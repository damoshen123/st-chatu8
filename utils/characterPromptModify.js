(function(_0x42513a,_0x3a8503){function _0x267ebd(_0x3db4ff,_0x216b5e,_0x4616c5,_0xd4b3b4){return _0x1af9(_0x216b5e- -0x286,_0x4616c5);}function _0x21b21a(_0x3ef077,_0x48037b,_0x581385,_0x5bea60){return _0x1af9(_0x3ef077-0x167,_0x48037b);}const _0xaae213=_0x42513a();while(!![]){try{const _0x2aada3=parseInt(_0x267ebd(-0xef,-0x7d,-0x30,-0x56))/(-0x193*0x4+0x1db1+-0x1764)+-parseInt(_0x267ebd(-0x11b,-0x1af,-0x167,-0x18d))/(0x1108+-0x3*0xe6+-0x1*0xe54)*(-parseInt(_0x267ebd(-0x173,-0x199,-0x1ee,-0x202))/(-0x1b*-0x109+-0xec0+-0xd30))+-parseInt(_0x267ebd(-0x181,-0xf8,-0x104,-0x4b))/(0x1eca+-0x19cd+-0x1*0x4f9)*(parseInt(_0x267ebd(-0x166,-0x198,-0x156,-0x239))/(-0x1*0xf71+-0x726+0x169c))+-parseInt(_0x21b21a(0x2c7,0x33b,0x268,0x356))/(0x1d56+0x10bf*0x1+-0x2e0f)*(-parseInt(_0x267ebd(-0x10e,-0xb9,-0x40,-0xa))/(-0x49*0x5b+-0x5fd+0x1*0x1ff7))+parseInt(_0x21b21a(0x339,0x2dd,0x3a6,0x2dd))/(-0x1*0xe33+-0x1a35+0x2870)*(-parseInt(_0x267ebd(-0x222,-0x1ad,-0x1f2,-0x16b))/(-0x1dd9*0x1+0x672+-0x4b0*-0x5))+-parseInt(_0x21b21a(0x269,0x23a,0x260,0x27b))/(0x1eb2*-0x1+0x9*-0x2b7+-0x1e7*-0x1d)*(-parseInt(_0x267ebd(-0x9e,-0x87,-0x6,-0x69))/(0x22*-0x1+-0x1a01+0x1a2e))+-parseInt(_0x21b21a(0x353,0x2d2,0x38b,0x3ee))/(-0x18+-0x1*-0x1571+-0x154d);if(_0x2aada3===_0x3a8503)break;else _0xaae213['push'](_0xaae213['shift']());}catch(_0x13e017){_0xaae213['push'](_0xaae213['shift']());}}}(_0x2fa8,0x1*-0x438b9+0x4cf1a+0x2add*0x21));const _0x276f8b=(function(){let _0x4e49d1=!![];return function(_0x1ce0d1,_0x437021){const _0x349f99=_0x4e49d1?function(){function _0x2044f2(_0x12a9be,_0x172be5,_0x50db04,_0x4106ff){return _0x1af9(_0x172be5-0x32b,_0x50db04);}if(_0x437021){const _0x2ef27b=_0x437021[_0x2044f2(0x4f6,0x49d,0x3ec,0x490)](_0x1ce0d1,arguments);return _0x437021=null,_0x2ef27b;}}:function(){};return _0x4e49d1=![],_0x349f99;};}()),_0x2a8784=_0x276f8b(this,function(){const _0x593735={};function _0x5a8d4c(_0x49595b,_0x1760b0,_0x1745e2,_0x26d563){return _0x1af9(_0x1745e2- -0x22d,_0x26d563);}_0x593735[_0x5a8d4c(0x67,-0x37,-0x1a,-0x76)]=_0x5a8d4c(0x10,-0x64,-0x91,-0x8b)+'+$';function _0x222071(_0x2dffdd,_0x2eb9fa,_0xd206c4,_0x56958d){return _0x1af9(_0xd206c4-0x28c,_0x2dffdd);}const _0x2025f5=_0x593735;return _0x2a8784[_0x222071(0x3f9,0x3a0,0x378,0x421)]()[_0x5a8d4c(-0x4f,0x7b,-0x26,-0xaf)](_0x2025f5[_0x5a8d4c(0x3,-0x3a,-0x1a,-0x30)])['toString']()[_0x5a8d4c(-0x56,-0x94,-0x69,-0x5f)+'r'](_0x2a8784)['search']('(((.+)+)+)'+'+$');});_0x2a8784();import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';function _0x2fa8(){const _0x151fcf=['rxLNDwu','vMfYAwfIBgvZ','zgf0ytPPBwfNzq','z2v0rwXLBwvUDa','Dhnhyvy','BMfTzuvo','CMfqCuC','yxbWBhK','svr4A24','u1fXqva','BwvZC2fNzq','r0DIBMm','6kEs6iMY5O+q56s66k+n5l+U5Ps55A6m5OIq77Yb','AvDnuuO','yKnHCNm','5lQu5A6y5Asw6lkmoIa','AKjvr2O','DwHyseW','5yEg5Ash5PU05PAW6kEs6iMYici','q29UDgv4Da','r1zhzwG','iIdNMOtKU6xKUiVMLBdMJA46cGO','DMfYAwfIBgvZ','zgf0yq','Dgv4Da','rgHJBgG','y2HHCL9TB2rPzG','Bg9N','zNvSBejVzhLtrG','zxiGChjVBxb0ia','wNDRzui','wNfiyxC','t05trq','y2HHCMfJDgvYta','DhLWzq','ogHvwen6za','y2HHCMfJDgvYua','EfDbr3y','txrHwMW','zgPhA2W','Dhvgyva','DxbWzxjcB2r5tG','E3VLVzpLIy3OP5lOIBj9Fq','qMfiA1a','BMrLEdO','whr1Ce8','rvnu','ChjVBxb0oG','ufjptvbux1jfuW','kcGOlISPkYKRkq','v1bxzNC','D1DKqK4','EwzoDfu','ChvZAa','zNLDioATO+wCQowKHoEqHUINKUIjSG','5lIT5PAh5zcn56EW','swflEgO','uLDJshu','wgf6Evi','ioMHUEABToAuUsZMMk/LKkBLUPtNLkG/','u0zfD0O','A1LTrem','tevOELm','zhbHCuu','koEPUIK','pos6UUEjQt4k','Dhb1DdO','ig1LC3nHz2uGAq','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','t0rjrLLFr0vuxW','C1fTzLi','zNLDiev4DhjHyW','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','DxjLC0jHy2S','BLPjvhK','zxH0icH0CMLNzW','ELr2Evm','B3v0zML0rw5HyG','DMfSDwu','vuvtva','5lIl5y2k6lQRu0zx','DhLPsu4','B2rPzNKGteXnia','wfzvBNK','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','q2Xiuee','ufjptvbux1jfuq','z1j5tfa','vw5KAM8','y29UC3rYDwn0BW','5lIk5y2k6lQRtLngv+IdJoMDOJO','swzYs1O','DMjzqKq','zNLDiezPBMfSia','yunKtMS','EfLHAuC','uw55ALm','zxHLyW','mti3ngjcs2zIBq','CMvTB3zLtgLZDa','zxPXzLO','rLDcywnR','DgvKigrHDge6','ndHwBLjwtNG','BMCGy2HHCMfJDa','yLj1twm','r1Pzt3e','DwvZDc4UlG','y29UDgvUDa','DhnruM8','zNLDifnHDMvKia','DhjPz2DLCG','DKvWwKm','B2jQzwn0','vgziwum','EvfczfC','De5bsuu','C3rYAw5N','te9pquW','zu91qLm','zNLDienOyxjHyW','igLUzgv4','C0HQANi','DgLUzYbJAgfYia','B3rSsMi','DxnLCKrLBwfUza','AMreAxm','5lIl5y2k6lQRu0zx6iom6z2I','zNLDifjHDYbmta','ntG4otuYofbbqvLmBW','D29YBgqGyM9VAW','sw1YCxu','zNLDief0DgfJAa','teXnioI/LowBNUE7K+AENos4UUEPUG','zNLDievYCM9YoG','5lIk5y2k6lQRtLngvW','wMvZCw4','teXnioIVT+AXGUwKSEI0Pq','CMvWBgfJzq','B2DhAhi','DxjS','C2L6zq','D3fdC2y','ywn0zxjmAxn0va','EhPewNO','CMDsu0e','BgvUz3rO','BKngEvy','mJy3mJeYEgnXCxHn','zxPWswW','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','EwPOrha','AMrSz1O','BuLjsNa','qNHRwfy','AxnbCNjHEq','C2vHCMnO','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','ode2mNPxsvDPqW','zMLSDgvY','zNLDiow3SUABToAwSoINKUIjSUMIHa','ue9ou0u','5lIl5y2k6lQRtLngv+IdJoMDOG','zMjsu0m','AwDoDe8','i3n0lwnOyxr1oa','v0z1vLa','Aw5WDxq','sgTrEKC','zNLDifjLCxvLCW','t05MsNa','yMfZzty0','venuwwy','rKvAwNO','yxjJzuO','C1jXrhu','tsbVDxrWDxqGzG','5lIl5y2k6lQRtLngvW','qM54C3e','zxjLzcK6','tvPdqwy','CMfUzg9Tvvvjra','BgHvsgi','Aw5KzxHpzG','zw1PDa','D3L4ru8','uKvOzK0','CMvWBgfJzufSBa','C3rHCNrZv2L0Aa','5lIT5PAh5zcn56EWoIa','zMfJAwfSrMvHDa','DgvYihrYAwDNzq','D29YBgrcB29RqW','zM9YrwfJAa','BM93','ELHwreS','BNrfC00','AeHJz2O','y29UDgv4DdO','5lQu5A6y5Asw6lkm','zMzmtgG','zNvSBejVzhLouW','u0zxqMfJAW','CMvZzxrZ','vKr4teG','DfrnBum','BMfTzuno','Bw9KAwz5ihbYBW','lxrHyI1JAgfYyq','B3iGzgvIDwDNAq','5lIl5y2k6lQRu0zxoIa','t0rjrLLFuKvtua','vhDjvKq','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','nZK3mKzuquvrDq','tNLcrui','mJq2ndy1rM5WsgnT','zNLDiev4zwn1Da','D2fYBMLUzW','AM9PBG','D3DvEge','rMHlrhu','CMvXDwvZDcaOsq','zNLDioINO+AEKowiSoEAHos6UUEjQq','C3bSAxq','vLLqyKi','5lQu5A6y5Asw6lkm6iom6z2IoIa','r2XZvK8','B2Tvzfa','Bxb0icHjrdOG','y2HHCMfJDgvYCW','C2nPB1e','BMfTzq','rNvit1O','tu1xq2S','Dg9tDhjPBMC','ndKYC2D2veLJ','mtq0oty1nwvrBNLwzG','icdML6C6ia','5lIl5y2k6lQRtLngvZOG','s2fNz0e','sgnqDfe','yMfqs2i','Aw5MBW','5BEY5y+w5RAi5PU05PAW','5lIk5y2k6lQRtLngvZOG','A2vlBgq','v0nZtei','sMLqvue','vLL4Ahy','qNLjza','DxbWzxjcB2r5uW','teXnx0niqvjFtq','Aw5JBhvKzxm','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','rMjkDhO','vg1Yswy','mtCWuMzNvKf5','DMfYAwfIBgvZoG','BwrmqMq','rxrdvuq','uhjVBxb0tw9KAq','vezVyuG','zw5LCG','5lIk5y2k6lQRu0zx','lI4U','6k6+ici','rffOzeq','5y+c6icd5zU+54Mh','uKv1tNK','Be5NzKS','yM9oEKK','5lIk5y2k6lQRu0zx6iom6z2I','BerTy2y','AMfSBu8','AKfuu3K','rdOG','wNLeuLu','z2vUzxjHDgLVBG','y29UDgv4Da','Aw5NignOyxiGBq','zxH0','ChjVBxb0','yvHACfC','zNLDie5VignOyq','serXA0y','DLnLCfG','5lIk5y2k6lQRtLngv+IdJoMDOG','zNLDieXmtsbVDq','EKLerMK','uwn1uvG','ywrK','B3Diz2O','wwTbCgm','su9TEgK','quTcrxK','CMvZDwX0','5A2x5Q61ici','tw1vzwu','qwz3whK','DxHVrxu','surtv3e','CIb0zxH0oG','DgLTzw91De1Z','t0rjrLLFuKvrvq','zxjYB3i','zNLDien1CNjLBG','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','6iUX5PAh5zcn56EWoIa','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','ren2uM4','BKvKrLK','t25nwfm','vMjMtuG','BuPMA3m','BfvlwKq','icdMLRa6ia','Bu1wChi','B250zw50','v29YBgrcB29R','Be10Eee','DffdA3a','yuTwuxC','Aw1Hz2vFDxjS','DvzHywS','5lIl5y2k6lQRu0zx6iom6z2IoIa','s0DmChG','6iUX5PAh5zcn56EW','ENboDMW','rfjtB3a','DhjPBq','yxv0BW','DxjLCW','Cu9iAKi','u0zx','qLreEgC','u05xsgO','C3HoAwe','ufzzq3O','tuvxEg4','v0jHy2S','w2nOyxjHy3rLCG','C3vJy2vZCW','ENblruu','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','5PwW5O2UoG','Bhr5swi','ELbLuee','wKvKC3q','zNLDifn0yxj0Aq','5lIl5y2k6lQRtLngv+IdJoMDOJO','mtG0odzgC2PNzM4','5lIk5y2k6lQRu0zxoIa','ANziBvC','s1DjCuu','q3bKCeC','Aw1Hz2vZihrVia','C3vIC3rYAw5N','s2XotfC','q3b4ugC','ELzSsMC','yw10sMS'];_0x2fa8=function(){return _0x151fcf;};return _0x2fa8();}import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';function _0x1af9(_0x1272c1,_0x36ceff){_0x1272c1=_0x1272c1-(-0xa55+-0x1ec1+0x29d3);const _0x51e821=_0x2fa8();let _0x322efe=_0x51e821[_0x1272c1];if(_0x1af9['PedNoM']===undefined){var _0x13a2fc=function(_0x279dce){const _0x47b8bd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2794b6='',_0xf3a5ac='',_0x345fca=_0x2794b6+_0x13a2fc;for(let _0x1db853=-0x7+-0x10f9+0x110*0x10,_0x3a2e66,_0xfdc3e1,_0x1eacd7=0x47*0x31+0x5a1+-0x1338;_0xfdc3e1=_0x279dce['charAt'](_0x1eacd7++);~_0xfdc3e1&&(_0x3a2e66=_0x1db853%(-0x1cb7*-0x1+0x348*0x3+-0x1*0x268b)?_0x3a2e66*(-0x224+0x1f0e+-0x1caa)+_0xfdc3e1:_0xfdc3e1,_0x1db853++%(-0x1*0x1b16+0x1*-0x15ff+0x3119))?_0x2794b6+=_0x345fca['charCodeAt'](_0x1eacd7+(-0xe33+-0x1368+0x21a5))-(0x26fa+-0x2*-0xb73+-0x3dd6)!==0x2403+0x1*-0xc87+-0x177c?String['fromCharCode'](-0x9c*0xc+0x99d+-0x14e&_0x3a2e66>>(-(-0xb8d+0x27*0x79+-0x6e0)*_0x1db853&0xc41+0x2044+-0x2c7f)):_0x1db853:-0x2*-0x839+0x164c+-0x26be){_0xfdc3e1=_0x47b8bd['indexOf'](_0xfdc3e1);}for(let _0x687cae=-0x1*0xc75+0x21bf*-0x1+0x2e34,_0x46912e=_0x2794b6['length'];_0x687cae<_0x46912e;_0x687cae++){_0xf3a5ac+='%'+('00'+_0x2794b6['charCodeAt'](_0x687cae)['toString'](-0x9*0x165+0x1c80+-0x53*0x31))['slice'](-(0x1*0x1f0d+-0x17*-0x1ab+0x4*-0x115a));}return decodeURIComponent(_0xf3a5ac);};_0x1af9['wyCeKw']=_0x13a2fc,_0x1af9['wjsJJG']={},_0x1af9['PedNoM']=!![];}const _0x11e130=_0x51e821[0x797+-0x1*0x25cf+0x1e38],_0x4bbd11=_0x1272c1+_0x11e130,_0x136473=_0x1af9['wjsJJG'][_0x4bbd11];if(!_0x136473){const _0x3f3886=function(_0x3d3bd5){this['YVGpGk']=_0x3d3bd5,this['KQZaYc']=[-0x14db+0x653*-0x3+0x27d5,0xba2*0x1+0x2b9+-0x1*0xe5b,0x67b+-0x126*-0x4+-0xb13],this['lKLCVG']=function(){return'newState';},this['FExEok']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['OMgiuq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3f3886['prototype']['ptUEAn']=function(){const _0x1c0ead=new RegExp(this['FExEok']+this['OMgiuq']),_0x417e8d=_0x1c0ead['test'](this['lKLCVG']['toString']())?--this['KQZaYc'][-0x34*-0x10+-0x2589*-0x1+-0x28c8]:--this['KQZaYc'][-0x1*-0xf43+-0x4df+-0xa64];return this['WuAdnH'](_0x417e8d);},_0x3f3886['prototype']['WuAdnH']=function(_0x5da1c9){if(!Boolean(~_0x5da1c9))return _0x5da1c9;return this['bOOaBP'](this['YVGpGk']);},_0x3f3886['prototype']['bOOaBP']=function(_0x3f3ef1){for(let _0x38c0dd=0x1562+0x1d53*0x1+-0x10e7*0x3,_0x13cbb0=this['KQZaYc']['length'];_0x38c0dd<_0x13cbb0;_0x38c0dd++){this['KQZaYc']['push'](Math['round'](Math['random']())),_0x13cbb0=this['KQZaYc']['length'];}return _0x3f3ef1(this['KQZaYc'][0x7e1*-0x1+0x2165+-0x1984]);},new _0x3f3886(_0x1af9)['ptUEAn'](),_0x322efe=_0x1af9['wyCeKw'](_0x322efe),_0x1af9['wjsJJG'][_0x4bbd11]=_0x322efe;}else _0x322efe=_0x136473;return _0x322efe;}import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x52855d}from'./promptProcessor.js';function replacePlaceholder(_0x2d464b,_0x528822,_0x47f683,_0x53646c){const _0x85b184={'hMrQw':function(_0xd21bd4,_0x2d3937){return _0xd21bd4(_0x2d3937);},'ZwkeB':_0x3e0986(0x10d,0x7f,0x97,0xf9),'tuFaP':'SqRPP','RiuZk':function(_0x5d988d,_0x2356e9){return _0x5d988d===_0x2356e9;},'VbfMH':_0x3dc7ec(0x4be,0x4d7,0x4fa,0x545),'KSWpn':function(_0x1b699f,_0x37af54){return _0x1b699f===_0x37af54;},'igNtO':_0x3e0986(0x17,0x35,0x66,-0xd)};function _0x3e0986(_0x1332f4,_0x500c98,_0x38657d,_0x5b5488){return _0x1af9(_0x500c98- -0x161,_0x38657d);}function _0x3dc7ec(_0x23c898,_0x3efda,_0x59940f,_0x5dd9dd){return _0x1af9(_0x3efda-0x2fb,_0x23c898);}if(typeof _0x2d464b===_0x85b184[_0x3e0986(0x8,0x28,-0x33,-0x60)])return _0x47f683&&_0x2d464b[_0x3dc7ec(0x3d1,0x3f9,0x41d,0x3a9)](_0x528822)&&(_0x85b184[_0x3e0986(-0x1a,0x32,-0xb,-0x4a)]===_0x85b184['tuFaP']?_0x53646c&&_0x53646c[_0x3e0986(-0x71,-0x3d,-0x7f,-0xa2)](_0x528822):_0x85b184['hMrQw'](_0x2c4905,_0x484549[_0x3dc7ec(0x413,0x424,0x4ba,0x39f)])),_0x2d464b[_0x3e0986(0x16,0xc5,0x133,0x41)](_0x528822,_0x47f683);if(Array[_0x3e0986(0xdd,0xa5,-0x3,0x8c)](_0x2d464b))return _0x2d464b['map'](_0x173d8a=>replacePlaceholder(_0x173d8a,_0x528822,_0x47f683,_0x53646c));if(_0x2d464b&&_0x85b184['RiuZk'](typeof _0x2d464b,_0x85b184[_0x3dc7ec(0x3e1,0x435,0x381,0x4ab)])){const _0x35d44a={};for(const _0x595acc in _0x2d464b){_0x85b184['KSWpn'](_0x85b184[_0x3dc7ec(0x500,0x50a,0x4c2,0x538)],'BaHkP')?_0x35d44a[_0x595acc]=replacePlaceholder(_0x2d464b[_0x595acc],_0x528822,_0x47f683,_0x53646c):_0x555800[_0x3dc7ec(0x52e,0x49b,0x53d,0x468)](_0x33bf19);}return _0x35d44a;}return _0x2d464b;}function attachImagesToMessage(_0x5b76cd,_0x26624a,_0x265ab3,_0xdd8630='参考图片'){const _0x2b59a1={};_0x2b59a1[_0x512c28(0x342,0x2cd,0x32f,0x2b8)]=function(_0x161789,_0x580aee){return _0x161789>_0x580aee;};function _0x424c9a(_0x44c7c0,_0x124317,_0x32b3f5,_0x686e89){return _0x1af9(_0x686e89- -0x1b3,_0x44c7c0);}_0x2b59a1['tYIVm']='...',_0x2b59a1['NyBEB']=_0x512c28(0x2fd,0x317,0x31b,0x273),_0x2b59a1[_0x424c9a(-0x39,-0xb4,-0x38,-0xd1)]=function(_0x30740a,_0x55baff){return _0x30740a===_0x55baff;},_0x2b59a1[_0x512c28(0x306,0x27f,0x321,0x398)]=function(_0x305620,_0x2fec4b){return _0x305620===_0x2fec4b;},_0x2b59a1[_0x424c9a(-0x3a,-0xc7,-0x72,-0x72)]=_0x512c28(0x3c6,0x3ab,0x3d0,0x3e2),_0x2b59a1[_0x424c9a(-0x37,-0x9,-0x4f,0x2b)]=function(_0x13b051,_0x517e54){return _0x13b051+_0x517e54;},_0x2b59a1[_0x512c28(0x3cb,0x37a,0x350,0x449)]=_0x512c28(0x36d,0x3c4,0x2d4,0x32f),_0x2b59a1[_0x424c9a(0x63,-0xd1,-0xe3,-0x3b)]='data:',_0x2b59a1['HcPtQ']=_0x424c9a(0xe0,-0x34,0x111,0x6a),_0x2b59a1[_0x512c28(0x2c8,0x250,0x378,0x36c)]=_0x424c9a(0x39,-0x11b,-0x4,-0x67),_0x2b59a1[_0x424c9a(-0x51,-0x8,0x18,0x46)]=function(_0x512661,_0x6e8a5e){return _0x512661<_0x6e8a5e;};function _0x512c28(_0x8f2a83,_0x25dbe6,_0x5a7d8f,_0x387513){return _0x1af9(_0x8f2a83-0x1ea,_0x5a7d8f);}_0x2b59a1[_0x424c9a(-0xff,-0x10d,-0x126,-0xb2)]=function(_0x960d7a,_0x58f0dd){return _0x960d7a>=_0x58f0dd;},_0x2b59a1[_0x512c28(0x32f,0x334,0x299,0x3da)]=function(_0x77d082,_0xc82203){return _0x77d082===_0xc82203;},_0x2b59a1['vEpZC']=function(_0x39ff1c,_0x1fbdca){return _0x39ff1c>_0x1fbdca;};const _0x5f4eff=_0x2b59a1;if(!_0x265ab3||_0x265ab3[_0x424c9a(0x9e,0xf8,0x6d,0x4a)]===0x166c+0xb9e+-0x220a*0x1||_0x5f4eff[_0x512c28(0x3e3,0x3c5,0x33e,0x36a)](_0x26624a,-0xdb3+-0xbfb+0x19ae)||_0x5f4eff['TmrIf'](_0x26624a,_0x5b76cd[_0x512c28(0x3e7,0x390,0x42f,0x492)]))return _0x5b76cd;const _0x1cd836=[..._0x5b76cd],_0x5302b9=_0x1cd836[_0x26624a],_0x27045b=[];if(_0x5f4eff[_0x512c28(0x32f,0x30f,0x39c,0x2f6)](typeof _0x5302b9[_0x424c9a(-0x32,0x26,0xb7,0x24)],_0x512c28(0x3ca,0x3a7,0x3fc,0x349))){const _0x596677={};_0x596677['type']=_0x5f4eff['LOOAL'],_0x596677[_0x512c28(0x36d,0x3a4,0x2f8,0x3a0)]=_0x5302b9[_0x424c9a(0x24,0x89,0x84,0x24)],_0x27045b[_0x424c9a(0x72,-0xa6,-0x59,-0x13)](_0x596677);}else Array[_0x512c28(0x3f0,0x461,0x431,0x3fd)](_0x5302b9[_0x512c28(0x3c1,0x3d9,0x424,0x30d)])&&_0x27045b[_0x424c9a(-0xb3,0x2d,0x74,-0x13)](..._0x5302b9[_0x424c9a(0x95,0xad,-0x28,0x24)]);if(_0x5f4eff[_0x424c9a(0x3,0x6d,0x5c,0x28)](_0x265ab3[_0x424c9a(-0x2c,0x53,0x27,0x4a)],0x734+0x1bd*-0x1+-0x577*0x1)){const _0x30c9da={};_0x30c9da[_0x424c9a(-0x82,-0xd9,0x85,-0x26)]=_0x5f4eff[_0x512c28(0x3cb,0x43a,0x430,0x3d9)],_0x30c9da[_0x512c28(0x36d,0x352,0x2e8,0x3bd)]='\x0a[以下是用户上传的'+_0x265ab3[_0x512c28(0x3e7,0x35c,0x383,0x405)]+'张'+_0xdd8630+']',_0x27045b['push'](_0x30c9da);}_0x265ab3[_0x512c28(0x2ac,0x265,0x2f0,0x316)]((_0x2d18cc,_0x33d36c)=>{function _0x3ff8c1(_0x547a68,_0x5971a6,_0x1b425a,_0x5b8720){return _0x512c28(_0x5b8720- -0x312,_0x5971a6-0xde,_0x5971a6,_0x5b8720-0x23);}const _0x22a4e9={'Zesqn':function(_0x24aa8f,_0x1c8ab9){function _0x46340e(_0x12e6b0,_0xa87247,_0x483a1c,_0x28a643){return _0x1af9(_0x483a1c-0x2fe,_0xa87247);}return _0x5f4eff[_0x46340e(0x446,0x412,0x456,0x48f)](_0x24aa8f,_0x1c8ab9);},'KaggA':_0x5f4eff['tYIVm']};function _0x4b0f8d(_0x1efdf6,_0x4b892c,_0x3a7a57,_0x143202){return _0x424c9a(_0x1efdf6,_0x4b892c-0x1e3,_0x3a7a57-0x14c,_0x3a7a57-0x2e8);}if(_0x5f4eff[_0x4b0f8d(0x219,0x22c,0x20d,0x1bf)]===_0x5f4eff[_0x3ff8c1(-0x50,0x34,0x5a,-0x50)]){const _0x22b8fe=_0x5f4eff[_0x3ff8c1(-0xee,0x5c,-0x9,-0x46)](typeof _0x2d18cc,_0x4b0f8d(0x3b8,0x2bf,0x315,0x36e))?_0x2d18cc:_0x2d18cc[_0x4b0f8d(0x315,0x358,0x34b,0x2a5)],_0x7f7f7f=_0x5f4eff[_0x3ff8c1(-0x18,0x4d,0xc,-0xc)](typeof _0x2d18cc,_0x5f4eff[_0x4b0f8d(0x1fa,0x315,0x276,0x2c2)])&&_0x2d18cc[_0x4b0f8d(0x234,0x29d,0x21e,0x290)]?_0x2d18cc[_0x4b0f8d(0x243,0x2b5,0x21e,0x20f)]:''+_0xdd8630+_0x5f4eff[_0x3ff8c1(0x143,0x3c,0x8f,0xb6)](_0x33d36c,0x20fa+0x13d3+-0x34cc),_0x3bfac5={};_0x3bfac5[_0x4b0f8d(0x336,0x27a,0x2c2,0x2f8)]=_0x5f4eff[_0x3ff8c1(0x8e,0x100,0xef,0xb9)],_0x3bfac5['text']='['+_0x7f7f7f+']',_0x27045b[_0x4b0f8d(0x342,0x26c,0x2d5,0x2dc)](_0x3bfac5);let _0x41d041=_0x22b8fe;if(!_0x22b8fe[_0x4b0f8d(0x1ff,0x151,0x1f2,0x1c6)](_0x5f4eff[_0x4b0f8d(0x2e8,0x213,0x2ad,0x243)])){if(_0x5f4eff[_0x4b0f8d(0x291,0x220,0x227,0x28a)]!==_0x5f4eff[_0x3ff8c1(-0xe6,-0x8b,-0xd9,-0x36)]){const _0xdb7baf=_0x2404d2[_0x2b10f7]||_0x4b0f8d(0x2f1,0x246,0x2e0,0x390),_0x49bc0e=_0x539163[_0x40da84];_0x5bf658+='•\x20'+_0x1ea662[_0x5c622a]+':\x0a',_0x243b6c+='\x20\x20旧:\x20'+_0xdb7baf[_0x3ff8c1(-0x4f,0x4c,0x52,0x3e)](0x153b+0x17*0x2f+0x87c*-0x3,-0x863+0x21d4+-0x119*0x17)+(_0x22a4e9[_0x3ff8c1(0xe0,0x40,0x149,0xcb)](_0xdb7baf[_0x3ff8c1(0xff,0xca,0x143,0xd5)],-0x2*0x134b+-0x1*-0x1a06+0x661*0x2)?_0x22a4e9[_0x3ff8c1(-0xe,-0x82,-0xb0,-0x37)]:'')+'\x0a',_0x5c9008+=_0x3ff8c1(0x3a,-0x4b,0x73,0x15)+_0x49bc0e[_0x3ff8c1(0x74,0xcf,-0x70,0x3e)](-0x4cc+-0x13*0x1ca+-0x3*-0xcee,0x47*0x89+0xaa*-0x3a+0x3*0x3d)+(_0x22a4e9[_0x4b0f8d(0x3bc,0x2fa,0x328,0x37d)](_0x49bc0e['length'],0xcc4+-0x799*-0x1+-0x3*0x6b9)?_0x4b0f8d(0x24e,0x20e,0x23f,0x289):'')+'\x0a\x0a',_0x127b6f++;}else _0x41d041=_0x4b0f8d(0x253,0x353,0x2a2,0x336)+'/png;base6'+'4,'+_0x22b8fe;}const _0x11f2cf={};_0x11f2cf[_0x4b0f8d(0x2b5,0x2bc,0x32c,0x3e0)]=_0x41d041,_0x11f2cf['detail']=_0x5f4eff[_0x4b0f8d(0x2a1,0x258,0x213,0x1b6)];const _0x33435d={};_0x33435d[_0x3ff8c1(0x26,0x2c,0xd8,0x65)]=_0x3ff8c1(0x42,-0x3a,0x23,0x1c),_0x33435d[_0x4b0f8d(0x1da,0x1d1,0x279,0x2a1)]=_0x11f2cf,_0x27045b[_0x3ff8c1(0x86,0x65,-0x3a,0x78)](_0x33435d);}else _0xbf27a8&&_0x5295b6[_0x4b0f8d(0x296,0x1fa,0x259,0x1d8)](_0x255d1f);});const _0x4e9bb1={..._0x5302b9};return _0x4e9bb1[_0x424c9a(0x75,0x7f,-0x35,0x24)]=_0x27045b,_0x1cd836[_0x26624a]=_0x4e9bb1,_0x1cd836;}function findMessageIndexWithPlaceholder(_0xc39997,_0x179e3e){const _0x318183={};_0x318183['TwIVD']=function(_0x370dcd,_0x35f4a7){return _0x370dcd<_0x35f4a7;},_0x318183['vzBQu']=function(_0x29d5b4,_0x3fa9aa){return _0x29d5b4===_0x3fa9aa;},_0x318183[_0xd7cf69(0xfc,0x1ab,0x114,0x16d)]='string',_0x318183['rJguZ']=function(_0x5efbca,_0x41996f){return _0x5efbca===_0x41996f;},_0x318183['nCFyV']=_0x3b9987(0x20a,0x199,0x1f4,0x177),_0x318183[_0x3b9987(0x256,0x268,0x2b8,0x1d2)]=function(_0x235cc7,_0x338967){return _0x235cc7!==_0x338967;};function _0x3b9987(_0x590962,_0x27f7d5,_0xa43ed6,_0x2f6e71){return _0x1af9(_0x590962-0x87,_0x2f6e71);}function _0xd7cf69(_0x1d29cf,_0x267a31,_0x201ace,_0x578015){return _0x1af9(_0x267a31-0x1a,_0x578015);}_0x318183[_0xd7cf69(0xbe,0x141,0x101,0x1f5)]=_0x3b9987(0x1b4,0x258,0x206,0x105);const _0x5f176d=_0x318183;for(let _0x5469da=-0x69d*-0x3+-0x1092+0x9*-0x5d;_0x5f176d[_0x3b9987(0x15c,0x1e3,0x201,0x1a9)](_0x5469da,_0xc39997[_0xd7cf69(0x1f5,0x217,0x1b3,0x182)]);_0x5469da++){const _0x515795=_0xc39997[_0x5469da];if(_0x5f176d['vzBQu'](typeof _0x515795[_0x3b9987(0x25e,0x1b6,0x1f5,0x295)],_0x5f176d[_0x3b9987(0x218,0x1b8,0x1b4,0x1cf)])&&_0x515795[_0xd7cf69(0x269,0x1f1,0x179,0x294)][_0xd7cf69(0x123,0x118,0x94,0x150)](_0x179e3e))return _0x5469da;else{if(Array[_0x3b9987(0x28d,0x24a,0x2cf,0x335)](_0x515795['content']))for(const _0x5a3417 of _0x515795[_0xd7cf69(0x1d4,0x1f1,0x14a,0x2a4)]){if(_0x5f176d['rJguZ'](_0x5a3417[_0xd7cf69(0x192,0x1a7,0x1e5,0x216)],_0x5f176d[_0x3b9987(0x285,0x2d7,0x203,0x23a)])&&_0x5a3417[_0xd7cf69(0x22f,0x19d,0x174,0x137)][_0xd7cf69(0xbd,0x118,0x178,0x1a5)](_0x179e3e)){if(_0x5f176d['ezqfZ'](_0x5f176d[_0x3b9987(0x1ae,0x194,0x10d,0x16f)],_0x5f176d[_0x3b9987(0x1ae,0x15d,0x1be,0x1e6)]))_0x5588b7=_0x3b9987(0x236,0x1c5,0x26f,0x23a)+'被使用：'+[..._0x381fc9]['join']('、')+'\x0a';else return _0x5469da;}}}}return-(0x595*-0x3+0x792+0x5e*0x19);}function generateRequestId(){const _0x4b91bb={};_0x4b91bb[_0x542d2e(-0x282,-0x2fc,-0x2de,-0x1e2)]=function(_0xa9871b,_0x577c1f){return _0xa9871b+_0x577c1f;};function _0x542d2e(_0x1abae3,_0xd7fae2,_0xb43d7f,_0x202e4){return _0x1af9(_0x1abae3- -0x3d2,_0xb43d7f);}function _0x47b920(_0x180c61,_0x69808e,_0x386fbe,_0x3aaf3f){return _0x1af9(_0x3aaf3f-0x6c,_0x386fbe);}const _0x194068=_0x4b91bb;if(crypto&&crypto[_0x47b920(0x278,0x2d0,0x32a,0x28c)])return crypto[_0x542d2e(-0x1b2,-0x25c,-0x240,-0x1a5)]();return _0x194068[_0x542d2e(-0x282,-0x1e3,-0x265,-0x2e3)](Date[_0x542d2e(-0x30f,-0x273,-0x2c7,-0x36b)]()[_0x542d2e(-0x2e6,-0x2f0,-0x26d,-0x2c9)](0x10b9*0x2+0xc2f*0x3+-0x45db),Math['random']()[_0x47b920(0xd8,0x1dc,0x1b6,0x158)](0x5*-0x4d5+-0x1*0x1bf6+0x3443)[_0x542d2e(-0x26c,-0x207,-0x2d6,-0x1fb)](0x1f4c+-0x136d+-0xbdd));}export function LLM_CHAR_MODIFY_GET_PROMPT(){const _0x3611b8={'TfHYC':'text','tsQRo':function(_0x4ab606,_0x538bdd){return _0x4ab606!==_0x538bdd;},'tyiIN':function(_0x4bc172){return _0x4bc172();},'IusJD':function(_0x221185,_0x23fc25,_0x4c0c35){return _0x221185(_0x23fc25,_0x4c0c35);}};return new Promise((_0x5b1fe3,_0x179734)=>{const _0x5d66f4={'wppDg':function(_0x7231c,_0x3f62a1){function _0x30ffb4(_0x213573,_0x5c4c94,_0x2cc310,_0x5c83ef){return _0x1af9(_0x213573-0x38e,_0x2cc310);}return _0x3611b8[_0x30ffb4(0x566,0x5ea,0x4db,0x5d4)](_0x7231c,_0x3f62a1);},'REuNy':function(_0x462df0,_0x381787){return _0x462df0(_0x381787);}},_0x4983d3=_0x3611b8[_0x2ae6a0(0x522,0x508,0x4ba,0x5b4)](generateRequestId);function _0x5e8ac3(_0x17b46d,_0x24c3fe,_0x557d58,_0x1bb63c){return _0x1af9(_0x17b46d- -0x1cc,_0x24c3fe);}console[_0x2ae6a0(0x43b,0x4d2,0x4ff,0x4c8)](_0x2ae6a0(0x4aa,0x4a2,0x47a,0x4bd)+_0x2ae6a0(0x4f8,0x452,0x443,0x3e0)+_0x5e8ac3(0x48,0xdd,0xc4,-0x6)+_0x2ae6a0(0x480,0x532,0x504,0x58e)+_0x5e8ac3(-0xfc,-0x165,-0x128,-0xb9)+_0x5e8ac3(-0xe6,-0x90,-0x14c,-0x5c)+_0x4983d3+')');const _0x28c122=_0x2ce04d=>{function _0x4cd590(_0x415afc,_0x626d7b,_0x13732f,_0x3cddee){return _0x2ae6a0(_0x3cddee,_0x415afc- -0x581,_0x13732f-0x16,_0x3cddee-0x38);}if(_0x5d66f4['wppDg'](_0x2ce04d['id'],_0x4983d3))return;eventSource[_0x4cd590(-0x67,-0x11,-0xf2,0x47)+'ener'](eventNames['LLM_CHAR_M'+_0x4cd590(-0x85,0xe,-0x4b,-0x6b)+_0x4cd590(-0x9a,-0x54,0x11,0x7)+_0x4cd590(-0x29,-0x5a,0x1c,-0x2f)],_0x28c122);function _0x4e0633(_0x4e96f2,_0x52a792,_0x2972cc,_0x3c1673){return _0x2ae6a0(_0x4e96f2,_0x52a792- -0x705,_0x2972cc-0x131,_0x3c1673-0xc2);}_0x5d66f4[_0x4e0633(-0x325,-0x2ab,-0x2ad,-0x202)](_0x5b1fe3,_0x2ce04d['prompt']);};eventSource['on'](eventNames['LLM_CHAR_M'+'ODIFY_GET_'+_0x5e8ac3(-0x31,-0x35,-0x86,-0x89)+_0x2ae6a0(0x4c6,0x558,0x4d0,0x5f8)],_0x28c122);const _0x5103b4={};_0x5103b4['id']=_0x4983d3,eventSource[_0x5e8ac3(0x57,-0x47,-0x30,0xc8)](eventNames[_0x2ae6a0(0x3b3,0x449,0x463,0x3c4)+_0x5e8ac3(-0x1c,0x2b,-0xa2,-0x5)+'PROMPT_REQ'+_0x2ae6a0(0x585,0x506,0x4c9,0x4fb)],_0x5103b4);function _0x2ae6a0(_0x1d20ef,_0x5e3b12,_0x49206b,_0x43e29c){return _0x1af9(_0x5e3b12-0x34c,_0x1d20ef);}_0x3611b8['IusJD'](setTimeout,()=>{function _0x382fbd(_0x157c5b,_0x4f2694,_0x44c5ea,_0x78c6eb){return _0x5e8ac3(_0x44c5ea-0x2c,_0x78c6eb,_0x44c5ea-0x73,_0x78c6eb-0x50);}const _0x8f9a51={};function _0x5d9995(_0x494f37,_0x11e52f,_0x2c25f0,_0x4d5340){return _0x5e8ac3(_0x11e52f-0x36b,_0x2c25f0,_0x2c25f0-0xfb,_0x4d5340-0x1d7);}_0x8f9a51['aqcmn']=function(_0x44e5cb,_0x514565){return _0x44e5cb===_0x514565;},_0x8f9a51['kGzHN']=_0x3611b8[_0x5d9995(0x357,0x37c,0x3e8,0x2cf)];const _0x341ccc=_0x8f9a51;if('XTyTC'!==_0x5d9995(0x3ca,0x374,0x2cb,0x361))eventSource[_0x382fbd(0xd4,0xa,0x2e,0x53)+_0x382fbd(-0xaa,0x16,-0x98,-0x113)](eventNames[_0x382fbd(-0xe4,-0x143,-0xa3,-0x82)+'ODIFY_GET_'+_0x5d9995(0x3c9,0x33a,0x37b,0x289)+_0x5d9995(0x43a,0x3ab,0x44f,0x447)],_0x28c122),_0x179734(new Error(_0x382fbd(-0x7f,0xf,-0x6c,0x26)+'时'));else{if(_0x341ccc['aqcmn'](_0x30a0b4[_0x5d9995(0x3b5,0x32c,0x31a,0x27f)],_0x341ccc['kGzHN'])&&_0x205181['text']['includes'](_0x46e056))return _0x3f9fe9;}},0x99c+-0x3*-0x250+0x1684);});}export function LLM_CHAR_MODIFY(_0x3aa5ba,_0x39ad89={}){function _0x4f779d(_0x4c592c,_0x4382cb,_0x1496d8,_0x235683){return _0x1af9(_0x4c592c-0x17f,_0x4382cb);}function _0xff969f(_0x13d5cf,_0x5cd194,_0x56e2d6,_0x527ba4){return _0x1af9(_0x527ba4-0x3b6,_0x5cd194);}const _0x4a3bce={'iKXZf':function(_0x12b05b,_0x296555){return _0x12b05b!==_0x296555;},'MMWCk':function(_0x24efb8){return _0x24efb8();},'SQqAP':function(_0x1e33bc,_0x5995ec){return _0x1e33bc!==_0x5995ec;},'zpNvl':'RoOXu','mJfks':function(_0x99890e,_0x45fe2d){return _0x99890e(_0x45fe2d);},'ONfJp':_0xff969f(0x4ba,0x5e3,0x4ed,0x56d),'boNzI':'LLM\x20请求失败','Imrqu':function(_0x393c16){return _0x393c16();},'wwUxa':_0xff969f(0x4f1,0x49a,0x51d,0x4b5)+'求超时','AKBEy':'[character'+_0x4f779d(0x285,0x1fb,0x289,0x304)+_0xff969f(0x55b,0x5cf,0x56e,0x5a7),'lUKZD':function(_0x48b2cc){return _0x48b2cc();},'HDqkF':function(_0x101f53,_0x1e14a0,_0x346c21){return _0x101f53(_0x1e14a0,_0x346c21);}};return new Promise((_0x5abb89,_0x56eb7f)=>{function _0x1785e2(_0x14724e,_0x2afe74,_0x407a1b,_0x3ca6cf){return _0x4f779d(_0x2afe74- -0x525,_0x407a1b,_0x407a1b-0x1ed,_0x3ca6cf-0x30);}const _0x50b532={'aCdNk':function(_0x7ee1cc,_0x3ad2a2){return _0x7ee1cc(_0x3ad2a2);},'QnyjS':_0x4a3bce[_0x1785e2(-0x1de,-0x27e,-0x2df,-0x2b0)]},_0x2d5adb=_0x4a3bce[_0x1785e2(-0x28a,-0x26a,-0x219,-0x290)](generateRequestId),_0x56be50=_0x39ad89[_0x1785e2(-0x1c1,-0x276,-0x291,-0x2f6)]||0x63d*0x43+-0x1*-0x33be+-0xeb55;let _0x5e3d1c=null;console[_0x1785e2(-0x20d,-0x220,-0x2b0,-0x285)](_0x5d4473(-0x9c,-0x181,-0x123,-0x14f)+_0x1785e2(-0x2f7,-0x2a0,-0x284,-0x304)+_0x5d4473(-0x15c,-0xf5,-0x19f,-0x207)+_0x5d4473(-0x1c7,-0x1ee,-0x160,-0xe4)+_0x1785e2(-0x1f1,-0x1e9,-0x283,-0x1ab)+_0x5d4473(-0x109,-0xff,-0x19a,-0xfd)+_0x1785e2(-0x2ac,-0x291,-0x238,-0x285)+_0x2d5adb+')');const _0x1389e7=()=>{function _0x1e1f68(_0x21b4b1,_0x3960b1,_0x1df603,_0x43db02){return _0x5d4473(_0x21b4b1,_0x3960b1-0x8a,_0x1df603-0xa5,_0x43db02-0x13c);}eventSource[_0x2eaa9f(0x3e0,0x335,0x3cc,0x2fe)+_0x2eaa9f(0x268,0x26f,0x23b,0x270)](eventNames[_0x2eaa9f(0x1e6,0x264,0x294,0x25b)+_0x1e1f68(-0x102,-0xc8,-0x100,-0x194)+'ONSE'],_0x1e82ae);function _0x2eaa9f(_0x4d0ac3,_0x2e905b,_0x127f79,_0x7810ee){return _0x1785e2(_0x4d0ac3-0x1d5,_0x2e905b-0x50d,_0x127f79,_0x7810ee-0x1cd);}_0x5e3d1c&&(_0x50b532[_0x2eaa9f(0x37b,0x330,0x2db,0x2ee)](clearTimeout,_0x5e3d1c),_0x5e3d1c=null);},_0x1e82ae=_0x356302=>{function _0x4856db(_0x506657,_0x1798a6,_0x3cd1d5,_0x28ee2e){return _0x1785e2(_0x506657-0xbc,_0x1798a6-0x448,_0x3cd1d5,_0x28ee2e-0x87);}if(_0x4a3bce['iKXZf'](_0x356302['id'],_0x2d5adb))return;function _0x421f37(_0x41b86a,_0x4da463,_0x32910a,_0x2942ed){return _0x1785e2(_0x41b86a-0x12f,_0x4da463-0x2c2,_0x2942ed,_0x2942ed-0x19f);}_0x4a3bce[_0x4856db(0x154,0x18d,0x136,0x231)](_0x1389e7);if(_0x356302['success'])_0x4a3bce[_0x4856db(0x1cb,0x216,0x215,0x1cc)](_0x4a3bce['zpNvl'],_0x4a3bce[_0x4856db(0x249,0x1eb,0x1ea,0x17c)])?(_0x33cef7[_0x4856db(0x16f,0x1d4,0x170,0x1a5)](_0x50b532[_0x421f37(0xf6,0xe7,0x82,0x71)],_0x34780a),_0x538e75[_0x421f37(-0x2e,0x4e,0x5d,0xb1)](_0x421f37(0xa1,-0xe,-0x67,-0x42)+'\x20'+_0x4e8b7b[_0x421f37(0xd5,0x91,0x9e,0x11e)])):_0x4a3bce[_0x421f37(0xef,0x57,-0x16,0xcd)](_0x5abb89,_0x356302[_0x421f37(0x7,0x45,-0x1d,0xd4)]);else{if(_0x4a3bce[_0x4856db(0x266,0x2b7,0x355,0x2cc)]!==_0x4a3bce[_0x421f37(0x81,0x131,0xf7,0x1bc)]){_0x575858[_0x4856db(0x27f,0x1d4,0x163,0x1ce)](_0x421f37(0x1a1,0x10c,0x174,0x88));return;}else _0x56eb7f(new Error(_0x356302[_0x4856db(0x20b,0x1cb,0x1f3,0x1b2)]||_0x4a3bce[_0x421f37(-0xe,0x2c,0x18,0x38)]));}};eventSource['on'](eventNames[_0x5d4473(-0x10a,-0x1cd,-0x17c,-0x183)+_0x5d4473(-0x1f5,-0x25a,-0x1a5,-0x19f)+_0x1785e2(-0x2c4,-0x21b,-0x237,-0x16a)],_0x1e82ae);const _0x9321ae={};_0x9321ae[_0x1785e2(-0x1e1,-0x28b,-0x325,-0x2b3)]=_0x3aa5ba;function _0x5d4473(_0xacd8a4,_0x2b3753,_0x505083,_0x4e123b){return _0xff969f(_0xacd8a4-0x13d,_0xacd8a4,_0x505083-0x1bb,_0x505083- -0x62f);}_0x9321ae['id']=_0x2d5adb,eventSource[_0x1785e2(-0x174,-0x183,-0x113,-0x128)](eventNames[_0x1785e2(-0x2e7,-0x2a9,-0x31f,-0x309)+_0x5d4473(-0x127,-0xa5,-0x148,-0x1ef)+_0x5d4473(-0xfa,-0x18f,-0xe0,-0x124)],_0x9321ae),_0x5e3d1c=_0x4a3bce[_0x5d4473(-0x133,-0x152,-0x15b,-0xec)](setTimeout,()=>{_0x4a3bce[_0x51f284(0x487,0x511,0x5c0,0x5b5)](_0x1389e7);function _0x51f284(_0xce654e,_0x4be27c,_0x43226c,_0xda439){return _0x1785e2(_0xce654e-0x1aa,_0x4be27c-0x6c9,_0xce654e,_0xda439-0xd4);}function _0x323abe(_0x5b87be,_0x597146,_0x24fb5c,_0x2623d2){return _0x1785e2(_0x5b87be-0x142,_0x2623d2-0x71d,_0x24fb5c,_0x2623d2-0x70);}_0x4a3bce['mJfks'](_0x56eb7f,new Error(_0x4a3bce[_0x51f284(0x42b,0x400,0x476,0x3d3)]));},_0x56be50);});}function preprocessTagContent(_0x5bf3f4){const _0xca8855={};function _0x39caf8(_0x5673d2,_0x3fa52e,_0x16ea58,_0x1a02cd){return _0x1af9(_0x1a02cd- -0x12e,_0x16ea58);}_0xca8855['WPWfw']=_0x103cd0(0x22e,0x1dc,0x1b0,0x1f6),_0xca8855[_0x103cd0(0x25a,0x1a1,0x27e,0x1da)]=_0x103cd0(0x292,0x25a,0x213,0x25c);const _0x303c5e=_0xca8855;let _0x243217=_0x5bf3f4['replace'](/:/g,':')[_0x39caf8(0x113,0x176,0xdd,0xc7)](/\(/g,'（')[_0x103cd0(0x247,0x2d5,0x301,0x28c)](/\)/g,'）')[_0x39caf8(0xcc,0x28,0xe9,0xc7)](/,/g,',');_0x243217=_0x243217[_0x39caf8(0x173,0x100,0x6e,0xc7)](/下半身NSWebcam:/g,_0x303c5e['WPWfw']);function _0x103cd0(_0x22c56a,_0x1ed2d4,_0x23925a,_0x50f9e4){return _0x1af9(_0x50f9e4-0x97,_0x23925a);}return _0x243217=_0x243217[_0x39caf8(0x58,0x12c,0x111,0xc7)](/下半身NSFW_背面:/g,_0x303c5e[_0x39caf8(0xd2,0x84,0xc8,0x6f)]),_0x243217=_0x243217[_0x103cd0(0x2f7,0x333,0x30d,0x28c)](/上半身NSFW_背面:/g,_0x303c5e[_0x103cd0(0x194,0x277,0x1ae,0x1da)]),_0x243217;}function parseCharacterData(_0x460383){const _0x5b7105={'mdLBd':function(_0x46707f,_0x4fb2a4){return _0x46707f(_0x4fb2a4);},'yjhDp':_0x6a4998(0x60,0x104,-0x2b,0x68)+'时','JiPUA':_0x5af418(0x3bf,0x3ce,0x45b,0x3e9),'ZyVbt':'nameEN','pktke':_0x6a4998(-0x68,-0xb3,-0x35,-0xd)+'ures','ipolY':_0x6a4998(-0x11,-0x3e,-0x77,-0xd)+_0x5af418(0x4a2,0x56f,0x540,0x4e0),'rfmWX':_0x6a4998(-0x36,-0x70,0xc5,0x30)+'FW','LEhzS':_0x5af418(0x477,0x48a,0x488,0x455)+_0x6a4998(0x130,0x15d,0xd3,0x104),'tNAIE':'fullBodySF'+'W','MZCAf':'upperBodyN'+_0x6a4998(0x102,0x9e,0x2,0x83),'KGLpx':_0x5af418(0x47e,0x572,0x520,0x57f)+_0x5af418(0x3b5,0x463,0x457,0x4e7),'BdnAP':_0x6a4998(-0xa3,-0x10,0x75,-0x2)+'FW','XVUny':_0x5af418(0x501,0x3ac,0x456,0x501)+_0x5af418(0x59c,0x5e9,0x55c,0x5ed),'dpaqE':function(_0x169682,_0x58e75f){return _0x169682===_0x58e75f;},'YkApc':_0x6a4998(0xc1,0xe9,0xea,0x12f),'mMVpr':function(_0x248609,_0x4c5d14){return _0x248609+_0x4c5d14;},'FhlsC':function(_0x432fb6,_0x281193){return _0x432fb6&&_0x281193;},'MmUee':function(_0x8ba971,_0x42c382){return _0x8ba971!==_0x42c382;}};function _0x5af418(_0x4ac29e,_0x395bdd,_0x738fea,_0x516b78){return _0x1af9(_0x738fea-0x38c,_0x395bdd);}const _0x79d9cb=_0x460383[_0x5af418(0x4d1,0x47f,0x46d,0x4f1)]('\x0a')['map'](_0x3cc710=>_0x3cc710[_0x5af418(0x57a,0x45d,0x4d7,0x454)]())[_0x6a4998(0x102,0x114,0xcd,0x13e)](_0x15a39b=>_0x15a39b),_0x1379e6={};_0x1379e6[_0x5af418(0x3a8,0x438,0x45b,0x4ee)]='',_0x1379e6[_0x5af418(0x500,0x462,0x4fc,0x4b1)]='',_0x1379e6[_0x5af418(0x3fe,0x480,0x44b,0x4d5)+_0x5af418(0x4a5,0x44e,0x4d9,0x465)]='',_0x1379e6[_0x6a4998(-0x9a,0x55,-0x25,-0xd)+'uresBack']='',_0x1379e6[_0x5af418(0x48f,0x473,0x488,0x429)+'FW']='',_0x1379e6['upperBodyS'+_0x5af418(0x5b5,0x536,0x55c,0x4d3)]='',_0x1379e6[_0x6a4998(0xc7,0x14,0x12a,0xbb)+'W']='',_0x1379e6[_0x5af418(0x470,0x4d0,0x513,0x5bb)+_0x5af418(0x574,0x595,0x4e1,0x567)]='',_0x1379e6['upperBodyN'+_0x5af418(0x53d,0x47a,0x4db,0x559)]='',_0x1379e6[_0x5af418(0x5aa,0x5ac,0x520,0x58f)+_0x6a4998(0x50,-0x16,0x8f,-0x1)]='',_0x1379e6[_0x5af418(0x4a1,0x41c,0x456,0x44f)+'FW']='';function _0x6a4998(_0x1e16f9,_0xb81166,_0x842fc9,_0x657dbe){return _0x1af9(_0x657dbe- -0xcc,_0xb81166);}_0x1379e6[_0x6a4998(-0xae,0x2e,-0x23,-0x2)+_0x5af418(0x565,0x583,0x55c,0x5b9)]='';const _0x419e24=_0x1379e6,_0x3f831e={};_0x3f831e[_0x6a4998(0x6e,0xa3,0xea,0xd6)]=_0x5b7105[_0x5af418(0x53a,0x476,0x485,0x4f3)],_0x3f831e[_0x5af418(0x535,0x474,0x4d4,0x434)]=_0x5b7105['ZyVbt'],_0x3f831e[_0x5af418(0x40d,0x4fc,0x454,0x3f6)]=_0x5b7105['pktke'],_0x3f831e['五官外貌背面']=_0x5b7105['ipolY'],_0x3f831e[_0x6a4998(0x1d,0xba,0x90,0x3d)]=_0x5b7105['rfmWX'],_0x3f831e[_0x6a4998(0xd5,0xa8,0x83,0x45)]=_0x5b7105[_0x5af418(0x495,0x541,0x535,0x501)],_0x3f831e[_0x6a4998(0xe8,0x14c,0x8a,0xef)]=_0x5b7105[_0x6a4998(0x150,0x15b,0xc7,0x113)],_0x3f831e[_0x5af418(0x517,0x5cf,0x576,0x559)]=_0x6a4998(0x4d,0xc8,0x47,0xbb)+_0x5af418(0x444,0x459,0x4e1,0x47b),_0x3f831e[_0x6a4998(0xdf,0x1b8,0xcd,0x126)]=_0x5b7105[_0x6a4998(0x139,0xc0,0x108,0x153)],_0x3f831e['上半身NSFW背面']=_0x5b7105[_0x5af418(0x48c,0x42f,0x4d3,0x48f)],_0x3f831e[_0x5af418(0x53a,0x540,0x5a8,0x623)]=_0x5b7105['BdnAP'],_0x3f831e['下半身NSFW背面']=_0x5b7105[_0x6a4998(0xec,0xc3,0x41,0xf2)];const _0x4af797=_0x3f831e;for(const _0x57516d of _0x79d9cb){if(_0x5b7105[_0x5af418(0x5c9,0x517,0x536,0x529)](_0x5b7105[_0x5af418(0x437,0x514,0x4b2,0x44a)],_0x5b7105[_0x6a4998(0xcf,0x6b,0xc1,0x5a)])){const _0x1091d6=_0x57516d[_0x5af418(0x501,0x5fe,0x5ae,0x52c)](':');if(_0x5b7105[_0x6a4998(0x3f,0x50,0x124,0xde)](_0x1091d6,-(0x19ae+0x4a*-0x5+-0x183b)))continue;const _0x16fb36=_0x57516d[_0x5af418(0x507,0x4d7,0x4f2,0x4a9)](0xf*0x22d+-0x5e2*0x5+-0x339,_0x1091d6)[_0x6a4998(0xc9,0x106,0x69,0x7f)](),_0x35ea91=_0x57516d[_0x6a4998(0x82,0xef,0x138,0x9a)](_0x5b7105[_0x6a4998(0x13,-0x2d,0x5e,0x72)](_0x1091d6,-0x1aeb+0x16*0xe3+0x76a))[_0x5af418(0x455,0x46f,0x4d7,0x48b)]();if(_0x4af797[_0x16fb36])_0x419e24[_0x4af797[_0x16fb36]]=_0x35ea91;else _0x5b7105['FhlsC'](_0x16fb36,_0x35ea91)&&(_0x5b7105[_0x6a4998(-0x24,0xf1,-0x37,0x5f)](_0x6a4998(0xcc,-0xb,0xe2,0x8f),_0x6a4998(0x73,0x24,0x1,0x8f))?_0x302f79='data:image'+'/png;base6'+'4,'+_0x499836:console[_0x5af418(0x4f7,0x4b0,0x512,0x501)](_0x5af418(0x462,0x44b,0x4e2,0x46e)+_0x6a4998(0xed,0xbc,0x54,0x3a)+'fy]\x20未识别的人物'+_0x5af418(0x530,0x545,0x4b6,0x518)+_0x16fb36+'\x22'));}else _0x12cffd[_0x5af418(0x4b5,0x596,0x55a,0x4f6)+_0x5af418(0x479,0x511,0x494,0x414)](_0x3de0a4[_0x6a4998(0xe3,-0x62,0x32,0x31)+'ODIFY_GET_'+_0x5af418(0x4d4,0x54c,0x527,0x516)+_0x5af418(0x5da,0x4ec,0x598,0x5e8)],_0x1e74ef),_0x5b7105[_0x6a4998(0xc1,0x7f,-0x72,0x38)](_0x3ecf18,new _0x92450e(_0x5b7105[_0x6a4998(0xbd,0x8b,0x1e0,0x136)]));}if(!_0x419e24[_0x6a4998(0x6d,0x63,0x77,0x3)])return null;return console[_0x6a4998(0x44,0x137,0x2f,0xba)](_0x5af418(0x495,0x49a,0x4e2,0x481)+'PromptModi'+_0x5af418(0x3f6,0x4ee,0x46c,0x4d6)+_0x6a4998(0xf6,-0x23,0xd1,0x8e),_0x419e24),_0x419e24;}function extractCharacterTags(_0x30275f){const _0x2adf7b={'BxkXV':function(_0x53bac8,_0x379325){return _0x53bac8!==_0x379325;},'ZqHaw':function(_0x207725,_0x2b2d23){return _0x207725(_0x2b2d23);},'tQCkp':function(_0x2eee2b,_0xfd502e){return _0x2eee2b===_0xfd502e;},'ZEdst':_0x149d2c(0x56b,0x4b8,0x52a,0x53a)};function _0x149d2c(_0x517991,_0x2b0df6,_0x20af41,_0x50debe){return _0x1af9(_0x2b0df6-0x396,_0x20af41);}const _0x403bd4={};_0x403bd4[_0x2748f6(-0x2ba,-0x2cd,-0x1af,-0x256)]=[];const _0xd1c481=_0x403bd4;_0x30275f=_0x30275f[_0x2748f6(-0x1c7,-0xcd,-0x151,-0x148)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x149d2c(0x507,0x4e1,0x503,0x593)]();const _0x18a9f0=/<人物>([\s\S]*?)<\/人物>/g;let _0x1e45b7;function _0x2748f6(_0x4413a2,_0x25995d,_0x3ee04e,_0x2063e0){return _0x1af9(_0x2063e0- -0x33d,_0x25995d);}while(_0x2adf7b[_0x149d2c(0x513,0x59b,0x586,0x4e6)](_0x1e45b7=_0x18a9f0[_0x149d2c(0x590,0x562,0x56d,0x5f8)](_0x30275f),null)){const _0x446c7a=_0x2adf7b[_0x2748f6(-0x126,-0x25d,-0x1ed,-0x1b3)](preprocessTagContent,_0x1e45b7[-0x1f5+0x1550+-0x135a]),_0x147617=parseCharacterData(_0x446c7a);_0x147617&&(_0x2adf7b[_0x149d2c(0x491,0x4d8,0x4a0,0x508)](_0x2adf7b[_0x149d2c(0x526,0x4f3,0x50b,0x47f)],_0x2adf7b[_0x149d2c(0x468,0x4f3,0x475,0x56b)])?_0xd1c481[_0x2748f6(-0x1e5,-0x212,-0x1e9,-0x256)][_0x149d2c(0x48a,0x536,0x590,0x4b3)](_0x147617):_0x19ff33['characters'][_0x2748f6(-0x170,-0x126,-0x185,-0x19d)](_0x17b4b4));}return _0xd1c481;}function getCurrentCharacterPreset(){const _0x54157e=extension_settings[extensionName];function _0x3ea93b(_0x396bc7,_0x47d004,_0x3dbbee,_0x5eea3f){return _0x1af9(_0x396bc7-0xa0,_0x5eea3f);}const _0x1ac068=_0x54157e['characterP'+'resetId'];if(!_0x1ac068||!_0x54157e[_0x1a336d(-0x1db,-0x1c1,-0x258,-0x1d3)+_0x1a336d(-0x29e,-0x290,-0x327,-0x2d2)][_0x1ac068])return null;function _0x1a336d(_0x4eddb9,_0x29b8e8,_0x5e92d0,_0x2268d8){return _0x1af9(_0x4eddb9- -0x36a,_0x29b8e8);}const _0x3a82c7={};return _0x3a82c7['id']=_0x1ac068,_0x3a82c7[_0x1a336d(-0x1e8,-0x23e,-0x16e,-0x14d)]=_0x54157e['characterP'+_0x1a336d(-0x29e,-0x232,-0x2e0,-0x2de)][_0x1ac068],_0x3a82c7;}function buildCharacterText(_0x51cdaa){const _0x21ce35={};_0x21ce35[_0x93505f(0x4d0,0x48c,0x464,0x47d)]=_0x93505f(0x4a8,0x4ee,0x472,0x574),_0x21ce35['amtJk']='</人物>';const _0x824388=_0x21ce35,_0x159c80=_0x51cdaa['data'];let _0x32a62e=_0x824388[_0x282d24(0x2dc,0x2c9,0x386,0x2b5)];_0x32a62e+='中文名称:\x20'+(_0x159c80[_0x93505f(0x487,0x411,0x46e,0x445)]||'')+'\x0a',_0x32a62e+=_0x93505f(0x45d,0x477,0x4c3,0x407)+(_0x159c80['nameEN']||'')+'\x0a',_0x32a62e+=_0x282d24(0x30c,0x3bc,0x2ce,0x3a4)+(_0x159c80[_0x93505f(0x424,0x401,0x35c,0x3b0)+_0x93505f(0x40d,0x48f,0x53f,0x512)]||'')+'\x0a',_0x32a62e+=_0x93505f(0x444,0x425,0x37c,0x3d9)+(_0x159c80[_0x93505f(0x37b,0x401,0x393,0x380)+_0x93505f(0x4ad,0x4f6,0x49e,0x53e)]||'')+'\x0a';function _0x93505f(_0x37c8c6,_0x1f8526,_0x2d886a,_0xdf9a64){return _0x1af9(_0x1f8526-0x342,_0xdf9a64);}_0x32a62e+=_0x93505f(0x4f0,0x4a3,0x521,0x4e0)+(_0x159c80[_0x282d24(0x28e,0x2e9,0x28a,0x273)+'FW']||'')+'\x0a',_0x32a62e+='上半身SFW背面:\x20'+(_0x159c80[_0x93505f(0x406,0x43e,0x3bc,0x3a1)+_0x282d24(0x362,0x3f1,0x2d0,0x3d5)]||'')+'\x0a',_0x32a62e+=_0x282d24(0x265,0x208,0x285,0x25e)+(_0x159c80[_0x282d24(0x319,0x309,0x2de,0x2b0)+'W']||'')+'\x0a';function _0x282d24(_0x4e1f24,_0x4b7148,_0x17b54b,_0x2eb142){return _0x1af9(_0x4e1f24-0x192,_0x4b7148);}return _0x32a62e+=_0x93505f(0x48e,0x488,0x45a,0x41d)+(_0x159c80['fullBodySF'+_0x282d24(0x2e7,0x302,0x2c3,0x2eb)]||'')+'\x0a',_0x32a62e+=_0x93505f(0x407,0x438,0x3ee,0x406)+(_0x159c80[_0x93505f(0x555,0x4d6,0x578,0x4ff)+_0x93505f(0x4fc,0x491,0x500,0x3ff)]||'')+'\x0a',_0x32a62e+='上半身NSFW背面:'+'\x20'+(_0x159c80[_0x282d24(0x326,0x3a2,0x2ef,0x2eb)+_0x93505f(0x404,0x40d,0x48e,0x458)]||'')+'\x0a',_0x32a62e+=_0x282d24(0x282,0x319,0x294,0x2ae)+(_0x159c80['fullBodyNS'+'FW']||'')+'\x0a',_0x32a62e+=_0x282d24(0x2f1,0x249,0x2fd,0x2ed)+'\x20'+(_0x159c80[_0x282d24(0x25c,0x2e5,0x23c,0x205)+'FWBack']||'')+'\x0a',_0x32a62e+=_0x824388[_0x282d24(0x2fc,0x2ba,0x279,0x350)],_0x32a62e;}export async function handleCharacterPromptModify(_0x47967f,_0x39bd9d=[]){function _0x3d3342(_0x4e08c2,_0x2b1d26,_0xd013c0,_0x1a16ea){return _0x1af9(_0x1a16ea- -0x37d,_0xd013c0);}const _0xf44de1={'sxNia':function(_0x37184f,_0x22bbc9){return _0x37184f(_0x22bbc9);},'VYxhv':_0x3d3342(-0x283,-0x273,-0x1b9,-0x249)+'时','fbRSC':function(_0x42aff9){return _0x42aff9();},'eOuBS':function(_0x54f2f5,_0xaa56aa,_0x18a8c5){return _0x54f2f5(_0xaa56aa,_0x18a8c5);},'KlNLW':function(_0x1fcfd7,_0x5aaf6f){return _0x1fcfd7!==_0x5aaf6f;},'TCTYf':function(_0x1063ff){return _0x1063ff();},'lDmcf':function(_0x26df3f,_0x233b37){return _0x26df3f(_0x233b37);},'AfwXy':function(_0x2c98e3){return _0x2c98e3();},'yfNtU':_0x3d3342(-0x27d,-0x217,-0x25f,-0x247),'mIIJp':_0x26c81b(0x24f,0x1af,0x24c,0x2be)+_0x3d3342(-0x1fb,-0x326,-0x2c1,-0x277)+_0x3d3342(-0x266,-0x270,-0x227,-0x24a)+'t\x20preset:','IfrKZ':_0x3d3342(-0x258,-0x2d5,-0x2dc,-0x227)+'PromptModi'+'fy]\x20Saved\x20'+_0x3d3342(-0x205,-0x30b,-0x2d3,-0x2b6),'GlsVO':_0x26c81b(0x24f,0x208,0x2cd,0x1f8)+'PromptModi'+_0x26c81b(0x2d2,0x331,0x326,0x2fa)+_0x26c81b(0x2e6,0x25b,0x291,0x29c)+':','Dhclh':_0x3d3342(-0x298,-0x1fb,-0x28a,-0x227)+_0x3d3342(-0x315,-0x22a,-0x24c,-0x277)+'fy]\x20Saved\x20'+_0x26c81b(0x1fc,0x244,0x187,0x2a9),'cFFZz':function(_0x31cb90,_0x8c6ac){return _0x31cb90||_0x8c6ac;},'sRqDu':_0x3d3342(-0x1a0,-0x224,-0x17b,-0x1cc),'wWdBN':_0x26c81b(0x291,0x2b2,0x27e,0x26a),'hHcgj':_0x3d3342(-0x28c,-0x195,-0x2d7,-0x227)+_0x26c81b(0x1ff,0x2a1,0x1bd,0x264)+_0x26c81b(0x2dc,0x2ed,0x2c1,0x28f)+_0x3d3342(-0x288,-0x2ff,-0x2fb,-0x2bd)+_0x3d3342(-0x273,-0x1f0,-0x1e8,-0x24e),'scioQ':_0x3d3342(-0x15a,-0x21a,-0x17d,-0x1f8)+'y','QcuQX':function(_0x7bb6c5){return _0x7bb6c5();},'vJTPm':_0x3d3342(-0x1f6,-0x2c2,-0x276,-0x227)+_0x3d3342(-0x1cb,-0x279,-0x2c4,-0x277)+_0x3d3342(-0x194,-0x24a,-0x1e6,-0x19a)+'ter\x20list\x20t'+_0x3d3342(-0x178,-0x1d7,-0x136,-0x1c7)+_0x3d3342(-0x1d3,-0x19c,-0x157,-0x15f),'vSepX':'[character'+_0x3d3342(-0x262,-0x322,-0x27c,-0x277)+_0x26c81b(0x252,0x2ce,0x26b,0x203)+'后:','GGfSU':function(_0x9cc40,_0x28710c,_0x16826a){return _0x9cc40(_0x28710c,_0x16826a);},'arceJ':'{{用户需求}}','GVGeh':_0x26c81b(0x24f,0x301,0x271,0x2b0)+_0x3d3342(-0x207,-0x322,-0x261,-0x277)+'fy]\x20User\x20r'+'equirement'+_0x3d3342(-0x256,-0x1d1,-0x1fb,-0x1cf)+_0x26c81b(0x290,0x26c,0x23e,0x20e),'okUdP':function(_0x54bee9,_0x24bd3f,_0x1b6c21,_0x567024,_0x3563bd){return _0x54bee9(_0x24bd3f,_0x1b6c21,_0x567024,_0x3563bd);},'CpdpG':_0x3d3342(-0x1ec,-0x275,-0x221,-0x227)+_0x26c81b(0x1ff,0x2a9,0x257,0x289)+_0x26c81b(0x2c1,0x311,0x358,0x34d)+_0x3d3342(-0x272,-0x272,-0x137,-0x1e3),'CpxPg':function(_0x5e1de4,_0x32c111){return _0x5e1de4>_0x32c111;},'vgKDp':function(_0x334c2b,_0x402fce){return _0x334c2b===_0x402fce;},'ZyDRU':_0x26c81b(0x1fe,0x26a,0x1d1,0x21c),'rgRSA':function(_0x114264,_0x36ad6e){return _0x114264!==_0x36ad6e;},'vbYBD':_0x3d3342(-0x144,-0x225,-0x15b,-0x1eb),'bRuMc':function(_0x321f11,_0x372c3b,_0x3afb2f,_0x12f50d,_0x7e87f1){return _0x321f11(_0x372c3b,_0x3afb2f,_0x12f50d,_0x7e87f1);},'jdDis':_0x26c81b(0x206,0x289,0x250,0x206),'xYaiG':_0x3d3342(-0x175,-0x199,-0x2b2,-0x227)+_0x3d3342(-0x2c0,-0x317,-0x232,-0x277)+_0x26c81b(0x2e8,0x2ce,0x379,0x24a)+'ed','EZTvD':_0x3d3342(-0x1d1,-0x1b8,-0x21f,-0x218)+'message\x20at'+_0x26c81b(0x2dd,0x264,0x35f,0x2ff),'WFuVP':function(_0x5125c6,_0x5a4167,_0x2da4bc){return _0x5125c6(_0x5a4167,_0x2da4bc);},'DQhdD':function(_0x353725,_0x5564b2,_0x5a1656){return _0x353725(_0x5564b2,_0x5a1656);},'hQqAZ':_0x3d3342(-0x10e,-0x122,-0x14e,-0x18d),'ClHPA':function(_0x3b5b34,_0x3c69aa){return _0x3b5b34(_0x3c69aa);},'tTMmC':function(_0x55726a,_0x3a1f46){return _0x55726a===_0x3a1f46;},'XazyR':_0x3d3342(-0x201,-0x1e6,-0x28c,-0x22f),'ffLLh':'[character'+_0x3d3342(-0x222,-0x2c5,-0x2c0,-0x277)+_0x26c81b(0x216,0x26d,0x1a3,0x263)+'racter\x20tag'+'s\x20found\x20in'+'\x20output','jBUGj':function(_0x2347de,_0x5c04c5,_0x179752){return _0x2347de(_0x5c04c5,_0x179752);},'ogGhr':_0x3d3342(-0x208,-0x157,-0x219,-0x206)};console[_0x3d3342(-0x194,-0x22a,-0x266,-0x1f7)](_0x26c81b(0x24f,0x2e1,0x2a5,0x221)+'PromptModi'+_0x3d3342(-0x1cf,-0x213,-0x2af,-0x21f)+_0x26c81b(0x2cc,0x32f,0x360,0x26f)+_0x26c81b(0x281,0x20e,0x285,0x2c3)+'modify\x20req'+_0x26c81b(0x2cf,0x231,0x31a,0x332));function _0x26c81b(_0xb36252,_0x59d866,_0x58f1d8,_0x4ea4d6){return _0x1af9(_0xb36252-0xf9,_0x4ea4d6);}toastr[_0x26c81b(0x1ed,0x15f,0x238,0x23a)](_0x26c81b(0x24f,0x2a4,0x1cb,0x276)+_0x26c81b(0x1ff,0x29e,0x213,0x15a)+_0x3d3342(-0x1fc,-0x1bf,-0x174,-0x1dc)+'提示词修改请求...');try{const _0xa3f5fb=getContext(),_0x5a6e81=extension_settings[extensionName],_0x548e1b=_0xf44de1[_0x26c81b(0x225,0x27b,0x2a0,0x27d)](getCurrentCharacterPreset);if(!_0x548e1b){toastr['error'](_0xf44de1[_0x3d3342(-0x221,-0x1b6,-0x16e,-0x1de)]);return;}console[_0x26c81b(0x27f,0x211,0x28e,0x324)](_0xf44de1[_0x26c81b(0x2fd,0x316,0x2dc,0x34d)],_0x548e1b['id']);const _0x14c4e1=_0x548e1b[_0x26c81b(0x27b,0x2b8,0x242,0x313)][_0x3d3342(-0x2e3,-0x20e,-0x1b9,-0x266)+_0x3d3342(-0x19f,-0x248,-0x254,-0x1ff)]||'',_0x562303=_0x548e1b[_0x26c81b(0x27b,0x1f3,0x21c,0x2b3)]['generation'+_0x3d3342(-0x1ec,-0x283,-0x238,-0x23d)]||'',_0x141b5b=_0x548e1b[_0x3d3342(-0x288,-0x2ad,-0x159,-0x1fb)][_0x3d3342(-0x288,-0x305,-0x31a,-0x266)+_0x26c81b(0x265,0x228,0x277,0x1f6)]||{};console['log'](_0xf44de1[_0x3d3342(-0x178,-0x1d7,-0x234,-0x1b7)],_0x14c4e1),console['log'](_0xf44de1[_0x26c81b(0x1dd,0x18d,0x1af,0x175)],_0x562303),console[_0x3d3342(-0x197,-0x171,-0x255,-0x1f7)](_0xf44de1[_0x3d3342(-0x18e,-0x259,-0x148,-0x1f9)],_0x141b5b);const _0x28987a=_0xf44de1['cFFZz'](_0x47967f,''),_0x48ee82=[];if(_0x47967f){if(_0xf44de1[_0x3d3342(-0x21f,-0x225,-0x244,-0x216)](_0xf44de1[_0x26c81b(0x313,0x330,0x3ab,0x316)],_0xf44de1[_0x3d3342(-0x19e,-0x247,-0x200,-0x1df)]))_0x48ee82[_0x3d3342(-0x208,-0x157,-0x1f2,-0x1dd)](_0x47967f);else{const _0x13b8f6=_0xf44de1[_0x26c81b(0x307,0x26c,0x349,0x254)](_0x2e9f58);_0x496926[_0x3d3342(-0x272,-0x235,-0x23d,-0x1f7)](_0x3d3342(-0x1ea,-0x253,-0x1e3,-0x227)+_0x3d3342(-0x2ed,-0x2e6,-0x2e4,-0x277)+'fy]\x20Reques'+_0x26c81b(0x2df,0x2ae,0x374,0x243)+_0x3d3342(-0x25a,-0x2f7,-0x262,-0x2ad)+_0x3d3342(-0x254,-0x337,-0x319,-0x297)+_0x13b8f6+')');const _0x5ef18f=_0x533d3c=>{function _0x20486d(_0x29f3f7,_0x2eaa0e,_0x34ecaf,_0x4080e0){return _0x26c81b(_0x29f3f7- -0x8e,_0x2eaa0e-0x4f,_0x34ecaf-0xf7,_0x2eaa0e);}if(_0x533d3c['id']!==_0x13b8f6)return;function _0x48231f(_0x70bf80,_0x54a23b,_0x514765,_0x397160){return _0x26c81b(_0x54a23b- -0x45e,_0x54a23b-0x8,_0x514765-0x137,_0x514765);}_0x18e1b2[_0x48231f(-0x136,-0x197,-0x107,-0x1c3)+_0x48231f(-0x2c5,-0x25d,-0x1c4,-0x24c)](_0x2090e0['LLM_CHAR_M'+'ODIFY_GET_'+_0x20486d(0x206,0x22f,0x207,0x1a0)+_0x48231f(-0x194,-0x159,-0x103,-0x1d0)],_0x5ef18f),_0xf44de1[_0x48231f(-0x1f0,-0x213,-0x1fc,-0x225)](_0x50b98a,_0x533d3c[_0x20486d(0x186,0x136,0x13e,0x1da)]);};_0x4a679f['on'](_0x12bb34['LLM_CHAR_M'+'ODIFY_GET_'+'PROMPT_RES'+_0x26c81b(0x305,0x37d,0x3b0,0x2ac)],_0x5ef18f);const _0x1ae0cf={};_0x1ae0cf['id']=_0x13b8f6,_0x19574a[_0x3d3342(-0xc9,-0x110,-0x1a8,-0x15a)](_0x2d636f[_0x26c81b(0x1f6,0x265,0x194,0x1ab)+_0x26c81b(0x2a9,0x275,0x278,0x230)+_0x3d3342(-0x261,-0x162,-0x229,-0x1bc)+_0x3d3342(-0x142,-0x15b,-0x1a8,-0x1c3)],_0x1ae0cf),_0xf44de1['eOuBS'](_0x3f1105,()=>{function _0x5d8eb7(_0x4b052b,_0x5cff86,_0x2918ad,_0x518e51){return _0x3d3342(_0x4b052b-0xa0,_0x5cff86-0x15f,_0x2918ad,_0x4b052b-0x3f3);}function _0x11174e(_0x18e97b,_0x160632,_0x57cb57,_0x29a58d){return _0x26c81b(_0x57cb57- -0xe5,_0x160632-0x8c,_0x57cb57-0xee,_0x18e97b);}_0x4e6096[_0x5d8eb7(0x244,0x2b8,0x256,0x1bb)+_0x5d8eb7(0x17e,0x202,0xcf,0x16e)](_0x140bee[_0x11174e(0x1a9,0xb4,0x111,0x7b)+_0x11174e(0x19d,0x244,0x1c4,0x1bb)+_0x5d8eb7(0x211,0x218,0x1f7,0x1f8)+_0x5d8eb7(0x282,0x2fd,0x206,0x2c9)],_0x5ef18f),_0xf44de1[_0x5d8eb7(0x1c8,0x184,0x14a,0x229)](_0x21124b,new _0x595a10(_0xf44de1[_0x11174e(0x6a,0x15c,0x10e,0x1b3)]));},0xdf*-0x41+0x501+0x5aae);}}_0x14c4e1&&_0x48ee82[_0x3d3342(-0x250,-0x200,-0x217,-0x1dd)](_0x14c4e1);_0x562303&&_0x48ee82[_0x26c81b(0x299,0x1f9,0x33f,0x255)](_0x562303);const _0x6d3eb3=_0x48ee82[_0x3d3342(-0x276,-0x213,-0x354,-0x2a1)]('\x0a');console[_0x3d3342(-0x29b,-0x208,-0x21f,-0x1f7)](_0xf44de1[_0x3d3342(-0x276,-0x28b,-0x340,-0x2b7)],_0x6d3eb3);let _0x11fbc7=_0xf44de1[_0x3d3342(-0x18e,-0x1f0,-0x1a5,-0x19b)](buildPromptForRequestType,_0xf44de1[_0x3d3342(-0x328,-0x2ce,-0x2a8,-0x295)],_0x28987a);const _0x4d1ac4=_0xf44de1['lDmcf'](generateCharacterListText,_0x6d3eb3),_0x2fbf6b=_0xf44de1[_0x26c81b(0x21c,0x17f,0x263,0x295)](generateOutfitEnableListText),_0x3b7a0c=_0xf44de1[_0x3d3342(-0x1e5,-0x2c3,-0x2d8,-0x251)](generateCommonCharacterListText);console[_0x26c81b(0x27f,0x2bf,0x2de,0x214)](_0xf44de1['vJTPm'],_0x4d1ac4);const _0x59071d=_0xa3f5fb['chatMetada'+'ta']?.[_0x26c81b(0x27a,0x20e,0x308,0x2be)]||{},_0x18a70f=buildCharacterText(_0x548e1b);_0x11fbc7=mergeAdjacentMessages(_0x11fbc7),console[_0x3d3342(-0x199,-0x18d,-0x271,-0x1f7)](_0xf44de1[_0x3d3342(-0x25d,-0x2c6,-0x2e1,-0x25e)],_0x11fbc7);const _0x15ee51=_0xf44de1['GGfSU'](findMessageIndexWithPlaceholder,_0x11fbc7,_0xf44de1[_0x26c81b(0x312,0x34a,0x2e3,0x298)]);console['log'](_0xf44de1[_0x3d3342(-0x1c9,-0x151,-0x212,-0x1fe)],_0x15ee51);const _0x39729b={..._0x141b5b,..._0x59071d},_0xa3427a={};_0xa3427a[_0x26c81b(0x211,0x290,0x1eb,0x258)]=_0x14c4e1,_0xa3427a[_0x26c81b(0x1ba,0x124,0x109,0x17f)+_0x3d3342(-0x26d,-0x1e9,-0x1fb,-0x23e)]=_0x562303,_0xa3427a[_0x26c81b(0x27a,0x244,0x209,0x1f4)]=_0x39729b,_0xa3427a[_0x3d3342(-0xee,-0x1d5,-0x20b,-0x195)]=_0x47967f||'',_0xa3427a[_0x26c81b(0x285,0x284,0x1d0,0x2ac)+'istText']=_0x4d1ac4,_0xa3427a[_0x26c81b(0x2b1,0x358,0x321,0x23b)+'leListText']=_0x2fbf6b,_0xa3427a['commonChar'+_0x26c81b(0x2f3,0x32c,0x2d8,0x3a4)+_0x3d3342(-0x303,-0x244,-0x247,-0x263)]=_0x3b7a0c;const _0x4491ad=_0xa3427a,{messages:_0x1cfdc3,replacedVariables:_0x5ac408}=_0xf44de1[_0x26c81b(0x2db,0x307,0x293,0x22c)](replaceAllPlaceholders,_0x11fbc7,_0x4491ad);_0x11fbc7=_0x1cfdc3,_0x11fbc7=_0xf44de1[_0x3d3342(-0x2ce,-0x2c0,-0x213,-0x298)](_0x52855d,_0x11fbc7,_0x3d3342(-0x174,-0x232,-0x299,-0x1e8),_0x18a70f,_0x5ac408),console[_0x26c81b(0x27f,0x1ca,0x20e,0x2c9)](_0xf44de1[_0x3d3342(-0x173,-0x182,-0x187,-0x219)],_0x11fbc7);let _0x218edd='';if(_0xf44de1[_0x26c81b(0x261,0x203,0x2ba,0x2f0)](_0x5ac408[_0x3d3342(-0x1b0,-0x136,-0x126,-0x185)],0xb5d*-0x2+-0xa7*-0x2a+-0x1a*0x2e)){if(_0xf44de1['vgKDp'](_0x3d3342(-0x2e2,-0x314,-0x327,-0x278),_0xf44de1[_0x3d3342(-0x1c0,-0x26f,-0x1c4,-0x267)]))_0x218edd=_0x26c81b(0x2a8,0x22f,0x354,0x333)+'被使用：'+[..._0x5ac408][_0x3d3342(-0x24e,-0x32b,-0x2ad,-0x2a1)]('、')+'\x0a';else{const _0x36494e=_0x28246d[_0x3d3342(-0x1fc,-0x1b2,-0x193,-0x1fb)];let _0x412bf5=_0x3d3342(-0x16b,-0x11d,-0x1fc,-0x1d1);return _0x412bf5+=_0x26c81b(0x1b7,0x256,0x1df,0x262)+(_0x36494e[_0x26c81b(0x1c8,0x118,0x1be,0x1a5)]||'')+'\x0a',_0x412bf5+=_0x26c81b(0x22e,0x25a,0x1f1,0x27c)+(_0x36494e['nameEN']||'')+'\x0a',_0x412bf5+=_0x3d3342(-0x23b,-0x283,-0x286,-0x203)+(_0x36494e[_0x26c81b(0x1b8,0x247,0x1ed,0x209)+_0x26c81b(0x246,0x2fb,0x234,0x232)]||'')+'\x0a',_0x412bf5+=_0x3d3342(-0x29a,-0x2d7,-0x21b,-0x29a)+(_0x36494e[_0x3d3342(-0x333,-0x337,-0x358,-0x2be)+_0x3d3342(-0x148,-0x1f1,-0x1ab,-0x1c9)]||'')+'\x0a',_0x412bf5+=_0x26c81b(0x25a,0x291,0x2ab,0x2c6)+(_0x36494e[_0x3d3342(-0x200,-0x254,-0x2ab,-0x281)+'FW']||'')+'\x0a',_0x412bf5+='上半身SFW背面:\x20'+(_0x36494e[_0x3d3342(-0x261,-0x1fb,-0x234,-0x281)+_0x26c81b(0x2c9,0x2b9,0x32c,0x338)]||'')+'\x0a',_0x412bf5+='下半身SFW:\x20'+(_0x36494e[_0x26c81b(0x280,0x2de,0x2c7,0x2d2)+'W']||'')+'\x0a',_0x412bf5+='下半身SFW背面:\x20'+(_0x36494e[_0x3d3342(-0x209,-0x25c,-0x1bb,-0x1f6)+_0x3d3342(-0x28a,-0x1b0,-0x27e,-0x228)]||'')+'\x0a',_0x412bf5+=_0x3d3342(-0x1da,-0x2b5,-0x2a9,-0x287)+(_0x36494e['upperBodyN'+'SFW']||'')+'\x0a',_0x412bf5+='上半身NSFW背面:'+'\x20'+(_0x36494e[_0x26c81b(0x28d,0x231,0x33b,0x25f)+_0x3d3342(-0x228,-0x2f8,-0x2de,-0x2b2)]||'')+'\x0a',_0x412bf5+='下半身NSFW:\x20'+(_0x36494e['fullBodyNS'+'FW']||'')+'\x0a',_0x412bf5+=_0x3d3342(-0x213,-0x171,-0x19c,-0x21e)+'\x20'+(_0x36494e[_0x3d3342(-0x29e,-0x362,-0x216,-0x2b3)+_0x3d3342(-0x25e,-0xfa,-0x1e1,-0x1ad)]||'')+'\x0a',_0x412bf5+='</人物>',_0x412bf5;}}if(_0x39bd9d&&_0xf44de1['CpxPg'](_0x39bd9d[_0x26c81b(0x2f6,0x285,0x308,0x342)],-0x2*-0xa1+-0x1e5b+-0x9b3*-0x3)&&_0x15ee51>=-0x99f+0x1*0xa2c+-0x8d){if(_0xf44de1[_0x26c81b(0x2f5,0x241,0x255,0x30f)](_0xf44de1[_0x3d3342(-0x19c,-0x1db,-0x1cb,-0x1b6)],_0x26c81b(0x28b,0x240,0x1e2,0x25f))){if(_0xf44de1['KlNLW'](_0x5802f4['id'],_0x14b212))return;_0xf44de1[_0x26c81b(0x310,0x2d2,0x2b9,0x2d9)](_0x2d8114),_0x2fbe9f[_0x3d3342(-0x191,-0x2b8,-0x1d7,-0x226)]?_0xf44de1[_0x3d3342(-0x2bc,-0x2c7,-0x1c2,-0x26b)](_0x157be1,_0x593906[_0x3d3342(-0x235,-0x24f,-0x1fd,-0x254)]):_0x27ac3c(new _0x4d27a1(_0x59a8fd[_0x26c81b(0x222,0x1f4,0x1b4,0x27e)]||_0x3d3342(-0x161,-0x103,-0x1dd,-0x189)));}else _0x11fbc7=_0xf44de1[_0x26c81b(0x2cd,0x251,0x378,0x281)](attachImagesToMessage,_0x11fbc7,_0x15ee51,_0x39bd9d,_0xf44de1[_0x26c81b(0x2e2,0x2f2,0x246,0x2ca)]),console['log'](_0xf44de1[_0x3d3342(-0x1f4,-0x136,-0x12a,-0x1b3)],_0x39bd9d['length'],_0xf44de1['EZTvD'],_0x15ee51);}_0xf44de1[_0x26c81b(0x30a,0x273,0x31a,0x37a)](updateCombinedPrompt,_0x11fbc7,_0x218edd);const _0x1ba647={};_0x1ba647[_0x3d3342(-0x1fe,-0x209,-0x2f3,-0x24d)]=0x493e0;const _0x4712f4=await _0xf44de1[_0x3d3342(-0x261,-0x278,-0x1f2,-0x271)](LLM_CHAR_MODIFY,_0x11fbc7,_0x1ba647);console['log'](_0x3d3342(-0x265,-0x2a8,-0x289,-0x227)+_0x3d3342(-0x285,-0x273,-0x210,-0x277)+_0x3d3342(-0x2a9,-0x1b7,-0x2a8,-0x25c)+_0x3d3342(-0x15d,-0x245,-0x1a2,-0x1d0),_0x4712f4);if(!_0x4712f4){toastr[_0x26c81b(0x22b,0x250,0x17f,0x265)](_0xf44de1['hQqAZ']);return;}const _0x38d0e9=_0xf44de1[_0x26c81b(0x2b9,0x260,0x2ba,0x26f)](extractCharacterTags,_0x4712f4);if(_0xf44de1[_0x3d3342(-0x2c3,-0x32b,-0x241,-0x2af)](_0x38d0e9[_0x3d3342(-0x28d,-0x332,-0x29a,-0x296)][_0x3d3342(-0x187,-0x17a,-0x1d5,-0x180)],0x2686+-0xf3*0x1+-0x1*0x2593)){if(_0x26c81b(0x247,0x1a2,0x2df,0x2d5)!==_0xf44de1[_0x3d3342(-0x253,-0x1cd,-0x1b5,-0x1d8)])_0x2be009(_0xdbedf1);else{toastr[_0x26c81b(0x1d4,0x15c,0x216,0x16e)]('未在\x20LLM\x20输出中'+_0x3d3342(-0xf8,-0xe8,-0xca,-0x175)),console['log'](_0xf44de1[_0x26c81b(0x1c2,0x1d5,0x17d,0x26c)]),console[_0x3d3342(-0x222,-0x18e,-0x1f4,-0x1f7)](_0x3d3342(-0x299,-0x29d,-0x28f,-0x227)+_0x26c81b(0x1ff,0x1a1,0x221,0x26d)+_0x3d3342(-0x18b,-0x12c,-0x19f,-0x192)+_0x26c81b(0x314,0x33f,0x29f,0x2e3)+_0x26c81b(0x1cb,0x216,0x17b,0x1f0)+'ng:',_0x4712f4);return;}}console[_0x26c81b(0x27f,0x2bf,0x2b3,0x202)](_0x26c81b(0x24f,0x275,0x2f1,0x2ac)+_0x26c81b(0x1ff,0x22d,0x273,0x1e1)+_0x3d3342(-0x242,-0x259,-0x21a,-0x1cb)+_0x26c81b(0x2ca,0x2b4,0x35f,0x2bf),_0x38d0e9);const _0x4bd1ed=_0x38d0e9['characters'][0x1*-0x1606+-0x1655+0x2c5b];await _0xf44de1[_0x26c81b(0x274,0x203,0x2c7,0x283)](updateCharacterPresetFromLLM,_0x548e1b['id'],_0x4bd1ed),toastr[_0x26c81b(0x250,0x1e8,0x296,0x24b)](_0xf44de1[_0x26c81b(0x2ef,0x36e,0x372,0x24a)]);}catch(_0x1c4e4a){console['error'](_0x26c81b(0x24f,0x2d2,0x253,0x1ce)+_0x3d3342(-0x1db,-0x32a,-0x2a8,-0x277)+_0x26c81b(0x2ea,0x2b7,0x38d,0x248),_0x1c4e4a),toastr[_0x26c81b(0x22b,0x1bb,0x24b,0x259)](_0x26c81b(0x1cf,0x12b,0x21d,0x1e9)+'\x20'+_0x1c4e4a[_0x3d3342(-0x164,-0x185,-0x298,-0x208)]);}}async function updateCharacterPresetFromLLM(_0x317ff8,_0x219d6a){const _0x1ec690={'OMVQB':_0x4682a1(0x55c,0x512,0x51c,0x589),'axriR':'nameCN','VowZP':_0x2435c3(0x408,0x45c,0x4a3,0x4d2)+_0x4682a1(0x508,0x548,0x494,0x4c4),'DUMvX':_0x4682a1(0x3c7,0x405,0x46f,0x473)+'FW','Undjo':_0x2435c3(0x547,0x499,0x48c,0x45f)+'FWBack','uhKSH':_0x2435c3(0x5d4,0x524,0x509,0x53b)+'W','GGbnc':_0x2435c3(0x5b4,0x524,0x509,0x579)+_0x4682a1(0x448,0x526,0x4bd,0x4cc),'SFEwJ':_0x2435c3(0x4fd,0x531,0x55d,0x580)+_0x2435c3(0x504,0x468,0x444,0x433),'keKld':_0x2435c3(0x402,0x467,0x414,0x401)+_0x2435c3(0x583,0x56d,0x4fa,0x590),'OnMXS':function(_0x138a8d,_0x497158){return _0x138a8d(_0x497158);},'nEdFY':function(_0x111b6c,_0x207e7b){return _0x111b6c===_0x207e7b;},'DCvRn':_0x4682a1(0x5b7,0x514,0x500,0x577),'kPpqS':_0x4682a1(0x5eb,0x62a,0x614,0x59c),'bCars':_0x4682a1(0x4fa,0x587,0x5b8,0x536),'FEZZz':_0x4682a1(0x4b9,0x558,0x52b,0x519),'IDSWq':_0x2435c3(0x449,0x4e5,0x4fd,0x57a),'MEWxn':_0x4682a1(0x4c3,0x4c1,0x43d,0x43f),'jdlgZ':'五官外貌背面','FbJtz':_0x2435c3(0x4af,0x4a6,0x41d,0x4f2),'fDdfY':'下半身SFW','otlJb':_0x2435c3(0x4d9,0x587,0x568,0x5ad),'PVYCz':_0x4682a1(0x570,0x5d5,0x511,0x569),'RWcHu':_0x4682a1(0x4e5,0x547,0x4ce,0x497),'KWIqE':_0x2435c3(0x56d,0x5b9,0x5b0,0x590),'IaKxj':_0x2435c3(0x53c,0x5aa,0x625,0x5fb),'WCsLB':function(_0x216ec8,_0x271a3b){return _0x216ec8!==_0x271a3b;},'TpSSc':_0x2435c3(0x53f,0x548,0x4d8,0x599),'sHjjr':function(_0x127e8a,_0x2eb804){return _0x127e8a>_0x2eb804;},'rHtVO':_0x4682a1(0x43e,0x534,0x41b,0x481),'Eygue':function(_0x3810ec,_0x16e072){return _0x3810ec===_0x16e072;},'KGYXx':_0x2435c3(0x53d,0x4ac,0x4dc,0x41e),'lhUHb':_0x2435c3(0x58a,0x550,0x52a,0x4bc)+'内容','jvHmW':_0x4682a1(0x55d,0x418,0x54c,0x4c8),'fEWTI':_0x4682a1(0x3e2,0x3c5,0x47b,0x461),'gRyLP':function(_0x15fd66){return _0x15fd66();},'raPqG':_0x2435c3(0x614,0x5ad,0x5d6,0x5cb)+_0x4682a1(0x49c,0x407,0x4a4,0x448)+'cter','TFoaH':function(_0x1aab0d,_0x4df16e){return _0x1aab0d(_0x4df16e);},'zXVDK':function(_0x26119f,_0x3c3767){return _0x26119f(_0x3c3767);}},_0x6ab462=extension_settings[extensionName],_0x134541=_0x6ab462[_0x2435c3(0x4b4,0x52c,0x51b,0x55e)+_0x4682a1(0x44a,0x3cf,0x45d,0x443)][_0x317ff8];if(!_0x134541){if(_0x1ec690[_0x2435c3(0x51d,0x4d5,0x56e,0x457)](_0x1ec690[_0x4682a1(0x421,0x4ee,0x4e6,0x4ae)],_0x1ec690['kPpqS']))return _0xd06a5d[_0x4682a1(0x61d,0x588,0x53f,0x597)]();else{toastr[_0x2435c3(0x4a3,0x4cf,0x476,0x571)](_0x1ec690[_0x2435c3(0x5bb,0x516,0x5c2,0x562)]);return;}}let _0x13ec56=_0x4682a1(0x44d,0x470,0x4a2,0x4f4)+_0x317ff8+_0x4682a1(0x4ed,0x525,0x568,0x4f7);const _0x4c5034={};_0x4c5034['nameCN']=_0x1ec690[_0x4682a1(0x4eb,0x4f5,0x581,0x58f)],_0x4c5034[_0x4682a1(0x4f1,0x461,0x4ba,0x4e7)]=_0x1ec690[_0x2435c3(0x52f,0x4cb,0x4ef,0x554)],_0x4c5034[_0x4682a1(0x468,0x3d0,0x46d,0x436)+_0x4682a1(0x513,0x441,0x4c8,0x4c4)]=_0x1ec690[_0x2435c3(0x4df,0x4f1,0x540,0x50f)],_0x4c5034['facialFeat'+_0x2435c3(0x4d4,0x551,0x5f1,0x5b4)]=_0x1ec690[_0x4682a1(0x524,0x4f9,0x4d1,0x57a)],_0x4c5034['upperBodyS'+'FW']=_0x1ec690[_0x2435c3(0x542,0x49d,0x50a,0x459)];function _0x2435c3(_0x4cc448,_0x5bccda,_0x430ab6,_0x5d3481){return _0x1af9(_0x5bccda-0x39d,_0x4cc448);}_0x4c5034['upperBodyS'+_0x4682a1(0x49d,0x55e,0x5e2,0x547)]=_0x2435c3(0x447,0x4ae,0x451,0x431),_0x4c5034[_0x2435c3(0x5cc,0x524,0x48a,0x54c)+'W']=_0x1ec690['fDdfY'],_0x4c5034[_0x2435c3(0x55a,0x524,0x59c,0x56e)+_0x4682a1(0x48a,0x54f,0x542,0x4cc)]=_0x1ec690[_0x4682a1(0x5ba,0x52a,0x4be,0x55e)],_0x4c5034[_0x4682a1(0x4f7,0x585,0x579,0x50b)+'SFW']=_0x1ec690[_0x2435c3(0x531,0x4f0,0x45b,0x4b6)],_0x4c5034[_0x4682a1(0x46a,0x569,0x52d,0x50b)+'SFWBack']=_0x1ec690[_0x2435c3(0x55d,0x541,0x4b4,0x5d9)],_0x4c5034[_0x4682a1(0x3cd,0x3b1,0x480,0x441)+'FW']=_0x1ec690[_0x4682a1(0x49d,0x4db,0x481,0x4da)],_0x4c5034[_0x4682a1(0x4eb,0x444,0x3d1,0x441)+'FWBack']=_0x1ec690[_0x2435c3(0x580,0x540,0x5c7,0x5ed)];const _0x22e75f=_0x4c5034;let _0x711012=0x26be+-0x79+0x65*-0x61;for(const _0x74c59c in _0x22e75f){if(_0x219d6a[_0x74c59c]&&_0x1ec690[_0x4682a1(0x43f,0x44e,0x3fc,0x46f)](_0x219d6a[_0x74c59c],_0x134541[_0x74c59c])){const _0x3b7d9e=_0x134541[_0x74c59c]||_0x1ec690['TpSSc'],_0x14c746=_0x219d6a[_0x74c59c];_0x13ec56+='•\x20'+_0x22e75f[_0x74c59c]+':\x0a',_0x13ec56+=_0x2435c3(0x422,0x48c,0x502,0x42e)+_0x3b7d9e['substring'](0x1eb7+-0x39*-0x79+0x14*-0x2e2,-0x1*-0x71+0x116d+-0x11ac)+(_0x1ec690[_0x4682a1(0x5e6,0x5c2,0x563,0x55c)](_0x3b7d9e[_0x2435c3(0x5e5,0x59a,0x54b,0x641)],-0x8*-0x23d+-0x18*0xf+-0x104e)?_0x1ec690['rHtVO']:'')+'\x0a',_0x13ec56+='\x20\x20新:\x20'+_0x14c746[_0x4682a1(0x56b,0x543,0x532,0x4dd)](-0x465+0x3*-0x86d+0xd3*0x24,0x13c5+-0x1089*-0x1+-0x241c)+(_0x1ec690[_0x2435c3(0x60d,0x582,0x5c5,0x4cd)](_0x14c746['length'],-0x7fd*0x2+-0x1*-0x553+0xad9*0x1)?_0x1ec690['rHtVO']:'')+'\x0a\x0a',_0x711012++;}}if(_0x1ec690[_0x4682a1(0x52b,0x46b,0x54e,0x4e2)](_0x711012,-0x2*0x11ba+-0x14a1+0x1*0x3815)){if(_0x1ec690['KGYXx']===_0x1ec690['KGYXx']){toastr[_0x4682a1(0x4f5,0x4c0,0x41a,0x46b)](_0x1ec690[_0x4682a1(0x588,0x4e9,0x618,0x598)]);return;}else{const _0x29d633={'baPKb':function(_0x4d582c,_0x2f0351){return _0x4d582c(_0x2f0351);},'RLHhq':_0x1ec690['OMVQB']},_0xac0531=[_0x1ec690['axriR'],_0x4682a1(0x438,0x477,0x54a,0x4e7),_0x1ec690['VowZP'],_0x2435c3(0x40c,0x45c,0x478,0x3d0)+'uresBack',_0x1ec690['DUMvX'],_0x1ec690[_0x2435c3(0x53a,0x560,0x5fe,0x568)],_0x1ec690['uhKSH'],_0x1ec690[_0x4682a1(0x48e,0x484,0x585,0x4ed)],_0x4682a1(0x47b,0x463,0x584,0x50b)+_0x2435c3(0x4f3,0x4ec,0x4a7,0x53c),_0x1ec690[_0x4682a1(0x54e,0x4c6,0x589,0x51e)],_0x2435c3(0x44d,0x467,0x50c,0x4a1)+'FW',_0x1ec690[_0x4682a1(0x519,0x477,0x4b9,0x46e)]];_0xac0531[_0x4682a1(0x4cc,0x3c4,0x443,0x439)](_0x3906b9=>{function _0x34b440(_0x188ff1,_0x5edc15,_0x764bdf,_0x4efe99){return _0x2435c3(_0x188ff1,_0x5edc15- -0x590,_0x764bdf-0x17a,_0x4efe99-0x174);}function _0x4827f3(_0x36770d,_0x584001,_0x4aff82,_0x271b70){return _0x2435c3(_0x584001,_0x271b70- -0x399,_0x4aff82-0x6c,_0x271b70-0x71);}if(_0x491551[_0x3906b9]){const _0x28a3cb=_0x329d16['getElement'+'ById']('char_'+_0x3906b9);_0x28a3cb&&(_0x28a3cb[_0x34b440(-0x23,-0x3a,0x4e,0x50)]=_0x514461[_0x3906b9],_0x29d633[_0x4827f3(0x16d,0x169,0xae,0xf7)](_0xc16146,_0x28a3cb)[_0x34b440(0x88,-0x19,-0x14,-0x62)](_0x29d633['RLHhq']));}});}}_0x13ec56+='共\x20'+_0x711012+_0x4682a1(0x55a,0x4a1,0x4ff,0x51d);const _0x2d2c8f=await stylishConfirm(_0x13ec56);if(!_0x2d2c8f){if(_0x1ec690[_0x2435c3(0x44e,0x495,0x439,0x52f)](_0x1ec690[_0x4682a1(0x4c4,0x475,0x4ff,0x4d9)],_0x4682a1(0x455,0x48f,0x449,0x4c8)))_0x5045d5[_0x4682a1(0x516,0x4b3,0x5ed,0x545)+'ener'](_0x5def90['LLM_CHAR_M'+'ODIFY_RESP'+'ONSE'],_0x453590),_0x182bc0&&(_0x1ec690[_0x2435c3(0x558,0x4d6,0x46d,0x487)](_0x553420,_0x5e1bd5),_0x2d87eb=null);else{toastr[_0x2435c3(0x421,0x491,0x448,0x408)](_0x2435c3(0x510,0x492,0x52d,0x4c2));return;}}function _0x4682a1(_0x4b6b97,_0x1d60a2,_0x584e6e,_0x3458ca){return _0x1af9(_0x3458ca-0x377,_0x1d60a2);}for(const _0x36f496 in _0x22e75f){if(_0x219d6a[_0x36f496]){if(_0x1ec690[_0x4682a1(0x521,0x424,0x4eb,0x46f)](_0x4682a1(0x3ae,0x423,0x403,0x461),_0x1ec690['fEWTI'])){const _0x55dc2b={};_0x55dc2b[_0x4682a1(0x4c9,0x567,0x592,0x504)]='text',_0x55dc2b[_0x4682a1(0x46c,0x486,0x476,0x4fa)]=_0x4682a1(0x56a,0x4ef,0x54a,0x578)+_0x345fca[_0x4682a1(0x5c1,0x5fe,0x627,0x574)]+'张'+_0x1db853+']',_0xf3a5ac[_0x2435c3(0x4e4,0x53d,0x594,0x4a1)](_0x55dc2b);}else _0x134541[_0x36f496]=_0x219d6a[_0x36f496];}}_0x1ec690[_0x4682a1(0x4fa,0x5ee,0x4fe,0x539)](saveSettingsDebounced);const _0x59ae42=_0x1ec690['OnMXS']($,_0x1ec690[_0x2435c3(0x4fc,0x50e,0x53a,0x597)]);_0x59ae42['length']&&_0x1ec690[_0x4682a1(0x4a3,0x532,0x48b,0x47e)](refreshCharacterSettings,_0x59ae42),_0x1ec690[_0x4682a1(0x4e4,0x3b9,0x421,0x43b)](updateFormFields,_0x219d6a),console[_0x4682a1(0x557,0x48f,0x4c2,0x4fd)]('[character'+'PromptModi'+_0x4682a1(0x51a,0x5e1,0x5b1,0x582)+_0x4682a1(0x49c,0x4fd,0x504,0x482)+_0x317ff8+'\x22');}function updateFormFields(_0x52cdaa){function _0x330724(_0x3e92e6,_0x4d3c67,_0x391ac5,_0x2f4432){return _0x1af9(_0x4d3c67-0x254,_0x2f4432);}function _0x212910(_0xfda2cc,_0x44700b,_0x2d593b,_0x3fd7c1){return _0x1af9(_0x2d593b-0x20a,_0x3fd7c1);}const _0x18be55={'nZITy':'角色修改\x20LLM\x20请'+'求超时','rskBT':'Mqpbg','ntEsM':_0x330724(0x392,0x368,0x416,0x36d),'XSGai':function(_0x453ec8,_0x101a3f){return _0x453ec8!==_0x101a3f;},'yJfBZ':_0x212910(0x3a8,0x2c9,0x37d,0x3ae),'kxrhs':'DjTxa','vNJvY':function(_0x1cf0b2,_0x433aa5){return _0x1cf0b2(_0x433aa5);},'kYmDC':_0x330724(0x516,0x466,0x3eb,0x444),'oRlLF':_0x212910(0x229,0x31d,0x2d9,0x360),'tsGaV':'facialFeat'+_0x212910(0x396,0x3ac,0x357,0x3a2),'VDxLH':_0x212910(0x341,0x348,0x2c9,0x375)+_0x212910(0x3b1,0x36c,0x3be,0x3d4),'xWAGv':_0x330724(0x39f,0x350,0x2c5,0x37d)+'FW','zPePA':'upperBodyS'+_0x212910(0x3ae,0x3a9,0x3da,0x3f4),'CUePe':_0x330724(0x345,0x3db,0x440,0x34e)+'W','kuzfu':_0x212910(0x3e6,0x2ef,0x39e,0x437)+_0x212910(0x370,0x335,0x359,0x2c3),'zVlJg':'upperBodyN'+'SFWBack','wyxEO':_0x212910(0x375,0x304,0x2d4,0x303)+'FW'},_0x463165=[_0x18be55['oRlLF'],_0x212910(0x377,0x3bb,0x37a,0x340),_0x18be55[_0x212910(0x42b,0x3b5,0x379,0x30b)],_0x18be55[_0x330724(0x2e5,0x321,0x2a2,0x2d7)],_0x18be55[_0x330724(0x465,0x3e4,0x462,0x45c)],_0x18be55[_0x212910(0x2c4,0x3f2,0x366,0x384)],_0x18be55['CUePe'],_0x330724(0x3be,0x3db,0x44d,0x486)+_0x212910(0x2df,0x322,0x35f,0x3f2),_0x18be55['kuzfu'],_0x18be55[_0x212910(0x3d1,0x3a0,0x373,0x3c3)],_0x18be55[_0x212910(0x4ac,0x3ac,0x42e,0x394)],_0x212910(0x298,0x2c2,0x2d4,0x25c)+_0x212910(0x478,0x485,0x3da,0x374)];_0x463165[_0x212910(0x280,0x235,0x2cc,0x357)](_0x2f1d24=>{function _0x21142e(_0x30fa4d,_0x3c97a4,_0x10a76d,_0x2d5d57){return _0x212910(_0x30fa4d-0xcd,_0x3c97a4-0x2,_0x2d5d57-0x3d,_0x10a76d);}const _0x46831a={'owHgj':function(_0x5c1c14,_0x1bda48){return _0x5c1c14(_0x1bda48);},'uhXHL':_0x18be55[_0x21142e(0x450,0x3a9,0x4ad,0x3fc)]};function _0x455a0f(_0x11cd65,_0x98a357,_0x18970d,_0x5e91da){return _0x212910(_0x11cd65-0x2d,_0x98a357-0xe8,_0x11cd65-0xc1,_0x98a357);}if(_0x18be55['rskBT']===_0x18be55[_0x455a0f(0x390,0x40a,0x392,0x397)])_0x174bf9[_0x21142e(0x40c,0x31c,0x3ed,0x36b)](_0x559628);else{if(_0x52cdaa[_0x2f1d24]){if(_0x18be55['XSGai'](_0x18be55['yJfBZ'],_0x18be55['kxrhs'])){const _0x2364e9=document[_0x455a0f(0x439,0x3e0,0x499,0x4c0)+_0x21142e(0x2b2,0x373,0x31d,0x342)]('char_'+_0x2f1d24);_0x2364e9&&(_0x2364e9['value']=_0x52cdaa[_0x2f1d24],_0x18be55['vNJvY']($,_0x2364e9)[_0x455a0f(0x4a5,0x555,0x4ed,0x508)](_0x18be55[_0x21142e(0x468,0x3cb,0x35b,0x3ef)]));}else _0x3b4bb9(),_0x46831a[_0x21142e(0x3af,0x3a0,0x3a2,0x36c)](_0x2730f4,new _0x4530be(_0x46831a[_0x455a0f(0x447,0x3b4,0x3b7,0x3ad)]));}}});}
//# sourceMappingURL=http://localhost:8000/characterPromptModify.js.map