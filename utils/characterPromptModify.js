(function(_0x1edb51,_0x82c7aa){function _0xa6ee6c(_0x2591c8,_0x3a8d5c,_0x55f750,_0x20dce){return _0x4cec(_0x55f750- -0x1b2,_0x20dce);}function _0x53fc5f(_0x23874a,_0x39fd69,_0x1ea54b,_0x2ba24b){return _0x4cec(_0x1ea54b-0x121,_0x39fd69);}const _0x51c6ff=_0x1edb51();while(!![]){try{const _0xc18e58=parseInt(_0x53fc5f(0x2d7,0x2a1,0x2f5,0x26d))/(-0x11d7+0x377+0xe61)*(parseInt(_0xa6ee6c(0x213,0xe5,0x171,0x128))/(-0x1db2+0xa*-0x39b+0x41c2))+-parseInt(_0xa6ee6c(0x1d6,0x1aa,0x131,0xb2))/(-0x1d52+-0x3*-0x757+-0xd0*-0x9)+parseInt(_0xa6ee6c(0xc0,0xe9,0x4c,0x96))/(-0x1*0x20fc+-0x33*0xb7+0x4575)*(-parseInt(_0x53fc5f(0x408,0x466,0x3ca,0x434))/(0x2598+-0x244c+-0x147))+-parseInt(_0x53fc5f(0x493,0x3f3,0x40b,0x4b7))/(-0x157*0x10+-0x11e4+0x275a)+-parseInt(_0xa6ee6c(0xf1,0x68,0xfe,0x17e))/(0x192+0x1*0x15d0+-0x175b)+parseInt(_0x53fc5f(0x48a,0x4cc,0x44b,0x478))/(-0x1e0f+-0x128a+0xd3*0x3b)+parseInt(_0x53fc5f(0x2ee,0x321,0x35c,0x38f))/(-0x1ce4*-0x1+-0x2154+0x479);if(_0xc18e58===_0x82c7aa)break;else _0x51c6ff['push'](_0x51c6ff['shift']());}catch(_0x50955e){_0x51c6ff['push'](_0x51c6ff['shift']());}}}(_0x232e,-0x1*-0x57a3d+0xc9*0x511+-0x5e054));const _0x1da785=(function(){const _0x12888d={};function _0x22b356(_0x39534a,_0x24f4d7,_0x1fc711,_0x1420f3){return _0x4cec(_0x1420f3-0x132,_0x39534a);}_0x12888d[_0x5e7e7f(0x3d8,0x318,0x434,0x3be)]=_0x22b356(0x4a2,0x48f,0x4e1,0x448),_0x12888d[_0x22b356(0x3ce,0x3db,0x2bf,0x32d)]=_0x5e7e7f(0x422,0x3b3,0x446,0x445),_0x12888d['CCtcV']=function(_0x17007c,_0x14d3b1){return _0x17007c===_0x14d3b1;},_0x12888d[_0x5e7e7f(0x484,0x4bc,0x4f5,0x488)]='oMRZB',_0x12888d['ReWdz']=_0x22b356(0x3a7,0x3d4,0x4b7,0x422);function _0x5e7e7f(_0xa443a9,_0xe30d60,_0x546b22,_0xc9bf2d){return _0x4cec(_0xc9bf2d-0x1bc,_0xa443a9);}const _0x48026f=_0x12888d;let _0x124a40=!![];return function(_0x5daeb4,_0x18e05f){function _0x4cbf62(_0x5a905e,_0x36a2be,_0x3f38c7,_0x15359f){return _0x22b356(_0x5a905e,_0x36a2be-0x5,_0x3f38c7-0x154,_0x36a2be-0x1f0);}function _0x2d5691(_0xa39c90,_0x5ad1a4,_0x191d46,_0x178757){return _0x5e7e7f(_0x178757,_0x5ad1a4-0x42,_0x191d46-0x121,_0x191d46-0x15);}if(_0x48026f['CCtcV'](_0x48026f[_0x2d5691(0x4f6,0x43b,0x49d,0x41c)],_0x48026f[_0x4cbf62(0x5a6,0x64f,0x6c3,0x5d4)])){_0x530142[_0x4cbf62(0x537,0x536,0x5b8,0x540)](_0x2d5691(0x47d,0x4a6,0x4ad,0x50c)+'内容');return;}else{const _0x15ed6c=_0x124a40?function(){const _0x2e9bee={};_0x2e9bee['vZZhZ']=_0x48026f[_0x12ac8d(-0x80,-0x62,-0x8e,-0x5e)];function _0x89deff(_0x37c59d,_0x564858,_0x4bfab3,_0x1d6cd7){return _0x4cbf62(_0x1d6cd7,_0x564858- -0x1e5,_0x4bfab3-0x22,_0x1d6cd7-0xc3);}const _0x26ee00=_0x2e9bee;function _0x12ac8d(_0xc03073,_0x3661fe,_0x9021db,_0x1b7c6e){return _0x4cbf62(_0x3661fe,_0xc03073- -0x5a4,_0x9021db-0x2,_0x1b7c6e-0xed);}if(_0x18e05f){if(_0x48026f[_0x89deff(0x2a5,0x338,0x312,0x34f)]!==_0x12ac8d(0x7,0x3b,0x23,0x8f)){_0x38af7c['error'](_0x26ee00[_0x89deff(0x3a6,0x359,0x39a,0x3f3)]);return;}else{const _0xaaefe=_0x18e05f[_0x12ac8d(-0x4d,-0xe4,-0xdd,-0x59)](_0x5daeb4,arguments);return _0x18e05f=null,_0xaaefe;}}}:function(){};return _0x124a40=![],_0x15ed6c;}};}()),_0xa51e8f=_0x1da785(this,function(){const _0x2e6473={};_0x2e6473[_0x24781b(0x453,0x4c6,0x4f7,0x3c2)]=_0x24781b(0x3fe,0x349,0x36a,0x4ad)+'+$';function _0x5dedf0(_0x2df1b9,_0x3b88de,_0x384688,_0x26a549){return _0x4cec(_0x384688- -0x23b,_0x2df1b9);}const _0x1d154c=_0x2e6473;function _0x24781b(_0x28d4d6,_0x27d085,_0x33cfbe,_0xf824c7){return _0x4cec(_0x28d4d6-0x1e4,_0xf824c7);}return _0xa51e8f[_0x5dedf0(-0x2,0x6,-0x2,-0x79)]()[_0x24781b(0x46a,0x49e,0x40f,0x4e5)](_0x1d154c[_0x5dedf0(-0x3d,-0x58,0x34,0x1f)])[_0x24781b(0x41d,0x470,0x3a9,0x403)]()[_0x24781b(0x4c5,0x4c5,0x50a,0x4bb)+'r'](_0xa51e8f)['search'](_0x1d154c[_0x24781b(0x453,0x39b,0x3f7,0x48b)]);});_0xa51e8f();import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x3ba468}from'./promptProcessor.js';function replacePlaceholder(_0x686df,_0x2ce74a,_0x14811f,_0x17e041){const _0x113f60={'BkiJk':function(_0x268e17,_0x21b256){return _0x268e17>_0x21b256;},'Ffefj':'...','TdhhT':_0x3937ec(0x409,0x447,0x3e1,0x3b4),'ujJCU':function(_0x402575,_0x572e4e){return _0x402575>_0x572e4e;},'yPknc':function(_0x28c977,_0x5914b4){return _0x28c977(_0x5914b4);},'LYgRe':function(_0x3fc6a2,_0x5d13a7){return _0x3fc6a2===_0x5d13a7;},'AIyGD':_0x5dd607(-0xc2,-0x102,-0x193,-0x17b),'FfwlM':function(_0xa85ee8,_0x15861d){return _0xa85ee8!==_0x15861d;},'qKyUT':_0x5dd607(-0x1a0,-0xf2,-0x189,-0x176),'cSRLS':function(_0x37b9d5,_0xa11ea0){return _0x37b9d5===_0xa11ea0;},'YWbub':'VAcnV','AuErr':_0x3937ec(0x3b2,0x3d5,0x3aa,0x426),'pZhnO':_0x3937ec(0x403,0x421,0x3b9,0x36c),'AOUUX':function(_0x240732,_0x33aef6,_0x40896f,_0x3b5b31,_0x58e05e){return _0x240732(_0x33aef6,_0x40896f,_0x3b5b31,_0x58e05e);}};if(_0x113f60['LYgRe'](typeof _0x686df,_0x113f60[_0x3937ec(0x2e9,0x332,0x3cb,0x333)])){if(_0x113f60['FfwlM'](_0x113f60[_0x5dd607(-0x7a,-0xcc,-0xb4,-0x6c)],_0x5dd607(-0x12b,-0xe2,-0x49,-0xa9)))return _0x14811f&&_0x686df[_0x3937ec(0x278,0x2e8,0x35b,0x323)](_0x2ce74a)&&(_0x113f60[_0x5dd607(-0xe4,-0x8c,0x2e,-0x122)](_0x3937ec(0x304,0x2ed,0x23a,0x2f1),_0x5dd607(-0x34,-0xaf,-0xb8,-0x9))?_0x5bd358[_0x3937ec(0x393,0x365,0x40b,0x3c7)]('[character'+_0x3937ec(0x468,0x45f,0x400,0x3b3)+_0x5dd607(-0x171,-0xf6,-0x161,-0xa7)+_0x5dd607(-0x20b,-0x162,-0x132,-0x12e)+_0x387f44+'\x22'):_0x17e041&&_0x17e041['add'](_0x2ce74a)),_0x686df[_0x5dd607(-0xaf,-0x111,-0x7f,-0x166)](_0x2ce74a,_0x14811f);else{const _0x498bb6=_0x3dea69[_0x7ad0c3]||'(空)',_0xa4cca0=_0x142204[_0x542a20];_0x2712ad+='•\x20'+_0x12e3b8[_0x4b230b]+':\x0a',_0x4fa09f+=_0x5dd607(-0xbd,-0xcb,-0x92,-0x27)+_0x498bb6[_0x5dd607(-0x175,-0xea,-0x159,-0x18e)](-0x10fe+0x2442+0x89*-0x24,0x1*0xaeb+0x1*-0xb85+0xcc)+(_0x113f60[_0x5dd607(-0xd1,-0x15d,-0x1ce,-0x20c)](_0x498bb6['length'],0x1e16+-0x125a+-0xb8a*0x1)?_0x113f60[_0x5dd607(-0x1c2,-0x171,-0x1be,-0xcc)]:'')+'\x0a',_0x188f48+=_0x5dd607(-0xbd,-0x6a,-0x97,-0x8c)+_0xa4cca0[_0x5dd607(-0x16b,-0xea,-0xce,-0x157)](-0x12f*-0xd+0x73*-0x17+0x2*-0x287,-0x11f7+0x110e+0x11b)+(_0xa4cca0[_0x3937ec(0x3bc,0x334,0x37c,0x33f)]>0x1e06+-0x2a9*0x2+-0xc41*0x2?_0x113f60[_0x5dd607(-0xf4,-0x171,-0x1fb,-0x15f)]:'')+'\x0a\x0a',_0xe11ec6++;}}function _0x3937ec(_0x4b4a2a,_0x3ab577,_0x350d48,_0x1e37e5){return _0x4cec(_0x1e37e5-0x105,_0x3ab577);}if(Array[_0x3937ec(0x398,0x383,0x46d,0x436)](_0x686df)){if(_0x113f60['LYgRe'](_0x5dd607(0x7b,-0x37,-0xec,-0x7f),_0x113f60['YWbub']))return _0x686df[_0x5dd607(-0x8d,-0xf1,-0xc9,-0x16f)](_0x4088ca=>replacePlaceholder(_0x4088ca,_0x2ce74a,_0x14811f,_0x17e041));else{if(_0x47a22f[_0x4864ce]&&_0x2ee4f2[_0x334846]!==_0x4a36ac[_0x11b2a1]){const _0x33b184=_0x320c71[_0x3bb0b9]||_0x113f60[_0x5dd607(-0x3b,-0x13,0x6e,-0x24)],_0x5c264b=_0x310372[_0x148211];_0x423f2b+='•\x20'+_0x29497d[_0x1a670e]+':\x0a',_0x79bb36+=_0x5dd607(-0x184,-0xcb,-0x69,-0xa6)+_0x33b184[_0x3937ec(0x2b9,0x313,0x369,0x359)](0x1704*0x1+0x17ae+-0x2eb2,-0x533*0x3+0x23db+0x2*-0xa08)+(_0x113f60[_0x3937ec(0x3fb,0x3cb,0x33b,0x358)](_0x33b184[_0x3937ec(0x3a6,0x318,0x340,0x33f)],0x88a*-0x4+0x308+0x1*0x1f52)?_0x3937ec(0x36f,0x375,0x429,0x37d):'')+'\x0a',_0x473245+=_0x5dd607(-0xe5,-0x6a,0x40,-0x33)+_0x5c264b['substring'](0x1fa2+0xb0c+0x3*-0xe3a,0x1adb+-0x486+-0x1*0x1623)+(_0x113f60[_0x3937ec(0x33b,0x32c,0x274,0x2e6)](_0x5c264b[_0x3937ec(0x340,0x30a,0x340,0x33f)],0xc5b*-0x3+0x7fb+0x1d48)?_0x113f60['Ffefj']:'')+'\x0a\x0a',_0x46c7e5++;}}}if(_0x686df&&typeof _0x686df===_0x113f60['AuErr']){if(_0x113f60[_0x3937ec(0x35d,0x358,0x3f7,0x3f0)](_0x5dd607(-0x6d,-0xd7,-0x130,-0x59),_0x113f60[_0x3937ec(0x374,0x31c,0x34b,0x335)])){const _0x39966d=_0x4baf77[_0x3937ec(0x412,0x3ac,0x305,0x36d)+_0x5dd607(-0x19e,-0x158,-0x1a8,-0x1a7)](_0x5dd607(-0x75,-0xce,-0x95,-0xdb)+_0x24fb51);_0x39966d&&(_0x39966d['value']=_0x2f4eec[_0x2f5fc6],_0x113f60[_0x5dd607(-0x172,-0xf0,-0x76,-0x108)](_0x366e67,_0x39966d)[_0x5dd607(0x83,-0xc,-0x56,-0x42)](_0x3937ec(0x3b4,0x324,0x391,0x328)));}else{const _0x1b1b18={};for(const _0x262e04 in _0x686df){_0x1b1b18[_0x262e04]=_0x113f60[_0x5dd607(-0x104,-0x13b,-0xad,-0xe7)](replacePlaceholder,_0x686df[_0x262e04],_0x2ce74a,_0x14811f,_0x17e041);}return _0x1b1b18;}}function _0x5dd607(_0x42c7a9,_0x1d9ce7,_0x3c9cf4,_0x353caf){return _0x4cec(_0x1d9ce7- -0x33e,_0x3c9cf4);}return _0x686df;}function attachImagesToMessage(_0x3c87b4,_0x3da66e,_0x3eca59,_0x393c20=_0x1ee02b(0x5c6,0x607,0x601,0x57e)){const _0x8f86b0={'pkFbj':function(_0x36efda,_0x781f52){return _0x36efda(_0x781f52);},'nPmcf':'已取消更新','RUiFM':_0x5e93fe(0x16d,0x1d8,0x1cc,0x1d8),'BlSPG':function(_0x4cfef2,_0x1b9a8c){return _0x4cfef2===_0x1b9a8c;},'jlhIn':_0x5f38c8(-0x75,-0xed,0x9,-0x35),'iELvh':function(_0x5087af,_0x5f2ee5){return _0x5087af===_0x5f2ee5;},'nBOhV':'object','kqMSJ':function(_0x39d259,_0x574241){return _0x39d259+_0x574241;},'yUppi':_0x5e93fe(0x1bf,0x23f,0x1d8,0x2ca),'mCHJd':_0x5f38c8(-0x87,-0x84,-0xe3,-0xa5),'TGEgA':function(_0x49ba62,_0x29e0c0){return _0x49ba62!==_0x29e0c0;},'pDMEk':'RGwWQ','RGbMK':_0x5e93fe(0x211,0x1ac,0x158,0x23a),'xGSpQ':_0x5f38c8(0x38,-0x27,-0x6c,-0x7),'PPOhr':_0x5e93fe(0x2bd,0x2e3,0x30c,0x2f5),'jegma':function(_0x279c30,_0x8e5010){return _0x279c30<_0x8e5010;},'QgAYc':_0x5e93fe(0x25c,0x234,0x1b2,0x21d),'RXUHK':function(_0x470681,_0x471f61){return _0x470681>_0x471f61;},'ykMcL':function(_0xba6a3f,_0x56afb3){return _0xba6a3f!==_0x56afb3;},'DOYAx':_0x5f38c8(-0x17,0xed,0x122,0x7d)};if(!_0x3eca59||_0x8f86b0[_0x5e93fe(0x32c,0x27e,0x277,0x2ad)](_0x3eca59[_0x5e93fe(0x208,0x1ef,0x214,0x244)],0xd*0x1be+-0x85+-0x1621*0x1)||_0x8f86b0[_0x5f38c8(-0x7,0xe6,-0x1b,0x48)](_0x3da66e,-0x856+-0x29*0xe2+0x2c88)||_0x3da66e>=_0x3c87b4[_0x5f38c8(-0xd4,-0xa4,0x7c,-0x37)])return _0x3c87b4;const _0x3cbdfa=[..._0x3c87b4];function _0x5e93fe(_0x3c8265,_0x555548,_0xc6812a,_0x491951){return _0x1ee02b(_0xc6812a,_0x555548- -0x381,_0xc6812a-0x10e,_0x491951-0x10a);}const _0x28636f=_0x3cbdfa[_0x3da66e],_0x10a91a=[];if(_0x8f86b0['BlSPG'](typeof _0x28636f['content'],_0x8f86b0[_0x5f38c8(0x79,0x32,-0x57,0x55)])){if(_0x8f86b0[_0x5f38c8(0xbf,0x51,0x135,0x7b)](_0x8f86b0[_0x5e93fe(0x155,0x1d5,0x281,0x139)],'YFrSC'))_0x8f86b0[_0x5e93fe(0x1b0,0x1a4,0x103,0x1de)](_0x418fd7,_0x23917a),_0x168e25=null;else{const _0x3a8904={};_0x3a8904[_0x5f38c8(0x15,0x110,-0xf,0x88)]=_0x8f86b0[_0x5f38c8(-0x129,-0x7b,-0xc4,-0xa1)],_0x3a8904[_0x5f38c8(0x8b,-0x5e,0x49,0x19)]=_0x28636f[_0x5e93fe(0x188,0x1a9,0x121,0x1db)],_0x10a91a['push'](_0x3a8904);}}else Array['isArray'](_0x28636f[_0x5f38c8(-0x52,-0x30,-0x2c,-0x7d)])&&_0x10a91a[_0x5e93fe(0x1d6,0x1be,0x20b,0x25f)](..._0x28636f[_0x5e93fe(0x1bb,0x1a9,0x25c,0x11c)]);if(_0x8f86b0[_0x5f38c8(0x43,-0xaa,0x50,0xd)](_0x3eca59['length'],0x383+0x2477+-0x27fa)){if(_0x8f86b0[_0x5e93fe(0x178,0x1b2,0x24a,0x192)](_0x8f86b0[_0x5e93fe(0x2a6,0x1ec,0x13a,0x1ec)],_0x5f38c8(-0x11b,-0x7e,-0x29,-0x93))){const _0x3d7715={};_0x3d7715[_0x5f38c8(0xaa,0x100,0x107,0x88)]=_0x8f86b0['yUppi'],_0x3d7715['text']=_0x5e93fe(0x27e,0x1f6,0x187,0x199)+_0x3eca59['length']+'张'+_0x393c20+']',_0x10a91a[_0x5e93fe(0x230,0x1be,0x1c6,0x154)](_0x3d7715);}else{_0x13a4d1[_0x5e93fe(0x210,0x1c9,0x110,0x17c)](_0x8f86b0[_0x5f38c8(-0x3,-0x22,-0xad,-0x65)]);return;}}_0x3eca59[_0x5e93fe(0x261,0x241,0x2d1,0x24b)]((_0x318209,_0x3aea1d)=>{const _0xd118ad={'iXjzW':function(_0x14411e,_0x16ce6d){function _0xf24a(_0x50c97f,_0x5a2b8d,_0x36f6cb,_0x45754c){return _0x4cec(_0x36f6cb-0x2f6,_0x5a2b8d);}return _0x8f86b0[_0xf24a(0x513,0x50f,0x4e5,0x540)](_0x14411e,_0x16ce6d);},'UXbfC':_0x8f86b0[_0x5cd790(0x3aa,0x2e0,0x3b7,0x355)]};function _0x4300e9(_0x10edea,_0x46abc5,_0x53e059,_0x49f683){return _0x5f38c8(_0x10edea,_0x46abc5-0xb0,_0x53e059-0x11b,_0x46abc5-0x3cb);}const _0x3b7c5b=_0x8f86b0[_0x4300e9(0x4d9,0x446,0x4cc,0x4f4)](typeof _0x318209,_0x8f86b0[_0x5cd790(0x4c0,0x43c,0x45e,0x436)])?_0x318209:_0x318209[_0x5cd790(0x3f9,0x3aa,0x3a0,0x450)],_0x307e7e=_0x8f86b0[_0x4300e9(0x3d4,0x423,0x3a2,0x3dc)](typeof _0x318209,_0x8f86b0['nBOhV'])&&_0x318209[_0x4300e9(0x50d,0x479,0x4a0,0x3f8)]?_0x318209['name']:''+_0x393c20+_0x8f86b0[_0x4300e9(0x373,0x3c7,0x36b,0x439)](_0x3aea1d,-0x113+-0x50+0x164),_0x3089bd={};_0x3089bd['type']=_0x8f86b0[_0x4300e9(0x2fc,0x32a,0x278,0x358)],_0x3089bd['text']='['+_0x307e7e+']',_0x10a91a[_0x5cd790(0x3b2,0x3ab,0x3b5,0x379)](_0x3089bd);let _0x5c2ce9=_0x3b7c5b;function _0x5cd790(_0x3b4fd0,_0x363b7b,_0x4b1518,_0xb28a39){return _0x5f38c8(_0x3b4fd0,_0x363b7b-0x89,_0x4b1518-0x1ef,_0xb28a39-0x3e1);}!_0x3b7c5b['startsWith'](_0x8f86b0[_0x5cd790(0x41d,0x336,0x408,0x3c0)])&&(_0x8f86b0[_0x5cd790(0x4b0,0x3ff,0x4c3,0x498)](_0x8f86b0['pDMEk'],_0x8f86b0[_0x4300e9(0x35a,0x36a,0x3c6,0x36b)])?_0x5c2ce9=_0x4300e9(0x40b,0x455,0x42e,0x3ca)+_0x4300e9(0x483,0x469,0x43f,0x3f2)+'4,'+_0x3b7c5b:(_0x3dc7d2[_0x5cd790(0x46e,0x342,0x447,0x3ed)]=_0x4c647c[_0x5b995f],_0xd118ad[_0x5cd790(0x525,0x49c,0x4ed,0x49f)](_0xa9f91a,_0x1ad455)[_0x5cd790(0x4e3,0x415,0x4ff,0x4a2)](_0xd118ad[_0x5cd790(0x448,0x3db,0x407,0x438)])));const _0x2c1a8a={};_0x2c1a8a['type']=_0x8f86b0[_0x4300e9(0x442,0x3f1,0x395,0x3b9)],_0x2c1a8a[_0x4300e9(0x39c,0x3c4,0x476,0x45a)]={},_0x2c1a8a[_0x4300e9(0x39c,0x3c4,0x476,0x45a)][_0x4300e9(0x323,0x3b4,0x3ce,0x329)]=_0x5c2ce9,_0x2c1a8a[_0x4300e9(0x39c,0x3c4,0x476,0x45a)][_0x5cd790(0x39b,0x415,0x35e,0x375)]=_0x8f86b0['PPOhr'],_0x10a91a['push'](_0x2c1a8a);});function _0x5f38c8(_0x2f89d5,_0x5dc5b5,_0x4867e0,_0x3c9031){return _0x1ee02b(_0x2f89d5,_0x3c9031- -0x5a7,_0x4867e0-0x1e5,_0x3c9031-0x156);}const _0x260283={..._0x28636f};return _0x260283[_0x5f38c8(0x30,-0xc8,-0x66,-0x7d)]=_0x10a91a,_0x3cbdfa[_0x3da66e]=_0x260283,_0x3cbdfa;}function findMessageIndexWithPlaceholder(_0x3f5191,_0x4dc9a3){function _0xde1966(_0x1869ac,_0x15b383,_0x17788f,_0x232375){return _0x1ee02b(_0x1869ac,_0x232375- -0x2d8,_0x17788f-0x100,_0x232375-0x6);}const _0x48d5e8={'uJjIC':function(_0x515da2,_0x72dce0){return _0x515da2(_0x72dce0);},'CvjtH':function(_0x17e191,_0x24e45a){return _0x17e191<_0x24e45a;},'MhpSS':function(_0x7e1820,_0x456fa9){return _0x7e1820===_0x456fa9;},'lruGi':_0xde1966(0x284,0x28c,0x22c,0x29a),'WhZqm':'MhyOO','GlAIC':_0xde1966(0x235,0x33d,0x289,0x2e8)};function _0x599a03(_0x1b3292,_0x341059,_0x11faab,_0x6b1e97){return _0x1ee02b(_0x11faab,_0x6b1e97- -0x2a,_0x11faab-0x12f,_0x6b1e97-0xe7);}for(let _0x18a42d=0x8d*0x1d+-0x200b+0x1012;_0x48d5e8[_0x599a03(0x498,0x492,0x5b2,0x508)](_0x18a42d,_0x3f5191[_0x599a03(0x4cf,0x541,0x5ab,0x546)]);_0x18a42d++){const _0x23d13b=_0x3f5191[_0x18a42d];if(_0x48d5e8['MhpSS'](typeof _0x23d13b['content'],_0x48d5e8[_0xde1966(0x2a6,0x27c,0x2be,0x27f)])&&_0x23d13b[_0x599a03(0x458,0x5a8,0x593,0x500)]['includes'](_0x4dc9a3)){if(_0x48d5e8[_0xde1966(0x27b,0x1f0,0x1ca,0x22c)]===_0x48d5e8['WhZqm'])return _0x18a42d;else _0x48d5e8[_0xde1966(0x2d6,0x1b0,0x2c4,0x268)](_0x388d8c,_0x1e6655[_0x599a03(0x49e,0x583,0x43e,0x4dd)]);}else{if(Array['isArray'](_0x23d13b[_0x599a03(0x576,0x5b5,0x498,0x500)]))for(const _0x4588d7 of _0x23d13b[_0xde1966(0x19d,0x24a,0x2d3,0x252)]){if(_0x4588d7[_0xde1966(0x2ea,0x2c7,0x3cd,0x357)]===_0x48d5e8[_0xde1966(0x380,0x2da,0x34d,0x2d8)]&&_0x4588d7[_0xde1966(0x39f,0x274,0x2d5,0x2e8)]['includes'](_0x4dc9a3))return _0x18a42d;}}}return-(0xab*-0x22+-0x3*-0x95f+-0x2b3*0x2);}function generateRequestId(){const _0x1b678f={};_0x1b678f[_0x77b211(0x245,0x214,0x2e6,0x2fb)]='text',_0x1b678f[_0x77b211(0x1cd,0x132,0x135,0x202)]=function(_0x173e2c,_0x143dd7){return _0x173e2c===_0x143dd7;};function _0x22c89e(_0x1be479,_0x3e3076,_0x5acbb2,_0x55a154){return _0x1ee02b(_0x5acbb2,_0x1be479- -0x18f,_0x5acbb2-0xef,_0x55a154-0x111);}_0x1b678f[_0x22c89e(0x371,0x2c9,0x3e7,0x414)]='rhKPW';function _0x77b211(_0x5a2f8e,_0x5ada43,_0x58071e,_0x5c0525){return _0x1ee02b(_0x5c0525,_0x5a2f8e- -0x34c,_0x58071e-0x1dd,_0x5c0525-0x1da);}_0x1b678f[_0x22c89e(0x40d,0x406,0x473,0x36a)]=function(_0x108915,_0x1a2987){return _0x108915+_0x1a2987;};const _0x106f9f=_0x1b678f;if(crypto&&crypto[_0x77b211(0x1fd,0x256,0x21c,0x221)]){if(_0x106f9f[_0x77b211(0x1cd,0x254,0x1c9,0x15f)](_0x106f9f[_0x77b211(0x1b4,0x1fd,0x148,0x24b)],_0x106f9f['kjSij']))return crypto[_0x77b211(0x1fd,0x1ca,0x183,0x207)]();else{const _0x40baa3={};_0x40baa3[_0x77b211(0x2e3,0x365,0x2d0,0x353)]=_0x106f9f[_0x22c89e(0x402,0x441,0x3c6,0x37b)],_0x40baa3[_0x77b211(0x274,0x215,0x1d2,0x201)]=_0x27791e[_0x22c89e(0x39b,0x454,0x38a,0x302)],_0x1a8fda[_0x77b211(0x1f3,0x146,0x2a0,0x1f5)](_0x40baa3);}}return _0x106f9f[_0x77b211(0x250,0x241,0x219,0x1d0)](Date['now']()[_0x77b211(0x223,0x1cd,0x1cc,0x17a)](-0x137*-0x5+-0x1d5f+0x1770),Math[_0x77b211(0x2d1,0x24b,0x2bc,0x30b)]()[_0x22c89e(0x3e0,0x37d,0x3b6,0x41b)](0x21a5+0x136b+-0x1a76*0x2)[_0x22c89e(0x3fb,0x387,0x437,0x3a9)](0x1*-0x1bdf+0x1aab+0x136));}function _0x4cec(_0x421180,_0x2e20d6){_0x421180=_0x421180-(0x9df+0x18e7+-0x2102);const _0x107240=_0x232e();let _0x58e796=_0x107240[_0x421180];if(_0x4cec['FEIMhN']===undefined){var _0x3b2650=function(_0x229856){const _0xfb502e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5ccec5='',_0x321ac5='',_0x56aa1f=_0x5ccec5+_0x3b2650;for(let _0x2e0120=0xa3f*-0x1+0x17f4+-0x13f*0xb,_0x693471,_0xf64477,_0x48e37e=-0x42e+-0x264c+0x2a7a*0x1;_0xf64477=_0x229856['charAt'](_0x48e37e++);~_0xf64477&&(_0x693471=_0x2e0120%(0x1*-0x1ff5+-0x24a1+0xb6f*0x6)?_0x693471*(-0x9*-0x256+0x5ae*0x1+0x1*-0x1a74)+_0xf64477:_0xf64477,_0x2e0120++%(-0x369*0x1+0x12*0x38+-0x1*0x83))?_0x5ccec5+=_0x56aa1f['charCodeAt'](_0x48e37e+(0x1*-0x2359+-0xb*0x25d+0x3d62))-(0xc5*0x1f+-0x61*0x21+-0x5a8*0x2)!==0x13ef+0x1b2e+-0x2f1d?String['fromCharCode'](0xd65+0xfd4+-0x1c3a&_0x693471>>(-(-0x1*0x13de+0x17e7*-0x1+0x641*0x7)*_0x2e0120&-0x12c4*-0x1+-0x305*-0x8+-0x2ae6)):_0x2e0120:-0x4fd*0x7+0x2365+-0x7a){_0xf64477=_0xfb502e['indexOf'](_0xf64477);}for(let _0x35a0ff=0xc9d*0x2+0x47f*-0x3+-0x1*0xbbd,_0x19e77f=_0x5ccec5['length'];_0x35a0ff<_0x19e77f;_0x35a0ff++){_0x321ac5+='%'+('00'+_0x5ccec5['charCodeAt'](_0x35a0ff)['toString'](-0x513*-0x5+0x8*0x117+-0x2207))['slice'](-(-0x2020+-0x1741+0x509*0xb));}return decodeURIComponent(_0x321ac5);};_0x4cec['zVdTJA']=_0x3b2650,_0x4cec['jvSefD']={},_0x4cec['FEIMhN']=!![];}const _0x49eb2a=_0x107240[0xd1*0x17+0x1*-0xd5f+-0x568],_0x71b9f0=_0x421180+_0x49eb2a,_0x27499f=_0x4cec['jvSefD'][_0x71b9f0];if(!_0x27499f){const _0x452938=function(_0x556825){this['niUCHj']=_0x556825,this['iqLffP']=[-0x4*-0x8db+-0xd68+-0x7*0x325,0xa27+-0x14a0+-0x7*-0x17f,0x2fb*0xb+0xc9*0x31+-0x2*0x23a1],this['fhAvre']=function(){return'newState';},this['FCuGTd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['FfIsSq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x452938['prototype']['PfOSPJ']=function(){const _0x567f11=new RegExp(this['FCuGTd']+this['FfIsSq']),_0x188981=_0x567f11['test'](this['fhAvre']['toString']())?--this['iqLffP'][-0x1*-0x7ed+-0x9af+0x1c3*0x1]:--this['iqLffP'][-0x11ec+-0xfa8+0x2194];return this['xQNKAr'](_0x188981);},_0x452938['prototype']['xQNKAr']=function(_0x355d8f){if(!Boolean(~_0x355d8f))return _0x355d8f;return this['wdambx'](this['niUCHj']);},_0x452938['prototype']['wdambx']=function(_0xbfd0cd){for(let _0x396ab9=0x1333+-0x6*-0x7f+-0x162d,_0x51183e=this['iqLffP']['length'];_0x396ab9<_0x51183e;_0x396ab9++){this['iqLffP']['push'](Math['round'](Math['random']())),_0x51183e=this['iqLffP']['length'];}return _0xbfd0cd(this['iqLffP'][-0x1361*0x1+-0x12e2+0x28d*0xf]);},new _0x452938(_0x4cec)['PfOSPJ'](),_0x58e796=_0x4cec['zVdTJA'](_0x58e796),_0x4cec['jvSefD'][_0x71b9f0]=_0x58e796;}else _0x58e796=_0x27499f;return _0x58e796;}export function LLM_CHAR_MODIFY_GET_PROMPT(){function _0x1e8f72(_0x3bec1e,_0x13a675,_0x58a208,_0x5ddcbe){return _0x1ee02b(_0x13a675,_0x5ddcbe-0x74,_0x58a208-0x4b,_0x5ddcbe-0x163);}function _0x59c9bc(_0x2c1ab9,_0x238470,_0x2e0ab8,_0xa10581){return _0x1ee02b(_0x238470,_0x2c1ab9- -0x245,_0x2e0ab8-0xd8,_0xa10581-0xff);}const _0x472d34={'KYmzC':_0x1e8f72(0x6c3,0x74d,0x6df,0x6e2),'ofgGc':function(_0x5d8915,_0x207df6){return _0x5d8915(_0x207df6);},'ismvR':'获取角色修改提示词超'+'时','Rksuk':function(_0x244aa2,_0x4e5367){return _0x244aa2===_0x4e5367;},'AvDlP':_0x1e8f72(0x6ee,0x67a,0x6e6,0x6cc),'SnkxB':_0x59c9bc(0x401,0x432,0x360,0x3f2),'JLifF':function(_0x4d1cbe){return _0x4d1cbe();}};return new Promise((_0x2341b2,_0xdfac86)=>{function _0x20b613(_0xff0a8,_0x2a5914,_0x25bd48,_0x4eb045){return _0x59c9bc(_0x25bd48- -0x3af,_0x4eb045,_0x25bd48-0x1a6,_0x4eb045-0xb1);}const _0x41e1d2={'qJbzo':function(_0x19f54e,_0x384d5d){return _0x19f54e!==_0x384d5d;},'ouWXw':_0x472d34[_0x1d115(0xd9,0x95,0x148,0x111)],'rYNXe':function(_0x2e1941,_0x5ca224){return _0x2e1941!==_0x5ca224;},'uAScV':function(_0x4e1090,_0x252ef6){function _0x5841be(_0x319af4,_0x1f11c7,_0xbf4030,_0xe533f0){return _0x1d115(_0x319af4-0x139,_0xe533f0,_0xbf4030-0x2bb,_0xe533f0-0x52);}return _0x472d34[_0x5841be(0x5ac,0x475,0x4f7,0x49d)](_0x4e1090,_0x252ef6);},'pRMNk':_0x472d34[_0x20b613(-0x18,-0x112,-0x95,-0xa0)]};function _0x1d115(_0x51a1f7,_0x5c5bc9,_0x1fd145,_0x5276c0){return _0x1e8f72(_0x51a1f7-0xf1,_0x5c5bc9,_0x1fd145-0xd1,_0x1fd145- -0x473);}if(_0x472d34[_0x1d115(0x173,0x276,0x1fe,0x1ce)](_0x472d34[_0x20b613(-0x16b,-0xaa,-0xf7,-0x13a)],_0x472d34['SnkxB']))_0x4cb577['push'](..._0x3e8e41['content']);else{const _0x28925a=_0x472d34[_0x1d115(0x22f,0x1e0,0x1d0,0x250)](generateRequestId);console[_0x1d115(0x1ac,0x273,0x1f9,0x21f)](_0x1d115(0x1a9,0x1d4,0x1db,0x253)+_0x20b613(0x25,0x2f,-0x10,-0x18)+_0x1d115(0x192,0x2a3,0x1f8,0x238)+_0x20b613(-0xae,-0x151,-0xa8,-0x125)+_0x20b613(-0x47,0x22,-0x5d,0x2d)+_0x1d115(0x171,0x1c9,0x17c,0x17e)+_0x28925a+')');const _0x10606c=_0x21543b=>{function _0x305306(_0x6dd10,_0x3e3f76,_0x298f6e,_0x13662e){return _0x20b613(_0x6dd10-0x135,_0x3e3f76-0x1bc,_0x3e3f76- -0x1b,_0x6dd10);}function _0x335963(_0x52e856,_0x764dd6,_0x2be417,_0x36986e){return _0x1d115(_0x52e856-0x133,_0x36986e,_0x52e856-0x36d,_0x36986e-0xff);}if(_0x41e1d2['qJbzo'](_0x41e1d2['ouWXw'],_0x41e1d2['ouWXw']))return _0x1d5c78[_0x305306(-0xfa,-0xc6,-0x15,-0x103)]();else{if(_0x41e1d2[_0x335963(0x495,0x4f0,0x44b,0x4cb)](_0x21543b['id'],_0x28925a))return;eventSource['removeList'+_0x335963(0x531,0x5a0,0x5e5,0x5ca)](eventNames[_0x335963(0x541,0x5ad,0x4b1,0x503)+'ODIFY_GET_'+_0x305306(-0x5c,-0xda,-0xd3,-0x16a)+_0x305306(-0x15,-0x21,-0xca,-0x5b)],_0x10606c),_0x2341b2(_0x21543b[_0x305306(0xb6,0x30,0x4e,-0x16)]);}};eventSource['on'](eventNames[_0x20b613(0x38,-0x4a,-0x21,-0x2)+_0x20b613(-0x174,-0x109,-0xeb,-0x189)+_0x20b613(-0xaa,-0x166,-0xbf,-0x161)+_0x20b613(-0x93,0x9a,-0x6,0x11)],_0x10606c);const _0x16181a={};_0x16181a['id']=_0x28925a,eventSource['emit'](eventNames[_0x1d115(0x1ce,0x191,0x1d4,0x16f)+_0x1d115(0x93,0x145,0x10a,0x9f)+'PROMPT_REQ'+_0x20b613(-0x70,-0x94,-0x4,-0x5d)],_0x16181a),setTimeout(()=>{function _0x127d67(_0x567436,_0x113c10,_0x238672,_0x58c0cc){return _0x1d115(_0x567436-0x8d,_0x238672,_0x567436-0x3e8,_0x58c0cc-0x74);}eventSource[_0xe9f0b7(0x26,-0x45,0x5,-0x35)+'ener'](eventNames['LLM_CHAR_M'+_0x127d67(0x4f2,0x566,0x4a2,0x512)+_0x127d67(0x51e,0x507,0x4c0,0x566)+'PONSE'],_0x10606c);function _0xe9f0b7(_0x55e5d0,_0xc3e0e6,_0xfe8656,_0x3fc47b){return _0x1d115(_0x55e5d0-0x11a,_0xfe8656,_0x55e5d0- -0x126,_0x3fc47b-0x159);}_0x41e1d2[_0xe9f0b7(-0x12,-0xa3,-0xcb,0x84)](_0xdfac86,new Error(_0x41e1d2[_0x127d67(0x509,0x57f,0x4b6,0x4a4)]));},0x36eb+0x11b3*0x4+-0x56a7*0x1);}});}function _0x1ee02b(_0x6e422e,_0x23cb60,_0x13f6cb,_0x32e57f){return _0x4cec(_0x23cb60-0x336,_0x6e422e);}export function LLM_CHAR_MODIFY(_0x3f5927,_0x51a09f={}){function _0x47e8b7(_0xeece1e,_0x5e0c70,_0x1fbb30,_0xfa90ee){return _0x1ee02b(_0xeece1e,_0x5e0c70- -0x4ac,_0x1fbb30-0x102,_0xfa90ee-0x1a2);}const _0x4e464e={'HrYaj':function(_0x1fe10b,_0xed63bf){return _0x1fe10b(_0xed63bf);},'ThaJc':function(_0x821b45,_0x38cc29){return _0x821b45!==_0x38cc29;},'Pszfy':function(_0x3b7b1c){return _0x3b7b1c();},'QWYum':function(_0x10fe2b,_0x32a5e3){return _0x10fe2b===_0x32a5e3;},'VGLYf':'ABprd','kEhvm':'sfQnH','ygrfM':_0x2aa2cf(0x2c2,0x2d2,0x350,0x3cf),'jILHr':function(_0x10eba8,_0x1540bf){return _0x10eba8===_0x1540bf;},'MMFqM':_0x47e8b7(0x15f,0x10d,0xc9,0x12a),'frQVo':function(_0x18f8f0){return _0x18f8f0();},'NCtRF':function(_0x10b27f,_0x47a5e2,_0x246baa){return _0x10b27f(_0x47a5e2,_0x246baa);}};function _0x2aa2cf(_0xcb2cc,_0xbe6f1b,_0x1fc9e9,_0x161b53){return _0x1ee02b(_0xcb2cc,_0x1fc9e9- -0x29c,_0x1fc9e9-0xc,_0x161b53-0x1e5);}return new Promise((_0x605da5,_0x2ba343)=>{const _0x16423f=generateRequestId();function _0x41d7df(_0x30c9c8,_0x34e9d4,_0xb4d265,_0x19a07e){return _0x2aa2cf(_0x19a07e,_0x34e9d4-0x55,_0x34e9d4-0x220,_0x19a07e-0x128);}const _0x59bbf8=_0x51a09f['timeoutMs']||-0x17337+-0x74a6+0xf0bf*0x3;let _0x1f85b9=null;console[_0x31a613(0x36c,0x2e4,0x2ec,0x245)](_0x31a613(0x316,0x2f3,0x2ce,0x255)+'PromptModi'+_0x31a613(0x306,0x36d,0x353,0x313)+_0x31a613(0x1ad,0x295,0x209,0x19b)+_0x41d7df(0x60c,0x597,0x5df,0x5e4)+_0x41d7df(0x65e,0x5de,0x660,0x690)+_0x31a613(0x2b1,0x244,0x21f,0x17a)+_0x16423f+')');const _0x3eef35=()=>{eventSource[_0x4eaeaf(0x281,0x282,0x1e5,0x252)+_0x361725(-0x29,0x65,0x2e,0xd0)](eventNames[_0x4eaeaf(0x29f,0x30a,0x260,0x351)+_0x361725(-0x8d,-0x92,-0x51,-0x15)+'ONSE'],_0x42a99e);function _0x4eaeaf(_0x459ae2,_0x5bab46,_0x34b026,_0x194c07){return _0x31a613(_0x459ae2-0x82,_0x34b026,_0x5bab46-0x43,_0x194c07-0x111);}function _0x361725(_0x23d035,_0x318139,_0x2b25af,_0xc6f837){return _0x41d7df(_0x23d035-0x14d,_0x2b25af- -0x519,_0x2b25af-0x1d7,_0xc6f837);}_0x1f85b9&&(_0x4e464e[_0x361725(-0x45,0x24,0x4e,0x74)](clearTimeout,_0x1f85b9),_0x1f85b9=null);},_0x42a99e=_0x5de7d8=>{function _0x2b84c8(_0x3fe3b6,_0x76c68b,_0x5117d8,_0x4b7893){return _0x31a613(_0x3fe3b6-0x10a,_0x76c68b,_0x3fe3b6-0x2d6,_0x4b7893-0xa1);}if(_0x4e464e['ThaJc'](_0x5de7d8['id'],_0x16423f))return;_0x4e464e['Pszfy'](_0x3eef35);function _0x4d4044(_0x351368,_0x4c4922,_0x4f3b73,_0x1f1c4f){return _0x41d7df(_0x351368-0x169,_0x4f3b73- -0x67e,_0x4f3b73-0x12,_0x4c4922);}if(_0x5de7d8['success'])_0x4e464e['HrYaj'](_0x605da5,_0x5de7d8['result']);else{if(_0x4e464e[_0x2b84c8(0x5e2,0x588,0x699,0x5a1)](_0x4e464e['VGLYf'],_0x4e464e[_0x4d4044(-0x148,-0x206,-0x1e2,-0x227)])){const _0x24334b=_0x1ab0b7[_0x4d4044(-0xa0,-0x178,-0xc1,-0x7a)];let _0x2eabf3=_0x2b84c8(0x626,0x648,0x631,0x58f);return _0x2eabf3+=_0x4d4044(-0x222,-0x126,-0x19e,-0x140)+(_0x24334b['nameCN']||'')+'\x0a',_0x2eabf3+='英文名称:\x20'+(_0x24334b['nameEN']||'')+'\x0a',_0x2eabf3+=_0x4d4044(-0x14a,-0xdc,-0xf2,-0x90)+(_0x24334b[_0x4d4044(-0x10e,-0x17b,-0x1c3,-0x17e)+'ures']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x5fa,0x68d,0x640,0x6af)+(_0x24334b[_0x4d4044(-0x210,-0x278,-0x1c3,-0x256)+'uresBack']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x5fe,0x5bf,0x5b8,0x5a7)+(_0x24334b[_0x2b84c8(0x5cb,0x55e,0x67f,0x592)+'FW']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x527,0x59a,0x5e1,0x508)+(_0x24334b[_0x4d4044(-0xac,-0xc2,-0xf9,-0x54)+'FWBack']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x618,0x59b,0x5fa,0x5d4)+(_0x24334b[_0x4d4044(-0x13e,-0x1c1,-0x130,-0xea)+'W']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x612,0x56f,0x59f,0x631)+(_0x24334b[_0x4d4044(-0x120,-0x197,-0x130,-0x154)+'WBack']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x4ed,0x47a,0x53c,0x529)+(_0x24334b[_0x2b84c8(0x552,0x51e,0x541,0x5be)+_0x4d4044(-0x197,-0xc5,-0x107,-0xe2)]||'')+'\x0a',_0x2eabf3+='上半身NSFW背面:'+'\x20'+(_0x24334b['upperBodyN'+'SFWBack']||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x600,0x65e,0x5ff,0x677)+(_0x24334b[_0x4d4044(-0x137,-0x19d,-0xff,-0x13c)+'FW']||'')+'\x0a',_0x2eabf3+=_0x4d4044(-0x1a9,-0x59,-0x108,-0x139)+'\x20'+(_0x24334b['fullBodyNS'+_0x4d4044(-0xba,0x3,-0xa4,-0x33)]||'')+'\x0a',_0x2eabf3+=_0x2b84c8(0x575,0x4d8,0x612,0x5cd),_0x2eabf3;}else _0x4e464e[_0x2b84c8(0x5ad,0x638,0x53b,0x635)](_0x2ba343,new Error(_0x5de7d8[_0x4d4044(-0x1ce,-0x23a,-0x1f3,-0x1b1)]||_0x4e464e[_0x4d4044(-0x1b9,-0x1bc,-0x1bd,-0x13f)]));}};eventSource['on'](eventNames[_0x41d7df(0x565,0x557,0x563,0x57e)+'ODIFY_RESP'+'ONSE'],_0x42a99e);const _0x2eeded={};_0x2eeded[_0x41d7df(0x52c,0x5c3,0x605,0x5af)]=_0x3f5927,_0x2eeded['id']=_0x16423f,eventSource['emit'](eventNames[_0x31a613(0x301,0x20d,0x2c7,0x261)+'ODIFY_REQU'+'EST'],_0x2eeded);function _0x31a613(_0x144614,_0x31b066,_0x575bff,_0x2c18a0){return _0x47e8b7(_0x31b066,_0x575bff-0x1a0,_0x575bff-0x84,_0x2c18a0-0x14d);}_0x1f85b9=_0x4e464e['NCtRF'](setTimeout,()=>{function _0x23be7f(_0x205be9,_0x4f6005,_0x2c8031,_0x40ef9b){return _0x41d7df(_0x205be9-0x193,_0x205be9- -0x4e2,_0x2c8031-0x4d,_0x2c8031);}function _0x1c791c(_0x5dd0e6,_0xa51aa7,_0x43a727,_0xf25d8a){return _0x41d7df(_0x5dd0e6-0x8d,_0xa51aa7- -0x643,_0x43a727-0x17,_0xf25d8a);}if(_0x4e464e[_0x1c791c(-0x21c,-0x181,-0x158,-0x1c3)](_0x1c791c(-0x10a,-0xca,-0x7a,-0xde),_0x4e464e['MMFqM'])){const _0x25490a=_0x3f82d7[_0x1e1719],_0x2c5394=_0x25490a[_0x1c791c(-0x17f,-0xce,-0x140,-0x84)+_0x1c791c(-0x192,-0xfb,-0x185,-0x18c)];if(!_0x2c5394||!_0x25490a['characterP'+_0x23be7f(0x17,-0x98,-0x6a,0x6d)][_0x2c5394])return null;const _0x7feb61={};return _0x7feb61['id']=_0x2c5394,_0x7feb61[_0x1c791c(-0x38,-0x86,-0xcd,-0x45)]=_0x25490a[_0x1c791c(-0x12a,-0xce,-0xbe,-0xf7)+_0x1c791c(-0x17e,-0x14a,-0x141,-0x1dd)][_0x2c5394],_0x7feb61;}else _0x4e464e[_0x1c791c(-0x14f,-0xd4,-0x116,-0x7f)](_0x3eef35),_0x4e464e[_0x1c791c(-0x162,-0xdc,-0x55,-0x8f)](_0x2ba343,new Error(_0x1c791c(-0x13d,-0xa0,-0xda,-0xf4)+'求超时'));},_0x59bbf8);});}function preprocessTagContent(_0x6312f3){const _0x4d876c={};_0x4d876c[_0x5a7cbc(0x255,0x222,0x343,0x2a7)]='上半身NSFW背面:';const _0x2f76ba=_0x4d876c;function _0x29c8a5(_0x1800fd,_0x3ce12a,_0x52fdfe,_0x2ccc79){return _0x1ee02b(_0x52fdfe,_0x3ce12a- -0x487,_0x52fdfe-0x5a,_0x2ccc79-0x44);}let _0x494d6f=_0x6312f3[_0x5a7cbc(0x3aa,0x27d,0x375,0x312)](/:/g,':')[_0x5a7cbc(0x277,0x32c,0x259,0x312)](/\(/g,'（')[_0x29c8a5(0xaa,0xde,0xb4,0x55)](/\)/g,'）')[_0x5a7cbc(0x366,0x328,0x2f7,0x312)](/,/g,',');_0x494d6f=_0x494d6f[_0x29c8a5(0x16a,0xde,0xda,0x170)](/下半身NSWebcam:/g,_0x5a7cbc(0x3bf,0x374,0x450,0x39f)),_0x494d6f=_0x494d6f[_0x5a7cbc(0x3a4,0x3cc,0x2ff,0x312)](/下半身NSFW_背面:/g,'下半身NSFW背面:');function _0x5a7cbc(_0x1b0179,_0x2e91fd,_0x3ff61c,_0x2f22b9){return _0x1ee02b(_0x2e91fd,_0x2f22b9- -0x253,_0x3ff61c-0xe1,_0x2f22b9-0x9a);}return _0x494d6f=_0x494d6f[_0x5a7cbc(0x39a,0x279,0x2e2,0x312)](/上半身NSFW_背面:/g,_0x2f76ba[_0x29c8a5(0xf1,0x73,0x65,0x34)]),_0x494d6f;}function parseCharacterData(_0x3e8cf5){const _0x594d1e={'lOIWx':function(_0xb6d865,_0x39a141){return _0xb6d865===_0x39a141;},'XuqAq':function(_0x51ef76,_0x8750a5){return _0x51ef76(_0x8750a5);},'EWAee':_0x164dd7(-0x95,0x3,-0x3e,-0xa9)+'时','FQYxD':_0x1cc984(0x4e2,0x441,0x466,0x4d5),'mitiy':'nameCN','WKnqs':_0x1cc984(0x3c7,0x43f,0x4c4,0x420),'KswMN':_0x164dd7(0xe,0x29,0x0,0x45)+_0x164dd7(-0x96,0xf,0xf,-0x69),'wVIpn':_0x1cc984(0x450,0x40e,0x3f6,0x44c)+'uresBack','ElYvJ':'upperBodyS'+_0x164dd7(0xf5,0x148,0x129,0x165),'IcnTj':_0x1cc984(0x451,0x500,0x55f,0x4df)+'W','DAhCD':_0x1cc984(0x54a,0x588,0x565,0x4df)+_0x1cc984(0x477,0x591,0x505,0x531),'ISYZC':_0x164dd7(0x4d,0xed,0x53,0xfa)+_0x164dd7(0xec,0x148,0x195,0xe4),'MmwYe':function(_0x488159,_0x4c306f){return _0x488159===_0x4c306f;},'NFZuY':function(_0x58ee96,_0x2d4577){return _0x58ee96+_0x2d4577;},'ZLXxO':function(_0x12ca7b,_0x3dff19){return _0x12ca7b!==_0x3dff19;},'GzWFq':_0x164dd7(-0x5b,0x4d,0xe6,-0x38),'AXfpS':function(_0x426ece,_0x38edd0){return _0x426ece&&_0x38edd0;},'IHaXc':_0x1cc984(0x559,0x560,0x4e2,0x4e6),'ZLPzY':_0x1cc984(0x404,0x4b0,0x3d4,0x473),'LxVWr':_0x164dd7(0x57,0xcc,0xac,0x14f)+'PromptModi'+_0x164dd7(-0x33,0x2c,-0x6f,-0x67)+_0x1cc984(0x595,0x50a,0x49e,0x51b)},_0x21393d=_0x3e8cf5['split']('\x0a')[_0x1cc984(0x445,0x444,0x50e,0x498)](_0x537c18=>_0x537c18['trim']())['filter'](_0x22e640=>_0x22e640),_0x3623c2={};function _0x164dd7(_0x2dafe5,_0x308ddb,_0x1ceb56,_0x13dcdb){return _0x1ee02b(_0x1ceb56,_0x308ddb- -0x50e,_0x1ceb56-0x2a,_0x13dcdb-0x1bd);}_0x3623c2[_0x1cc984(0x454,0x4a4,0x479,0x4e0)]='',_0x3623c2[_0x1cc984(0x48c,0x4a7,0x496,0x420)]='',_0x3623c2[_0x1cc984(0x3df,0x480,0x4e7,0x44c)+_0x1cc984(0x46b,0x40d,0x40b,0x432)]='',_0x3623c2[_0x1cc984(0x44d,0x3cf,0x4e1,0x44c)+'uresBack']='';function _0x1cc984(_0x53cb40,_0x174c3c,_0x17f99a,_0x4d69bf){return _0x1ee02b(_0x174c3c,_0x4d69bf- -0xeb,_0x17f99a-0x99,_0x4d69bf-0x1cb);}_0x3623c2[_0x164dd7(0x104,0xf3,0x87,0x87)+'FW']='',_0x3623c2[_0x1cc984(0x4ac,0x5d0,0x46a,0x516)+'FWBack']='',_0x3623c2[_0x164dd7(0xc5,0xbc,0xeb,0x37)+'W']='',_0x3623c2[_0x1cc984(0x4b3,0x54a,0x56e,0x4df)+'WBack']='',_0x3623c2[_0x164dd7(0x4a,0x7a,0x5a,0x134)+'SFW']='',_0x3623c2['upperBodyN'+_0x164dd7(0x8,0xb3,0x28,0xb4)]='',_0x3623c2[_0x1cc984(0x5c5,0x550,0x487,0x510)+'FW']='',_0x3623c2[_0x1cc984(0x57b,0x592,0x51f,0x510)+_0x164dd7(0x104,0x148,0x1a9,0xeb)]='';const _0x3c9d1e=_0x3623c2,_0xc31ac0={};_0xc31ac0[_0x164dd7(-0x1a,0x1,0x88,0x1b)]=_0x594d1e[_0x164dd7(0xba,0x22,0x63,0xad)],_0xc31ac0[_0x1cc984(0x4e0,0x3b4,0x38e,0x43d)]=_0x594d1e['WKnqs'],_0xc31ac0['五官外貌']=_0x594d1e[_0x1cc984(0x464,0x50d,0x3fa,0x4b4)],_0xc31ac0[_0x164dd7(0xf5,0xb0,0x9a,0x95)]=_0x594d1e[_0x1cc984(0x518,0x48f,0x3f2,0x488)],_0xc31ac0[_0x1cc984(0x4f8,0x44d,0x41d,0x475)]=_0x1cc984(0x489,0x4ce,0x5cc,0x516)+'FW',_0xc31ac0[_0x164dd7(0x151,0x10d,0x5e,0x147)]=_0x594d1e[_0x164dd7(0xc5,0x41,-0x68,0x33)],_0xc31ac0['下半身SFW']=_0x594d1e['IcnTj'],_0xc31ac0[_0x164dd7(0x169,0xd0,0x15d,0x3f)]=_0x594d1e[_0x1cc984(0x50a,0x5ed,0x5b1,0x540)],_0xc31ac0['上半身NSFW']=_0x164dd7(-0xf,0x7a,0x1c,0x128)+_0x164dd7(0x75,0xe5,0x74,0x7b),_0xc31ac0[_0x164dd7(0x1b4,0x127,0x14d,0x10a)]=_0x1cc984(0x4a8,0x437,0x548,0x49d)+'SFWBack',_0xc31ac0[_0x164dd7(0xb1,-0x6,-0x15,-0x9b)]=_0x1cc984(0x497,0x53c,0x5be,0x510)+'FW',_0xc31ac0[_0x1cc984(0x470,0x510,0x4dd,0x489)]=_0x594d1e[_0x1cc984(0x5f2,0x4d0,0x54b,0x57f)];const _0x3d71e4=_0xc31ac0;for(const _0x28d566 of _0x21393d){const _0x21e2a3=_0x28d566[_0x1cc984(0x50c,0x4f9,0x4e3,0x4ea)](':');if(_0x594d1e[_0x164dd7(0x20,0xce,0x23,0x8d)](_0x21e2a3,-(-0x57c+-0x20ef*0x1+0x266c)))continue;const _0x2cd047=_0x28d566['substring'](0x740+-0x7*0x46c+-0x4*-0x5ed,_0x21e2a3)[_0x164dd7(0x59,0x6f,0x59,0x2d)](),_0x2bad84=_0x28d566[_0x1cc984(0x553,0x4a0,0x4e7,0x49f)](_0x594d1e[_0x164dd7(0x70,0xca,0xfe,0x68)](_0x21e2a3,-0x77*0x47+-0x5cf*0x1+0x26d1))[_0x164dd7(0x35,0x6f,0xb7,-0x37)]();if(_0x3d71e4[_0x2cd047]){if(_0x594d1e[_0x164dd7(0x17d,0x12c,0x16f,0x1c2)]('wyLxi',_0x594d1e[_0x164dd7(0x13b,0x8a,0x53,0x63)])){if(_0x594d1e[_0x1cc984(0x394,0x4ee,0x38b,0x43e)](_0x16020b[_0x1cc984(0x551,0x573,0x528,0x544)],_0x1cc984(0x431,0x582,0x573,0x4d5))&&_0x1d17e7[_0x164dd7(0x148,0xb2,0xe5,-0x1)][_0x1cc984(0x3ce,0x3ce,0x4b2,0x469)](_0x5c74a3))return _0x31171b;}else _0x3c9d1e[_0x3d71e4[_0x2cd047]]=_0x2bad84;}else _0x594d1e[_0x164dd7(0x5f,0xc6,0x129,0xcd)](_0x2cd047,_0x2bad84)&&(_0x594d1e[_0x1cc984(0x476,0x445,0x3aa,0x43e)](_0x594d1e[_0x164dd7(0xe4,0x8d,0xce,0x52)],_0x1cc984(0x4dd,0x48f,0x466,0x50f))?(_0x380eb5['removeList'+_0x1cc984(0x478,0x48f,0x51b,0x4d8)](_0x13689a['LLM_CHAR_M'+_0x1cc984(0x44f,0x44b,0x3cf,0x41e)+_0x164dd7(0xce,0x27,-0x2b,-0x36)+_0x164dd7(0x175,0xe0,0xcc,0xc3)],_0x2f35d5),_0x594d1e[_0x164dd7(0xfc,0x11b,0x13b,0x17b)](_0x2691f5,new _0x21c73d(_0x594d1e[_0x164dd7(0x91,0x43,-0x26,-0x47)]))):console[_0x164dd7(0x81,0xea,0x11a,0x118)](_0x1cc984(0x46a,0x530,0x4a0,0x4ef)+_0x164dd7(0x12d,0xd6,0x5c,0xf3)+'fy]\x20未识别的人物'+_0x1cc984(0x4d1,0x4a8,0x370,0x427)+_0x2cd047+'\x22'));}if(!_0x3c9d1e[_0x1cc984(0x53f,0x520,0x487,0x4e0)]){if(_0x594d1e['MmwYe'](_0x164dd7(0x45,-0x1,0x12,0x70),_0x594d1e[_0x164dd7(0x177,0x11e,0x106,0x118)])){const _0x59c7dc={};_0x59c7dc['type']=_0x594d1e[_0x1cc984(0x560,0x43e,0x565,0x4e3)],_0x59c7dc[_0x1cc984(0x561,0x435,0x4bb,0x4d5)]=_0x1cc984(0x4f7,0x438,0x49d,0x48c)+_0x2e20d6[_0x1cc984(0x435,0x42d,0x4f1,0x485)]+'张'+_0x107240+']',_0x421180[_0x164dd7(0x7c,0x31,0x22,0xb1)](_0x59c7dc);}else return null;}return console[_0x164dd7(0x14d,0xea,0x101,0x169)](_0x594d1e[_0x164dd7(0x1b,0x7d,0x12e,-0x38)],_0x3c9d1e),_0x3c9d1e;}function extractCharacterTags(_0x1d6ceb){const _0x47f995={'oVXNR':function(_0x576141,_0x4e4342){return _0x576141!==_0x4e4342;},'PtpFv':function(_0x3c12fc,_0x31842e){return _0x3c12fc(_0x31842e);},'prraw':function(_0x40d852,_0x295214){return _0x40d852(_0x295214);},'NItpr':_0x4a1982(-0x88,-0x5b,-0xcf,0xb),'dsZzY':function(_0x1f52e3,_0x664b05){return _0x1f52e3(_0x664b05);},'Faonb':'GAQWz'};function _0x4a1982(_0x5949aa,_0x2e9c59,_0x347ecc,_0x5ce7d3){return _0x1ee02b(_0x2e9c59,_0x5949aa- -0x674,_0x347ecc-0x105,_0x5ce7d3-0x1cf);}const _0x5dc3a9={};_0x5dc3a9[_0x4a1982(-0x126,-0x11b,-0xff,-0x175)]=[];const _0x35316e=_0x5dc3a9;function _0x2ea6d2(_0xbecb2a,_0x5b8b30,_0xe8228e,_0x229fa6){return _0x1ee02b(_0xe8228e,_0x5b8b30- -0x6ba,_0xe8228e-0x1ab,_0x229fa6-0x12a);}_0x1d6ceb=_0x1d6ceb[_0x2ea6d2(-0x107,-0x155,-0x1f4,-0x167)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x4a1982(-0xf7,-0x1a2,-0x7a,-0xb6)]();const _0x170649=/<人物>([\s\S]*?)<\/人物>/g;let _0x58fd36;while(_0x47f995['oVXNR'](_0x58fd36=_0x170649['exec'](_0x1d6ceb),null)){const _0x4d9010=preprocessTagContent(_0x58fd36[0xeda+-0x1*-0x1a8d+-0x1*0x2966]),_0x5d4e1b=_0x47f995[_0x2ea6d2(-0x234,-0x1bc,-0x1a0,-0x148)](parseCharacterData,_0x4d9010);if(_0x5d4e1b){if(_0x47f995['oVXNR'](_0x4a1982(-0x6f,-0xf2,-0x108,-0xe),_0x47f995[_0x2ea6d2(-0xd8,-0x13a,-0x149,-0x1c8)])){if(_0x47f995[_0x4a1982(-0x5f,0x42,0x31,-0x75)](_0xbed1c6['id'],_0x4f274f))return;_0x4509f6(),_0x2afc53['success']?_0x47f995[_0x4a1982(-0xd3,-0x36,-0x9c,-0x5e)](_0x17501d,_0x2b226f[_0x2ea6d2(-0x232,-0x1b3,-0x229,-0x18d)]):_0x47f995[_0x2ea6d2(-0xf,-0xaf,-0x156,-0xb3)](_0x543578,new _0x38ac6d(_0x2252ee['result']||_0x47f995[_0x2ea6d2(-0x148,-0x12d,-0x8f,-0xa5)]));}else _0x35316e[_0x4a1982(-0x126,-0x1c2,-0xf4,-0x1de)][_0x2ea6d2(-0x1d7,-0x17b,-0x165,-0x186)](_0x5d4e1b);}}return _0x35316e;}function _0x232e(){const _0x50e30b=['pc/KURRNIAK+','yururNy','uMvkBeW','lI4U','zNLDievYCM9YoG','r2Xbsum','ig1LC3nHz2uGAq','6kkR5l2/55sO77YA','DMfSDwu','uLHvseS','C2Lsz0q','A2D6ENO','y2ntBLi','zxjLzcK6','ENPnDeS','seDxDxq','q29UDgv4Da','C2vHCMnO','qwXNqK0','5lQu5A6y5Asw6lkm6iom6z2I','CujuCfu','Dgv4Da','u0zxqMfJAW','zM9YrwfJAa','zw5LCG','CMvZzxrjza','DxP4tgC','twj5A3C','DwrcuNi','5PYQ5zYOieXmtsdOVPpLH7RKUk0','BwvZC2fNzsbHDa','zNvSBejVzhLtrG','BMfTzuno','Aw1Hz2vZihrVia','EeDtCfe','rLfzEeq','sKXPzKy','uNzMwLa','zMnyDNC','vMfYAwfIBgvZ','teXnx0niqvjFtq','qvHMCfm','Aw5KzxHpzG','qK1rrKm','wvjou2y','tKzADvK','AeDrtem','w2nOyxjHy3rLCG','BM9IwvC','tw13wwu','z2vUzxjHDgLVBG','5lIl5y2k6lQRu0zx6iom6z2I','mJy4nZblDfb2tuC','y29UDgv4DdO','DgvYigXPC3qGDa','C1vWCvK','shjzywO','uhjVBxb0tw9KAq','koEPUIK','mtyYndG3nuf6D1r6ta','C3vJy2vZCW','y1nstfm','5lIk5y2k6lQRtLngv+IdJoMDOJO','BKTnDMW','zNjrvM8','teXnioIVT+AXGUwKSEI0Pq','zLnKuuC','ue9ou0u','AMvNBwe','vuvtva','y2HHCMfJDgvYua','5lIl5y2k6lQRtLngv+IdJoMDOJO','u0zx','Bw9KAwz5ihjLCq','D3vvv2y','zxiGChjVBxb0ia','zNLDifjLCxvLCW','Bg9N','s0TMthq','wwfsCvG','zNvSBejVzhLouW','AMXOsw4','uMTZDwS','vvHIzKm','AuvmDMG','tLvTAxK','DxbWzxjcB2r5uW','ruTRB0u','5yEg5Ash5PU05PAW6kEs6iMYici','i3n0lwnOyxr1oa','r0frv3O','5PwW5O2UoG','5y+c6icd5zU+54Mh','5lQu5A6y5Asw6lkmoIa','EM9xs0W','icdMLRa6ia','ChjYyxC','t21MqwC','zNLDien1CNjLBG','uvz5sLq','Eg5nEuC','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','ExPQCuu','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','B2rPzNKGteXnia','rufZq3i','B1zytLi','yMfZzty0','y29UC3rYDwn0BW','uvDzDw0','mZGYnZuYruP0CKHy','zezYs1q','5lIk5y2k6lQRu0zx6iom6z2I','v0jHy2S','CMfUzg9T','zNLDiev4DhjHyW','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','mta3mJuZnNrpDxniDa','rMz3Be0','qMXtueC','5Rgc6lAf5PE2','tLb4rNu','D01IrNK','yvHSEvu','D29YBgqGyM9VAW','qMLdENi','whvXqxe','qLPIuhi','refOq0q','wKXqELK','DxjLC0jHy2S','CfrjzKK','DhLWzq','5lQu5A6y5Asw6lkm6iom6z2IoIa','zgf0ytPPBwfNzq','zNLDienOyxjHyW','CKvpv0G','5lIk5y2k6lQRu0zxoIa','5lIk5y2k6lQRtLngv+IdJoMDOG','5lIl5y2k6lQRtLngvZOG','CvPADuu','s3POD0y','zgf0yq','wKXyEe8','B2zNr2m','BuXmtMK','vKfJBLy','BM93z2q','ChjVBxb0','6iUX5PAh5zcn56EWoIa','CxPdDxG','zw1Xvfy','qxLrq0S','ELP0Cgq','l3bUzZTIyxnLnG','z1D1zwu','AM9PBG','5lIl5y2k6lQRu0zx6iom6z2IoIa','zKDkrKK','twztzfq','ugrtA0y','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','zgHvEvy','5lIl5y2k6lQRu0zxoIa','CMfJDgvYihrHzW','B3iGzgvIDwDNAq','wKT1v1e','wfjczhK','DNrks20','tsbVDxrWDxqGzG','BMfTzq','rLDcywnR','B2jQzwn0','DvrgsKO','mLbxDMD2EG','CMvXDwvZDcaOsq','AhDVqui','pos6UUEjQt4k','Dhb1DdO','veDfz0e','zNLDiev4zwn1Da','mZa5mZiWohb6v1b5yG','vgrOAfq','zuzSqNK','uMvxzhO','yxv0BW','AvHQELC','zeTUALe','AxnbCNjHEq','DhjPz2DLCG','zNLDie5VignOyq','svnzwKm','zNLDifjHDYbmta','zgf5B2u','wLLcCMC','AKL3t28','DhzpBLe','vhvtq3O','C2L6zq','qxzeBfa','zhnAELK','zNLDifnHDMvKia','A2PtAwO','rfj3Bvi','zgf0ytO','rMzLzMO','v2HACw0','v29YBgrcB29R','EvvWCgK','CMvZDwX0','5lIl5y2k6lQRtLngvW','t0rjrLLFr0vuxW','mZi3nZy5zvrirvnW','BMfTzuvo','DKThsuy','A1POru0','D1rOEfC','5lIT5PAh5zcn56EW','C3HrzgS','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','5A2x5Q61ici','Dufty1y','EMHxsgy','Aw5NignOyxiGBq','DurIthy','qMTPsMS','A0vODM0','vePPsum','v3bdBva','uLvPrK0','qNLjza','DxjLCW','BMrLEdO','6k6+ici','CfjntMS','zeLOv2C','ugvKDMm','5lIk5y2k6lQRtLngvZOG','yNLptgK','CgTgyMO','rgzSsKS','CLLowgu','6iUX5PAh5zcn56EW','Be9jv3G','y29UDgvUDa','rdOG','5lIl5y2k6lQRu0zx','sMnQqNG','Eu5xAge','lxrHyI1JAgfYyq','BwL0AxK','rxfHwNG','q3zQDeG','EwTny0W','mJq0zfvvqK9g','ufjptvbux1jfuW','DMfYAwfIBgvZoG','zMfJAwfSrMvHDa','qNDNugK','qu9vvvG','zNLDioINO+AEKowiSoEAHos6UUEjQq','zgv0ywLS','z3nrt3C','EwDYzK0','AKLmshi','ChvZAa','DuPQsum','EgTYBLy','BLbTy2y','BMCGy2HHCMfJDa','t0rjrLLFuKvtua','sLPbs1y','uKDItuS','s1LTEKm','vKjdCMC','CMfUzg9Tvvvjra','Aw5MBW','CMvTB3zLtgLZDa','DgLUzYbJAgfYia','CLziweq','y2HHCMfJDgvYCW','rwXzDKO','kcGOlISPkYKRkq','rvDbzwu','DLPAAfO','BejlrfO','Aw5JBhvKzxm','zw1PDa','uwDbwwm','Bhj1r2K','zxjYB3i','Aw5WDxq','tKDRBwi','D3LmEgK','5lIT5PAh5zcn56EWoIa','5lIk5y2k6lQRu0zx6iom6z2IoIa','DePot28','AxnTDLi','5lIk5y2k6lQRu0zx','teXnioI/LowBNUE7K+AENos4UUEPUG','DwrAvLq','CMvWBgfJzufSBa','quL5r0q','CMvWBgfJzq','CfPOBK8','5lQu5A6y5Asw6lkm','E3VLVzpLIy3OP5lOIBj9Fq','r2L0Bu4','CYbMB3vUzcbPBG','yxbWBhK','y2HHDe1LDgfKyq','re9zqxG','rfLSwMC','Dg9tDhjPBMC','BgvUz3rO','mZq3nZC4ouXuwLnZqq','C3rYAw5N','D1zjCg4','5lIl5y2k6lQRtLngv+IdJoMDOG','CMvZzxrZ','qxzTt28','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','zNLDieXmtsbVDq','EgvYtNq','sKTbCve','Bxb0icHjrdOG','DffMB2y','DhjPBq','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','iIdNMOtKU6xKUiVMLBdMJA46cGO','rMfVBMi','DgLTzw91De1Z','Bgz5sM0','BwfW','EvbRBMm','wwnTwva','BunisMq','DgvKigrHDge6','DxbWzxjcB2r5tG','DwPkq1u','C3vIC3rYAw5N','thHwv3i','D254CLG','tKL0Chi','uNbiv2O','ig91Dhb1Da','DxjS','u1LVqNC','uwjnz0i','q3D2EgK','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','uwTTA3C','5lIk5y2k6lQRtLngvW','Bw9KAwz5ihbYBW','r3PxrNe','DgvYihrYAwDNzq','uu9urvq','suHHwgm','DLfPEwS','serQzeW','z2v0rwXLBwvUDa','s3n3tu4','Aw1Hz2vFDxjS','uhrWrNy','twvVAM0','A3fnu0O','sMvuz1e','wxfWru8','y2HHCL8','zNLDiezPBMfSia','CuT5vvq','icdML6C6ia','y3rLCG'];_0x232e=function(){return _0x50e30b;};return _0x232e();}function getCurrentCharacterPreset(){const _0x378e18=extension_settings[extensionName];function _0x5bdddd(_0x2e05c7,_0x4a9d59,_0x5b5cd2,_0x100250){return _0x1ee02b(_0x5b5cd2,_0x2e05c7- -0xbe,_0x5b5cd2-0x158,_0x100250-0xe6);}const _0x28b92b=_0x378e18[_0x5bdddd(0x533,0x4b4,0x521,0x515)+'resetId'];if(!_0x28b92b||!_0x378e18[_0x5bdddd(0x533,0x487,0x533,0x50e)+'resets'][_0x28b92b])return null;const _0x28a35a={};_0x28a35a['id']=_0x28b92b;function _0x9a227c(_0x2e15cd,_0x640e36,_0x457967,_0x51131a){return _0x1ee02b(_0x51131a,_0x2e15cd- -0x63c,_0x457967-0x4,_0x51131a-0x14b);}return _0x28a35a[_0x5bdddd(0x57b,0x4fd,0x629,0x4e3)]=_0x378e18[_0x5bdddd(0x533,0x5e4,0x59c,0x577)+_0x9a227c(-0xc7,-0x128,-0x67,-0x11)][_0x28b92b],_0x28a35a;}function buildCharacterText(_0x3a8a63){const _0x3e92de={};_0x3e92de[_0x225d6b(0x157,0x1eb,0x27a,0x149)]='<人物>\x0a',_0x3e92de[_0x4441c7(0x553,0x5ed,0x648,0x597)]='</人物>';const _0x54fb00=_0x3e92de;function _0x4441c7(_0x80a69f,_0x222885,_0x367c49,_0x18b0c6){return _0x1ee02b(_0x80a69f,_0x222885- -0x66,_0x367c49-0x42,_0x18b0c6-0x13);}function _0x225d6b(_0x152779,_0x672df1,_0x3c23a7,_0x52c1a0){return _0x1ee02b(_0x152779,_0x672df1- -0x42f,_0x3c23a7-0xb3,_0x52c1a0-0x3f);}const _0x5e0508=_0x3a8a63[_0x225d6b(0x267,0x20a,0x22c,0x24c)];let _0x4137b8=_0x54fb00[_0x225d6b(0x267,0x1eb,0x1ed,0x207)];return _0x4137b8+=_0x4441c7(0x530,0x4f6,0x4df,0x4bb)+(_0x5e0508[_0x225d6b(0x242,0x19c,0x115,0x22c)]||'')+'\x0a',_0x4137b8+=_0x225d6b(0x24f,0x211,0x1d6,0x23d)+(_0x5e0508[_0x4441c7(0x4a5,0x4a5,0x41d,0x478)]||'')+'\x0a',_0x4137b8+=_0x4441c7(0x51e,0x5a2,0x57c,0x5b2)+(_0x5e0508[_0x4441c7(0x4e5,0x4d1,0x537,0x4ae)+_0x4441c7(0x498,0x4b7,0x46b,0x4be)]||'')+'\x0a',_0x4137b8+='五官外貌背面:\x20'+(_0x5e0508[_0x225d6b(0x195,0x108,0x139,0x158)+_0x4441c7(0x550,0x5c7,0x5ed,0x552)]||'')+'\x0a',_0x4137b8+=_0x225d6b(0x170,0x205,0x1e0,0x2ae)+(_0x5e0508[_0x4441c7(0x62e,0x59b,0x5c7,0x582)+'FW']||'')+'\x0a',_0x4137b8+=_0x4441c7(0x55e,0x4f7,0x496,0x5a8)+(_0x5e0508['upperBodyS'+_0x4441c7(0x5d0,0x5f0,0x612,0x67e)]||'')+'\x0a',_0x4137b8+=_0x4441c7(0x542,0x5e8,0x56c,0x67d)+(_0x5e0508['fullBodySF'+'W']||'')+'\x0a',_0x4137b8+='下半身SFW背面:\x20'+(_0x5e0508['fullBodySF'+_0x4441c7(0x62e,0x5b6,0x591,0x64f)]||'')+'\x0a',_0x4137b8+=_0x225d6b(0xdb,0xf4,0xcc,0x1aa)+(_0x5e0508[_0x4441c7(0x4db,0x522,0x573,0x59f)+_0x4441c7(0x54d,0x58d,0x4f1,0x5c3)]||'')+'\x0a',_0x4137b8+=_0x4441c7(0x5df,0x583,0x5a0,0x5c0)+'\x20'+(_0x5e0508['upperBodyN'+_0x4441c7(0x5a1,0x55b,0x551,0x580)]||'')+'\x0a',_0x4137b8+=_0x225d6b(0x245,0x207,0x26e,0x1d1)+(_0x5e0508['fullBodyNS'+'FW']||'')+'\x0a',_0x4137b8+=_0x225d6b(0x11d,0x1c3,0x18a,0x1c7)+'\x20'+(_0x5e0508[_0x4441c7(0x5a0,0x595,0x60a,0x56a)+_0x4441c7(0x675,0x5f0,0x6a1,0x5bf)]||'')+'\x0a',_0x4137b8+=_0x54fb00[_0x225d6b(0x176,0x224,0x28a,0x1f5)],_0x4137b8;}export async function handleCharacterPromptModify(_0x5a4ae9,_0xf204aa=[]){function _0x39df8e(_0x1fff90,_0x33c613,_0x55aa5a,_0x5404d2){return _0x1ee02b(_0x1fff90,_0x5404d2- -0x3a,_0x55aa5a-0x1a5,_0x5404d2-0x1e);}const _0x2d0b9e={'QOTET':_0x39df8e(0x5c8,0x5be,0x532,0x538),'XRBdy':function(_0x89373a,_0x46f4a7){return _0x89373a===_0x46f4a7;},'uDbLv':_0x39df8e(0x647,0x6b4,0x59d,0x61d),'KKfLt':function(_0x1fee07,_0x3fb471){return _0x1fee07+_0x3fb471;},'NGkmb':_0x39df8e(0x519,0x46b,0x46f,0x4c8),'OmfAg':_0x41147e(-0xe6,-0x15,-0x7d,-0x96),'WpCmP':function(_0x118f90,_0x2b61c4){return _0x118f90(_0x2b61c4);},'QpcWz':_0x41147e(-0x179,-0xac,-0x56,-0xdb)+_0x41147e(-0xb5,-0x141,-0x4d,-0xd7),'zZtpd':function(_0x443083,_0x1cf1d1){return _0x443083!==_0x1cf1d1;},'Mbykw':function(_0x30e517,_0x45926a){return _0x30e517(_0x45926a);},'AvmOo':function(_0x3dda7e,_0x31d2ae,_0x296a54){return _0x3dda7e(_0x31d2ae,_0x296a54);},'qZZuE':'未在\x20LLM\x20输出中'+_0x41147e(-0x135,-0x14b,-0x190,-0xea),'QVyJT':_0x39df8e(0x543,0x58c,0x531,0x5a0)+_0x41147e(-0x64,-0xf2,-0x125,-0x116)+_0x39df8e(0x681,0x6ce,0x698,0x62f)+_0x39df8e(0x69e,0x5df,0x5ab,0x615)+_0x39df8e(0x50d,0x4a2,0x47f,0x530)+_0x39df8e(0x5c7,0x4ba,0x5a1,0x555),'TAeyi':_0x41147e(-0x1d4,-0x127,-0xd4,-0x120)+'PromptModi'+'fy]\x20Starti'+_0x39df8e(0x45a,0x463,0x59e,0x509)+_0x41147e(-0x141,-0xf4,-0x163,-0x104)+_0x41147e(-0x1aa,-0xf7,-0x1b2,-0x106)+'uest...','udZVT':'[character'+_0x41147e(-0x1af,-0xf7,-0x69,-0x116)+'fy]\x20正在处理角色'+'提示词修改请求...','JAMRY':_0x41147e(-0x21e,-0x2a6,-0x240,-0x1f9),'nobYW':function(_0x3f48b4){return _0x3f48b4();},'dIhWg':_0x41147e(-0xb,-0x9e,-0x45,-0xae),'DflJK':_0x41147e(-0xa2,-0x1c4,-0x199,-0x120)+_0x39df8e(0x577,0x5df,0x605,0x5aa)+_0x39df8e(0x56c,0x58d,0x5c8,0x5d3)+'t\x20preset:','EAsCr':_0x39df8e(0x53b,0x5e8,0x604,0x5a0)+'PromptModi'+_0x39df8e(0x4eb,0x4a5,0x4c1,0x4c5)+_0x39df8e(0x488,0x4bd,0x56e,0x4fc),'ccSnR':function(_0x26dd2a,_0x16a154){return _0x26dd2a!==_0x16a154;},'pTIfI':_0x39df8e(0x46c,0x52a,0x578,0x507),'GitmN':'qMtEI','mLLNi':function(_0x43909f,_0x5f2096,_0x1edce1){return _0x43909f(_0x5f2096,_0x1edce1);},'cyOpb':function(_0xf496b6,_0x14617c){return _0xf496b6(_0x14617c);},'hGQLC':_0x39df8e(0x63f,0x5dc,0x5e2,0x5a0)+_0x39df8e(0x598,0x607,0x5c6,0x5aa)+'fy]\x20合并相邻消息'+'后:','AlgBM':function(_0x1723a3,_0x1c3f5d){return _0x1723a3||_0x1c3f5d;},'MWmRA':function(_0x2e5ba8,_0x282d6e,_0x26e6bb){return _0x2e5ba8(_0x282d6e,_0x26e6bb);},'xnMyG':function(_0x4379e5,_0x3b5712,_0x132dd9,_0x61d3fe,_0x27c059){return _0x4379e5(_0x3b5712,_0x132dd9,_0x61d3fe,_0x27c059);},'wThxW':_0x41147e(-0x18a,-0x1b5,-0x1af,-0x192),'Meojm':_0x39df8e(0x649,0x60a,0x5bc,0x5a0)+'PromptModi'+_0x39df8e(0x5d1,0x5fa,0x59c,0x56d)+'prompt:','YRNSf':function(_0x541c60,_0x504658){return _0x541c60>_0x504658;},'Qkmkw':function(_0x44591b,_0x522bfc){return _0x44591b!==_0x522bfc;},'hwoAB':_0x41147e(-0x82,-0x12b,-0xd,-0x8d),'emqTV':function(_0x28bcc5,_0xfd3436){return _0x28bcc5>_0xfd3436;},'wnxrX':function(_0x11a03d,_0x4b14ce){return _0x11a03d>=_0x4b14ce;},'udBRr':function(_0x31af1f,_0x52f9f2,_0x3f5a8e,_0x4884ca,_0x594833){return _0x31af1f(_0x52f9f2,_0x3f5a8e,_0x4884ca,_0x594833);},'kgzzz':_0x41147e(-0x64,-0x147,-0x196,-0xf3),'sxQdk':'[character'+_0x39df8e(0x555,0x561,0x657,0x5aa)+'fy]\x20Attach'+'ed','RUJJW':function(_0x4d2643,_0x4eba73,_0x1cdced){return _0x4d2643(_0x4eba73,_0x1cdced);},'fSdQG':'[character'+'PromptModi'+_0x41147e(-0x1e9,-0x159,-0x139,-0x182)+_0x39df8e(0x5e3,0x60f,0x5cc,0x623),'byOLi':_0x39df8e(0x55c,0x5ac,0x5b0,0x527),'zoWKL':function(_0x4ddeb0,_0x353887){return _0x4ddeb0(_0x353887);},'qzCux':'[character'+_0x39df8e(0x5b2,0x5a7,0x4f2,0x5aa)+_0x41147e(-0x59,0x9,-0xcc,-0x8f)+_0x41147e(-0x41,0xa,-0x4c,-0xa6)+'or\x20debuggi'+'ng:','JZAKV':'角色提示词修改完成！','dKnjQ':_0x39df8e(0x5e7,0x59d,0x59b,0x5a0)+_0x39df8e(0x535,0x581,0x664,0x5aa)+_0x39df8e(0x5e1,0x509,0x5e3,0x575)};console[_0x41147e(-0x1b5,-0x136,-0x1ac,-0x102)](_0x2d0b9e['TAeyi']),toastr[_0x41147e(-0x112,-0x19b,-0x18b,-0x1b0)](_0x2d0b9e[_0x41147e(-0x144,-0x177,-0x16e,-0x198)]);function _0x41147e(_0xa2c2e1,_0x52aef9,_0x6d3b83,_0x2c9d42){return _0x1ee02b(_0xa2c2e1,_0x2c9d42- -0x6fa,_0x6d3b83-0x88,_0x2c9d42-0x18e);}try{if(_0x2d0b9e['JAMRY']!==_0x41147e(-0xfb,-0x21b,-0x149,-0x167)){const _0x2949d2=_0x2d0b9e[_0x41147e(-0x173,-0xe9,-0xdb,-0x11f)](getContext),_0x2a6ba4=extension_settings[extensionName],_0x4d1cb0=_0x2d0b9e[_0x39df8e(0x627,0x552,0x55f,0x5a1)](getCurrentCharacterPreset);if(!_0x4d1cb0){toastr[_0x39df8e(0x5bf,0x5a8,0x4fa,0x51e)](_0x2d0b9e[_0x41147e(-0x1ac,-0x1f6,-0x263,-0x1d9)]);return;}console[_0x41147e(-0x67,-0x84,-0x7a,-0x102)](_0x2d0b9e[_0x41147e(-0x279,-0x157,-0x1f2,-0x1d4)],_0x4d1cb0['id']);const _0x28938a=_0x4d1cb0[_0x41147e(-0x128,-0x80,-0x111,-0xc1)][_0x41147e(-0x146,-0x15a,-0x13a,-0x11d)+_0x41147e(-0x148,-0xe6,-0x162,-0x13f)]||'',_0x45113e=_0x4d1cb0[_0x41147e(-0x69,-0xe7,-0x51,-0xc1)][_0x41147e(-0x11c,-0x1b8,-0x1a3,-0x11d)+_0x39df8e(0x4bd,0x567,0x4b7,0x4cb)]||'',_0x2c4f1d=_0x4d1cb0[_0x39df8e(0x5db,0x62d,0x5ca,0x5ff)][_0x39df8e(0x5b1,0x5f2,0x60c,0x5a3)+_0x41147e(-0x1a9,-0x94,-0xdf,-0x128)]||{};console['log'](_0x39df8e(0x535,0x643,0x63c,0x5a0)+_0x41147e(-0x7c,-0xb5,-0x139,-0x116)+_0x39df8e(0x475,0x4e6,0x559,0x4c5)+_0x41147e(-0x79,-0xdf,-0x86,-0x11a),_0x28938a),console[_0x41147e(-0x173,-0xbc,-0x99,-0x102)]('[character'+'PromptModi'+_0x39df8e(0x52e,0x442,0x514,0x4c5)+_0x41147e(-0x100,-0x110,-0x14d,-0xd3)+':',_0x45113e),console[_0x41147e(-0x142,-0x9e,-0x100,-0x102)](_0x2d0b9e[_0x41147e(-0x139,-0xe6,-0xb6,-0xe6)],_0x2c4f1d);const _0x223bdb=_0x5a4ae9||'',_0x398e45=[];if(_0x5a4ae9){if(_0x2d0b9e[_0x41147e(-0xfb,-0x1a7,-0x1b1,-0x143)](_0x2d0b9e[_0x39df8e(0x548,0x5cb,0x63d,0x5f4)],_0x2d0b9e[_0x41147e(-0x72,-0x4d,-0x38,-0xcc)])){const _0xc29c69=typeof _0x2e0120===_0x2d0b9e[_0x41147e(-0x1ba,-0x108,-0xd2,-0x160)]?_0x693471:_0xf64477[_0x41147e(-0x42,-0x4b,-0x189,-0xe4)],_0x21e73a=_0x2d0b9e[_0x41147e(-0x7,-0x6c,-0x14f,-0xa8)](typeof _0x48e37e,_0x2d0b9e[_0x41147e(-0x22f,-0x17b,-0x1b1,-0x1e4)])&&_0x35a0ff[_0x41147e(-0xbd,-0x3f,-0x26,-0xa5)]?_0x19e77f['name']:''+_0x452938+_0x2d0b9e[_0x41147e(-0xee,-0xd5,-0xdb,-0x101)](_0x556825,-0x149f*-0x1+-0x1cdb+-0x13*-0x6f),_0xca023b={};_0xca023b[_0x39df8e(0x665,0x67b,0x562,0x5f5)]=_0x39df8e(0x637,0x637,0x5b1,0x586),_0xca023b[_0x41147e(-0x1c4,-0x1bb,-0x1d1,-0x13a)]='['+_0x21e73a+']',_0x567f11[_0x41147e(-0x1d7,-0x218,-0x1e7,-0x1bb)](_0xca023b);let _0x49b038=_0xc29c69;!_0xc29c69['startsWith'](_0x2d0b9e[_0x39df8e(0x5b9,0x4e8,0x58a,0x520)])&&(_0x49b038=_0x41147e(-0x19,-0x46,-0xf7,-0xc9)+_0x41147e(-0xe9,-0x91,-0x34,-0xb5)+'4,'+_0xc29c69);const _0xded2b5={};_0xded2b5[_0x41147e(-0x223,-0x1c3,-0xcd,-0x16a)]=_0x49b038,_0xded2b5[_0x41147e(-0x20c,-0x19f,-0x1ab,-0x1bf)]=_0x2d0b9e[_0x41147e(-0xcc,-0x15c,-0xbe,-0xee)];const _0x217105={};_0x217105['type']=_0x41147e(-0x116,-0x189,-0x16b,-0x15a),_0x217105['image_url']=_0xded2b5,_0x188981[_0x39df8e(0x509,0x49a,0x4d4,0x505)](_0x217105);}else _0x398e45[_0x39df8e(0x55a,0x5b3,0x482,0x505)](_0x5a4ae9);}_0x28938a&&_0x398e45['push'](_0x28938a);_0x45113e&&(_0x2d0b9e[_0x41147e(-0xe0,-0xc,-0x130,-0xa8)](_0x2d0b9e[_0x41147e(-0x154,-0x141,-0x243,-0x191)],_0x2d0b9e[_0x39df8e(0x4b3,0x5e4,0x512,0x52f)])?_0x398e45[_0x39df8e(0x552,0x554,0x50b,0x505)](_0x45113e):(_0x248fa2(),_0x2d0b9e[_0x41147e(-0x20f,-0x1bb,-0x1f8,-0x1e0)](_0x4c49f9,new _0x393456(_0x2d0b9e['QpcWz']))));const _0x24b775=_0x398e45['join']('\x0a');console[_0x41147e(-0xd5,-0xc7,-0x138,-0x102)](_0x39df8e(0x507,0x527,0x5ea,0x5a0)+_0x39df8e(0x5f7,0x5dd,0x55e,0x5aa)+_0x39df8e(0x62d,0x63e,0x57c,0x5f8)+_0x41147e(-0x1fe,-0x11e,-0x144,-0x161)+'r\x20text:',_0x24b775);let _0xe84ebc=_0x2d0b9e[_0x41147e(-0xe3,-0x134,-0xe,-0xbe)](buildPromptForRequestType,'char_modif'+'y',_0x223bdb);const _0x1d389=_0x2d0b9e['cyOpb'](generateCharacterListText,_0x24b775),_0x1053e4=_0x2d0b9e[_0x39df8e(0x506,0x528,0x5d8,0x5a1)](generateOutfitEnableListText),_0x228023=generateCommonCharacterListText();console[_0x39df8e(0x53b,0x622,0x65d,0x5be)](_0x41147e(-0x107,-0x134,-0x6a,-0x120)+_0x39df8e(0x4f4,0x586,0x561,0x5aa)+'fy]\x20Charac'+_0x41147e(-0x151,-0x150,-0x142,-0x119)+'ext\x20(trigg'+_0x41147e(-0x11e,-0xf7,-0xbb,-0x142),_0x1d389);const _0xe46b98=_0x2949d2[_0x39df8e(0x51d,0x588,0x4a7,0x532)+'ta']?.['variables']||{},_0x304836=_0x2d0b9e[_0x39df8e(0x4c2,0x4e4,0x547,0x4e0)](buildCharacterText,_0x4d1cb0);_0xe84ebc=mergeAdjacentMessages(_0xe84ebc),console[_0x39df8e(0x536,0x5cc,0x5d5,0x5be)](_0x2d0b9e[_0x39df8e(0x552,0x579,0x61c,0x59f)],_0xe84ebc);const _0x3610a7=_0x2d0b9e[_0x39df8e(0x5d8,0x685,0x690,0x602)](findMessageIndexWithPlaceholder,_0xe84ebc,'{{用户需求}}');console[_0x41147e(-0xc0,-0x1a0,-0xf2,-0x102)](_0x41147e(-0x141,-0x68,-0x115,-0x120)+_0x41147e(-0xfd,-0xaa,-0xf4,-0x116)+'fy]\x20User\x20r'+'equirement'+_0x41147e(-0x1a4,-0x103,-0x123,-0x149)+_0x41147e(-0x20f,-0x297,-0x16d,-0x1dc),_0x3610a7);const _0x65ad8a={..._0x2c4f1d,..._0xe46b98},_0x57234e={'context':_0x28938a,'worldBookContent':_0x45113e,'variables':_0x65ad8a,'userDemand':_0x2d0b9e[_0x41147e(-0x153,-0x16e,-0x162,-0x13d)](_0x5a4ae9,''),'characterListText':_0x1d389,'outfitEnableListText':_0x1053e4,'commonCharacterListText':_0x228023},{messages:_0x311bda,replacedVariables:_0x4c9069}=_0x2d0b9e['MWmRA'](replaceAllPlaceholders,_0xe84ebc,_0x57234e);_0xe84ebc=_0x311bda,_0xe84ebc=_0x2d0b9e[_0x41147e(-0xb8,-0xcb,-0xbb,-0xeb)](_0x3ba468,_0xe84ebc,_0x2d0b9e[_0x39df8e(0x580,0x54a,0x431,0x4d4)],_0x304836,_0x4c9069),console[_0x41147e(-0x1b7,-0xdf,-0x157,-0x102)](_0x2d0b9e[_0x41147e(-0x20b,-0x1ec,-0x121,-0x158)],_0xe84ebc);let _0x55bd25='';if(_0x2d0b9e[_0x41147e(-0x17c,-0x18e,-0x15b,-0x123)](_0x4c9069[_0x41147e(-0x290,-0x1be,-0x229,-0x1fe)],0x2708+0x144d*-0x1+-0x12bb)){if(_0x2d0b9e[_0x41147e(-0xbd,-0x1ad,-0x130,-0x165)](_0x39df8e(0x5a4,0x656,0x59e,0x633),_0x2d0b9e[_0x39df8e(0x5e4,0x67c,0x5b2,0x621)])){const _0x5a702b=_0x2874c2();_0x2ff278[_0x41147e(-0x104,-0xb4,-0xdf,-0x102)](_0x41147e(-0x8b,-0x1b1,-0x164,-0x120)+_0x39df8e(0x539,0x629,0x613,0x5aa)+'fy]\x20Reques'+_0x39df8e(0x4c8,0x488,0x50d,0x512)+'modify\x20pro'+_0x39df8e(0x57e,0x4c2,0x524,0x541)+_0x5a702b+')');const _0x2c6b84=_0x56e76c=>{function _0x34916e(_0x3d6303,_0x5e3974,_0x3895ac,_0x21eb0e){return _0x41147e(_0x3895ac,_0x5e3974-0x50,_0x3895ac-0x12d,_0x3d6303-0x377);}if(_0x2d0b9e[_0x34916e(0x2c1,0x2c9,0x294,0x367)](_0x56e76c['id'],_0x5a702b))return;_0x4b7531[_0xe28934(0x1bc,0x24d,0x20f,0x1a3)+_0xe28934(0x2a1,0x2c5,0x278,0x30d)](_0x4a456e[_0x34916e(0x250,0x258,0x280,0x1f3)+'ODIFY_GET_'+_0xe28934(0x2ec,0x237,0x1ab,0x27b)+_0xe28934(0x2a6,0x2f0,0x309,0x27a)],_0x2c6b84);function _0xe28934(_0x3565cf,_0x9b70cc,_0x11d43a,_0x2e1aa0){return _0x39df8e(_0x11d43a,_0x9b70cc-0x18b,_0x11d43a-0xb8,_0x9b70cc- -0x2c4);}_0x2d0b9e[_0x34916e(0x243,0x25b,0x29a,0x2e1)](_0x3094b8,_0x56e76c[_0x34916e(0x2bc,0x2c3,0x2b1,0x233)]);};_0x5dc8d9['on'](_0x3a491a[_0x41147e(-0x121,-0x188,-0x177,-0x127)+_0x39df8e(0x486,0x4fb,0x49e,0x4cf)+_0x41147e(-0x133,-0x1e3,-0x192,-0x1c5)+'PONSE'],_0x2c6b84);const _0x310a1e={};_0x310a1e['id']=_0x5a702b,_0x552915[_0x41147e(-0x1e1,-0x111,-0x1f1,-0x1a5)](_0x532598[_0x39df8e(0x56f,0x5ed,0x601,0x599)+_0x39df8e(0x554,0x515,0x436,0x4cf)+'PROMPT_REQ'+'UEST'],_0x310a1e),_0x2d0b9e[_0x39df8e(0x538,0x5a6,0x518,0x53c)](_0x38db67,()=>{function _0x111733(_0x3978a3,_0x5e7bef,_0x577f0f,_0x47db0a){return _0x41147e(_0x577f0f,_0x5e7bef-0x1ea,_0x577f0f-0xf4,_0x3978a3-0x6db);}_0x584750[_0x3acffc(0x39d,0x336,0x412,0x353)+'ener'](_0x2fc74a[_0x3acffc(0x425,0x4cc,0x3f8,0x401)+_0x111733(0x4ea,0x506,0x526,0x525)+_0x111733(0x516,0x4fb,0x513,0x58f)+_0x111733(0x5cf,0x64f,0x589,0x65f)],_0x2c6b84);function _0x3acffc(_0x11a59,_0x2ef692,_0x165588,_0x1b646a){return _0x39df8e(_0x165588,_0x2ef692-0xef,_0x165588-0x14a,_0x11a59- -0x174);}_0x5240c9(new _0x129fe9(_0x3acffc(0x363,0x345,0x2c7,0x384)+'时'));},-0x2d07+-0x149d*-0x3+0x1640);}else _0x55bd25='诊断：检测到以下变量'+_0x39df8e(0x575,0x4bf,0x4c3,0x578)+[..._0x4c9069][_0x39df8e(0x6c0,0x58a,0x694,0x60d)]('、')+'\x0a';}_0xf204aa&&_0x2d0b9e[_0x41147e(-0x2e,-0x142,-0x6d,-0xb8)](_0xf204aa['length'],-0x3d*0x74+0x26f7+-0xb53)&&_0x2d0b9e[_0x39df8e(0x513,0x5ef,0x525,0x552)](_0x3610a7,0xc86*0x2+-0x1ebe+-0x2*-0x2d9)&&(_0xe84ebc=_0x2d0b9e[_0x39df8e(0x5be,0x590,0x527,0x58d)](attachImagesToMessage,_0xe84ebc,_0x3610a7,_0xf204aa,_0x2d0b9e[_0x41147e(-0x10d,-0x16a,-0xd0,-0x144)]),console['log'](_0x2d0b9e[_0x39df8e(0x510,0x49b,0x572,0x4d6)],_0xf204aa[_0x39df8e(0x4ea,0x565,0x51e,0x536)],_0x41147e(-0x141,-0x15e,-0x1dd,-0x12e)+_0x39df8e(0x51b,0x514,0x614,0x58f)+'\x20index',_0x3610a7));_0x2d0b9e['RUJJW'](updateCombinedPrompt,_0xe84ebc,_0x55bd25);const _0x4da726={};_0x4da726[_0x41147e(-0xd7,-0x192,-0x19b,-0x179)]=0x493e0;const _0x1b4945=await _0x2d0b9e['mLLNi'](LLM_CHAR_MODIFY,_0xe84ebc,_0x4da726);console[_0x39df8e(0x59e,0x59e,0x561,0x5be)](_0x2d0b9e[_0x39df8e(0x66e,0x527,0x5fd,0x5b3)],_0x1b4945);if(!_0x1b4945){toastr['error'](_0x2d0b9e[_0x41147e(-0x166,-0x18a,-0x12f,-0x1d6)]);return;}const _0x3edcd=_0x2d0b9e[_0x39df8e(0x51e,0x52e,0x5e4,0x5cf)](extractCharacterTags,_0x1b4945);if(_0x2d0b9e[_0x41147e(-0x141,-0xd3,-0x8d,-0xa8)](_0x3edcd[_0x39df8e(0x555,0x57f,0x4d2,0x514)][_0x39df8e(0x5cd,0x482,0x551,0x536)],-0x1ded+-0x236*0x3+0x31*0xbf)){toastr['warning'](_0x41147e(-0xbc,-0x1e6,-0x17c,-0x132)+_0x41147e(-0x74,-0x11e,-0xb1,-0xea)),console['log'](_0x41147e(-0x19c,-0x105,-0x1ca,-0x120)+_0x41147e(-0xd5,-0xd1,-0xdf,-0x116)+_0x41147e(-0x21,-0x48,-0x2d,-0x91)+'racter\x20tag'+'s\x20found\x20in'+_0x39df8e(0x4e6,0x4c2,0x5e4,0x555)),console[_0x39df8e(0x604,0x55f,0x672,0x5be)](_0x2d0b9e[_0x39df8e(0x660,0x66e,0x664,0x607)],_0x1b4945);return;}console[_0x39df8e(0x58a,0x636,0x671,0x5be)]('[character'+_0x39df8e(0x608,0x62b,0x510,0x5aa)+_0x39df8e(0x5dc,0x613,0x678,0x5e4)+_0x39df8e(0x56a,0x5bf,0x604,0x54d),_0x3edcd);const _0x4e7979=_0x3edcd[_0x41147e(-0x260,-0x200,-0x144,-0x1ac)][0x22ce+-0x592+0x2*-0xe9e];await _0x2d0b9e[_0x41147e(-0x1bc,-0x187,-0x1e8,-0x184)](updateCharacterPresetFromLLM,_0x4d1cb0['id'],_0x4e7979),toastr[_0x39df8e(0x58d,0x539,0x517,0x5ad)](_0x2d0b9e[_0x41147e(-0x117,-0x184,-0x1d7,-0x1b5)]);}else{_0x475391['warning'](_0x2d0b9e[_0x41147e(-0x2e,-0x33,-0x7b,-0xc3)]),_0x4f2f04[_0x41147e(-0x12f,-0x182,-0x137,-0x102)](_0x2d0b9e[_0x41147e(-0x96,-0x188,-0x90,-0xec)]),_0x1cadde[_0x41147e(-0x109,-0x14c,-0x19f,-0x102)]('[character'+_0x39df8e(0x5cb,0x5f2,0x506,0x5aa)+'fy]\x20Raw\x20LL'+_0x39df8e(0x599,0x6c7,0x699,0x61a)+_0x41147e(-0x49,-0xdd,-0xf5,-0xaa)+'ng:',_0x29e5ba);return;}}catch(_0x5cf7be){console[_0x39df8e(0x5a4,0x535,0x5ca,0x51e)](_0x2d0b9e[_0x39df8e(0x5ab,0x62d,0x667,0x62c)],_0x5cf7be),toastr['error'](_0x41147e(-0xc6,-0xf9,-0x1f8,-0x166)+'\x20'+_0x5cf7be['message']);}}async function updateCharacterPresetFromLLM(_0x1c79db,_0x34acc8){const _0x323416={'yNWha':function(_0x53677d,_0x115185){return _0x53677d(_0x115185);},'tQfof':_0x302d8d(0x56c,0x548,0x585,0x5b3),'ZKuWQ':function(_0x1b7c9c,_0x21b8ea){return _0x1b7c9c===_0x21b8ea;},'qmctU':_0xb34977(-0xc2,-0x27,-0x7a,-0xa9),'hrDha':'中文名称','kanhf':'英文名称','MfSdT':_0xb34977(0x13,-0x7a,0x31,0x31),'lBKDZ':_0x302d8d(0x4cb,0x51a,0x54b,0x4ad),'cLoDK':_0xb34977(0x1a,-0x81,-0xc,-0x73),'AyQCK':_0x302d8d(0x4e2,0x577,0x5f5,0x4f1),'FQUAh':_0x302d8d(0x419,0x488,0x527,0x52d),'dayoe':_0x302d8d(0x4bc,0x4f2,0x46a,0x4ef),'fGJFI':'下半身NSFW','vKGIF':_0xb34977(-0x80,-0x6d,0x3b,0x13),'RpHWj':_0xb34977(0xd6,0x81,0x96,0xb0),'ReJlL':function(_0x484f44,_0x228116){return _0x484f44!==_0x228116;},'PdSkF':_0xb34977(-0x61,-0x73,-0x19,-0xa0),'BMQFC':_0x302d8d(0x60a,0x594,0x594,0x5ca),'VBCrg':_0x302d8d(0x574,0x541,0x5e8,0x5a8),'yzjqE':function(_0x4cc82a,_0x61f65f){return _0x4cc82a>_0x61f65f;},'BiCzr':_0xb34977(-0x3d,-0x33,0x6c,-0xab),'JKAqQ':function(_0x41d3fb,_0x28e3a8){return _0x41d3fb===_0x28e3a8;},'cMfvr':_0x302d8d(0x4bd,0x4d5,0x4d5,0x55a),'aDTFv':function(_0x57dc78){return _0x57dc78();},'YcmYP':_0x302d8d(0x4ce,0x560,0x4d3,0x58c)+_0xb34977(-0xbc,-0xb2,-0x12,-0x10c)+_0xb34977(0x46,-0x37,0x57,0x5b),'LtVAZ':function(_0x41a9d8,_0x1c7674){return _0x41a9d8(_0x1c7674);}},_0x501c2b=extension_settings[extensionName],_0x3fff85=_0x501c2b['characterP'+'resets'][_0x1c79db];function _0xb34977(_0x54d084,_0x226581,_0x181804,_0x273f7b){return _0x1ee02b(_0x273f7b,_0x226581- -0x5e1,_0x181804-0x15c,_0x273f7b-0x18b);}if(!_0x3fff85){if(_0x323416[_0x302d8d(0x573,0x5ad,0x564,0x5dd)](_0x323416['qmctU'],_0xb34977(-0x3,-0x27,-0x5,-0xb6))){toastr[_0x302d8d(0x4d2,0x4b4,0x4c3,0x46d)]('找不到指定的角色预设');return;}else _0x323416[_0xb34977(-0x44,-0xb3,-0xed,-0x8f)](_0x5642e9,new _0x12e62d(_0x551996[_0xb34977(-0x185,-0xda,-0x115,-0x140)]||_0x323416[_0x302d8d(0x48e,0x4d8,0x45c,0x52f)]));}let _0x36df5a=_0xb34977(0xa1,0x22,0x7d,-0xe)+_0x1c79db+_0x302d8d(0x44c,0x4db,0x43d,0x438);const _0x4b5a5f={};_0x4b5a5f['nameCN']=_0x323416['hrDha'],_0x4b5a5f[_0x302d8d(0x479,0x467,0x3b6,0x4ed)]=_0x323416['kanhf'];function _0x302d8d(_0x44f8ef,_0x382723,_0x249bc0,_0x63dbbf){return _0x1ee02b(_0x249bc0,_0x382723- -0xa4,_0x249bc0-0x161,_0x63dbbf-0xba);}_0x4b5a5f[_0x302d8d(0x49f,0x493,0x410,0x41c)+_0x302d8d(0x50b,0x479,0x497,0x450)]=_0x323416[_0x302d8d(0x55a,0x5a6,0x5fc,0x653)],_0x4b5a5f[_0xb34977(-0x107,-0xaa,-0x6f,-0x91)+_0x302d8d(0x639,0x589,0x5d4,0x506)]=_0x323416[_0xb34977(0x9,-0x8e,-0x1a,-0x11e)],_0x4b5a5f['upperBodyS'+'FW']=_0x323416['cLoDK'],_0x4b5a5f['upperBodyS'+_0xb34977(0x5b,0x75,0xb2,-0x42)]=_0x323416[_0x302d8d(0x63b,0x59f,0x5e7,0x541)],_0x4b5a5f[_0xb34977(-0x11,-0x17,-0x24,0x39)+'W']=_0x323416['FQUAh'],_0x4b5a5f['fullBodySF'+_0x302d8d(0x5de,0x578,0x54e,0x53e)]=_0xb34977(-0x8f,-0x3,-0x71,0x44),_0x4b5a5f[_0xb34977(0x5f,-0x59,-0x20,-0x76)+_0x302d8d(0x543,0x54f,0x4c6,0x5bc)]=_0x323416[_0x302d8d(0x526,0x5c8,0x5a8,0x5f9)],_0x4b5a5f['upperBodyN'+_0xb34977(0x94,-0x20,-0x1a,0x5b)]='上半身NSFW背面',_0x4b5a5f['fullBodyNS'+'FW']=_0x323416[_0x302d8d(0x5e6,0x5a5,0x507,0x56f)],_0x4b5a5f['fullBodyNS'+_0x302d8d(0x5f5,0x5b2,0x505,0x628)]=_0x323416[_0x302d8d(0x521,0x468,0x3e3,0x4bb)];const _0x27dff9=_0x4b5a5f;let _0x58012c=-0x2c*0x5c+-0x54f+0x1*0x151f;for(const _0x54e9ba in _0x27dff9){if(_0x323416[_0x302d8d(0x515,0x4ea,0x4e3,0x587)]==='vPWye')return _0x335276;else{if(_0x34acc8[_0x54e9ba]&&_0x323416[_0x302d8d(0x528,0x509,0x4df,0x50f)](_0x34acc8[_0x54e9ba],_0x3fff85[_0x54e9ba])){if(_0x323416[_0xb34977(0x43,-0x34,-0x50,-0xb4)](_0x323416[_0xb34977(0xf3,0x6a,0x122,0xdd)],_0x323416[_0xb34977(-0x94,-0xb,0x41,0x8f)])){const _0x326651=_0x3fff85[_0x54e9ba]||_0x323416[_0x302d8d(0x478,0x4a4,0x44d,0x476)],_0x5ce8d3=_0x34acc8[_0x54e9ba];_0x36df5a+='•\x20'+_0x27dff9[_0x54e9ba]+':\x0a',_0x36df5a+=_0xb34977(-0xe7,-0x38,0x80,-0x28)+_0x326651[_0x302d8d(0x4a8,0x4e6,0x49c,0x4fb)](-0x5b2*-0x4+-0x1df6+0x72e,0x2e*-0xd6+-0x3f*-0x1a+0x2040)+(_0x323416[_0x302d8d(0x53e,0x56d,0x5fa,0x4d3)](_0x326651['length'],-0x1b70+0x5*-0x14b+-0xcb*-0x2b)?_0x323416[_0x302d8d(0x51c,0x584,0x638,0x50f)]:'')+'\x0a',_0x36df5a+=_0xb34977(0x48,0x29,0x4b,0x4f)+_0x5ce8d3['substring'](0x115*0x1+0xd7*-0xa+0x751*0x1,-0x2107+-0x83e+-0x5*-0x84b)+(_0x323416[_0xb34977(-0x45,0x30,0x20,0xab)](_0x5ce8d3['length'],-0x2e*0xf+0x57*-0x5d+-0x227f*-0x1)?_0x323416[_0x302d8d(0x4fb,0x584,0x5f5,0x4d0)]:'')+'\x0a\x0a',_0x58012c++;}else _0x323416[_0xb34977(-0x167,-0xb3,-0x165,-0x142)](_0x578f8e,_0x12cda8);}}}if(_0x58012c===-0x2*-0x1e7+0x543*-0x5+0x337*0x7){toastr[_0xb34977(-0x120,-0x97,-0x84,-0x118)]('没有检测到需要更新的'+'内容');return;}_0x36df5a+='共\x20'+_0x58012c+'\x20项更改,是否应用?';const _0x38acdc=await stylishConfirm(_0x36df5a);if(!_0x38acdc){if(_0x323416[_0xb34977(0x3c,-0x67,-0xe1,-0xc5)](_0x302d8d(0x4e6,0x58f,0x5ad,0x5c8),_0x323416['cMfvr']))_0x41607e[_0xff8fc6]=_0x262d99[_0x34af81];else{toastr['info']('已取消更新');return;}}for(const _0x5087aa in _0x27dff9){_0x302d8d(0x479,0x4a9,0x3f0,0x444)===_0x302d8d(0x42c,0x4a9,0x441,0x4fa)?_0x34acc8[_0x5087aa]&&(_0x3fff85[_0x5087aa]=_0x34acc8[_0x5087aa]):_0x66615['push'](_0x42be72);}_0x323416[_0x302d8d(0x56b,0x508,0x4a9,0x529)](saveSettingsDebounced);const _0x3c3c9a=_0x323416['yNWha']($,_0x323416[_0x302d8d(0x563,0x4e1,0x4c3,0x4fc)]);_0x3c3c9a[_0xb34977(-0xb9,-0x71,-0x11d,-0x74)]&&_0x323416['LtVAZ'](refreshCharacterSettings,_0x3c3c9a),_0x323416['yNWha'](updateFormFields,_0x34acc8),console['log'](_0xb34977(-0x2e,-0x7,-0x77,-0x5a)+_0xb34977(0x46,0x3,0x84,0x74)+'fy]\x20已更新角色预'+_0xb34977(-0x38,-0xc2,-0xd7,-0x176)+_0x1c79db+'\x22');}function updateFormFields(_0x55779e){const _0x5a90ee={};_0x5a90ee['sUpqY']=_0x40b121(-0x102,0x47,-0x62,0x40),_0x5a90ee[_0x40b121(0xfd,0xf8,0x6f,0x12)]='nameCN',_0x5a90ee['RvfZP']=_0xcbe6ab(0x283,0x280,0x1c7,0x31a),_0x5a90ee[_0x40b121(-0x18,0x18,-0x17,0x6)]=_0xcbe6ab(0x2db,0x2ac,0x26c,0x2f5)+_0xcbe6ab(0x22e,0x292,0x1d9,0x2ba),_0x5a90ee[_0x40b121(0x0,0xf0,0x92,0xec)]=_0x40b121(-0xfa,-0x6a,-0x84,-0xa5)+'uresBack',_0x5a90ee['DAoiy']=_0x40b121(-0x12,0xe2,0x46,0xe8)+'FW',_0x5a90ee[_0xcbe6ab(0x22c,0x270,0x202,0x2d9)]=_0x40b121(0xe,0xe,0x46,0xd)+'FWBack',_0x5a90ee['nKMvl']=_0xcbe6ab(0x2e3,0x33f,0x291,0x394)+'WBack',_0x5a90ee[_0xcbe6ab(0x22c,0x2b1,0x31c,0x342)]=_0xcbe6ab(0x263,0x2fd,0x358,0x2a6)+_0x40b121(0x2f,0xb4,0x38,0x2d),_0x5a90ee[_0xcbe6ab(0x411,0x375,0x3c2,0x317)]=_0x40b121(0x38,0x4b,-0x33,0x5a)+_0xcbe6ab(0x34c,0x336,0x2e7,0x386),_0x5a90ee[_0x40b121(-0x25,0xf1,0x6a,0xa4)]=_0xcbe6ab(0x362,0x370,0x39d,0x373)+'FW';function _0xcbe6ab(_0x890049,_0xacf16c,_0x22ec64,_0x306021){return _0x1ee02b(_0x306021,_0xacf16c- -0x28b,_0x22ec64-0xcb,_0x306021-0xe8);}_0x5a90ee[_0x40b121(0x13a,0x12c,0x83,-0x2)]='fullBodyNS'+_0x40b121(-0xf,0x108,0x9b,0x48);const _0x35bd0c=_0x5a90ee;function _0x40b121(_0x31913a,_0x223264,_0x54d885,_0x2e6f89){return _0x1ee02b(_0x31913a,_0x54d885- -0x5bb,_0x54d885-0x9c,_0x2e6f89-0x6a);}const _0x445b72=[_0x35bd0c[_0x40b121(0x9b,0x5,0x6f,0x6)],_0x35bd0c[_0xcbe6ab(0x38b,0x345,0x2f0,0x381)],_0x35bd0c['JeTgQ'],_0x35bd0c['dhUyV'],_0x35bd0c['DAoiy'],_0x35bd0c[_0x40b121(-0xfd,-0xb1,-0xc0,-0xce)],'fullBodySF'+'W',_0x35bd0c[_0x40b121(0x22,-0x4e,0x2f,-0x53)],_0x35bd0c[_0x40b121(0x2e,-0x7c,-0x7f,-0xb4)],_0x35bd0c[_0xcbe6ab(0x414,0x375,0x390,0x34d)],_0x35bd0c[_0xcbe6ab(0x3bd,0x39a,0x392,0x32e)],_0x35bd0c[_0x40b121(0x54,0x4d,0x83,0x1a)]];_0x445b72[_0x40b121(-0x3d,-0xa,0x7,0x9d)](_0x1b53d9=>{function _0x73daf3(_0x270abe,_0x562aed,_0x31743b,_0x253d11){return _0x40b121(_0x562aed,_0x562aed-0x151,_0x31743b-0x61b,_0x253d11-0x6);}function _0x4781c0(_0x108fe8,_0x53885c,_0x5ecd49,_0x37dd56){return _0xcbe6ab(_0x108fe8-0x2d,_0x37dd56-0x18e,_0x5ecd49-0x116,_0x5ecd49);}if(_0x55779e[_0x1b53d9]){const _0x15c73a=document[_0x4781c0(0x553,0x50b,0x40a,0x4a1)+'ById'](_0x73daf3(0x6bd,0x5a2,0x606,0x66c)+_0x1b53d9);_0x15c73a&&(_0x15c73a['value']=_0x55779e[_0x1b53d9],$(_0x15c73a)['trigger'](_0x35bd0c[_0x4781c0(0x461,0x56f,0x566,0x4e5)]));}});}