(function(_0x5ba4f5,_0x44155e){function _0x10c058(_0x28119c,_0x3c60a0,_0x932ca0,_0x22f3a5){return _0xf8e5(_0x28119c- -0x78,_0x22f3a5);}function _0x344967(_0x2e440c,_0x2664a1,_0x19196f,_0x242578){return _0xf8e5(_0x2664a1-0x1b8,_0x242578);}const _0xc6fedf=_0x5ba4f5();while(!![]){try{const _0x2f0cb2=parseInt(_0x344967(0x3fe,0x42c,0x498,0x37c))/(0x9ef*0x1+-0x239d+0x19af)+parseInt(_0x344967(0x4ae,0x440,0x4d6,0x4c0))/(-0x6d4+-0x163e+0x1d14)+parseInt(_0x10c058(0xec,0x9d,0x16e,0xc0))/(-0x16eb*-0x1+-0x15*0x181+0x8ad)+-parseInt(_0x344967(0x482,0x3da,0x46f,0x494))/(-0x1*0x9a3+-0xe2a+0x17d1)+-parseInt(_0x344967(0x399,0x378,0x391,0x409))/(-0x51*-0x46+0x10e2+-0x2703)+parseInt(_0x344967(0x366,0x3a4,0x3da,0x3df))/(-0x1*0x66e+-0x43*-0x10+0x244)*(parseInt(_0x10c058(0x237,0x29b,0x1f1,0x187))/(0x3*-0xa1f+0x23c4+0x1*-0x560))+parseInt(_0x344967(0x316,0x3d1,0x3b0,0x3ff))/(0x2bc+-0x17e1+0x27*0x8b);if(_0x2f0cb2===_0x44155e)break;else _0xc6fedf['push'](_0xc6fedf['shift']());}catch(_0x16abb3){_0xc6fedf['push'](_0xc6fedf['shift']());}}}(_0x26af,-0x2f71a+-0x9bf55+-0xc4cab*-0x2));const _0x1ecb40=(function(){const _0x2fe4c4={};_0x2fe4c4[_0xf2a72e(0x613,0x57b,0x532,0x5a4)]=function(_0x4ab97c,_0x45f5e0){return _0x4ab97c===_0x45f5e0;},_0x2fe4c4[_0x5f364d(0x61,-0xd0,-0x3a,-0xae)]='zwjHt';const _0x2bf07d=_0x2fe4c4;let _0xd9204e=!![];function _0x5f364d(_0x1685c5,_0x2cfde2,_0x36249d,_0x33581e){return _0xf8e5(_0x36249d- -0x30c,_0x1685c5);}function _0xf2a72e(_0x236c27,_0x1e6512,_0x3171fa,_0x294e00){return _0xf8e5(_0x294e00-0x393,_0x1e6512);}return function(_0x4f848b,_0x4febb8){const _0x2706be=_0xd9204e?function(){function _0x5abfd1(_0x4a0463,_0x616cae,_0x455989,_0xa545c5){return _0xf8e5(_0xa545c5-0x30c,_0x455989);}const _0x537adf={};_0x537adf[_0x5abfd1(0x55f,0x57b,0x58f,0x50f)]=_0x5607e5(0x39c,0x2fb,0x33f,0x3f1)+'+$';function _0x5607e5(_0x2762f4,_0x7166b2,_0x3d71c3,_0x56472a){return _0xf8e5(_0x2762f4-0x1f9,_0x56472a);}const _0x29ad13=_0x537adf;if(_0x2bf07d[_0x5abfd1(0x504,0x4a1,0x56a,0x51d)](_0x2bf07d['xtwYo'],_0x2bf07d[_0x5abfd1(0x592,0x5b4,0x675,0x5de)])){if(_0x4febb8){const _0xfdc967=_0x4febb8[_0x5abfd1(0x40b,0x401,0x415,0x479)](_0x4f848b,arguments);return _0x4febb8=null,_0xfdc967;}}else return _0x2028e3[_0x5abfd1(0x4c4,0x500,0x54b,0x4e0)]()[_0x5607e5(0x463,0x50f,0x3b4,0x49c)](_0x5abfd1(0x4e8,0x49a,0x4c1,0x4af)+'+$')[_0x5607e5(0x3cd,0x40c,0x34e,0x33f)]()[_0x5abfd1(0x559,0x50e,0x4d6,0x4ab)+'r'](_0x251856)[_0x5abfd1(0x574,0x580,0x4bd,0x576)](_0x29ad13[_0x5607e5(0x3fc,0x35a,0x4bb,0x48a)]);}:function(){};return _0xd9204e=![],_0x2706be;};}()),_0x2e77c5=_0x1ecb40(this,function(){const _0x3755de={};_0x3755de['iSfKz']=_0x3b5cd6(0xc8,0xa8,0xe6,0x162)+'+$';function _0x3b5cd6(_0xddf28d,_0x116f54,_0x555785,_0x48e5c4){return _0xf8e5(_0xddf28d- -0xdb,_0x48e5c4);}function _0x818758(_0x12c085,_0x1f1af1,_0x4af998,_0x1ed246){return _0xf8e5(_0x1f1af1-0x2dc,_0x4af998);}const _0x29e2a1=_0x3755de;return _0x2e77c5[_0x3b5cd6(0xf9,0xfd,0x6a,0x3f)]()[_0x818758(0x48f,0x546,0x575,0x5ae)](_0x29e2a1[_0x3b5cd6(0xcc,0x7f,0xc9,0x64)])['toString']()[_0x818758(0x42b,0x47b,0x477,0x4fd)+'r'](_0x2e77c5)[_0x3b5cd6(0x18f,0x1d5,0x147,0x1a6)](_0x29e2a1[_0x818758(0x3f9,0x483,0x485,0x47f)]);});_0x2e77c5();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg,deduplicateTags}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';function _0x26af(){const _0x24028f=['5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','qw90yK4','mJG4mJqWogXkDePozW','A2LW','zw5HyMXLx2HYia','cI0GkIRMLl7LPkFLGi3NJOCG','qwnJzxb0','6zQp5PY6kc0Xkq','B2zKELK','l2fWAs9Zzc9Zzq','q1rNyKC','C3vIC3rYAw5N','C2fTCgXLCL9Uyq','AgvPz2H0','EMGTq04SEMG7Cq','shLAD08','ic0Gq2HHBMDLoG','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','kIOG','kfvWC2nHBguGrG','qNbtEfi','6k+V44cc54Q25Ocb56cboIa','tLr3sM0','BMvXyMO','yxfbz0S','zMfYAs81mZCUmW','vvzhuNu','cI0GkIRMQkhLNOSGke0','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','ywrKvgfZAW','t0vWyMO','cI0GkIRPH43NU5JLUyxLUQyG','C2rFDMfL','ke5Lz2f0AxzLia','C2rFy2HPCMvZxW','ktOG','ANnVBG','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','y29SBgvJDgvKqW','ANruveO','BMvYyxrL','wLLjyuq','kfjLC3rVCMuGrG','5BcD6k+v5l2C5lI65y6F5AEliejHCW','vLf0vKK','yvbezMy','y2XPzw50','BezksLa','y3jPChrZ','EgLHBMnOzw5N','DgLIq2C','u0rmAxn0zw5LCG','qMP0t0y','ksaTifbYB21WDa','5BEY5ywZ6zET44cc','CMvZDg9Yzv9Myq','ifbYB21WDa','vLfRsfy','q3nZsgG','zMvSq1e','Aw5JBhvKzxm','keHPCMvZiezPEa','CMvTB3zLtgLZDa','ENfSDwW','yM1Xug0','vvfKv2u','C3vJy2vZCW','CvvVvwG','ywX3yxLZB25FCW','sKLeuMy','Bg9N','5zon5BQu5yAf5A65oG','yMvfDwe','zgTtuvC','C2vHCMnO','44cc6k+35Qoa5P+LC2r3zwj1','Ee9Pz1G','AML1z3vHBG','l3bUzZTIyxnLnG','v2fWDgi','r3bhDgi','C3rFy2HHDhu4xW','ywn0B3iPoIOQia','zhnKq3O','nde1ndCZzgrzt2jy','sxnJvgG','q2fJAguTq29UDa','77Ym6k+35Qoa5P+LC2r3zwj1','rLPNsu4','cI0GkIPdrKCGuW','C2rdzMDty2fSzq','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','Aw1Hz2u6','z2f0AxzLCW','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','of9TB2rLBa','BgvUz3rO','icHjrdOG','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','ugzSrvK','icHlsfrntcWGBa','B1DbEvG','C3rYzw5NDgG','odyXnZy4sefdwhvw','AMjjseu','AuTNrxi','CunOEhm','zv9Mywn0B3i','q29UDgvUDc1uEq','CKPfChe','zxr0Aw5NCW','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','ANHhANq','yw1L','sgTHqMS','wxHYC1y','AgfYywn0zxjozq','vgntAKO','AwP5CK8','yuvLuMK','Cvj5vhC','DtHFC2rFyxv0Aa','of9Zy2HLzhvSzq','DgvYDMfS','zwvKktOQkIa','vhrksvi','A3LuBgO','og4UChq','thLgA2y','uhjHz21H','sfjWwuS','C2rFy2fKzxrHAq','EM5iswW','y2jSu0u','zxjYB3i','yxv0Aa','B3HhDvq','qurLDgfPBgvY','DgvWCYK6kIOG','qxv0Ag9YAxPHDa','rxjYB3iGz2vUzq','vfP4ufK','mty4otHPzhPfrMK','teLUD2q','C2rFy3nLzwq','C2rvCMW','l2fWAs9Zzc9Nzq','DhH0mMLTzW','BMvNyxrPDMvqCG','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','C2tOR7FMSylNLj/LM77PLjNOR686ia','rLLXzwG','ifn0CMvUz3rOkq','y2vZ','z1HkDNO','ug5qDfe','tLziuwq','AhjFC2nHBgu','Aw5PDgLHBgL6zq','rKLssgK','C2rFyxv0Aa','rvDYsfG','6i635y+w5QIH5z6l5AsX6lsLoIa','BNfjBwy','Avz1reW','y2zNx3nJywXL','s2L0lZuZnY4ZnG','zML4','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','wNL6vha','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','zw1PDa','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','cI0GkIROTj/PNAlMJ5dNPlOG','y2HHBMDL','uhjVBxb0ktOQkG','ChjVBxb0','Ehr3ww8','BNjYCMq','q0Xjuf9ZDg9WxW','CujVDgC','v1HntNe','cI0GkIRNP43LRzaGkfm','EgLHBMnOzw5Nia','E+s/RUwBVN0','Dhj1zq','56cboIa','uwHUzMi','Dgrlyuu','EwfwBKy','l3nKyxbPl3yXlW','Aw5Nx3n0CMvUzW','nJK4nZm2yMvjDvrp','kI8Q','s3L1Aum','CMvZDg9YzuzHyW','C3rHDhvZ','5yop5PwW5O2U44cc','Bw9Kzq','s2DNu0y','6k6+572U5QIH5z6llI4U5lI6','yxbWBhK','ienOCM9Tzs8XmG','ugrXt08','kerPDMLKzv9YBW','A1jHBNK','su9IsKG','BwvZC2fNzq','tufhrv9srvnqtW','vunqx3nK','Dgv4Da','ptaUosXLBJTXpq','zMneq08','mc44','zw5HyMXLx2HY','qwPRshy','u2TPCdOQkIa','BI9QC29U','A1HTtvK','B2rLBcK6kIOG','cI0GkIRLSlRLR7GGkfm','5zU+5y+c5PwW5OQL5zgkcI0GkIO','cI0TlqOGicaG','sLnptIdOP6pMNPdLPlhOTkxVViW','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','zwz5AfG','cI0GkIPdBgLWia','vNLOC1G','yxrFBgfZDf9Syq','B3iGChjVBxb0oG','ExvZAgvPzf9Zza','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','DLHkqMe','kerLBM9PC2LUzW','yK1cr2q','B3nPDgLVBG','Ag9WrNC','txvHzxi','5yYw5lI6igrHDgeGvvi','teTxvMy','cI0GkIRPH4FMOlFMLRNMS5uG','thzyvLa','z3PABxi','y29TCgXLDgvuyq','cI0GkIROHlJPG6JKV67LPi0G','u2nLBMuGq29TCa','C2rFC3rVCf9Nzq','C2rFy2nOyxr1xW','5lIT55QeihbYB21WDooaGG','cI0TlqOJiYmG55sF','kfnHBxbSzxiPoG','y29UC3rYDwn0BW','sM9vB1y','BMvYyxrPB24','t05Quvi','kcGOlISPkYKRkq','y2fJAgu','44cc5zon5BQu5yAf5A65oIa','cI0GkIRPQ5JMUixKV67LPi0G','AvnMs3O','loAOOEwEI+s4UG','mJiYmG','BgvY','r0vorvjbvevFsq','C3rYAw5NAwz5','C2rkq0W','tgrlv2q','Df9LBMq','Aw1wELm','Avjjs00','C2rFy2HLAwDODa','5lU75yQH5BEY5y+w5RAi','yNffs0m','DM5WBNy','5lI6Dhj1zq','BurlrMO','Cgf5Bg9Hza','qKrTsvK','DxjS','yxjNCW','ywrFBw9KzwW','z3vHz2u','uKzJwgO','wuLND0W','mZu5mty0nxHQsNLkyG','EMvHEeO','Bgz6z0K','q2HHCMfJDgvYia','qvfux3nK','C3rLChm','suq6ia','6AUy5RIf5l+U5Asnios4UG','vxnLCI1bz2vUDa','cI0GkIRMRAxMLBaGkfm','Bhzdu2i','qKjltNm','CMf0Aw5Nifneia','5BEY5yID5AEl5yYw44cc','sMrJC1O','DxbKyxrLu3rHDa','ExvZAgu','qwnJzxb0luXHBG','CLjXqMW','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','Dg9tDhjPBMC','AwXLCJOQkIa','zgf0ytPPBwfNzq','C2vLza','EK51vfG','5yIh5O2I5QIH5z6l5AsX6lsLoIa','of91ChnJywXLCG','yxbWBgLJyxrPBW','D2LKDgG','AwTLieDLy2TVkq','zw5LCG','Dg9Rzw4','C2zczw8','mc4WlJaUmcbtyq','zKz3EeO','5Q2J5zYO6ycA6l+hC2r3zwj1','CgvNu3rVCMfNzq','BM8Ty2fJAgu','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','EKvirMi','6lsF6z2I5lI6oIa','r1jpAuy','EwvYCW','zty0ioAvSoAnRUwKHoEqHUoaGG','mJC1nhzdr0vOta','CM9S','vK50sMG','svDwuwK','ie5uideWlJa7ia','Bw9KzwW','tLnf','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','qNvlqKS','EvHntha','v2LUnJq7ihG2na','C2rFy3n0zxbZ','zMfJzsdKUlRLVidLKk8','AfHZCKO','C2rFy3DPzhrO','A3v4rhK','AvLwweC','of92ywu','u0qGqvbjioI/LowBNUMuMq','Cw9HtKu','EgHnsvm','Ce5ps1K','zNrgvNa','ksbbChbSzvDLyG','CxvzD2u','s0DHsMy','zMfJzv95B2XVDG','qxbYsfu','C1b6Dwi','mcaOv2LUzg93CW','C3bSAxq','qLb6wwu','CMf0Aw5NigLTyq','Aw9U','DhjPBq','qMrYC2W','A21ry3u','C3rHDhvZvgv4Da','w1nexsdLKiJLUBBOP5lOIBlOTj8','zML4zwrqCM9TCa','r21Rt2u','tufhrv9srvfvrq','yvHly08','Dc1TB2rLBa','mJq0otuYEhnLDNvH','Evz2CxK','t2Xoww0','lI4U','y2fSztOQkIa','y29UDMvYDfrVsG','zxvL'];_0x26af=function(){return _0x24028f;};return _0x26af();}import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';function getDirectHeaders(_0x14f58e=null,_0x258cb8=null){const _0x4e0c25={};_0x4e0c25[_0x514202(0x68b,0x57a,0x648,0x626)]='Mozilla/5.'+_0x195127(0x3ef,0x350,0x3d8,0x330)+_0x514202(0x63e,0x597,0x623,0x58d)+_0x514202(0x572,0x50e,0x5fa,0x594)+_0x514202(0x5a6,0x5c4,0x550,0x5a1)+_0x514202(0x65f,0x6e0,0x65b,0x664)+_0x195127(0x3e8,0x50c,0x453,0x482)+_0x514202(0x5bc,0x568,0x58c,0x57a)+_0x514202(0x54e,0x540,0x5b9,0x50b)+'0.0.0.0\x20Sa'+'fari/537.3'+'6';function _0x195127(_0x59cf74,_0x48798c,_0x860388,_0xfd365f){return _0xf8e5(_0x860388-0x1ce,_0x48798c);}_0x4e0c25[_0x514202(0x4d4,0x49f,0x4b7,0x53f)]=_0x195127(0x3b6,0x34b,0x3fc,0x409)+_0x514202(0x577,0x4e1,0x59b,0x514)+_0x195127(0x2ea,0x366,0x347,0x366),_0x4e0c25[_0x514202(0x6e7,0x59d,0x5fc,0x630)]=_0x195127(0x3d4,0x317,0x3b3,0x326),_0x4e0c25[_0x195127(0x2ce,0x430,0x38d,0x3a7)]='zzRxo',_0x4e0c25['quYwe']=_0x195127(0x4ee,0x455,0x45b,0x3f3)+'pe';const _0x42207e=_0x4e0c25,_0x46a7f3={};_0x46a7f3['User-Agent']=_0x42207e['jbIHE'],_0x46a7f3[_0x195127(0x33c,0x463,0x3f4,0x35e)]='*/*',_0x46a7f3[_0x195127(0x33d,0x43a,0x39f,0x2e7)+_0x195127(0x43f,0x357,0x38b,0x34d)]=_0x42207e[_0x514202(0x5a5,0x5a6,0x57c,0x53f)],_0x46a7f3[_0x514202(0x693,0x61e,0x68d,0x613)+'rol']=_0x42207e['HkaBk'];function _0x514202(_0x6790c3,_0x2ecb04,_0x233341,_0x2cd34d){return _0xf8e5(_0x2cd34d-0x39d,_0x233341);}_0x46a7f3[_0x514202(0x6d2,0x5e8,0x5b7,0x63f)]=_0x42207e[_0x514202(0x6e7,0x5c9,0x5b9,0x630)];const _0x2d6d1d=_0x46a7f3;return _0x14f58e&&(_0x42207e[_0x514202(0x4f4,0x4c5,0x566,0x55c)]===_0x42207e['YIgwL']?_0x2d6d1d[_0x42207e[_0x514202(0x573,0x609,0x4ed,0x5a2)]]=_0x14f58e:(_0x3ea0fa[_0x195127(0x441,0x493,0x48d,0x534)+'SDListener']=!![],_0x36e9b0())),_0x258cb8&&(_0x2d6d1d[_0x195127(0x48f,0x4c8,0x47a,0x431)+_0x514202(0x647,0x524,0x5b2,0x5ab)]=_0x258cb8),_0x2d6d1d;}let currentTaskId=null;function _0xf8e5(_0x544e25,_0x4ef0c2){_0x544e25=_0x544e25-(-0x1*0x19b+0x88+0x270);const _0x35f178=_0x26af();let _0x1ab044=_0x35f178[_0x544e25];if(_0xf8e5['xwEePn']===undefined){var _0xd01324=function(_0x183b98){const _0x35fabe='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x19f5e6='',_0x4d2a6d='',_0x34161f=_0x19f5e6+_0xd01324;for(let _0x2996bf=0x1a54*-0x1+0x1bd*-0x5+0x37*0xa3,_0x2dd48d,_0x456f88,_0x2d1896=-0x4a8+0x1f41+-0x1*0x1a99;_0x456f88=_0x183b98['charAt'](_0x2d1896++);~_0x456f88&&(_0x2dd48d=_0x2996bf%(-0x2*-0x1033+-0x77*0x4d+-0x9*-0x61)?_0x2dd48d*(0x8*0x18a+0x3*-0x38c+-0x16c)+_0x456f88:_0x456f88,_0x2996bf++%(0x8df*0x2+0x1ff6*-0x1+0x38f*0x4))?_0x19f5e6+=_0x34161f['charCodeAt'](_0x2d1896+(0x24b3+-0xd63*0x1+-0x14b*0x12))-(0x22c*-0xd+-0x17*-0x111+0x3bf)!==0x2605+0x1*0x1087+0x1*-0x368c?String['fromCharCode'](0x1d0f*0x1+-0xa*-0x344+-0x3cb8&_0x2dd48d>>(-(-0x6*0x223+0x1cba+-0xfe6)*_0x2996bf&-0x42*0x22+0x1369+-0x1*0xa9f)):_0x2996bf:0x40a+-0x1068+0xc5e){_0x456f88=_0x35fabe['indexOf'](_0x456f88);}for(let _0x369707=-0x4b6+-0x2114+0x25ca,_0x5a62fd=_0x19f5e6['length'];_0x369707<_0x5a62fd;_0x369707++){_0x4d2a6d+='%'+('00'+_0x19f5e6['charCodeAt'](_0x369707)['toString'](-0x8c*-0xa+0x2c0*-0x4+0x598))['slice'](-(0x2424+-0xb*0x20e+0x8*-0x1b1));}return decodeURIComponent(_0x4d2a6d);};_0xf8e5['sJscDW']=_0xd01324,_0xf8e5['gvssTg']={},_0xf8e5['xwEePn']=!![];}const _0x6c06f=_0x35f178[-0x61*-0x1+0xb9*-0x32+0x23c1],_0x2d19b3=_0x544e25+_0x6c06f,_0x5ed726=_0xf8e5['gvssTg'][_0x2d19b3];if(!_0x5ed726){const _0x27911f=function(_0x5fd122){this['EHsmHE']=_0x5fd122,this['bhtzmH']=[0x2*0x716+-0xd89+0x2*-0x51,0x733+0x6d*0x6+-0x9c1,-0xa*0x5e+0x159c+-0x1*0x11f0],this['hdRSnd']=function(){return'newState';},this['aMoIaM']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['DUnnmC']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x27911f['prototype']['CYOSaV']=function(){const _0x3fee05=new RegExp(this['aMoIaM']+this['DUnnmC']),_0x265430=_0x3fee05['test'](this['hdRSnd']['toString']())?--this['bhtzmH'][0xec6+0xe45+0x6*-0x4d7]:--this['bhtzmH'][0x2193+-0x1*-0xbe3+0x16*-0x211];return this['oLIWEf'](_0x265430);},_0x27911f['prototype']['oLIWEf']=function(_0x3a505a){if(!Boolean(~_0x3a505a))return _0x3a505a;return this['Aufgem'](this['EHsmHE']);},_0x27911f['prototype']['Aufgem']=function(_0xbcf8e1){for(let _0x1bf194=0xc86+-0x25*-0x25+-0x11df,_0x332cd3=this['bhtzmH']['length'];_0x1bf194<_0x332cd3;_0x1bf194++){this['bhtzmH']['push'](Math['round'](Math['random']())),_0x332cd3=this['bhtzmH']['length'];}return _0xbcf8e1(this['bhtzmH'][-0x115*0x1+-0xdc5+0xeda]);},new _0x27911f(_0xf8e5)['CYOSaV'](),_0x1ab044=_0xf8e5['sJscDW'](_0x1ab044),_0xf8e5['gvssTg'][_0x2d19b3]=_0x1ab044;}else _0x1ab044=_0x5ed726;return _0x1ab044;}async function generateSDImage({prompt:_0x2f64ae,width:_0x56935e,height:_0x21a625,change:_0x29e984}){function _0xa42f45(_0x1a334e,_0x5ef211,_0x5a1056,_0x126e31){return _0xf8e5(_0x1a334e-0x100,_0x5ef211);}const _0x29193c={'oWAyX':function(_0x3a7e32,_0x4a3291){return _0x3a7e32(_0x4a3291);},'GROiF':function(_0x33ae72,_0x13ec05){return _0x33ae72(_0x13ec05);},'jxGjt':function(_0x220626,_0xeaf133){return _0x220626+_0xeaf133;},'NTwJm':function(_0x18f0ac,_0x297367){return _0x18f0ac+_0x297367;},'HIxEy':'1|3|4|0|2|'+'5','felCQ':_0x380ed0(0x5ae,0x572,0x58e,0x501)+_0xa42f45(0x30d,0x282,0x284,0x29c)+'ge:','LvXVP':function(_0x57e150,_0x109b30){return _0x57e150===_0x109b30;},'bmqPm':_0xa42f45(0x3d8,0x3f4,0x37a,0x3ff)+_0x380ed0(0x4c6,0x439,0x48e,0x40a),'KGaJf':'SD\x20生图事件监听器'+_0xa42f45(0x2cd,0x25b,0x2a5,0x263),'qUoUh':function(_0x44bb77,_0x3f3fba){return _0x44bb77+_0x3f3fba;},'HyZwO':function(_0x230b04,_0x5138d1){return _0x230b04+_0x5138d1;},'lvCSb':_0x380ed0(0x37b,0x461,0x43f,0x3b9),'fcDCO':_0x380ed0(0x3f1,0x3e3,0x48f,0x482)+'=0.9,en;q='+_0x380ed0(0x3f5,0x417,0x333,0x3cd),'zEHFb':_0xa42f45(0x2e5,0x397,0x35e,0x31f),'Muaer':_0x380ed0(0x4ef,0x4cf,0x436,0x4e1)+'pe','gzZmr':_0xa42f45(0x3ac,0x451,0x42f,0x35d)+_0xa42f45(0x30e,0x2fb,0x2fe,0x2b5),'VQkHV':function(_0x1abfc5,_0x7b9ab2){return _0x1abfc5===_0x7b9ab2;},'znHIl':_0x380ed0(0x547,0x5cd,0x5d9,0x529),'xhMIS':function(_0x56f2ce,_0x5d5925){return _0x56f2ce(_0x5d5925);},'kXmMY':_0xa42f45(0x2e6,0x376,0x33f,0x2aa),'kuxDy':_0xa42f45(0x2b3,0x2e3,0x200,0x2df),'JoUoV':function(_0x1362f0){return _0x1362f0();},'hopFw':function(_0x3ad2cb,_0xdbb973){return _0x3ad2cb+_0xdbb973;},'qoaNE':function(_0x21ed8c,_0x31ea5f){return _0x21ed8c||_0x31ea5f;},'aqAgK':function(_0x32a8a2,_0x3a963d){return _0x32a8a2>_0x3a963d;},'YxrsV':function(_0x2fb64d,_0x150661){return _0x2fb64d(_0x150661);},'HRpYK':function(_0x2ff6eb,_0x23b154){return _0x2ff6eb(_0x23b154);},'RFcXj':function(_0x7db1aa,_0x1f27f5){return _0x7db1aa!==_0x1f27f5;},'ZYIaD':'Scene\x20Comp'+_0x380ed0(0x3fd,0x47a,0x43f,0x3e3),'LdKWd':function(_0x39d833,_0x1eaadc){return _0x39d833!==_0x1eaadc;},'JdcsZ':_0xa42f45(0x2b5,0x214,0x275,0x2a4),'GZLbA':'KbLXZ','imVzS':function(_0x1d1749,_0x377a62){return _0x1d1749(_0x377a62);},'ofdzY':_0x380ed0(0x4e9,0x515,0x4d0,0x4cf)+_0xa42f45(0x383,0x2f0,0x42f,0x419),'zqlul':function(_0x1d4f61,_0x14495c){return _0x1d4f61<=_0x14495c;},'fFwxJ':function(_0x4aaa3e,_0x2c9681){return _0x4aaa3e===_0x2c9681;},'AlemF':'PODLD','bezns':_0x380ed0(0x445,0x457,0x34b,0x3ba),'EWrHX':function(_0xb97bb0,_0x1ba30b){return _0xb97bb0===_0x1ba30b;},'rJEpq':'UVOSB','VQtVI':function(_0x508bd5,_0x2a5f5d){return _0x508bd5(_0x2a5f5d);},'SsEQf':_0x380ed0(0x527,0x46b,0x4bb,0x50a)+_0xa42f45(0x29c,0x24f,0x2c9,0x314),'hXsrJ':function(_0x428c59,_0x4eb04e,_0x52dc27){return _0x428c59(_0x4eb04e,_0x52dc27);},'beEua':function(_0x25696e,_0x3f21c6){return _0x25696e===_0x3f21c6;},'kRany':_0xa42f45(0x261,0x1d4,0x2aa,0x2c3),'PdqOO':_0xa42f45(0x354,0x29e,0x2e3,0x411),'mDKFj':'gjNRa','ZyzTp':'DAdcr','TcSjJ':function(_0xe80695,_0x154a28){return _0xe80695+_0x154a28;},'oxGuT':function(_0x5b116d,_0x1951b9,_0x53245e,_0x69e49d,_0x231e53,_0x5cd669){return _0x5b116d(_0x1951b9,_0x53245e,_0x69e49d,_0x231e53,_0x5cd669);},'LyFkf':function(_0x3ac332,_0x493830){return _0x3ac332!==_0x493830;},'pWWyW':_0x380ed0(0x471,0x57a,0x430,0x4c4),'bMBGd':_0xa42f45(0x313,0x2c5,0x2c4,0x386)+'面提示词:','FIRHi':function(_0x24d075,_0x162bd2){return _0x24d075===_0x162bd2;},'IfFrs':_0x380ed0(0x447,0x5a5,0x46e,0x4ec),'PflEY':function(_0x2e4405,_0x2e3b79,_0x4542df){return _0x2e4405(_0x2e3b79,_0x4542df);},'Waptb':'POST','YSnVD':'cmodel2222'+_0x380ed0(0x411,0x40f,0x418,0x3fd),'FYqeh':function(_0x18cbda,_0x59ed04){return _0x18cbda!=_0x59ed04;},'nrrrd':_0xa42f45(0x2fd,0x373,0x398,0x2f3),'dsdCz':function(_0x4ddc86,_0x7ff0f0,_0x16d0aa){return _0x4ddc86(_0x7ff0f0,_0x16d0aa);},'tibCg':_0x380ed0(0x3d3,0x3e5,0x47e,0x47d)+_0xa42f45(0x318,0x2a0,0x356,0x372),'IWVQi':function(_0x343f3e,_0x120c57){return _0x343f3e(_0x120c57);},'IscTh':function(_0x40adb0,_0x3802fd){return _0x40adb0!==_0x3802fd;},'rRqBl':_0x380ed0(0x55b,0x429,0x452,0x4de),'KggSF':function(_0x1d6d74,_0x884e0d){return _0x1d6d74(_0x884e0d);},'TZxPY':function(_0x43d66e,_0x4c127c,_0x59d09d){return _0x43d66e(_0x4c127c,_0x59d09d);},'lFJJP':function(_0x531784,_0x527fb8){return _0x531784===_0x527fb8;},'sdJCL':_0xa42f45(0x3b0,0x319,0x349,0x3ad),'iVuDL':function(_0x4ce33a,_0x51c711){return _0x4ce33a!==_0x51c711;},'BuKBK':function(_0x444224,_0x370248){return _0x444224>=_0x370248;},'LiAiA':function(_0x380d1a,_0x726199){return _0x380d1a==_0x726199;},'aPDff':_0xa42f45(0x25d,0x28d,0x19f,0x271),'BDmIY':function(_0x30bd24,_0x458a2a){return _0x30bd24==_0x458a2a;},'lfzgI':function(_0x2ead7c,_0x53b4c4){return _0x2ead7c(_0x53b4c4);},'iRIKM':'adetailer_'+_0xa42f45(0x2f9,0x244,0x329,0x354),'AprHU':function(_0x18fb42,_0x167fa7){return _0x18fb42===_0x167fa7;},'hSWXN':function(_0x43df03,_0x31dc0e){return _0x43df03==_0x31dc0e;},'flakA':function(_0x168ee7,_0x4e653e){return _0x168ee7(_0x4e653e);},'AotbN':function(_0x1180a7,_0x5c61ad){return _0x1180a7(_0x5c61ad);},'aXKcO':function(_0x2c3269,_0x3b0878){return _0x2c3269(_0x3b0878);},'TtJIR':'running','IObJH':function(_0x42d814,_0x1a69bd){return _0x42d814===_0x1a69bd;},'iUGjZ':_0x380ed0(0x492,0x45a,0x405,0x4c1),'cblSE':'sd_stop_ge'+_0x380ed0(0x3c7,0x40e,0x3a7,0x3f5),'FZgIN':'payst_chat'+_0xa42f45(0x39a,0x434,0x3cd,0x35b)+'load','xMUnW':_0xa42f45(0x2f6,0x2c0,0x293,0x336),'VyhsX':_0xa42f45(0x293,0x25c,0x2cf,0x278),'TVbEa':_0xa42f45(0x367,0x424,0x35b,0x2fb),'UQdWe':'ALnSB','JIDRf':_0x380ed0(0x3f0,0x3f6,0x378,0x3d7)+_0x380ed0(0x3e3,0x486,0x552,0x49f)+_0x380ed0(0x3dc,0x403,0x469,0x43f),'tdKaE':function(_0x145050,_0x540612){return _0x145050+_0x540612;},'PnPtQ':_0xa42f45(0x3cb,0x343,0x3ab,0x473)+_0xa42f45(0x292,0x2ed,0x322,0x1d4)+'L。','OEpbj':'uvXkz','CTgbG':function(_0x4b12dd,_0x2a5810){return _0x4b12dd||_0x2a5810;},'yVvqy':function(_0x1142b2,_0x205d5f){return _0x1142b2+_0x205d5f;},'vXJBa':function(_0x2c7588,_0x5e3406,_0x58d5b4){return _0x2c7588(_0x5e3406,_0x58d5b4);},'qRyTw':_0x380ed0(0x3a9,0x4d6,0x47c,0x42f)+_0xa42f45(0x27d,0x2fe,0x278,0x1f4),'MXHuy':function(_0x48606c){return _0x48606c();},'BBKNs':function(_0x1ef76a,_0x46118b){return _0x1ef76a===_0x46118b;},'TokOK':_0xa42f45(0x27b,0x1ec,0x2b8,0x1fb),'CbyZw':_0x380ed0(0x453,0x45c,0x512,0x4d3)+_0x380ed0(0x3da,0x38a,0x364,0x3bd),'efyhX':_0xa42f45(0x2d6,0x2b8,0x301,0x27d)+_0x380ed0(0x539,0x518,0x4a8,0x4c2)+'4,','sfBeo':function(_0x4727ce,_0x4d1056){return _0x4727ce===_0x4d1056;},'nqImf':function(_0x5927a0,_0x3a3a48){return _0x5927a0(_0x3a3a48);},'kMvfn':function(_0x6cb5dc,_0x3175fd){return _0x6cb5dc||_0x3175fd;},'dfiMy':_0xa42f45(0x3bb,0x307,0x457,0x30a),'VNtJh':_0xa42f45(0x38b,0x33b,0x38d,0x2d7),'neqbj':'1|2|0|3|5|'+'4','OlNYm':function(_0x31dda9,_0x4ab558){return _0x31dda9(_0x4ab558);}};_0x29193c['JoUoV'](clearLog);const _0x3d2416=taskQueue[_0x380ed0(0x449,0x4a4,0x4e0,0x491)]({'name':_0x29193c[_0x380ed0(0x32d,0x45c,0x36a,0x3e4)](_0x29193c[_0x380ed0(0x3eb,0x455,0x50d,0x454)](_0x2f64ae,'')[_0x380ed0(0x402,0x4f7,0x420,0x47f)](-0x111*0xe+0x3*0x641+-0x3d5,0x1*-0x769+-0x4*0x1fc+0xf77*0x1),_0x2f64ae&&_0x29193c[_0x380ed0(0x4cd,0x40c,0x3db,0x48c)](_0x2f64ae[_0xa42f45(0x381,0x411,0x36f,0x2ce)],0x216e+0xd67*0x1+-0x2eb7*0x1)?'...':''),'type':TaskType['SD'],'prompt':_0x2f64ae});currentTaskId=_0x3d2416;let _0x131bd6=_0x29e984;_0x2f64ae=_0x29193c['xhMIS'](processCharacterPrompt,_0x2f64ae),_0x29e984=processCharacterPrompt(_0x29e984),_0x2f64ae=await _0x29193c[_0xa42f45(0x394,0x43a,0x2df,0x422)](stripChineseAnnotations,_0x2f64ae),_0x29e984=await _0x29193c[_0x380ed0(0x48b,0x50f,0x46a,0x4e8)](stripChineseAnnotations,_0x29e984);const _0x24fe2b=extension_settings[extensionName][_0x380ed0(0x533,0x58b,0x541,0x506)][_0x380ed0(0x443,0x3c2,0x47a,0x463)](),_0x464426=extension_settings[extensionName];_0x29193c[_0xa42f45(0x3a3,0x456,0x43d,0x393)](addLog,_0x380ed0(0x4a5,0x3b2,0x48f,0x437)+_0xa42f45(0x2f4,0x32d,0x2d3,0x2c1)+'端为'+_0x464426[_0xa42f45(0x34e,0x394,0x311,0x33f)]+_0xa42f45(0x2a8,0x1fc,0x297,0x28f)+_0x464426[_0x380ed0(0x471,0x3d0,0x43d,0x3ef)+_0x380ed0(0x500,0x562,0x4e1,0x4d4)]);const _0x364228=_0x29e984&&_0x29193c[_0xa42f45(0x2be,0x36a,0x339,0x2df)](_0x29e984[_0xa42f45(0x30f,0x360,0x355,0x327)](),'')?_0x29e984:_0x2f64ae;_0x29193c[_0xa42f45(0x386,0x3f9,0x3c3,0x378)](addLog,'用于生成的Tag:\x20'+_0x364228);let _0x2591e3=![];if(_0x364228[_0x380ed0(0x43c,0x55f,0x4ab,0x4b0)](_0x29193c[_0x380ed0(0x493,0x520,0x478,0x49d)])){if(_0x29193c[_0x380ed0(0x421,0x477,0x447,0x402)](_0x29193c[_0xa42f45(0x2ce,0x379,0x24a,0x32c)],_0x29193c['GZLbA']))_0x2591e3=!![];else{_0x29193c[_0xa42f45(0x386,0x382,0x3b3,0x380)](_0x47b661,_0xa42f45(0x3c3,0x3fe,0x43c,0x41b)+_0x36868b[_0xa42f45(0x268,0x1e8,0x225,0x236)]+'\x20'+_0x4bdc9f['statusText']);throw new _0x444b94(_0xa42f45(0x3c3,0x429,0x481,0x306)+_0x42fcdc[_0x380ed0(0x3bc,0x3b9,0x36f,0x3bc)]+'\x20'+_0x57a865['statusText']);}}_0x29193c[_0xa42f45(0x301,0x2ac,0x2c1,0x310)](addLog,_0x380ed0(0x508,0x461,0x473,0x4d2)+_0xa42f45(0x270,0x1d7,0x2c4,0x1d7)+'les):\x20'+_0x2591e3);let _0x195c6f={},_0x18ed68='',_0x892119='';if(_0x2591e3){_0x29193c['imVzS'](addLog,_0x29193c[_0xa42f45(0x328,0x3da,0x3ab,0x3a9)]),_0x195c6f=_0x29193c[_0xa42f45(0x386,0x384,0x378,0x403)](parsePromptStringWithCoordinates,_0x364228),_0x18ed68=_0x195c6f[_0x380ed0(0x38a,0x3a7,0x404,0x3ed)+_0xa42f45(0x28f,0x2de,0x34b,0x255)];for(let _0x38b4df=-0x1*-0x187a+0x1dc2+-0x363b;_0x29193c['zqlul'](_0x38b4df,0x1*0x26af+0x258e+-0x403*0x13);_0x38b4df++){_0x195c6f[_0xa42f45(0x2c3,0x27d,0x29f,0x354)+_0x38b4df+'\x20Prompt']&&(_0x29193c[_0xa42f45(0x2e2,0x33c,0x33d,0x315)](_0x29193c['AlemF'],_0x29193c['bezns'])?(_0x29193c['oWAyX'](_0x2dc808,_0x380ed0(0x510,0x55f,0x509,0x50a)+'中的\x20prompt。'),_0x30ac51=_0x29193c[_0x380ed0(0x4b9,0x3cb,0x3b0,0x43d)](_0x372b8c,_0x58aa9c)):_0x892119=_0x29193c['jxGjt'](_0x892119,',\x20')+_0x195c6f[_0xa42f45(0x2c3,0x375,0x266,0x273)+_0x38b4df+_0x380ed0(0x520,0x436,0x4a2,0x4ac)]);}}else _0x29193c[_0x380ed0(0x53c,0x5ce,0x4f1,0x516)](_0x29193c[_0xa42f45(0x38e,0x431,0x44d,0x3b2)],_0x29193c[_0x380ed0(0x474,0x467,0x451,0x4e2)])?(_0x29193c[_0x380ed0(0x4a6,0x407,0x453,0x4a0)](addLog,_0x29193c['SsEQf']),_0x18ed68=_0x29193c[_0x380ed0(0x3f2,0x4ed,0x3ac,0x455)](deduplicateTags,_0x364228)):_0x52d151=_0x29193c['oWAyX'](_0x33097c,_0x4a01a1);let {modifiedPrompt:_0x40af8f,insertions:_0x44b9a9}=await _0x29193c[_0x380ed0(0x416,0x45f,0x4aa,0x44e)](prompt_replace,_0x18ed68,_0x892119);if(_0x2591e3){if(_0x29193c[_0xa42f45(0x368,0x379,0x34c,0x37e)](_0x29193c[_0xa42f45(0x271,0x245,0x2ac,0x211)],_0x29193c['kRany']))for(let _0x1dff69=-0xf*0x1f3+0xa5*-0x2e+0x3ae4;_0x29193c[_0xa42f45(0x35f,0x3bb,0x36a,0x2e9)](_0x1dff69,0xb*-0x151+-0x1b09+0x2988);_0x1dff69++){if(_0x29193c['beEua'](_0x29193c[_0xa42f45(0x26f,0x238,0x1c9,0x1c6)],_0x29193c[_0xa42f45(0x26f,0x284,0x241,0x1d4)])){if(_0x195c6f['Character\x20'+_0x1dff69+_0xa42f45(0x358,0x2b6,0x3b5,0x2d1)]){if(_0x29193c['LdKWd'](_0x29193c[_0xa42f45(0x2b7,0x2b3,0x212,0x2ca)],_0x29193c[_0xa42f45(0x3ca,0x3be,0x47d,0x336)]))_0x40af8f=_0x29193c[_0xa42f45(0x396,0x37f,0x30a,0x2fe)](_0x29193c[_0xa42f45(0x363,0x342,0x2ee,0x318)](_0x40af8f,',\x20'),_0x29193c[_0x380ed0(0x3ff,0x3f5,0x4c1,0x4a0)](prompt_replace_for_character,_0x195c6f[_0x380ed0(0x425,0x45f,0x392,0x417)+_0x1dff69+'\x20Prompt']));else{if(_0x5588e5){const _0x115c03=_0x49994e['apply'](_0x5c7b85,arguments);return _0x1f598b=null,_0x115c03;}}}}else throw new _0x503bef(_0xa42f45(0x37f,0x414,0x3ef,0x3df)+_0x380ed0(0x37c,0x341,0x420,0x3bd));}else _0x5b48e9=_0x29193c[_0x380ed0(0x535,0x430,0x48a,0x4e5)](_0x29193c[_0xa42f45(0x336,0x319,0x387,0x27f)](_0x1d1519,',\x20'),_0x1fcd60['Character\x20'+_0x3c7a5d+'\x20Prompt']);}let _0x26602f=await _0x29193c[_0x380ed0(0x472,0x595,0x547,0x4fd)](zhengmian,extension_settings[extensionName][_0x380ed0(0x493,0x3e8,0x438,0x424)][extension_settings[extensionName]['yusheid_sd']][_0xa42f45(0x314,0x322,0x369,0x30e)+'t'],_0x40af8f,extension_settings[extensionName][_0x380ed0(0x44c,0x41a,0x49e,0x424)][extension_settings[extensionName][_0xa42f45(0x28a,0x346,0x327,0x2de)]][_0x380ed0(0x51b,0x417,0x44d,0x468)+_0xa42f45(0x2af,0x32f,0x231,0x35d)],extension_settings[extensionName][_0xa42f45(0x2c4,0x2a2,0x293,0x2fb)],_0x44b9a9),_0x175d64=await _0x29193c[_0xa42f45(0x2fa,0x23d,0x268,0x2df)](fumian,extension_settings[extensionName][_0xa42f45(0x2d0,0x29e,0x27b,0x22e)][extension_settings[extensionName][_0xa42f45(0x28a,0x2a2,0x1d9,0x274)]][_0x380ed0(0x468,0x510,0x55b,0x509)+'ompt'],extension_settings[extensionName][_0xa42f45(0x275,0x2a0,0x2b5,0x26e)]);if(!_0x2591e3&&window['collectedC'+_0xa42f45(0x395,0x304,0x2e0,0x408)+_0xa42f45(0x37d,0x3b1,0x3a2,0x41a)]){if(_0x29193c[_0xa42f45(0x3a1,0x43b,0x318,0x38b)](_0x29193c['pWWyW'],_0xa42f45(0x369,0x2d4,0x3d8,0x3ad))){const _0x1c22ec=window[_0x380ed0(0x460,0x3ee,0x41f,0x49a)+'haracterNe'+_0xa42f45(0x37d,0x432,0x381,0x30f)][_0x380ed0(0x451,0x50b,0x516,0x463)]();_0x1c22ec&&(_0x175d64=_0x175d64?_0x175d64+',\x20'+_0x1c22ec:_0x1c22ec,addLog('[角色负面]\x20添加角'+'色负面提示词:\x20'+_0x1c22ec),console[_0xa42f45(0x366,0x2b5,0x2f2,0x324)](_0x29193c[_0xa42f45(0x28e,0x2b7,0x241,0x29e)],_0x1c22ec));}else{const _0xa175d2=_0x14f718['apply'](_0xd3a8b0,arguments);return _0x4d9fe9=null,_0xa175d2;}}_0x29193c[_0xa42f45(0x3a3,0x308,0x2f7,0x44a)](addLog,_0x380ed0(0x441,0x432,0x3fa,0x43c)+_0x175d64),extension_settings['sd']['auto_url']=_0x24fe2b,await _0x29193c[_0x380ed0(0x4a5,0x34e,0x40c,0x3f4)](saveSettingsDebounced);try{if(_0x29193c[_0x380ed0(0x463,0x4a0,0x378,0x436)](_0x464426[_0x380ed0(0x422,0x3f0,0x55b,0x4a2)],'jiuguan')){if(_0x29193c[_0x380ed0(0x50c,0x548,0x470,0x514)](_0x29193c['IfFrs'],_0xa42f45(0x2c1,0x215,0x27e,0x294)))_0x7da3cc[_0x380ed0(0x450,0x476,0x3ff,0x4b2)+_0xa42f45(0x2de,0x34c,0x27f,0x262)](_0x5e212a[_0xa42f45(0x2ab,0x2d9,0x23e,0x342)+'MAGE_REQUE'+'ST'],_0x32c404),_0x561857[_0x380ed0(0x595,0x569,0x4b0,0x513)+'SDListener']=![],_0x29193c[_0xa42f45(0x2e9,0x295,0x319,0x2ef)](_0x54b6ab,_0xa42f45(0x3c9,0x3e0,0x3d7,0x3e1)+_0xa42f45(0x356,0x2c7,0x2fb,0x3fa));else{const _0x4dacdd={};_0x4dacdd[_0xa42f45(0x3a8,0x34d,0x430,0x328)]=_0x464426['st_chatu8_'+_0x380ed0(0x4b2,0x5d1,0x59f,0x515)]?_0x464426[_0xa42f45(0x371,0x3b9,0x427,0x3f1)+_0xa42f45(0x3c1,0x472,0x3eb,0x322)]:'',_0x4dacdd[_0x380ed0(0x404,0x457,0x434,0x40e)]=_0x24fe2b;const _0x3a025a=await _0x29193c[_0xa42f45(0x384,0x428,0x3bd,0x2f9)](fetch,_0xa42f45(0x3b3,0x412,0x374,0x45e)+_0x380ed0(0x406,0x44b,0x445,0x46c),{'method':_0x29193c[_0x380ed0(0x4ea,0x4b6,0x559,0x4c3)],'body':JSON['stringify'](_0x4dacdd),'headers':_0x29193c[_0x380ed0(0x3b4,0x3c8,0x452,0x455)](getRequestHeaders,window['token'])});if(!_0x3a025a['ok']){addLog(_0xa42f45(0x3c3,0x3c3,0x356,0x3a4)+_0x3a025a[_0xa42f45(0x268,0x2f6,0x2e5,0x314)]+'\x20'+_0x3a025a[_0xa42f45(0x312,0x331,0x282,0x31a)]);throw new Error('获取模型失败:\x20'+_0x3a025a[_0x380ed0(0x424,0x451,0x39c,0x3bc)]+'\x20'+_0x3a025a[_0x380ed0(0x453,0x3f4,0x3b6,0x466)]);}let _0x47123a=await _0x3a025a[_0x380ed0(0x432,0x34c,0x380,0x3ca)]();console['log'](_0x29193c['YSnVD'],_0x47123a),console[_0x380ed0(0x42c,0x42f,0x499,0x4ba)]('extension_'+'settingss.'+_0x380ed0(0x338,0x3dc,0x3ff,0x3ef)+_0x380ed0(0x52e,0x453,0x570,0x4d4),_0x464426[_0x380ed0(0x342,0x3ba,0x42b,0x3ef)+_0x380ed0(0x43d,0x540,0x464,0x4d4)]);if(_0x29193c['FYqeh'](_0x47123a,_0x464426[_0xa42f45(0x29b,0x230,0x33f,0x290)+'8_model'])){if(_0x29193c[_0xa42f45(0x368,0x2f8,0x3ed,0x425)](_0x29193c[_0xa42f45(0x3d3,0x374,0x37a,0x31c)],_0x29193c['nrrrd'])){_0x29193c[_0xa42f45(0x386,0x379,0x329,0x30f)](addLog,'正在设置模型为'+_0x464426[_0x380ed0(0x33d,0x44b,0x443,0x3ef)+'8_model']+_0x380ed0(0x3fe,0x473,0x52c,0x470)),toastr['info']('正在设置模型...为'+_0x464426[_0x380ed0(0x497,0x491,0x338,0x3ef)+_0x380ed0(0x54b,0x55a,0x55f,0x4d4)]);const _0x53ef7c={};_0x53ef7c['auth']=_0x464426[_0xa42f45(0x371,0x3ae,0x3c8,0x3f1)+_0x380ed0(0x501,0x47b,0x47b,0x515)]?_0x464426[_0xa42f45(0x371,0x32a,0x407,0x392)+_0x380ed0(0x53f,0x51a,0x5a8,0x515)]:'',_0x53ef7c[_0x380ed0(0x42c,0x420,0x381,0x40e)]=_0x24fe2b,_0x53ef7c[_0xa42f45(0x2f1,0x24f,0x260,0x25f)]=_0x464426[_0xa42f45(0x29b,0x301,0x22f,0x1ea)+_0x380ed0(0x4ee,0x4de,0x58b,0x4d4)];const _0x5a0bdc=await _0x29193c[_0x380ed0(0x546,0x4b0,0x580,0x4c7)](fetch,_0x29193c[_0xa42f45(0x352,0x30f,0x3c0,0x307)],{'method':_0x29193c[_0x380ed0(0x505,0x467,0x50a,0x4c3)],'body':JSON[_0xa42f45(0x2ac,0x312,0x353,0x31e)](_0x53ef7c),'headers':_0x29193c[_0xa42f45(0x2b0,0x306,0x28d,0x336)](getRequestHeaders,window[_0x380ed0(0x4ea,0x474,0x4df,0x433)])});if(!_0x5a0bdc['ok']){_0x29193c[_0x380ed0(0x3c3,0x476,0x3af,0x443)](addLog,_0xa42f45(0x2d9,0x312,0x324,0x28c)+_0x5a0bdc[_0xa42f45(0x268,0x217,0x25b,0x2cb)]+'\x20'+_0x5a0bdc[_0x380ed0(0x3be,0x3f8,0x3c5,0x466)]);throw new Error(_0x380ed0(0x4c1,0x411,0x44b,0x42d)+_0x5a0bdc['status']+'\x20'+_0x5a0bdc['statusText']);}toastr['info'](_0xa42f45(0x26c,0x24e,0x2af,0x1d5)+_0x464426['sd_cchatu_'+_0x380ed0(0x4ee,0x57c,0x4a7,0x4d4)]+'成功');}else{const _0x5a32ee=_0x29193c['HIxEy'][_0xa42f45(0x30b,0x37a,0x282,0x393)]('|');let _0x5e1023=0x2*-0x353+-0x2*0x1227+0x2af4;while(!![]){switch(_0x5a32ee[_0x5e1023++]){case'0':_0x10c049(_0x380ed0(0x538,0x500,0x541,0x50b)+_0x2cec4a['message']);continue;case'1':_0x13cd05[_0xa42f45(0x351,0x2b3,0x314,0x37c)]=!![];continue;case'2':_0x41a15e[_0x380ed0(0x46b,0x495,0x5b5,0x4fb)](_0x29193c[_0x380ed0(0x464,0x3fc,0x4c0,0x4af)],_0x379f88);continue;case'3':if(_0x29193c[_0x380ed0(0x491,0x3cf,0x35b,0x3e9)](_0x41f7d5['message'],'任务已取消')){}else _0x201b12[_0x380ed0(0x33d,0x3b9,0x49a,0x3eb)+'sk'](_0x2a6ff2,![]);continue;case'4':_0x2012a2=null;continue;case'5':throw _0x56d0a1;continue;}break;}}}}}else{let _0x5f0611=await _0x29193c[_0x380ed0(0x4b9,0x4ee,0x3c9,0x43d)](getSDMode,_0x24fe2b);_0x29193c[_0xa42f45(0x3b8,0x383,0x434,0x324)](_0x5f0611,_0x464426['sd_cchatu_'+'8_model'])&&(_0x29193c[_0xa42f45(0x375,0x2be,0x32f,0x425)](_0x29193c[_0x380ed0(0x3a5,0x3a5,0x3ec,0x426)],_0x380ed0(0x592,0x4a8,0x545,0x4de))?(_0x294f19[_0xa42f45(0x366,0x373,0x32f,0x3d6)](_0x29193c[_0xa42f45(0x360,0x3a0,0x3a9,0x404)]),_0x5d26f8[_0xa42f45(0x351,0x35c,0x3d0,0x398)]=!![]):(_0x29193c[_0x380ed0(0x422,0x379,0x3e1,0x3bf)](addLog,_0xa42f45(0x2f3,0x395,0x27e,0x2e1)+_0x464426[_0x380ed0(0x482,0x3ff,0x40a,0x3ef)+_0xa42f45(0x380,0x409,0x42a,0x3b5)]+_0xa42f45(0x31c,0x2fd,0x28f,0x2c2)),await _0x29193c[_0x380ed0(0x59a,0x4bb,0x49c,0x502)](setSDMode,_0x24fe2b,_0x464426[_0xa42f45(0x29b,0x26f,0x2b4,0x25e)+'8_model'])));}}catch(_0x172214){if(_0x29193c[_0xa42f45(0x34f,0x321,0x312,0x2c4)](_0x29193c[_0x380ed0(0x34c,0x349,0x37d,0x401)],_0x29193c[_0x380ed0(0x3e9,0x4bd,0x470,0x401)])){_0x29193c[_0xa42f45(0x2ef,0x287,0x33c,0x362)](addLog,'获取或者切换模型失败'+':\x20'+_0x172214['message']+(_0xa42f45(0x36b,0x3c6,0x2c4,0x3b7)+'i是否正常启动，并检'+_0x380ed0(0x410,0x4c9,0x4cf,0x474))),taskQueue[_0xa42f45(0x297,0x23b,0x30a,0x2ab)+'sk'](_0x3d2416,![]),currentTaskId=null;throw new Error(_0x380ed0(0x4d8,0x445,0x4ba,0x485)+_0x380ed0(0x4ab,0x562,0x485,0x4cb)+_0xa42f45(0x345,0x2e1,0x3b3,0x2f9)+'查模型是否正确。');}else _0x59df59['on'](_0x11e363[_0x380ed0(0x451,0x4a4,0x397,0x3ff)+'MAGE_REQUE'+'ST'],_0x2384c9),_0x29193c[_0x380ed0(0x456,0x52a,0x443,0x4da)](_0x36173f,_0x29193c[_0xa42f45(0x306,0x378,0x2f0,0x2d9)]);}let _0x2388ae=-(0x1*0x1777+-0x100c+-0x76a);const _0x4a9e20=_0x464426[_0xa42f45(0x3b1,0x3bb,0x3c1,0x461)];_0x4a9e20!==''&&_0x29193c[_0x380ed0(0x565,0x4fd,0x504,0x519)](_0x4a9e20,null)&&!isNaN(_0x29193c['GROiF'](Number,_0x4a9e20))&&_0x29193c[_0xa42f45(0x2f5,0x2cc,0x332,0x3b0)](_0x29193c[_0x380ed0(0x58d,0x43a,0x55b,0x4da)](Number,_0x4a9e20),-0x207*-0x12+-0x10c*0xd+-0x16e2)&&(_0x2388ae=_0x29193c[_0x380ed0(0x3a8,0x3cc,0x3bd,0x443)](Number,_0x4a9e20));let _0x2d0159={'prompt':_0x26602f,'negative_prompt':_0x175d64,'sampler_name':_0x464426[_0x380ed0(0x389,0x47a,0x3c3,0x3ef)+'8_samplerN'+_0xa42f45(0x392,0x32c,0x416,0x37f)],'scheduler':_0x464426[_0x380ed0(0x353,0x476,0x3e2,0x3ef)+_0xa42f45(0x39b,0x392,0x456,0x401)+'r'],'steps':_0x464426[_0x380ed0(0x4e0,0x4c9,0x425,0x44c)],'cfg_scale':_0x464426[_0x380ed0(0x51e,0x54b,0x55c,0x4ce)],'width':_0x56935e?_0x56935e:_0x464426[_0x380ed0(0x435,0x3ae,0x3bd,0x44f)],'height':_0x21a625?_0x21a625:_0x464426[_0xa42f45(0x2b2,0x2ba,0x2aa,0x248)],'restore_faces':_0x29193c['LiAiA'](_0x464426[_0x380ed0(0x34f,0x432,0x3e7,0x3bb)+'es'],_0x29193c['aPDff']),'enable_hr':_0x29193c[_0x380ed0(0x4b4,0x3dd,0x4ad,0x40d)](_0x464426[_0x380ed0(0x3dd,0x478,0x49f,0x496)+_0xa42f45(0x3c8,0x3fe,0x3d8,0x3cf)],_0x29193c['aPDff']),'hr_upscaler':_0x464426[_0xa42f45(0x29b,0x246,0x299,0x332)+_0x380ed0(0x39f,0x3b0,0x4a7,0x42e)],'hr_scale':_0x464426['sd_cupscal'+_0x380ed0(0x574,0x51b,0x459,0x4e0)],'hr_additional_modules':[],'denoising_strength':_0x464426['sd_cdenois'+_0xa42f45(0x263,0x30a,0x248,0x1b9)+'th'],'hr_second_pass_steps':_0x464426[_0x380ed0(0x4cf,0x47d,0x448,0x496)+_0xa42f45(0x2c5,0x25b,0x267,0x277)],'seed':_0x2388ae,'override_settings':{'CLIP_stop_at_last_layers':_0x29193c[_0x380ed0(0x502,0x474,0x537,0x4f7)](Number,_0x464426['sd_cclip_s'+_0xa42f45(0x323,0x363,0x341,0x297)]),'sd_vae':_0x464426[_0x380ed0(0x332,0x440,0x37c,0x3ef)+_0x380ed0(0x430,0x412,0x435,0x452)]},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x29193c[_0x380ed0(0x37a,0x430,0x4c7,0x416)](addLog,_0x380ed0(0x49a,0x498,0x558,0x4ab)+'ces\x20脸部修复\x20为'+_0x2d0159[_0x380ed0(0x55e,0x428,0x4b0,0x4ab)+_0x380ed0(0x4f4,0x4f6,0x504,0x50e)]);function _0x380ed0(_0x5ad76e,_0x3204aa,_0x1bc834,_0x160aa1){return _0xf8e5(_0x160aa1-0x254,_0x5ad76e);}addLog(_0x380ed0(0x3bc,0x4d5,0x501,0x478)+_0x380ed0(0x3d6,0x385,0x406,0x41b)+_0x2d0159[_0x380ed0(0x38f,0x32a,0x41b,0x3ce)]);if(_0x29193c[_0xa42f45(0x2b9,0x2cd,0x215,0x277)](_0x464426['sd_cadetai'+_0x380ed0(0x43e,0x3db,0x4a6,0x3fe)],_0x29193c['aPDff'])){_0x29193c['imVzS'](addLog,_0x29193c[_0xa42f45(0x2b1,0x254,0x25c,0x2c0)]);const _0x1a7b11={};_0x1a7b11[_0xa42f45(0x2bc,0x334,0x22d,0x298)]=_0x380ed0(0x444,0x48d,0x3a8,0x45b)+_0xa42f45(0x3a0,0x2f6,0x33e,0x35c);const _0x76ec02={};_0x76ec02[_0xa42f45(0x2bb,0x33b,0x21b,0x26a)]=[!![],!![],_0x1a7b11];const _0x149048={};_0x149048[_0xa42f45(0x3aa,0x3bd,0x3bc,0x444)]=_0x76ec02;const _0x4ba3e2={};_0x4ba3e2[_0x380ed0(0x51f,0x478,0x4cf,0x4b8)+_0xa42f45(0x350,0x398,0x2ef,0x2d5)]=_0x149048,_0x2d0159=deepMerge(_0x2d0159,_0x4ba3e2);}const _0x5bd454=_0xa42f45(0x29d,0x308,0x26a,0x2c6)+_0xa42f45(0x281,0x2a3,0x267,0x243)+'正面提示\x20(Prom'+'pt):**\x20'+_0x26602f+(_0x380ed0(0x565,0x584,0x49a,0x522)+_0x380ed0(0x4b0,0x443,0x411,0x495)+_0xa42f45(0x3d0,0x351,0x3c1,0x3b4)+'\x20')+_0x175d64+(_0x380ed0(0x473,0x368,0x43d,0x3e8)+_0xa42f45(0x29e,0x1e7,0x308,0x2a5)+_0x380ed0(0x455,0x522,0x46a,0x486))+_0x2d0159[_0x380ed0(0x4ed,0x4a6,0x4a2,0x480)+'me']+(_0x380ed0(0x389,0x3f7,0x42b,0x41d)+_0xa42f45(0x3ab,0x356,0x330,0x41b))+_0x2d0159['steps']+(_0xa42f45(0x379,0x3af,0x3b2,0x37b)+_0xa42f45(0x31d,0x2ab,0x285,0x2f9))+_0x2d0159[_0x380ed0(0x582,0x4ae,0x51b,0x51a)]+(_0x380ed0(0x414,0x46e,0x3ab,0x3d4)+'ize):**\x20')+_0x2d0159[_0x380ed0(0x3c0,0x456,0x45a,0x430)]+'x'+_0x2d0159[_0x380ed0(0x45e,0x3ec,0x3ce,0x481)]+(_0xa42f45(0x3d7,0x335,0x3cd,0x47f)+_0xa42f45(0x39d,0x3d1,0x452,0x446))+(_0x29193c[_0xa42f45(0x308,0x296,0x25d,0x25d)](_0x2d0159[_0xa42f45(0x2d7,0x295,0x259,0x2f1)],-(0x1*-0xe15+-0x206b+0x2e81))?_0xa42f45(0x327,0x30b,0x3b6,0x3e5):_0x2d0159[_0x380ed0(0x4ab,0x408,0x4d9,0x42b)])+(_0xa42f45(0x33b,0x3d6,0x2b3,0x2ff)+_0xa42f45(0x27f,0x30c,0x2d9,0x2bd))+_0x464426[_0x380ed0(0x41e,0x3dc,0x450,0x3ef)+_0xa42f45(0x380,0x42b,0x32f,0x355)]+('\x0a-\x20**VAE:*'+'*\x20')+_0x2d0159['override_s'+'ettings'][_0x380ed0(0x539,0x457,0x3f4,0x494)]+(_0xa42f45(0x286,0x2b5,0x2cd,0x275)+_0x380ed0(0x400,0x3a6,0x3ef,0x3d0))+_0x2d0159['override_s'+_0xa42f45(0x38f,0x37b,0x363,0x390)][_0x380ed0(0x5d6,0x5a1,0x4af,0x528)+_0x380ed0(0x3b6,0x3b4,0x3b7,0x3dc)+_0x380ed0(0x474,0x427,0x3bd,0x43e)]+(_0x380ed0(0x3f9,0x361,0x33e,0x3fa)+_0x380ed0(0x4cd,0x4eb,0x434,0x4b1)+'):**\x20')+_0x2d0159[_0x380ed0(0x450,0x45b,0x35c,0x3ce)]+(_0x380ed0(0x401,0x52a,0x4bb,0x479)+_0xa42f45(0x333,0x2b4,0x3d5,0x307)+_0xa42f45(0x372,0x374,0x2ed,0x330))+_0x2d0159[_0x380ed0(0x59a,0x4b5,0x473,0x512)]+(_0x380ed0(0x4a5,0x43c,0x491,0x493)+_0x380ed0(0x473,0x362,0x423,0x3e1)+_0x380ed0(0x5aa,0x5c3,0x5a2,0x50d)+':**\x20')+_0x2d0159['denoising_'+_0x380ed0(0x46b,0x4d2,0x4c6,0x4db)]+(_0x380ed0(0x444,0x377,0x3e3,0x3ec)+_0x380ed0(0x407,0x4f1,0x4a0,0x49e)+'aces):**\x20')+_0x2d0159[_0xa42f45(0x357,0x364,0x39a,0x2fd)+'ces']+('\x0a-\x20**ADeta'+_0x380ed0(0x3d6,0x404,0x483,0x429))+_0x29193c['hSWXN'](_0x464426[_0x380ed0(0x497,0x500,0x4c2,0x4f8)+'ler'],_0x380ed0(0x3fd,0x340,0x3ca,0x3b1))+_0xa42f45(0x282,0x22a,0x265,0x228);_0x29193c['flakA'](addLog,_0x5bd454),_0x29193c[_0x380ed0(0x512,0x3e2,0x416,0x475)](addLog,'sdwebui生图参'+'数为'+JSON[_0x380ed0(0x45f,0x3a4,0x451,0x400)](_0x2d0159)),console[_0xa42f45(0x366,0x338,0x301,0x38d)](_0x380ed0(0x3f9,0x4bf,0x481,0x40c),_0x2d0159);while(!window[_0xa42f45(0x351,0x301,0x353,0x3d9)]){await _0x29193c['aXKcO'](sleep,-0x60c+-0xd*-0xcb+-0x5b*0x1);};try{window[_0x380ed0(0x4e0,0x4f3,0x43e,0x4a5)]=![],taskQueue[_0xa42f45(0x2cf,0x234,0x338,0x347)+'us'](_0x3d2416,_0x29193c[_0x380ed0(0x4bc,0x48a,0x4e2,0x4f2)]);if(_0x29193c[_0x380ed0(0x389,0x3c3,0x423,0x3c6)](_0x464426['client'],_0x29193c['iUGjZ'])){if(!taskQueue['isTaskInQu'+_0x380ed0(0x407,0x4ee,0x3e4,0x473)](_0x3d2416)){_0x29193c[_0xa42f45(0x386,0x3a9,0x376,0x333)](addLog,_0x380ed0(0x461,0x3c0,0x40c,0x43a)),eventSource[_0x380ed0(0x565,0x48e,0x4de,0x520)](_0x29193c[_0x380ed0(0x4bb,0x503,0x565,0x4fa)]);throw new Error(_0x29193c[_0xa42f45(0x2fc,0x316,0x325,0x32a)]);}_0x2d0159[_0x380ed0(0x445,0x4bd,0x4a2,0x40e)]=_0x24fe2b,console[_0xa42f45(0x366,0x354,0x41f,0x2aa)](_0x29193c[_0xa42f45(0x378,0x2f3,0x310,0x3e9)],_0x464426[_0xa42f45(0x371,0x397,0x337,0x3cb)+_0xa42f45(0x3c1,0x429,0x328,0x33c)]),_0x2d0159[_0x380ed0(0x447,0x473,0x45c,0x4fc)]=_0x464426[_0x380ed0(0x445,0x4bc,0x488,0x4c5)+_0x380ed0(0x555,0x5b0,0x589,0x515)]?_0x464426[_0x380ed0(0x4c9,0x52c,0x531,0x4c5)+'sd_auth']:'';const _0x3b26e0=await fetch(_0xa42f45(0x3b3,0x40a,0x42c,0x31b)+_0x380ed0(0x555,0x423,0x4e6,0x49c),{'method':_0x29193c[_0xa42f45(0x36f,0x378,0x404,0x42a)],'headers':getRequestHeaders(window[_0x380ed0(0x4d7,0x3a6,0x45e,0x433)]),'body':JSON[_0x380ed0(0x3a2,0x442,0x3df,0x400)](_0x2d0159)});if(!_0x3b26e0['ok']){if(_0x29193c['xMUnW']!==_0x29193c[_0xa42f45(0x287,0x262,0x1d9,0x22a)]){const _0x55900a=await _0x3b26e0[_0x380ed0(0x310,0x3c8,0x3cd,0x3ca)]();_0x29193c[_0xa42f45(0x2c2,0x28f,0x2b7,0x2be)](addLog,_0x380ed0(0x483,0x4b9,0x5a2,0x521)+_0xa42f45(0x25e,0x273,0x2fc,0x2f0)+_0x3b26e0[_0x380ed0(0x34a,0x380,0x474,0x3bc)]+_0xa42f45(0x2a5,0x214,0x316,0x246)+_0x55900a),console['log'](_0x29193c['TVbEa'],_0x55900a);throw new Error('请求失败,状态码:\x20'+_0x3b26e0[_0x380ed0(0x393,0x389,0x344,0x3bc)]+',\x20详情:\x20'+_0x55900a);}else _0x1f2acb[_0xa42f45(0x2c3,0x37e,0x214,0x211)+_0x41369c+_0x380ed0(0x412,0x547,0x551,0x4ac)]&&(_0x387929=_0x29193c[_0xa42f45(0x363,0x409,0x3d2,0x3a6)](_0x32cde3,',\x20')+_0xe1d5ab[_0x380ed0(0x4a4,0x3ca,0x3cb,0x417)+_0x5efc00+'\x20Prompt']);}const _0x50cf39=await _0x3b26e0[_0xa42f45(0x276,0x330,0x296,0x1c9)]();let _0x5d9fda='';try{const _0x1aad73=JSON['parse'](_0x50cf39);_0x5d9fda=_0x1aad73['images'][-0x1*-0x24bd+-0xb1f+0x1*-0x199e];}catch(_0x1183c8){_0x29193c[_0xa42f45(0x361,0x330,0x348,0x399)]===_0x380ed0(0x358,0x433,0x4a4,0x408)?_0x29bea4=_0x29193c[_0x380ed0(0x525,0x3c7,0x3d1,0x483)](_0x52ad99+',\x20',_0x29193c['GROiF'](_0x222028,_0x35e9df[_0xa42f45(0x2c3,0x37c,0x258,0x32b)+_0x5980ae+_0xa42f45(0x358,0x3c8,0x37e,0x33f)])):(_0x29193c[_0x380ed0(0x504,0x47a,0x423,0x46b)](addLog,_0x29193c[_0xa42f45(0x365,0x3ff,0x2fa,0x32e)]),_0x5d9fda=_0x50cf39);}const _0x3a41e8=_0x29193c[_0xa42f45(0x260,0x1a8,0x1af,0x1d4)](_0xa42f45(0x2d6,0x308,0x2b2,0x247)+'/png;base6'+'4,',_0x5d9fda);addLog(_0x29193c[_0x380ed0(0x468,0x4da,0x566,0x510)]),setTimeout(()=>{function _0x367362(_0x3470ef,_0xbb8be0,_0xdafdcc,_0x3f2c1c){return _0xa42f45(_0x3470ef- -0x257,_0xbb8be0,_0xdafdcc-0x186,_0x3f2c1c-0x89);}console[_0x367362(0x10f,0x13a,0x14e,0xf5)](_0x29193c[_0x55bc35(-0xc5,-0x58,-0x6f,-0xb6)]);function _0x55bc35(_0x4ba1f8,_0x1ac880,_0x50f24f,_0x7745a5){return _0xa42f45(_0x4ba1f8- -0x425,_0x1ac880,_0x50f24f-0xfe,_0x7745a5-0x14);}window['xiancheng']=!![];},extension_settings[extensionName]['imageGenIn'+'terval']);;taskQueue['completeTa'+'sk'](_0x3d2416,!![]),currentTaskId=null;if(_0x29193c[_0xa42f45(0x295,0x246,0x1ee,0x253)](_0x29193c[_0xa42f45(0x301,0x2e5,0x39b,0x248)](String,extension_settings[extensionName][_0x380ed0(0x3fd,0x458,0x3d1,0x472)+_0xa42f45(0x2e4,0x287,0x36b,0x29d)]),_0x29193c[_0xa42f45(0x34d,0x329,0x319,0x3b1)])){if(_0x29193c[_0xa42f45(0x3a1,0x3a8,0x3c0,0x2f1)](_0x29193c[_0x380ed0(0x421,0x468,0x46a,0x492)],'cqdgc'))_0x3a41e8=await _0x29193c[_0x380ed0(0x4ef,0x435,0x460,0x46b)](convertImageToJpeg,_0x3a41e8);else{const _0x1fc1b6={};_0x1fc1b6[_0x380ed0(0x3b0,0x379,0x42f,0x41c)]='Mozilla/5.'+'0\x20(Windows'+_0xa42f45(0x2f0,0x380,0x3ad,0x287)+_0xa42f45(0x2f7,0x350,0x32d,0x2d4)+_0xa42f45(0x304,0x3b2,0x28e,0x355)+_0x380ed0(0x4c6,0x565,0x54b,0x51b)+_0xa42f45(0x385,0x42b,0x3e7,0x3a0)+_0xa42f45(0x2dd,0x226,0x387,0x297)+_0x380ed0(0x34a,0x304,0x374,0x3c2)+_0xa42f45(0x2e1,0x317,0x35b,0x245)+_0x380ed0(0x477,0x456,0x4a4,0x48d)+'6',_0x1fc1b6[_0xa42f45(0x326,0x2e0,0x3c5,0x3e4)]=_0x29193c[_0xa42f45(0x2ca,0x28c,0x225,0x2ae)],_0x1fc1b6[_0x380ed0(0x3e3,0x377,0x4be,0x425)+_0x380ed0(0x4aa,0x3af,0x43c,0x411)]=_0x29193c[_0xa42f45(0x278,0x32c,0x266,0x2bc)],_0x1fc1b6[_0x380ed0(0x51e,0x420,0x515,0x4ca)+_0xa42f45(0x2ed,0x3aa,0x357,0x27d)]=_0x29193c[_0xa42f45(0x2e7,0x308,0x24f,0x243)],_0x1fc1b6['Pragma']=_0x29193c[_0xa42f45(0x2e7,0x288,0x2f8,0x334)];const _0x14ab0d=_0x1fc1b6;return _0x42674c&&(_0x14ab0d[_0x29193c[_0xa42f45(0x291,0x313,0x2d0,0x1e3)]]=_0x578b73),_0x3793a7&&(_0x14ab0d[_0x29193c[_0xa42f45(0x296,0x2d7,0x2db,0x300)]]=_0x39e1c2),_0x14ab0d;}}return{'image':_0x3a41e8,'change':_0x29193c[_0x380ed0(0x4b8,0x43e,0x4d4,0x47e)](_0x29e984,'')};}else{if(!taskQueue['isTaskInQu'+_0x380ed0(0x480,0x435,0x4df,0x473)](_0x3d2416)){_0x29193c[_0x380ed0(0x322,0x376,0x337,0x3bf)](addLog,_0x29193c[_0xa42f45(0x27e,0x311,0x2a0,0x2db)]);throw new Error(_0x29193c['kuxDy']);}const _0x696905=new URL(_0x29193c[_0xa42f45(0x31a,0x327,0x2ff,0x266)](_0x24fe2b,_0xa42f45(0x262,0x1ac,0x1be,0x297)+_0xa42f45(0x3b4,0x3f1,0x32c,0x341)));window[_0xa42f45(0x351,0x352,0x395,0x3d6)]=![];const _0xe92d9b=await _0x29193c[_0x380ed0(0x3ac,0x400,0x3a6,0x3e0)](fetch,_0x696905,{'method':_0x29193c[_0xa42f45(0x36f,0x301,0x35d,0x3d5)],'body':JSON[_0xa42f45(0x2ac,0x259,0x2de,0x251)](_0x2d0159),'headers':_0x29193c[_0x380ed0(0x43c,0x4b2,0x3cc,0x44e)](getDirectHeaders,_0x29193c[_0x380ed0(0x54e,0x441,0x5a4,0x4ed)],_0x29193c['MXHuy'](getsdAuth))});_0x29193c[_0x380ed0(0x4ac,0x46c,0x4e4,0x44e)](setTimeout,()=>{function _0x5ea804(_0x4703d6,_0x22e8ef,_0x33cdf3,_0x45c68b){return _0x380ed0(_0x4703d6,_0x22e8ef-0x1d6,_0x33cdf3-0x124,_0x45c68b- -0x4ce);}function _0x249194(_0x560334,_0x5a1f46,_0x3d90ac,_0x111d38){return _0xa42f45(_0x560334- -0x95,_0x3d90ac,_0x3d90ac-0x11e,_0x111d38-0x16);}_0x29193c[_0x249194(0x2c4,0x2c0,0x33a,0x373)](_0x29193c['znHIl'],_0x29193c[_0x5ea804(-0x27,-0x23,-0x7b,0x2b)])?(console[_0x5ea804(-0x31,-0x54,-0xa0,-0x14)](_0x249194(0x343,0x334,0x3de,0x371)+_0x5ea804(-0xdc,-0x40,-0x1f,-0xc4)),window[_0x5ea804(-0xdd,0x5e,-0xd2,-0x29)]=!![]):(_0x12a17e[_0x249194(0x2d1,0x24a,0x291,0x2fd)]('xiancheng\x20'+'为true'),_0x1d49c6['xiancheng']=!![]);},extension_settings[extensionName]['imageGenIn'+_0x380ed0(0x54b,0x597,0x4b8,0x4f0)]);;if(!_0xe92d9b['ok']){if(_0x29193c[_0x380ed0(0x494,0x3c7,0x440,0x41f)](_0x29193c['TokOK'],_0x29193c['TokOK'])){const _0x405870=await _0xe92d9b[_0x380ed0(0x33c,0x454,0x457,0x3ca)]();_0x29193c[_0x380ed0(0x441,0x4f1,0x4e7,0x4da)](addLog,_0x380ed0(0x3d6,0x4bf,0x412,0x453)+_0x380ed0(0x508,0x47a,0x4c5,0x489)+_0xe92d9b[_0x380ed0(0x409,0x3bd,0x329,0x3bc)]+_0xa42f45(0x2a5,0x2bb,0x277,0x293)+_0x405870),console['log'](_0xa42f45(0x367,0x2f7,0x2de,0x368),_0x405870);throw new Error(_0xa42f45(0x28b,0x2aa,0x329,0x322)+_0xe92d9b[_0xa42f45(0x268,0x274,0x2dd,0x2b3)]+',\x20详情:\x20'+_0x405870);}else{_0x29193c[_0xa42f45(0x301,0x270,0x3b0,0x273)](_0x1fb951,_0x380ed0(0x490,0x45a,0x430,0x43a));throw new _0x4ab737('任务已取消');}}const _0x1e3ca2=await _0xe92d9b[_0xa42f45(0x344,0x316,0x37d,0x2ca)]();if(!_0x1e3ca2['images']||_0x1e3ca2['images'][_0xa42f45(0x381,0x2c2,0x3e2,0x316)]===-0xc3a+0xcea+-0xb*0x10)throw new Error(_0x29193c['CbyZw']);const _0x139d6f=_0x1e3ca2['images'][0x9e0+-0xc14+0x234*0x1],_0xd62aac=_0x29193c['yVvqy'](_0x29193c[_0xa42f45(0x285,0x327,0x208,0x2b5)],_0x139d6f);return _0x29193c[_0x380ed0(0x4d0,0x56c,0x56d,0x4e8)](addLog,_0x29193c['PnPtQ']),taskQueue[_0x380ed0(0x41f,0x428,0x42b,0x3eb)+'sk'](_0x3d2416,!![]),currentTaskId=null,_0x29193c[_0x380ed0(0x4bb,0x37b,0x4af,0x434)](_0x29193c[_0x380ed0(0x5a1,0x562,0x512,0x518)](String,extension_settings[extensionName][_0x380ed0(0x528,0x404,0x528,0x472)+_0x380ed0(0x3fd,0x416,0x433,0x438)]),_0x29193c[_0xa42f45(0x34d,0x3ed,0x37d,0x36b)])&&(_0xd62aac=await convertImageToJpeg(_0xd62aac)),{'image':_0xd62aac,'change':_0x29193c['kMvfn'](_0x131bd6,'')};}}catch(_0x270b6b){if(_0x29193c['VQkHV'](_0x29193c['dfiMy'],_0x29193c[_0xa42f45(0x2ee,0x26a,0x38c,0x338)])){_0x5ecb81(_0x29193c[_0x380ed0(0x3d6,0x3b9,0x44a,0x3d2)]),_0x1300f6[_0x380ed0(0x51d,0x4e0,0x5ae,0x520)](_0x380ed0(0x36c,0x4a5,0x46b,0x3ee)+'neration');throw new _0xb67d6e(_0x29193c[_0x380ed0(0x409,0x439,0x4c2,0x450)]);}else{const _0x1b8860=_0x29193c[_0x380ed0(0x491,0x3cd,0x507,0x48b)][_0x380ed0(0x516,0x3c0,0x476,0x45f)]('|');let _0x95fcb9=-0xb77+0x105d+-0x13*0x42;while(!![]){switch(_0x1b8860[_0x95fcb9++]){case'0':currentTaskId=null;continue;case'1':window[_0xa42f45(0x351,0x35f,0x3c7,0x405)]=!![];continue;case'2':if(_0x270b6b[_0x380ed0(0x3e0,0x373,0x45f,0x3c7)]===_0x29193c[_0xa42f45(0x2fc,0x308,0x2ef,0x297)]){}else taskQueue[_0xa42f45(0x297,0x30e,0x355,0x2c8)+'sk'](_0x3d2416,![]);continue;case'3':_0x29193c[_0xa42f45(0x31b,0x363,0x263,0x2cc)](addLog,_0x380ed0(0x538,0x4bb,0x578,0x50b)+_0x270b6b['message']);continue;case'4':throw _0x270b6b;continue;case'5':console[_0xa42f45(0x3a7,0x446,0x3ba,0x3b2)](_0x29193c['felCQ'],_0x270b6b);continue;}break;}}}}async function sdGenerate(_0x465386){const _0x39a34f={'Qhnfb':function(_0x4fcf2b,_0x2a4a1a){return _0x4fcf2b(_0x2a4a1a);},'sPzub':function(_0x195d86,_0x4889e3){return _0x195d86!=_0x4889e3;},'WXMNq':function(_0x4eaf1f,_0x5555ec){return _0x4eaf1f!==_0x5555ec;},'bPadz':_0x21100f(-0xe4,-0xe5,-0x50,-0x11e),'BPzYe':_0x5363e2(0x1b8,0x14a,0x20a,0x11f),'xOigX':function(_0x3c9524,_0x4f3330,_0x245e9b,_0x2cb687){return _0x3c9524(_0x4f3330,_0x245e9b,_0x2cb687);},'GmkOe':function(_0x2798d5,_0xdfc00){return _0x2798d5(_0xdfc00);},'zNuTX':'Error\x20gene'+_0x21100f(-0x1d5,-0x268,-0x1bb,-0x127)+_0x21100f(-0x125,-0x74,-0x11e,-0x8d),'ijyrO':function(_0x5e64e9,_0x4d3ee0){return _0x5e64e9(_0x4d3ee0);}};function _0x21100f(_0x2b70e8,_0x194af0,_0x26da4e,_0xfea3e){return _0xf8e5(_0x2b70e8- -0x3a1,_0x26da4e);}const {id:_0x2eea95,prompt:_0x4ef505,width:_0x2eae43,height:_0x341b9e,change:_0x8c8922}=_0x465386;_0x39a34f[_0x5363e2(0xd0,0x4e,0xa9,0xf5)](addLog,'收到SD生图请求\x20('+_0x5363e2(0x137,0x1aa,0xf9,0xe8)+_0x2eea95+(_0x5363e2(0x1c6,0x1ab,0x271,0x272)+':\x20')+_0x4ef505+(_0x8c8922?_0x5363e2(0x1a1,0x210,0x22e,0x226)+'\x20'+_0x8c8922:''));if(_0x8c8922&&_0x8c8922[_0x5363e2(0x1cd,0x20e,0x248,0x162)](_0x21100f(-0xc8,-0xe7,-0x62,-0x17d))){_0x39a34f[_0x21100f(-0x242,-0x261,-0x279,-0x2a8)](bananaGenerate,_0x465386);return;}function _0x5363e2(_0x4d694f,_0x2089a5,_0x109a66,_0x5c1276){return _0xf8e5(_0x4d694f- -0x8f,_0x109a66);}try{const {image:_0x34e58c,change:_0x534b4a}=await _0x39a34f[_0x5363e2(0xd0,0x6a,0x109,0x170)](generateSDImage,{'prompt':_0x4ef505,'width':_0x2eae43,'height':_0x341b9e,'change':_0x8c8922});if(_0x39a34f[_0x5363e2(0x17a,0x109,0x167,0x128)](extension_settings[extensionName][_0x5363e2(0x115,0x142,0x17b,0xf7)],'0')){if(_0x39a34f[_0x5363e2(0x247,0x259,0x214,0x1f4)](_0x39a34f['bPadz'],_0x39a34f[_0x5363e2(0x17d,0x231,0x1b9,0x122)])){const _0x51ada5={};_0x51ada5[_0x5363e2(0x240,0x27c,0x25e,0x29b)]=_0x534b4a,await _0x39a34f[_0x21100f(-0x135,-0x11e,-0x12f,-0x171)](setItemImg,_0x4ef505,_0x34e58c,_0x51ada5),_0x39a34f[_0x21100f(-0x242,-0x24f,-0x253,-0x22e)](addLog,'图像已存入数据库\x20f'+_0x5363e2(0xfa,0x84,0x187,0x4c)+'\x20'+_0x4ef505);}else{_0x1d6fa8(_0x5363e2(0x1a2,0x1b7,0x108,0x233)+':\x20'+_0x58309b[_0x5363e2(0xe4,0x158,0x19c,0x13d)]+(_0x5363e2(0x1dc,0x25e,0x12b,0x187)+'i是否正常启动，并检'+_0x21100f(-0x181,-0x18f,-0x1ad,-0x22c))),_0x22c2a2['completeTa'+'sk'](_0x44f9dc,![]),_0x37d176=null;throw new _0x30cbe2(_0x5363e2(0x1a2,0x13b,0x19e,0x11e)+_0x5363e2(0x1e8,0x1a6,0x237,0x203)+_0x21100f(-0x15c,-0x161,-0xf2,-0x213)+'查模型是否正确。');}}else addLog(_0x21100f(-0x21d,-0x191,-0x26f,-0x1bb)+'库');const _0x1b172f={};_0x1b172f['id']=_0x2eea95,_0x1b172f[_0x21100f(-0x13f,-0xd4,-0x10a,-0x1fc)]=!![],_0x1b172f['imageData']=_0x34e58c,_0x1b172f[_0x5363e2(0x242,0x1fc,0x238,0x1e6)]=_0x4ef505,_0x1b172f[_0x21100f(-0xd2,-0x95,-0xbc,-0xe3)]=_0x534b4a,eventSource['emit'](EventType[_0x21100f(-0x1f6,-0x1a5,-0x264,-0x196)+'MAGE_RESPO'+_0x5363e2(0x163,0x18b,0xa8,0x10c)],_0x1b172f),_0x39a34f[_0x21100f(-0x18c,-0x1ae,-0xf8,-0x1fc)](addLog,_0x21100f(-0x165,-0x13b,-0xb4,-0x1fd)+_0x5363e2(0x1f3,0x154,0x19d,0x23a)+_0x2eea95+')');}catch(_0x174159){const _0x445fba=_0x21100f(-0x111,-0x1ac,-0x61,-0x1c1)+'常\x20(ID:\x20'+_0x2eea95+_0x21100f(-0x15e,-0x166,-0x1f4,-0xda)+_0x174159['message'];_0x39a34f['Qhnfb'](addLog,'错误:\x20'+_0x445fba),console[_0x21100f(-0xfa,-0x68,-0x105,-0x51)](_0x39a34f[_0x5363e2(0x149,0x160,0x92,0x1ea)],_0x174159);const _0x35a884={};_0x35a884['id']=_0x2eea95,_0x35a884[_0x5363e2(0x1d3,0x23d,0x25d,0x1c3)]=![],_0x35a884[_0x21100f(-0xfa,-0x66,-0x156,-0x17a)]=_0x174159['message'],_0x35a884[_0x5363e2(0x242,0x295,0x28e,0x295)]=_0x4ef505,eventSource[_0x5363e2(0x23d,0x1c0,0x1cb,0x2d7)](EventType[_0x5363e2(0x11c,0x7d,0x82,0x1d2)+_0x5363e2(0xe5,0xcf,0xca,0x142)+'NSE'],_0x35a884),_0x39a34f[_0x21100f(-0x10a,-0x158,-0xa0,-0x74)](addLog,_0x5363e2(0x144,0x175,0xd6,0xcb)+'\x20(ID:\x20'+_0x2eea95+')');}}function initializeSDListener(){function _0x12969e(_0x43cf50,_0x272236,_0x20844a,_0x35b6ed){return _0xf8e5(_0x43cf50- -0x170,_0x35b6ed);}const _0x59a214={'BeNXt':function(_0x32ceed,_0x33c7d){return _0x32ceed(_0x33c7d);}};function _0x590280(_0x457f8e,_0x426a19,_0x425cca,_0x5acd43){return _0xf8e5(_0x5acd43- -0x1fd,_0x426a19);}eventSource['on'](EventType[_0x12969e(0x3b,0x89,-0x6f,0xf6)+_0x590280(0x65,0x4,0xb,0x19)+'ST'],sdGenerate),_0x59a214['BeNXt'](addLog,_0x12969e(0x159,0xfc,0x1da,0x124)+_0x12969e(0x5d,0xb0,0x8,0x33));}export async function replaceWithSd(){function _0x4630b7(_0x581624,_0x2470f9,_0x5306f0,_0xb67eff){return _0xf8e5(_0x581624- -0x2f2,_0x2470f9);}const _0x557a2c={'Bdrsl':function(_0x33beac,_0x7d38e0){return _0x33beac+_0x7d38e0;},'fhauf':function(_0x2a7ee8,_0x1fe53c){return _0x2a7ee8(_0x1fe53c);},'BpSxR':function(_0x41fd81,_0x4e9876){return _0x41fd81!==_0x4e9876;},'UVGRu':_0x4a47c4(-0xef,-0x19e,-0xe3,-0x40),'pNOKY':function(_0x182f03){return _0x182f03();},'kyTlj':function(_0x2318bc,_0xdd9e8f){return _0x2318bc(_0xdd9e8f);},'OVKrC':_0x4a47c4(-0x8f,-0xf4,-0x74,-0x17)+'已关闭。'};function _0x4a47c4(_0x293d60,_0xc6eaa8,_0x32557a,_0x53246f){return _0xf8e5(_0x32557a- -0x33d,_0x53246f);}if(extension_settings[extensionName][_0x4630b7(-0x188,-0x237,-0x1ff,-0x1c4)]=='sd'){if(_0x557a2c[_0x4630b7(-0xbe,-0xe1,-0xf2,-0xdf)](_0x557a2c['UVGRu'],_0x557a2c[_0x4a47c4(-0xb6,-0x196,-0x103,-0xc8)]))for(let _0x11d5a1=0x2*-0xb69+-0xf03+0xa7*0x3a;_0x11d5a1<=0x21c9+-0x1*-0x48e+-0x2653;_0x11d5a1++){_0x119bda[_0x4630b7(-0x12f,-0x173,-0x115,-0x8d)+_0x11d5a1+_0x4a47c4(-0xfe,-0xaa,-0xe5,-0xf9)]&&(_0x35f178=_0x557a2c['Bdrsl'](_0x557a2c[_0x4a47c4(-0x9d,-0x189,-0x12d,-0x114)](_0x1ab044,',\x20'),_0x557a2c['fhauf'](_0xd01324,_0x6c06f[_0x4a47c4(-0x172,-0x161,-0x17a,-0x21b)+_0x11d5a1+_0x4a47c4(-0x80,-0xbf,-0xe5,-0x28)])));}else!window['initialize'+_0x4a47c4(-0xff,-0x6e,-0xea,-0x169)]&&(window[_0x4a47c4(-0xc5,-0x79,-0x7e,-0x8c)+_0x4630b7(-0x9f,-0x151,-0x109,-0x145)]=!![],initializeSDListener()),_0x557a2c[_0x4a47c4(-0x164,-0xfc,-0x13b,-0x148)](initializeImageProcessing);}else window[_0x4a47c4(-0x43,0x27,-0x7e,-0x46)+_0x4a47c4(-0x11c,-0x106,-0xea,-0x15c)]&&(eventSource[_0x4630b7(-0x94,-0xe,-0xfd,-0x41)+_0x4630b7(-0x114,-0x74,-0x14b,-0x1b4)](EventType['GENERATE_I'+_0x4a47c4(-0x105,-0x19b,-0x127,-0x98)+'ST'],sdGenerate),window[_0x4a47c4(-0xcd,-0x10f,-0x7e,0x3b)+_0x4630b7(-0x9f,-0x3,-0x119,-0x40)]=![],_0x557a2c[_0x4630b7(-0x53,-0x14,-0xc7,-0x34)](addLog,_0x557a2c['OVKrC']));}