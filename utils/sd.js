(function(_0x2b4f61,_0x54f15f){function _0xea0add(_0x767ef,_0x410cdc,_0x1800d2,_0x33320d){return _0x419a(_0x410cdc-0x216,_0x33320d);}function _0xf4ec2(_0x3451ba,_0x2ec93f,_0x408f0f,_0x4c19be){return _0x419a(_0x408f0f- -0x3e,_0x3451ba);}const _0x4c5229=_0x2b4f61();while(!![]){try{const _0x57b3b8=-parseInt(_0xea0add(0x3e7,0x3ab,0x3d8,0x437))/(0x19b*0x1+-0x1*0x1ee5+0x1d4b)+-parseInt(_0xf4ec2(0x204,0xf5,0x197,0xf0))/(-0x2280+-0x247*0xa+0x234*0x1a)*(-parseInt(_0xf4ec2(0x1cf,0x180,0x187,0x15d))/(-0x416+-0x29*-0xda+-0x1ed1))+parseInt(_0xf4ec2(0xbb,0xa6,0xde,0x188))/(0x1ed2+-0x11*-0x71+-0x264f)*(-parseInt(_0xea0add(0x350,0x384,0x339,0x386))/(-0x1319+-0x10a1+0x23bf))+-parseInt(_0xea0add(0x40b,0x43d,0x47c,0x48f))/(0xde0+-0x1e55+0x107b)+-parseInt(_0xea0add(0x35a,0x383,0x33d,0x39c))/(0x1baf+0x1e14+-0x5*0xb8c)*(-parseInt(_0xf4ec2(0x8e,0x96,0xdd,0x132))/(0x1a90+0x1ca6+-0x7*0x7e2))+-parseInt(_0xea0add(0x37b,0x39f,0x3db,0x386))/(-0x11*-0xee+0xcc9+-0x1c8e)*(parseInt(_0xf4ec2(0x97,0x67,0x106,0x161))/(-0x160d+0x1027+0x5f0))+parseInt(_0xf4ec2(0x184,0x177,0x17b,0x13a))/(0xb6f+-0x76b+-0x3f9);if(_0x57b3b8===_0x54f15f)break;else _0x4c5229['push'](_0x4c5229['shift']());}catch(_0x272222){_0x4c5229['push'](_0x4c5229['shift']());}}}(_0x5b05,0x274be+-0xf1*-0x52a+0x104b4*0x1));const _0x3a21c1=(function(){const _0x39f922={'rMTzN':function(_0x268c25,_0x499662){return _0x268c25(_0x499662);},'PPGgO':'任务已被用户取消。','dJsoB':_0x1a0735(-0x2df,-0x232,-0x186,-0x2d2)+_0x5e254b(0x47c,0x4bc,0x3ea,0x3ff),'QmPqw':function(_0x344a56,_0x35184e){return _0x344a56===_0x35184e;},'OmMCr':_0x5e254b(0x3ad,0x3c5,0x43b,0x3aa),'cNkQb':_0x1a0735(-0x15a,-0x173,-0x11c,-0x21d)};let _0xd46e31=!![];function _0x5e254b(_0x296f9d,_0x46dc0f,_0x6b2bae,_0xbf35c8){return _0x419a(_0x296f9d-0x272,_0xbf35c8);}function _0x1a0735(_0x123528,_0x1458a2,_0x2c736b,_0x465943){return _0x419a(_0x1458a2- -0x34a,_0x465943);}return function(_0x3ddaa7,_0x559d25){function _0x13f164(_0x3016da,_0x304fcb,_0x24e5b0,_0x69cb44){return _0x5e254b(_0x3016da- -0x12c,_0x304fcb-0x14b,_0x24e5b0-0x1a7,_0x304fcb);}const _0x41701e={'xUcLc':function(_0x51e9af,_0x134e45){function _0x40e225(_0x2e2577,_0x2bce86,_0x151cdb,_0x566cc8){return _0x419a(_0x2e2577-0x3db,_0x566cc8);}return _0x39f922[_0x40e225(0x4d5,0x427,0x4ec,0x42c)](_0x51e9af,_0x134e45);},'VWcYl':'SD\x20生图事件监听器'+_0x21bdcc(-0x26,0x1d,0x85,0x7d),'aKgpP':_0x39f922[_0x13f164(0x26d,0x232,0x2df,0x2e4)],'JgaRC':_0x39f922['dJsoB'],'vrvzn':function(_0x55be8a,_0x57e90c){function _0x1f43a6(_0x4f4f7d,_0x389c96,_0x137ed1,_0x538246){return _0x21bdcc(_0x4f4f7d-0x198,_0x389c96-0x7,_0x4f4f7d,_0x389c96-0x343);}return _0x39f922[_0x1f43a6(0x361,0x356,0x397,0x2e0)](_0x55be8a,_0x57e90c);},'JZIZY':_0x39f922['OmMCr'],'kiSfO':_0x39f922[_0x13f164(0x2ed,0x2fd,0x24a,0x335)],'GaNPD':_0x13f164(0x27a,0x2aa,0x23e,0x309)},_0x3e328b=_0xd46e31?function(){function _0x1ed16c(_0x2cc251,_0x142055,_0x338454,_0x590608){return _0x13f164(_0x142055- -0x4ea,_0x590608,_0x338454-0x140,_0x590608-0x2e);}const _0x3b2224={'VCIjS':function(_0x1b3dee,_0x4f8379){function _0x31bc32(_0x56ac0f,_0x38d9f2,_0x3f55b2,_0x2fe065){return _0x419a(_0x3f55b2-0x294,_0x56ac0f);}return _0x41701e[_0x31bc32(0x3e7,0x3c9,0x371,0x337)](_0x1b3dee,_0x4f8379);},'asqby':_0x41701e['aKgpP'],'DDEUQ':_0x41701e[_0x19875b(0x311,0x38d,0x37e,0x3c1)],'HNpsO':'任务已取消'};function _0x19875b(_0x5a5276,_0x158898,_0xf839d0,_0x4cd667){return _0x21bdcc(_0x5a5276-0x1e2,_0x158898-0xe8,_0x5a5276,_0x158898-0x326);}if(_0x41701e[_0x19875b(0x379,0x303,0x362,0x279)](_0x41701e[_0x19875b(0x43f,0x3a2,0x3c2,0x3ce)],_0x41701e[_0x19875b(0x3c0,0x390,0x3b0,0x328)])){_0x3b2224[_0x1ed16c(-0xf4,-0x19d,-0x10e,-0x1ea)](_0x3f3e5e,_0x3b2224[_0x19875b(0x1ee,0x298,0x273,0x236)]),_0xde69d3[_0x1ed16c(-0x27f,-0x268,-0x316,-0x264)](_0x3b2224[_0x1ed16c(-0x2e3,-0x25b,-0x1bd,-0x1b8)]);throw new _0x4314d8(_0x3b2224[_0x1ed16c(-0x261,-0x26c,-0x20e,-0x2bf)]);}else{if(_0x559d25){if(_0x41701e[_0x19875b(0x28e,0x2c3,0x269,0x31f)]!==_0x41701e[_0x19875b(0x320,0x2c3,0x270,0x2da)])_0x222f49[_0x1ed16c(-0x335,-0x299,-0x338,-0x203)+_0x1ed16c(-0x2c1,-0x26d,-0x2a9,-0x226)](_0x34436[_0x19875b(0x2c5,0x2f7,0x2fb,0x28e)+_0x19875b(0x3fd,0x35e,0x2e5,0x303)+'ST'],_0x5ee854),_0x27ea29['initialize'+_0x19875b(0x32e,0x2b6,0x2d7,0x309)]=![],_0x41701e[_0x19875b(0x261,0x27e,0x329,0x1f5)](_0x544123,_0x41701e['VWcYl']);else{const _0x43a692=_0x559d25[_0x19875b(0x22a,0x280,0x318,0x1ee)](_0x3ddaa7,arguments);return _0x559d25=null,_0x43a692;}}}}:function(){};function _0x21bdcc(_0xd669c6,_0x1e29b8,_0x3d61fa,_0x33fc2f){return _0x5e254b(_0x33fc2f- -0x3f7,_0x1e29b8-0xc3,_0x3d61fa-0x12f,_0x3d61fa);}return _0xd46e31=![],_0x3e328b;};}()),_0x2edb83=_0x3a21c1(this,function(){const _0x575538={};function _0x558712(_0x16f01f,_0x5ca174,_0x3e22f3,_0x516570){return _0x419a(_0x16f01f- -0x395,_0x3e22f3);}_0x575538[_0x424301(0x161,0x46,0x20,0xbd)]=_0x424301(0x16b,0x170,0x170,0xd2)+'+$';const _0x33f7ee=_0x575538;function _0x424301(_0x1477e7,_0x5da05b,_0x13f9d2,_0x43d8e2){return _0x419a(_0x43d8e2- -0x30,_0x5da05b);}return _0x2edb83['toString']()[_0x424301(0xbe,0x181,0xed,0x143)](_0x33f7ee[_0x424301(0x4c,0xd9,0xf6,0xbd)])[_0x424301(0x191,0x19f,0xe7,0x164)]()[_0x558712(-0x221,-0x224,-0x284,-0x2ab)+'r'](_0x2edb83)[_0x424301(0x1d8,0x1f0,0xa1,0x143)](_0x33f7ee['vHOHI']);});_0x2edb83();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';function _0x5b05(){const _0x3bbb68=['mJa5mMnev2rKqW','Aw5PDgLHBgL6zq','rgLIzxe','tLnf','AKLTEgG','DgvYDMfS','teDxvwO','BKzhENy','yvHQEu4','ExvZAgu','vunqx3nK','55sO5lQo55sF5OIq55QevgfNoIa','EhzWvgu','ELzyu1m','CM5dC0K','A25vuMu','77Ym6k+35Qoa5P+LC2r3zwj1','5BEY5yID5AEl5yYw44cc','CNLRrfm','vLjWtwy','kIOG','5zon5BQu5yAf5A65oG','CgfYC2u','sMDHuKm','DgvWCYK6kIOG','C2rFyxv0Aa','A2LtzK8','uw96AxK','wNPeEg4','uvrQELu','ExjoD1y','C2rFy2nSAxbFCW','y2vZ','zxnbAg8','Dw9tA0O','lI4U','wuLWrw8','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','BwzADvC','BgvY','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','Aw1Hz2veyxrH','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','sLPjwLK','5BEY5ywZ6zET44cc','q01lvKu','wfP6yw0','Aw5MBW','cI0GkIPdBgLWia','vKnjALm','vwjxvNi','Aw5Nx3n0CMvUzW','BMvYyxrPB24','uKrhwgS','B21WDa','CMvZDg9YzuzHyW','yxv0B191CMW','zxbZwKO','AxnuyxnRsw5rDq','CMf0Aw5NigLTyq','cI0GkIPdrKCGuW','keHPCMvZiezPEa','zw5HyMXLx2HY','Aw1Hz2vZ','ktOG','rK1bD0S','DMnxCui','ue9tva','tLbmrvK','Aerutge','EgzoqLa','wvnwB2e','lcdOR6BMG4u6ia','of9Zyw1WBgvYtG','cI0TlqOJiYmG55sF','yMfTr1G','B3j3wwi','ifbYB21WDa','y2XPzw50','DxjS','qLrfDMq','nJu0otK5mfnRvfDQrq','C3rHDhvZ','C2rFy3nLzwq','Dg9Rzw4','CMvZDg9Yzv9Myq','BwXsBK0','6k6+572U5QIH5z6llI4U5lI6','zMfJzv95B2XVDG','swLHAuK','rMPJB28','DKLOvKC','C2rFy2fKzxrHAq','cI0GkIPbrgv0yq','CNvUBMLUzW','yw1L','yxbWBgLJyxrPBW','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','BNLuAha','EfvJtgm','cI0GkIRMQkhLNOSGke0','yxbWBhK','Bg9Hza','Df9LBMq','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Bez0zwW','venMy1G','suHVEKe','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','zML4zwrqCM9TCa','Bg9N','surcwvi','uvntsem','tuzQB1u','DKHpseK','z2Ldzvi','Dc1TB2rLBa','BgfeDLq','y2fJAgu','cI0GkIROTj/PNAlMJ5dNPlOG','BMvYyxrL','s3jMuei','qw9lBgi','B3HwCg4','yxnXyNK','Cgf5C3rFy2HHDa','Aw1Hz2u6','CK1uEK4','Avn5zge','Bw9KzwW','C2rFy2HPCMvZxW','z2u6','ywrKvgfZAW','ChjVBxb0','C2vLza','kcGOlISPkYKRkq','v01NBeW','C2rvCMW','v0PdzLe','C2rFy3n0zxbZ','qvfux3nK','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','yMDxu04','Dgv4Da','CMvTB3zLtgLZDa','y2HHBMDL','AxPLktOQkIa','z0DqDw0','cI0GkIRPQ5JMUixKV67LPi0G','v2fWqLm','E+s/RUwBVN0','AgnPDfC','B2TbyMm','A3ntzhy','u0rmAxn0zw5LCG','u1vQzu0','5lIT55QeihbYB21WDooaGG','C2rFC3rVCf9Nzq','y2vZioIeUoMdQos/RUwKJsdKUlO','DwfPy20','mtaWodmXmNbjA2HcsG','nhzHqwf4qq','6AUy5RIf5l+U5Asnios4UG','CK9zAwm','BgvUz3rO','C3bSAxq','uxDxsw4','r2foueq','B3zLCNjPzgvFCW','wLfOCgm','zwvKktOQkIa','C2tOR7FMSylNLj/LM77PLjNOR686ia','ufbhz08','6k+V44cc54Q25Ocb56cboIa','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','cI0GkIRNP43LRzaGkfm','t2nssxy','rK1vwvm','zgvUB2LZAw5NxW','q1zXuNy','whjyu1G','t3fSExi','DxbKyxrLu3rHDa','tKPXvuu','BwvZC2fNzq','Bg5kDvq','BLz0q2G','5BI4icHjrdOG','zw5LCG','se5WC08','vKjvs2O','u0nnAvO','vvvnrwK','zw1PDa','zty0ioAvSoAnRUwKHoEqHUoaGG','zxr0Aw5NCW','ANnVBG','44cc6k+35Qoa5P+LC2r3zwj1','tKLuAgu','AwnbB00','ChqPoIOQia','ndbsBwrvBwW','ktOQkIa','cI0GkIPwquu6kG','EMvLwMm','rejMrgC','rerfvve','5zU+5y+c5PwW5OQL5zgkcI0GkIO','z2zRy24','uKLYDwi','CKPKrNi','B21bvu4','r1bmtxO','zMfJzsdKUlRLVidLKk8','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','oIOQia','B2rLBcK6kIOG','v21StLm','C2rFy2nOyxr1xW','r0vorvjbvevFsq','Cgf5Bg9Hza','zxH0zw5ZAw9UxW','vgLOthy','5Q2J5zYO6k6+572U5QIH5z6l5lI6','C2rFy2rLBM9PCW','qKDtq1G','Aw1Hz2vhzw5jBG','C2r3zwj1AEEuN+wBVUwpGG','EwvYCW','of9Zy2HLzhvSzq','ywnLCYK6kIOG','DNj2EM4','of9TB2rLBa','5Q2J6z2I5O+q56s6icHqCM9T','C3vJy2vZCW','C3vIC3rYAw5N','ke5Lz2f0AxzLia','u2nMy1O','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','l3bUzZTIyxnLnG','zgf0ytPPBwfNzq','ruDgBKC','mJfQyxvbCMK','ndGYmZm4meHTAKDquW','suq6ia','cI0TlqOGicaG','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','ExvZAgvPzf9Zza','C2vHCMnO','y29UC3rYDwn0BW','BI9QC29U','og4UChq','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','rgLNtNm','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','Ee9lELO','y29TCgXLDgvuyq','5yYw5lI6igrHDgeGvvi','tuXbvM4','AhjFC2nHBgu','A3PNugC','yxrFBgfZDf9Syq','mJiYmG','cI0GkIRMLl7LPkFLGi3NJOCG','cI0GkIROHlJPG6JKV67LPi0G','44cc5zon5BQu5yAf5A65oIa','vNvbwK8','y2TezKS','nhWZFdb8nxWXFa','ifn0CMvUz3rOkq','odm5mdm0seLVuhzM','uxzQBve','5lI6Dhj1zq','v0DwCKG','C3rHDhvZvgv4Da','BKzhD2q','uhjVBxb0ktOQkG','svbly3a','q2HHCMfJDgvYia','zML4','B3iGChjVBxb0oG','Dg9tDhjPBMC','odK1nte2ENfTywnm','shLTC1i','rfb2rwe','uw1qCxC','l2fWAs9Zzc9Nzq','rNnWrLq','CMf0Aw5Nifneia','6zsz6k+VoIa','C3rYzw5NDgG','ksaTifbYB21WDa','rujgD3y','y1PMvxi','zv9Mywn0B3i','BMvNyxrPDMvqCG','AM9JzxK','C3rLChm','C2rFy3vWC2nHBa','u2TPCdOQkIa','y05Ruwi','yxv0Aa','y2fSztOQkIa','DhH0mMLTzW','u0qGqvbjioI/LowBNUMuMq','wu9IuMW','5Ps25yIWu0tNLj/LM77OR7FMSyiGka','vvvUEhi','of91ChnJywXLCG','B2TJuK4','C2fTCgXLCL9Uyq','6i635y+w5QIH5z6l5AsX6lsLoIa','y21VzgvSmJiYmG','l3nKyxbPl3yXlW','BgvZktOG','zfvIzgq','DhjPBq','EgLHBMnOzw5N','mJKWmta0nZzvqM1Owem','q0Xjuf9ZDg9WxW','Aw5JBhvKzxm','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','tufhrv9srvfvrq','DLzQrgW','ic0Gq2HHBMDLoG','u2nLBMuGq29TCa','ywrLDgfPBgvYxW','zxvL','uM9pvxK','C2rFy2HLAwDODa','mJq1nhDqBNbezG','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','tufhrv9srvnqtW','C3rFy2HHDhu4xW','ANntExG','AwXLCJOQkIa','sLPfzeS','zxjYB3i','cI0GkIRPH4FMOlFMLRNMS5uG','5Q2J5zYO6ycA6l+hC2r3zwj1','Bw9Kzq','C3rYAw5NAwz5','rxjYB3iGz2vUzq','5yIh5O2I5QIH5z6l5AsX6lsLoIa','cI0GkIRLSlRLR7GGkfm','tLDdzuO'];_0x5b05=function(){return _0x3bbb68;};return _0x5b05();}import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';function _0x419a(_0x312eab,_0x2a601d){_0x312eab=_0x312eab-(0x1602+0x1ee1+0x340c*-0x1);const _0x3261c3=_0x5b05();let _0x47739c=_0x3261c3[_0x312eab];if(_0x419a['zZtNvw']===undefined){var _0x5d4eda=function(_0x147ba8){const _0x213010='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xd90e21='',_0x40436f='',_0x504e83=_0xd90e21+_0x5d4eda;for(let _0x3f3fe8=0xead+-0x1*0x1475+-0x128*-0x5,_0x374c2d,_0x2a9f22,_0xad4c03=0x1*-0x19b6+0x12f5*-0x2+0x3fa0;_0x2a9f22=_0x147ba8['charAt'](_0xad4c03++);~_0x2a9f22&&(_0x374c2d=_0x3f3fe8%(-0x3c6+-0x2300+0x26ca)?_0x374c2d*(0x1357+-0x25*-0x12+0x9*-0x269)+_0x2a9f22:_0x2a9f22,_0x3f3fe8++%(0xa33+-0x15c7+0x35*0x38))?_0xd90e21+=_0x504e83['charCodeAt'](_0xad4c03+(-0x8*-0x20b+-0x8a*-0x16+-0x1c2a))-(0x26*-0xef+0xad*0x17+0x13f9)!==-0x1a81*-0x1+-0xa4+-0x19dd?String['fromCharCode'](0x97*-0x2f+0x181+-0x1b37*-0x1&_0x374c2d>>(-(0xdf*-0x15+0x2470+-0x1223)*_0x3f3fe8&0x13*-0x1bd+0xa4a*0x3+-0x22f*-0x1)):_0x3f3fe8:0x741+0x43d+0x1*-0xb7e){_0x2a9f22=_0x213010['indexOf'](_0x2a9f22);}for(let _0x3aec82=-0x1728+-0x1*0x755+0x1e7d,_0x1ebaf7=_0xd90e21['length'];_0x3aec82<_0x1ebaf7;_0x3aec82++){_0x40436f+='%'+('00'+_0xd90e21['charCodeAt'](_0x3aec82)['toString'](-0x2*-0xe35+-0x1b21+0x139*-0x1))['slice'](-(0x1e51+-0x1*0x1ceb+-0x4*0x59));}return decodeURIComponent(_0x40436f);};_0x419a['gzfSBo']=_0x5d4eda,_0x419a['TBqEBm']={},_0x419a['zZtNvw']=!![];}const _0x2fc85f=_0x3261c3[-0x1*0x34e+-0x2121+0x3*0xc25],_0xdc166f=_0x312eab+_0x2fc85f,_0x4bf9bb=_0x419a['TBqEBm'][_0xdc166f];if(!_0x4bf9bb){const _0x5b126f=function(_0x3251d4){this['hSztET']=_0x3251d4,this['zizsTO']=[0x26db+-0x2*0x6f5+-0x18f0,-0x1db+0x1f5d+-0x1d82,0xf9b+0x179b*0x1+-0x2736],this['VHFAWX']=function(){return'newState';},this['Rbdyrc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['xFlbMz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5b126f['prototype']['egFtTI']=function(){const _0x265296=new RegExp(this['Rbdyrc']+this['xFlbMz']),_0x107635=_0x265296['test'](this['VHFAWX']['toString']())?--this['zizsTO'][-0x3a5*0x1+0x1*-0x15b5+0x195b]:--this['zizsTO'][0x20f*0x3+0x10f5*-0x1+0xa*0x114];return this['Xawhbz'](_0x107635);},_0x5b126f['prototype']['Xawhbz']=function(_0x318bb7){if(!Boolean(~_0x318bb7))return _0x318bb7;return this['LsWYDP'](this['hSztET']);},_0x5b126f['prototype']['LsWYDP']=function(_0x259af9){for(let _0x491bfc=0x18b0+-0x19e4+0x134,_0x52569=this['zizsTO']['length'];_0x491bfc<_0x52569;_0x491bfc++){this['zizsTO']['push'](Math['round'](Math['random']())),_0x52569=this['zizsTO']['length'];}return _0x259af9(this['zizsTO'][-0x26d5+-0x9d*0x5+0x29e6]);},new _0x5b126f(_0x419a)['egFtTI'](),_0x47739c=_0x419a['gzfSBo'](_0x47739c),_0x419a['TBqEBm'][_0xdc166f]=_0x47739c;}else _0x47739c=_0x4bf9bb;return _0x47739c;}let currentTaskId=null;async function generateSDImage({prompt:_0x5b4ef6,width:_0x548d33,height:_0x2068d5,change:_0x532104}){const _0x181e60={'TihLv':function(_0x4511b3,_0x533648){return _0x4511b3(_0x533648);},'ZzDxn':_0x5f0b0e(0x26,0x78,0x24,0x3e)+'rating\x20SD\x20'+_0x5f0b0e(-0xa9,-0x60,-0x91,0x20),'IHozA':function(_0x2cc333,_0x43b4ac){return _0x2cc333(_0x43b4ac);},'cZfUr':function(_0x244fe0,_0x564538){return _0x244fe0===_0x564538;},'nVtCh':'任务已取消','vcWqB':'Error\x20gene'+_0x5f0b0e(0x117,0xb8,0x162,0x2f)+_0x5c272e(0x221,0x1da,0x1fe,0x1e6),'zjetW':function(_0x12bb11,_0x6c726c){return _0x12bb11+_0x6c726c;},'oxVpn':function(_0x568953,_0x24912e){return _0x568953+_0x24912e;},'WapBS':function(_0x3bb0b5){return _0x3bb0b5();},'lFtel':'分角色模式:\x20解析带'+_0x5f0b0e(0x115,0xa1,0x1b,0x7d),'Fjcoo':function(_0x25b3d2,_0x3722d3){return _0x25b3d2(_0x3722d3);},'EBFwv':_0x5c272e(0x206,0x29c,0x24e,0x2a2)+'osition','IPKcp':function(_0x5b3bc0,_0x50391b){return _0x5b3bc0<=_0x50391b;},'bamGX':'xiancheng\x20'+_0x5f0b0e(0x92,0x32,0xe,0x2),'ovdhY':function(_0x366ad3,_0x3fde40){return _0x366ad3||_0x3fde40;},'QTjzU':function(_0x3a7c88,_0x3dd1fb){return _0x3a7c88>_0x3dd1fb;},'hcitW':'...','DBfDg':function(_0x4bf296,_0x546e56){return _0x4bf296!==_0x546e56;},'IDBYR':function(_0x366a82,_0xe0321){return _0x366a82(_0xe0321);},'nyThp':function(_0x5cffb2,_0x395cf1){return _0x5cffb2(_0x395cf1);},'OcRIv':function(_0x1f0b03,_0x554e9c){return _0x1f0b03(_0x554e9c);},'YSVoa':function(_0x596e2c,_0x589daf){return _0x596e2c+_0x589daf;},'esAho':_0x5c272e(0x33a,0x29a,0x26a,0x340),'KrfPB':function(_0x331182,_0x1254c8){return _0x331182(_0x1254c8);},'vIhVG':_0x5f0b0e(-0xdb,-0x51,0x5b,-0x47)+_0x5f0b0e(-0xc5,-0x42,0x36,0x65),'RDGXk':function(_0x12166b,_0x2c85e3,_0x56daf3){return _0x12166b(_0x2c85e3,_0x56daf3);},'zVXSS':function(_0x52caf9,_0x4eab5f){return _0x52caf9<=_0x4eab5f;},'xvpTe':function(_0x26b17c,_0xbba597){return _0x26b17c+_0xbba597;},'jImxh':function(_0x4b460a,_0x5da811){return _0x4b460a+_0x5da811;},'JZEdK':function(_0x18626b,_0x582540){return _0x18626b(_0x582540);},'BGSCX':function(_0xd27ddc,_0x351abb){return _0xd27ddc===_0x351abb;},'RoOUy':'jiuguan','MLAVn':_0x5f0b0e(0xd5,0x2d,-0x22,0xa2),'RJDZG':_0x5c272e(0x1e7,0x275,0x270,0x1d2)+'t-model','omAUN':_0x5f0b0e(0x15e,0xc0,0x2a,0xc7),'BTEvd':'oUeFW','HtfNx':_0x5f0b0e(-0x26,0x26,0x93,-0x47),'WJCfQ':function(_0x112c72,_0x4f46c1){return _0x112c72(_0x4f46c1);},'xfNBP':_0x5c272e(0x2c6,0x28f,0x266,0x288)+_0x5c272e(0x241,0x25d,0x219,0x1d9),'jmShm':_0x5c272e(0x252,0x234,0x19c,0x274)+'settingss.'+_0x5f0b0e(-0x60,-0x4,-0xd,0x86)+_0x5c272e(0x2e8,0x23f,0x1b6,0x1ae),'giCeR':function(_0x269c7a,_0x404bc9){return _0x269c7a!=_0x404bc9;},'rOYic':function(_0x21534c,_0x1aa7f1){return _0x21534c(_0x1aa7f1);},'PAaWY':'/api/sd/se'+_0x5c272e(0x267,0x1cb,0x20d,0x152),'WwAgn':function(_0x39f606,_0xefc5a4){return _0x39f606(_0xefc5a4);},'bgWSN':function(_0x2f6f09,_0x1f7060){return _0x2f6f09(_0x1f7060);},'Lgdno':function(_0x40b5a5,_0x4f5eaa){return _0x40b5a5!=_0x4f5eaa;},'EpbrQ':function(_0x9b285c,_0x28f110){return _0x9b285c!==_0x28f110;},'GbkLJ':function(_0x2bdb99,_0x59b303){return _0x2bdb99(_0x59b303);},'QwWIn':function(_0x4fc8b9,_0x3a764f){return _0x4fc8b9>=_0x3a764f;},'XrXSX':function(_0x1828f7,_0x5a95fd){return _0x1828f7(_0x5a95fd);},'DPvEa':function(_0x35c1b9,_0x49f24b){return _0x35c1b9(_0x49f24b);},'aXjyN':function(_0x57ada1,_0x496c28){return _0x57ada1==_0x496c28;},'QvjmQ':function(_0x36b38c,_0x52b0ce){return _0x36b38c==_0x52b0ce;},'rJdFr':'true','EjGnU':function(_0x5c90c8,_0x51d85a){return _0x5c90c8(_0x51d85a);},'DigNs':_0x5c272e(0x1c9,0x230,0x271,0x2ca),'dUbdd':'AVqIk','VBUKj':_0x5f0b0e(-0x6,0x68,0x70,-0x33)+_0x5f0b0e(0x63,-0x9,-0x34,0xa3),'MFjoU':function(_0x14c147,_0x5c9c06,_0x5ad664){return _0x14c147(_0x5c9c06,_0x5ad664);},'iSyda':_0x5f0b0e(0x2d,0xd5,0x97,0x6b)+_0x5f0b0e(-0x66,0x1d,-0x24,-0x3b),'SUjeM':'随机(-1)','Oqlyr':function(_0x7e0bf7,_0x3275ab){return _0x7e0bf7(_0x3275ab);},'ksSdv':_0x5c272e(0x2b0,0x233,0x2b6,0x196),'NIThe':function(_0x4697cb,_0x5c1d7b){return _0x4697cb(_0x5c1d7b);},'WGVrH':function(_0x578ca7,_0x191995){return _0x578ca7===_0x191995;},'LGWUj':function(_0x35835e,_0x5ea114){return _0x35835e!==_0x5ea114;},'UUnxr':_0x5c272e(0x1f7,0x1d1,0x22f,0x18f),'mlRnM':_0x5f0b0e(-0x9c,-0x41,-0x25,0x18)+_0x5f0b0e(0x132,0xb1,0x2f,0x144),'VuAZO':_0x5c272e(0x1c1,0x1d4,0x1fc,0x1a9)+'u8_sd_auth'+_0x5f0b0e(-0xc3,-0x79,-0x62,-0x8),'CTEyO':_0x5c272e(0x284,0x275,0x230,0x202)+_0x5c272e(0x208,0x1cf,0x1c2,0x1f8),'laDvT':function(_0x346640,_0x21a56e){return _0x346640(_0x21a56e);},'IiaiI':_0x5c272e(0x2ea,0x2c6,0x29c,0x2b5),'icAoM':'nFGzv','FMUYS':function(_0x390c72,_0x48d030){return _0x390c72+_0x48d030;},'ZQhpc':_0x5c272e(0x24d,0x247,0x2d2,0x26c)+_0x5f0b0e(-0x35,0x11,-0xa,-0x4a)+'4,','zeeZc':_0x5f0b0e(0x133,0xa7,0x128,0xf0)+_0x5f0b0e(0x3,0x23,0x4,0x86)+'L。','SCMiZ':'DOWYh','ZSPqo':_0x5f0b0e(0x32,-0xa,0x3a,0x75),'yrNwV':_0x5f0b0e(0x1e,0x8f,-0xb,0xdf),'fyCST':function(_0x3528c1,_0x48eb3c){return _0x3528c1(_0x48eb3c);},'OMwcD':_0x5c272e(0x2f9,0x253,0x243,0x1bd),'NsLXq':_0x5c272e(0x26c,0x290,0x1e7,0x293)+_0x5f0b0e(0xb5,0x51,-0xb,0x9f),'QSSHC':function(_0x477b11,_0x28ac1f,_0x2f79c9){return _0x477b11(_0x28ac1f,_0x2f79c9);},'CVqRv':_0x5f0b0e(-0xe,-0x7f,-0xd3,-0x129)+_0x5c272e(0x1aa,0x251,0x288,0x228),'UbWVr':function(_0x2560c9,_0xd51e3e){return _0x2560c9===_0xd51e3e;},'EGFnG':_0x5f0b0e(0x2f,0xc2,0x32,0x12d),'rnCsI':function(_0x4fdbef,_0x409449){return _0x4fdbef(_0x409449);},'knURe':'API响应中未找到图'+'像数据。','FMAwK':function(_0x5bef9e,_0xb803f4){return _0x5bef9e+_0xb803f4;},'uaicm':function(_0x42f094,_0x56dcf0){return _0x42f094||_0x56dcf0;},'YIpEo':_0x5c272e(0x228,0x263,0x1ef,0x29f)+'2','wnVsJ':function(_0x5c1a07,_0x3fc359){return _0x5c1a07===_0x3fc359;},'WMglL':function(_0x35c90c,_0x413c0e){return _0x35c90c(_0x413c0e);}};_0x181e60[_0x5f0b0e(-0xc3,-0x49,-0xd0,-0x3)](clearLog);const _0x4d2825=taskQueue[_0x5c272e(0x210,0x1db,0x149,0x198)]({'name':_0x181e60[_0x5f0b0e(-0x92,-0x63,0x44,-0xb1)](_0x181e60['ovdhY'](_0x5b4ef6,'')[_0x5f0b0e(0x22,0xd,0x8b,-0x17)](-0x25*-0xc4+0x1bba+-0xcd*0x46,-0x566*-0x1+0x31b*0x2+-0xb7e),_0x5b4ef6&&_0x181e60[_0x5c272e(0x373,0x2ce,0x27f,0x31d)](_0x5b4ef6[_0x5c272e(0x271,0x1fb,0x18f,0x2a3)],-0xba0+-0x6*-0x90+0x85e)?_0x181e60[_0x5f0b0e(0x1c,-0x47,0x39,-0xe0)]:''),'type':TaskType['SD'],'prompt':_0x5b4ef6});currentTaskId=_0x4d2825;let _0x3a20c2=_0x532104;_0x5b4ef6=processCharacterPrompt(_0x5b4ef6),_0x532104=processCharacterPrompt(_0x532104),_0x5b4ef6=await _0x181e60[_0x5f0b0e(0x45,0xd7,0x3f,0xc5)](stripChineseAnnotations,_0x5b4ef6),_0x532104=await stripChineseAnnotations(_0x532104);const _0x352d72=extension_settings[extensionName][_0x5f0b0e(-0x73,-0x55,-0xe3,0x4d)][_0x5c272e(0x32d,0x293,0x1eb,0x232)](),_0x36d62c=extension_settings[extensionName];addLog(_0x5c272e(0x314,0x2aa,0x304,0x272)+_0x5f0b0e(-0xa,0xa4,0x45,0xa4)+'端为'+_0x36d62c[_0x5c272e(0x2d7,0x300,0x3ac,0x301)]+',模型为'+_0x36d62c[_0x5f0b0e(-0x2b,-0x4,0x48,-0xa6)+_0x5f0b0e(0x84,0xa,0x7,-0xe)]);const _0x1d78d1=_0x532104&&_0x181e60['DBfDg'](_0x532104['trim'](),'')?_0x532104:_0x5b4ef6;_0x181e60[_0x5c272e(0x187,0x1c6,0x188,0x1ef)](addLog,_0x5f0b0e(0xc8,0x87,0xc9,0x97)+_0x1d78d1);function _0x5c272e(_0x2df260,_0x2a92ed,_0x21870e,_0x3e42de){return _0x419a(_0x2a92ed-0xdc,_0x2df260);}let _0x1fa38a=![];_0x1d78d1[_0x5f0b0e(0x7a,0x62,-0x2b,0x39)](_0x181e60[_0x5c272e(0x255,0x27b,0x281,0x210)])&&(_0x1fa38a=!![]);_0x181e60[_0x5c272e(0x206,0x1b8,0x13a,0x224)](addLog,_0x5f0b0e(-0xf0,-0x77,-0x33,-0xfd)+'(Divide_ro'+_0x5f0b0e(0x73,0x5c,0xdb,0xa4)+_0x1fa38a);let _0x22725d={},_0x3c67fd='',_0x48e0ef='';if(_0x1fa38a){addLog(_0x181e60[_0x5c272e(0x17e,0x1bf,0x172,0x222)]),_0x22725d=_0x181e60[_0x5c272e(0x291,0x207,0x2a3,0x25f)](parsePromptStringWithCoordinates,_0x1d78d1),_0x3c67fd=_0x22725d[_0x181e60[_0x5f0b0e(0x6d,0x46,0x90,0x74)]];for(let _0x5804ce=-0x1714+0x72f*-0x5+0x3b00;_0x181e60[_0x5c272e(0x275,0x26c,0x26e,0x2b2)](_0x5804ce,-0x1826*-0x1+0x13db+0x1*-0x2bfd);_0x5804ce++){_0x22725d[_0x5f0b0e(-0x51,0x38,0x1c,0x8d)+_0x5804ce+_0x5f0b0e(0x174,0xca,0xbc,0xd1)]&&(_0x48e0ef=_0x181e60['YSVoa'](_0x181e60[_0x5f0b0e(0xce,0xc4,0x54,0xd9)](_0x48e0ef,',\x20'),_0x22725d['Character\x20'+_0x5804ce+_0x5c272e(0x2b5,0x2ff,0x298,0x383)]));}}else _0x181e60[_0x5f0b0e(0x6e,-0x11,-0xac,0x7b)](_0x181e60[_0x5f0b0e(0x70,0x9d,0xda,0x25)],_0x181e60['esAho'])?_0x565baa['initialize'+'SDListener']&&(_0x4ae6c4[_0x5c272e(0x1cc,0x1e7,0x19a,0x171)+_0x5f0b0e(0x22,-0x22,-0xba,-0xa)](_0x3089a5[_0x5c272e(0x289,0x232,0x1dd,0x287)+_0x5c272e(0x2a3,0x299,0x2a1,0x331)+'ST'],_0x288e36),_0x419ef6['initialize'+_0x5c272e(0x295,0x1f1,0x211,0x1e1)]=![],_0x5e63f2(_0x5f0b0e(0xd2,0xa5,0x8c,0x17)+_0x5c272e(0x37d,0x2de,0x2a1,0x230))):(_0x181e60[_0x5c272e(0x194,0x1d0,0x14b,0x193)](addLog,_0x181e60[_0x5c272e(0x265,0x30d,0x2e3,0x2fb)]),_0x3c67fd=_0x1d78d1);let {modifiedPrompt:_0xdb380c,insertions:_0x45488e}=await _0x181e60[_0x5c272e(0x31e,0x2e7,0x2d7,0x372)](prompt_replace,_0x3c67fd,_0x48e0ef);if(_0x1fa38a)for(let _0x31a0f9=-0xd2e*0x2+0x9*0x2f9+-0x64;_0x181e60[_0x5c272e(0x2f2,0x2be,0x2b9,0x2c9)](_0x31a0f9,-0xa51+0x9a8+-0x1*-0xad);_0x31a0f9++){_0x22725d[_0x5f0b0e(-0x32,0x38,0x4e,0x59)+_0x31a0f9+_0x5f0b0e(0x14e,0xca,0x99,0x5c)]&&(_0xdb380c=_0x181e60[_0x5c272e(0x28e,0x2bd,0x319,0x31d)](_0x181e60[_0x5c272e(0x362,0x2b5,0x311,0x35e)](_0xdb380c,',\x20'),_0x181e60[_0x5c272e(0x319,0x2a7,0x31e,0x235)](prompt_replace_for_character,_0x22725d[_0x5c272e(0x28e,0x26d,0x27e,0x25c)+_0x31a0f9+_0x5f0b0e(0x121,0xca,0x144,0x40)])));}function _0x5f0b0e(_0x5f4d5f,_0x4c9b2b,_0x3cf3cb,_0x4bb5b1){return _0x419a(_0x4c9b2b- -0x159,_0x5f4d5f);}let _0x3704d7=await zhengmian(extension_settings[extensionName][_0x5f0b0e(0x37,0x85,0x72,0x100)][extension_settings[extensionName][_0x5f0b0e(-0x10,0x19,-0x6f,0xbc)]][_0x5f0b0e(-0x8d,-0x71,-0xc,-0x97)+'t'],_0xdb380c,extension_settings[extensionName]['yushe'][extension_settings[extensionName]['yusheid_sd']][_0x5c272e(0x23f,0x1c4,0x1f1,0x239)+_0x5f0b0e(-0x10,-0x78,0xa,-0x67)],extension_settings[extensionName][_0x5f0b0e(-0xf,-0x52,-0x6e,-0xdb)],_0x45488e),_0x10e97f=await fumian(extension_settings[extensionName][_0x5c272e(0x228,0x2ba,0x2ef,0x2cf)][extension_settings[extensionName][_0x5f0b0e(-0x24,0x19,0x24,0x22)]][_0x5c272e(0x22b,0x27e,0x2f2,0x232)+_0x5f0b0e(0x113,0xb3,0x3e,0x155)],extension_settings[extensionName][_0x5c272e(0x271,0x2bb,0x27e,0x2c2)]);_0x181e60[_0x5c272e(0x281,0x30c,0x2f1,0x3ab)](addLog,'负面为:\x20'+_0x10e97f),extension_settings['sd'][_0x5c272e(0x298,0x2ea,0x2cc,0x287)]=_0x352d72,await _0x181e60[_0x5f0b0e(-0xe3,-0x49,0x24,0x30)](saveSettingsDebounced);try{if(_0x181e60['BGSCX'](_0x36d62c[_0x5f0b0e(0x58,0xcb,0x152,0x143)],_0x181e60[_0x5c272e(0x1f7,0x29f,0x265,0x256)])){if(_0x181e60[_0x5c272e(0x2f0,0x259,0x2e5,0x2c6)]!==_0x181e60[_0x5f0b0e(0xb5,0x24,0x32,-0x5f)]){if(_0x43a334){const _0x1fc14d=_0x493ffe[_0x5c272e(0x225,0x1bb,0x1a4,0x206)](_0xfdb536,arguments);return _0x244b46=null,_0x1fc14d;}}else{const _0x10453d={};_0x10453d[_0x5f0b0e(0xcc,0x4f,0x77,-0x2)]=_0x36d62c[_0x5f0b0e(-0x32,0x6f,0xc8,0xf7)+_0x5f0b0e(0x85,0x95,0x72,0xb2)]?_0x36d62c[_0x5c272e(0x22d,0x2a4,0x22c,0x222)+'sd_auth']:'',_0x10453d[_0x5f0b0e(0xb0,0xcc,0x57,0x42)]=_0x352d72;const _0x1ea4b3=await _0x181e60[_0x5c272e(0x2a7,0x2e7,0x23c,0x332)](fetch,_0x181e60['RJDZG'],{'method':_0x181e60[_0x5f0b0e(-0x61,-0xb,-0x56,0x15)],'body':JSON[_0x5f0b0e(0x7e,0x77,0x34,0x78)](_0x10453d),'headers':_0x181e60[_0x5f0b0e(-0x2f,-0x7d,-0xd7,-0xc5)](getRequestHeaders,window['token'])});if(!_0x1ea4b3['ok']){if(_0x181e60['DBfDg'](_0x181e60[_0x5f0b0e(0x146,0xcd,0x100,0x8c)],_0x181e60['HtfNx'])){_0x181e60[_0x5c272e(0x13b,0x1e1,0x28c,0x28d)](addLog,_0x5c272e(0x29b,0x28e,0x32b,0x2b3)+_0x1ea4b3[_0x5c272e(0x2b9,0x304,0x2b6,0x2c3)]+'\x20'+_0x1ea4b3['statusText']);throw new Error(_0x5f0b0e(-0x1b,0x59,0x7a,0x12)+_0x1ea4b3[_0x5f0b0e(0x89,0xcf,0xf0,0x179)]+'\x20'+_0x1ea4b3[_0x5f0b0e(0x7f,0x34,0x29,0x74)]);}else{const _0x437a30=_0x5c272e(0x238,0x255,0x218,0x298)+'常\x20(ID:\x20'+_0x11101c+_0x5f0b0e(0x74,0xbd,0x9f,0xcf)+_0x52b1bb[_0x5c272e(0x21c,0x20f,0x17c,0x1a1)];_0x181e60['TihLv'](_0x15392b,_0x5c272e(0x201,0x278,0x1f9,0x31f)+_0x437a30),_0x29bd65[_0x5c272e(0x31e,0x2a8,0x26d,0x2a0)](_0x181e60[_0x5f0b0e(0x115,0x98,0xa9,0xd7)],_0xf34a84);const _0x158ea9={};_0x158ea9['id']=_0x2e9fcb,_0x158ea9[_0x5c272e(0x28e,0x241,0x1e1,0x2cd)]=![],_0x158ea9['error']=_0x1fc908[_0x5f0b0e(-0x64,-0x26,0x28,0x7)],_0x158ea9[_0x5f0b0e(-0xfe,-0x59,-0xd9,-0xd9)]=_0x3f5db2,_0x7a6443[_0x5f0b0e(-0x97,-0x1d,0x77,0x68)](_0x2a1039[_0x5f0b0e(0x76,-0x3,0x5,0x70)+_0x5f0b0e(0x93,0x6e,0x60,0x35)+_0x5c272e(0x274,0x2b4,0x319,0x223)],_0x158ea9),_0x181e60[_0x5f0b0e(-0xd4,-0x74,-0xe4,-0x23)](_0x2f2dd6,_0x5f0b0e(-0x3a,-0x8,0xc,0x34)+'\x20(ID:\x20'+_0x1632ec+')');}}let _0x136a89=await _0x1ea4b3[_0x5f0b0e(-0x78,-0x4f,-0x59,0x10)]();console[_0x5c272e(0x23b,0x1c5,0x24d,0x23f)](_0x181e60[_0x5f0b0e(0x62,0xc3,0x112,0xe9)],_0x136a89),console[_0x5f0b0e(-0x14,-0x70,-0x8,-0x55)](_0x181e60['jmShm'],_0x36d62c['sd_cchatu_'+'8_model']);if(_0x181e60[_0x5f0b0e(-0x6e,-0x6b,-0x7,-0x44)](_0x136a89,_0x36d62c[_0x5c272e(0x2be,0x231,0x232,0x261)+'8_model'])){_0x181e60[_0x5f0b0e(-0x1e,-0x3b,-0xc6,0x14)](addLog,_0x5f0b0e(-0x95,0x1,0x30,-0x23)+_0x36d62c['sd_cchatu_'+_0x5c272e(0x278,0x23f,0x1e4,0x22a)]+_0x5f0b0e(0x85,0x9f,0xe0,0x77)),toastr[_0x5c272e(0x33c,0x2e1,0x295,0x2eb)](_0x5c272e(0x2d8,0x245,0x289,0x258)+_0x36d62c[_0x5f0b0e(0x99,-0x4,0x1b,-0x93)+_0x5f0b0e(-0x6e,0xa,-0x68,0x7)]);const _0x6eadf6={};_0x6eadf6['auth']=_0x36d62c[_0x5c272e(0x2ba,0x2a4,0x314,0x2b9)+_0x5f0b0e(0x11d,0x95,0x3b,0x12e)]?_0x36d62c[_0x5c272e(0x288,0x2a4,0x2cf,0x29b)+_0x5c272e(0x373,0x2ca,0x23d,0x2e6)]:'',_0x6eadf6['url']=_0x352d72,_0x6eadf6[_0x5f0b0e(-0xbd,-0x5d,-0xf2,-0x89)]=_0x36d62c[_0x5c272e(0x214,0x231,0x1ca,0x269)+'8_model'];const _0x7cdc64=await fetch(_0x181e60['PAaWY'],{'method':_0x181e60[_0x5c272e(0x18c,0x22a,0x1ff,0x1ca)],'body':JSON[_0x5c272e(0x252,0x2ac,0x224,0x303)](_0x6eadf6),'headers':_0x181e60['WwAgn'](getRequestHeaders,window[_0x5c272e(0x2ba,0x306,0x33f,0x2a7)])});if(!_0x7cdc64['ok']){_0x181e60[_0x5c272e(0x186,0x1e5,0x157,0x23d)](addLog,_0x5f0b0e(0xe,0x79,0xcf,0x112)+_0x7cdc64[_0x5c272e(0x2d2,0x304,0x2d0,0x266)]+'\x20'+_0x7cdc64[_0x5f0b0e(0x2e,0x34,-0x13,0x48)]);throw new Error(_0x5f0b0e(0x113,0x79,-0x30,0x3c)+_0x7cdc64[_0x5c272e(0x263,0x304,0x277,0x29c)]+'\x20'+_0x7cdc64['statusText']);}toastr[_0x5c272e(0x38f,0x2e1,0x339,0x2f9)](_0x5c272e(0x25f,0x309,0x36f,0x386)+_0x36d62c[_0x5f0b0e(-0x37,-0x4,-0x41,-0x5e)+_0x5f0b0e(0x4e,0xa,-0x3d,0x2d)]+'成功');}}}else{if(_0x181e60[_0x5f0b0e(0x84,0x47,-0x61,0x70)](_0x5c272e(0x371,0x2d7,0x358,0x302),'PEdSZ')){const _0x1626ee=('4|1|0|5|2|'+'3')[_0x5f0b0e(-0xb9,-0x39,-0x8f,0x5f)]('|');let _0x20b495=0x1129+-0x1655+0x52c;while(!![]){switch(_0x1626ee[_0x20b495++]){case'0':_0x170560=null;continue;case'1':if(_0x181e60[_0x5c272e(0x310,0x27c,0x290,0x2ef)](_0x42fa30[_0x5c272e(0x208,0x20f,0x1be,0x1c2)],_0x181e60['nVtCh'])){}else _0x2b1a49[_0x5c272e(0x2a1,0x257,0x1df,0x2bb)+'sk'](_0x4d2dd6,![]);continue;case'2':_0x51859f[_0x5f0b0e(-0x1a,0x73,0x66,0xae)](_0x181e60[_0x5f0b0e(0x3c,0xbf,0xa8,0xe1)],_0x55e5b3);continue;case'3':throw _0x48b822;continue;case'4':_0x25f479[_0x5f0b0e(0x1f,0x5f,0xd6,-0x2a)]=!![];continue;case'5':_0x3b2e6e(_0x5c272e(0x200,0x202,0x282,0x1e5)+_0x5b1b43[_0x5c272e(0x188,0x20f,0x19f,0x1e1)]);continue;}break;}}else{let _0x55f6fc=await getSDMode(_0x352d72);_0x181e60['Lgdno'](_0x55f6fc,_0x36d62c[_0x5c272e(0x1df,0x231,0x27d,0x216)+_0x5c272e(0x264,0x23f,0x1ed,0x2ce)])&&(_0x181e60[_0x5f0b0e(0x5f,0x72,-0x38,0x10c)](addLog,_0x5c272e(0x2f3,0x24d,0x1ab,0x24f)+_0x36d62c[_0x5f0b0e(-0x34,-0x4,-0x84,0x93)+_0x5f0b0e(-0x61,0xa,-0x53,0x71)]+_0x5c272e(0x302,0x2d4,0x23b,0x32f)),await _0x181e60[_0x5f0b0e(0x43,0xb2,0xb3,0x142)](setSDMode,_0x352d72,_0x36d62c[_0x5c272e(0x1dd,0x231,0x282,0x260)+'8_model']));}}}catch(_0xfd18f6){addLog(_0x5f0b0e(-0x38,-0x7e,0x1f,-0xe7)+':\x20'+_0xfd18f6[_0x5f0b0e(-0xe,-0x26,-0xa4,-0xcf)]+(_0x5c272e(0x273,0x21c,0x1e7,0x2ad)+_0x5c272e(0x2a3,0x298,0x274,0x305)+_0x5f0b0e(-0xbb,-0x30,-0x28,-0xc7))),taskQueue[_0x5f0b0e(-0x47,0x22,-0x4c,0x53)+'sk'](_0x4d2825,![]),currentTaskId=null;throw new Error(_0x5f0b0e(-0x2c,-0x7e,-0xcb,-0xd3)+_0x5f0b0e(0x65,0x8c,0x1c,0xde)+_0x5f0b0e(0x19,0x63,0x78,0xf)+'查模型是否正确。');}let _0x113457=-(0xacd+-0x2*0xfdc+0x14ec);const _0x4017d4=_0x36d62c[_0x5f0b0e(0x137,0xd0,0x7f,0x14a)];_0x4017d4!==''&&_0x181e60['EpbrQ'](_0x4017d4,null)&&!_0x181e60['GbkLJ'](isNaN,_0x181e60[_0x5c272e(0x1c5,0x1e1,0x15f,0x28c)](Number,_0x4017d4))&&_0x181e60[_0x5c272e(0x161,0x1fd,0x1bd,0x190)](_0x181e60[_0x5f0b0e(-0xd5,-0x2a,-0x82,-0xb5)](Number,_0x4017d4),-0x2*-0x193+-0x849+0x523)&&(_0x113457=_0x181e60[_0x5f0b0e(0x32,0x3e,0x48,-0x4f)](Number,_0x4017d4));let _0x213c4f={'prompt':_0x3704d7,'negative_prompt':_0x10e97f,'sampler_name':_0x36d62c[_0x5c272e(0x277,0x231,0x2d5,0x217)+_0x5f0b0e(0x2a,0xc6,0x7e,0x99)+_0x5c272e(0x13a,0x1b5,0x252,0x23c)],'scheduler':_0x36d62c[_0x5f0b0e(-0x84,-0x4,-0x99,0x2f)+_0x5c272e(0x229,0x23c,0x242,0x19b)+'r'],'steps':_0x36d62c[_0x5f0b0e(-0xa9,-0x53,0x33,-0x99)],'cfg_scale':_0x36d62c['sdCfgScale'],'width':_0x548d33?_0x548d33:_0x36d62c['sd_cwidth'],'height':_0x2068d5?_0x2068d5:_0x36d62c[_0x5f0b0e(0xf4,0x6b,-0xe,0xc)],'restore_faces':_0x181e60[_0x5f0b0e(-0x2a,0x84,0xd6,0x8b)](_0x36d62c[_0x5c272e(0x37f,0x2e9,0x244,0x348)+'es'],'true'),'enable_hr':_0x181e60[_0x5c272e(0x2a2,0x266,0x2ff,0x22c)](_0x36d62c['sd_chires_'+_0x5f0b0e(-0x1e,0x39,0xce,0x51)],_0x181e60[_0x5f0b0e(-0x33,-0xc,-0x68,0x85)]),'hr_upscaler':_0x36d62c[_0x5c272e(0x1c9,0x231,0x185,0x19a)+_0x5c272e(0x2c2,0x28b,0x2cf,0x202)],'hr_scale':_0x36d62c[_0x5c272e(0x2ce,0x281,0x23f,0x279)+_0x5f0b0e(0x57,0x48,0xd8,0xeb)],'hr_additional_modules':[],'denoising_strength':_0x36d62c[_0x5c272e(0x296,0x237,0x1cf,0x2a1)+_0x5c272e(0x2ec,0x2e5,0x308,0x2cb)+'th'],'hr_second_pass_steps':_0x36d62c[_0x5f0b0e(0x36,-0x5c,0xc,-0xf8)+'steps'],'seed':_0x113457,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x36d62c[_0x5f0b0e(0x69,0x9b,0x10d,0xa)+'kip']),'sd_vae':_0x36d62c['sd_cchatu_'+'8_vae']},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x181e60['EjGnU'](addLog,'restore_fa'+_0x5f0b0e(0x1e,-0x40,-0x79,-0x44)+_0x213c4f[_0x5c272e(0x2a3,0x307,0x286,0x2c7)+'ces']),addLog('enable_hr\x20'+_0x5f0b0e(0x3a,-0x3c,-0x2d,0x63)+_0x213c4f['enable_hr']);_0x181e60[_0x5c272e(0x1b8,0x266,0x2d7,0x2d3)](_0x36d62c[_0x5c272e(0x296,0x30e,0x261,0x264)+_0x5f0b0e(0x70,0xa3,0xa1,0xef)],_0x181e60[_0x5f0b0e(0xc,-0xc,0xe,-0xb8)])&&(_0x181e60[_0x5f0b0e(-0x51,-0x11,-0xa6,-0x92)](_0x181e60[_0x5f0b0e(-0x1,0x1f,0x96,0x2a)],_0x181e60[_0x5f0b0e(0x3d,0x5d,0x45,0x1a)])?(_0x181e60[_0x5c272e(0x1dc,0x1d0,0x214,0x264)](addLog,_0x181e60[_0x5c272e(0x28b,0x215,0x18f,0x20e)]),_0x213c4f=_0x181e60['MFjoU'](deepMerge,_0x213c4f,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x181e60[_0x5f0b0e(-0x6a,-0x5e,0x35,-0xd3)]}]}}})):_0xdda67a=!![]);const _0x4ecc1c=_0x5c272e(0x31c,0x2fc,0x27c,0x391)+_0x5f0b0e(0x2b,-0xf,-0xb7,0x9c)+_0x5f0b0e(0x6f,0xb,-0xb,0x56)+_0x5c272e(0x2be,0x21f,0x176,0x242)+_0x3704d7+(_0x5c272e(0x25e,0x1ce,0x26d,0x1de)+_0x5c272e(0x228,0x243,0x269,0x297)+_0x5f0b0e(0xa7,0x36,0x5a,0x8f)+'\x20')+_0x10e97f+(_0x5c272e(0x34f,0x2a9,0x34d,0x2d1)+'(Sampler):'+_0x5f0b0e(0xc5,0x90,0x59,0x30))+_0x213c4f[_0x5f0b0e(0x5d,0x58,0xc8,0xa5)+'me']+('\x0a-\x20**步数\x20(S'+_0x5c272e(0x26a,0x2c9,0x2f8,0x269))+_0x213c4f[_0x5f0b0e(-0x4d,0x4b,0xed,0x60)]+(_0x5c272e(0x2ca,0x2ee,0x307,0x375)+_0x5c272e(0x294,0x285,0x23a,0x29c))+_0x213c4f['cfg_scale']+(_0x5c272e(0x35c,0x2af,0x314,0x262)+_0x5f0b0e(-0x1a,-0x4c,-0x65,-0x9e))+_0x213c4f['width']+'x'+_0x213c4f['height']+(_0x5f0b0e(0x1c,-0x2f,0x8,-0xe)+_0x5f0b0e(-0x33,-0x34,-0x25,-0x3c))+(_0x181e60[_0x5c272e(0x2e1,0x238,0x291,0x274)](_0x213c4f[_0x5c272e(0x190,0x1dd,0x152,0x1ab)],-(-0x132b*0x1+0x134f*0x2+0x9b9*-0x2))?_0x181e60[_0x5f0b0e(0x1d,-0x43,-0x2,-0x2c)]:_0x213c4f[_0x5f0b0e(-0x9c,-0x58,-0x100,-0xd4)])+(_0x5f0b0e(-0x26,-0x7b,0x27,-0x1d)+_0x5c272e(0x1aa,0x22f,0x272,0x1e1))+_0x36d62c[_0x5f0b0e(0x76,-0x4,0x14,0x17)+'8_model']+(_0x5f0b0e(0x2b,-0x13,0x4a,0x1a)+'*\x20')+_0x213c4f[_0x5f0b0e(-0x60,-0x36,-0x2e,-0x61)+_0x5c272e(0x17d,0x21a,0x16f,0x1e5)]['sd_vae']+(_0x5f0b0e(0x133,0xad,0x115,0xfe)+_0x5c272e(0x1d6,0x282,0x230,0x27d))+_0x213c4f[_0x5c272e(0x1c4,0x1ff,0x1a3,0x1dd)+_0x5c272e(0x26c,0x21a,0x2c1,0x284)][_0x5c272e(0x2ae,0x296,0x31a,0x285)+_0x5c272e(0x2ff,0x25c,0x27e,0x1db)+_0x5f0b0e(-0x87,0x6,0x58,-0x7e)]+(_0x5c272e(0x1a9,0x1eb,0x23a,0x171)+_0x5f0b0e(0xa9,0xba,0xe7,0x149)+_0x5f0b0e(-0x7f,-0x14,0x52,0x96))+_0x213c4f[_0x5c272e(0x25e,0x2f0,0x24f,0x31e)]+(_0x5f0b0e(0x44,0x29,0x51,0x66)+'(Upscale\x20F'+'actor):**\x20')+_0x213c4f[_0x5f0b0e(-0x4c,0x25,0x4e,0x6f)]+('\x0a-\x20**重绘幅度\x20'+'(Denoising'+_0x5f0b0e(-0xd,0x2f,-0x43,0x91)+_0x5f0b0e(-0x1c,-0x7,0x5,0x80))+_0x213c4f[_0x5c272e(0x220,0x209,0x1a4,0x19d)+_0x5c272e(0x1f6,0x279,0x2aa,0x250)]+(_0x5f0b0e(-0x66,0x2a,0x8e,-0xa)+'(Restore\x20F'+_0x5c272e(0x1ee,0x23d,0x1c2,0x1d1))+_0x213c4f[_0x5f0b0e(0x166,0xd2,0xdb,0x5f)+_0x5f0b0e(0x147,0x9c,0xf2,-0x12)]+(_0x5c272e(0x15c,0x1b3,0x223,0x1e8)+_0x5f0b0e(0x119,0x71,0xcc,0xa3))+_0x181e60[_0x5c272e(0x22c,0x2b9,0x2ab,0x2f8)](_0x36d62c[_0x5c272e(0x380,0x30e,0x283,0x38a)+_0x5f0b0e(0xbc,0xa3,0x129,0x1e)],_0x181e60[_0x5f0b0e(0x96,-0xc,0x7c,-0x17)])+_0x5c272e(0x201,0x24c,0x1a2,0x1c9);_0x181e60[_0x5c272e(0x172,0x20c,0x1dd,0x24e)](addLog,_0x4ecc1c),_0x181e60[_0x5c272e(0x236,0x1e1,0x17b,0x1be)](addLog,_0x5f0b0e(0x9,0x5,0x62,0xc)+'数为'+JSON['stringify'](_0x213c4f)),console[_0x5f0b0e(0xa,-0x70,-0xb8,-0xe5)](_0x181e60[_0x5f0b0e(0x8,-0x45,-0x22,-0xb)],_0x213c4f);while(!window['xiancheng']){await _0x181e60[_0x5c272e(0x201,0x21d,0x1c0,0x1f8)](sleep,0x2524+0xbd7*-0x1+-0x1565);};try{window[_0x5c272e(0x219,0x294,0x298,0x293)]=![],taskQueue[_0x5c272e(0x230,0x20d,0x28c,0x1e5)+'us'](_0x4d2825,_0x5c272e(0x178,0x1b4,0x11c,0x11a));if(_0x181e60[_0x5f0b0e(-0x6a,0x33,0x45,0xb2)](_0x36d62c[_0x5c272e(0x292,0x300,0x32c,0x393)],_0x181e60['RoOUy'])){if(!taskQueue[_0x5c272e(0x255,0x2ec,0x2b8,0x280)+_0x5c272e(0x346,0x29e,0x2ba,0x210)](_0x4d2825)){if(_0x181e60[_0x5c272e(0x25e,0x2b7,0x29f,0x2ce)](_0x181e60[_0x5c272e(0x1e8,0x28a,0x267,0x2e8)],_0x181e60[_0x5c272e(0x1f7,0x28a,0x2f7,0x23c)]))_0x493d19=_0x3c3bb3(_0x1592bc);else{addLog(_0x5c272e(0x20a,0x253,0x225,0x289)),eventSource['emit'](_0x181e60[_0x5c272e(0x281,0x308,0x27b,0x394)]);throw new Error(_0x181e60['nVtCh']);}}_0x213c4f[_0x5f0b0e(0x90,0xcc,0x71,0x5c)]=_0x352d72,console[_0x5f0b0e(0x13,-0x70,-0xd1,-0x11)](_0x181e60[_0x5c272e(0x2d7,0x261,0x261,0x2cf)],_0x36d62c[_0x5f0b0e(-0x3d,0x6f,0x8d,0xfb)+_0x5f0b0e(0xc7,0x95,0x9b,0x65)]),_0x213c4f[_0x5c272e(0x272,0x284,0x32d,0x245)]=_0x36d62c['st_chatu8_'+_0x5f0b0e(0x68,0x95,-0x8,0x119)]?_0x36d62c['st_chatu8_'+_0x5c272e(0x36a,0x2ca,0x32e,0x346)]:'';const _0x209ba1=await _0x181e60['MFjoU'](fetch,_0x181e60['CTEyO'],{'method':_0x181e60[_0x5f0b0e(0x42,-0xb,-0x5e,0x0)],'headers':_0x181e60[_0x5c272e(0x1e5,0x1cc,0x238,0x25e)](getRequestHeaders,window[_0x5c272e(0x310,0x306,0x394,0x32e)]),'body':JSON['stringify'](_0x213c4f)});if(!_0x209ba1['ok']){const _0x384096=await _0x209ba1['text']();addLog(_0x5c272e(0x1b7,0x1c2,0x1ef,0x1e2)+'码:\x20'+_0x209ba1[_0x5f0b0e(0x4f,0xcf,0x2b,0x177)]+_0x5c272e(0x2d7,0x260,0x301,0x203)+_0x384096),console[_0x5c272e(0x193,0x1c5,0x175,0x24d)](_0x181e60[_0x5f0b0e(0x13b,0xd6,0x10a,0xab)],_0x384096);throw new Error('请求失败,状态码:\x20'+_0x209ba1[_0x5c272e(0x290,0x304,0x2d3,0x2f4)]+_0x5c272e(0x2fa,0x2fa,0x36a,0x2e2)+_0x384096);}const _0x20ded2=await _0x209ba1[_0x5c272e(0x255,0x1e6,0x235,0x271)]();let _0x3c7ba5='';try{if(_0x5f0b0e(0xc8,0x83,0xba,0x49)!==_0x181e60[_0x5f0b0e(0x47,-0x17,-0x5d,0x13)])_0xfa93da['Character\x20'+_0xb5a1d4+_0x5c272e(0x2fa,0x2ff,0x2f8,0x39e)]&&(_0x2fc85f=_0x181e60['zjetW'](_0x181e60['oxVpn'](_0xdc166f,',\x20'),_0x181e60[_0x5c272e(0x214,0x1c1,0x26f,0x1ab)](_0x4bf9bb,_0x147ba8['Character\x20'+_0x213010+_0x5f0b0e(0x4d,0xca,0xf9,0xac)])));else{const _0x3c77cd=JSON[_0x5c272e(0x259,0x2c7,0x375,0x2bd)](_0x20ded2);_0x3c7ba5=_0x3c77cd['images'][-0x235*0x8+-0x302+0x14aa];}}catch(_0x4b633d){_0x181e60[_0x5c272e(0x2ff,0x30c,0x302,0x29c)](addLog,'JSON\x20解析失败，'+'尝试作为原始\x20Bas'+_0x5c272e(0x232,0x219,0x1f1,0x1e8)),_0x3c7ba5=_0x20ded2;}const _0x593d3f=_0x181e60[_0x5c272e(0x226,0x208,0x238,0x26a)](_0x181e60[_0x5c272e(0x156,0x200,0x267,0x19d)],_0x3c7ba5);return _0x181e60[_0x5c272e(0x2e1,0x235,0x1cc,0x29b)](addLog,_0x181e60[_0x5c272e(0x284,0x223,0x297,0x28a)]),taskQueue[_0x5f0b0e(0x4b,0x22,-0x1d,0x8c)+'sk'](_0x4d2825,!![]),currentTaskId=null,{'image':_0x593d3f,'change':_0x181e60['ovdhY'](_0x532104,'')};}else{if(_0x181e60[_0x5c272e(0x262,0x268,0x2cb,0x2f4)](_0x181e60[_0x5c272e(0x194,0x216,0x283,0x1db)],_0x181e60['ZSPqo']))!_0x2969ca[_0x5c272e(0x2f8,0x2b2,0x2aa,0x33b)+_0x5f0b0e(-0x1c,-0x44,-0xe2,-0x7)]&&(_0xa1a7c5['initialize'+_0x5f0b0e(0x5b,-0x44,-0xe6,-0x46)]=!![],_0x181e60['WapBS'](_0x5e331d)),_0x181e60['WapBS'](_0x33feb7);else{if(!taskQueue[_0x5f0b0e(0x6f,0xb7,0x60,0x1a)+'eue'](_0x4d2825)){if(_0x181e60[_0x5c272e(0x196,0x238,0x22e,0x2ae)](_0x181e60['yrNwV'],_0x181e60[_0x5c272e(0x365,0x2cf,0x2fb,0x349)])){_0x181e60['fyCST'](addLog,_0x181e60['OMwcD']);throw new Error(_0x181e60[_0x5c272e(0x22c,0x211,0x299,0x203)]);}else{_0x45316c(_0x181e60[_0x5c272e(0x252,0x1bf,0x1d2,0x1bb)]),_0xda6e8=_0x181e60[_0x5c272e(0x30a,0x30c,0x3b5,0x33c)](_0x760874,_0x555cbe),_0x2ff474=_0x3c0e58[_0x181e60[_0x5f0b0e(0x45,0x46,0x31,-0x4b)]];for(let _0x4690e7=0x14d+-0x795+-0x1*-0x649;_0x181e60['IPKcp'](_0x4690e7,0x1341+0x4*-0x50+-0x11fd);_0x4690e7++){_0x41fdf5[_0x5c272e(0x2a2,0x26d,0x1ce,0x2f8)+_0x4690e7+_0x5c272e(0x2e0,0x2ff,0x382,0x3ab)]&&(_0x27fb48=_0x181e60['oxVpn'](_0x181e60[_0x5c272e(0x26c,0x1d2,0x12c,0x15b)](_0x3dc2de,',\x20'),_0x254491['Character\x20'+_0x4690e7+'\x20Prompt']));}}}const _0x3d61d4=new URL(_0x181e60[_0x5c272e(0x35a,0x2bd,0x2ff,0x247)](_0x352d72,_0x181e60['NsLXq']));window[_0x5c272e(0x21b,0x294,0x2bb,0x306)]=![];const _0x16e576=await _0x181e60[_0x5f0b0e(-0x104,-0x6e,-0x5a,-0xdf)](fetch,_0x3d61d4,{'method':_0x181e60[_0x5c272e(0x1e3,0x22a,0x28e,0x244)],'body':JSON[_0x5c272e(0x33c,0x2ac,0x326,0x27a)](_0x213c4f),'headers':{'Content-Type':_0x181e60[_0x5c272e(0x260,0x20a,0x22f,0x16c)],'Authorization':_0x181e60[_0x5c272e(0x1fa,0x1ec,0x175,0x212)](getsdAuth)}});_0x181e60[_0x5f0b0e(-0x16,-0x6d,-0xf4,-0x11a)](setTimeout,()=>{function _0x26bc2f(_0x1613b5,_0x3f06b6,_0x2cec58,_0x31c9cb){return _0x5f0b0e(_0x3f06b6,_0x31c9cb- -0x1a3,_0x2cec58-0x1f4,_0x31c9cb-0x191);}function _0x2baf7e(_0x36cb46,_0x22ba5f,_0x56b2ff,_0x2de52c){return _0x5c272e(_0x22ba5f,_0x56b2ff-0x1f,_0x56b2ff-0xef,_0x2de52c-0xc8);}console[_0x26bc2f(-0x20f,-0x1db,-0x2aa,-0x213)](_0x181e60[_0x2baf7e(0x362,0x2b4,0x31c,0x2a3)]),window[_0x26bc2f(-0x15b,-0x1a2,-0x156,-0x144)]=!![];},extension_settings[extensionName][_0x5c272e(0x1bd,0x239,0x19c,0x190)+_0x5f0b0e(0x3c,0x81,0x7e,0xd2)]);;if(!_0x16e576['ok']){if(_0x181e60[_0x5f0b0e(0xa4,0xaf,0x10f,0xcc)](_0x181e60[_0x5f0b0e(0xc,0x13,-0x7a,0x2f)],_0x181e60['EGFnG'])){const _0x27de82=await _0x16e576['text']();_0x181e60[_0x5c272e(0x275,0x2bf,0x220,0x33e)](addLog,_0x5f0b0e(0x16,0x52,0x62,0xd4)+_0x5f0b0e(-0xab,-0x31,-0x78,-0x1e)+_0x16e576['status']+_0x5f0b0e(0x7f,0x2b,0x2b,0x81)+_0x27de82),console[_0x5f0b0e(-0xc4,-0x70,-0x49,0x35)](_0x181e60[_0x5c272e(0x395,0x30b,0x350,0x2c8)],_0x27de82);throw new Error('请求失败,状态码:\x20'+_0x16e576[_0x5f0b0e(0x101,0xcf,0x60,0xd4)]+_0x5c272e(0x320,0x2fa,0x26e,0x261)+_0x27de82);}else{_0x181e60[_0x5c272e(0x2fc,0x30c,0x2ea,0x30d)](_0x128b25,_0x472621);return;}}const _0x3efe5a=await _0x16e576[_0x5c272e(0x1a1,0x21b,0x18e,0x2c4)]();if(!_0x3efe5a[_0x5c272e(0x2cf,0x2f1,0x28f,0x2c8)]||_0x181e60[_0x5f0b0e(-0x27,0x33,-0x78,0xd0)](_0x3efe5a[_0x5c272e(0x2ca,0x2f1,0x35d,0x28f)]['length'],0x8*-0x1fd+-0x7e6+0x17ce))throw new Error(_0x181e60[_0x5c272e(0x25e,0x2c0,0x2a8,0x2a7)]);const _0x446c04=_0x3efe5a['images'][0xe*-0x1d3+0x1982+0x8],_0xa9f1eb=_0x181e60[_0x5c272e(0x2b1,0x2f3,0x2f4,0x258)](_0x181e60[_0x5f0b0e(-0xa1,-0x35,0x63,0x5d)],_0x446c04);return addLog(_0x181e60['zeeZc']),taskQueue[_0x5f0b0e(0x90,0x22,-0x1c,0x61)+'sk'](_0x4d2825,!![]),currentTaskId=null,{'image':_0xa9f1eb,'change':_0x181e60[_0x5f0b0e(-0xe7,-0x3f,-0x98,-0x82)](_0x3a20c2,'')};}}}catch(_0x43d4a0){const _0x7996fe=_0x181e60[_0x5f0b0e(0xfc,0xa0,0x13e,-0x6)][_0x5c272e(0x181,0x1fc,0x259,0x1a0)]('|');let _0x2aab83=0x9*0x26+-0x2e2+-0x63*-0x4;while(!![]){switch(_0x7996fe[_0x2aab83++]){case'0':currentTaskId=null;continue;case'1':console[_0x5f0b0e(0x103,0x73,0xad,-0x4)](_0x181e60[_0x5c272e(0x334,0x2f4,0x2fc,0x33d)],_0x43d4a0);continue;case'2':throw _0x43d4a0;continue;case'3':if(_0x181e60['wnVsJ'](_0x43d4a0[_0x5f0b0e(0x55,-0x26,-0xa8,0x14)],_0x181e60[_0x5f0b0e(-0x30,-0x24,-0x22,-0x6b)])){}else taskQueue['completeTa'+'sk'](_0x4d2825,![]);continue;case'4':window[_0x5f0b0e(-0x4a,0x5f,0xfc,0x100)]=!![];continue;case'5':_0x181e60[_0x5c272e(0x175,0x1df,0x13a,0x25a)](addLog,_0x5f0b0e(-0x23,-0x33,-0xbf,-0x94)+_0x43d4a0[_0x5f0b0e(-0x7c,-0x26,0x83,-0xa8)]);continue;}break;}}}async function sdGenerate(_0x3a3e17){const _0x1930b7={'XZzam':function(_0xb2d9a9,_0xc8d988){return _0xb2d9a9(_0xc8d988);},'NJqUE':function(_0x34189b,_0x39c6fb){return _0x34189b===_0x39c6fb;},'CMKVE':'CvkJI','TCfcX':_0x5a9eee(0x2d3,0x256,0x2b4,0x36d),'RgpJq':function(_0x1f7d34,_0x2155a0){return _0x1f7d34(_0x2155a0);},'RIrub':function(_0x1714f1,_0x1a5cb0){return _0x1714f1===_0x1a5cb0;},'DXYYO':_0x2883e1(0x552,0x5a4,0x51a,0x587),'NPLEY':_0x5a9eee(0x317,0x27b,0x3b6,0x39f),'rykDS':function(_0x300fae,_0x3dd806){return _0x300fae(_0x3dd806);},'okAbc':'Error\x20gene'+_0x2883e1(0x4f6,0x578,0x458,0x4f6)+_0x5a9eee(0x220,0x1c6,0x1f5,0x1a5)};function _0x2883e1(_0x507827,_0x11d178,_0x2c75a4,_0x2a8487){return _0x419a(_0x507827-0x35b,_0x2a8487);}const {id:_0x64d97f,prompt:_0x3666c8,width:_0xa3b282,height:_0x19eb21,change:_0x490ea2}=_0x3a3e17;addLog(_0x2883e1(0x508,0x471,0x49d,0x4ad)+_0x2883e1(0x4ca,0x56d,0x473,0x51e)+_0x64d97f+(_0x2883e1(0x4f9,0x519,0x4f4,0x4be)+':\x20')+_0x3666c8+(_0x490ea2?_0x2883e1(0x51a,0x521,0x4df,0x46d)+'\x20'+_0x490ea2:''));if(_0x490ea2&&_0x490ea2[_0x5a9eee(0x2e2,0x390,0x388,0x2b6)](_0x2883e1(0x46c,0x4c6,0x40a,0x50f))){bananaGenerate(_0x3a3e17);return;}function _0x5a9eee(_0x5c4adc,_0x4ada00,_0x246a00,_0x186635){return _0x419a(_0x5c4adc-0x127,_0x186635);}try{const {image:_0x577cfe,change:_0x3a06b0}=await _0x1930b7['XZzam'](generateSDImage,{'prompt':_0x3666c8,'width':_0xa3b282,'height':_0x19eb21,'change':_0x490ea2});if(extension_settings[extensionName][_0x5a9eee(0x218,0x224,0x170,0x27d)]!='0'){if(_0x1930b7[_0x5a9eee(0x259,0x1e1,0x1f1,0x1ec)](_0x1930b7[_0x5a9eee(0x32a,0x29e,0x2cb,0x3b9)],_0x1930b7[_0x5a9eee(0x20b,0x26e,0x270,0x2a3)])){_0x58967e('获取或者切换模型失败'+':\x20'+_0x59132f[_0x5a9eee(0x25a,0x2f3,0x1bd,0x1f7)]+('。请检查sdwebu'+'i是否正常启动，并检'+_0x5a9eee(0x250,0x2ee,0x219,0x24c))),_0x33d99a[_0x2883e1(0x4d6,0x4a0,0x506,0x576)+'sk'](_0x203469,![]),_0x241f23=null;throw new _0x458be4(_0x5a9eee(0x202,0x261,0x168,0x20d)+_0x2883e1(0x540,0x531,0x4c9,0x58b)+_0x2883e1(0x517,0x59b,0x4ba,0x585)+_0x5a9eee(0x250,0x229,0x1fe,0x1ea));}else{const _0x4747f0={};_0x4747f0[_0x5a9eee(0x233,0x1bf,0x286,0x270)]=_0x3a06b0,await setItemImg(_0x3666c8,_0x577cfe,_0x4747f0),_0x1930b7['RgpJq'](addLog,'图像已存入数据库\x20f'+_0x2883e1(0x4ee,0x548,0x539,0x585)+'\x20'+_0x3666c8);}}else{if(_0x1930b7[_0x5a9eee(0x273,0x2d6,0x289,0x31f)](_0x1930b7['DXYYO'],_0x1930b7[_0x2883e1(0x575,0x59b,0x542,0x58c)])){_0x1930b7[_0x5a9eee(0x32b,0x2a3,0x308,0x3a7)](_0x2d9785,_0x5a9eee(0x2f9,0x30b,0x32a,0x2cb)+_0x2ec370['status']+'\x20'+_0x4356e0[_0x2883e1(0x4e8,0x479,0x43e,0x51d)]);throw new _0x4fbe2d(_0x5a9eee(0x2f9,0x27a,0x2ff,0x378)+_0xe06af8[_0x5a9eee(0x34f,0x3b6,0x39d,0x38e)]+'\x20'+_0x5c137a[_0x2883e1(0x4e8,0x4d4,0x46d,0x563)]);}else addLog(_0x5a9eee(0x20e,0x202,0x1a5,0x251)+'库');}const _0x37d7f0={};_0x37d7f0['id']=_0x64d97f,_0x37d7f0[_0x5a9eee(0x28c,0x30e,0x2c9,0x2a3)]=!![],_0x37d7f0[_0x2883e1(0x55a,0x599,0x541,0x4b6)]=_0x577cfe,_0x37d7f0[_0x2883e1(0x45b,0x48c,0x40a,0x47e)]=_0x3666c8,_0x37d7f0['change']=_0x3a06b0,eventSource[_0x5a9eee(0x263,0x2dc,0x2b7,0x249)](EventType[_0x2883e1(0x4b1,0x55d,0x501,0x515)+_0x5a9eee(0x2ee,0x31d,0x2ee,0x339)+_0x5a9eee(0x2ff,0x30a,0x25b,0x34e)],_0x37d7f0),_0x1930b7[_0x5a9eee(0x30e,0x341,0x3a1,0x2ce)](addLog,_0x2883e1(0x521,0x4df,0x4f5,0x4bc)+'\x20(ID:\x20'+_0x64d97f+')');}catch(_0x1c78fb){const _0x1230d1=_0x2883e1(0x4d4,0x4ad,0x52e,0x4e3)+_0x2883e1(0x491,0x4c3,0x4fe,0x3e5)+_0x64d97f+_0x5a9eee(0x33d,0x3db,0x2b3,0x383)+_0x1c78fb[_0x5a9eee(0x25a,0x23c,0x1c8,0x22a)];_0x1930b7[_0x2883e1(0x55f,0x5e4,0x538,0x551)](addLog,_0x5a9eee(0x2c3,0x312,0x24d,0x305)+_0x1230d1),console[_0x2883e1(0x527,0x49d,0x55c,0x5c7)](_0x1930b7[_0x5a9eee(0x23a,0x249,0x2c7,0x2e8)],_0x1c78fb);const _0x394f4b={};_0x394f4b['id']=_0x64d97f,_0x394f4b[_0x5a9eee(0x28c,0x20d,0x31d,0x221)]=![],_0x394f4b['error']=_0x1c78fb[_0x5a9eee(0x25a,0x22c,0x2f6,0x1fb)],_0x394f4b[_0x2883e1(0x45b,0x438,0x4c4,0x40c)]=_0x3666c8,eventSource[_0x5a9eee(0x263,0x1f7,0x2b6,0x2ec)](EventType['GENERATE_I'+'MAGE_RESPO'+'NSE'],_0x394f4b),addLog(_0x2883e1(0x4ac,0x52d,0x450,0x501)+'\x20(ID:\x20'+_0x64d97f+')');}}function initializeSDListener(){const _0x251429={};_0x251429[_0x334a6c(0x4c,0x61,0xc2,0xa0)]=_0x334a6c(0xca,0x130,0x18b,0x136)+_0x5dd78c(0x4a5,0x4b1,0x466,0x479);function _0x334a6c(_0x408ebd,_0x364a50,_0xd959d4,_0x3ccbdd){return _0x419a(_0x3ccbdd- -0xc8,_0xd959d4);}const _0x37a8f4=_0x251429;eventSource['on'](EventType[_0x5dd78c(0x415,0x407,0x485,0x3a7)+_0x334a6c(0x68,0x75,0xee,0xf5)+'ST'],sdGenerate);function _0x5dd78c(_0x1d99c7,_0x5df86b,_0x622059,_0x1dc2f8){return _0x419a(_0x1d99c7-0x2bf,_0x5df86b);}addLog(_0x37a8f4[_0x334a6c(0x2d,0xb0,0xc5,0xa0)]);}export async function replaceWithSd(){function _0x260f68(_0x5279e4,_0x16f76d,_0x3df093,_0x2e87e7){return _0x419a(_0x2e87e7-0x2c6,_0x5279e4);}const _0x2e0a80={'epsZJ':function(_0x3c48d0,_0x772448){return _0x3c48d0<=_0x772448;},'gGPum':function(_0x297045,_0x39558e){return _0x297045+_0x39558e;},'gfkcn':function(_0x1ab106,_0x2d5525){return _0x1ab106==_0x2d5525;},'oUmqo':function(_0x522a2c){return _0x522a2c();},'BrHdA':function(_0x5aeb61){return _0x5aeb61();},'nFGwd':function(_0x49af68,_0x4cdfab){return _0x49af68!==_0x4cdfab;},'jsSyx':'FeaVj','jocey':_0x388c38(0x151,0x1ea,0x159,0x162),'FspFT':function(_0x11edab,_0x271f38){return _0x11edab!==_0x271f38;},'xOKzZ':_0x388c38(0x190,0x1e3,0x1e5,0x228),'okcRN':function(_0x4db176,_0x21f73a){return _0x4db176(_0x21f73a);}};function _0x388c38(_0xdbc7c2,_0x24188b,_0x9dd49c,_0x96f6ab){return _0x419a(_0x9dd49c- -0x3d,_0x96f6ab);}if(_0x2e0a80[_0x260f68(0x3f3,0x404,0x44e,0x411)](extension_settings[extensionName][_0x388c38(0x1e0,0x13d,0x192,0x103)],'sd')){if(_0x260f68(0x4bb,0x411,0x45e,0x49a)!==_0x260f68(0x4d5,0x423,0x3f1,0x49a)){const _0x4b9afe=_0x702650?function(){function _0x309f91(_0x2e1695,_0x169095,_0x582e3e,_0x73ba8b){return _0x388c38(_0x2e1695-0xc1,_0x169095-0xbe,_0x73ba8b-0x326,_0x169095);}if(_0x474b8f){const _0x2518ed=_0x161e82[_0x309f91(0x3a7,0x33f,0x320,0x3c8)](_0x52dc03,arguments);return _0x3fbcb2=null,_0x2518ed;}}:function(){};return _0x396f37=![],_0x4b9afe;}else!window['initialize'+'SDListener']&&(window['initialize'+_0x260f68(0x3f0,0x43b,0x44b,0x3db)]=!![],_0x2e0a80['oUmqo'](initializeSDListener)),_0x2e0a80['BrHdA'](initializeImageProcessing);}else{if(_0x2e0a80[_0x260f68(0x44a,0x4f1,0x492,0x454)](_0x2e0a80[_0x388c38(0x238,0x168,0x18c,0x1cb)],_0x2e0a80[_0x388c38(0x1df,0x19c,0x166,0xba)])){if(window[_0x388c38(0x15c,0x236,0x199,0x1ee)+_0x260f68(0x420,0x3e7,0x484,0x3db)]){if(_0x2e0a80[_0x260f68(0x408,0x4fc,0x405,0x460)](_0x388c38(0x243,0x219,0x1e5,0x1d8),_0x2e0a80[_0x260f68(0x3a1,0x429,0x4ab,0x440)])){_0x52569(_0x388c38(0x1d0,0x12b,0x175,0x1d1)+_0x396fad[_0x260f68(0x574,0x506,0x4ba,0x4ee)]+'\x20'+_0x5123c4[_0x388c38(0x173,0xb9,0x150,0x15a)]);throw new _0x1e4287('获取模型失败:\x20'+_0x59c77d[_0x260f68(0x49a,0x510,0x4ea,0x4ee)]+'\x20'+_0x49df33[_0x388c38(0xd8,0xfd,0x150,0x167)]);}else eventSource['removeList'+'ener'](EventType[_0x260f68(0x437,0x379,0x490,0x41c)+'MAGE_REQUE'+'ST'],sdGenerate),window[_0x388c38(0x234,0x161,0x199,0x21f)+'SDListener']=![],_0x2e0a80[_0x388c38(0x171,0xd6,0x173,0x120)](addLog,_0x260f68(0x4ec,0x49c,0x561,0x4c4)+'已关闭。');}}else for(let _0x4c99cc=-0xe9f+-0xc96*-0x1+0x20a;_0x2e0a80[_0x388c38(0x278,0x1a4,0x1d2,0x15b)](_0x4c99cc,0x1781+-0x243+-0xf7*0x16);_0x4c99cc++){_0x373a62['Character\x20'+_0x4c99cc+'\x20Prompt']&&(_0x58b90e=_0x2e0a80[_0x388c38(0x56,0xa4,0xd1,0x6a)](_0x2e0a80[_0x260f68(0x43b,0x3ef,0x3af,0x3d4)](_0x391f07,',\x20'),_0x3a3280(_0x4dd185[_0x388c38(0x154,0xb2,0x154,0x17f)+_0x4c99cc+_0x388c38(0x16f,0x13b,0x1e6,0x13b)])));}}}