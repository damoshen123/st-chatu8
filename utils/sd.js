(function(_0x16af32,_0x4a9c42){function _0x17d83c(_0x4b1b13,_0x2029fc,_0xf3dff7,_0x2d57da){return _0x3570(_0x2d57da-0x1f1,_0x2029fc);}const _0x2cd38a=_0x16af32();function _0x135cc2(_0x3c48c3,_0x352a98,_0x3f3df0,_0x38cead){return _0x3570(_0x352a98- -0x3cb,_0x3c48c3);}while(!![]){try{const _0x2929fe=-parseInt(_0x135cc2(-0xb5,-0x93,-0x38,-0x140))/(-0x7c3+0xf0a+-0x1*0x746)+-parseInt(_0x17d83c(0x553,0x4cd,0x460,0x515))/(0xd27*0x1+0x2*0x88b+-0x1e3b*0x1)*(parseInt(_0x135cc2(-0x1bf,-0x15a,-0x1e8,-0xe1))/(0x4*-0x197+0xa51+0x1f9*-0x2))+parseInt(_0x135cc2(-0x98,-0xbb,-0x7d,-0x57))/(0x9fa*0x1+0x48c*-0x6+0x5c6*0x3)*(-parseInt(_0x17d83c(0x4cb,0x492,0x432,0x4d3))/(-0x7*-0x3e3+-0x1824+-0x5*0x9c))+-parseInt(_0x17d83c(0x480,0x369,0x36b,0x3ed))/(0xdfd+0xb*0x2d0+-0x415*0xb)+-parseInt(_0x17d83c(0x425,0x3f2,0x446,0x483))/(0x1*-0xfa3+0x1b4f+-0xba5*0x1)+parseInt(_0x135cc2(-0x52,-0xb0,-0x72,-0x13b))/(-0x4*-0xa7+0x1*0xc5f+-0x1*0xef3)*(-parseInt(_0x135cc2(-0x127,-0x192,-0x226,-0x1ea))/(0x1*-0x137+-0x53d+0x67d))+parseInt(_0x135cc2(-0x155,-0x1e4,-0x20c,-0x223))/(-0x7*0x53+-0x185*-0xb+0x1*-0xe68);if(_0x2929fe===_0x4a9c42)break;else _0x2cd38a['push'](_0x2cd38a['shift']());}catch(_0x229f97){_0x2cd38a['push'](_0x2cd38a['shift']());}}}(_0x3c74,0x1089a9+-0x8d6c5+0x33d54));const _0x533b72=(function(){let _0x3c6f7f=!![];return function(_0x129211,_0x36998d){const _0x1122c6=_0x3c6f7f?function(){function _0x40a05d(_0xdec6c5,_0x472b2b,_0x1bc181,_0x39da9b){return _0x3570(_0x39da9b- -0x1de,_0x1bc181);}if(_0x36998d){const _0x349699=_0x36998d[_0x40a05d(0xc6,0x29,0x56,0x99)](_0x129211,arguments);return _0x36998d=null,_0x349699;}}:function(){};return _0x3c6f7f=![],_0x1122c6;};}()),_0x1ff3bf=_0x533b72(this,function(){const _0x27d20d={};_0x27d20d[_0x854e16(0x2b5,0x3cc,0x31f,0x38e)]=_0x4eacc8(0x207,0x1d7,0x239,0x1ba)+'+$';const _0x4036b9=_0x27d20d;function _0x854e16(_0x1ae934,_0x5994f1,_0x35b8a1,_0x5d9d36){return _0x3570(_0x35b8a1-0x84,_0x5994f1);}function _0x4eacc8(_0x4f2e9,_0x22484a,_0x3dceca,_0x8af8c){return _0x3570(_0x22484a- -0x15a,_0x4f2e9);}return _0x1ff3bf['toString']()['search'](_0x4036b9[_0x4eacc8(0x141,0x141,0xce,0x174)])[_0x854e16(0x2f8,0x3aa,0x364,0x2c1)]()[_0x4eacc8(0x10e,0xbf,0x101,0x21)+'r'](_0x1ff3bf)[_0x4eacc8(0x152,0x1a9,0x1db,0x254)](_0x4036b9[_0x4eacc8(0x9e,0x141,0x121,0xa2)]);});_0x1ff3bf();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';function _0x3570(_0x26b197,_0x79a6bb){_0x26b197=_0x26b197-(-0x7*-0x2b7+0x1*0x179f+0x1*-0x28d5);const _0x3bce11=_0x3c74();let _0x28334d=_0x3bce11[_0x26b197];if(_0x3570['ScuEAt']===undefined){var _0x4caf40=function(_0x5c17e0){const _0x45f7a5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2bfb03='',_0xf9ed4b='',_0x159d17=_0x2bfb03+_0x4caf40;for(let _0x41d289=0x1fd8+0x120d*-0x2+0x442,_0xbf8ddd,_0x5dddda,_0x15c4fc=0x2*-0xe5d+-0xb8d+0x3*0xd6d;_0x5dddda=_0x5c17e0['charAt'](_0x15c4fc++);~_0x5dddda&&(_0xbf8ddd=_0x41d289%(0x1287+-0x1092*0x1+-0x1f1)?_0xbf8ddd*(0xd9f+-0x7*-0x363+-0x2514)+_0x5dddda:_0x5dddda,_0x41d289++%(0x113c+0xca3+-0x1ddb))?_0x2bfb03+=_0x159d17['charCodeAt'](_0x15c4fc+(-0xe02+0x16f0+-0x8e4))-(0x1635+0xc1c*-0x2+0x20d)!==-0xc06+-0x2*-0xcd+-0x1*-0xa6c?String['fromCharCode'](0x2067+-0xa3a+-0x1*0x152e&_0xbf8ddd>>(-(0x27a*0x1+-0x103f+0xdc7)*_0x41d289&-0xf3b+0x18a2+-0x961)):_0x41d289:0x89*-0x3d+0x1429+-0x31f*-0x4){_0x5dddda=_0x45f7a5['indexOf'](_0x5dddda);}for(let _0x4dcd44=-0xfb*-0x1c+0x1a49+-0x35bd,_0x5eec27=_0x2bfb03['length'];_0x4dcd44<_0x5eec27;_0x4dcd44++){_0xf9ed4b+='%'+('00'+_0x2bfb03['charCodeAt'](_0x4dcd44)['toString'](0x1*-0x1381+-0x12ba+0x1*0x264b))['slice'](-(0xe91+0x1f70+-0x2dff));}return decodeURIComponent(_0xf9ed4b);};_0x3570['ZAjBGp']=_0x4caf40,_0x3570['ylXpjk']={},_0x3570['ScuEAt']=!![];}const _0xc972c1=_0x3bce11[0x266e+-0x4*-0x7c1+0x3*-0x1726],_0x3ac4af=_0x26b197+_0xc972c1,_0x3bb224=_0x3570['ylXpjk'][_0x3ac4af];if(!_0x3bb224){const _0x4b5792=function(_0x2fb00b){this['vagvEQ']=_0x2fb00b,this['TolYBE']=[-0x462+-0x2266+0x26c9,0x2425+-0xae2*0x1+-0x1943,-0x180b+0x1*-0xc1+0x18cc],this['CQbvCW']=function(){return'newState';},this['CBPPnX']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VCHrKd']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4b5792['prototype']['gYWkpc']=function(){const _0x1ef2d5=new RegExp(this['CBPPnX']+this['VCHrKd']),_0xffbffc=_0x1ef2d5['test'](this['CQbvCW']['toString']())?--this['TolYBE'][0x1a0a+-0x1e82+0x479]:--this['TolYBE'][-0x1b*0x25+-0x2*0x939+-0x1*-0x1659];return this['CCthow'](_0xffbffc);},_0x4b5792['prototype']['CCthow']=function(_0x154d1a){if(!Boolean(~_0x154d1a))return _0x154d1a;return this['LdMNdJ'](this['vagvEQ']);},_0x4b5792['prototype']['LdMNdJ']=function(_0x4dd65d){for(let _0x43fcff=0x899*-0x1+-0xe6c+-0x1*-0x1705,_0x1fcd3c=this['TolYBE']['length'];_0x43fcff<_0x1fcd3c;_0x43fcff++){this['TolYBE']['push'](Math['round'](Math['random']())),_0x1fcd3c=this['TolYBE']['length'];}return _0x4dd65d(this['TolYBE'][0xd7b+0xc91+-0x1a0c]);},new _0x4b5792(_0x3570)['gYWkpc'](),_0x28334d=_0x3570['ZAjBGp'](_0x28334d),_0x3570['ylXpjk'][_0x3ac4af]=_0x28334d;}else _0x28334d=_0x3bb224;return _0x28334d;}import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';function _0x3c74(){const _0x21a209=['cI0GkIROTj/PNAlMJ5dNPlOG','5yIh5O2I5QIH5z6l5AsX6lsLoIa','q3zgv0G','Dhj1zq','shDHDwe','ktOG','of91ChnJywXLCG','rM1fCuO','AeHPqM8','og4UChq','Aw5MBW','cI0GkIPdBgLWia','BM8Ty2fJAgu','tw96AwXSys81lG','EfP6vNe','ndK1odmYmLzAuvHpBW','lI4U','C3rHDhvZ','qLf5A0e','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','wg50y2K','CMvTB3zLtgLZDa','uK9duxa','BMvYyxrL','Dgvsv1C','DtHFC2rFyxv0Aa','ugvKv3K','ChrKu0C','D3bNvNK','vgLqqMq','B3nPDgLVBG','tvfvr2u','y2HHBMDL','yMHxBeK','B2v6rMu','ChqPoIOQia','6i635y+w5QIH5z6l5AsX6lsLoIa','CMvZDg9YzuzHyW','q2HHCMfJDgvYia','DxjS','ExvZAgvPzf9Zza','A0fKv24','ktOQkIa','uhjVBxb0ktOQkG','y29UC3rYDwn0BW','DhjPBq','wezetKO','AKjWzhC','icHjrdOG','rLrTB0G','C2rFy3vWC2nHBa','wwfNExK','AfLNtgq','zxr0Aw5NCW','EgLHBMnOzw5Nia','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','44cc5zon5BQu5yAf5A65oIa','zty0ioAvSoAnRUwKHoEqHUoaGG','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','z0HPrLq','D3Lusxe','CwHeuu8','vLLjq1m','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','5Q2J6z2I5O+q56s6icHqCM9T','uNLRq2W','y21VzgvSmJiYmG','AxHLB0K','ExvZAgu','BwvZC2fNzq','Bun5rMO','u2LPAwG','te90Bwm','tufhrv9srvfvrq','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','mJG4mgDdzuf2rG','Aw1Hz2vhzw5jBG','zxH0zw5ZAw9UxW','Dgv4Da','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','serHwwm','EgzJBgW','wevbz1q','v2fqsem','5Q2J5zYO6ycA6l+hC2r3zwj1','EeTxtNu','C2rFy2nOyxr1xW','uhrRt0u','AhzlwNm','mNW0Fdf8m3W1Fa','Dc1TB2rLBa','sez0vvC','6zsz6k+VoIa','cI0GkIRMQkhLNOSGke0','C2r3zwj1AEEuN+wBVUwpGG','wMLJuuu','y2zNx3nJywXL','55sO5lQo55sF5OIq55QevgfNoIa','svrvyuC','5lI6Dhj1zq','u2TPCdOQkIa','C3rLChm','CxbjsKy','of9TB2rLBa','Bg9N','DhH0mMLTzW','rxjYB3iGz2vUzq','Aw5PDgLHBgL6zq','s1LjqNy','6zQp5PY6kc0Xkq','tLnf','Ahv0ruO','mc4WlJaUmcbtyq','l3bUzZTIyxnLnG','Aw1Hz2u6','q1rMEwm','C0PMu0y','zhr5qK8','l3nKyxbPl3yXlW','5BEY5yID5AEl5yYw44cc','zxvL','AML1z3vHBG','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','rfHQD1q','mc44','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','q3rKy0S','CKDfz04','cI0GkIPwquu6kG','vw5JrfC','C2rdzMDty2fSzq','m1DMAMnMDW','se5bzg0','rM1hALy','ywnLCYK6kIOG','C2fTCgXLCL9Uyq','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','yxbWBhK','rfDuwuG','C2rFy2HPCMvZxW','zurUtuC','C3rYAw5NAwz5','shjSExK','of92ywu','zw1PDa','ifbYB21WDa','CgfYC2u','ChjVBxb0','AxPLktOQkIa','5zU+5y+c5PwW5OQL5zgkcI0GkIO','t2TvDuW','ANbHreW','zhfoveO','q2DbteC','yxv0B191CMW','DxbKyxrLu3rHDa','CLPIEMe','Bw9KzwW','cI0GkIRMLl7LPkFLGi3NJOCG','y2vZ','B2rLBcK6kIOG','DgvYDMfS','ptaUosXLBJTXpq','DgvWCYK6kIOG','mZi3nZG2mKnbBfnvDa','we15DMC','BeDeu0u','y3jPChrZ','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','C2rFy3nLzwq','5BcD6k+v5l2C5lI65y6F5AEliejHCW','se1QDhy','Aw9U','wKHTD0u','l2fWAs9Zzc9Nzq','AxnuyxnRsw5rDq','C3rFy2HHDhu4xW','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','EMGTq04SEMG7Cq','vwXNzgm','B3iGChjVBxb0oG','5yop5PwW5O2U44cc','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','BMvYyxrPB24','ruXRrMC','EhjcvxG','qMvMD2e','ruXNzeS','r2nxtu0','s3rLEe8','Df9LBMq','BgvUz3rO','qwnJzxb0luXHBG','vfHhvMO','5BEY5ywZ6zET44cc','C3vJy2vZCW','kfjLC3rVCMuGrG','uvnNr0C','44cc6k+35Qoa5P+LC2r3zwj1','rvL0yxG','uMfsvgm','C2tOR7FMSylNLj/LM77PLjNOR686ia','z3vHz2u','Bg9Hza','zMfJzsdKUlRLVidLKk8','CMf0Aw5Nifneia','y29TCgXLDgvuyq','E+s/RUwBVN0','whHNv08','ExHuu1q','shDdEvC','qxv0Ag9YAxPHDa','zgf0ytPPBwfNzq','qxLvveC','r0vorvjbvevFsq','EwX2Ahy','C2rFC3rVCf9Nzq','icHlsfrntcWGBa','mcaOv2LUzg93CW','vxrNBhO','AgrryxG','ksaTifbYB21WDa','C2rFy3DPzhrO','suq6ia','yu1PqLO','q0Xjuf9ZDg9WxW','qwnJzxb0','C2rFy3n0zxbZ','kI8Q','v2fHvxq','wKrjvKu','ifn0CMvUz3rOkq','5lIT55QeihbYB21WDooaGG','qM9oB3O','AhjFC2nHBgu','yMfJvMC','zw5HyMXLx2HYia','thbWBMy','Aw1Hz2vZ','cI0GkIRMRAxMLBaGkfm','rvnZELK','ic0Gq2HHBMDLoG','Dg9tDhjPBMC','ww9Qwwq','mJe1qLvrqNrb','sLnptIdOP6pMNPdLPlhOTkxVViW','z0TbvMu','of9Zy2HLzhvSzq','rhzNAgW','Cgf5Bg9Hza','v01gtMK','u0rmAxn0zw5LCG','zxjYB3i','D2LKDgG','EgLHBMnOzw5N','q29UDgvUDc1uEq','y2XPzw50','u2nLBMuGq29TCa','v3zdzuq','ue9tva','ANnVBG','uvDjAfq','yxv0Aa','loAOOEwEI+s4UG','C2rFyxv0Aa','vgLzAMC','qxvZqM4','vuLcC0C','vxnLCI1bz2vUDa','DfvnuxO','ksbbChbSzvDLyG','qKnxthy','CMf0Aw5NigLTyq','oIOQia','sgzsyxe','z2DWq0u','cI0TlqOGicaG','C2vHCMnO','swvnA0C','qw1cAuq','Dg9Rzw4','6k6+572U5QIH5z6llI4U5lI6','C2rvCMW','5lU75yQH5BEY5y+w5RAi','lcdOR6BMG4u6ia','v3fkA0e','y2fSztOQkIa','vunqx3nK','ywrKvgfZAW','CMvZDg9Yzv9Myq','mZi0otjlyLzXENm','5Q2J5zYO6k6+572U5QIH5z6l5lI6','tefPD0i','zw5HyMXLx2HY','BvLdq3e','z3HyBM8','zK90CNe','qxjpELC','Aw5Nx3n0CMvUzW','l2fWAs9Zzc9Zzq','5yYw5lI6igrHDgeGvvi','mJGWnJrXEenyrfK','BgvZktOG','uvvcvwu','y2fJAgu','Bhj1tKy','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','C2jVzfK','zMfYAs81mZCUmW','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','mtiWotyYogfMrwXLDa','zMfJzv95B2XVDG','5BI4icHjrdOG','EeDQCuO','A2LW','cI0GkIRPH4FMOlFMLRNMS5uG','tLnHt0W','sLH6ALa','CgvNu3rVCMfNzq','uLbevMe','yxjNCW','zML4zwrqCM9TCa','DMT1t1m','kcGOlISPkYKRkq','DNrOAKW','D0TmEKy','Aw5JBhvKzxm','ruPSv3y','C2rFDMfL','t2jss2u','nta5odmZtKH6uxnu','B21WDa','vxLtwwe','wvjvuNK','CMTSC2W','rhrlv3m','wLLqtMu','tunvs3G','C2v0DgLUz3nZlG','cI0GkIRNP43LRzaGkfm','C3rHDhvZvgv4Da','q2fJAguTq29UDa','tufhrv9srvnqtW','77Ym6k+35Qoa5P+LC2r3zwj1','s2rJuvi','C2rFy2fKzxrHAq','vgr4A3e','BMvNyxrPDMvqCG','A0LyDwq','C2vLza','y29UDMvYDfrVsG','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','zML4','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','kIOG','B3zLCNjPzgvFCW','B3nSrwe','ww93vwe','svzes2G','zgvUB2LZAw5NxW','5zon5BQu5yAf5A65oG','Aw1Hz2veyxrH','C3bSAxq','ywn0B3iPoIOQia','6k+V44cc54Q25Ocb56cboIa','Cgf5C3rFy2HHDa','ndu5odaWntbktuLyuhG','zKzPweC','ywrLDgfPBgvYxW','CNvUBMLUzW','C2rFy2nSAxbFCW','v2Ddu0y'];_0x3c74=function(){return _0x21a209;};return _0x3c74();}import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';function getDirectHeaders(_0xd22c38=null,_0x3d3907=null){const _0x528fa7={'uzHHx':function(_0x1f520e){return _0x1f520e();},'PtkOE':_0x4de1bb(-0x20e,-0xfe,-0xac,-0x164)+_0xe649b(0xae,0x101,0x9d,0x72)+'\x20NT\x2010.0;\x20'+'Win64;\x20x64'+_0xe649b(0xa6,0x135,0x1d5,0x167)+'Kit/537.36'+_0xe649b(0x14a,0x100,0xf8,0xf6)+'ike\x20Gecko)'+'\x20Chrome/12'+_0xe649b(0xcf,0x97,0x115,0x140)+_0x4de1bb(-0x3e,-0xef,-0xd4,-0x3c)+'6','LAiwB':_0xe649b(0x168,0x10b,0xd6,0xdb),'tUMQz':_0x4de1bb(-0x162,-0xe8,-0x153,-0xbe)+_0x4de1bb(-0xd0,-0xea,-0x163,-0xce)+_0x4de1bb(-0x176,-0x77,-0x13b,-0xf4),'AyUTG':_0x4de1bb(-0x16b,-0x205,-0xaf,-0x165),'IVDKh':function(_0x3ca446,_0x5a81c4){return _0x3ca446===_0x5a81c4;},'BQykA':_0xe649b(0x4b,0xbe,0xf3,0xd7),'teRWW':_0x4de1bb(-0x8a,-0x182,-0x1ab,-0x115),'nkUsW':_0xe649b(0x108,0xfa,0x14f,0xf0)+_0x4de1bb(-0x75,-0x160,-0xcd,-0xc4)},_0x565b9d={};_0x565b9d[_0x4de1bb(-0x117,-0xf5,-0xd,-0x64)]=_0x528fa7[_0x4de1bb(-0x12f,-0x142,-0x1a8,-0x119)],_0x565b9d[_0x4de1bb(-0x132,-0xef,0x1,-0x8e)]=_0x528fa7[_0x4de1bb(0x5a,-0x27,0x36,-0x4c)];function _0xe649b(_0x3a5b56,_0x15b558,_0xd22976,_0x176edd){return _0x3570(_0x15b558- -0x1c7,_0x176edd);}_0x565b9d[_0xe649b(0x114,0xe7,0x65,0x135)+_0xe649b(0x135,0xf1,0xf4,0x16c)]=_0x528fa7[_0x4de1bb(-0xe4,-0x42,0x39,-0x63)],_0x565b9d[_0xe649b(-0xa6,0x7,-0xf,0x82)+'rol']=_0x528fa7[_0xe649b(0xf6,0xfc,0x87,0x18a)],_0x565b9d['Pragma']=_0x4de1bb(-0x176,-0x13d,-0x1d9,-0x165);const _0x421707=_0x565b9d;function _0x4de1bb(_0x3cfd78,_0x462f8b,_0x1f6945,_0x2c1da1){return _0x3570(_0x2c1da1- -0x35e,_0x3cfd78);}return _0xd22c38&&(_0x528fa7[_0x4de1bb(-0x1b0,-0xea,-0x202,-0x17f)](_0x528fa7[_0x4de1bb(-0x169,-0x1ad,-0x14f,-0x15f)],_0x528fa7[_0xe649b(0xf4,0x3e,0x77,0xc5)])?(!_0x4b0e93[_0x4de1bb(-0xab,-0xc9,-0x15e,-0x105)+_0xe649b(0xf0,0x122,0x1b3,0xa1)]&&(_0x14f4dc['initialize'+_0xe649b(0x1cd,0x122,0x1a1,0x113)]=!![],_0x528fa7['uzHHx'](_0x13164d)),_0x1d9d69()):_0x421707[_0xe649b(0x123,0x126,0x7e,0x13b)+'pe']=_0xd22c38),_0x3d3907&&(_0x421707[_0x528fa7['nkUsW']]=_0x3d3907),_0x421707;}let currentTaskId=null;async function generateSDImage({prompt:_0x27779f,width:_0x4fcd12,height:_0x121cd5,change:_0x4c0898}){const _0x38a060={'sJfSF':function(_0x1cbed7,_0x2d8aa8){return _0x1cbed7(_0x2d8aa8);},'rZbza':function(_0x440333,_0x2121e4){return _0x440333(_0x2121e4);},'kIXud':function(_0x3ec2b4,_0x47d6e8){return _0x3ec2b4(_0x47d6e8);},'mYCCq':_0x4d6539(0x236,0x24c,0x1a2,0x103)+_0x4d6539(0x1c0,0x2c5,0x273,0x1fb),'FTmoH':_0x4d6539(0x284,0x325,0x2de,0x247)+_0x4d6539(0x1df,0x150,0x1af,0x182),'XxgWO':function(_0x20bc4b,_0x4a97f6){return _0x20bc4b(_0x4a97f6);},'Hrlyy':_0x4d6539(0x26c,0x284,0x1f1,0x14e)+_0x1d0a30(0xaf,0x15b,0x17,0x140),'IeMkG':_0x4d6539(0x264,0x341,0x2a8,0x2d5)+_0x1d0a30(0x7d,-0x38,0xb2,0x11d),'XMyvg':function(_0x3b8a56,_0x100992){return _0x3b8a56<=_0x100992;},'Tdxkq':function(_0x2f58dc,_0x2db0e8){return _0x2f58dc+_0x2db0e8;},'xGjqJ':function(_0x1c52f7,_0x5cfc5b){return _0x1c52f7(_0x5cfc5b);},'mCyFj':_0x4d6539(0x1b4,0x2e3,0x258,0x301),'xfcll':'SD\x20生图事件监听器'+_0x4d6539(0x20e,0x1d2,0x21e,0x204),'DWTYH':function(_0x21aeef){return _0x21aeef();},'ITUaG':function(_0x1544ce,_0x345432){return _0x1544ce(_0x345432);},'UIBsG':_0x1d0a30(0x95,0xe1,0x130,0x39)+_0x4d6539(0x294,0x2a8,0x20a,0x15f),'BFjwt':_0x4d6539(0x1fa,0x20b,0x211,0x1c7)+_0x4d6539(0x2e0,0x32b,0x274,0x2f9)+_0x1d0a30(0xd2,0x49,0x13b,0x163),'gKAVe':function(_0x58ba37,_0x50a7bf){return _0x58ba37(_0x50a7bf);},'BCWLv':function(_0x572944,_0xb3037e){return _0x572944(_0xb3037e);},'DXjwT':function(_0x3d1fc7,_0x4ad8f7){return _0x3d1fc7||_0x4ad8f7;},'TiPBd':function(_0x3a1d2f,_0x553a07){return _0x3a1d2f>_0x553a07;},'qhDQO':_0x4d6539(0x199,0x248,0x1b6,0x164),'OkUuL':function(_0x1c42ba,_0x43384f){return _0x1c42ba(_0x43384f);},'KdcQR':function(_0x284233,_0x424230){return _0x284233(_0x424230);},'BoNoz':function(_0x26bf6b,_0x1d90f1){return _0x26bf6b(_0x1d90f1);},'EJlWv':function(_0x42c8b3,_0x400f39){return _0x42c8b3(_0x400f39);},'wyTIq':function(_0x13dd78,_0x21e4b1){return _0x13dd78!==_0x21e4b1;},'Xntci':function(_0xa46682,_0x4a8c75){return _0xa46682(_0x4a8c75);},'eDnMG':function(_0x5774a1,_0x335523){return _0x5774a1===_0x335523;},'jnyTH':_0x1d0a30(0x17d,0x1f8,0x118,0x100),'oezFe':function(_0x30801f,_0x13e928){return _0x30801f(_0x13e928);},'ixeoI':_0x1d0a30(0x4c,-0xc,0x5f,0x4b)+_0x1d0a30(0x148,0xf3,0x97,0xb9),'ELgdK':function(_0x2804d6,_0x50af59,_0x3a6054){return _0x2804d6(_0x50af59,_0x3a6054);},'lruNF':_0x4d6539(0x2fa,0x325,0x2f6,0x36f),'ggpCE':'eiUef','WgCSF':_0x4d6539(0x106,0x1d9,0x1c0,0x118),'lGDSE':function(_0x4eac45,_0x356e33,_0x4ea5c4,_0x341391,_0xac5bd5,_0x563e3d){return _0x4eac45(_0x356e33,_0x4ea5c4,_0x341391,_0xac5bd5,_0x563e3d);},'hYgLd':function(_0xed394e,_0x3ab84f,_0x5a4c40){return _0xed394e(_0x3ab84f,_0x5a4c40);},'VYICS':function(_0x1f7168){return _0x1f7168();},'ZYPNe':function(_0x414d84,_0x1f9ac6){return _0x414d84===_0x1f9ac6;},'HwCyW':_0x1d0a30(0xd9,0xd8,0xff,0x44),'KYIBv':_0x4d6539(0x17c,0x1fc,0x1d5,0x1c1),'bacVg':_0x4d6539(0x19f,0x1cc,0x255,0x209)+_0x4d6539(0x201,0x269,0x201,0x229),'Siiih':_0x1d0a30(0x163,0xea,0x1ca,0xbf),'wKLzF':_0x4d6539(0x27f,0x214,0x1e8,0x172)+'2222','YowUa':_0x4d6539(0x24c,0x2a1,0x1f4,0x23a)+_0x4d6539(0x1bc,0x1c5,0x184,0xca)+_0x4d6539(0x183,0x1b4,0x1fd,0x1db)+_0x1d0a30(0xc7,0x118,0xdb,0x133),'QUBUe':function(_0x566860,_0x43b881){return _0x566860!=_0x43b881;},'WMFNi':function(_0x277fe7,_0xaf7f04){return _0x277fe7===_0xaf7f04;},'xZzVq':'CgrpV','hdQax':_0x1d0a30(0x18b,0x16d,0x1cc,0xdc)+_0x1d0a30(0xba,0x119,0xb1,0x160),'QWIhT':function(_0x2cee9c,_0x16d816){return _0x2cee9c(_0x16d816);},'NSAZP':function(_0x4f26da,_0x16d4aa){return _0x4f26da!==_0x16d4aa;},'sbodY':_0x4d6539(0x1dd,0x284,0x263,0x286),'MCUKx':function(_0x1eeb6d,_0x3ec2f1){return _0x1eeb6d(_0x3ec2f1);},'YRURy':_0x1d0a30(0xe5,0x191,0xd5,0x191),'HMjtv':_0x1d0a30(0x137,0x12d,0x98,0xb6),'Dvghl':_0x1d0a30(0xa7,0x157,0xc5,-0x13),'RykCl':function(_0x53dc62,_0x405706){return _0x53dc62!==_0x405706;},'Befwa':function(_0xf3277,_0x466495){return _0xf3277>=_0x466495;},'dcNiy':_0x1d0a30(0x92,0x7a,0x4a,0x140),'lQHMK':function(_0x44bf55,_0x51a351){return _0x44bf55==_0x51a351;},'hvKZs':_0x1d0a30(0x62,-0x1a,0xb8,0x54),'xrBUx':function(_0x5a6a60,_0x3bba37){return _0x5a6a60(_0x3bba37);},'wpgVy':_0x1d0a30(0xcd,0xb9,0x181,0x181),'GJQVi':_0x1d0a30(0x159,0x1e6,0xa0,0x156),'WaPHC':function(_0x61650e,_0x44a83d){return _0x61650e(_0x44a83d);},'UySYa':_0x4d6539(0x250,0xec,0x1a3,0x101),'ptdSG':'riJtI','CvFWH':'AdfgF','UncDW':_0x4d6539(0x2b6,0x256,0x2ce,0x2f1),'dtyBO':_0x1d0a30(0x138,0xd3,0x1f2,0xd6)+_0x4d6539(0x1c2,0x1eb,0x25e,0x1fc),'dqNTJ':_0x1d0a30(0x17b,0x1cd,0x15f,0x107),'CTfyc':_0x4d6539(0x164,0x1f0,0x19f,0x1aa)+_0x1d0a30(0x78,0x124,0x35,0x88)+_0x1d0a30(0x12b,0xbd,0x1d7,0xcc),'vkuOS':function(_0x375728,_0x38c370,_0x2bb0bf){return _0x375728(_0x38c370,_0x2bb0bf);},'ArOzW':_0x1d0a30(0x10e,0xc6,0x187,0x17c)+_0x4d6539(0x24d,0x102,0x1bd,0x264),'WaaUt':function(_0x1ca5f8,_0x3fe028){return _0x1ca5f8(_0x3fe028);},'ROCQp':_0x4d6539(0x34f,0x349,0x294,0x299),'QSgGG':function(_0x2bcead,_0x424aae){return _0x2bcead(_0x424aae);},'ZicQE':_0x4d6539(0x19c,0x1f1,0x19a,0xf6),'KtexO':_0x4d6539(0x293,0x15c,0x20d,0x19d),'RaRTc':'bqxxc','oslEa':_0x4d6539(0x2ec,0x245,0x27b,0x31c)+_0x4d6539(0x2a6,0x22f,0x218,0x2ba)+'4,','MQUGe':function(_0x3d0d17,_0x4a1c1c){return _0x3d0d17(_0x4a1c1c);},'ESszY':function(_0x4bc638,_0x3b6d09,_0x2a8aaa){return _0x4bc638(_0x3b6d09,_0x2a8aaa);},'CtdcK':function(_0x874d51,_0xf6beb0){return _0x874d51||_0xf6beb0;},'TiYjg':_0x1d0a30(0xd6,0x180,0x77,0xa9)+_0x1d0a30(0xc9,0xaa,0xde,0x53),'ELkFg':function(_0x351066,_0x2c329b,_0x314208){return _0x351066(_0x2c329b,_0x314208);},'fFiXG':'applicatio'+'n/json','RPDVa':function(_0x3bb459,_0x5ae66f){return _0x3bb459!==_0x5ae66f;},'RjfPF':_0x4d6539(0x2cd,0x1f5,0x226,0x2cc),'gUbMM':_0x1d0a30(0xcf,0x161,0x106,0x57),'ToSze':function(_0x268c33,_0x10d0be){return _0x268c33+_0x10d0be;},'enEeJ':_0x1d0a30(0xa9,0xf8,0x158,0xcf)+_0x1d0a30(0x18c,0x193,0x1cd,0x18a)+'L。','NSaOL':_0x4d6539(0x2a7,0x1f1,0x200,0x1a5)+'0','CgALG':_0x1d0a30(0xca,0x15b,0x125,0x101)+_0x1d0a30(0x170,0x190,0x1f2,0x11e)+'ge:'};_0x38a060[_0x1d0a30(0xea,0xb3,0x184,0xfa)](clearLog);const _0x40e55f=taskQueue[_0x4d6539(0x2cc,0x29d,0x2c7,0x226)]({'name':_0x38a060[_0x4d6539(0x2ce,0x273,0x222,0x242)](_0x27779f,'')['substring'](-0x1d6c+-0x13d7+0x3143,0x2281+0x1*0x18ad+-0x3b10)+(_0x27779f&&_0x38a060[_0x4d6539(0x10d,0x1db,0x1c3,0x275)](_0x27779f[_0x1d0a30(0x11f,0x179,0x6b,0x17d)],-0x3f+-0xd7*0x17+0x2*0x9d7)?_0x38a060[_0x1d0a30(0x9c,0x56,-0x14,0x24)]:''),'type':TaskType['SD'],'prompt':_0x27779f});currentTaskId=_0x40e55f;let _0x1dca4f=_0x4c0898;_0x27779f=processCharacterPrompt(_0x27779f),_0x4c0898=_0x38a060[_0x4d6539(0x1bd,0x1fe,0x23d,0x20d)](processCharacterPrompt,_0x4c0898),_0x27779f=await _0x38a060['KdcQR'](stripChineseAnnotations,_0x27779f),_0x4c0898=await _0x38a060[_0x4d6539(0x1e5,0x26c,0x290,0x227)](stripChineseAnnotations,_0x4c0898);const _0x537fb1=extension_settings[extensionName][_0x4d6539(0x34f,0x26f,0x2c1,0x2d1)][_0x1d0a30(0x8c,0xb2,0xae,0x13a)](),_0x1985a9=extension_settings[extensionName];_0x38a060[_0x1d0a30(0x1a7,0x132,0x11e,0x1da)](addLog,_0x1d0a30(0xb4,0xa3,0x104,0xc0)+'i生成图片...客户'+'端为'+_0x1985a9[_0x4d6539(0x25b,0x336,0x2a7,0x320)]+_0x4d6539(0x250,0x263,0x2ae,0x1fd)+_0x1985a9[_0x1d0a30(0xb6,0x123,0xb0,0x102)+_0x1d0a30(0xc7,0xa5,0xa4,0x14b)]);const _0x32874d=_0x4c0898&&_0x38a060[_0x4d6539(0x167,0x1df,0x1e2,0x137)](_0x4c0898[_0x1d0a30(0x8c,-0x20,0x7b,0xe4)](),'')?_0x4c0898:_0x27779f;addLog(_0x1d0a30(0xc1,0x154,0x4b,0x4e)+_0x32874d);let _0x54a428=![];_0x32874d[_0x4d6539(0x2d6,0x361,0x2ed,0x307)](_0x38a060[_0x1d0a30(0x176,0x110,0x17e,0x140)])&&(_0x54a428=!![]);_0x38a060[_0x1d0a30(0x73,0x113,-0x44,0xbb)](addLog,_0x1d0a30(0x96,0xeb,0x127,-0x18)+'(Divide_ro'+_0x4d6539(0x2fc,0x372,0x2d5,0x2c5)+_0x54a428);function _0x4d6539(_0x5b351a,_0x4d7f1c,_0x496d0f,_0x5979b2){return _0x3570(_0x496d0f- -0x47,_0x5b351a);}let _0x4f7dac={},_0x2d1e2d='',_0x4cb690='';if(_0x54a428){if(_0x38a060[_0x1d0a30(0xec,0xb9,0x19c,0x7f)](_0x38a060['jnyTH'],_0x1d0a30(0x1a9,0x1e0,0x1c1,0x18c)))_0x5fc93e=!![];else{addLog(_0x38a060[_0x1d0a30(0xee,0x185,0x4f,0xc7)]),_0x4f7dac=_0x38a060[_0x4d6539(0x2fc,0x298,0x2e0,0x365)](parsePromptStringWithCoordinates,_0x32874d),_0x2d1e2d=_0x4f7dac[_0x1d0a30(0x161,0x1bb,0x11b,0x154)+_0x1d0a30(0x7d,0xf4,0xd3,-0xe)];for(let _0x2324a7=-0x3b*0x38+0x241+-0x2*-0x554;_0x2324a7<=-0x15f9+0x2*0xa94+0xd5*0x1;_0x2324a7++){_0x4f7dac[_0x1d0a30(0x85,0x10d,-0x31,0x3a)+_0x2324a7+_0x1d0a30(0xf1,0x90,0x16f,0x5c)]&&(_0x4cb690=_0x4cb690+',\x20'+_0x4f7dac[_0x1d0a30(0x85,0x2d,0x79,0xf1)+_0x2324a7+_0x1d0a30(0xf1,0xed,0x19f,0xb6)]);}}}else _0x38a060[_0x4d6539(0x21d,0x1c7,0x1c8,0x182)](addLog,_0x38a060[_0x4d6539(0x1f1,0x228,0x1e9,0x141)]),_0x2d1e2d=_0x32874d;let {modifiedPrompt:_0x778846,insertions:_0x9cc6b}=await _0x38a060['ELgdK'](prompt_replace,_0x2d1e2d,_0x4cb690);if(_0x54a428){if(_0x38a060[_0x1d0a30(0xec,0x4d,0x4b,0xc9)](_0x38a060[_0x4d6539(0x291,0x2db,0x2d8,0x260)],_0x38a060[_0x1d0a30(0x191,0x1ab,0x12f,0x14c)]))for(let _0x5d4764=0x1636+0x3*0x30b+-0x1f56;_0x38a060[_0x4d6539(0x1c0,0x2bf,0x24c,0x1c2)](_0x5d4764,0x2450+-0x268a*0x1+0x23e);_0x5d4764++){_0x38a060[_0x1d0a30(0x173,0x137,0xd1,0x16e)]===_0x38a060[_0x4d6539(0x196,0x1da,0x1a5,0x23e)]?(_0xf85bfe[_0x1d0a30(0x74,0xa2,0x52,0xad)+'ener'](_0x5dbc1a[_0x4d6539(0x22f,0x1d5,0x27d,0x26d)+_0x1d0a30(0xa8,0x14,0x143,0x52)+'ST'],_0x203b4f),_0x480e9a[_0x1d0a30(0xcb,0x94,0x12c,0x130)+_0x4d6539(0x332,0x202,0x2a2,0x2ad)]=![],_0x38a060[_0x4d6539(0x2b9,0x1f4,0x21b,0x1f6)](_0xa9aba8,'SD\x20生图事件监听器'+_0x1d0a30(0x122,0x90,0x1d9,0x155))):_0x4f7dac[_0x4d6539(0x1d5,0x26e,0x1cc,0x1db)+_0x5d4764+_0x1d0a30(0xf1,0x8a,0x41,0x12f)]&&(_0x778846=_0x38a060[_0x1d0a30(0x45,0xc,-0x3c,0x67)](_0x778846,',\x20')+prompt_replace_for_character(_0x4f7dac[_0x1d0a30(0x85,0xea,0x3c,0xd7)+_0x5d4764+'\x20Prompt']));}else throw new _0x522ad7(_0x1d0a30(0xda,0x186,0x128,0xe4)+_0x4d6539(0x1cc,0x290,0x25c,0x30b));}let _0x4b6447=await _0x38a060[_0x4d6539(0x2c4,0x19d,0x24d,0x2a4)](zhengmian,extension_settings[extensionName][_0x4d6539(0x245,0x1c2,0x1ea,0x1aa)][extension_settings[extensionName]['yusheid_sd']][_0x1d0a30(0x1a1,0x11e,0x153,0x173)+'t'],_0x778846,extension_settings[extensionName][_0x4d6539(0x21f,0x253,0x1ea,0x14f)][extension_settings[extensionName]['yusheid_sd']][_0x1d0a30(0x1a1,0x1be,0xe7,0x12b)+_0x4d6539(0x2b7,0x2c6,0x265,0x1d3)],extension_settings[extensionName]['AQT_sd'],_0x9cc6b),_0xa1b8db=await _0x38a060['hYgLd'](fumian,extension_settings[extensionName][_0x1d0a30(0xa3,0x128,0x57,0x4e)][extension_settings[extensionName][_0x4d6539(0x11d,0x1f4,0x1ce,0x144)]][_0x4d6539(0x153,0x22b,0x18d,0x20e)+_0x1d0a30(0x1ab,0x10a,0x1b2,0x221)],extension_settings[extensionName][_0x4d6539(0x2dc,0x2e8,0x2c6,0x2e2)]);_0x38a060[_0x1d0a30(0x43,0xa,0xad,-0x5d)](addLog,'负面为:\x20'+_0xa1b8db),extension_settings['sd'][_0x4d6539(0x2de,0x205,0x241,0x2e4)]=_0x537fb1;function _0x1d0a30(_0x3a14c5,_0x147a1a,_0x40293b,_0x496801){return _0x3570(_0x3a14c5- -0x18e,_0x40293b);}await _0x38a060[_0x4d6539(0x18f,0x1ea,0x1e4,0x289)](saveSettingsDebounced);try{if(_0x38a060['ZYPNe'](_0x1985a9[_0x4d6539(0x2ae,0x225,0x2a7,0x26a)],_0x38a060[_0x4d6539(0x235,0x25c,0x279,0x1e5)])){if('jBpdw'!==_0x38a060[_0x1d0a30(0xcc,0x16f,0x7b,0x123)])_0xe2fcfd=_0x38a060[_0x4d6539(0x2b7,0x2f0,0x243,0x2e1)](_0x1101c2,_0x328d63);else{const _0x4516e9={};_0x4516e9[_0x1d0a30(0x166,0x15d,0x1d2,0xc3)]=_0x1985a9['st_chatu8_'+_0x1d0a30(0x168,0x11a,0x198,0x137)]?_0x1985a9[_0x4d6539(0x1d2,0x240,0x257,0x207)+'sd_auth']:'',_0x4516e9[_0x4d6539(0x27a,0x203,0x1cd,0x27e)]=_0x537fb1;const _0x153039=await _0x38a060[_0x1d0a30(0x93,0x13d,0x124,0x7d)](fetch,_0x38a060[_0x4d6539(0x2d3,0x26c,0x292,0x2f6)],{'method':_0x38a060[_0x1d0a30(0xa6,0x3f,0xbe,0x161)],'body':JSON[_0x4d6539(0x1fc,0x198,0x234,0x206)](_0x4516e9),'headers':_0x38a060[_0x4d6539(0x333,0x35a,0x2ee,0x2eb)](getRequestHeaders,window[_0x4d6539(0x364,0x22f,0x2bf,0x2a3)])});if(!_0x153039['ok']){addLog(_0x1d0a30(0x83,0x7e,0x137,0x94)+_0x153039[_0x4d6539(0x200,0x162,0x1b7,0x173)]+'\x20'+_0x153039[_0x1d0a30(0x3f,0x6d,0x90,-0x3d)]);throw new Error('获取模型失败:\x20'+_0x153039['status']+'\x20'+_0x153039['statusText']);}let _0x1078c6=await _0x153039[_0x4d6539(0x141,0x1bc,0x1f5,0x22d)]();console[_0x4d6539(0x211,0x183,0x20f,0x1bd)](_0x38a060[_0x1d0a30(0x1a5,0x248,0x1d7,0x164)],_0x1078c6),console[_0x4d6539(0x2bf,0x1de,0x20f,0x29d)](_0x38a060[_0x1d0a30(0x50,-0x26,0x96,-0x56)],_0x1985a9['sd_cchatu_'+_0x1d0a30(0xc7,0x136,0xe9,0xe2)]);if(_0x38a060[_0x1d0a30(0x18f,0x105,0x131,0x223)](_0x1078c6,_0x1985a9[_0x4d6539(0x2a7,0x18d,0x1fd,0x18d)+_0x1d0a30(0xc7,0xcc,0x15b,0xdb)])){if(_0x38a060[_0x4d6539(0x2b0,0x31b,0x2a1,0x2e6)](_0x38a060[_0x4d6539(0x21d,0x1dd,0x1b4,0x132)],'oLUmI')){_0x533759(_0x4d6539(0x1a4,0x250,0x1ca,0x271)+_0xf6192b[_0x4d6539(0x1d6,0x266,0x1b7,0x16a)]+'\x20'+_0x37ae4b[_0x4d6539(0x23a,0x1fb,0x186,0x15e)]);throw new _0x34928a(_0x4d6539(0x183,0x13a,0x1ca,0x23d)+_0x2cc5a8[_0x4d6539(0x234,0x1c4,0x1b7,0x244)]+'\x20'+_0x93c821[_0x1d0a30(0x3f,0xb7,0xe7,0x82)]);}else{_0x38a060['BCWLv'](addLog,_0x1d0a30(0x183,0x133,0x1c9,0x167)+_0x1985a9[_0x1d0a30(0xb6,0x7f,-0x3,0x3a)+_0x4d6539(0x223,0x15b,0x20e,0x2b8)]+_0x1d0a30(0x6f,0xa1,0x4f,-0x17)),toastr[_0x4d6539(0x1a8,0x10b,0x1b0,0x209)](_0x4d6539(0x1be,0x153,0x191,0x1ba)+_0x1985a9[_0x4d6539(0x19c,0x2b2,0x1fd,0x176)+_0x1d0a30(0xc7,0xc7,0xb4,0x116)]);const _0x261e33={};_0x261e33['auth']=_0x1985a9[_0x1d0a30(0x110,0x165,0x157,0x1c5)+'sd_auth']?_0x1985a9[_0x1d0a30(0x110,0x15f,0xa4,0xe0)+_0x4d6539(0x22f,0x1f6,0x2af,0x2ef)]:'',_0x261e33[_0x4d6539(0x1aa,0x24c,0x1cd,0x237)]=_0x537fb1,_0x261e33[_0x1d0a30(0xfd,0x138,0x1ac,0x183)]=_0x1985a9['sd_cchatu_'+_0x1d0a30(0xc7,0x61,0x78,0xcb)];const _0x540ade=await fetch(_0x38a060[_0x1d0a30(0x13c,0x115,0xba,0x98)],{'method':_0x38a060[_0x1d0a30(0xa6,0x129,0xef,0x160)],'body':JSON[_0x4d6539(0x1c5,0x1c1,0x234,0x1ef)](_0x261e33),'headers':_0x38a060['OkUuL'](getRequestHeaders,window['token'])});if(!_0x540ade['ok']){_0x38a060[_0x4d6539(0x292,0x33f,0x2ac,0x21c)](addLog,_0x1d0a30(0x60,0x110,-0x48,0x63)+_0x540ade['status']+'\x20'+_0x540ade['statusText']);throw new Error(_0x1d0a30(0x60,0x53,0x4a,0x8e)+_0x540ade[_0x1d0a30(0x70,0x3b,-0x47,-0x1c)]+'\x20'+_0x540ade[_0x4d6539(0x21f,0x141,0x186,0x1df)]);}toastr[_0x4d6539(0x174,0x176,0x1b0,0x120)](_0x1d0a30(0x179,0x233,0xd2,0x1a7)+_0x1985a9[_0x1d0a30(0xb6,0x156,0x143,0x154)+_0x4d6539(0x265,0x1bd,0x20e,0x20f)]+'成功');}}}}else{if(_0x38a060['NSAZP'](_0x4d6539(0x1c7,0x2e2,0x263,0x24b),_0x38a060[_0x1d0a30(0x193,0xdc,0xe4,0x1eb)])){_0x38a060[_0x1d0a30(0x47,-0x58,0x1b,-0x1b)](_0x5144c5,_0x38a060[_0x4d6539(0x381,0x365,0x2cd,0x30e)]);const _0x485284={};_0x485284['ad_model']=_0x38a060[_0x4d6539(0x282,0x250,0x1d7,0x26c)];const _0x2b7421={};_0x2b7421[_0x4d6539(0x331,0x30b,0x2e7,0x2bb)]=[!![],!![],_0x485284];const _0x4081c1={};_0x4081c1['ADetailer']=_0x2b7421;const _0x2bc67f={};_0x2bc67f['alwayson_s'+_0x4d6539(0x1ff,0x2a5,0x24e,0x1e6)]=_0x4081c1,_0x35d85a=_0x3924d9(_0x53af3c,_0x2bc67f);}else{let _0x5184b2=await _0x38a060[_0x4d6539(0x293,0x36a,0x2f8,0x3a4)](getSDMode,_0x537fb1);_0x38a060[_0x4d6539(0x273,0x389,0x2d6,0x279)](_0x5184b2,_0x1985a9['sd_cchatu_'+_0x4d6539(0x21d,0x1db,0x20e,0x29c)])&&(_0x38a060[_0x4d6539(0x270,0x1c0,0x1e2,0x282)](_0x38a060[_0x1d0a30(0x1ad,0x177,0x14e,0x1ae)],_0x38a060[_0x1d0a30(0x10b,0xab,0x181,0x11e)])?(_0x38a060[_0x4d6539(0x1d7,0x1ff,0x21b,0x283)](addLog,_0x4d6539(0x1e3,0x15c,0x1e0,0x247)+_0x1985a9[_0x4d6539(0x17b,0x164,0x1fd,0x177)+_0x4d6539(0x229,0x1f0,0x20e,0x1e1)]+_0x4d6539(0x231,0x108,0x1b6,0x1bb)),await _0x38a060[_0x4d6539(0x280,0x1e8,0x262,0x1be)](setSDMode,_0x537fb1,_0x1985a9[_0x1d0a30(0xb6,0xda,0x62,0x6c)+_0x1d0a30(0xc7,0x128,0x160,0x119)])):_0x1f5b85(_0x4d6539(0x214,0x2ab,0x25d,0x20f)+'库'));}}}catch(_0x28c997){if(_0x38a060['ZYPNe'](_0x38a060[_0x1d0a30(0x158,0x178,0x112,0xab)],_0x1d0a30(0xa7,0x125,0xfb,0x10c))){_0x38a060[_0x1d0a30(0x1a7,0x12f,0x100,0x1dd)](addLog,_0x1d0a30(0x192,0x1bc,0x17d,0x1b6)+':\x20'+_0x28c997[_0x1d0a30(0xa4,0x1f,0xf1,0x12b)]+(_0x4d6539(0x2b2,0x214,0x26d,0x1e7)+_0x1d0a30(0x72,-0x43,-0x30,-0x4)+'查模型是否正确。')),taskQueue[_0x4d6539(0x297,0x276,0x275,0x2ce)+'sk'](_0x40e55f,![]),currentTaskId=null;throw new Error('获取或者切换模型失败'+_0x4d6539(0x10a,0x199,0x189,0x228)+_0x1d0a30(0x72,0xd3,-0x34,0x80)+_0x4d6539(0x2af,0x25a,0x24f,0x1ac));}else{_0x38a060[_0x1d0a30(0x130,0x1e1,0x1df,0x115)](_0x382b7f,_0x38a060[_0x1d0a30(0xee,0xfa,0x120,0xb9)]),_0x3d7db4=_0x38a060[_0x1d0a30(0x47,-0x5c,0x62,0xe5)](_0x2e4ef8,_0x3be352),_0x3c777f=_0x417736[_0x38a060['IeMkG']];for(let _0x3854c7=-0x1bc1+0x554+0x166e;_0x38a060['XMyvg'](_0x3854c7,-0x21ac+0x3*0xabf+0x1*0x173);_0x3854c7++){_0x27761c['Character\x20'+_0x3854c7+_0x1d0a30(0xf1,0x17a,0xa6,0x169)]&&(_0x5b3f7d=_0x38a060[_0x1d0a30(0x45,0xe7,0x82,0x52)](_0x38a060['Tdxkq'](_0x121b5f,',\x20'),_0x161ef2[_0x4d6539(0x1a4,0x1a0,0x1cc,0x156)+_0x3854c7+_0x1d0a30(0xf1,0x113,0x7c,0x8d)]));}}}let _0x237198=-(0x1dbf+0x9*0x84+-0x2262);const _0x362007=_0x1985a9[_0x4d6539(0x25d,0x253,0x250,0x19b)];if(_0x362007!==''&&_0x38a060[_0x1d0a30(0xa0,0xc5,0x134,0x4a)](_0x362007,null)&&!_0x38a060[_0x4d6539(0x1bb,0xe5,0x18e,0x208)](isNaN,Number(_0x362007))&&_0x38a060[_0x1d0a30(0x11a,0xcd,0xff,0x71)](_0x38a060[_0x4d6539(0x1ad,0x1bd,0x18e,0x1c3)](Number,_0x362007),-0x1*0x25af+0x1*0x24f+0x2360)){if(_0x38a060[_0x1d0a30(0x9b,0x31,0x4b,0x6)](_0x4d6539(0x164,0x1c0,0x1d9,0x20d),_0x38a060['dcNiy'])){_0x38a060[_0x1d0a30(0xd4,0x141,0xcb,0x64)](_0x12ab3e,_0x1d0a30(0x192,0xf3,0x23b,0x13a)+':\x20'+_0x28800e[_0x1d0a30(0xa4,0x7d,0x0,0xb5)]+('。请检查sdwebu'+_0x4d6539(0x130,0x19a,0x1b9,0x169)+_0x1d0a30(0x108,0x15e,0x127,0x17f))),_0x585c3e['completeTa'+'sk'](_0x1da38e,![]),_0x4659e4=null;throw new _0xf0f035(_0x1d0a30(0x192,0x229,0x156,0x1c0)+_0x1d0a30(0x42,-0x4b,-0x11,0x81)+_0x1d0a30(0x72,0x37,-0x33,-0xf)+_0x4d6539(0x1fb,0x2a3,0x24f,0x197));}else _0x237198=_0x38a060[_0x4d6539(0x2f4,0x350,0x2ee,0x30c)](Number,_0x362007);}let _0x4fa173={'prompt':_0x4b6447,'negative_prompt':_0xa1b8db,'sampler_name':_0x1985a9[_0x1d0a30(0xb6,0x79,0xae,0x165)+'8_samplerN'+'ame'],'scheduler':_0x1985a9[_0x4d6539(0x161,0x285,0x1fd,0x2b5)+_0x4d6539(0x30c,0x21c,0x29e,0x269)+'r'],'steps':_0x1985a9[_0x1d0a30(0x143,0xb7,0xfe,0x16c)],'cfg_scale':_0x1985a9[_0x4d6539(0x2af,0x27c,0x229,0x1c3)],'width':_0x4fcd12?_0x4fcd12:_0x1985a9[_0x1d0a30(0x13e,0x116,0x1a4,0x148)],'height':_0x121cd5?_0x121cd5:_0x1985a9['sd_cheight'],'restore_faces':_0x38a060['lQHMK'](_0x1985a9[_0x1d0a30(0x84,0x75,0x75,0x60)+'es'],_0x38a060['hvKZs']),'enable_hr':_0x1985a9['sd_chires_'+_0x1d0a30(0x4b,-0x44,-0x65,0x101)]==_0x1d0a30(0x62,0x33,0xf2,0xe8),'hr_upscaler':_0x1985a9[_0x1d0a30(0xb6,0x3f,0x154,0x123)+_0x1d0a30(0x65,0x62,0xab,0x1a)],'hr_scale':_0x1985a9[_0x1d0a30(0x91,0x6a,0x34,0x12a)+'e_factor'],'hr_additional_modules':[],'denoising_strength':_0x1985a9['sd_cdenois'+_0x1d0a30(0x18a,0x19f,0x1fa,0x161)+'th'],'hr_second_pass_steps':_0x1985a9[_0x4d6539(0x272,0x1b2,0x232,0x221)+_0x4d6539(0x22d,0x24a,0x20c,0x185)],'seed':_0x237198,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x1985a9[_0x4d6539(0x164,0x11e,0x1a4,0x22e)+_0x1d0a30(0x19a,0xfb,0xf7,0x1bd)]),'sd_vae':_0x1985a9[_0x1d0a30(0xb6,0xa5,0xbd,0xa8)+_0x4d6539(0x2d3,0x2af,0x236,0x194)]},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x38a060[_0x1d0a30(0x47,0x6a,0xed,0xa9)](addLog,'restore_fa'+'ces\x20脸部修复\x20为'+_0x4fa173[_0x4d6539(0x295,0x21c,0x2c8,0x33b)+_0x1d0a30(0xff,0x119,0x83,0x18c)]),addLog(_0x1d0a30(0x14c,0x1da,0x12c,0x1f4)+'高清修复\x20为'+_0x4fa173[_0x4d6539(0x255,0x232,0x2cc,0x234)]);_0x38a060['lQHMK'](_0x1985a9[_0x1d0a30(0x44,0x3a,-0xb,0x58)+'ler'],_0x38a060[_0x4d6539(0x194,0x1d5,0x1ff,0x235)])&&(_0x38a060[_0x1d0a30(0x119,0x142,0x150,0x134)](addLog,_0x4d6539(0x1ad,0x15e,0x1a2,0xf3)+_0x1d0a30(0x12c,0x16b,0x11c,0x86)),_0x4fa173=_0x38a060[_0x1d0a30(0x93,0x61,0xa6,0x145)](deepMerge,_0x4fa173,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x38a060[_0x1d0a30(0x90,0x66,0x59,0x9)]}]}}}));const _0x159fe2='\x0a---\x0a###\x20生'+_0x1d0a30(0xf5,0x131,0x18f,0x1a2)+_0x4d6539(0x286,0x1f5,0x1e6,0x23f)+_0x4d6539(0x1e9,0x1c7,0x1c9,0x122)+_0x4b6447+(_0x4d6539(0x173,0x1a8,0x1a6,0x238)+'(Negative\x20'+_0x4d6539(0x265,0x24b,0x1d1,0x139)+'\x20')+_0xa1b8db+(_0x4d6539(0x34c,0x24c,0x2e2,0x2f4)+'(Sampler):'+_0x1d0a30(0x4d,0xee,0x4b,0xb0))+_0x4fa173[_0x4d6539(0x219,0x1a4,0x22e,0x22e)+'me']+(_0x4d6539(0x279,0x27d,0x296,0x21e)+_0x4d6539(0x250,0x218,0x24a,0x2ab))+_0x4fa173[_0x1d0a30(0xc5,0xdb,0x42,0xcd)]+('\x0a-\x20**CFG\x20S'+_0x4d6539(0x34b,0x244,0x2c5,0x317))+_0x4fa173[_0x4d6539(0x14d,0x1d5,0x207,0x2bd)]+('\x0a-\x20**尺寸\x20(S'+_0x4d6539(0x1fd,0x2b9,0x23b,0x2f5))+_0x4fa173[_0x1d0a30(0x15d,0x175,0x1f5,0x16c)]+'x'+_0x4fa173['height']+(_0x1d0a30(0x3e,-0x7c,0xa4,0xd4)+'eed):**\x20')+(_0x4fa173[_0x1d0a30(0x48,0x99,0x57,-0x18)]===-(0x2*0xaab+0x732+-0x43*0x6d)?_0x38a060[_0x1d0a30(0x7b,0xd0,0x12,0x63)]:_0x4fa173[_0x1d0a30(0x48,0xa4,0x5d,0x9)])+(_0x4d6539(0x29e,0x1b9,0x204,0x264)+_0x4d6539(0x2c8,0x2ab,0x247,0x282))+_0x1985a9[_0x4d6539(0x237,0x16f,0x1fd,0x1bf)+'8_model']+(_0x1d0a30(0xe0,0x127,0xf6,0x170)+'*\x20')+_0x4fa173[_0x1d0a30(0x4e,0x104,-0x13,0x105)+_0x4d6539(0x17b,0x209,0x1db,0x1df)][_0x1d0a30(0x1a8,0x224,0x1b6,0x1dd)]+(_0x4d6539(0x1a3,0x194,0x1b1,0x15e)+_0x1d0a30(0xc4,0xc5,0x120,0x61))+_0x4fa173['override_s'+'ettings'][_0x1d0a30(0x141,0x183,0x14b,0x193)+'at_last_la'+'yers']+('\x0a-\x20**高清修复\x20'+'(Hires\x20Fix'+_0x4d6539(0x1ed,0x1a5,0x1d0,0x255))+_0x4fa173[_0x4d6539(0x2a3,0x343,0x2cc,0x2ba)]+(_0x1d0a30(0xfe,0x17b,0x73,0x15b)+'(Upscale\x20F'+_0x4d6539(0x1a5,0x14d,0x19d,0x16f))+_0x4fa173[_0x1d0a30(0x14a,0x1c8,0x1a4,0xb1)]+('\x0a-\x20**重绘幅度\x20'+'(Denoising'+_0x4d6539(0x207,0x319,0x28e,0x2c5)+_0x1d0a30(0x171,0x1ca,0x18e,0x193))+_0x4fa173[_0x4d6539(0x177,0x17d,0x199,0x20e)+'strength']+('\x0a-\x20**脸部修复\x20'+_0x4d6539(0x25e,0x2c2,0x26b,0x291)+_0x1d0a30(0xe6,0x44,0x76,0xbc))+_0x4fa173[_0x1d0a30(0x181,0x1f8,0x166,0x18a)+_0x1d0a30(0xff,0xf3,0xc2,0xc5)]+('\x0a-\x20**ADeta'+'iler:**\x20')+_0x38a060['lQHMK'](_0x1985a9[_0x4d6539(0xf0,0x171,0x18b,0x211)+'ler'],_0x38a060[_0x1d0a30(0xb8,0x121,0x86,0xee)])+_0x4d6539(0x263,0x2c6,0x2bb,0x311);addLog(_0x159fe2),_0x38a060[_0x1d0a30(0x199,0x13c,0x251,0x1ed)](addLog,_0x4d6539(0x159,0x29e,0x205,0x24b)+'数为'+JSON[_0x1d0a30(0xed,0x19c,0x5f,0x1a6)](_0x4fa173)),console[_0x1d0a30(0xc8,0x120,0x17c,0xf7)](_0x38a060['GJQVi'],_0x4fa173);while(!window[_0x4d6539(0x212,0x2d4,0x2a5,0x2ee)]){await _0x38a060[_0x1d0a30(0xb3,0x4d,0x7f,0x15c)](sleep,0x1*-0x6ff+-0x11*0x1b+0xcb2);};try{window[_0x1d0a30(0x15e,0x1aa,0xf3,0x209)]=![],taskQueue[_0x1d0a30(0xfb,0x111,0x150,0x75)+'us'](_0x40e55f,_0x38a060[_0x4d6539(0x316,0x2cf,0x2f3,0x377)]);if(_0x38a060[_0x1d0a30(0x1b0,0x1af,0x10d,0x1bb)](_0x1985a9[_0x4d6539(0x2dd,0x327,0x2a7,0x2db)],'jiuguan')){if(_0x38a060['eDnMG'](_0x38a060[_0x4d6539(0x181,0x19f,0x1c1,0x130)],_0x1d0a30(0x188,0x165,0x23f,0x203))){_0x38a060[_0x1d0a30(0x199,0x1a6,0xf3,0x1b9)](_0x2e8d00,_0x38a060[_0x1d0a30(0xa5,0x35,0xa0,0xd2)]);throw new _0x507a42('任务已取消');}else{if(!taskQueue[_0x1d0a30(0x10f,0xdf,0x190,0x143)+_0x4d6539(0x24a,0x268,0x21f,0x1f8)](_0x40e55f)){if(_0x38a060['RykCl'](_0x38a060[_0x4d6539(0x164,0x13e,0x1a8,0x1ac)],_0x38a060[_0x4d6539(0x1bb,0x27d,0x228,0x282)])){_0x38a060[_0x1d0a30(0xb3,0xea,0x59,0xd3)](addLog,_0x38a060['mCyFj']),eventSource[_0x4d6539(0x233,0x1f4,0x237,0x1e6)](_0x38a060[_0x4d6539(0x2a5,0x1c8,0x21c,0x1e4)]);throw new Error(_0x38a060[_0x4d6539(0x1e7,0x277,0x23f,0x2e7)]);}else _0x285cb0['on'](_0x473bd5[_0x1d0a30(0x136,0x144,0xc8,0xc0)+_0x1d0a30(0xa8,0x144,0x13,0x15b)+'ST'],_0x56919e),_0x38a060[_0x4d6539(0x2ab,0x21f,0x21b,0x27a)](_0x507a76,_0x38a060[_0x4d6539(0x194,0x177,0x1f8,0x19c)]);}_0x4fa173[_0x1d0a30(0x86,0x10e,0x3d,0x30)]=_0x537fb1,console[_0x1d0a30(0xc8,0x14a,0xc7,0xff)](_0x38a060[_0x4d6539(0x242,0x1c4,0x21a,0x1df)],_0x1985a9[_0x1d0a30(0x110,0x57,0x5c,0x6c)+_0x4d6539(0x2b2,0x2fd,0x2af,0x2d5)]),_0x4fa173[_0x4d6539(0x254,0x332,0x2ad,0x24c)]=_0x1985a9[_0x1d0a30(0x110,0xd3,0xa0,0x1c4)+_0x4d6539(0x28e,0x23f,0x2af,0x208)]?_0x1985a9[_0x4d6539(0x2e2,0x310,0x257,0x2fd)+_0x4d6539(0x33e,0x324,0x2af,0x308)]:'';const _0x13c302=await _0x38a060[_0x4d6539(0x36f,0x2d3,0x2e9,0x233)](fetch,_0x38a060[_0x4d6539(0x244,0x2bf,0x2d0,0x369)],{'method':_0x38a060[_0x1d0a30(0xa6,0x97,0x11c,0x145)],'headers':_0x38a060[_0x4d6539(0x207,0x21a,0x28c,0x27b)](getRequestHeaders,window['token']),'body':JSON[_0x1d0a30(0xed,0xd5,0x129,0x122)](_0x4fa173)});if(!_0x13c302['ok']){if(_0x38a060[_0x4d6539(0x212,0x274,0x1bc,0x1e4)]!==_0x4d6539(0x324,0x21c,0x287,0x270)){const _0x4124d2=await _0x13c302['text']();_0x38a060[_0x4d6539(0x1b2,0x252,0x26c,0x2f7)](addLog,'酒馆\x20返回错误。状态'+'码:\x20'+_0x13c302[_0x4d6539(0x181,0x263,0x1b7,0x23a)]+_0x1d0a30(0x97,0x2f,0x8d,-0x8)+_0x4124d2),console[_0x1d0a30(0xc8,0x85,0x166,0x5b)](_0x38a060[_0x1d0a30(0xbf,0xff,0x44,0x84)],_0x4124d2);throw new Error(_0x4d6539(0x2a3,0x211,0x224,0x2d5)+_0x13c302[_0x4d6539(0x226,0x206,0x1b7,0x16a)]+_0x1d0a30(0x17c,0xed,0x231,0x1c1)+_0x4124d2);}else _0x1e40e9[_0x1d0a30(0xcb,0x109,0x84,0xf8)+_0x1d0a30(0x15b,0x1cc,0x1bd,0x15c)]=!![],_0x38a060[_0x1d0a30(0xea,0x19f,0xd5,0x38)](_0x144698);}const _0x505ed1=await _0x13c302[_0x4d6539(0x1db,0x18d,0x1f5,0x18d)]();let _0x33ebb7='';try{if(_0x38a060[_0x1d0a30(0x11d,0x150,0x1d6,0x180)]!==_0x38a060[_0x1d0a30(0x128,0x1c5,0x126,0x175)]){const _0x57ee8b=JSON[_0x4d6539(0x2ae,0x29d,0x239,0x288)](_0x505ed1);_0x33ebb7=_0x57ee8b[_0x1d0a30(0x14e,0x14f,0x1bf,0xa0)][0x1b60+0x161*-0x6+0x5*-0x3d2];}else _0x38a060[_0x1d0a30(0xc2,0x29,0x40,0x1f)](_0x15ec35,_0x1d0a30(0x155,0x1ea,0x17b,0xb2)+_0x1d0a30(0x10a,0x88,0x117,0x5c)+_0x4d6539(0x297,0x1db,0x1df,0x169)),_0x23f2a4=_0x242cd6;}catch(_0x2e358b){addLog(_0x1d0a30(0x155,0xc4,0x16f,0x1fe)+_0x1d0a30(0x10a,0xec,0x19a,0xe5)+_0x1d0a30(0x98,0xbb,0x11b,0x147)),_0x33ebb7=_0x505ed1;}const _0x1b683a=_0x38a060[_0x1d0a30(0x45,-0x60,0xfb,0x57)](_0x38a060[_0x4d6539(0x21d,0x241,0x196,0xe5)],_0x33ebb7);_0x38a060['MQUGe'](addLog,_0x4d6539(0x1cc,0x27d,0x1f0,0x19e)+_0x4d6539(0x33d,0x359,0x2d3,0x318)+'L。'),_0x38a060[_0x4d6539(0x250,0x2a9,0x297,0x20b)](setTimeout,()=>{console['log'](_0x38a060[_0x4d480c(0x4ca,0x40a,0x474,0x3ba)]);function _0x4d480c(_0x57d193,_0x3375ce,_0x4dfccc,_0x5203bd){return _0x4d6539(_0x5203bd,_0x3375ce-0xd7,_0x4dfccc-0x1c2,_0x5203bd-0x27);}function _0x1e847b(_0x38abc9,_0x2c2816,_0x590a7c,_0x456461){return _0x1d0a30(_0x456461-0x76,_0x2c2816-0x173,_0x590a7c,_0x456461-0x148);}window[_0x1e847b(0x1b1,0x1c2,0x12a,0x1d4)]=!![];},extension_settings[extensionName][_0x1d0a30(0xac,0xdf,0xe,0xdb)+_0x4d6539(0x26b,0x2e4,0x248,0x280)]);;return taskQueue[_0x4d6539(0x29e,0x294,0x275,0x22e)+'sk'](_0x40e55f,!![]),currentTaskId=null,_0x38a060[_0x4d6539(0x383,0x2d7,0x2f7,0x337)](String(extension_settings[extensionName][_0x4d6539(0x16d,0x178,0x190,0x1e0)+_0x1d0a30(0x19e,0x199,0x24e,0x126)]),_0x38a060[_0x4d6539(0x1d3,0x28a,0x1ff,0x242)])&&(_0x1b683a=await _0x38a060[_0x4d6539(0x2bf,0x1e0,0x243,0x21b)](convertImageToJpeg,_0x1b683a)),{'image':_0x1b683a,'change':_0x38a060[_0x1d0a30(0xde,0x35,0x196,0x31)](_0x4c0898,'')};}}else{if(!taskQueue[_0x1d0a30(0x10f,0xca,0xa0,0xce)+_0x4d6539(0x29f,0x2b5,0x21f,0x241)](_0x40e55f)){addLog(_0x38a060['mCyFj']);throw new Error(_0x38a060[_0x1d0a30(0xf8,0xe2,0x12f,0xde)]);}const _0x1487a2=new URL(_0x38a060[_0x1d0a30(0x45,0x14,-0x3,0x45)](_0x537fb1,_0x38a060[_0x1d0a30(0x169,0x1bb,0x115,0x116)]));window[_0x1d0a30(0x15e,0xb1,0x188,0x190)]=![];const _0x2a342c=await _0x38a060[_0x1d0a30(0x150,0x15d,0x171,0x159)](fetch,_0x1487a2,{'method':_0x38a060[_0x1d0a30(0xa6,0x121,0xc5,0x68)],'body':JSON['stringify'](_0x4fa173),'headers':_0x38a060[_0x4d6539(0x1ce,0x2dc,0x25f,0x26b)](getDirectHeaders,_0x38a060[_0x4d6539(0x208,0x1af,0x1a1,0x23a)],getsdAuth())});setTimeout(()=>{function _0x55c61b(_0x5a1e13,_0x4b94c1,_0x3fd908,_0x2f81e8){return _0x4d6539(_0x4b94c1,_0x4b94c1-0x17,_0x3fd908-0x193,_0x2f81e8-0x1b2);}console[_0x55c61b(0x429,0x433,0x3a2,0x43d)](_0x23c7c0(-0x1be,-0x1ef,-0x11b,-0x202)+_0x55c61b(0x35d,0x358,0x39d,0x35b));function _0x23c7c0(_0x36aad1,_0x1316e8,_0x324748,_0x2772c4){return _0x4d6539(_0x324748,_0x1316e8-0x164,_0x36aad1- -0x39a,_0x2772c4-0xa1);}window[_0x55c61b(0x48c,0x489,0x438,0x466)]=!![];},extension_settings[extensionName][_0x4d6539(0x29b,0x198,0x1f3,0x157)+'terval']);;if(!_0x2a342c['ok']){if(_0x38a060[_0x4d6539(0x310,0x2f8,0x2e6,0x2a4)](_0x4d6539(0x23b,0x149,0x1f7,0x24b),_0x4d6539(0x2ab,0x184,0x1f7,0x27d))){const _0x147bdd=_0x4d6539(0x17f,0x2bf,0x22f,0x276)+_0x1d0a30(0x198,0x101,0x19a,0x237)+_0x474db0+_0x4d6539(0x13f,0x1cc,0x1ab,0x230)+_0x39e80e[_0x4d6539(0x179,0x283,0x1eb,0x175)];_0x3722b9(_0x1d0a30(0xbc,0x2c,0x6c,0x144)+_0x147bdd),_0x9a683c[_0x1d0a30(0x15c,0xe3,0x1e8,0x15d)](_0x38a060['BFjwt'],_0x5c703f);const _0x328f98={};_0x328f98['id']=_0x5c5a59,_0x328f98[_0x4d6539(0x26f,0x27d,0x26a,0x243)]=![],_0x328f98['error']=_0x1238b7[_0x1d0a30(0xa4,0x118,0x40,0xe)],_0x328f98[_0x4d6539(0x1c9,0x297,0x23a,0x24d)]=_0x3edf01,_0x514510['emit'](_0x1f7300[_0x1d0a30(0x136,0xd4,0x15a,0x11b)+_0x1d0a30(0x41,-0x2e,0xbd,-0x1d)+_0x1d0a30(0xce,0x14,0xd1,0x165)],_0x328f98),_0x38a060[_0x1d0a30(0x156,0x201,0x192,0xc0)](_0x39b9a4,'发送SD生图失败响应'+_0x4d6539(0x14f,0x1c8,0x1d6,0x18b)+_0x4f2cc8+')');}else{const _0x33a19b=await _0x2a342c[_0x1d0a30(0xae,0xc6,0xad,0xc)]();addLog('SD\x20API\x20返回错'+_0x4d6539(0x237,0x233,0x19e,0x1f1)+_0x2a342c['status']+_0x4d6539(0x253,0x21d,0x1de,0x13b)+_0x33a19b),console['log'](_0x38a060[_0x4d6539(0x230,0x156,0x206,0x1cc)],_0x33a19b);throw new Error(_0x1d0a30(0xdd,0x112,0xf6,0x15b)+_0x2a342c['status']+_0x1d0a30(0x17c,0x156,0x1af,0xd7)+_0x33a19b);}}const _0x560a07=await _0x2a342c[_0x1d0a30(0x164,0x206,0x18b,0x13f)]();if(!_0x560a07[_0x4d6539(0x20e,0x307,0x295,0x2d4)]||_0x38a060[_0x1d0a30(0xec,0x138,0x96,0x145)](_0x560a07['images'][_0x4d6539(0x244,0x275,0x266,0x2a5)],-0x19b7+-0x13*0x24+0x1c63*0x1)){if(_0x38a060['ZYPNe'](_0x38a060['RjfPF'],_0x38a060['gUbMM'])){_0x38a060[_0x1d0a30(0x16f,0x226,0x168,0xe2)](_0xba9cd7,_0x18a758);return;}else throw new Error('API响应中未找到图'+'像数据。');}const _0x5ec821=_0x560a07[_0x1d0a30(0x14e,0x109,0x165,0xb4)][-0x1*-0x1fcb+-0x173*-0x7+-0x29f0],_0x4faa8c=_0x38a060['ToSze'](_0x4d6539(0x286,0x294,0x27b,0x335)+_0x4d6539(0x2c9,0x241,0x218,0x1fc)+'4,',_0x5ec821);addLog(_0x38a060['enEeJ']),taskQueue[_0x4d6539(0x2b2,0x270,0x275,0x2eb)+'sk'](_0x40e55f,!![]),currentTaskId=null;_0x38a060[_0x1d0a30(0x15a,0x128,0x18d,0x163)](_0x38a060['oezFe'](String,extension_settings[extensionName][_0x1d0a30(0x49,0x57,0xd4,0x78)+_0x1d0a30(0x19e,0x258,0x235,0x242)]),_0x1d0a30(0x62,0xa7,0xae,0xb2))&&(_0x4faa8c=await convertImageToJpeg(_0x4faa8c));const _0x224284={};return _0x224284['image']=_0x4faa8c,_0x224284[_0x1d0a30(0x7f,0xf3,0x8e,0xa0)]=_0x1dca4f||'',_0x224284;}}catch(_0x1370a8){const _0x9792d0=_0x38a060[_0x1d0a30(0x19c,0x20e,0xf2,0x128)][_0x1d0a30(0x55,0x14,-0x1c,-0x4c)]('|');let _0x4b37ae=0x1*-0xb2f+-0xde0+0x190f*0x1;while(!![]){switch(_0x9792d0[_0x4b37ae++]){case'0':throw _0x1370a8;continue;case'1':currentTaskId=null;continue;case'2':window[_0x4d6539(0x27f,0x2ce,0x2a5,0x230)]=!![];continue;case'3':_0x38a060[_0x1d0a30(0x7e,0x19,0xa5,0x6d)](addLog,_0x4d6539(0x205,0x286,0x270,0x2b2)+_0x1370a8[_0x1d0a30(0xa4,0xa0,0xe2,0x9b)]);continue;case'4':if(_0x38a060[_0x1d0a30(0x15a,0x14c,0xba,0x207)](_0x1370a8[_0x4d6539(0x1d5,0x1e4,0x1eb,0x271)],_0x38a060[_0x1d0a30(0xf8,0xab,0x12c,0x132)])){}else taskQueue[_0x1d0a30(0x12e,0x199,0x199,0x1bb)+'sk'](_0x40e55f,![]);continue;case'5':console[_0x4d6539(0x27f,0x242,0x2a3,0x335)](_0x38a060[_0x4d6539(0x1bb,0x189,0x240,0x1e9)],_0x1370a8);continue;}break;}}}async function sdGenerate(_0x56499e){function _0x42fced(_0xe66728,_0xb8a079,_0x1cef83,_0x996e72){return _0x3570(_0x996e72-0x2b6,_0xb8a079);}const _0x24b934={'Utglz':function(_0x457c06,_0x3c957b){return _0x457c06(_0x3c957b);},'kAdWn':function(_0x16a21f,_0x5460bf){return _0x16a21f(_0x5460bf);},'WvCeD':_0x42fced(0x520,0x52c,0x5e8,0x573),'yxTST':function(_0x11ff35,_0x53c5b2){return _0x11ff35===_0x53c5b2;},'rklsl':_0x42fced(0x535,0x5dd,0x512,0x56b),'vthjL':function(_0x2bcef6,_0x4bbe72){return _0x2bcef6(_0x4bbe72);},'VyozV':function(_0x4fe599,_0x37f386,_0x27de13,_0x3ffb99){return _0x4fe599(_0x37f386,_0x27de13,_0x3ffb99);},'AmBiD':function(_0x3e4a18,_0x1590d2){return _0x3e4a18(_0x1590d2);},'ZDIVE':function(_0x169025,_0x405a1e){return _0x169025(_0x405a1e);},'uYkpW':function(_0x35a8de,_0x277941){return _0x35a8de(_0x277941);},'FmEqJ':_0x29bd4a(0x4f0,0x591,0x64a,0x648)+_0x29bd4a(0x5be,0x5f4,0x589,0x5e6)+_0x42fced(0x471,0x475,0x5a9,0x516),'Hwaua':function(_0x1949a1,_0x4dad2b){return _0x1949a1(_0x4dad2b);}},{id:_0x44012d,prompt:_0x34fe72,width:_0x345081,height:_0x5d2682,change:_0x4d1f02}=_0x56499e;_0x24b934[_0x42fced(0x587,0x49c,0x56a,0x4cc)](addLog,'收到SD生图请求\x20('+_0x29bd4a(0x61d,0x606,0x6b1,0x638)+_0x44012d+(_0x29bd4a(0x5f2,0x604,0x552,0x672)+':\x20')+_0x34fe72+(_0x4d1f02?_0x29bd4a(0x57e,0x618,0x60b,0x694)+'\x20'+_0x4d1f02:''));if(_0x4d1f02&&_0x4d1f02['includes'](_0x24b934[_0x42fced(0x5b5,0x624,0x58b,0x5a6)])){bananaGenerate(_0x56499e);return;}function _0x29bd4a(_0x2bde7f,_0x24d618,_0x13e2e3,_0x4d5b4d){return _0x3570(_0x24d618-0x339,_0x13e2e3);}try{if(_0x24b934[_0x42fced(0x5ee,0x5a5,0x5bc,0x575)](_0x24b934[_0x29bd4a(0x680,0x675,0x5e7,0x5e3)],_0x29bd4a(0x5b5,0x5ee,0x590,0x661))){const {image:_0x5b1a87,change:_0x4a32b9}=await _0x24b934[_0x42fced(0x599,0x69a,0x65f,0x5e8)](generateSDImage,{'prompt':_0x34fe72,'width':_0x345081,'height':_0x5d2682,'change':_0x4d1f02});if(extension_settings[extensionName][_0x42fced(0x637,0x570,0x532,0x5d4)]!='0'){const _0xd3bc02={};_0xd3bc02[_0x42fced(0x57b,0x4f0,0x51f,0x4c3)]=_0x4a32b9,await _0x24b934['VyozV'](setItemImg,_0x34fe72,_0x5b1a87,_0xd3bc02),_0x24b934[_0x29bd4a(0x583,0x63e,0x6a3,0x6e5)](addLog,'图像已存入数据库\x20f'+_0x42fced(0x541,0x52a,0x590,0x558)+'\x20'+_0x34fe72);}else _0x24b934[_0x29bd4a(0x568,0x60d,0x5db,0x5f7)](addLog,_0x29bd4a(0x590,0x5dd,0x611,0x67c)+'库');const _0x2d3e08={};_0x2d3e08['id']=_0x44012d,_0x2d3e08[_0x29bd4a(0x649,0x5ea,0x549,0x5cb)]=!![],_0x2d3e08[_0x29bd4a(0x4d1,0x51b,0x471,0x497)]=_0x5b1a87,_0x2d3e08[_0x29bd4a(0x502,0x5ba,0x63f,0x5cc)]=_0x34fe72,_0x2d3e08['change']=_0x4a32b9,eventSource[_0x42fced(0x563,0x511,0x57e,0x534)](EventType['GENERATE_I'+_0x29bd4a(0x4b1,0x508,0x5a8,0x557)+_0x29bd4a(0x626,0x595,0x639,0x58d)],_0x2d3e08),_0x24b934['uYkpW'](addLog,_0x42fced(0x53b,0x448,0x455,0x4e2)+_0x29bd4a(0x501,0x556,0x5fb,0x607)+_0x44012d+')');}else _0x51b447[_0x42fced(0x590,0x479,0x536,0x50f)+_0x42fced(0x4f5,0x500,0x56f,0x59f)]&&(_0x36a29e[_0x29bd4a(0x557,0x53b,0x486,0x53e)+'ener'](_0x3b5232[_0x42fced(0x626,0x585,0x4cf,0x57a)+_0x29bd4a(0x583,0x56f,0x4fa,0x58a)+'ST'],_0xf5c2aa),_0x13e6a1[_0x29bd4a(0x5f1,0x592,0x537,0x58d)+_0x42fced(0x620,0x632,0x4ef,0x59f)]=![],_0x24b934[_0x29bd4a(0x5a2,0x602,0x6b9,0x576)](_0x21347b,_0x42fced(0x541,0x58a,0x598,0x5d9)+_0x29bd4a(0x61d,0x5e9,0x599,0x58b)));}catch(_0x80d4ae){const _0x2f915e='SD生图流程捕获到异'+'常\x20(ID:\x20'+_0x44012d+_0x29bd4a(0x4ee,0x52b,0x48c,0x5c8)+_0x80d4ae[_0x42fced(0x475,0x58d,0x45d,0x4e8)];_0x24b934[_0x42fced(0x637,0x54e,0x606,0x5bb)](addLog,_0x29bd4a(0x5b7,0x583,0x533,0x5a4)+_0x2f915e),console[_0x42fced(0x58d,0x5c2,0x60c,0x5a0)](_0x24b934[_0x29bd4a(0x566,0x52d,0x537,0x4ce)],_0x80d4ae);const _0x4ff2c8={};_0x4ff2c8['id']=_0x44012d,_0x4ff2c8[_0x29bd4a(0x53c,0x5ea,0x5c6,0x630)]=![],_0x4ff2c8['error']=_0x80d4ae[_0x29bd4a(0x4fd,0x56b,0x537,0x60e)],_0x4ff2c8['prompt']=_0x34fe72,eventSource['emit'](EventType[_0x42fced(0x523,0x519,0x4d0,0x57a)+'MAGE_RESPO'+_0x29bd4a(0x616,0x595,0x517,0x60a)],_0x4ff2c8),_0x24b934[_0x42fced(0x559,0x483,0x452,0x4a7)](addLog,'发送SD生图失败响应'+_0x29bd4a(0x57d,0x556,0x535,0x4bf)+_0x44012d+')');}}function initializeSDListener(){function _0x39cab5(_0x41e750,_0x59788c,_0x1375a7,_0x286b31){return _0x3570(_0x41e750-0x39c,_0x286b31);}const _0x4c67d8={};_0x4c67d8[_0x345391(0x1e2,0x251,0x281,0x2c3)]=_0x345391(0x2e7,0x376,0x2c3,0x221)+'已初始化。';const _0x19e504=_0x4c67d8;eventSource['on'](EventType['GENERATE_I'+_0x39cab5(0x5d2,0x551,0x5f8,0x557)+'ST'],sdGenerate);function _0x345391(_0x39b89e,_0x1e9ef6,_0x3db12e,_0x4a8995){return _0x3570(_0x3db12e- -0x60,_0x4a8995);}addLog(_0x19e504[_0x345391(0x1ef,0x2f1,0x281,0x30e)]);}export async function replaceWithSd(){function _0x38a956(_0x2d3ecf,_0x320003,_0x321e99,_0x46577f){return _0x3570(_0x321e99-0x2cf,_0x320003);}const _0x289de7={'XEAgT':function(_0x313cea,_0x42ccd4){return _0x313cea+_0x42ccd4;},'JXzjP':function(_0x5c1c4b,_0x51a7c8){return _0x5c1c4b+_0x51a7c8;},'AusBn':function(_0x182292,_0x16c8ba){return _0x182292(_0x16c8ba);},'XFDNJ':function(_0x533c41,_0x2cc0b1){return _0x533c41!==_0x2cc0b1;},'HNAdm':_0x38a956(0x62d,0x560,0x5cf,0x608),'Ulgdc':function(_0x492fc3){return _0x492fc3();},'pihbj':function(_0x556eb7,_0x2ed9cf){return _0x556eb7!==_0x2ed9cf;},'gHiFT':_0x38a956(0x4d6,0x42a,0x4dd,0x4b2),'TXGVj':function(_0x47b3ef,_0x465f17){return _0x47b3ef(_0x465f17);},'xKWNu':'SD\x20生图事件监听器'+_0x38a956(0x567,0x568,0x57f,0x5d9)};function _0x228cb3(_0xec3e9,_0x2ed978,_0x14c7e8,_0x4a2490){return _0x3570(_0xec3e9-0x24e,_0x4a2490);}extension_settings[extensionName]['mode']=='sd'?(!window[_0x228cb3(0x4a7,0x550,0x441,0x423)+_0x38a956(0x616,0x5bc,0x5b8,0x5d4)]&&(_0x289de7[_0x228cb3(0x469,0x455,0x4ce,0x430)](_0x38a956(0x4a1,0x4a1,0x4c4,0x553),_0x289de7[_0x228cb3(0x4c0,0x42f,0x4f2,0x4af)])?(window[_0x228cb3(0x4a7,0x40a,0x4a0,0x4f4)+_0x38a956(0x5e5,0x653,0x5b8,0x57f)]=!![],initializeSDListener()):_0x1257c0['Character\x20'+_0x2ec489+'\x20Prompt']&&(_0x4f77f4=_0x289de7[_0x38a956(0x487,0x51b,0x50f,0x4c7)](_0x289de7[_0x228cb3(0x579,0x599,0x4f2,0x572)](_0xa7450e,',\x20'),_0x15361a[_0x228cb3(0x461,0x3c2,0x4e1,0x405)+_0x2dbca7+_0x38a956(0x533,0x581,0x54e,0x5c5)]))),_0x289de7[_0x228cb3(0x4ef,0x449,0x470,0x56f)](initializeImageProcessing)):_0x289de7['pihbj'](_0x228cb3(0x45c,0x41f,0x49d,0x4b3),_0x289de7[_0x228cb3(0x476,0x4d8,0x4e0,0x4c7)])?_0x43fcff['Character\x20'+_0x1fcd3c+_0x38a956(0x49a,0x56b,0x54e,0x51c)]&&(_0x123a11=_0x138ee5+',\x20'+_0x289de7[_0x228cb3(0x546,0x511,0x5d7,0x5c6)](_0x33c025,_0x5ecbad[_0x38a956(0x43a,0x466,0x4e2,0x44c)+_0x2b1576+_0x228cb3(0x4cd,0x4d0,0x53f,0x582)])):window[_0x228cb3(0x4a7,0x4ed,0x529,0x476)+_0x228cb3(0x537,0x564,0x5ce,0x51e)]&&(eventSource[_0x228cb3(0x450,0x46e,0x3b0,0x47a)+'ener'](EventType[_0x38a956(0x53b,0x5a2,0x593,0x583)+_0x228cb3(0x484,0x437,0x447,0x4f1)+'ST'],sdGenerate),window[_0x228cb3(0x4a7,0x4c9,0x505,0x457)+_0x228cb3(0x537,0x526,0x55e,0x4ae)]=![],_0x289de7[_0x228cb3(0x4fd,0x5ae,0x54e,0x454)](addLog,_0x289de7[_0x228cb3(0x491,0x489,0x52c,0x437)]));}