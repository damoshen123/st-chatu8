(function(_0x3e1ad7,_0x44f85d){function _0x575cb4(_0x516253,_0x3a4058,_0x427e9b,_0x482c3f){return _0xe681(_0x482c3f- -0x237,_0x3a4058);}const _0xe1e8f0=_0x3e1ad7();function _0x10cd42(_0x13f542,_0x2664a4,_0x45cd80,_0x4a8ddd){return _0xe681(_0x13f542-0x337,_0x2664a4);}while(!![]){try{const _0x2e246b=-parseInt(_0x575cb4(-0x7d,-0x195,-0x110,-0xe0))/(0x17d3+0x5ad*0x3+0x28d9*-0x1)+-parseInt(_0x575cb4(-0x18e,-0x27,-0x56,-0xbf))/(-0x16b9+-0x9*0x457+-0x16*-0x2cf)+parseInt(_0x575cb4(-0xc1,-0x10f,-0x5d,-0xc2))/(-0x24bc+0x164b+0xe74)+parseInt(_0x10cd42(0x5bf,0x534,0x578,0x5e5))/(0xcdf+-0x33c+-0x99f)*(parseInt(_0x575cb4(-0x49,-0x57,-0xb,-0xc5))/(0x22*0x2+-0x17e9+0x2*0xbd5))+-parseInt(_0x10cd42(0x47e,0x518,0x3e4,0x441))/(0x107a+0x1162+-0x21d6)+-parseInt(_0x10cd42(0x59e,0x587,0x502,0x52b))/(-0x1eaa+-0xef3+-0x17*-0x1fc)*(-parseInt(_0x575cb4(0x6a,-0x98,-0x4f,-0x69))/(-0x2577*-0x1+-0x4*-0x19+-0x25d3))+-parseInt(_0x10cd42(0x514,0x552,0x472,0x5d4))/(-0x5cb+0x1441+0x3*-0x4cf)*(-parseInt(_0x575cb4(0x29,0x8,-0x7c,-0xa7))/(-0x1*-0x2e7+-0x1098+0x25*0x5f));if(_0x2e246b===_0x44f85d)break;else _0xe1e8f0['push'](_0xe1e8f0['shift']());}catch(_0x2a1c13){_0xe1e8f0['push'](_0xe1e8f0['shift']());}}}(_0xdfaa,0x7dc56+0x49*0x905+0xe0a7));const _0x452046=(function(){const _0x4e52a9={};_0x4e52a9[_0x2611d8(0x281,0x328,0x294,0x3dd)]=_0x2611d8(0x301,0x269,0x30b,0x1b9);function _0x2611d8(_0x37c26a,_0x3aad36,_0x537af7,_0x3b082e){return _0xe681(_0x3aad36-0xc8,_0x3b082e);}_0x4e52a9[_0x2611d8(0x336,0x358,0x3e5,0x338)]=_0x2611d8(0x27f,0x237,0x236,0x1e3),_0x4e52a9[_0xab65a(0x376,0x2f1,0x293,0x3a9)]=_0xab65a(0x314,0x31c,0x2ce,0x386),_0x4e52a9[_0xab65a(0x32d,0x2ef,0x2ae,0x364)]=_0xab65a(0x1a9,0x1e0,0x1a5,0x249),_0x4e52a9[_0xab65a(0x215,0x216,0x27c,0x1fa)]='EUAEP';function _0xab65a(_0x475106,_0x1cc53d,_0x43726a,_0x690575){return _0xe681(_0x1cc53d-0x9b,_0x690575);}const _0x2b1312=_0x4e52a9;let _0x295bb7=!![];return function(_0x30bb2e,_0x128b53){const _0x118cf7={};_0x118cf7['cgCIg']=_0x2b1312['tZSlq'],_0x118cf7[_0x2a1c8d(0x429,0x48a,0x424,0x491)]=_0x2b1312[_0x2a1c8d(0x493,0x5ad,0x5aa,0x4db)],_0x118cf7['PxFOQ']=_0x2b1312['yqqdT'];function _0x1f1aa4(_0x1a5f6a,_0x345320,_0x24298c,_0x3a1bd9){return _0xab65a(_0x1a5f6a-0x19a,_0x3a1bd9- -0x1c5,_0x24298c-0xd9,_0x345320);}_0x118cf7[_0x1f1aa4(0x1e,0xcf,0x48,0xa7)]=_0x2b1312['nONIF'],_0x118cf7[_0x1f1aa4(0xa9,0x8e,0xe5,0x43)]=_0x2b1312[_0x1f1aa4(0x9b,0xaf,-0x42,0x51)];function _0x2a1c8d(_0xb7f7f2,_0x57d51b,_0x2cdc77,_0x45d744){return _0xab65a(_0xb7f7f2-0xde,_0x45d744-0x1b0,_0x2cdc77-0x166,_0x2cdc77);}const _0x3bb512=_0x118cf7,_0x40b0d2=_0x295bb7?function(){function _0x3afd20(_0x502c06,_0x2e7fa1,_0x3e6787,_0x29f1e0){return _0x2a1c8d(_0x502c06-0x1a4,_0x2e7fa1-0xcf,_0x2e7fa1,_0x29f1e0-0x130);}function _0x195a1b(_0x4ccd35,_0x5ae3a2,_0x1d2139,_0x5dddda){return _0x1f1aa4(_0x4ccd35-0x34,_0x5dddda,_0x1d2139-0x97,_0x1d2139- -0x158);}if(_0x3bb512[_0x3afd20(0x431,0x582,0x571,0x4e8)]===_0x3afd20(0x4f2,0x42e,0x545,0x47d)){if(_0x14e789[_0x3afd20(0x68f,0x6ad,0x5ba,0x5f9)]['includes'](_0x3bb512[_0x195a1b(0x5b,0x5,-0x6b,-0xc1)]))_0x59b253=_0x195a1b(-0xea,-0x52,-0x82,0x1a);else(_0x82903b[_0x3afd20(0x5e7,0x647,0x691,0x5f9)][_0x3afd20(0x490,0x508,0x538,0x4a9)](_0x3bb512[_0x3afd20(0x63d,0x592,0x61f,0x5c1)])||_0x1bcd91[_0x3afd20(0x62b,0x58e,0x64f,0x5f9)]['includes'](_0x3bb512[_0x195a1b(-0xa3,-0x45,-0x3f,-0x2a)]))&&(_0x41f8d0=_0x3bb512[_0x3afd20(0x50e,0x591,0x52e,0x54c)]);}else{if(_0x128b53){const _0x499de5=_0x128b53[_0x3afd20(0x4cb,0x57b,0x414,0x4bc)](_0x30bb2e,arguments);return _0x128b53=null,_0x499de5;}}}:function(){};return _0x295bb7=![],_0x40b0d2;};}()),_0x9a53b5=_0x452046(this,function(){const _0x862a4d={};_0x862a4d[_0x14d2dc(0x44f,0x389,0x4b0,0x3e9)]='(((.+)+)+)'+'+$';function _0x14d2dc(_0x4e307e,_0x532932,_0x2dd08a,_0x4de755){return _0xe681(_0x4e307e-0x314,_0x532932);}const _0x565467=_0x862a4d;function _0x3db2c2(_0x569a19,_0x2f01f2,_0x1cd8e6,_0x8df7d7){return _0xe681(_0x1cd8e6- -0x27f,_0x8df7d7);}return _0x9a53b5[_0x3db2c2(-0x66,-0x12b,-0x9e,-0x80)]()[_0x14d2dc(0x4e6,0x522,0x535,0x486)](_0x565467[_0x14d2dc(0x44f,0x3c8,0x3e4,0x413)])[_0x3db2c2(-0x10d,-0x4c,-0x9e,-0x4a)]()[_0x3db2c2(-0x10d,-0xb8,-0x121,-0x113)+'r'](_0x9a53b5)['search'](_0x565467[_0x14d2dc(0x44f,0x417,0x51d,0x464)]);});_0x9a53b5();import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';function _0xe681(_0x42629a,_0x5233a2){_0x42629a=_0x42629a-(-0x3ed*-0x6+-0x128*-0xe+-0x26c0);const _0x5b479a=_0xdfaa();let _0x3b9542=_0x5b479a[_0x42629a];if(_0xe681['bfQjCf']===undefined){var _0x5b0641=function(_0x19e493){const _0x445d13='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x6c7904='',_0x3d299e='',_0x42f0d3=_0x6c7904+_0x5b0641;for(let _0xdd99cd=0x42*0xd+0x11*0xad+-0xed7,_0x3c2c5e,_0x524e2e,_0x4e496a=-0xcf*0x12+0xc5b+0x233;_0x524e2e=_0x19e493['charAt'](_0x4e496a++);~_0x524e2e&&(_0x3c2c5e=_0xdd99cd%(0x17e2+-0x573+-0x126b)?_0x3c2c5e*(0x1007+0x79d+-0xc*0x1f3)+_0x524e2e:_0x524e2e,_0xdd99cd++%(-0x443*0x7+0x7e1+0x15f8))?_0x6c7904+=_0x42f0d3['charCodeAt'](_0x4e496a+(-0x8*-0x3f9+0x5bd*-0x3+0x1*-0xe87))-(-0x1954*0x1+-0x287+0x1be5)!==-0x117b*0x1+0x16b3*-0x1+0x282e?String['fromCharCode'](-0x1c*0xfe+-0x270e*-0x1+0x36d*-0x3&_0x3c2c5e>>(-(0x237+-0x13ea+0x11b5)*_0xdd99cd&0x11*-0x3d+0xd8+0x33b)):_0xdd99cd:-0x3*-0x8d3+-0x1*0x1c09+-0x50*-0x5){_0x524e2e=_0x445d13['indexOf'](_0x524e2e);}for(let _0x50e442=0x1*-0x5ba+-0x1*0xd9f+0xd*0x17d,_0x419975=_0x6c7904['length'];_0x50e442<_0x419975;_0x50e442++){_0x3d299e+='%'+('00'+_0x6c7904['charCodeAt'](_0x50e442)['toString'](0x14ec+0x26*0x30+-0x1bfc))['slice'](-(-0x1177+0xd34+0x445*0x1));}return decodeURIComponent(_0x3d299e);};_0xe681['bMkXac']=_0x5b0641,_0xe681['JxgWOu']={},_0xe681['bfQjCf']=!![];}const _0x2db1b8=_0x5b479a[0x3*-0xb2f+-0xf2f+0xc2f*0x4],_0x30cc2c=_0x42629a+_0x2db1b8,_0x32fd52=_0xe681['JxgWOu'][_0x30cc2c];if(!_0x32fd52){const _0x58c94a=function(_0x1a5a8e){this['QACUqx']=_0x1a5a8e,this['HnNrcH']=[0x1a35*-0x1+-0xe01*0x2+0x3638,-0x192+0x1*-0xd7a+-0x282*-0x6,0x1886+0x12a8*0x1+-0x2b2e],this['PdUFRQ']=function(){return'newState';},this['sSnJKg']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['eEDcjt']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x58c94a['prototype']['AHswFA']=function(){const _0x5e4f3c=new RegExp(this['sSnJKg']+this['eEDcjt']),_0x3dfd2c=_0x5e4f3c['test'](this['PdUFRQ']['toString']())?--this['HnNrcH'][0x1*-0x19ef+-0x8ff+0x22ef]:--this['HnNrcH'][-0x575*-0x7+-0xb*0x3d+-0x1*0x2394];return this['JeaZpY'](_0x3dfd2c);},_0x58c94a['prototype']['JeaZpY']=function(_0xbf19db){if(!Boolean(~_0xbf19db))return _0xbf19db;return this['PIHLKL'](this['QACUqx']);},_0x58c94a['prototype']['PIHLKL']=function(_0x5e4de7){for(let _0x29901f=0x152e+0x201f+-0x5*0xaa9,_0x4dccd2=this['HnNrcH']['length'];_0x29901f<_0x4dccd2;_0x29901f++){this['HnNrcH']['push'](Math['round'](Math['random']())),_0x4dccd2=this['HnNrcH']['length'];}return _0x5e4de7(this['HnNrcH'][0xc5d+0x238d+0x2*-0x17f5]);},new _0x58c94a(_0xe681)['AHswFA'](),_0x3b9542=_0xe681['bMkXac'](_0x3b9542),_0xe681['JxgWOu'][_0x30cc2c]=_0x3b9542;}else _0x3b9542=_0x32fd52;return _0x3b9542;}import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{setItemImg}from'./database.js';import{saveChatDebounced,saveSettingsDebounced,eventSource}from'../../../../../script.js';function _0xdfaa(){const _0x35eb20=['C05vCK8','DMLKzw8VD2vIBq','DMzrufG','CNvUBMLUzW','CuvWCLC','ExzRyLm','o2jHC2u2ncW','ihbYB21WDdOG','keLeoIa','zw1PDa','u2nLBMuGq29TCa','Bwz5DwK','cUwWUUwVUdOG','55sF5OIq5OIq5yQF5zon5BQuicHjra','yK9lzw0','C3rYAw5NAwz5','reHRu0O','6l2U6k+I6lAf5PE277YimtaWmoASOq','ue9tva','DxHwvKe','AgvPz2H0','zKLjA2G','AxPNCxu','6l2U6k+I5y6g5y+Y6k6W5B2v5PE25yE66zszoG','y2DdswC','yxbWBgLJyxrPBW','5lIT5PAT6k+35Rgc5AsX6lsLoG','q29UDgvUDc1uEq','EgLHBMnOzw5N','DxrmsK4','D29YA2vY','qw5Zuxa','vKXeswC','5yIW5PAh5lU25zcn44cc','ExvZAgu','AwDODa','whnbvwe','5lU75yQH5BEY5y+w5RAi','ihWG','zty0ioAvSoAnRUwKHoEqHUoaGG','D29YA2vYAwq','6k+VoIa','BMvNyxrPDMvFCa','C2LjrgO','ALjguK8','iIvZy2HLzhvSzq','B2z4Buu','Duj0C1O','55sO5lQo55sF5OIq55QevgfNoIa','vKzcC1q','x3nRAxa','CIuI','tufhrv9srvnqtW','BNHoEMi','77Yi5zcR57g75z6l5yY56ywn77Yj','y2HHBMDL','vvjm','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','Dxv0y0i','y2zNx2nVBwz5Dq','zLvLAeW','veHoEfe','l2fWAs9PBNrLCG','wNDjC2q','Bw9Kzq','tLnf','lcdOR6BMG4u6ia','rvzPu0W','uhHgt1e','C2vLza','cUI0N+MDOUApKoEKUUIVJtOG','vxn3Efu','ChjVBxb0','sLbyA1u','yMXVyG','Bu1Yq3O','C3vJy2vZCW','AgvHzgvYCW','uwXhBLu','zuvKAgO','sNLewgO','6lEZ6l+h6iQc54k55Ase55cg5A6m5OIq77Ym5BEY','EhfMAg4','CwTyD3q','zgHOuM0','BK9osuy','ANnVBG','ExfXzfq','C3vIzM9SzgvY','DxbKyxrLu3rHDa','yKv5rvG','zfPyC3O','re91wfO','uffcsu8','iIWGiNbYB21WDa','rvDktNm','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','DfPtBhe','CxvJs2O','AxbH','C0v1vw0','C3rHCNrZv2L0Aa','x3bYB21WDcuI','6k+35AgR5yAzq29TzNLvsq','n0vmBuToBq','pgXVCMe6','whLWs1a','6zsz6k+VoIa','ioEuN+wBVUA1GEEOI+oaGUwUOUAiT+ERR+s4UG','y29TzNL1Av9ZDa','5y+r6ycb55sF5zU+5AsX6lsL5zon5BQuicG','ANDbquO','BwfNzs1YzxnWBW','zwq6ia','ifbYB21WDa','zNL1AsK6ia','tNbABNC','AMntrw4','m3WYFdf8nhWW','BMfTzt0','Aw1Hz2uVz2LM','BNnL','ss4UlG','oJe+','Bg9N','ios4QUI3S+I/H+EAHoIkGUEcUE+8JoATO+wCQa','tuv5qKu','zM9YBwf0','cKngrYbty2fSzq','q2DIDvi','Adi2na','Ce5dA0u','D21zB1i','5PYQ6io95lUoqvbj5zon5BQu5lIT5OM+','zNHNzNa','BIuI','tuuLiG','ndiYntu4oe9dCufssq','C3rLChm','s3HqA28','Dg9Rzw4','wuLMsKu','AvfeD2i','DxjUigLTywDLia','jNn1yMzVBgrLCG','sLbKywS','6iQc54k55Ase55cgoIa','A3HRyve','5lQl5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw77Yi','C2jPEfG','ls0Tls0Tls0Tlq','v09SBe0','suTKCLa','6lsF6z2I5O+q56s66k+noIa','DgvUzxi','6k+noIa','rxjYB3iGz2vUzq','z2vUzxjHDguTAq','uxjIz1m','Ew5zqKe','C2nACxi','yu9kthy','Cgf5Bg9HzdiYmG','CMvWBgfJzufSBa','zMLSzw5HBwu','CMvTB3zLtgLZDa','zvndwKK','rM5Xtha','BwjYsMG','ueHfvK0','r0vorvjbvevFsq','C3bSAxq','ue9Hruy','ug56sey','uK9ozgy','qvfux2nVBwz5Dq','rxzdzxK','sw9IDeq','EYjJBgLLBNrFAq','C2zACuW','uvf0z0i','Bwv0Ag9K','DMfL','iIvZDgvWCYuI','yw5Ryw90DxbPyq','CMvZDwX0','zfzNwe4','y3qGy29TzNL1Aq','vfDQsvG','B2XVBNm','AeLYt0q','vxL5wum','Bwz5l2DLBMvYyq','whnItw4','zwL2svy','A1vZAeS','kerPDMLKzv9YBW','s3bkyNC','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi77Ym5Q2J','vevZrhy','y2fJAgu','Df9LBMq','5yYw5lI6igrHDgeGvvi','qxnMz2q','tKXIBLC','sw5MBW','ALznEue','C2nOzwr1BgvY','y29TzNL1Av9ZyW','zhrO','A2fVDhvWAwfU','BMfSA2y','z2LMCW','BgvUz3rO','5zU+54Mh55sF5OIq6l+h56Il5lIT5y+r55sF6zsz','EwHhuwy','C2fTCgXLCL9Uyq','EMfYuNG','6yEn5PIG5Bce6l+E5O6L','AML1z3vHBIbJBa','C3b5C1y','D2fYBG','ue5JtKC','Aw5JBhvKzxm','AgvKDwXLCG','iIvOzwLNAhqLiG','CMf0Aw5NigLTyq','sNPrCM8','y29TzNL1AxnHBq','zsuI','CM9TChq','5AQs5l2ticG','5Q2J6z2I5O+q56s66k+noIa','D212Bxm','rNjLEM0','v1j3vfu','uMrYwuW','5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','Ew5hwxK','tgfyA3i','5zU+54Mh55sF5OIq5OIq5yQFicHQAq','t1P0y1O','yxbWBhK','ug5erLe','zgLYzwn0ignVBq','ugn6s2S','DMLKzw8VBxa0','y2XPCa','mJG5ote1oerssgftzG','DhjPBq','tufYvue','rgPhvw8','AKfXrgy','6l+E5O6L5zco6ycj5OUP','uKfkD1G','Ew1czLO','vunqx2nVBwz5Dq','ChjVBxb0x2LK','y19XDwfUEMHVBG','5y+r6ycb5yIWienVBwz5vq','jNr5Cgu9B3v0Ca','q2HHCMfJDgvYia','suPLywK','txbcAvK','mZqZnZfNzxfSAe0','EvnYvw0','D3zcsMi','B3v0Chv0CW','iIvJzMDFC2nHBa','zxj0Eq','t2jZsfC','y29UC3rYDwn0BW','ALLuANC','ic0+ia','A1ngtfm','CMrJv3K','Aw1Hz2u','CM9WwvC','y194AwPPzq','y2LIvei','tufhrv9srvfvrq','y29TCgXLDgvuyq','tu9eruXFtKfnrq','swzWtMy','cI0Tls0Tls0Tlq','y29TzNL1Aq','v1zxq2i','C3rHDhvZ','Bxa0','ufvryw4','CMrmBNG','nwjAEeDuuW','iIvZzwvKjsi','ruDotuW','mJe2nJu0z0LLsLj6','D2LKDgG','5Qoa5Rwl5yIWia','mtmYmtm2nKjmC2jAEG','wKPiqwS','rgTXA0W','qwfMyuS','zMLSDgvY','5zgkic0TlqRMRApPNAlMJ5dNPlO','uhHdq3m','zgf0ys4','zhjMDeq','CMvHzefZrgf0yq','EujsvMi','EMHVBMCLiG','DwD1yw4Gy2XPzq','wMHyChG','AML1z3vHBG','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','B25N','r1zKswu','Dgv4Da','AgfZt3DUuhjVCa','s0HNCfy','Cg5N','54Mh5PwW5O2UicHQAxvNDq','u1nYr0y','nJy2mJCXmeL4yKfuva','y0jxwfG','sgLZDg9YEsbYzq','y29TzNL1AsdNLj/LM74','wKfVq2y','CMvZCg9UC2uY','y2zNx3nJywXL','cUATPEAvSdOG','ExvZAgvPzf9JBW','Cfr1Evu','rwfqwNy','B1D0sxG','Aw5PDgLHBgL6zq','D0rmAve','BuT5y1e','yxjYyxLcDwzMzq','5ywO6io95O+q56s66k+n57Yw6l6r5zMO','D2vIBq','q3POA3q','y29TzNL1AunHyW','rw5KCg9PBNqGza','6l2U6k+I5PE25y+r55sF5BYc5BI4oIa','CMvWBgfJzq','ntmZzwyZytmTmW','y2XPzw50','A2v5CW','C3vIC3rYAw5N','q2PhDvi','ywjOr0u','rMDNt0e','cUMhH+AGT+wzQdOG','rLDMzuS','zw5LCG','B3nPDgLVBG','lNnHzMv0zw5ZBW','y29TzNL1AwnHBG','y19Pzhf1yw56Aa','DxjS','zg9uyMO','wePXDuu','tezey28','Dfz5EhG','yw4Gy2XPzw50kq','AuPgrNi','x2XHC3rnzwrPyq','5QIH5z6l44cc','sLnptIdOP6pMNPdLPlhOTkxVViW','ExHUt2i','iIvJx2zLBNDLAq','5Ase55cg6l+E5O6L6yEn5PIG5BcelI4U','6k+35Rgc5BEL5l2C5RwbAwqGlsa','sxPUChm','zw9zuhe','6kEg6Akrie1jtuuG57g75z6l','vvbSuM0','B2jQzwn0sw5MBW','suq6ia','C2XAwee','qvbjiowtJEw6Los4REAYOEACIEwBVG','t3Pru0S','Aw1Hz2vZ','cI0TlsdNLj/LM77LJ4lMLBdMIQu','otK2nJK2zLnPrhnP','qvPmu3q','CxvLC3qGzMfPBa','qwXiwK8','C2vHCMnO','6i635y+w5zU+54Mh5AsX6lsLloEkTUAaGEEGGq','B25SB2fKzw5K','B21WDa','q29TzNLvssdMNi3LIQe','D0HQAxi','r1vWsMy','y19Mzw53zwK','zxjYB3i','z2u6','BgLUAW','ow1evfzctG','AwqGBM90ihjLDa','BwvZC2fNzq','ENDlweq','Dg9tDhjPBMC','zgf0ytPPBwfNzq','6l+E5O6L44cc','qvbjioIVT+AXGUwKSEI0PsaO','rKLXtxC','BfHAzhO','iIv2ywuLiG','BNqP44cc','cUENJEwTKdOG','w0nVBwz5vuLDia','tLbpwu0','A0v1CMK','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','y29TzNL1Av9Zzq','AxnwAwrLBW','BI9QC29U','q29TzNL1AuXPCW','r1f2A1u','A0L3BLi','re16Cge','CgfYC2u','CNm6','A0LwvgK','ksdLT7lMIjdLIP/OJRFLJ5BLUBBMOlZLVi8','l2HPC3rVCNKV','zgf0yq','tunVAu4','A1LTvxG','iIvPCgeLiG','ren4vwi'];_0xdfaa=function(){return _0x35eb20;};return _0xdfaa();}import{initializeImageProcessing}from'./iframe.js';import{taskQueue,TaskType}from'./taskQueue.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{processSkippedNodes}from'./settings/worker.js';async function replacepro(_0x311200,_0x534796){function _0x5d853a(_0x47c32e,_0xd44a06,_0x3c1c50,_0x442041){return _0xe681(_0x3c1c50- -0x1e6,_0x47c32e);}const _0x441b8d={'kUshK':_0x5d853a(0x117,0x6f,0xbb,-0x3),'DMzpa':function(_0x214f7e,_0x35daff){return _0x214f7e(_0x35daff);},'wvBJb':_0xf4d2e8(-0x24d,-0x212,-0x26a,-0x1a1)+_0xf4d2e8(-0x289,-0x239,-0x311,-0x17a),'HUYde':'\x22%sampler_'+'name%\x22','PUQan':function(_0x5bd1cb,_0x37f862){return _0x5bd1cb+_0x37f862;},'PnzHF':'\x22%width%\x22','spysV':function(_0x15ec80,_0x6e1dad){return _0x15ec80(_0x6e1dad);},'KpJbw':_0xf4d2e8(-0x306,-0x23d,-0x218,-0x1b1),'TWjIX':'\x22%negative'+_0x5d853a(0x140,0xf0,0x7f,0x9d),'dVgXN':'\x22%prompt%\x22','bOKem':'\x22%c_quanzh'+'ong%\x22','AZYkb':function(_0x1d65c9,_0x7352a){return _0x1d65c9(_0x7352a);},'uutcB':'\x22%c_idquan'+_0xf4d2e8(-0x12c,-0x1ea,-0x29f,-0x136),'vfQPX':'\x22%c_xijie%'+'\x22','oWtIx':function(_0x17f4d6,_0x11eb24){return _0x17f4d6(_0x11eb24);},'XJquE':_0x5d853a(0x9,0x11,-0x26,0x28)+'%\x22','PeAuv':'\x22%comfyuic'+_0x5d853a(-0x1a3,-0x75,-0xdf,-0x6e)+_0x5d853a(-0x4,0xc7,0xa0,0xfc),'dZXsz':function(_0x7d1e3f,_0x39b235){return _0x7d1e3f+_0x39b235;},'DOuXZ':_0x5d853a(0x71,0x79,0x17,-0x6d),'zwKXD':function(_0x3c12b9,_0x40702a){return _0x3c12b9+_0x40702a;},'DkqkL':function(_0x2cb724,_0x3f03d3){return _0x2cb724+_0x3f03d3;},'eSCZI':'\x22%clip%\x22','EWJNs':function(_0xd3ef80,_0x17da9e){return _0xd3ef80+_0x17da9e;}};console[_0xf4d2e8(-0x8e,-0xf2,-0x1ca,-0xb8)](_0x441b8d[_0x5d853a(-0x116,-0x88,-0xd4,-0x177)],_0x311200),_0x534796=_0x534796[_0x5d853a(0x149,0xd8,0xbc,0x95)](_0xf4d2e8(-0x136,-0x1fa,-0x1de,-0x1df),_0x441b8d[_0xf4d2e8(-0x114,-0x179,-0x21b,-0x24c)](Number,_0x311200['seed'])),_0x534796=_0x534796[_0xf4d2e8(-0x19e,-0xcb,-0xd5,-0xc)](_0x5d853a(-0x18e,-0x17b,-0xe0,-0xba),Number(_0x311200[_0xf4d2e8(-0x44,-0xe4,-0xa6,-0x11e)])),_0x534796=_0x534796[_0xf4d2e8(-0x42,-0xcb,-0x103,-0x21)](_0x441b8d[_0x5d853a(-0xe,-0xd4,-0x8d,-0x5f)],_0x441b8d['DMzpa'](Number,_0x311200[_0x5d853a(-0xc9,-0x6a,-0x50,-0x84)])),_0x534796=_0x534796[_0xf4d2e8(-0xa2,-0xcb,-0x14a,-0xeb)](_0x441b8d['HUYde'],''+_0x441b8d['PUQan']('\x22'+_0x311200[_0xf4d2e8(-0x21e,-0x246,-0x30a,-0x260)+'me'],'\x22')),_0x534796=_0x534796[_0x5d853a(0x7d,0x14a,0xbc,0x9c)](_0x441b8d[_0xf4d2e8(-0x93,-0xc1,-0x40,-0x5c)],_0x441b8d[_0xf4d2e8(-0x30d,-0x242,-0x2f4,-0x315)](Number,_0x311200[_0x5d853a(-0xed,-0x89,-0x70,-0x8b)])),_0x534796=_0x534796[_0x5d853a(0x101,0x184,0xbc,0xc5)](_0x441b8d[_0xf4d2e8(-0x2cc,-0x259,-0x25a,-0x22c)],_0x441b8d['spysV'](Number,_0x311200[_0xf4d2e8(-0xed,-0x15a,-0xd0,-0x202)])),_0x534796=_0x534796[_0xf4d2e8(-0x15,-0xcb,-0x3,-0x142)](_0x441b8d[_0xf4d2e8(-0x1f2,-0x262,-0x20e,-0x2c9)],''+(_0x441b8d[_0x5d853a(0x15,-0xfa,-0x76,-0x106)]('\x22',_0x311200[_0x5d853a(0x9d,-0x1d,0x43,-0xb)+_0x5d853a(-0x9c,-0xa6,-0xb1,-0x83)])+'\x22'));function _0xf4d2e8(_0x4f22cb,_0x2f286d,_0x159cb2,_0x56641b){return _0xe681(_0x2f286d- -0x36d,_0x56641b);}return _0x534796=_0x534796['replaceAll'](_0x441b8d[_0x5d853a(-0x170,-0x1a6,-0xdd,-0x190)],''+(_0x441b8d[_0xf4d2e8(-0x255,-0x1fd,-0x287,-0x240)]('\x22',_0x311200['prompt']['replaceAll']('\x22','\x5c\x22'))+'\x22')),_0x534796=_0x534796['replaceAll']('\x22%MODEL_NA'+_0x5d853a(0x107,0x15e,0xa1,0x15d),'\x22'+_0x311200[_0xf4d2e8(-0x22c,-0x204,-0x155,-0x1ad)]+'\x22'),_0x534796=_0x534796[_0xf4d2e8(-0x45,-0xcb,-0xd3,0xb)](_0x441b8d[_0x5d853a(-0x2f,-0x39,0x27,0x6b)],_0x441b8d['AZYkb'](Number,_0x311200[_0xf4d2e8(-0x2ae,-0x21c,-0x20a,-0x1c9)+'g'])),_0x534796=_0x534796['replaceAll'](_0x441b8d[_0xf4d2e8(-0x1c4,-0x134,-0x100,-0x1b6)],_0x441b8d[_0x5d853a(0x6d,-0x56,0xe,0x62)](Number,_0x311200[_0xf4d2e8(-0x14b,-0x1b9,-0x1f1,-0x1b4)+_0x5d853a(-0x128,-0x12b,-0x5e,0x15)])),_0x534796=_0x534796[_0x5d853a(0x67,0xe,0xbc,0xee)](_0x441b8d[_0xf4d2e8(-0x102,-0x16c,-0x190,-0x1c9)],_0x441b8d['oWtIx'](Number,_0x311200[_0x5d853a(0x19,-0x67,-0x81,0x4d)])),_0x534796=_0x534796[_0x5d853a(0x90,0x105,0xbc,0x8)](_0x441b8d[_0xf4d2e8(-0x1bd,-0x1b6,-0x253,-0xde)],_0x441b8d[_0x5d853a(-0x5f,0x26,-0x4b,0x14)](Number,_0x311200[_0x5d853a(0x4d,0xab,-0xd,0x72)])),_0x534796=_0x534796[_0x5d853a(0x45,-0x13,0xbc,0x1a)](_0x441b8d['PeAuv'],''+(_0x441b8d[_0x5d853a(0x25,0xcf,0x74,0xa7)]('\x22',_0x311200[_0x5d853a(-0xc8,-0xba,-0x33,0x23)+_0x5d853a(-0x5d,0x0,-0xc5,-0x127)])+'\x22')),_0x534796=_0x534796[_0xf4d2e8(-0x11,-0xcb,-0x1b,-0x2c)](_0x441b8d[_0x5d853a(0x8f,0xa7,0x75,0x9e)],''+_0x441b8d[_0xf4d2e8(-0x24a,-0x1fd,-0x1b3,-0x24f)]('\x22'+_0x311200[_0xf4d2e8(-0xcb,-0x10b,-0x159,-0x1a0)],'\x22')),_0x534796=_0x534796[_0x5d853a(0x11,0x3,0xbc,0x6a)](_0xf4d2e8(-0x218,-0x141,-0x1c4,-0x177)+_0xf4d2e8(-0x64,-0x13b,-0x1ea,-0x11a),''+(_0x441b8d[_0xf4d2e8(-0x23a,-0x18d,-0x1bf,-0x21b)]('\x22',_0x311200[_0x5d853a(-0xb4,-0x119,-0xc8,-0x178)])+'\x22')),_0x534796=_0x534796[_0x5d853a(0xaf,-0xb,0xbc,0x134)](_0xf4d2e8(-0x201,-0x186,-0xd4,-0x23c),''+(_0x441b8d[_0xf4d2e8(-0x18a,-0x1f3,-0x1fa,-0x17c)]('\x22',_0x311200['vae'])+'\x22')),_0x534796=_0x534796[_0xf4d2e8(-0x8a,-0xcb,-0x177,-0x11f)](_0x441b8d[_0x5d853a(0x2,0x129,0xbf,0x19)],''+_0x441b8d[_0xf4d2e8(-0x1c5,-0x1f3,-0x293,-0x29d)](_0x441b8d[_0x5d853a(-0x10,-0x5e,0x78,0x26)]('\x22',_0x311200[_0xf4d2e8(-0x2ff,-0x227,-0x24d,-0x1c6)]),'\x22')),console[_0xf4d2e8(-0x3d,-0xf2,-0xe0,-0x178)](_0x534796),_0x534796;}let currentTaskId=null;export async function generateComfyUIImage({prompt:_0x7661f0,width:_0x33f04f,height:_0x8185cb,change:_0x57a712}){const _0xf82887={'sNUrO':function(_0x4840fb){return _0x4840fb();},'mMrCz':function(_0x1c5dc2){return _0x1c5dc2();},'dhhRm':function(_0x17b9f2,_0x336817){return _0x17b9f2+_0x336817;},'Asfgd':function(_0x262681,_0x57481c){return _0x262681+_0x57481c;},'Frezm':_0x6fc5ba(0x316,0x2ab,0x336,0x26c),'siIDj':function(_0x106047,_0xcd02ae){return _0x106047(_0xcd02ae);},'ySrUm':function(_0x2fe7af,_0x3ac8f9){return _0x2fe7af(_0x3ac8f9);},'Czhkt':'.safetenso'+'rs','PNcNG':function(_0x3d3ef3,_0x1cdb81){return _0x3d3ef3>_0x1cdb81;},'DHkSJ':function(_0x5c6f53,_0x180108){return _0x5c6f53+_0x180108;},'JyDXj':function(_0x56a8b0,_0x207644){return _0x56a8b0+_0x207644;},'izgqu':_0x39110b(0xd1,0x18a,0xbb,0x28),'QlGnU':'<wlr:','xqfhn':function(_0x52a59d,_0x49d2a4){return _0x52a59d===_0x49d2a4;},'nalkf':_0x39110b(0x104,0x11e,0x162,0xcb)+'rating\x20ima'+_0x6fc5ba(0x2ac,0x2ad,0x227,0x222),'RONdf':'video/','XsAUa':_0x6fc5ba(0x2c0,0x318,0x1f8,0x2be),'mbrJh':function(_0x46bc98,_0x1afc7a){return _0x46bc98!==_0x1afc7a;},'jVMyA':'FneDk','rdcWy':'ohvFi','LFDco':'pQcbv','VlFny':'AMvOW','OZtcZ':_0x6fc5ba(0x1b9,0x175,0x156,0x1aa),'SSrGF':_0x39110b(0x53,0xe9,0xc9,0x19)+_0x39110b(0x82,0xdd,0x120,-0x51),'NpZnw':function(_0x53f424,_0xa21d5b){return _0x53f424||_0xa21d5b;},'pNCkE':function(_0x47a573,_0x177d6e){return _0x47a573>_0x177d6e;},'OOfAf':'...','EvCey':_0x39110b(0x45,0x13,-0x26,-0x6f),'CgbuR':function(_0x538582,_0x9a03c8){return _0x538582(_0x9a03c8);},'uxVVA':function(_0x1b5d44,_0x456e53){return _0x1b5d44||_0x456e53;},'ymBfZ':_0x6fc5ba(0x264,0x20f,0x1f7,0x193),'TFwUa':function(_0xac2167,_0x280e1a){return _0xac2167!==_0x280e1a;},'JKfPd':_0x39110b(0x100,0xa8,0xc4,0xde),'KxPko':_0x39110b(0xde,0xe4,0x54,0x72),'WOllM':function(_0x53e5eb,_0x1193ba){return _0x53e5eb!==_0x1193ba;},'SvKTr':_0x6fc5ba(0x26f,0x310,0x2ab,0x250)+_0x39110b(0x1a,-0x79,-0x1e,-0x70),'DCxUb':function(_0x5028d8,_0x1a39f4){return _0x5028d8===_0x1a39f4;},'FnqLp':_0x6fc5ba(0x243,0x207,0xcd,0x19d),'XwhZA':function(_0x48e825,_0x5a951f){return _0x48e825(_0x5a951f);},'BmUFF':_0x6fc5ba(0x2c7,0x1e7,0x231,0x2a6)+_0x39110b(0xa1,0xde,0xd1,0x118),'hIrOD':function(_0x27b584,_0xe4548b){return _0x27b584<=_0xe4548b;},'IJeai':function(_0x220941,_0x5da829){return _0x220941===_0x5da829;},'PxCCs':_0x6fc5ba(0x179,0x1eb,0xea,0x1a4),'MCoiN':_0x6fc5ba(0x15c,0x1a2,0x1b4,0x20d),'rdLnx':_0x39110b(0x56,0xe7,0x2b,0x39)+'中的\x20prompt。','kIVTi':function(_0x55ce72,_0x1aea4c,_0x9edbda){return _0x55ce72(_0x1aea4c,_0x9edbda);},'kIwnR':function(_0x132c58,_0x258e6a){return _0x132c58!==_0x258e6a;},'GVdIe':_0x6fc5ba(0x229,0x23f,0x1e1,0x1ad),'kxkaQ':_0x6fc5ba(0x323,0x2fc,0x383,0x2c4),'scZqr':function(_0x39a9dd,_0x3aaa07){return _0x39a9dd+_0x3aaa07;},'ITamN':function(_0x3714b2,_0x193ebe){return _0x3714b2(_0x193ebe);},'PHEVM':function(_0x1275e0,_0x34713a,_0x74eeb0,_0x2870b2,_0xd1fe5a,_0x463189){return _0x1275e0(_0x34713a,_0x74eeb0,_0x2870b2,_0xd1fe5a,_0x463189);},'TEsDv':function(_0x5cd2ce,_0x243dbb){return _0x5cd2ce(_0x243dbb);},'JPXkU':_0x39110b(0x9,0x33,-0x18,-0x61),'GUpJf':function(_0x4239a8,_0x1edad7){return _0x4239a8(_0x1edad7);},'IHPxO':_0x39110b(-0x36,0x48,-0xec,0x44),'ynYBA':'iWXJv','PQBIO':function(_0x52fa91,_0x1951d5){return _0x52fa91(_0x1951d5);},'Aevtc':_0x6fc5ba(0x1b0,0x1a3,0x1e0,0x1ee)+'9c0-4e39-9'+'ced-37d290'+'f371f8','olons':function(_0x4924d8,_0x4ddf12){return _0x4924d8>_0x4ddf12;},'JzQro':function(_0x185a14,_0x543077){return _0x185a14(_0x543077);},'DjGUo':function(_0x19c8f5,_0x17d60f){return _0x19c8f5(_0x17d60f);},'PnDFQ':function(_0x51854c,_0x1790ad){return _0x51854c>_0x1790ad;},'BSmbw':_0x6fc5ba(0x282,0x1ac,0x306,0x27b),'wmYoR':function(_0x43b1c7,_0x4e6554,_0x406ee3){return _0x43b1c7(_0x4e6554,_0x406ee3);},'XsbMn':function(_0x32ec0c,_0x39547c){return _0x32ec0c(_0x39547c);},'VFBsT':_0x39110b(0x6b,-0x49,0xff,0xa3),'ZhXpx':_0x39110b(-0x11,0x67,0xb6,0x18),'lXZdz':'/api/sd/co'+_0x6fc5ba(0x11b,0x22b,0x82,0x156)+'te','RAJwX':'POST','bEyEX':function(_0x1822cd,_0x2637f4){return _0x1822cd(_0x2637f4);},'QrbgS':function(_0x7dbfbc,_0x5b2ad1){return _0x7dbfbc(_0x5b2ad1);},'yhGQf':_0x6fc5ba(0x253,0x1dd,0x218,0x1d4),'fxgfp':_0x39110b(0x54,0xe7,0xc7,0x53),'FIqMw':function(_0x1865f4,_0x2720a3){return _0x1865f4||_0x2720a3;},'jAqDf':function(_0x18fa82,_0x1cf34f){return _0x18fa82===_0x1cf34f;},'fekbQ':_0x6fc5ba(0x27b,0x1b3,0x25b,0x265),'Krtez':_0x6fc5ba(0x302,0x1c3,0x1e5,0x25f)+_0x39110b(0x59,0xc0,-0x34,0xf7),'YIfJE':function(_0x5a52db,_0x5c771e){return _0x5a52db(_0x5c771e);},'jcSEn':_0x39110b(0x28,0xf1,-0x1d,-0x5f),'yBRVb':function(_0x437aa2,_0x589f89){return _0x437aa2(_0x589f89);},'IfpNf':_0x39110b(-0x82,-0x11f,-0x144,-0x111)+'在中断\x20ComfyU'+_0x39110b(0xe2,0x12f,0x172,0x4a),'sEuUm':'任务已取消','kYmUx':_0x6fc5ba(0x2d9,0x23a,0x1f6,0x289),'slZXA':_0x39110b(-0x3d,-0x42,0x15,-0xdb),'eSDHU':function(_0xc7d52e,_0x16fa6e){return _0xc7d52e(_0x16fa6e);},'CjGuR':function(_0x5f4ebd,_0x8dbe5a){return _0x5f4ebd!==_0x8dbe5a;},'eivIV':'XFjwq','qAfkY':_0x39110b(0xf6,0x7b,0x1c2,0xbd),'UyyYC':_0x6fc5ba(0x150,0x179,0x29a,0x20b),'qkXwt':_0x39110b(-0x52,-0x112,-0xe0,0x6c),'ynGYy':_0x39110b(0xa,-0x16,-0x41,-0x8a),'ofxmE':function(_0x5e4408,_0x1c794c){return _0x5e4408===_0x1c794c;},'LaXkr':_0x39110b(-0x5d,-0x100,-0x10f,0x3e),'wHjir':'video/webm','wmvms':_0x6fc5ba(0x2a0,0x263,0x354,0x2c8),'cBWXX':function(_0x1fd80d,_0x542cb4){return _0x1fd80d(_0x542cb4);},'jYZDS':_0x6fc5ba(0x290,0x1b7,0x1e4,0x21d)+'器超时。','GQvkU':function(_0x305a4f,_0x32ef22){return _0x305a4f!==_0x32ef22;},'jYTjw':_0x6fc5ba(0x313,0x3c2,0x38a,0x2f2),'AZLSt':_0x6fc5ba(0x18e,0x167,0x268,0x1ab),'aOJLv':'0|5|4|3|2|'+'1'};_0xf82887['mMrCz'](clearLog);const _0x32cee0=taskQueue['addTask']({'name':_0xf82887[_0x39110b(0xb8,-0x1b,0x93,0x34)](_0xf82887[_0x39110b(0xdc,0x186,0x176,0x78)](_0x7661f0,'')[_0x39110b(0x13,-0x38,-0xa7,-0x6c)](-0xf21+-0x1412+-0x2333*-0x1,0x80*-0xf+0x1*-0x5c8+0xd66),_0x7661f0&&_0xf82887[_0x39110b(0xeb,0x106,0xaf,0xad)](_0x7661f0[_0x39110b(-0x73,-0x6b,0x34,-0xed)],0x2368+-0x43*0x51+-0xe17)?_0xf82887['OOfAf']:''),'type':TaskType['COMFYUI'],'prompt':_0x7661f0});currentTaskId=_0x32cee0,console[_0x6fc5ba(0x39a,0x249,0x2d3,0x2c2)](_0xf82887[_0x39110b(-0x98,-0x54,0x1e,0x1d)],_0x7661f0),_0x7661f0=_0xf82887[_0x6fc5ba(0x19b,0x239,0x1c6,0x271)](processCharacterPrompt,_0x7661f0),_0x7661f0=await _0xf82887['siIDj'](stripChineseAnnotations,_0x7661f0);let _0x512710=_0x57a712;_0x57a712=processCharacterPrompt(_0x57a712),_0x57a712=await _0xf82887[_0x39110b(-0x3f,-0xc5,-0x53,0x7f)](stripChineseAnnotations,_0x57a712),_0xf82887[_0x39110b(-0x3f,-0x88,-0xee,0x11)](addLog,'开始\x20ComfyUI'+_0x6fc5ba(0x274,0x2e5,0x34f,0x2b2)+extension_settings[extensionName]['client']),_0xf82887['CgbuR'](addLog,_0x39110b(0x2b,0x31,-0x5,0x26)+extension_settings[extensionName][_0x39110b(0x90,0xc8,0xf8,0x13c)]),_0xf82887[_0x6fc5ba(0x260,0x1fd,0x23e,0x2c7)](addLog,'请求尺寸:\x20宽度\x20-'+'\x20'+_0xf82887[_0x6fc5ba(0x284,0x31c,0x2d7,0x2ba)](_0x33f04f,'默认')+',\x20高度\x20-\x20'+_0xf82887[_0x6fc5ba(0x32a,0x21e,0x1bc,0x259)](_0x8185cb,'默认'));if(extension_settings[extensionName]['MODEL_NAME'][_0x6fc5ba(0x1ad,0xd2,0x1df,0x18f)]()===_0xf82887[_0x6fc5ba(0x18a,0x188,0x24e,0x195)]){if(_0xf82887['TFwUa'](_0xf82887['JKfPd'],'rLJPr')){const _0x5f0351=_0xf82887[_0x39110b(0xf3,0x140,0xf0,0x169)][_0x39110b(0x113,0xef,0xfb,0x172)]('|');let _0x4bb996=-0x359*-0x4+0xaec+-0x1850;while(!![]){switch(_0x5f0351[_0x4bb996++]){case'0':return;case'1':taskQueue[_0x6fc5ba(0x158,0x128,0x142,0x1af)+'sk'](_0x32cee0,![]);continue;case'2':toastr['error'](_0x39110b(0xcf,0x141,0xc5,0x12)+_0x39110b(0x26,-0x1e,0x8f,-0x1f));continue;case'3':_0xf82887['CgbuR'](addLog,_0x6fc5ba(0x1f4,0x270,0x2d7,0x2ad)+_0x6fc5ba(0x209,0x137,0x1e2,0x204));continue;case'4':currentTaskId=null;continue;}break;}}else!_0x1cf0ab['initialize'+'ComfyuiLis'+_0x6fc5ba(0x386,0x298,0x261,0x2e0)]&&(_0x5167e2[_0x6fc5ba(0x1ed,0x295,0x21a,0x1e3)+_0x39110b(0x5a,0x17,0x12,-0x1e)+_0x39110b(0x102,0x62,0x135,0x123)]=!![],_0xf82887[_0x39110b(0x68,0x7c,0x45,-0x4)](_0x50e069)),_0xf82887['mMrCz'](_0x198b46);}const _0x4abbf7=extension_settings[extensionName]['comfyuiUrl'][_0x6fc5ba(0x1d3,0x167,0x137,0x18f)](),_0x51c15d=_0x57a712&&_0xf82887[_0x6fc5ba(0x39d,0x364,0x31a,0x2dd)](_0x57a712[_0x6fc5ba(0x12e,0x1b4,0x144,0x18f)](),'')?_0x57a712:_0x7661f0;function _0x6fc5ba(_0x52281d,_0x360922,_0x57d155,_0x3c633f){return _0xe681(_0x3c633f-0x47,_0x57d155);}function _0x39110b(_0xe6c133,_0x2d417f,_0x14fc14,_0x471459){return _0xe681(_0xe6c133- -0x197,_0x2d417f);}_0xf82887[_0x39110b(0xe9,0x92,0x136,0x177)](addLog,_0x39110b(0x98,0x167,0x135,0xc9)+_0x51c15d);let _0x3f765c=![];_0x51c15d[_0x39110b(-0x69,0xa,-0x64,-0x69)](_0xf82887['SvKTr'])&&(_0x3f765c=!![]);addLog('是否启用分角色模式\x20'+_0x39110b(-0x84,-0xa4,0xf,-0xd0)+'les):\x20'+_0x3f765c);let _0xcf5dab={},_0x4c7f3c='',_0x25e891='';if(_0x3f765c){if(_0xf82887['DCxUb'](_0xf82887[_0x6fc5ba(0x3bf,0x2e3,0x260,0x2ed)],_0xf82887[_0x6fc5ba(0x2c3,0x29b,0x355,0x2ed)])){_0xf82887['XwhZA'](addLog,_0xf82887['BmUFF']),_0xcf5dab=parsePromptStringWithCoordinates(_0x51c15d),_0x4c7f3c=_0xcf5dab[_0x6fc5ba(0x206,0x31b,0x213,0x250)+_0x6fc5ba(0x23c,0x1eb,0x1d0,0x1f8)];for(let _0x572932=0x358+-0xb3+-0x152*0x2;_0xf82887[_0x6fc5ba(0x113,0xc6,0x100,0x154)](_0x572932,-0x26a0+0x3*-0x955+0x42a3*0x1);_0x572932++){_0xcf5dab['Character\x20'+_0x572932+'\x20Prompt']&&(_0x25e891=_0xf82887[_0x39110b(0xbc,0x81,0x12b,0xce)](_0xf82887[_0x39110b(0xb8,0x114,0x18b,0xfe)](_0x25e891,',\x20'),_0xcf5dab[_0x6fc5ba(0x137,0x11c,0x114,0x19b)+_0x572932+_0x6fc5ba(0x252,0x2fc,0x385,0x2b8)]));}}else _0x24d9a6=_0xf82887[_0x39110b(0xbc,0xd2,0x12e,0x14f)](_0xf82887[_0x39110b(-0x7d,-0xe6,-0x8c,-0xf6)](_0xe8a2e3,_0xf82887['Frezm']),_0xf82887[_0x6fc5ba(0x31f,0x30c,0x253,0x271)](_0x8f9eaf,_0x4ca3b7['Character\x20'+_0x4a86bf+_0x6fc5ba(0x21c,0x270,0x211,0x2b8)]));}else _0xf82887[_0x39110b(-0x42,-0x97,0x18,-0x7d)](_0xf82887[_0x6fc5ba(0x26d,0x29c,0x1a6,0x1c5)],_0xf82887[_0x39110b(0x64,0x49,0xef,0xb2)])?_0x43030a=_0xf82887[_0x6fc5ba(0x136,0x1c9,0x1f2,0x19f)](_0x24fb79,_0x2e2598):(_0xf82887[_0x6fc5ba(0xcd,0x178,0x1eb,0x19f)](addLog,_0xf82887[_0x39110b(-0x26,0x93,-0x2a,0x98)]),_0x4c7f3c=_0x51c15d);let {modifiedPrompt:_0xde403d,insertions:_0x39efd6}=await _0xf82887[_0x39110b(0x60,-0x2b,0xe6,0xa0)](prompt_replace,_0x4c7f3c,_0x25e891);if(_0x3f765c){if(_0xf82887[_0x39110b(0x5c,0x9,0xd9,-0x56)](_0xf82887[_0x39110b(-0xe,-0xd9,0x6,0x9e)],_0xf82887[_0x6fc5ba(0x29a,0x358,0x25b,0x2d9)]))for(let _0x1c38b4=0x5fb*-0x1+-0x1aef+0x20eb;_0x1c38b4<=0xf3a+0x3d5+-0x130b;_0x1c38b4++){_0xcf5dab['Character\x20'+_0x1c38b4+_0x39110b(0xda,0x1b1,0x116,0x152)]&&(_0xde403d=_0xf82887['dhhRm'](_0xf82887[_0x6fc5ba(0x37d,0x307,0x29e,0x2e6)](_0xde403d,_0xf82887[_0x6fc5ba(0x202,0xc8,0xc6,0x180)]),_0xf82887['ITamN'](prompt_replace_for_character,_0xcf5dab[_0x6fc5ba(0xe8,0x18e,0xcc,0x19b)+_0x1c38b4+'\x20Prompt'])));}else{const _0x1c43f0=_0x16ed50?function(){function _0x4216f7(_0x33a507,_0x3a475b,_0x44b970,_0x4080d9){return _0x6fc5ba(_0x33a507-0x120,_0x3a475b-0xe5,_0x4080d9,_0x3a475b- -0x348);}if(_0x433fac){const _0x5b9183=_0x599c24[_0x4216f7(-0xec,-0x1c0,-0x132,-0x102)](_0x1a4d91,arguments);return _0xb46a10=null,_0x5b9183;}}:function(){};return _0x18b9b3=![],_0x1c43f0;}}let _0x4ba8b7=await _0xf82887[_0x6fc5ba(0x28e,0x247,0x257,0x2ef)](zhengmian,extension_settings[extensionName][_0x6fc5ba(0x1a6,0x257,0x1af,0x268)][extension_settings[extensionName][_0x6fc5ba(0x296,0x17c,0x23e,0x1df)+_0x6fc5ba(0x318,0x2d0,0x23a,0x251)]]['fixedPromp'+'t'],_0xde403d,extension_settings[extensionName][_0x6fc5ba(0x284,0x28e,0x1e0,0x268)][extension_settings[extensionName]['yusheid_co'+'mfyui']]['fixedPromp'+_0x39110b(-0x7f,-0xe2,-0xdb,-0x76)],extension_settings[extensionName][_0x39110b(-0x99,-0x13f,-0xaf,-0x33)+'i'],_0x39efd6);_0x4ba8b7=_0xf82887[_0x6fc5ba(0x19e,0x1c7,0x213,0x15d)](_0x5a068d,_0x4ba8b7);function _0x5a068d(_0x39fd87){const _0x63ad41={};_0x63ad41[_0x2dd3ea(0x5b0,0x524,0x4d7,0x5e9)]=_0xf82887[_0x2dd3ea(0x5c9,0x57d,0x566,0x558)];const _0x4e12b9=_0x63ad41;function _0x445407(_0x148806,_0x378ec9,_0x51db80,_0x165c8e){return _0x39110b(_0x148806-0x10a,_0x378ec9,_0x51db80-0x130,_0x165c8e-0x1e);}const _0x43f1f2=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;function _0x2dd3ea(_0x410769,_0x119ed7,_0x4c335e,_0x23fd9c){return _0x6fc5ba(_0x410769-0xaa,_0x119ed7-0x1db,_0x410769,_0x119ed7-0x394);}return _0x39fd87[_0x2dd3ea(0x64d,0x581,0x638,0x4f4)](_0x43f1f2,(_0x55493e,_0x4eaf4f,_0x30f57a)=>{function _0x518c3b(_0x1435b8,_0x556444,_0x137ce2,_0x287bea){return _0x445407(_0x556444-0x381,_0x1435b8,_0x137ce2-0xd5,_0x287bea-0x2a);}if(_0x55493e[_0x463e47(-0x213,-0x16f,-0x175,-0x244)](_0x4e12b9[_0x463e47(-0x2b9,-0x274,-0x218,-0x229)]))return _0x55493e;function _0x463e47(_0x143472,_0x5981c5,_0x463383,_0x555334){return _0x445407(_0x555334- -0x2e5,_0x143472,_0x463383-0x93,_0x555334-0x130);}if(_0x30f57a[_0x463e47(-0x2a2,-0x2a0,-0x217,-0x244)](':'))return _0x518c3b(0x5cd,0x55c,0x591,0x52c)+_0x4eaf4f+('.safetenso'+'rs:')+_0x30f57a+'>';return _0x518c3b(0x490,0x55c,0x60f,0x4dc)+_0x4eaf4f+(_0x463e47(-0x183,-0x1d7,-0x1bb,-0x1c0)+_0x463e47(-0x10b,-0x157,-0x112,-0x17c))+_0x30f57a+':1>';});}extension_settings[extensionName][_0x39110b(0x86,0x10e,-0x13,-0x3e)][_0x39110b(-0x69,-0x71,0x42,-0x13b)](_0xf82887[_0x6fc5ba(0x2e9,0x1fe,0x218,0x28f)])&&(_0x4ba8b7=_0x4ba8b7[_0x39110b(0x10b,0x121,0x134,0x146)](_0xf82887['izgqu'],_0xf82887['QlGnU']),_0x4ba8b7=_0x4ba8b7['replaceAll'](_0xf82887[_0x39110b(0xb,0x86,0x8f,-0xc0)],''));console[_0x39110b(0xe4,0xc7,0x104,0x112)](_0x6fc5ba(0x28a,0x1d7,0x1e4,0x28e),_0x4ba8b7),_0xf82887[_0x39110b(0x41,0xd7,0x42,0xbc)](addLog,_0x39110b(-0x60,-0x120,-0x11,-0x7b)+_0x4ba8b7);let _0x2a6f75=await _0xf82887[_0x39110b(0x60,0xb0,0x8f,0x4b)](fumian,extension_settings[extensionName][_0x39110b(0x8a,0xe2,0xb9,0x62)][extension_settings[extensionName]['yusheid_co'+'mfyui']]['negativePr'+_0x6fc5ba(0x151,0x2dd,0x256,0x21c)],extension_settings[extensionName][_0x6fc5ba(0x20f,0x18f,0x13d,0x196)+'i']);if(extension_settings[extensionName][_0x39110b(0x86,-0x1b,0xdb,0x14c)]['includes'](_0x39110b(0x9,0x65,-0x17,-0xb3)))_0x2a6f75=_0x2a6f75[_0x6fc5ba(0x249,0x356,0x381,0x2e9)](_0xf82887[_0x39110b(0x7e,0x57,0x94,0xb4)],'<wlr:');else{if(_0xf82887[_0x6fc5ba(0x393,0x369,0x358,0x2dd)](_0xf82887['IHPxO'],_0xf82887[_0x6fc5ba(0x30c,0x243,0x343,0x2e5)]))_0x2a6f75=_0x5a068d(_0x2a6f75);else{_0xf82887[_0x39110b(0x93,0x49,0x79,0x4b)](_0x5514e2,_0x5344bf);return;}}_0xf82887[_0x39110b(0xc5,0x54,0x17e,-0xd)](addLog,_0x6fc5ba(0x339,0x3a4,0x21a,0x2df)+_0x2a6f75),_0x4ba8b7=_0x4ba8b7[_0x6fc5ba(0x229,0x219,0x33a,0x2e9)]('\x0a',',')[_0x6fc5ba(0x152,0x28c,0x123,0x1ed)](/,{2,}/g,',')[_0x6fc5ba(0x367,0x24f,0x298,0x2e9)]('\x5c\x5c','\x5c')[_0x39110b(0x10b,0x13b,0x1cf,0x9d)]('\x5c','\x5c\x5c'),_0x2a6f75=_0x2a6f75[_0x6fc5ba(0x254,0x2ea,0x320,0x2e9)]('\x0a',',')[_0x39110b(0xf,0x0,-0xaa,-0x87)](/,{2,}/g,',')[_0x39110b(0x10b,0xae,0xf5,0xcc)]('\x5c\x5c','\x5c')[_0x6fc5ba(0x292,0x223,0x288,0x2e9)]('\x5c','\x5c\x5c');let _0x19ad77={'prompt':_0x4ba8b7,'negative_prompt':_0x2a6f75,'steps':extension_settings[extensionName][_0x39110b(0xd5,0x12a,0xb7,0x60)+'eps'],'sampler_name':extension_settings[extensionName][_0x39110b(-0x64,0x13,-0x61,0x47)+'plerName'],'width':_0x33f04f?_0x33f04f:extension_settings[extensionName]['comfyui_wi'+_0x39110b(-0x77,0x1a,0x45,-0x102)],'height':_0x8185cb?_0x8185cb:extension_settings[extensionName]['comfyui_he'+_0x39110b(0x8b,0xd2,0xb4,0x121)],'cfg_scale':extension_settings[extensionName][_0x6fc5ba(0x23a,0x203,0x2b4,0x281)+'i'],'seed':_0xf82887[_0x6fc5ba(0x29b,0x252,0x197,0x245)](extension_settings[extensionName][_0x39110b(0x57,-0x1,0xd7,0x8c)+'ed'],0x1a81+0xb25+-0x25a6)||_0xf82887[_0x6fc5ba(0x132,0x1fd,0xf5,0x19c)](extension_settings[extensionName][_0x39110b(0x57,0xfa,0x17,0xc)+'ed'],'0')||extension_settings[extensionName][_0x6fc5ba(0x295,0x1c0,0x16b,0x235)+'ed']===''||extension_settings[extensionName][_0x6fc5ba(0x222,0x212,0x17e,0x235)+'ed']===-(0x2005+-0xb*0x29c+-0x350)||extension_settings[extensionName][_0x6fc5ba(0x297,0x2fc,0x2bf,0x235)+'ed']==='-1'?_0xf82887[_0x39110b(0xb3,0x13d,0x74,0x179)](generateRandomSeed):extension_settings[extensionName][_0x39110b(0x57,0xa0,0x7c,-0xb)+'ed'],'MODEL_NAME':extension_settings[extensionName][_0x39110b(-0x2e,-0xf9,-0xd1,0x1d)],'c_quanzhong':extension_settings[extensionName][_0x39110b(-0x46,0x36,0x4a,0x4)+'g'],'c_idquanzhong':extension_settings[extensionName][_0x39110b(0x1d,-0xba,0xb5,-0x42)+_0x6fc5ba(0x1c9,0x255,0x22c,0x1cf)],'c_xijie':extension_settings[extensionName]['c_xijie'],'c_fenwei':extension_settings[extensionName]['c_fenwei'],'comfyuicankaotupian':window[_0x6fc5ba(0x16a,0x2a1,0x2c1,0x1fa)+_0x6fc5ba(0x1d7,0x112,0x1a8,0x168)],'ipa':extension_settings[extensionName][_0x39110b(0xcb,0x6b,0x9b,0x13c)],'scheduler':extension_settings[extensionName][_0x6fc5ba(0x1ed,0x19c,0x1b1,0x166)+_0x39110b(-0x68,0xd,-0x2d,-0x5)],'vae':extension_settings[extensionName]['comfyui_va'+'e'],'clip':extension_settings[extensionName]['comfyuiCLI'+'PName']};const _0x5023f2=_0x39110b(0x36,-0x57,0x9a,-0x72)+_0x6fc5ba(0x12f,0x135,0x26f,0x1c4)+_0x6fc5ba(0x303,0x277,0x27f,0x2e1)+_0x19ad77['prompt']+_0x6fc5ba(0x272,0x31a,0x27c,0x28c)+_0x19ad77[_0x39110b(0x92,0x168,-0x3,0xce)+_0x39110b(-0x62,-0x65,0x1b,-0xd)]+'\x0a模型:\x20'+_0x19ad77['MODEL_NAME']+_0x6fc5ba(0x1b9,0x128,0x221,0x1f5)+_0x19ad77['sampler_na'+'me']+_0x39110b(0x0,0xab,0x76,0xc1)+_0x19ad77['steps']+(_0x39110b(0xe8,0x119,0x98,0x1ae)+':\x20')+_0x19ad77['cfg_scale']+_0x39110b(0x52,-0x53,0xe,-0x41)+_0x19ad77[_0x39110b(0xad,0x11b,0x3f,0x8d)]+_0x39110b(0x74,0x3f,0x4d,0xd1)+_0x19ad77['width']+'x'+_0x19ad77[_0x39110b(0x7c,0xe2,0x61,0x2d)]+'\x0aVAE:\x20'+_0x19ad77[_0x39110b(-0x92,-0x6,-0x9,0x0)]+('\x0aScheduler'+':\x20')+_0x19ad77['scheduler']+(_0x6fc5ba(0x1f4,0x1af,0x265,0x1b2)+_0x39110b(0xfe,0xea,0x82,0x1ca)+'-\x0a');_0xf82887[_0x39110b(-0x3f,-0x87,0x45,-0x3c)](addLog,_0x5023f2);const _0x33c35e=_0xf82887['Aevtc'];let _0x1620a6=extension_settings[extensionName][_0x6fc5ba(0x286,0x1ba,0x2fb,0x264)];try{const _0x4e95d1=JSON[_0x6fc5ba(0x26e,0x28c,0x20a,0x23c)](_0x1620a6),_0x578549=Object['values'](_0x4e95d1)[_0x6fc5ba(0x270,0x158,0x263,0x1c3)](_0x453278=>_0x453278&&_0x453278[_0x6fc5ba(0x33a,0x2f2,0x2e1,0x278)])[_0x39110b(-0x73,-0xd2,0x2a,-0x39)];if(_0xf82887[_0x6fc5ba(0xfb,0x21e,0x1e8,0x153)](_0x578549,-0x193c+-0x1146*0x1+0x1541*0x2)){_0xf82887['JzQro'](addLog,'检测到\x20'+_0x578549+(_0x39110b(0xe5,0x168,0x120,0xf5)+_0x39110b(0x2a,-0x23,-0x31,-0x8)));const _0x50ed04=extension_settings[extensionName]?.[_0x6fc5ba(0x241,0x1a5,0x1e3,0x1ea)+'he']?.[_0x39110b(0x30,0xac,0xa3,0x35)]||{},_0x4ab63f=processSkippedNodes(_0x4e95d1,_0x50ed04);_0x1620a6=JSON[_0x6fc5ba(0x1e9,0x18b,0x2c9,0x255)](_0x4ab63f),_0xf82887[_0x6fc5ba(0x1f1,0x24d,0x207,0x191)](addLog,_0x39110b(0xb9,0x75,0x138,0xd8)+_0x6fc5ba(0x162,0x214,0x222,0x170)+(_0xf82887[_0x39110b(-0x55,-0x5d,-0x55,0x63)](Object['keys'](_0x50ed04)[_0x6fc5ba(0x17f,0x1df,0xbc,0x16b)],-0x193c+0x1a8a+0x1*-0x14e)?_0x39110b(0x9e,0x81,0x41,0xaa):''));}}catch(_0x5444fc){if(_0xf82887['TFwUa'](_0xf82887['BSmbw'],_0x6fc5ba(0x292,0x157,0x1b6,0x200)))_0xf82887[_0x6fc5ba(0x1da,0xd5,0xa7,0x179)](addLog,'工作流解析失败，跳过'+_0x6fc5ba(0x2dd,0x32c,0x28b,0x2d8)+_0x5444fc[_0x39110b(0x48,0x106,0x42,0x19)]);else{const _0x4d5082=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;return _0x581902[_0x6fc5ba(0x137,0x123,0x1fd,0x1ed)](_0x4d5082,(_0x28d5fc,_0x139c24,_0x5bc594)=>{if(_0x28d5fc[_0x333267(0x272,0x25a,0x2e9,0x26c)]('.safetenso'+'rs'))return _0x28d5fc;function _0x333267(_0x15210b,_0x4a5530,_0x552119,_0x51f6cd){return _0x39110b(_0x51f6cd-0x2d5,_0x15210b,_0x552119-0xb3,_0x51f6cd-0x12d);}if(_0x5bc594[_0x333267(0x1b4,0x258,0x302,0x26c)](':'))return _0x5ca2ff(-0x120,-0x8,0xe,-0x59)+_0x139c24+('.safetenso'+_0x333267(0x2f8,0x3eb,0x370,0x334))+_0x5bc594+'>';function _0x5ca2ff(_0x3b9704,_0x238571,_0x2626d8,_0x537c90){return _0x39110b(_0x537c90- -0x12a,_0x238571,_0x2626d8-0x9f,_0x537c90-0x81);}return _0x5ca2ff(-0xa3,-0xc9,-0xfd,-0x59)+_0x139c24+(_0x5ca2ff(-0x143,-0x109,-0xf3,-0x10f)+_0x333267(0x3d3,0x36b,0x3a0,0x334))+_0x5bc594+_0x5ca2ff(-0x44,-0x9,0x4e,-0x47);});}}_0x19ad77=await _0xf82887[_0x6fc5ba(0x27c,0x37e,0x251,0x2ca)](replacepro,_0x19ad77,_0x1620a6),_0x19ad77=_0x39110b(-0x96,-0xb8,-0x161,-0x154)+'d\x22:\x22'+_0x33c35e+(_0x39110b(0xc6,0x4f,0xc0,0x32)+'\x22:')+_0x19ad77+'}',_0xf82887[_0x39110b(0x93,-0xb,0x100,0xb3)](addLog,_0x39110b(-0x45,0x6e,0x4,-0xf6)+'I\x20的最终\x20payl'+'oad:\x20'+_0x19ad77);let _0x530cb5=!![];while(_0x530cb5){window[_0x6fc5ba(0x294,0x282,0x1b4,0x262)]?_0x530cb5=![]:await _0xf82887[_0x39110b(-0x87,-0x120,0x19,-0x133)](sleep,-0x10cc+-0x2b6*0x6+-0x5b*-0x68);};try{window[_0x6fc5ba(0x2ee,0x2df,0x20a,0x262)]=!![],taskQueue[_0x6fc5ba(0x25a,0x26c,0x2e3,0x29f)+'us'](_0x32cee0,_0xf82887[_0x6fc5ba(0x1cd,0x2ff,0x245,0x277)]);let _0x5e801a;if(extension_settings[extensionName][_0x39110b(0x11,-0x20,0xcf,-0x6a)]===_0xf82887[_0x39110b(-0x12,-0x60,-0x7c,-0x4d)]){const _0x1909cb={};_0x1909cb[_0x6fc5ba(0x1f8,0x128,0x1cb,0x1fc)]=_0x4abbf7,_0x1909cb[_0x39110b(0xb0,0x12,0xda,0xa3)]=_0x19ad77;const _0x46feb5=await _0xf82887['wmYoR'](fetch,_0xf82887[_0x6fc5ba(0x234,0x1b4,0x20c,0x22d)],{'method':_0xf82887['RAJwX'],'body':JSON[_0x6fc5ba(0x2b9,0x1ec,0x2da,0x255)](_0x1909cb),'headers':_0xf82887[_0x6fc5ba(0x2d4,0x261,0x22a,0x2a0)](getRequestHeaders,window[_0x39110b(0xf4,0x119,0x70,0xbf)])});if(!_0x46feb5['ok']){const _0x567ad7=await _0x46feb5[_0x39110b(-0xd,-0x20,0x4d,0xb2)]();addLog(_0x39110b(0x4d,-0x41,0xc7,-0x8a)+_0x39110b(-0x6d,-0xca,-0x4f,-0x18)+'ient):\x20'+_0x567ad7);throw new Error(_0x6fc5ba(0x23e,0x10e,0x135,0x1ce)+_0x46feb5[_0x39110b(-0x29,-0xf7,-0x94,-0x31)]+_0x6fc5ba(0x1ea,0x289,0x1b0,0x288)+_0x567ad7);}const _0x65cfb0=await _0x46feb5['text']();let _0x5d2b72,_0x297a15;try{const _0x1b722e=JSON['parse'](_0x65cfb0);_0x5d2b72=_0x1b722e[_0x6fc5ba(0x213,0x219,0x287,0x2c5)],_0x297a15=_0x1b722e[_0x39110b(0x63,0x2b,0x11b,0xd4)];}catch(_0x477f3f){_0xf82887[_0x39110b(0x106,0x15f,0x7c,0x1a3)](addLog,_0x6fc5ba(0x26f,0x214,0x249,0x205)+'尝试作为原始\x20Bas'+_0x39110b(0x8f,0x1c,0x3a,0x48)),_0x5d2b72=_0xf82887[_0x39110b(-0x71,-0x4f,0x27,-0x54)],_0x297a15=_0x65cfb0;}if(!_0x297a15){if(_0xf82887[_0x39110b(0xee,0x180,0x11b,0x46)]!==_0x6fc5ba(0x2c4,0x2b7,0x247,0x2db)){_0xf82887[_0x39110b(0xe9,0xd8,0x17a,0x1a7)](addLog,_0x6fc5ba(0x2a4,0x18a,0x2a1,0x211)+_0x39110b(-0x9,-0x1a,0x13,-0xcf)+_0x39110b(0x23,-0x94,0x4a,0x7e)+'。');throw new Error(_0x39110b(0xd,-0x80,0xd6,0x41)+_0x39110b(0x47,0x11a,-0x7e,0x2a)+_0x6fc5ba(0x285,0x332,0x257,0x2d5)+_0x39110b(-0x18,-0x24,-0xa8,-0xa8));}else{_0xf82887['ySrUm'](_0x3a47e5,_0x6fc5ba(0x182,0x142,0x26f,0x1be)+_0x2a82d0+(_0x39110b(0xe5,0xf8,0x6c,0xb4)+_0x39110b(0x2a,0x1b,0x3f,-0x61)));const _0x33e3d7=_0x1efe5a[_0x2b05f9]?.[_0x6fc5ba(0x1c2,0x1de,0x1f8,0x1ea)+'he']?.['objectInfo']||{},_0x105960=_0x51ee47(_0x424190,_0x33e3d7);_0x564ca6=_0x249f95[_0x39110b(0x77,0xe9,0x86,0xbc)](_0x105960),_0x4ac64f(_0x39110b(0xb9,0xd6,0x16d,0x87)+'重映射连接'+(_0xf82887[_0x6fc5ba(0x201,0xa1,0x10a,0x174)](_0x8de8eb[_0x6fc5ba(0x148,0x16e,0x1d5,0x1f0)](_0x33e3d7)['length'],0x1a4f*0x1+-0x9e1+-0x106e)?_0x39110b(0x9e,0xe3,0xfd,0x7e):''));}}return addLog(_0x39110b(-0x58,-0xa6,0x4f,-0x120)+_0x39110b(-0x13,-0x5b,-0x86,0x83)+_0x39110b(0x51,0x8f,-0x73,0xca)),_0x5e801a=_0x39110b(0x4b,0xbf,0xcf,-0x25)+'/'+_0x5d2b72+_0x39110b(0x6e,0x6a,0x10c,-0x3e)+_0x297a15,{'image':_0x5e801a,'change':_0xf82887[_0x39110b(0x4e,0xdb,0x120,0x87)](_0x512710,''),'isVideo':![],'format':_0x5d2b72};}else{if(_0xf82887[_0x39110b(-0x4c,-0x79,-0x30,-0xcc)](_0x39110b(0x24,-0x3a,0x26,-0x3b),_0xf82887['fekbQ'])){if(_0x2ae70d['includes'](_0xf82887[_0x6fc5ba(0x203,0x226,0x18a,0x1e9)]))return _0x469a6a;if(_0x30bef3['includes'](':'))return'<lora:'+_0x41270b+('.safetenso'+_0x39110b(0x5f,0x0,-0x44,0x11b))+_0x4a0cd5+'>';return _0x39110b(0xd1,0x12e,0x177,0x119)+_0x56cff2+(_0x39110b(0x1b,-0x9e,0xab,-0x80)+_0x6fc5ba(0x2ce,0x242,0x1f9,0x23d))+_0x2d1632+_0x6fc5ba(0x2d0,0x374,0x214,0x2c1);}else{const _0x49a0c0=new URL(_0xf82887[_0x39110b(0xbc,0x137,0x88,0x16c)](_0x4abbf7,'/prompt')),_0x332b00={};_0x332b00[_0x39110b(-0x93,-0x15b,-0x87,-0xbc)]=_0xf82887[_0x6fc5ba(0x17c,0x112,0x15b,0x194)],_0x332b00['body']=_0x19ad77,_0x332b00[_0x39110b(0xb5,0x172,0x140,0xc)]={},_0x332b00[_0x39110b(0xb5,0x172,0x140,0xc)][_0x6fc5ba(0x292,0x24f,0x1e5,0x261)+'pe']=_0xf82887['Krtez'];const _0x1c4b2f=await fetch(_0x49a0c0,_0x332b00);if(!_0x1c4b2f['ok']){const _0x2b2fbf=await _0x1c4b2f[_0x6fc5ba(0x249,0x10f,0x100,0x1d1)]();_0xf82887[_0x39110b(0xf5,0x1cd,0x154,0xb5)](addLog,_0x6fc5ba(0x232,0x2cf,0x2d2,0x22b)+_0x6fc5ba(0xf1,0x260,0x258,0x18a)+_0x39110b(0xdb,0x76,0x1b,0x1c)+_0x2b2fbf);throw new Error('请求失败,状态码:\x20'+_0x1c4b2f[_0x39110b(-0x29,-0x1e,-0xb4,-0x5b)]+_0x39110b(0xaa,0xaf,0xcd,0x152)+_0x2b2fbf);}const _0x1fbc59=await _0x1c4b2f['json']();let _0xd5468f=_0x1fbc59[_0x6fc5ba(0xc1,0x1a2,0x142,0x197)],_0x152d4e=-0x1886+0x173*0x17+0x1*-0x8cf;while(!![]){try{if(!taskQueue['isTaskInQu'+'eue'](_0x32cee0)){if(_0xf82887[_0x6fc5ba(0x282,0x273,0x29a,0x2bb)]!==_0xf82887[_0x6fc5ba(0x319,0x224,0x28b,0x2bb)])_0x637ffc[_0x6fc5ba(0x252,0x225,0xd3,0x19b)+_0x2f4bb5+_0x39110b(0xda,0xc,0xf3,0x82)]&&(_0x39a2dc=_0xf82887[_0x39110b(0x78,0x6c,-0x16,0x7d)](_0xf82887[_0x6fc5ba(0x214,0x28f,0x235,0x296)](_0x112883,_0xf82887['Frezm']),_0x57246d(_0x46d3a7['Character\x20'+_0x5b8a03+_0x39110b(0xda,0x60,0x5d,0xda)])));else{_0xf82887[_0x39110b(-0x15,-0xb2,0xb0,0x3e)](addLog,_0xf82887[_0x39110b(-0x2d,-0x37,-0x2f,0xc)]);try{const _0x51d258={};_0x51d258[_0x6fc5ba(0x78,0x1cd,0x1a2,0x14b)]=_0x6fc5ba(0x21b,0x2df,0x2d5,0x258),await fetch(_0x4abbf7+(_0x39110b(0xa6,0x6d,0xf9,0xe9)+'rupt'),_0x51d258);}catch(_0x24b38e){console[_0x39110b(-0x6b,0x4b,-0x25,-0x122)](_0x39110b(0x53,0x3b,0x10e,0x93)+_0x39110b(0x82,0x159,0x54,0xe),_0x24b38e);}throw new Error(_0xf82887[_0x39110b(0xcc,0x25,0x70,0xb4)]);}}const _0x5444f9=await fetch(_0x4abbf7+_0x6fc5ba(0x2ed,0x2fe,0x295,0x240)+_0xd5468f);if(!_0x5444f9['ok']){_0xf82887['CgbuR'](addLog,_0x39110b(0x7f,0x152,0x1e,-0x51)+'\x20'+_0x5444f9[_0x39110b(-0x29,0x2d,-0x74,-0xf2)]);throw new Error(_0x39110b(-0x5,-0x41,0xb7,-0x9a)+_0x39110b(0x39,-0x39,0x10d,0x8d)+_0x6fc5ba(0x370,0x228,0x2be,0x2b7)+_0x5444f9[_0x39110b(-0x29,-0xf9,0xe,-0x64)]);}let _0x490fee=await _0x5444f9[_0x6fc5ba(0x2b8,0x25f,0x206,0x29c)]();console[_0x39110b(0xe4,0x149,0x1b3,0x71)](_0x6fc5ba(0x111,0x21e,0x1a0,0x1dc),_0x490fee);if(_0x490fee[_0x39110b(-0xc,-0xab,0x3b,-0x86)+_0x6fc5ba(0x1f1,0x221,0x228,0x1a3)](_0xd5468f)){if(_0xf82887[_0x6fc5ba(0x216,0x266,0x2b2,0x2dd)](_0xf82887[_0x6fc5ba(0x309,0x30d,0x170,0x243)],_0xf82887[_0x6fc5ba(0x1a3,0x173,0x2a9,0x243)]))_0x395314=_0x22de56[_0x6fc5ba(0x2f3,0x2af,0x337,0x2e9)](_0xf82887[_0x6fc5ba(0x222,0x27d,0x303,0x25c)],_0xf82887[_0x39110b(0xb6,0x9d,0x119,0xc6)]),_0x439b58=_0x98cf3b[_0x39110b(0x10b,0x38,0x55,0x13c)](_0xf82887[_0x39110b(0xb,0x2e,0x5f,0x3a)],'');else{function _0x3fffc0(_0x332648){function _0x53eac2(_0x10d765,_0x20c918,_0x4c4dcd,_0x333113){return _0x39110b(_0x10d765-0x25e,_0x333113,_0x4c4dcd-0x1f2,_0x333113-0x156);}const _0x351e07={'EaPZv':function(_0x2ffcfc,_0x26393d){function _0x2556a8(_0x2ebe25,_0xc9eba7,_0x1aa4c9,_0x521415){return _0xe681(_0xc9eba7- -0x26f,_0x1aa4c9);}return _0xf82887[_0x2556a8(-0xa7,-0x1e,0x22,-0x8c)](_0x2ffcfc,_0x26393d);},'kEuri':_0xf82887[_0x42f354(0x128,0x37,0xb3,0xec)],'OzQSK':function(_0x25f268,_0x229c2c){function _0xe65fb0(_0x59796f,_0x5d8ccc,_0x288e00,_0x4ea183){return _0x42f354(_0x59796f-0x1ca,_0x59796f,_0x288e00-0x1b2,_0x4ea183-0x1b6);}return _0xf82887[_0xe65fb0(0x35c,0x2cc,0x29b,0x36b)](_0x25f268,_0x229c2c);},'yvkbS':_0xf82887['RONdf'],'FggOA':_0xf82887[_0x53eac2(0x2ea,0x24b,0x255,0x23c)]};function _0x42f354(_0x53944c,_0x2492a4,_0x46cf2b,_0x500ce4){return _0x6fc5ba(_0x53944c-0xa3,_0x2492a4-0x75,_0x2492a4,_0x46cf2b- -0xb6);}if(_0xf82887[_0x53eac2(0x36e,0x409,0x2dd,0x3e9)](_0xf82887[_0x53eac2(0x1e4,0x10e,0x1c4,0x21d)],'FneDk')){_0x408bc5[_0x42f354(0x12d,0xfa,0x1ac,0x170)]=!![];if(_0x351e07[_0x42f354(0x174,0x68,0x12b,0x127)](_0x23d3ea[_0x42f354(0xd5,0x109,0x170,0x229)],_0x42f354(0x183,0x248,0x1b5,0x11b))){}else _0x371647[_0x42f354(0xa2,0x74,0xf9,0x17a)+'sk'](_0x523a34,![]);_0x29c85a=null,_0x1933a4(_0x42f354(0x18a,0x1c,0xb6,0x15)+_0x53eac2(0x2ef,0x2e4,0x23f,0x220)+_0xa4323b[_0x42f354(0x14e,0xf0,0x170,0x18f)]),_0x2aef55['error'](_0x351e07[_0x53eac2(0x2b3,0x247,0x28a,0x247)],_0x2a3833);throw _0x4c9bc5;}else{for(const _0x2e2299 in _0x332648){if(_0xf82887[_0x42f354(0x1a6,0x1e5,0x1e2,0x23f)](_0xf82887[_0x53eac2(0x229,0x1f2,0x20e,0x1c1)],_0xf82887[_0x42f354(0xdb,0xa8,0x149,0x1ee)])){_0x351e07[_0x53eac2(0x292,0x347,0x250,0x336)](_0x4205b6,_0x53eac2(0x26c,0x26d,0x299,0x263)+_0x568750);throw _0x2707a5;}else{const _0xe5dd77=_0x332648[_0x2e2299];if(_0xe5dd77['images']&&_0xe5dd77['images'][_0x42f354(0x11,0xa1,0xb5,0xec)]>-0x50*0x76+-0x8*-0x2f7+0x4*0x34a){if(_0xf82887['VlFny']===_0x53eac2(0x335,0x263,0x2e9,0x2d3)){const _0x5bd750=_0x92a99f[_0x53eac2(0x1ea,0x175,0x16d,0x207)][0x58*-0x37+0x270b+-0x1423],_0x1abbf8=_0x5bd750[_0x42f354(0x164,0x2dd,0x20f,0x1e3)]&&_0x5bd750[_0x42f354(0x1bd,0x190,0x20f,0x1c9)][_0x53eac2(0x32b,0x280,0x3b7,0x3e2)](_0x351e07[_0x53eac2(0x2cb,0x2ab,0x2c0,0x38e)]),_0x44e837={};return _0x44e837[_0x42f354(0x17c,0x1ef,0x234,0x1b4)]=_0x5bd750[_0x53eac2(0x36a,0x322,0x29c,0x3f7)],_0x44e837[_0x53eac2(0x31e,0x2e6,0x3e0,0x263)]=_0x5bd750[_0x42f354(0x179,0x157,0x1e8,0x1e0)]||'',_0x44e837[_0x42f354(0x11e,0x21f,0x180,0xb8)]=_0x1abbf8,_0x44e837['format']=_0x5bd750[_0x53eac2(0x345,0x29a,0x3ff,0x297)]||_0x351e07[_0x53eac2(0x274,0x2ca,0x1b3,0x325)],_0x44e837;}else{const _0x2337d4={};return _0x2337d4[_0x42f354(0x284,0x1d8,0x234,0x1f6)]=_0xe5dd77['images'][0xa81+-0x238*0xb+0x1*0xde7]['filename'],_0x2337d4[_0x42f354(0x137,0x2ac,0x1e8,0x1d1)]=_0xe5dd77[_0x42f354(0x1d9,0x14a,0x15d,0x1a7)][-0x548+-0x515*-0x1+0x3*0x11]['subfolder']||'',_0x2337d4[_0x53eac2(0x2b6,0x22c,0x24f,0x276)]=![],_0x2337d4[_0x42f354(0x2be,0x2be,0x20f,0x2c0)]=_0xf82887[_0x53eac2(0x207,0x19f,0x1a0,0x201)],_0x2337d4;}}if(_0xe5dd77[_0x42f354(0x56,-0xf,0xb4,0x151)]&&_0xe5dd77[_0x42f354(0x69,0xc,0xb4,0x169)][_0x42f354(0xd9,0x175,0xb5,0x18)]>-0x197d+0x1*-0x1c2b+0x35a8){const _0x6d5c29=_0xe5dd77['gifs'][0x17f*-0x6+0x257+-0x1*-0x6a3],_0x375ea0=_0x6d5c29['format']&&_0x6d5c29[_0x42f354(0x298,0x2c1,0x20f,0x25b)]['startsWith'](_0xf82887[_0x42f354(0x245,0x27b,0x23e,0x254)]),_0xe5a8f0={};return _0xe5a8f0[_0x42f354(0x285,0x17c,0x234,0x284)]=_0x6d5c29[_0x53eac2(0x36a,0x3d6,0x300,0x42d)],_0xe5a8f0['subfolder']=_0x6d5c29['subfolder']||'',_0xe5a8f0[_0x42f354(0x156,0x175,0x180,0x1a4)]=_0x375ea0,_0xe5a8f0[_0x53eac2(0x345,0x400,0x3cd,0x3da)]=_0x6d5c29[_0x42f354(0x2a6,0x27c,0x20f,0x17f)]||_0xf82887['XsAUa'],_0xe5a8f0;}}}return null;}}let _0x35efc1=_0xf82887['siIDj'](_0x3fffc0,_0x490fee[_0xd5468f][_0xf82887[_0x6fc5ba(0x186,0x2c1,0x1a9,0x210)]]);if(!_0x35efc1)throw new Error(_0x6fc5ba(0x252,0x32e,0x37d,0x2cb)+_0x6fc5ba(0x290,0x1b8,0x32d,0x267));window[_0x39110b(0x25,0xb,-0x54,-0xa9)+_0x39110b(-0x7b,-0x128,-0xa0,-0x5c)]=_0x35efc1;const _0x11ecd5=_0x35efc1[_0x39110b(0x58,0xda,-0x49,0x9b)]?'视频':'图片';_0xf82887['ITamN'](addLog,_0x11ecd5+('生成成功\x20(dire'+_0x6fc5ba(0x182,0x174,0x1db,0x151)+')。'));let _0x2726b5=_0x4abbf7+('/view?file'+_0x6fc5ba(0x214,0x2cc,0x22f,0x2bd))+_0x35efc1[_0x6fc5ba(0x307,0x2f7,0x2f3,0x2ea)]+(_0x6fc5ba(0x22c,0x26c,0x37e,0x2d6)+'=')+_0xf82887[_0x39110b(0xc5,0xff,0x196,0x3)](encodeURIComponent,_0x35efc1[_0x6fc5ba(0x344,0x367,0x264,0x29e)])+(_0x39110b(-0x44,-0xec,0x91,0x3d)+'ut');const _0x452aff=await _0xf82887['eSDHU'](fetch,_0x2726b5);if(!_0x452aff['ok']){if(_0xf82887[_0x6fc5ba(0x27b,0x2b4,0x1db,0x1f2)](_0xf82887[_0x39110b(-0x86,-0x26,-0x116,0x7)],_0xf82887['qAfkY']))throw new Error(_0x6fc5ba(0x1bb,0x283,0x173,0x21a)+':\x20'+_0x452aff[_0x39110b(-0x29,-0x71,-0x6e,-0x63)]);else _0x2e632d=![];}let _0x424c9d=await _0x452aff[_0x39110b(0xb2,0x12f,0x13f,0x94)]();if(_0x35efc1[_0x39110b(0x58,0x11,0xaf,0x128)]){if(_0xf82887[_0x39110b(0x67,0xa8,0x9d,0x12e)](_0xf82887[_0x6fc5ba(0x1ff,0x100,0x20d,0x155)],_0xf82887[_0x6fc5ba(0x182,0xc9,0xa2,0x155)])){let _0xc62d0a=_0xf82887['qkXwt'];if(_0x35efc1[_0x39110b(0xe7,0x8f,0x2e,0x34)]){if(_0x35efc1['format'][_0x39110b(-0x69,-0x109,-0x140,-0x4a)](_0xf82887[_0x6fc5ba(0x1d6,0x1c8,0x172,0x184)])){if(_0xf82887[_0x6fc5ba(0x2da,0x1f5,0x2e2,0x274)](_0xf82887[_0x39110b(-0x59,-0xbc,0x7d,-0xf9)],_0x6fc5ba(0xbe,0x1bf,0x162,0x181)))_0xc62d0a=_0xf82887[_0x39110b(0x40,0xfc,0x63,0xa3)];else{const _0x30b677=_0x4b08f6[_0x39110b(0x5e,-0x4f,0xae,-0x37)](_0x16c459);_0x290948=_0x30b677[_0x39110b(0xe7,0x11c,0x8d,0xfd)],_0x106246=_0x30b677['data'];}}else(_0x35efc1[_0x6fc5ba(0x34b,0x2b5,0x371,0x2c5)][_0x39110b(-0x69,0x15,-0x103,-0x60)]('mp4')||_0x35efc1[_0x39110b(0xe7,0x69,0x11,0x149)][_0x39110b(-0x69,-0xcc,-0x2a,0x40)](_0xf82887[_0x39110b(-0x5f,-0x35,-0x5e,-0xea)]))&&(_0xc62d0a=_0xf82887[_0x6fc5ba(0x28b,0x2ce,0x289,0x299)]);}const _0x445cc9=await _0x424c9d[_0x6fc5ba(0x157,0x1a1,0x1ab,0x1e6)+'r'](),_0x1ffe6a={};_0x1ffe6a['type']=_0xc62d0a,_0x424c9d=new Blob([_0x445cc9],_0x1ffe6a),console[_0x6fc5ba(0x271,0x2d5,0x2be,0x2c2)](_0x6fc5ba(0x292,0x2f9,0x2ac,0x231)+_0x6fc5ba(0x1cd,0x248,0x164,0x20c)+'修正:\x20'+_0x35efc1[_0x6fc5ba(0x22f,0x210,0x214,0x2c5)]+_0x6fc5ba(0x199,0x251,0x11b,0x1a7)+_0xc62d0a);}else _0x33aaa2[_0x39110b(-0x6b,-0x2f,-0x46,-0x51)](_0xf82887[_0x39110b(-0x8,0xa9,0x40,-0xc1)],_0x20463);}_0x5e801a=await new Promise((_0x59e70a,_0x473d53)=>{function _0x389a96(_0xd323f3,_0xf029a3,_0x5a8141,_0x2f34e5){return _0x39110b(_0xd323f3- -0xe9,_0x5a8141,_0x5a8141-0x1db,_0x2f34e5-0x1d);}const _0x3d654e=new FileReader();_0x3d654e[_0x329c8e(-0xbb,-0xba,-0x10e,-0x169)]=()=>_0x59e70a(_0x3d654e['result']);function _0x329c8e(_0x3da618,_0x36a531,_0x1de716,_0x224adb){return _0x39110b(_0x36a531- -0xf7,_0x3da618,_0x1de716-0x9e,_0x224adb-0x78);}_0x3d654e['onerror']=_0x473d53,_0x3d654e['readAsData'+_0x329c8e(-0xb9,-0x57,-0x88,0x39)](_0x424c9d);});break;}}await sleep(0x2*0xefe+0x2710+-0x4124),_0x152d4e++;if(_0xf82887[_0x39110b(-0x55,0x16,0x3a,0x5f)](_0x152d4e,0x47*0x35+0x223f*0x1+-0x2*0x1685)){_0xf82887[_0x39110b(-0x6,-0xd9,0x5e,0x11)](addLog,_0x6fc5ba(0x216,0x32f,0x197,0x257)+'），服务器可能已断开'+_0x39110b(0x4c,0x10a,0xfe,0xe9));throw new Error(_0xf82887['jYZDS']);}}catch(_0x25bb04){if(_0xf82887[_0x6fc5ba(0x306,0x2fe,0x1b7,0x239)](_0xf82887[_0x6fc5ba(0x185,0xd6,0x20e,0x1a6)],_0xf82887[_0x6fc5ba(0x224,0x1c5,0x14d,0x216)])){_0xf82887[_0x6fc5ba(0x146,0x120,0x214,0x191)](addLog,_0x39110b(0xe,-0xc2,-0xa7,0xa5)+_0x25bb04);throw _0x25bb04;}else{if(_0x1aad53){const _0x44ecea=_0x541ef0['apply'](_0x361553,arguments);return _0x3f552e=null,_0x44ecea;}}}}window[_0x6fc5ba(0x1dc,0x1cc,0x318,0x262)]=!![];if(!_0x5e801a)throw new Error('未能生成图片\x20URL'+'。');const _0x343b78=window[_0x39110b(0x25,0x68,-0x82,0x30)+_0x39110b(-0x7b,0x4a,0x10,0x3e)]?.['isVideo']||![],_0x3e5846=window[_0x39110b(0x25,-0x5c,-0x3,-0xa4)+_0x6fc5ba(0xce,0x218,0x115,0x163)]?.[_0x6fc5ba(0x32a,0x303,0x216,0x2c5)]||_0xf82887[_0x6fc5ba(0x13a,0x1e2,0xd8,0x187)];addLog(_0x6fc5ba(0x139,0xb7,0x1bf,0x17d)+(_0x343b78?'视频':'图片')+(_0x39110b(0x61,0x58,-0x10,0x6d)+_0x39110b(-0x7e,-0x94,-0x11f,-0x143)+'L。')),taskQueue[_0x6fc5ba(0x103,0x1a1,0xfd,0x1af)+'sk'](_0x32cee0,!![]),currentTaskId=null;const _0x3624b5={};return _0x3624b5[_0x39110b(-0x34,0x72,-0xdb,-0x36)]=_0x5e801a,_0x3624b5['change']=_0x512710||'',_0x3624b5[_0x6fc5ba(0x2bb,0x276,0x2ca,0x236)]=_0x343b78,_0x3624b5[_0x6fc5ba(0x1f1,0x33d,0x339,0x2c5)]=_0x3e5846,_0x3624b5;}}}catch(_0x542df4){const _0x3104aa=_0xf82887[_0x39110b(0x109,0x61,0x91,0xa2)][_0x39110b(0x113,0x1e5,0xcf,0x1b4)]('|');let _0xd64c95=0x766+0x106f+-0x17d5;while(!![]){switch(_0x3104aa[_0xd64c95++]){case'0':window[_0x39110b(0x84,0x12,0x6b,0xc4)]=!![];continue;case'1':throw _0x542df4;continue;case'2':console[_0x6fc5ba(0x284,0x18b,0x2ac,0x221)](_0xf82887[_0x6fc5ba(0x1f4,0xa9,0x19a,0x169)],_0x542df4);continue;case'3':addLog(_0x39110b(-0x72,0x0,0x8,0xe)+'误:\x20'+_0x542df4[_0x6fc5ba(0x1c5,0x2df,0x186,0x226)]);continue;case'4':currentTaskId=null;continue;case'5':if(_0x542df4[_0x6fc5ba(0x1c9,0x1f1,0x20d,0x226)]===_0xf82887['sEuUm']){}else taskQueue['completeTa'+'sk'](_0x32cee0,![]);continue;}break;}}}async function comfyuigenerate(_0x5414b4){const _0x5678de={'NLbnW':_0x1ab179(0x401,0x41b,0x4d1,0x3e5)+_0x1ab179(0x3aa,0x364,0x369,0x436),'eEdhj':'3|0|4|2|1','ynZyi':'请填写ComfyUI'+'模型。','QQtgB':function(_0x22c209,_0x461f16){return _0x22c209(_0x461f16);},'ZJHAk':'{修图}','VLDIg':function(_0x54630d,_0x5e1578){return _0x54630d===_0x5e1578;},'jRFRO':_0x1d30b6(0x66e,0x5a8,0x631,0x624),'fIIkh':function(_0x4397c5,_0x51e984){return _0x4397c5!==_0x51e984;},'uBtsZ':_0x1ab179(0x48a,0x4aa,0x40b,0x4fe),'abhGE':_0x1ab179(0x402,0x32d,0x3a9,0x3da),'qEprW':function(_0x30d7b3,_0xaf1545,_0x101b0e,_0x5ae034){return _0x30d7b3(_0xaf1545,_0x101b0e,_0x5ae034);},'NDFtC':function(_0x28245c,_0x1eeacd){return _0x28245c!==_0x1eeacd;},'XbfXo':'THNxQ','KHgpV':function(_0x42b41b,_0x32a664){return _0x42b41b(_0x32a664);},'drftD':function(_0x4e355c,_0x3bcfd2){return _0x4e355c||_0x3bcfd2;},'qucKj':_0x1ab179(0x3d1,0x362,0x38b,0x480),'ZwIsd':_0x1d30b6(0x698,0x681,0x6f0,0x750)+_0x1ab179(0x4dd,0x56d,0x5b1,0x46e)+_0x1ab179(0x4e6,0x5a1,0x4e7,0x4ea),'UFIYw':function(_0x535ffd,_0x272988){return _0x535ffd||_0x272988;},'fUehL':_0x1ab179(0x509,0x5ae,0x57d,0x5d4)+_0x1d30b6(0x57a,0x516,0x519,0x4e6)+'ge:'};function _0x1d30b6(_0x5aa805,_0x289997,_0x1b2e3c,_0x151060){return _0xe681(_0x289997-0x3e5,_0x5aa805);}let {id:_0x480fc7,prompt:_0xa7888d,width:_0x38055a,height:_0x16607b,change:_0x1e5f05}=_0x5414b4;_0x5678de['QQtgB'](addLog,'收到生图请求\x20(ID'+':\x20'+_0x480fc7+(')\x20-\x20Prompt'+':\x20')+_0xa7888d+(_0x1e5f05?'\x20-\x20Change:'+'\x20'+_0x1e5f05:''));function _0x1ab179(_0x5d7223,_0x51af0a,_0x357840,_0x57592b){return _0xe681(_0x5d7223-0x26e,_0x51af0a);}if(_0x1e5f05&&_0x1e5f05['includes'](_0x5678de[_0x1ab179(0x3e7,0x331,0x32e,0x377)])){if(_0x5678de[_0x1d30b6(0x6ac,0x604,0x5a7,0x695)](_0x5678de[_0x1ab179(0x499,0x4cf,0x555,0x3ce)],_0x5678de['jRFRO'])){_0x5678de['QQtgB'](bananaGenerate,_0x5414b4);return;}else throw new _0x1e302f(_0x1ab179(0x441,0x400,0x480,0x3e5)+':\x20'+_0x17fdba[_0x1d30b6(0x4ba,0x553,0x617,0x4c4)]);}try{if(_0x5678de[_0x1ab179(0x482,0x451,0x4aa,0x46f)](_0x5678de[_0x1d30b6(0x61c,0x613,0x69e,0x636)],_0x5678de[_0x1d30b6(0x53c,0x591,0x4be,0x57e)])){const {image:_0x198be6,change:_0x48e5b5,isVideo:_0x530bb8,format:_0x185c24}=await _0x5678de['QQtgB'](generateComfyUIImage,{'prompt':_0xa7888d,'width':_0x38055a,'height':_0x16607b,'change':_0x1e5f05});if(extension_settings[extensionName][_0x1d30b6(0x4db,0x4fc,0x462,0x4c5)]!='0'){const _0x80faef={};_0x80faef[_0x1ab179(0x4a4,0x4e2,0x478,0x527)]=_0x48e5b5,_0x80faef[_0x1ab179(0x45d,0x492,0x413,0x44c)]=_0x530bb8,_0x80faef['format']=_0x185c24,await _0x5678de[_0x1d30b6(0x5cb,0x5e8,0x5cb,0x5bf)](setItemImg,_0xa7888d,_0x198be6,_0x80faef),addLog((_0x530bb8?'视频':'图像')+('已存入数据库\x20for'+_0x1d30b6(0x637,0x5eb,0x629,0x55c))+_0xa7888d);}else _0x5678de['NDFtC'](_0x1d30b6(0x6c3,0x621,0x66f,0x555),_0x5678de['XbfXo'])?(_0x29c4df[_0x1d30b6(0x639,0x689,0x69c,0x704)+_0x1d30b6(0x4da,0x595,0x513,0x57b)](_0x32a271[_0x1ab179(0x517,0x5d9,0x50d,0x4aa)+_0x1ab179(0x3d5,0x406,0x443,0x49b)+'ST'],_0x12a01b),_0x2ed043['initialize'+_0x1ab179(0x45f,0x4e9,0x48a,0x4d6)+_0x1ab179(0x507,0x49d,0x55b,0x527)]=![],_0x2a3014(_0x5678de[_0x1d30b6(0x475,0x500,0x5a1,0x5a4)])):_0x5678de['KHgpV'](addLog,'缓存设置为不存入数据'+'库');eventSource[_0x1ab179(0x476,0x42d,0x53a,0x3e4)](EventType[_0x1d30b6(0x6d2,0x68e,0x6b5,0x686)+_0x1ab179(0x4a1,0x456,0x42e,0x448)+_0x1d30b6(0x6e5,0x625,0x571,0x5d7)],{'id':_0x480fc7,'success':!![],'imageData':_0x198be6,'prompt':_0xa7888d,'change':_0x48e5b5,'isVideo':_0x5678de[_0x1d30b6(0x62f,0x565,0x52f,0x5b6)](_0x530bb8,![]),'format':_0x5678de['drftD'](_0x185c24,_0x5678de[_0x1d30b6(0x651,0x646,0x69d,0x6a5)])}),eventSource[_0x1d30b6(0x682,0x5ed,0x529,0x6bf)](_0x5678de['ZwIsd'],{'id':_0x480fc7,'success':!![],'imageData':_0x198be6,'prompt':_0xa7888d,'change':_0x48e5b5,'isVideo':_0x5678de[_0x1d30b6(0x508,0x565,0x4cc,0x56d)](_0x530bb8,![]),'format':_0x5678de['UFIYw'](_0x185c24,_0x5678de['qucKj'])}),_0x5678de[_0x1ab179(0x371,0x2a7,0x2a7,0x3d1)](addLog,'发送'+(_0x530bb8?'视频':'图片')+(_0x1ab179(0x47a,0x3ea,0x50e,0x40d)+':\x20')+_0x480fc7+')');}else{const _0x2a873c=_0x5678de[_0x1d30b6(0x595,0x633,0x6fa,0x5ef)][_0x1d30b6(0x607,0x68f,0x764,0x664)]('|');let _0x5e6df9=-0x1*0x42e+0x8c7+-0x499;while(!![]){switch(_0x2a873c[_0x5e6df9++]){case'0':_0x56a25c[_0x1d30b6(0x618,0x5bf,0x518,0x511)](_0x5678de['ynZyi']);continue;case'1':return;case'2':_0x5d9d11=null;continue;case'3':_0x5678de['QQtgB'](_0x50e281,_0x5678de['ynZyi']);continue;case'4':_0x2959fb[_0x1d30b6(0x5b9,0x54d,0x5f9,0x5bd)+'sk'](_0x1e289a,![]);continue;}break;}}}catch(_0x1ace28){const _0x44c85c='生图流程捕获到异常\x20'+_0x1ab179(0x475,0x4fd,0x4b9,0x494)+_0x480fc7+'):\x20'+_0x1ace28['message'];addLog(_0x1ab179(0x4d8,0x550,0x41a,0x504)+_0x44c85c),console[_0x1d30b6(0x54b,0x5bf,0x651,0x5f5)](_0x5678de[_0x1d30b6(0x54d,0x620,0x5ca,0x6b6)],_0x1ace28);const _0x4947d8={};_0x4947d8['id']=_0x480fc7,_0x4947d8[_0x1d30b6(0x6a9,0x630,0x615,0x68c)]=![],_0x4947d8['error']=_0x1ace28[_0x1ab179(0x44d,0x3ae,0x41e,0x3f5)],_0x4947d8['prompt']=_0xa7888d,eventSource[_0x1d30b6(0x562,0x5ed,0x599,0x5f2)](EventType[_0x1d30b6(0x5d0,0x68e,0x627,0x60c)+_0x1ab179(0x4a1,0x463,0x519,0x3dc)+'NSE'],_0x4947d8);const _0x1b5f9f={};_0x1b5f9f['id']=_0x480fc7,_0x1b5f9f[_0x1ab179(0x4b9,0x50b,0x549,0x57c)]=![],_0x1b5f9f['error']=_0x1ace28[_0x1d30b6(0x580,0x5c4,0x51b,0x659)],_0x1b5f9f[_0x1ab179(0x4b5,0x569,0x403,0x50e)]=_0xa7888d,eventSource[_0x1d30b6(0x65a,0x5ed,0x52f,0x52f)](_0x5678de[_0x1ab179(0x4ac,0x460,0x4b0,0x4d9)],_0x1b5f9f),_0x5678de[_0x1d30b6(0x4ba,0x571,0x5cf,0x5fd)](addLog,_0x1d30b6(0x635,0x652,0x66c,0x682)+_0x1ab179(0x436,0x3cd,0x497,0x3a9)+_0x480fc7+')');}}function initializeComfyuiListener(){function _0x3f21f6(_0x2fac61,_0x2c04ab,_0x52c7da,_0x1cf5ef){return _0xe681(_0x1cf5ef- -0x1ce,_0x2c04ab);}const _0x504aff={'PczKk':function(_0xdbd7b9,_0x579476){return _0xdbd7b9(_0x579476);},'zarRx':_0x11586d(0x134,0x18b,0x239,0xcd)+_0x3f21f6(0x154,0xff,0x15c,0xc5)+'含旧版兼容）。'};function _0x11586d(_0x26f5cf,_0xaf17be,_0x2709f5,_0x18f5b7){return _0xe681(_0xaf17be- -0x8,_0x2709f5);}eventSource['on'](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],comfyuigenerate),_0x504aff[_0x3f21f6(-0xe2,-0x2d,-0x100,-0x8a)](addLog,_0x504aff[_0x3f21f6(-0x49,-0x117,-0x21,-0xa6)]);}export async function replaceWithcomfyui(){function _0x4c7178(_0x45fe48,_0x4b0e5a,_0xe18ac0,_0x519082){return _0xe681(_0x519082- -0x10a,_0xe18ac0);}function _0x507183(_0x4dec87,_0x427c65,_0x3d1c78,_0x3d431d){return _0xe681(_0x3d431d- -0x33d,_0x4dec87);}const _0x1f9cf6={'pTuyU':function(_0x4a3ffd,_0x34ada2){return _0x4a3ffd(_0x34ada2);},'doTbj':function(_0x3673bc,_0x492581){return _0x3673bc==_0x492581;},'FWfeK':_0x4c7178(0x12d,0x101,-0x75,0x62),'CwOag':function(_0x5330ab,_0xcf7604){return _0x5330ab!==_0xcf7604;},'UxcBr':_0x507183(-0x1bd,-0x14b,-0x16a,-0x19f),'XypKP':function(_0x5a3d0f){return _0x5a3d0f();},'xcgEm':function(_0x188594){return _0x188594();},'EGNML':'CsSdG','wDLiQ':_0x4c7178(0x6d,-0x3b,0x72,-0xa)};if(_0x1f9cf6[_0x507183(-0x189,-0xd7,-0x203,-0x187)](extension_settings[extensionName][_0x4c7178(0x98,0x10b,0x14c,0x135)],_0x1f9cf6[_0x4c7178(0x5f,0x106,0x7c,0xa5)])){if(_0x1f9cf6['CwOag'](_0x4c7178(0xd7,0xc3,0x7e,0x94),_0x1f9cf6['UxcBr'])){const _0x1bcc1f=new _0x2604ff();_0x1bcc1f[_0x4c7178(0x198,0x48,0x150,0xca)]=()=>_0x3f3582(_0x1bcc1f[_0x507183(-0x2f6,-0x1a4,-0x29f,-0x235)]),_0x1bcc1f['onerror']=_0x1017b5,_0x1bcc1f[_0x507183(-0x136,-0xfa,-0x1c7,-0x1bc)+'URL'](_0x1bfd31);}else!window[_0x507183(-0x1c1,-0x273,-0x17f,-0x1a1)+_0x507183(-0xec,-0x14d,-0xd5,-0x14c)+_0x4c7178(0x129,0x16c,0x144,0x18f)]&&(window[_0x507183(-0x127,-0xde,-0x25d,-0x1a1)+_0x4c7178(0x143,0xbb,0x10c,0xe7)+_0x507183(-0x91,-0x11b,-0x131,-0xa4)]=!![],_0x1f9cf6[_0x4c7178(0x15b,0x234,0x157,0x15f)](initializeComfyuiListener)),_0x1f9cf6['xcgEm'](initializeImageProcessing);}else{if(window[_0x4c7178(-0x3,0x5f,0xea,0x92)+_0x4c7178(0x41,0x12f,0x20,0xe7)+_0x4c7178(0x1f8,0x255,0x23d,0x18f)]){if(_0x1f9cf6['CwOag'](_0x1f9cf6[_0x507183(-0x117,-0x1c8,-0x184,-0x1c9)],_0x1f9cf6[_0x507183(-0xe3,-0x270,-0x265,-0x1a0)]))eventSource[_0x4c7178(0x1e6,0x263,0xc7,0x19a)+_0x507183(-0xfe,-0x115,-0x20f,-0x18d)](EventType[_0x4c7178(0xce,0x136,0x215,0x19f)+_0x507183(-0x219,-0x2ae,-0x25b,-0x1d6)+'ST'],comfyuigenerate),window[_0x4c7178(-0x36,0xeb,0x119,0x92)+_0x4c7178(0xb9,0xeb,0x17e,0xe7)+_0x507183(-0x164,-0x2d,-0x10d,-0xa4)]=![],_0x1f9cf6[_0x4c7178(0x113,0x14f,0xdd,0x8f)](addLog,_0x4c7178(0x44,0xb0,0x84,0x89)+_0x4c7178(-0x9,-0x8e,0xcf,0x32));else{_0x1f9cf6[_0x4c7178(0x41,0x103,0x64,0x8f)](_0x523698,_0x4c7178(0x8f,0x94,0x101,0x10c)+'\x20'+_0x3ba127[_0x507183(-0x195,-0x1f8,-0x1b6,-0x1cf)]);throw new _0x11ee0a(_0x507183(-0x180,-0x1e6,-0x182,-0x1ab)+_0x4c7178(0xe7,0xab,0x104,0xc6)+_0x4c7178(0xb9,0xdd,0xa9,0x166)+_0x2d6125[_0x4c7178(0x74,0x53,-0xe,0x64)]);}}}}