function _0x2c1c27(_0x1c1d5a,_0x4bcc88,_0x5e1a78,_0x22eef8){return _0x2fb5(_0x5e1a78- -0x12b,_0x1c1d5a);}(function(_0x34d8d8,_0x109196){function _0x162f36(_0x2ad447,_0x5a8e5e,_0x4c2795,_0x528596){return _0x2fb5(_0x5a8e5e- -0x292,_0x528596);}function _0x18531c(_0x497dfe,_0x56a261,_0x234a1c,_0x18a251){return _0x2fb5(_0x497dfe- -0x3c9,_0x56a261);}const _0x470079=_0x34d8d8();while(!![]){try{const _0x23d6f5=-parseInt(_0x162f36(-0xa4,-0xa0,-0x24,-0x165))/(-0xd28+-0xf79*0x2+0x2c1b)+-parseInt(_0x162f36(-0x99,-0x8d,-0x2d,-0x12c))/(0x55*0x41+0x2079+-0x360c)*(parseInt(_0x18531c(-0x183,-0x1ab,-0x11e,-0xcf))/(-0x1*0x222d+0x1*-0x21ec+0x3*0x16b4))+-parseInt(_0x18531c(-0x120,-0x79,-0x53,-0x7d))/(0x69d+0x22e9+0xe*-0x2f7)+-parseInt(_0x162f36(-0x72,-0x73,-0x152,0x13))/(0x5d2*-0x1+-0x11*0x14c+0x1be3)+parseInt(_0x18531c(-0x176,-0x1b8,-0x222,-0x1c1))/(-0xfea+-0x1*0x1ed+0x11*0x10d)*(-parseInt(_0x18531c(-0xcd,-0x14f,-0x5b,-0x159))/(-0x1e07+0x1*0x1cd6+0x8*0x27))+parseInt(_0x162f36(0x13c,0x106,0x3d,0x84))/(-0x1e*0xc9+0x1b42+0xeb*-0x4)*(parseInt(_0x18531c(-0xd8,-0x54,-0xdf,-0x133))/(-0x1fb*0x1+-0x8b2+0x392*0x3))+parseInt(_0x162f36(0x39,-0x3b,0x21,0x2f))/(0x1443+-0x2702+0x15*0xe5);if(_0x23d6f5===_0x109196)break;else _0x470079['push'](_0x470079['shift']());}catch(_0xad80ec){_0x470079['push'](_0x470079['shift']());}}}(_0xd010,-0x1*-0x28adb+-0xbf*-0x65d+0x3*-0x12c03));const _0x28e042=(function(){const _0x5661bb={};_0x5661bb[_0x4332e1(0x58a,0x5ba,0x517,0x5df)]=_0x47688c(0x4d9,0x563,0x53e,0x47f);function _0x47688c(_0x3ebfdf,_0x1c9100,_0x4d1a3f,_0x175efa){return _0x2fb5(_0x4d1a3f-0x29e,_0x1c9100);}function _0x4332e1(_0x2b1ce3,_0x335562,_0x507d94,_0x1dad83){return _0x2fb5(_0x2b1ce3-0x286,_0x335562);}_0x5661bb[_0x4332e1(0x4a0,0x57c,0x485,0x471)]=_0x47688c(0x504,0x522,0x514,0x53c),_0x5661bb[_0x47688c(0x571,0x5a3,0x60b,0x659)]=_0x4332e1(0x4da,0x498,0x49f,0x5ac),_0x5661bb[_0x47688c(0x4cd,0x5c9,0x584,0x4a9)]=_0x4332e1(0x5a2,0x5dd,0x50c,0x669),_0x5661bb[_0x4332e1(0x535,0x51b,0x523,0x52a)]='Qfcsy';const _0x495989=_0x5661bb;let _0x52e12a=!![];return function(_0xb0bda9,_0x15cf08){const _0x196370=_0x52e12a?function(){const _0x315668={};_0x315668[_0x55b73a(0x448,0x412,0x458,0x501)]=_0x495989[_0x4c1688(0x4b5,0x4ff,0x58b,0x617)],_0x315668[_0x55b73a(0x4e5,0x4a1,0x4fc,0x50a)]=_0x495989[_0x4c1688(0x540,0x403,0x4a1,0x41d)],_0x315668[_0x4c1688(0x4d8,0x546,0x52c,0x4a8)]=_0x495989[_0x4c1688(0x5c2,0x62b,0x5f4,0x6a0)];const _0x5220fa=_0x315668;function _0x55b73a(_0x4cdfe5,_0x55578b,_0x5626d0,_0x143a4a){return _0x2fb5(_0x5626d0-0x231,_0x4cdfe5);}function _0x4c1688(_0x54ca39,_0x20f768,_0x190102,_0x473783){return _0x2fb5(_0x190102-0x287,_0x473783);}if(_0x15cf08){if(_0x495989[_0x55b73a(0x5a8,0x548,0x517,0x438)]!==_0x495989[_0x4c1688(0x5fa,0x4e6,0x536,0x462)]){const _0x20c68d=_0x15cf08['apply'](_0xb0bda9,arguments);return _0x15cf08=null,_0x20c68d;}else{if(_0x353db1[_0x4c1688(0x514,0x5db,0x50e,0x49c)][_0x55b73a(0x60a,0x53e,0x5ba,0x551)](_0x5220fa[_0x55b73a(0x503,0x3fd,0x458,0x3be)]))_0x44fc0f='video/webm';else(_0x230666[_0x4c1688(0x503,0x504,0x50e,0x4bc)][_0x55b73a(0x619,0x607,0x5ba,0x52a)](_0x5220fa[_0x4c1688(0x600,0x58a,0x552,0x589)])||_0x95203b[_0x4c1688(0x490,0x549,0x50e,0x580)][_0x4c1688(0x580,0x52c,0x610,0x63e)](_0x55b73a(0x404,0x4a0,0x4d0,0x41e)))&&(_0x4a7492=_0x5220fa[_0x4c1688(0x565,0x574,0x52c,0x471)]);}}}:function(){};return _0x52e12a=![],_0x196370;};}()),_0x63ec80=_0x28e042(this,function(){const _0x36b064={};function _0x2d864b(_0x535850,_0x504d0e,_0x252f97,_0x5d78a2){return _0x2fb5(_0x535850-0xee,_0x252f97);}_0x36b064[_0x41b1a3(0x3a0,0x3ca,0x322,0x321)]=_0x41b1a3(0x41d,0x3cf,0x3c3,0x40f)+'+$';const _0x11412d=_0x36b064;function _0x41b1a3(_0x5460ea,_0x435249,_0x11a53f,_0x5b54ce){return _0x2fb5(_0x435249-0x1d0,_0x5b54ce);}return _0x63ec80['toString']()[_0x41b1a3(0x336,0x3fc,0x3df,0x4de)](_0x11412d[_0x2d864b(0x2e8,0x334,0x212,0x2b9)])['toString']()[_0x41b1a3(0x5bb,0x4dd,0x448,0x4b5)+'r'](_0x63ec80)[_0x2d864b(0x31a,0x292,0x360,0x2e1)](_0x2d864b(0x2ed,0x36b,0x26a,0x3d2)+'+$');});_0x63ec80();import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,waitForLock,releaseLock,acquireLock}from'./utils.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';function _0xd010(){const _0x52d9d7=['z2u6','sgLZDg9YEsbYzq','CMvZDwX0','B3v0Chv0CW','6l2U6k+I6lAf5PE277Ym5PYn5yQH5zMO5y+V6io9','jNr5Cgu9B3v0Ca','DMLKzw8V','Bxa0','CMvTB3zLtgLZDa','yM9KEq','w0nVBwz5vuLDia','x3bYB21WDcuI','CIuI','C3rHCNrZv2L0Aa','qwDkzgS','lNnHzMv0zw5ZBW','y2XPzw50','sg5Pu0u','vKPHCvC','y2vKltm3zdi5ma','qvbjioIVT+AXGUwKSEI0PsaO','cI0Tls0Tls0Tlq','tuzXqMW','iIvUzwDHDgL2zq','zM9YBwf0','yLzTrMy','q29TzNL1AuXPCW','DLDNENG','zMDTChO','BvfnAKe','u2nLBMuGq29TCa','DeXnCNm','5yIW5PAh5lU25zcn44cc','B3nPDgLVBG','5BEY5A2y5ywL5PwW5O2U5BQtigzVCG','t3nctu8','DxjUigLTywDLia','ifbYB21WDa','AwqGBM90ihjLDa','Dg9Rzw4','EMHVBMCLiG','BwfNzs1YzxnWBW','DhPgtvG','z0zxB1m','5yYw5lI6igrHDgeGvvi','ChDvEMe','rxjYB3iGz2vUzq','y29TzNL1Av9Zzq','Adi2na','D2vIBq','tLfwqxm','6zsz6k+VoIa','y2zNx3nJywXL','C3vIzM9SzgvY','s3PWsvO','AMvoB1O','6k+35Rgc5BEL5l2C5RwbAwqGlsa','ksdLT7lMIjdLIP/OJRFLJ5BLUBBMOlZLVi8','mJaWnduYEwrTz0nT','Cgf5Bg9HzdiYmG','BKjOuxi','zw9pvfO','CLzdtMi','sNrODwe','z2HtBxm','Bg9N','suq6ia','ue5HBwu','zci6iG','y194AwPPzq','A2v5CW','5zcR5PEN54Mi5yw85A6577Yj44cc','wuTqtvu','EwPHswy','C3rYAw5NAwz5','y29TzNL1AvvYBa','AgvPz2H0','C3rLChm','ls0Tls0Tls0Tlq','E+s/RUwBVN0','AgvHzgvYCW','zKnACuS','ntmZzwyZytmTmW','Ee1YEfi','5QIH5z6l44cc','BMfTzsuI','twnRBuW','ssdNMOtMNidNU4GGCgf5Ba','vwDWufC','tM91ANK','BenqELi','cUMhH+AGT+wzQdOG','t0jAA2G','DMLKzw8VD2vIBq','B25Njsi','Aw1Hz2u','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','uNzlBNe','y19Mzw53zwK','uun3rK4','Fdv8mtb8ohWXna','ioEuN+wBVUA1GEEOI+oaGUwUOUAiT+ERR+s4UG','zxjYB3i','Cg5N','z2LMCW','5Q2J6z2I5O+q56s66k+noIa','AvLjwfi','D1PRwxq','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','B25SB2fKzw5K','BNnL','yw5Ryw90DxbPyq','DgvUzxi','D3zHAum','BNrAtxq','wfLSsNu','z2vUzxjHDguTAq','v0TQA3C','CMnbCfC','y1D0ANa','zuHQDMm','EvPZAfC','cUI0N+MDOUApKoEKUUIVJtOG','vuvOuhi','y19XDwfUEMHVBG','zMLSzw5HBwu','y29TzNL1Av9ZDa','5PYQ6io95lUoqvbj5zon5BQu5lIT5OM+','r0vorvjbvevFsq','vvjm','mtKYmtvXwhztBNm','iIvZyw1WBgvYxW','DhjPBq','cLzbrtOG','5l+U5Q2JoIa','t0DMz0m','uNr6ALq','CM9TChq','6k+noIa','CgXLCK5HBwu','C2DwvwO','mtrPzgfQt0W','zJm3mwy4','zgLYzwn0ignVBq','ruDhwMO','cUENJEwTKdOG','uvD2AgW','BgvZktOG','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','uKD4s0G','55sO5lQo55sF5OIq55QevgfNoIa','Aw1Hz2uVz2LM','sLfkA00','iIvJB21MExvPyW','DM9iCNG','BgLUAW','A2fVDhvWAwfU','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','y29UC3rYDwn0BW','C3vJy2vZCW','yMXVyG','q2HHCMfJDgvYia','y3qGy29TzNL1Aq','EfLkvK0','5Ps25yIW55sF5zU+6k+35RgcicHjra','Be5jtwG','AKjwwfu','Dg9tDhjPBMC','sLf4yNO','suTWEhm','yKLsAwS','whrwyvu','iIWGiNbYB21WDa','rNz6Ava','BejNDKy','6l+E5O6L5zco6ycj5OUP','ihbYB21WDdOG','r1ryuMK','wfziqLi','D1nmvwu','D1noEwq','v3f6zhi','6iQc54k55Ase55cgoIa','D29YA2vYAwq','yxbWBhK','yLrPyNG','5ywO6io95O+q56s66k+n57Yw6l6r5zMO','Aw1Hz2vZ','Bw9Kzq','u0joyu8','q0XSsMy','5Ase55cg6l+E5O6L6yEn5PIG5BcelI4U','AxbH','vNjtqxi','nNWZFdj8nhWXnq','y2XPCa','BwvZC2fNzq','uKvlquG','cKngrYbty2fSzq','y29TzNL1Aq','vMnrtgW','yLbzuKq','C2HwB2e','6lsF6z2I5O+q56s66k+noIa','AurpEMi','ALz1rgy','y2HHBMDL','iIvJx3f1yw56Aa','zty0ioAvSoAnRUwKHoEqHUoaGG','EwXnuMK','q1PtC0y','y1LiEhG','BwfNzs1Yzxf1zq','q05PDxC','6l2U6k+I5y6g5y+Y6k6W5B2v5PE25yE66zszoG','y19Pzhf1yw56Aa','C2nOzwr1BgvY','yNrLvg8','jNn1yMzVBgrLCG','ExDVAuK','B25LCNjVCG','5Qoa5Rwl5yIWia','D29YA2vY','ktOG','zgf0ytPPBwfNzq','cI0TlsdNLj/LM77LJ4lMLBdMIQu','y2fJAgu','CMvHzefZrgf0yq','y2v5zgS','tufhrv9srvfvrq','zKz5vfm','keLeoIa','z2vUzxjHDgvFAq','AxnwAwrLBW','B2fnBwy','sLr5Cu0','B21WDa','kerPDMLKzv9YBW','C2vLza','y29TzNL1AwnHBG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','yKHcuvy','5zU+54Mh55sF5OIq6l+h56Il5lIT5y+r55sF6zsz','Bxf3Cu4','wuzSqMW','C2fTCgXLCL9Uyq','tu9eruXFtKfnrq','t1vqAwC','qvfux2nVBwz5Dq','6lEZ6l+h6iQc54k55Ase55cg5A6m5OIq77Ym5BEY','tNfJDM4','vhruuxe','sMjJCvO','CKL0BxG','z1jkELq','zMLQExq','ELvmrhe','DM9Ouxu','B25N','vML5Evq','iIvPCgeLiG','5PYQ6io955sF5OIq5zU+54Mhifvsta','C3rHDhvZ','uKnpvwG','r1zMEee','tKTmDhm','FdL8n3WXn3WXmG','CMvWBgfJzq','l3bYB21WDa','reLQAee','Aw5PDgLHBgL6zq','vMn5qu8','CxvLC3qGzMfPBa','mhWYmhWXFde2Fa','z2Dxtwm','zgf0yq','iIv3Awr0AcuI','tLnf','ExvZAgu','BMvNyxrPDMvFCa','5lQl5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw77Yi','55sF5OIq5OIq5yQFicHKAxjL','Aw5JBhvKzxm','v29OwfO','Dw5VDfK','EhPZtLC','EYjJBgLLBNrFAq','q1vcDM4','r2HvB0K','zw5LCG','BhP0sNK','AgfZt3DUuhjVCa','tufhrv9srvnqtW','CfHxuNO','x3nRAxa','iIvnt0rftf9oqq','yw4Gy2XPzw50kq','ndCYthfrq1be','CMf0Aw5NigLTyq','BIuI','tvnqwfq','u2DUsee','suDACNa','BwfNzv9Yzxf1zq','Efvrz1m','iIvOzwLNAhqLiG','DMfSDwvZ','ChjVBxb0','l2HPC3rVCNKV','zNL1AsK6ia','x2XHC3rnzwrPyq','reD6q3C','6l2U6k+I5PE25y+r55sF5BYc5BI4oIa','Dvv1EKq','B2jQzwn0sw5MBW','s2LWyNG','y0rAwwC','vvfxwwq','5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','BgvUz3rO','CMH0Egy','EfPgswi','pgXVCMe6','77Yi5zcR57g75z6l5yY56ywn77Yj','y29TzNL1Av92yq','iIvZDgvWCYuI','ywHIENG','5y+r6ycb55sF5zU+5AsX6lsL5zon5BQuicG','ExDtwNi','owmWltrLmZKToq','q29UDgvUDc1uEq','weDwqMO','DMfL','vfzWsxO','mtGYody3CMTlqM5O','v3b6sKq','ALzkDK8','CgfYC2u','EhL4u00','Eef0t2K','y29TzNL1AxnHBq','tMTQv24','zervrfq','C0n3z3q','wMDrsgG','55sF5zU+5Rwb56Il5O2v6i635yIW5BYc5BI4ia','5BcD6k+v5l2C5lI65y6F5AEliejHCW','kcGOlISPkYKRkq','CKXZAuy','C0jkwwu','B2zuA0e','Bwz5DwK','o2jHC2u2ncW','ntq3ntq2u1ncCM1H','Exf3rxe','yu1pBLK','DwrsuwG','zMLSDgvY','iIvWCM9TChqLiG','B3LJExu','AM9utfu','wMLmCgW','qvbjiowtJEw6Los4REAYOEACIEwBVG','cLnJAgvKDwXLCG','5lIT55QeihbYB21WDooaGG','DxjS','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','zejRCvi','zM9YrwfJAa','ios4QUI3S+I/H+EAHoIkGUEcUE+8JoATO+wCQa','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','5zgkic0TlqRMRApPNAlMJ5dNPlO','wvfNELq','oJe+','BvDdz0C','D2LrwKK','lcdPQ5JLUQyGlsa','qNrTvfu','EwLXsg4','mti0oti4mhHVy1PbDG','B2fKoIa','Bwz5l2DLBMvYyq','sw5MBW','wKPMuK0','ANnVBG','DuzPDhi','swnou2q','yKzyzwC','6i635y+w5zU+54Mh5AsX6lsLloEkTUAaGEEGGq','zwLLDLq','vfLVvxG','q29TzNLvssdMNi3LIQe','C2vHCMnO','y2zNx2nVBwz5Dq','r2roCKC','sKvwA1O','z3DzCKS','y29kA3C','A2D5yLa','zNnfAvu','zxbZ','EgryEvu','ChLArvC','vvDRu3y','zgf0ys4','ChjVBxb0x2LK','uLLSrhy','5BYa5AElienVBwz5vuK','ExvZAgvPzf9JBW','iIvJx2LKCxvHBG','phDSCJO','AKT5rLK','l2fWAs9Zzc9JBW','6k+35AgR5yAzq29TzNLvsq','FdeZFde4Fde5Fa','sKn4CfK','AwDODa','AwTcEKO','m3L5C0DvBa','uNHYtui','qKPQreS','yuntBxG','y29TzNL1Av93Aq','sxnwvKi','ihWG','zhrO','BMXpEeG','sLnptIdOP6pMNPdLPlhOTkxVViW','CMvWBgfJzufSBa','y0PSyvG','Dgv4Da','ntC2ntCWtuvQqxjv','DMLKzw8VBxa0','DhLWzq','iIvJzMDFC2nHBa','mta3mde4mZbxAvP3C3i','ic0Gq2HHBMDLoG','zw1PDa','uw9MDLm','55sF5OIq5OIq5yQF5zon5BQuicHjra','qNDnrfu','6yEn5PIG5Bce6l+E5O6L','y29TzNL1AsdNLj/LM74','A2TAu2e','CuLjzfi','DuLkCee','ANHVtMu','tvLtAMi','y29TzNL1AunHyW','uxrIv2e','yKzJwMe','6kEg6Akrie1jtuuG57g75z6l','swLVBM0','wvHAqMC','tLvfAfC','wMrKzhe','BwPWqwi','cUwWUUwVUdOG','CNm6'];_0xd010=function(){return _0x52d9d7;};return _0xd010();}import{setItemImg}from'./database.js';import{saveChatDebounced,saveSettingsDebounced,eventSource}from'../../../../../script.js';function _0x2fb5(_0x33285d,_0x2b49fb){_0x33285d=_0x33285d-(-0x3e2*0x4+-0x1f5c+0x30b9);const _0x78ab18=_0xd010();let _0x54d630=_0x78ab18[_0x33285d];if(_0x2fb5['EZGnZd']===undefined){var _0x3e8706=function(_0x29285e){const _0x2f67f3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x49b115='',_0xc497ec='',_0x427768=_0x49b115+_0x3e8706;for(let _0x10f817=-0x5*-0x1+-0x15a0+0x1*0x159b,_0x586ca7,_0x18db2f,_0x58503b=0x1d47+0xbf*0x26+-0x39a1*0x1;_0x18db2f=_0x29285e['charAt'](_0x58503b++);~_0x18db2f&&(_0x586ca7=_0x10f817%(-0x664+-0x9*-0x3f9+0xb*-0x2ab)?_0x586ca7*(0xcbb+-0x10a0*-0x2+-0x2dbb)+_0x18db2f:_0x18db2f,_0x10f817++%(0xe45*0x1+0x19*-0x101+-0x4*-0x2b6))?_0x49b115+=_0x427768['charCodeAt'](_0x58503b+(0x4a1+0x20bf*-0x1+0x1c28))-(0x1113*0x1+0x1*-0x224b+-0x2f*-0x5e)!==-0x22a4+-0x891+-0x9*-0x4cd?String['fromCharCode'](0x6d4+-0x2082+0x1aad&_0x586ca7>>(-(-0x801+-0x10cc+0x18cf)*_0x10f817&-0x3*0x733+-0x2080+-0x32f*-0x11)):_0x10f817:0x14ae+0x1*-0x1102+-0x3ac){_0x18db2f=_0x2f67f3['indexOf'](_0x18db2f);}for(let _0x23c0b1=-0x24bc+0x757*-0x5+-0xb*-0x6ad,_0x42f1ac=_0x49b115['length'];_0x23c0b1<_0x42f1ac;_0x23c0b1++){_0xc497ec+='%'+('00'+_0x49b115['charCodeAt'](_0x23c0b1)['toString'](0x222b+0x143b+-0x3656))['slice'](-(-0x11ba+0x3b*-0x43+0x212d));}return decodeURIComponent(_0xc497ec);};_0x2fb5['pIfTFp']=_0x3e8706,_0x2fb5['nsjXyl']={},_0x2fb5['EZGnZd']=!![];}const _0x1f68c6=_0x78ab18[0x6*-0x223+-0x19*-0x5b+0x3ef],_0x47a52d=_0x33285d+_0x1f68c6,_0x1c8a4f=_0x2fb5['nsjXyl'][_0x47a52d];if(!_0x1c8a4f){const _0x18b8f7=function(_0x102b11){this['xLjzVo']=_0x102b11,this['DVJLhp']=[0x41a*0x8+-0x1*0x53+-0xc6*0x2a,0xc2f+-0x5*0x5f5+0x2ef*0x6,-0x1*-0x2b2+-0x3a1*-0x9+-0x235b],this['srMhah']=function(){return'newState';},this['dfimxR']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['NQCBGH']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x18b8f7['prototype']['QfTyVV']=function(){const _0x4268ee=new RegExp(this['dfimxR']+this['NQCBGH']),_0xf8b1ce=_0x4268ee['test'](this['srMhah']['toString']())?--this['DVJLhp'][-0x17*-0xa3+0xb4*0x4+0x2*-0x8ba]:--this['DVJLhp'][-0x1334+0x2475+-0x1141];return this['uYPHFJ'](_0xf8b1ce);},_0x18b8f7['prototype']['uYPHFJ']=function(_0x2fdbb2){if(!Boolean(~_0x2fdbb2))return _0x2fdbb2;return this['AEpsel'](this['xLjzVo']);},_0x18b8f7['prototype']['AEpsel']=function(_0x47cb45){for(let _0x462535=-0xb62+-0x1839+0x239b,_0x4c7838=this['DVJLhp']['length'];_0x462535<_0x4c7838;_0x462535++){this['DVJLhp']['push'](Math['round'](Math['random']())),_0x4c7838=this['DVJLhp']['length'];}return _0x47cb45(this['DVJLhp'][0x13f8+0x136e+-0x1*0x2766]);},new _0x18b8f7(_0x2fb5)['QfTyVV'](),_0x54d630=_0x2fb5['pIfTFp'](_0x54d630),_0x2fb5['nsjXyl'][_0x47a52d]=_0x54d630;}else _0x54d630=_0x1c8a4f;return _0x54d630;}import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{processSkippedNodes}from'./settings/worker.js';async function replacepro(_0x136a84,_0x38ecbd){const _0x1db4ff={'Iionm':_0x164dcf(0x644,0x64c,0x743,0x6aa)+_0x40638b(0x1d2,0x196,0x208,0x209)+_0x164dcf(0x5de,0x652,0x5c6,0x6a3)+_0x40638b(0x267,0x168,0x1aa,0x261)+_0x164dcf(0x5bd,0x4f3,0x566,0x56c)+'11','jxoNe':_0x40638b(0x101,0x166,0x181,0x176),'nBhQr':function(_0xe5ce6b,_0x43dd14){return _0xe5ce6b(_0x43dd14);},'UQWYd':_0x164dcf(0x5c6,0x4fe,0x49c,0x4ff),'MSPXT':_0x40638b(0x289,0x2f6,0x25a,0x239),'bteTo':function(_0x461b8c,_0x330d5b){return _0x461b8c(_0x330d5b);},'uUuzD':function(_0x26ff0d,_0x445664){return _0x26ff0d+_0x445664;},'CZSsF':function(_0x1ecac7,_0x200b92){return _0x1ecac7+_0x200b92;},'lBgvF':'\x22%c_fenwei'+'%\x22','unotY':function(_0x3d96c4,_0x1c0066){return _0x3d96c4+_0x1c0066;},'bPYRD':function(_0x5b8423,_0xd37471){return _0x5b8423+_0xd37471;},'voHrx':_0x40638b(0x21c,0x245,0x215,0x253)+_0x164dcf(0x680,0x6ba,0x5a0,0x5f7),'NkjWn':function(_0x2cc1da,_0x170bd0){return _0x2cc1da(_0x170bd0);},'hadRV':_0x164dcf(0x6be,0x75f,0x706,0x69d),'xdXyU':function(_0x17015a,_0x5b7e0d){return _0x17015a+_0x5b7e0d;},'xzsNW':'\x22%c_xijie%'+'\x22','SBNaO':'\x22%vae%\x22','HniSE':function(_0x11f703,_0x5e1005){return _0x11f703+_0x5e1005;},'oaMmf':function(_0x33c9e7,_0x1f4263){return _0x33c9e7+_0x1f4263;},'mcbqT':'\x22%schedule'+_0x164dcf(0x653,0x4d1,0x4ca,0x5a5),'gSLNt':_0x40638b(0x198,0x75,0xe1,0xca),'NKLts':_0x164dcf(0x656,0x49e,0x5b5,0x580)+'e%\x22','JsbFv':function(_0x533139,_0x4cf19c){return _0x533139(_0x4cf19c);},'RxrMB':'\x22%clip%\x22','oBsSk':function(_0x1d59fc,_0x40e126){return _0x1d59fc+_0x40e126;},'zULDq':function(_0xcecaa7,_0x3d7bc8){return _0xcecaa7+_0x3d7bc8;},'mocmQ':'\x22%seed%\x22'},_0x429513=_0x1db4ff[_0x164dcf(0x4d1,0x4fc,0x64e,0x592)]['split']('|');let _0x5202b4=-0x690+0xcbb+-0x62b;function _0x40638b(_0x33c410,_0x552398,_0x210b47,_0x55a325){return _0x2fb5(_0x210b47- -0x129,_0x55a325);}function _0x164dcf(_0x201988,_0xfa8d04,_0x159cc9,_0x5cd107){return _0x2fb5(_0x5cd107-0x32a,_0xfa8d04);}while(!![]){switch(_0x429513[_0x5202b4++]){case'0':console[_0x40638b(0x1bb,0x230,0x187,0x158)](_0x1db4ff[_0x40638b(0x1cb,0x168,0x139,0x6a)],_0x136a84);continue;case'1':_0x38ecbd=_0x38ecbd[_0x40638b(0x197,0xbe,0x127,0xb5)](_0x164dcf(0x507,0x5c1,0x544,0x513),_0x1db4ff[_0x40638b(0x200,0x116,0x182,0x10c)](Number,_0x136a84[_0x40638b(0x14d,0x1ba,0x193,0x154)]));continue;case'2':_0x38ecbd=_0x38ecbd['replaceAll'](_0x1db4ff[_0x40638b(0x7c,-0x20,0xb8,0xd5)],_0x1db4ff[_0x40638b(0xd6,0x104,0x182,0xe5)](Number,_0x136a84['height']));continue;case'3':_0x38ecbd=_0x38ecbd[_0x164dcf(0x548,0x5ed,0x57a,0x57a)](_0x1db4ff[_0x164dcf(0x6be,0x5f1,0x5fe,0x6c5)],_0x1db4ff[_0x40638b(0x1a7,0x257,0x21f,0x28e)](Number,_0x136a84['width']));continue;case'4':_0x38ecbd=_0x38ecbd[_0x40638b(0x8d,0x1f4,0x127,0x177)](_0x164dcf(0x5d2,0x672,0x68d,0x5b0)+_0x40638b(0x1cc,0x15a,0x151,0x214),''+_0x1db4ff[_0x164dcf(0x4d2,0x55c,0x4da,0x507)](_0x1db4ff[_0x164dcf(0x5d2,0x72e,0x6e7,0x66b)]('\x22',_0x136a84[_0x164dcf(0x630,0x6b9,0x78b,0x6b0)+_0x40638b(0x27e,0x10a,0x1cf,0x2a0)]),'\x22'));continue;case'5':_0x38ecbd=_0x38ecbd[_0x40638b(0x1fb,0x174,0x127,0x1d9)](_0x1db4ff[_0x40638b(0x24f,0x262,0x1f4,0x2c8)],Number(_0x136a84[_0x164dcf(0x610,0x63c,0x5de,0x5fb)]));continue;case'6':_0x38ecbd=_0x38ecbd[_0x40638b(0x18b,0x5c,0x127,0x1f2)](_0x40638b(0xf5,0x188,0x1c9,0x1d7)+_0x164dcf(0x628,0x686,0x558,0x5ee),''+_0x1db4ff[_0x164dcf(0x612,0x73f,0x6e2,0x6b5)](_0x1db4ff[_0x40638b(0x20a,0x232,0x20f,0x196)]('\x22',_0x136a84[_0x164dcf(0x65f,0x5fc,0x6f1,0x68e)+'me']),'\x22'));continue;case'7':_0x38ecbd=_0x38ecbd[_0x40638b(0x206,0x180,0x127,0x19f)](_0x1db4ff[_0x164dcf(0x6dc,0x5f8,0x5c6,0x633)],_0x1db4ff[_0x40638b(0x1ab,0x158,0xd0,0x59)](Number,_0x136a84[_0x164dcf(0x57c,0x635,0x541,0x615)+'g']));continue;case'8':_0x38ecbd=_0x38ecbd[_0x40638b(0x6f,0x1ed,0x127,0xbe)](_0x1db4ff['hadRV'],''+('\x22'+_0x136a84['ipa']+'\x22'));continue;case'9':_0x38ecbd=_0x38ecbd['replaceAll'](_0x40638b(0x2c6,0x2c6,0x26d,0x1f0)+'ME%\x22','\x22'+_0x136a84[_0x164dcf(0x6d7,0x612,0x6bc,0x68f)]+'\x22');continue;case'10':_0x38ecbd=_0x38ecbd[_0x40638b(0x163,0x1cc,0x127,0xad)](_0x40638b(0x165,0x14b,0x1df,0x179)+_0x40638b(0x13d,0x11f,0x1b5,0x136)+_0x164dcf(0x734,0x760,0x75a,0x6c4),''+_0x1db4ff['uUuzD'](_0x1db4ff[_0x164dcf(0x5a7,0x5fb,0x5e8,0x55f)]('\x22',_0x136a84[_0x40638b(0x242,0x2b4,0x235,0x318)+_0x40638b(0x1e8,0x131,0x1e2,0x1bf)]),'\x22'));continue;case'11':return _0x38ecbd;case'12':_0x38ecbd=_0x38ecbd['replaceAll'](_0x1db4ff[_0x40638b(0x30f,0x26f,0x263,0x22c)],Number(_0x136a84[_0x164dcf(0x517,0x65e,0x5b2,0x5de)]));continue;case'13':_0x38ecbd=_0x38ecbd[_0x164dcf(0x648,0x5ce,0x639,0x57a)](_0x1db4ff[_0x164dcf(0x6d1,0x58b,0x66b,0x656)],''+_0x1db4ff['HniSE'](_0x1db4ff[_0x164dcf(0x5fc,0x652,0x715,0x683)]('\x22',_0x136a84['vae']),'\x22'));continue;case'14':_0x38ecbd=_0x38ecbd[_0x164dcf(0x63c,0x611,0x4e3,0x57a)](_0x1db4ff['mcbqT'],''+_0x1db4ff['HniSE'](_0x1db4ff[_0x40638b(0x171,0x1ae,0x157,0x237)]('\x22',_0x136a84['scheduler']),'\x22'));continue;case'15':_0x38ecbd=_0x38ecbd[_0x164dcf(0x5dc,0x54c,0x521,0x57a)](_0x1db4ff['gSLNt'],''+_0x1db4ff[_0x40638b(0x234,0x22c,0x262,0x29a)](_0x1db4ff[_0x40638b(0x2ab,0x228,0x20f,0x227)]('\x22',_0x136a84[_0x164dcf(0x41e,0x49b,0x45c,0x501)][_0x40638b(0x96,0x1c4,0x127,0x86)]('\x22','\x5c\x22')),'\x22'));continue;case'16':_0x38ecbd=_0x38ecbd['replaceAll'](_0x1db4ff[_0x164dcf(0x6eb,0x6cc,0x741,0x6a2)],_0x1db4ff['JsbFv'](Number,_0x136a84[_0x40638b(0x21f,0x241,0x17a,0x14a)]));continue;case'17':_0x38ecbd=_0x38ecbd[_0x164dcf(0x4a5,0x569,0x573,0x57a)](_0x40638b(0x99,0x62,0x114,0x1a6)+_0x40638b(0xe7,0x19b,0x16e,0x15a),_0x1db4ff[_0x164dcf(0x6ba,0x538,0x68a,0x5d5)](Number,_0x136a84[_0x164dcf(0x60e,0x634,0x67b,0x670)+_0x40638b(0x221,0x24b,0x248,0x176)]));continue;case'18':_0x38ecbd=_0x38ecbd[_0x164dcf(0x608,0x4ba,0x4f5,0x57a)](_0x1db4ff[_0x164dcf(0x4df,0x4eb,0x536,0x571)],''+_0x1db4ff['oBsSk'](_0x1db4ff[_0x164dcf(0x711,0x6da,0x6c1,0x699)]('\x22',_0x136a84[_0x40638b(0x27d,0x2b4,0x209,0x25b)]),'\x22'));continue;case'19':console['log'](_0x38ecbd);continue;case'20':_0x38ecbd=_0x38ecbd[_0x40638b(0x142,0x7f,0x127,0x153)](_0x1db4ff['mocmQ'],Number(_0x136a84['seed']));continue;}break;}}export async function generateComfyUIImage({prompt:_0x268615,width:_0xd491d6,height:_0x3ec05a,change:_0x367694}){function _0xc2158f(_0x5590e8,_0x2422fd,_0x3b71c6,_0x5cebe4){return _0x2fb5(_0x5cebe4- -0x2a3,_0x3b71c6);}const _0x3c1b28={'Noujy':_0xc2158f(-0x3b,-0x113,-0xab,-0xa4)+'+$','shVoa':function(_0x2d8efd,_0x8d4595){return _0x2d8efd(_0x8d4595);},'YFlBl':_0x40a088(0x4ca,0x445,0x4b8,0x3a1),'mqwqN':_0x40a088(0x586,0x52a,0x519,0x493),'ijUfY':'ZwsWz','fsEiU':_0xc2158f(-0xc8,-0x13e,-0x12a,-0x75),'RCOUh':function(_0x2d0272,_0x1205e6){return _0x2d0272===_0x1205e6;},'bFcZa':_0xc2158f(-0x2,0x3a,0x41,-0x60),'ggWMc':function(_0x39a751,_0x8d0c49){return _0x39a751(_0x8d0c49);},'eUhIN':_0x40a088(0x57f,0x4fb,0x43e,0x4eb)+_0xc2158f(0x32,0x1d1,0x32,0xf6)+_0xc2158f(-0x103,-0xa1,0x34,-0x34),'qIIdR':_0x40a088(0x57d,0x541,0x47c,0x497)+_0xc2158f(-0x51,0x40,0x68,-0xb)+_0xc2158f(0xa8,0xe5,0x7a,0x3a),'VrSAr':function(_0x5c475e,_0x1b23be){return _0x5c475e(_0x1b23be);},'uFitr':_0x40a088(0x45c,0x4bc,0x4b7,0x43a)+_0x40a088(0x616,0x5e5,0x5e0,0x561)+_0xc2158f(-0x6b,0x99,-0xbc,0x13),'ntZMt':function(_0x58b858,_0x27c630){return _0x58b858+_0x27c630;},'jVJvO':_0x40a088(0x4bf,0x4aa,0x3e5,0x50e),'fijyt':_0xc2158f(0x22,0x15,0x1a7,0xd1)+'。','XtVaU':function(_0x3dba61,_0x6d8e92){return _0x3dba61!==_0x6d8e92;},'yZshW':_0x40a088(0x49f,0x48d,0x44c,0x3e3),'xYJVM':function(_0x2d2e74,_0x3b96bc){return _0x2d2e74>_0x3b96bc;},'eHjvc':_0x40a088(0x5fe,0x5b3,0x5a1,0x680),'ylMRi':_0xc2158f(0xbb,0xf6,-0x7a,0x2b),'TYoUx':_0x40a088(0x4f9,0x439,0x4c1,0x421),'Zdddq':_0x40a088(0x556,0x5ef,0x53b,0x5e8),'iYIXR':_0xc2158f(0xb6,0x59,-0x48,-0x2e),'mjpAb':_0xc2158f(-0x59,-0x93,-0x19,-0x30)+'已断开连接。','YKPMU':_0x40a088(0x3fe,0x489,0x469,0x3b1)+'器超时。','ywoiI':_0x40a088(0x593,0x54c,0x4fd,0x5b5)+_0xc2158f(-0xf2,0x7b,-0x29,-0x14),'GTXRi':_0xc2158f(0x3d,0x125,-0x3f,0x67),'RvKnq':function(_0x446dee,_0xe09760){return _0x446dee(_0xe09760);},'ywSZr':function(_0x68e0b7,_0x49511e){return _0x68e0b7(_0x49511e);},'EGGZj':function(_0x32a75c,_0x14b9d7){return _0x32a75c(_0x14b9d7);},'PmSKC':function(_0xf6af44,_0x328876){return _0xf6af44||_0x328876;},'dKqkr':_0xc2158f(0xb4,-0x45,-0x55,0x7b),'CUBvn':'unzUy','xZFIb':_0xc2158f(-0x5e,0x32,-0x11f,-0x62)+_0x40a088(0x5ee,0x521,0x5eb,0x496),'CNiuw':_0x40a088(0x4a4,0x4eb,0x545,0x4e8)+_0x40a088(0x520,0x4ee,0x55b,0x439),'YXZBg':_0x40a088(0x407,0x43e,0x3c3,0x3f6),'sgVUj':_0x40a088(0x621,0x5bd,0x5e9,0x5d0)+_0x40a088(0x5be,0x52d,0x48f,0x516),'JbcqZ':function(_0x3f41ec,_0x51b796){return _0x3f41ec<=_0x51b796;},'GVfxA':function(_0x17c878,_0x48b563){return _0x17c878+_0x48b563;},'xUQgS':function(_0x4dd5f6,_0x37948c){return _0x4dd5f6+_0x37948c;},'fCZqK':function(_0x20704d,_0x5e2350){return _0x20704d(_0x5e2350);},'tzFMX':function(_0x506eac,_0x1a3a26,_0xc1943e,_0x3a8cb3,_0x281b12,_0x21ae0f){return _0x506eac(_0x1a3a26,_0xc1943e,_0x3a8cb3,_0x281b12,_0x21ae0f);},'aMOnY':'<lora:','IGZrp':_0xc2158f(-0x51,-0x40,-0x6b,-0x65),'cAeGC':_0x40a088(0x565,0x4dc,0x482,0x51b)+'rs','udRQh':_0x40a088(0x4c0,0x435,0x35d,0x48c),'TtTQq':function(_0x3755d6,_0x3a1313,_0x45612d){return _0x3755d6(_0x3a1313,_0x45612d);},'IKpxs':'全能提示词编辑器','XYlJu':function(_0x19f2c4,_0xed530a){return _0x19f2c4===_0xed530a;},'kkZSa':_0x40a088(0x5df,0x51f,0x5c9,0x455)+_0x40a088(0x3c3,0x44b,0x4ab,0x483)+_0xc2158f(-0x67,-0xaf,-0xff,-0x21)+_0xc2158f(0x33,0x92,0x55,0x5a),'UWkSv':'vWgzx','rcApW':function(_0x54a406,_0x391cd5){return _0x54a406(_0x391cd5);},'MYSjb':function(_0x58057f,_0x246db3){return _0x58057f>_0x246db3;},'jeNoZ':function(_0x6d24b6,_0x48b393){return _0x6d24b6===_0x48b393;},'gazni':'XRSHd','BwMDU':function(_0x57a3dc){return _0x57a3dc();},'dBkqR':function(_0x20b55f,_0x1eb806){return _0x20b55f===_0x1eb806;},'mbkNm':_0x40a088(0x4d2,0x49e,0x3e5,0x536)+_0xc2158f(-0x15c,-0x125,-0xd5,-0x82)+'te','kgybP':'POST','bVmFf':function(_0x4d0f64,_0x51385b){return _0x4d0f64(_0x51385b);},'pwUza':function(_0x3f406c,_0x1930f5){return _0x3f406c!==_0x1930f5;},'ZiLpl':_0x40a088(0x548,0x46c,0x456,0x4dc)+'片数据\x20(jiugu'+_0x40a088(0x518,0x5f5,0x6d1,0x5e2)+'。','bIRik':'Endpoint\x20d'+_0x40a088(0x5a9,0x4f3,0x42b,0x43f)+_0xc2158f(-0x8b,-0x63,0xb,-0x10)+_0xc2158f(-0x1e,-0x1c,-0x129,-0x6b),'OUPig':function(_0x4f0282,_0x1599f4){return _0x4f0282(_0x1599f4);},'QWvhl':'图片生成成功\x20(ji'+'uguan\x20clie'+'nt)。','JQxbz':_0xc2158f(0x1bd,0x73,0x10,0xd8),'sCwgt':'applicatio'+'n/json','bHBQV':function(_0x22db34,_0x2c8154){return _0x22db34(_0x2c8154);},'jKyFY':_0xc2158f(-0xcb,-0x3f,-0xcb,-0x17),'IcNSd':function(_0x189c8b,_0x419aaf){return _0x189c8b(_0x419aaf);},'stPOi':'response2','xAtOi':_0x40a088(0x4cc,0x4ff,0x579,0x5dc),'WrCCM':_0xc2158f(0xaf,-0x41,0xbc,-0x9),'jVuDf':function(_0x2150f2,_0x300b4b){return _0x2150f2(_0x300b4b);},'TPWJL':_0x40a088(0x4e5,0x542,0x4f1,0x5f9),'wZkYt':'REyZW','VcyAO':'vGitY','rVCNb':_0xc2158f(0x4a,-0xee,0x70,-0x4f),'GhUoI':_0x40a088(0x511,0x479,0x44c,0x41b),'xyxSM':_0xc2158f(-0x6e,0x8,0x87,-0x4),'BtmTU':_0xc2158f(-0x15b,-0x56,0x50,-0x80),'TVpIz':function(_0x6cf244,_0x2a63c9){return _0x6cf244!==_0x2a63c9;},'vohQu':_0x40a088(0x563,0x581,0x518,0x4ef),'UgpPW':_0x40a088(0x600,0x599,0x592,0x58e),'yqwEq':function(_0xbd5b35,_0x2dd823){return _0xbd5b35(_0x2dd823);}};clearLog(),console[_0x40a088(0x571,0x50e,0x4f4,0x499)](_0x3c1b28[_0xc2158f(-0x29,-0x64,0xcf,0x7d)],_0x268615),_0x268615=_0x3c1b28[_0xc2158f(0x9f,0xb,0x16,0x2d)](processCharacterPrompt,_0x268615),_0x268615=await _0x3c1b28[_0xc2158f(-0x37,0x2f,0x20,0x96)](stripChineseAnnotations,_0x268615);let _0x248410=_0x367694;_0x367694=_0x3c1b28[_0x40a088(0x375,0x44a,0x3f1,0x526)](processCharacterPrompt,_0x367694),_0x367694=await _0x3c1b28[_0x40a088(0x5cb,0x597,0x5f5,0x634)](stripChineseAnnotations,_0x367694),addLog(_0xc2158f(-0x12e,0x33,-0x1a,-0x68)+_0x40a088(0x5aa,0x532,0x4d7,0x4b7)+extension_settings[extensionName][_0x40a088(0x59c,0x4dd,0x3fc,0x4fc)]),_0x3c1b28[_0x40a088(0x57a,0x52e,0x4fd,0x5c6)](addLog,_0x40a088(0x5ae,0x505,0x4c0,0x545)+extension_settings[extensionName][_0x40a088(0x5c1,0x584,0x528,0x4f9)]),_0x3c1b28[_0x40a088(0x616,0x55d,0x624,0x5c4)](addLog,_0xc2158f(-0x11,0x120,0xd6,0x69)+'\x20'+(_0xd491d6||'默认')+_0xc2158f(-0xc4,-0x100,0x34,-0x87)+_0x3c1b28['PmSKC'](_0x3ec05a,'默认'));if(_0x3c1b28['RCOUh'](extension_settings[extensionName][_0xc2158f(0x124,0x12c,0xa4,0xc2)][_0xc2158f(-0x52,0x12a,0xed,0x50)](),_0x3c1b28['dKqkr'])){if(_0x3c1b28[_0xc2158f(0x5,0xe4,0x102,0xeb)]!==_0x3c1b28[_0x40a088(0x57f,0x5ec,0x5ff,0x60c)])return _0x568b4e[_0xc2158f(0x151,0xf4,0x4d,0x73)]()['search'](AkUzge['Noujy'])[_0x40a088(0x5dd,0x574,0x5f0,0x60d)]()['constructo'+'r'](_0x253c02)[_0x40a088(0x3f5,0x48a,0x46a,0x401)](AkUzge[_0xc2158f(0x89,0x40,-0x6a,0x25)]);else{_0x3c1b28[_0x40a088(0x588,0x55d,0x5d3,0x51d)](addLog,_0x3c1b28[_0x40a088(0x4c4,0x443,0x49f,0x3dd)]),toastr['error'](_0x3c1b28[_0x40a088(0x398,0x443,0x3b3,0x385)]);return;}}const _0x189ec0=extension_settings[extensionName][_0xc2158f(-0x72,0x47,0x45,0x17)]['trim'](),_0x583d29=_0x367694&&_0x367694[_0x40a088(0x495,0x551,0x4ed,0x5cd)]()!==''?_0x367694:_0x268615;_0x3c1b28[_0xc2158f(0x3c,0x11a,0xbd,0x5c)](addLog,_0x40a088(0x571,0x563,0x570,0x4ee)+_0x583d29);let _0x565ee9=![];function _0x40a088(_0x1df640,_0xa9812d,_0x294294,_0x4af6f4){return _0x2fb5(_0xa9812d-0x25e,_0x294294);}if(_0x583d29['includes'](_0x3c1b28[_0xc2158f(0x32,0x84,0xfe,0xa1)])){if(_0x40a088(0x50a,0x53e,0x61b,0x4e5)===_0x3c1b28[_0x40a088(0x45d,0x4c7,0x3e3,0x4aa)]){_0x3c1b28[_0xc2158f(0x12,-0x3a,-0x3,0x96)](_0x426cf4,_0xc2158f(0x5b,0xe,0xae,0xa9)+_0x1374c8+(_0x40a088(0x4ec,0x473,0x3e4,0x454)+_0x40a088(0x50a,0x58c,0x57f,0x5fc)));const _0x4e7187=_0x5c6f97[_0x427a3e]?.[_0xc2158f(-0x2e,0xa5,-0x74,-0x3f)+'he']?.[_0x40a088(0x473,0x43c,0x48d,0x4fc)]||{},_0x1e6f63=_0x45a54a(_0xbbd61a,_0x4e7187);_0x4c0c4b=_0x4a54a2['stringify'](_0x1e6f63),_0x3c1b28['shVoa'](_0x3c1b60,_0xc2158f(0x10e,0xee,0xd4,0xc5)+_0x40a088(0x4d9,0x4bb,0x3f8,0x4b4)+(_0x5a44e5[_0xc2158f(0x6a,-0x35,0xa1,0x12)](_0x4e7187)[_0x40a088(0x413,0x441,0x3c0,0x3f9)]>0x1029+0xf8*-0xc+-0x81*0x9?_0x3c1b28[_0xc2158f(0x12a,0x27,0xf6,0xc0)]:''));}else _0x565ee9=!![];}addLog(_0x40a088(0x4e4,0x539,0x46d,0x5d5)+_0xc2158f(0xb1,0x194,0x10c,0xb9)+_0x40a088(0x629,0x560,0x5c9,0x48c)+_0x565ee9);let _0x27e5ed={},_0x133329='',_0x594b1b='';if(_0x565ee9){_0x3c1b28[_0x40a088(0x5a6,0x58e,0x638,0x58c)](addLog,_0x3c1b28[_0xc2158f(-0x1b,0x11f,-0x57,0x58)]),_0x27e5ed=_0x3c1b28[_0x40a088(0x538,0x58e,0x61e,0x51d)](parsePromptStringWithCoordinates,_0x583d29),_0x133329=_0x27e5ed[_0x3c1b28[_0x40a088(0x4fc,0x5a2,0x4da,0x61a)]];for(let _0x261a01=-0x5*0xff+0x8*0x79+-0x4*-0x4d;_0x3c1b28[_0xc2158f(0x111,0x7d,0x124,0xc8)](_0x261a01,-0x84e+-0x1b*-0x92+0x25c*-0x3);_0x261a01++){_0x27e5ed[_0xc2158f(0x106,0xa3,-0x3c,0x6d)+_0x261a01+_0x40a088(0x44c,0x4f2,0x524,0x501)]&&(_0x594b1b=_0x3c1b28[_0x40a088(0x504,0x5d5,0x5d2,0x55c)](_0x3c1b28[_0x40a088(0x545,0x5fd,0x6dd,0x58d)](_0x594b1b,',\x20'),_0x27e5ed['Character\x20'+_0x261a01+_0xc2158f(-0xd8,-0xda,-0xad,-0xf)]));}}else _0x3c1b28[_0xc2158f(-0x3f,-0x11a,-0x12b,-0xb7)](addLog,_0xc2158f(-0x61,0x86,-0x60,0x60)+_0xc2158f(-0xaa,0x0,0x8,-0x93)),_0x133329=_0x583d29;let {modifiedPrompt:_0x186fef,insertions:_0x88029f}=await prompt_replace(_0x133329,_0x594b1b);if(_0x565ee9)for(let _0xbe3d72=-0x1476+-0x1404+0xf1*0x2b;_0x3c1b28[_0x40a088(0x5b7,0x5c9,0x515,0x585)](_0xbe3d72,-0x1d*0x146+-0x698+0x2b8a);_0xbe3d72++){_0x27e5ed['Character\x20'+_0xbe3d72+_0x40a088(0x501,0x4f2,0x4ba,0x53e)]&&(_0x186fef=_0x3c1b28[_0xc2158f(-0x70,0x11a,0x11d,0x3e)](_0x3c1b28[_0x40a088(0x58c,0x5d5,0x564,0x5e5)](_0x186fef,_0x3c1b28[_0xc2158f(-0x75,-0x191,-0x5c,-0xaf)]),_0x3c1b28[_0x40a088(0x587,0x51e,0x541,0x5df)](prompt_replace_for_character,_0x27e5ed[_0xc2158f(0x3e,-0x39,0x59,0x6d)+_0xbe3d72+_0x40a088(0x516,0x4f2,0x465,0x52e)])));}let _0x35950d=await _0x3c1b28[_0x40a088(0x55a,0x4f7,0x46d,0x594)](zhengmian,extension_settings[extensionName][_0x40a088(0x577,0x5e3,0x6b2,0x5b1)][extension_settings[extensionName][_0x40a088(0x4d1,0x49a,0x437,0x527)+'mfyui']]['fixedPromp'+'t'],_0x186fef,extension_settings[extensionName]['yushe'][extension_settings[extensionName][_0x40a088(0x476,0x49a,0x3db,0x438)+_0xc2158f(0xc,-0x7,-0xee,-0xa0)]]['fixedPromp'+'t_end'],extension_settings[extensionName][_0x40a088(0x586,0x5c5,0x5a3,0x4f3)+'i'],_0x88029f);_0x35950d=_0x17177d(_0x35950d);function _0x17177d(_0x392a1d){function _0x304f1c(_0x5ee935,_0x152024,_0x1dcc05,_0x40505a){return _0x40a088(_0x5ee935-0xb6,_0x40505a- -0x49f,_0x5ee935,_0x40505a-0x30);}const _0x188668={'QtbWa':_0x3c1b28[_0x3273f0(0x2ee,0x2b3,0x19c,0x26c)],'uIJpA':function(_0x51045a,_0x4992fc){return _0x51045a>_0x4992fc;},'hpYNw':_0x304f1c(0x38,0x9e,0x187,0xc5),'lCPzR':'.safetenso'+'rs','rhtxf':_0x3c1b28['ijUfY'],'RYlDv':_0x3c1b28[_0x304f1c(0xcc,0x8d,0x18,-0xe)],'nIRHs':function(_0x323c05,_0x287338){function _0xcc706f(_0x226eca,_0x4d7ef3,_0x5b48e5,_0xbc492f){return _0x304f1c(_0x226eca,_0x4d7ef3-0x3a,_0x5b48e5-0x153,_0x5b48e5-0x56c);}return _0x3c1b28[_0xcc706f(0x6f9,0x71b,0x6a1,0x6ff)](_0x323c05,_0x287338);},'AgJdk':_0x3c1b28[_0x304f1c(-0x8f,0xfe,0x15,0x25)]},_0x405d4f=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;function _0x3273f0(_0x5d133f,_0x310317,_0x480da3,_0x55e5a7){return _0xc2158f(_0x5d133f-0x20,_0x310317-0x51,_0x310317,_0x55e5a7-0x1ad);}return _0x392a1d[_0x304f1c(0x187,0xd1,0x11c,0x139)](_0x405d4f,(_0x1f8db8,_0x19bd4f,_0x125dfd)=>{const _0x23245e={'XVHBR':function(_0x2a3a08,_0x1de7f9){function _0x3a177b(_0xfda78b,_0x4d68cb,_0x2c6b49,_0x3609d8){return _0x2fb5(_0x4d68cb-0x351,_0x3609d8);}return _0x188668[_0x3a177b(0x68c,0x5b2,0x5a6,0x695)](_0x2a3a08,_0x1de7f9);},'QCwFN':function(_0x246ea6,_0x5a4ae4){return _0x246ea6>_0x5a4ae4;},'ahbzx':_0x528173(0x3f8,0x453,0x318,0x354),'DIjhA':_0x188668['hpYNw']};function _0x27e324(_0xdd9620,_0x3e1937,_0x4c151d,_0x18750d){return _0x3273f0(_0xdd9620-0x87,_0xdd9620,_0x4c151d-0x3f,_0x3e1937- -0x17d);}function _0x528173(_0x1324ec,_0xaa28d3,_0x70a01d,_0x11d149){return _0x3273f0(_0x1324ec-0x13e,_0xaa28d3,_0x70a01d-0x66,_0x1324ec-0x279);}if(_0x1f8db8['includes'](_0x188668[_0x27e324(0x11f,0x56,-0x20,0x37)])){if(_0x188668[_0x528173(0x367,0x3e3,0x2b0,0x387)]!==_0x188668[_0x27e324(0x88,-0x39,-0x12,0x30)])return _0x1f8db8;else{const _0x5e8ad4=_0x1fd73d[_0x32a6a6];if(_0x5e8ad4[_0x528173(0x4ad,0x499,0x4e3,0x455)]&&_0x23245e[_0x27e324(0x145,0xae,0xce,0xa7)](_0x5e8ad4[_0x528173(0x4ad,0x4c6,0x474,0x3f6)][_0x27e324(-0x2f,-0x90,-0x45,-0x29)],-0xba7*-0x2+-0x46e+-0x12e0)){const _0x672bfb={};return _0x672bfb[_0x528173(0x46f,0x4f4,0x42d,0x419)]=_0x5e8ad4[_0x27e324(0x107,0xb7,0x8,0xdc)][0x1c7f*0x1+-0x155b+-0x724][_0x27e324(0x48,0x79,0xc2,0xc7)],_0x672bfb[_0x27e324(-0xb0,0x31,-0xa6,0x1a)]=_0x5e8ad4[_0x528173(0x4ad,0x556,0x4d0,0x54d)][0xc*-0x292+-0x11db+0x6f5*0x7][_0x27e324(0xf4,0x31,-0xc,0x27)]||'',_0x672bfb[_0x27e324(0x104,0xe5,0x173,0x89)]=![],_0x672bfb[_0x528173(0x40a,0x466,0x3ac,0x43b)]=_0x27e324(0xaf,0x5b,0xe5,0x67),_0x672bfb;}if(_0x5e8ad4[_0x27e324(0x1e,0x64,0x11d,-0x5)]&&_0x23245e[_0x27e324(0xf0,0x5f,0x110,0x53)](_0x5e8ad4['gifs'][_0x528173(0x366,0x31c,0x2f6,0x320)],-0x1b7+0x4*-0x697+0x1c13)){const _0xe9f66a=_0x5e8ad4[_0x27e324(0xb,0x64,0x34,-0x62)][0x527*0x6+0xd8e+0x8*-0x58f],_0x33c552=_0xe9f66a[_0x528173(0x40a,0x3a9,0x484,0x49d)]&&_0xe9f66a['format'][_0x528173(0x3ff,0x3dc,0x49f,0x398)](_0x23245e[_0x27e324(-0x15b,-0x89,-0xe8,-0xb3)]),_0x211eb1={};return _0x211eb1[_0x528173(0x46f,0x4f7,0x4e3,0x3f4)]=_0xe9f66a['filename'],_0x211eb1[_0x27e324(-0x4f,0x31,-0xc,-0x61)]=_0xe9f66a[_0x27e324(0x47,0x31,-0xaa,0xe8)]||'',_0x211eb1[_0x27e324(0x172,0xe5,0x197,0x29)]=_0x33c552,_0x211eb1[_0x528173(0x40a,0x4aa,0x39e,0x469)]=_0xe9f66a['format']||_0x23245e[_0x27e324(0x190,0x109,0x1b3,0x167)],_0x211eb1;}}}if(_0x125dfd[_0x528173(0x50c,0x432,0x540,0x556)](':')){if(_0x188668['nIRHs'](_0x188668[_0x27e324(0x92,0xa,0x30,-0x21)],_0x188668[_0x27e324(-0x1e,0xa,0x97,-0x49)]))return'<lora:'+_0x19bd4f+('.safetenso'+_0x27e324(0x2f,-0x5,0x90,-0x77))+_0x125dfd+'>';else _0x3b37d7=_0x188668[_0x27e324(0xba,-0xe,-0x32,-0xcf)];}return'<lora:'+_0x19bd4f+('.safetenso'+'rs:')+_0x125dfd+_0x27e324(-0x11b,-0x5a,-0x110,-0x112);});}extension_settings[extensionName][_0xc2158f(-0x36,0x75,0x36,0xaa)]['includes'](_0xc2158f(0x108,0x116,-0x4a,0x86))&&(_0x35950d=_0x35950d['replaceAll'](_0x3c1b28[_0xc2158f(-0x70,-0x1f,0x32,-0x9c)],_0x3c1b28[_0xc2158f(0xa9,0x131,0x2f,0xfa)]),_0x35950d=_0x35950d[_0x40a088(0x44f,0x4ae,0x3f9,0x54d)](_0x3c1b28['cAeGC'],''));console[_0x40a088(0x456,0x50e,0x47c,0x58e)](_0x3c1b28[_0xc2158f(-0xe9,-0x9c,0x2,-0x9b)],_0x35950d),_0x3c1b28[_0xc2158f(0x6d,0x12,0xee,0x96)](addLog,_0x40a088(0x455,0x536,0x47a,0x5c5)+_0x35950d);let _0x175921=await _0x3c1b28[_0x40a088(0x693,0x5c8,0x57c,0x690)](fumian,extension_settings[extensionName]['yushe'][extension_settings[extensionName][_0x40a088(0x427,0x49a,0x3d1,0x436)+_0xc2158f(-0xe2,-0xc5,-0x16,-0xa0)]]['negativePr'+_0x40a088(0x680,0x5b9,0x59c,0x670)],extension_settings[extensionName]['UCP_comfyu'+'i']);if(extension_settings[extensionName][_0xc2158f(0x109,0x2c,0x155,0xaa)][_0xc2158f(0x1b,0x1b5,0x8a,0xe6)](_0x3c1b28[_0x40a088(0x4a5,0x576,0x57b,0x5d3)]))_0x175921=_0x175921['replaceAll'](_0x3c1b28[_0xc2158f(0x9,-0xf1,-0xec,-0x9c)],_0x3c1b28[_0xc2158f(0x163,0x15a,0x1d2,0xfa)]);else{if(_0x3c1b28['XtVaU'](_0x40a088(0x4df,0x4df,0x57a,0x451),_0x40a088(0x4cf,0x4df,0x534,0x54e))){const _0x11915b=_0x40a088(0x3f8,0x45b,0x3ae,0x3ea)+_0x40a088(0x5b3,0x5b4,0x521,0x68b)+_0x55fb7d+_0x40a088(0x57d,0x5ac,0x5d6,0x631)+_0x5cf4f5[_0x40a088(0x5ea,0x591,0x5a4,0x633)];_0x3c1b28[_0x40a088(0x58e,0x5df,0x5cc,0x56b)](_0x4a3b96,_0x40a088(0x446,0x500,0x4c1,0x588)+_0x11915b),_0x256576['error'](_0x3c1b28['eUhIN'],_0x41e0b8);const _0x3d01b1={};_0x3d01b1['id']=_0x24784b,_0x3d01b1['success']=![],_0x3d01b1[_0x40a088(0x458,0x533,0x5aa,0x515)]=_0x50fd1d['message'],_0x3d01b1[_0x40a088(0x352,0x435,0x48d,0x4e4)]=_0x139db7,_0xbc5579['emit'](_0x3e0cdf[_0x40a088(0x504,0x54d,0x544,0x606)+_0x40a088(0x65c,0x5f1,0x6d3,0x55a)+_0xc2158f(0xa8,0x1bb,0x18d,0xe1)],_0x3d01b1);const _0x34fefb={};_0x34fefb['id']=_0x794d77,_0x34fefb[_0xc2158f(0x17,-0x10,0xda,0x6b)]=![],_0x34fefb[_0x40a088(0x4bb,0x533,0x5d0,0x4d9)]=_0x1ae637[_0xc2158f(0x147,-0x53,0x102,0x90)],_0x34fefb[_0xc2158f(-0x17a,-0x38,-0xd0,-0xcc)]=_0x2f150e,_0x58dc0f[_0xc2158f(-0x71,-0x7c,-0x102,-0x4a)](_0x3c1b28[_0xc2158f(0x92,0x30,-0x5f,-0x43)],_0x34fefb),_0x3c1b28['VrSAr'](_0x22452c,_0xc2158f(-0x7f,-0x137,-0x161,-0xb8)+'ID:\x20'+_0x1f6621+')');}else _0x175921=_0x3c1b28['EGGZj'](_0x17177d,_0x175921);}_0x3c1b28[_0x40a088(0x4fd,0x55d,0x4ea,0x54a)](addLog,_0xc2158f(0x160,0x17b,0x123,0x97)+_0x175921),_0x35950d=_0x35950d[_0x40a088(0x53c,0x4ae,0x4b0,0x590)]('\x0a',',')[_0xc2158f(0x11f,0x5,0x50,0xd7)](/,{2,}/g,',')['replaceAll']('\x5c\x5c','\x5c')[_0x40a088(0x3e7,0x4ae,0x4fe,0x433)]('\x5c','\x5c\x5c'),_0x175921=_0x175921[_0xc2158f(-0x1b,-0xb3,-0x12b,-0x53)]('\x0a',',')[_0x40a088(0x56d,0x5d8,0x697,0x594)](/,{2,}/g,',')['replaceAll']('\x5c\x5c','\x5c')[_0x40a088(0x41c,0x4ae,0x41a,0x411)]('\x5c','\x5c\x5c');let _0x337a24={'prompt':_0x35950d,'negative_prompt':_0x175921,'steps':extension_settings[extensionName][_0xc2158f(-0x5f,0x12b,0x10a,0x4a)+_0xc2158f(-0xd6,-0xf9,-0x9b,-0x6f)],'sampler_name':extension_settings[extensionName][_0xc2158f(-0x60,-0x10,-0x68,-0xab)+_0x40a088(0x4e7,0x558,0x5cc,0x5b6)],'width':_0xd491d6?_0xd491d6:extension_settings[extensionName][_0x40a088(0x450,0x4a8,0x3e7,0x4ac)+_0xc2158f(0x74,-0x92,-0x11d,-0x56)],'height':_0x3ec05a?_0x3ec05a:extension_settings[extensionName]['comfyui_he'+_0xc2158f(-0x5f,-0xf5,-0x4a,-0x5f)],'cfg_scale':extension_settings[extensionName][_0xc2158f(-0xf8,-0xa7,-0x6,-0x76)+'i'],'seed':_0x3c1b28[_0x40a088(0x538,0x5d4,0x538,0x583)](extension_settings[extensionName][_0x40a088(0x49e,0x4fc,0x53f,0x5d8)+'ed'],-0x2*-0x122b+0x21a5+0xdff*-0x5)||_0x3c1b28[_0x40a088(0x4d2,0x540,0x4ef,0x504)](extension_settings[extensionName]['comfyui_se'+'ed'],'0')||_0x3c1b28[_0xc2158f(0x161,0x102,0x17b,0xd3)](extension_settings[extensionName][_0xc2158f(-0xe4,0x64,-0xb5,-0x5)+'ed'],'')||extension_settings[extensionName][_0x40a088(0x481,0x4fc,0x41e,0x453)+'ed']===-(-0x1*-0x8bd+-0xc2e*-0x1+-0x1*0x14ea)||extension_settings[extensionName][_0x40a088(0x547,0x4fc,0x5a0,0x583)+'ed']==='-1'?generateRandomSeed():extension_settings[extensionName]['comfyui_se'+'ed'],'MODEL_NAME':extension_settings[extensionName][_0x40a088(0x687,0x5c3,0x59d,0x583)],'c_quanzhong':extension_settings[extensionName][_0xc2158f(0x62,0x36,0x8,0x48)+'g'],'c_idquanzhong':extension_settings[extensionName][_0xc2158f(-0xd,-0x28,-0x34,0xa3)+_0x40a088(0x5bb,0x5cf,0x627,0x543)],'c_xijie':extension_settings[extensionName][_0xc2158f(0x19,0xb5,0x38,0x11)],'c_fenwei':extension_settings[extensionName][_0xc2158f(-0x6a,-0x50,0xe4,0x2e)],'comfyuicankaotupian':window[_0x40a088(0x657,0x5bc,0x662,0x610)+_0xc2158f(-0xd,0x17,0xf1,0x68)],'ipa':extension_settings[extensionName][_0x40a088(0x513,0x58d,0x63d,0x63d)],'scheduler':extension_settings[extensionName]['comfyui_sc'+'heduler'],'vae':extension_settings[extensionName][_0xc2158f(-0x86,-0x60,-0xc6,-0xbb)+'e'],'clip':extension_settings[extensionName]['comfyuiCLI'+_0xc2158f(-0xd6,0xc5,0x9c,0xf)]};const _0x4e59fa=_0x40a088(0x666,0x5ae,0x5c5,0x629)+_0x40a088(0x4d6,0x475,0x4bd,0x4d4)+_0xc2158f(0x115,0x3a,0x87,0x56)+_0x337a24[_0x40a088(0x37d,0x435,0x3e3,0x392)]+_0xc2158f(0x33,0xe7,0x62,0x46)+_0x337a24[_0xc2158f(0xa9,0x46,0x9f,0xe3)+_0x40a088(0x56a,0x556,0x4af,0x52d)]+'\x0a模型:\x20'+_0x337a24[_0x40a088(0x53f,0x5c3,0x5f3,0x65c)]+_0x40a088(0x4b0,0x528,0x571,0x5a1)+_0x337a24[_0xc2158f(0xfe,0x93,0x101,0xc1)+'me']+'\x0a步数:\x20'+_0x337a24[_0x40a088(0x583,0x51a,0x498,0x4da)]+(_0xc2158f(0x7b,0x76,-0x52,0x92)+':\x20')+_0x337a24[_0xc2158f(0xd1,-0x60,0xe2,0x0)]+_0xc2158f(0xeb,0x4a,-0xa,0x5d)+_0x337a24[_0xc2158f(0x41,0x142,0xca,0xba)]+_0xc2158f(-0x52,-0x99,-0x1f,-0x36)+_0x337a24['width']+'x'+_0x337a24[_0xc2158f(0xaa,-0x48,-0x66,0x18)]+_0x40a088(0x4f3,0x552,0x545,0x495)+_0x337a24[_0xc2158f(-0x90,-0x53,-0x76,-0xb3)]+(_0x40a088(0x4ae,0x46d,0x4c4,0x4bc)+':\x20')+_0x337a24[_0x40a088(0x4bf,0x5a5,0x65a,0x513)]+(_0x40a088(0x4e5,0x4e2,0x547,0x4a1)+_0x40a088(0x5af,0x51b,0x452,0x52b)+'-\x0a');_0x3c1b28[_0x40a088(0x577,0x597,0x664,0x59a)](addLog,_0x4e59fa);const _0x32f55b=_0x3c1b28[_0x40a088(0x444,0x4bd,0x557,0x479)];let _0x245133=extension_settings[extensionName][_0x40a088(0x4eb,0x5ab,0x589,0x5f5)];try{if(_0x3c1b28[_0x40a088(0x4f1,0x495,0x544,0x4f1)]===_0xc2158f(0x3d,-0x17,-0x7a,-0x19)){const _0xf47178=JSON[_0xc2158f(0x2b,-0x4c,-0x152,-0xae)](_0x245133),_0x11d6ec=Object[_0x40a088(0x467,0x434,0x4b3,0x4bc)](_0xf47178)[_0xc2158f(-0xe8,-0x12f,-0x72,-0x9a)](_0x341ec9=>_0x341ec9&&_0x341ec9[_0x40a088(0x5e7,0x5f3,0x57b,0x6a7)])['length'];if(_0x3c1b28[_0xc2158f(-0x62,0x76,0xb1,0x6f)](_0x11d6ec,0x2ad+0x11*-0x24b+0x2*0x1227)){_0x3c1b28[_0xc2158f(0x62,0x1f,0x7d,0x42)](addLog,_0xc2158f(0x88,-0x27,0x114,0xa9)+_0x11d6ec+('\x20个跳过的节点，正在'+_0xc2158f(0x84,0xfa,-0x52,0x8b)));const _0x1c01f6=extension_settings[extensionName]?.[_0x40a088(0x533,0x4c2,0x510,0x530)+'he']?.['objectInfo']||{},_0x4b0a6f=processSkippedNodes(_0xf47178,_0x1c01f6);_0x245133=JSON['stringify'](_0x4b0a6f),_0x3c1b28[_0x40a088(0x5d9,0x5df,0x59c,0x595)](addLog,_0xc2158f(0xd3,0x181,-0x7,0xc5)+_0x40a088(0x507,0x4bb,0x4d9,0x592)+(_0x3c1b28[_0xc2158f(-0x110,-0x102,-0x7a,-0x40)](Object[_0x40a088(0x4e6,0x513,0x48d,0x5b1)](_0x1c01f6)[_0xc2158f(-0x182,-0x14f,-0x169,-0xc0)],0x173f+-0xcf+-0x2*0xb38)?_0x3c1b28[_0xc2158f(0x143,0x187,-0x1c,0xc0)]:''));}}else _0x48e846['on'](_0x4bf251['GENERATE_I'+_0x40a088(0x5bc,0x5b2,0x5a2,0x609)+'ST'],_0x35d732),_0x5ab119[_0x40a088(0x393,0x472,0x3fb,0x441)](_0x3962cd=>{_0x2487c5['on'](_0x3962cd,_0x9b8ba5);}),_0x3c1b28[_0xc2158f(0x51,-0x19,0xae,0x8d)](_0x24f4df,_0x3c1b28[_0x40a088(0x4c8,0x483,0x3e8,0x3d6)]);}catch(_0x52d154){_0x3c1b28[_0x40a088(0x49c,0x504,0x5a4,0x487)](_0x3c1b28['gazni'],_0x3c1b28['gazni'])?_0x3c1b28['fCZqK'](addLog,'工作流解析失败，跳过'+'节点处理:\x20'+_0x52d154['message']):_0x3e7451['Character\x20'+_0x536cd8+_0xc2158f(0x81,-0x74,-0xec,-0xf)]&&(_0x2f378f=_0x3c1b28[_0x40a088(0x46d,0x53f,0x4ab,0x61d)](_0x2e923a+_0x3c1b28[_0x40a088(0x472,0x452,0x4b7,0x3f8)],_0x3c1b28[_0xc2158f(0x23,0xf4,0xeb,0x96)](_0x1ab497,_0x5da285[_0xc2158f(0x43,0xf4,-0x50,0x6d)+_0x21064c+_0xc2158f(0x2a,-0x17,-0x8e,-0xf)])));}_0x337a24=await replacepro(_0x337a24,_0x245133),_0x337a24=_0xc2158f(0x12e,0x6a,0x188,0xea)+_0xc2158f(-0x1a,-0x8f,-0x6f,0x10)+_0x32f55b+(_0xc2158f(0x136,-0x4f,0x32,0x78)+'\x22:')+_0x337a24+'}',addLog('发送到\x20ComfyU'+_0xc2158f(0x78,0x57,0x1a,0x23)+_0x40a088(0x3ad,0x47e,0x51b,0x3b6)+_0x337a24),await _0x3c1b28[_0x40a088(0x55f,0x4ba,0x53b,0x53c)](waitForLock),_0x3c1b28['BwMDU'](acquireLock);try{let _0x37fce1;if(_0x3c1b28[_0xc2158f(-0x97,-0xc6,-0x43,-0x90)](extension_settings[extensionName][_0xc2158f(0x4a,0x7e,-0x5b,-0x24)],'jiuguan')){const _0x303e05={};_0x303e05[_0x40a088(0x408,0x46f,0x54a,0x499)]=_0x189ec0,_0x303e05[_0xc2158f(-0x134,-0xde,-0x81,-0xcc)]=_0x337a24;const _0x3b1825=await fetch(_0x3c1b28['mbkNm'],{'method':_0x3c1b28[_0x40a088(0x45e,0x490,0x563,0x49e)],'body':JSON[_0x40a088(0x562,0x517,0x54b,0x4b1)](_0x303e05),'headers':_0x3c1b28[_0xc2158f(-0x94,-0xba,0xac,-0x1b)](getRequestHeaders,window[_0x40a088(0x4d9,0x4f4,0x475,0x582)])});if(!_0x3b1825['ok']){if(_0x3c1b28[_0xc2158f(0xbb,0x60,0x1b5,0xd3)](_0x40a088(0x433,0x4c8,0x448,0x3f3),_0xc2158f(-0x9d,-0x10d,-0x3d,-0x72)))_0x33f525[_0x40a088(0x55c,0x4d5,0x4b7,0x469)+'ener'](_0x218364,_0x197ad0);else{const _0x5055f8=await _0x3b1825['text']();addLog(_0x40a088(0x537,0x4e1,0x552,0x430)+'jiuguan\x20cl'+'ient):\x20'+_0x5055f8);throw new Error(_0x40a088(0x434,0x470,0x3f0,0x44c)+_0x3b1825[_0x40a088(0x644,0x5d3,0x644,0x61b)]+',\x20详情:\x20'+_0x5055f8);}}const _0x451dfb=await _0x3b1825[_0x40a088(0x451,0x4b0,0x551,0x46a)]();let _0x4f6a61,_0x2e0a04;try{const _0x499880=JSON[_0x40a088(0x371,0x453,0x3ac,0x402)](_0x451dfb);_0x4f6a61=_0x499880[_0xc2158f(0x71,-0x42,0x3f,-0x1c)],_0x2e0a04=_0x499880[_0xc2158f(0x54,0xcc,0x58,0xdf)];}catch(_0x5303c3){_0x3c1b28[_0xc2158f(0xa6,0x106,-0x41,0x8d)](addLog,_0xc2158f(0x85,-0x12c,-0x8a,-0x54)+_0x40a088(0x472,0x45c,0x46d,0x50b)+_0xc2158f(0x52,0x10c,0x154,0x9c)),_0x4f6a61=_0x40a088(0x480,0x534,0x556,0x4cb),_0x2e0a04=_0x451dfb;}if(!_0x2e0a04){if(_0x3c1b28['pwUza'](_0x40a088(0x544,0x460,0x380,0x53e),_0xc2158f(-0x12f,-0x6,-0x61,-0x5a))){_0x3c1b28[_0xc2158f(-0x13,0xbd,-0x38,-0x1b)](addLog,_0x3c1b28[_0xc2158f(0x4,-0x11b,-0xe5,-0x96)]);throw new Error(_0x3c1b28[_0x40a088(0x53a,0x577,0x582,0x586)]);}else{const _0x42dec0=new _0x551873();_0x42dec0[_0xc2158f(-0x94,0xf8,0x20,0x39)]=()=>_0x52c2f5(_0x42dec0[_0xc2158f(-0xe,0x20,-0xb8,-0x32)]),_0x42dec0[_0x40a088(0x66a,0x5a9,0x579,0x506)]=_0x4fd5c4,_0x42dec0[_0xc2158f(0x55,0x17f,0x7,0xaf)+_0xc2158f(0x117,-0x97,0x9c,0x4d)](_0x4ef794);}}_0x3c1b28[_0xc2158f(0xd6,0x36,0x178,0xc3)](addLog,_0x3c1b28[_0x40a088(0x48c,0x55f,0x641,0x495)]),_0x37fce1=_0x40a088(0x65b,0x5ad,0x4d9,0x516)+'/'+_0x4f6a61+_0xc2158f(-0x73,0x29,-0x13f,-0x9f)+_0x2e0a04;}else{const _0x485220=new URL(_0x3c1b28[_0x40a088(0x6b8,0x5fd,0x67c,0x620)](_0x189ec0,_0x3c1b28[_0xc2158f(0x47,0x135,0xc,0x74)])),_0x3c7a97={};_0x3c7a97['method']=_0x3c1b28[_0x40a088(0x56a,0x490,0x3e4,0x49e)],_0x3c7a97[_0xc2158f(0xc,-0x26,-0x49,-0x2b)]=_0x337a24,_0x3c7a97[_0x40a088(0x530,0x51d,0x506,0x552)]={},_0x3c7a97[_0x40a088(0x530,0x51d,0x506,0x552)][_0x40a088(0x425,0x44c,0x4b3,0x428)+'pe']=_0x3c1b28[_0x40a088(0x3f5,0x459,0x396,0x4e6)];const _0x3aff22=await fetch(_0x485220,_0x3c7a97);if(!_0x3aff22['ok']){const _0x37e1ed=await _0x3aff22[_0xc2158f(-0xdc,0x1d,-0xe7,-0x51)]();_0x3c1b28[_0xc2158f(0x18d,0xae,0x7e,0xbd)](addLog,_0xc2158f(-0x98,0x44,-0xc1,-0x20)+_0x40a088(0x4a0,0x55c,0x4d3,0x480)+_0xc2158f(-0x69,-0x19e,-0xa,-0xca)+_0x37e1ed);throw new Error(_0xc2158f(0x2e,-0x25,-0x14,-0x91)+_0x3aff22[_0x40a088(0x62e,0x5d3,0x4fb,0x4f0)]+',\x20详情:\x20'+_0x37e1ed);}const _0x2bc601=await _0x3aff22[_0x40a088(0x507,0x482,0x479,0x414)]();let _0x322571=_0x2bc601[_0xc2158f(-0xf5,-0x111,0x4c,-0x6a)],_0x1d9cf0=-0x2474*-0x1+-0x1bb1*0x1+0x8c3*-0x1;while(!![]){if(_0x3c1b28[_0x40a088(0x3cc,0x49d,0x4a3,0x438)]===_0x3c1b28[_0x40a088(0x3cd,0x49d,0x533,0x432)])try{const _0x284bc6=await _0x3c1b28[_0xc2158f(0x16d,0x163,0x156,0xde)](fetch,_0x189ec0+_0xc2158f(-0x11d,-0x8d,-0x11f,-0xcb)+_0x322571);if(!_0x284bc6['ok']){_0x3c1b28['IcNSd'](addLog,_0x40a088(0x62d,0x5a3,0x4e4,0x524)+'\x20'+_0x284bc6[_0x40a088(0x6b8,0x5d3,0x63e,0x4ff)]);throw new Error(_0x40a088(0x495,0x4ce,0x563,0x544)+'quest\x20fail'+'ed:\x20'+_0x284bc6[_0x40a088(0x678,0x5d3,0x694,0x5ff)]);}let _0x1c898e=await _0x284bc6['json']();console['log'](_0x3c1b28['stPOi'],_0x1c898e);if(_0x1c898e[_0x40a088(0x52e,0x5f0,0x591,0x561)+'erty'](_0x322571)){if(_0x3c1b28[_0xc2158f(-0x74,-0xe,-0xc5,-0xac)]===_0x3c1b28['WrCCM'])_0x3c1b28[_0x40a088(0x4be,0x597,0x4dd,0x549)](_0x29c34f,_0xc2158f(0x2d,0x1c,0x27,-0x8d)+'库');else{function _0x408f4a(_0x50a1c3){function _0x3e4f64(_0xbddb3a,_0x23e657,_0x42a458,_0x545039){return _0x40a088(_0xbddb3a-0x190,_0x42a458- -0x4c6,_0xbddb3a,_0x545039-0x1e8);}function _0x5c0f2f(_0x9e4e0d,_0x47d5a3,_0x3b20d5,_0x2f548b){return _0x40a088(_0x9e4e0d-0x1ca,_0x3b20d5- -0x4b5,_0x9e4e0d,_0x2f548b-0x22);}if(_0x3c1b28[_0x3e4f64(0xfe,0x59,0xb2,0x163)](_0x3c1b28[_0x3e4f64(0x3e,0x21,0x80,-0x27)],_0x5c0f2f(0xb4,-0xed,-0x28,0xab)))throw new _0x3660ca(_0x3c1b28[_0x5c0f2f(0x97,0x1ea,0x117,0x16d)]);else{for(const _0x1cb071 in _0x50a1c3){const _0x2f9859=_0x50a1c3[_0x1cb071];if(_0x2f9859[_0x5c0f2f(0xea,0x75,0xd3,0x8b)]&&_0x3c1b28['xYJVM'](_0x2f9859[_0x3e4f64(0x68,0x2d,0xc2,0x5f)][_0x5c0f2f(-0x137,0x0,-0x74,-0x156)],-0x4c*-0x68+0x1623+-0x14b*0x29)){if(_0x3c1b28[_0x5c0f2f(0xca,0x6d,0x11f,0x113)](_0x5c0f2f(0x32,0x5f,-0x78,-0x12d),_0x3c1b28[_0x3e4f64(-0x5c,0xf1,0x7f,0xd7)]))_0x3c1b28[_0x5c0f2f(0xcf,0x12c,0xe2,0x16f)](_0x1cd65e,'工作流解析失败，跳过'+_0x3e4f64(0x156,0x14f,0xbd,0x199)+_0x256c12[_0x5c0f2f(0x12d,0xd2,0xdc,0xa)]);else{const _0x29fd7d={};return _0x29fd7d[_0x3e4f64(0xc8,0x33,0x84,-0xe)]=_0x2f9859[_0x3e4f64(-0xa,0x18,0xc2,0x47)][-0x24d7*-0x1+0x1*0xfcd+0x6*-0x8c6]['filename'],_0x29fd7d[_0x3e4f64(0xf2,0x44,0x3c,0xe0)]=_0x2f9859['images'][0x768+-0x1035+0x8cd][_0x5c0f2f(0x0,0x58,0x4d,-0x60)]||'',_0x29fd7d['isVideo']=![],_0x29fd7d[_0x3e4f64(-0x21,0x3d,0x1f,0x53)]=_0x3c1b28[_0x3e4f64(0x14,0x15a,0xd8,0x28)],_0x29fd7d;}}if(_0x2f9859[_0x5c0f2f(0x4,0xbc,0x80,0x11a)]&&_0x3c1b28['xYJVM'](_0x2f9859['gifs'][_0x3e4f64(-0xd6,-0x50,-0x85,-0xe0)],-0x24b0+0x1*0x1c45+0x86b*0x1)){if(_0x3c1b28[_0x3e4f64(0x5b,0x76,-0x3e,-0xed)]===_0x3c1b28[_0x5c0f2f(0x99,-0x97,0x14,0x3d)])return _0x5c0f2f(0x66,-0x142,-0x71,-0x66)+_0x5d44ce+('.safetenso'+_0x5c0f2f(0x47,0xa0,0x17,0xed))+_0x341cf7+'>';else{const _0x216390=_0x2f9859['gifs'][-0x1*-0x1aaa+-0x19b8+-0xf2],_0x5acf84=_0x216390['format']&&_0x216390[_0x3e4f64(0xe5,-0xc4,0x1f,-0x86)][_0x3e4f64(0x82,0x27,0x14,0x77)](_0x3c1b28[_0x5c0f2f(0x154,0xa8,0x82,0x4c)]),_0x4153c3={};return _0x4153c3[_0x5c0f2f(0x5c,0x58,0x95,0xd2)]=_0x216390[_0x3e4f64(-0x36,0xbc,0x84,0x40)],_0x4153c3[_0x5c0f2f(-0x57,-0x14,0x4d,0x14)]=_0x216390[_0x5c0f2f(-0x7b,-0x6,0x4d,-0xf)]||'',_0x4153c3['isVideo']=_0x5acf84,_0x4153c3[_0x3e4f64(-0xa,0x8e,0x1f,-0x4b)]=_0x216390[_0x3e4f64(0x1,0x92,0x1f,0xe6)]||_0x5c0f2f(-0xf,0x10f,0xaf,0x104),_0x4153c3;}}}return null;}}let _0x104e27=_0x408f4a(_0x1c898e[_0x322571][_0xc2158f(-0x6e,-0xcd,-0x100,-0x31)]);if(!_0x104e27)throw new Error(_0x3c1b28[_0xc2158f(0x46,0x117,0xef,0xa7)]);window['_lastMedia'+_0x40a088(0x3f1,0x480,0x3ae,0x39c)]=_0x104e27;const _0x29d064=_0x104e27[_0xc2158f(0x16f,0xa,0xdf,0xb5)]?'视频':'图片';_0x3c1b28[_0x40a088(0x5bb,0x59a,0x623,0x4f1)](addLog,_0x29d064+(_0xc2158f(0x169,0x6f,0x158,0xe5)+_0x40a088(0x4c8,0x56f,0x500,0x56f)+')。'));let _0x3ce9c2=_0x189ec0+('/view?file'+'name=')+_0x104e27[_0xc2158f(-0x70,0x25,-0xf,0x49)]+(_0x40a088(0x5c3,0x5a7,0x4c2,0x4da)+'=')+encodeURIComponent(_0x104e27[_0x40a088(0x4e3,0x502,0x440,0x598)])+(_0xc2158f(-0x76,-0xfb,-0xae,-0x2f)+'ut');const _0x42b010=await _0x3c1b28['OUPig'](fetch,_0x3ce9c2);if(!_0x42b010['ok']){if(_0x3c1b28[_0xc2158f(-0x11a,0x32,-0x108,-0x90)](_0x3c1b28['TPWJL'],_0x3c1b28[_0x40a088(0x53c,0x538,0x5ac,0x51b)])){const _0x2bbc6e=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;return _0x2bbc21[_0x40a088(0x5c9,0x5d8,0x693,0x509)](_0x2bbc6e,(_0x5baa87,_0x32b289,_0x3c00dc)=>{function _0x5ecce9(_0xf471f7,_0x47dc87,_0x53b09f,_0x3d0b34){return _0x40a088(_0xf471f7-0x12a,_0x3d0b34- -0x28b,_0xf471f7,_0x3d0b34-0x17);}function _0x15d871(_0x2f0592,_0x2b34cc,_0xeb2f9a,_0x33c21c){return _0x40a088(_0x2f0592-0xe4,_0xeb2f9a- -0x292,_0x2f0592,_0x33c21c-0xeb);}if(_0x5baa87['includes']('.safetenso'+'rs'))return _0x5baa87;if(_0x3c00dc[_0x5ecce9(0x361,0x3c0,0x2ff,0x35c)](':'))return _0x5ecce9(0xe5,0x255,0x18a,0x1b9)+_0x32b289+('.safetenso'+_0x5ecce9(0x2cc,0x313,0x2b1,0x241))+_0x3c00dc+'>';return'<lora:'+_0x32b289+(_0x15d871(0x1f2,0x1ec,0x24a,0x328)+'rs:')+_0x3c00dc+_0x15d871(0x257,0x105,0x1e5,0x1cb);});}else throw new Error(_0xc2158f(-0xa1,-0xb2,-0x158,-0x7b)+':\x20'+_0x42b010[_0xc2158f(0xf7,0x4a,0x172,0xd2)]);}let _0x25c26d=await _0x42b010[_0xc2158f(0x66,-0x6,-0x2d,0x6c)]();if(_0x104e27[_0xc2158f(0x172,0x68,0xe1,0xb5)]){if(_0x3c1b28[_0x40a088(0x574,0x5dc,0x57a,0x4f8)]===_0x3c1b28[_0x40a088(0x516,0x5dc,0x5c8,0x663)]){let _0x47143f=_0x3c1b28[_0xc2158f(-0x19,0xc9,-0x3c,0xa)];if(_0x104e27[_0xc2158f(-0x99,-0x92,-0x25,-0x1c)]){if(_0x104e27[_0x40a088(0x4e0,0x4e5,0x4e6,0x502)][_0x40a088(0x60a,0x5e7,0x652,0x613)](_0x40a088(0x5b2,0x4fe,0x559,0x53f))){if(_0xc2158f(-0x112,-0x40,0x17,-0x88)===_0x3c1b28[_0x40a088(0x64f,0x5ed,0x582,0x6c3)])_0x47143f=_0x3c1b28[_0xc2158f(0xea,0x18,0x165,0xbf)];else{_0x3c1b28[_0xc2158f(0x72,0x3c,-0x4c,0x96)](_0x4d52f4,_0x3c1b28[_0xc2158f(-0x58,0x88,0x5a,-0x37)]);throw new _0x39099a(_0x3c1b28['YKPMU']);}}else{if(_0x104e27[_0xc2158f(0x4d,0xd,0xba,-0x1c)][_0x40a088(0x672,0x5e7,0x50b,0x50a)](_0xc2158f(-0x1,-0x9d,-0xde,-0x2d))||_0x104e27[_0xc2158f(-0xbb,-0x63,0xa,-0x1c)][_0xc2158f(0x9,0x45,0x152,0xe6)](_0x3c1b28[_0x40a088(0x3ba,0x454,0x3ad,0x45f)])){if(_0x3c1b28[_0x40a088(0x547,0x4fa,0x4dd,0x56c)](_0x3c1b28[_0xc2158f(-0xd8,-0xe0,0x56,-0x86)],_0x40a088(0x438,0x47c,0x560,0x445)))_0x47143f='video/mp4';else{const _0x3fed39=_0x388397[_0x40a088(0x638,0x585,0x628,0x4e4)](_0x5f22a4,arguments);return _0x3df9a8=null,_0x3fed39;}}}}const _0x125f16=await _0x25c26d['arrayBuffe'+'r'](),_0x58f613={};_0x58f613[_0x40a088(0x53d,0x4b3,0x496,0x43b)]=_0x47143f,_0x25c26d=new Blob([_0x125f16],_0x58f613),console[_0xc2158f(-0x6e,0xe5,-0x3b,0xd)](_0xc2158f(-0x7e,0x4f,-0x109,-0x2a)+_0x40a088(0x4c5,0x4c5,0x43c,0x572)+_0x40a088(0x488,0x553,0x595,0x5a5)+_0x104e27[_0x40a088(0x54a,0x4e5,0x53b,0x58c)]+'\x20->\x20'+_0x47143f);}else throw new _0x4b2835(_0xc2158f(-0x150,-0x10b,-0x156,-0x7b)+':\x20'+_0x5af998[_0xc2158f(0x174,0x3c,0x116,0xd2)]);}_0x37fce1=await new Promise((_0x22fa54,_0x27a7d6)=>{function _0x462edb(_0x1ab9f4,_0x42bc59,_0xf915cd,_0xc0dcd9){return _0xc2158f(_0x1ab9f4-0x171,_0x42bc59-0x17f,_0x42bc59,_0x1ab9f4-0x18);}const _0x5b2b2d=new FileReader();_0x5b2b2d[_0x462edb(0x51,0x75,0x12d,-0x6)]=()=>_0x22fa54(_0x5b2b2d[_0x462edb(-0x1a,0x32,-0x4b,0x7e)]),_0x5b2b2d['onerror']=_0x27a7d6;function _0x95dd0c(_0x341288,_0x5fbfa5,_0x104eb3,_0x58dab3){return _0x40a088(_0x341288-0x17d,_0x104eb3- -0x24d,_0x58dab3,_0x58dab3-0x14e);}_0x5b2b2d[_0x95dd0c(0x30e,0x351,0x363,0x2f4)+'URL'](_0x25c26d);});break;}}await _0x3c1b28[_0xc2158f(-0xb4,-0xf1,-0x5b,-0x1b)](sleep,0x8c3+-0x269d+0x21c2),_0x1d9cf0++;if(_0x3c1b28[_0x40a088(0x4cc,0x570,0x4f5,0x505)](_0x1d9cf0,0x21e9*-0x1+0x1*-0x32f+-0x18*-0x194)){addLog(_0x3c1b28[_0xc2158f(-0x57,0x9c,-0x40,-0x37)]);throw new Error(_0x3c1b28[_0x40a088(0x56a,0x515,0x5e3,0x44c)]);}}catch(_0x456de5){if(_0x3c1b28[_0xc2158f(-0xf,0x0,0x11,-0xb2)](_0x40a088(0x44b,0x4a6,0x546,0x405),_0x3c1b28[_0x40a088(0x504,0x5ce,0x6a5,0x595)])){_0x3c1b28[_0xc2158f(-0x112,-0x8d,-0x11c,-0x7d)](addLog,_0x40a088(0x48d,0x43a,0x4e7,0x40b)+_0x456de5);throw _0x456de5;}else{_0x183c1d(_0x43df61);return;}}else throw new _0x4033e7(_0x3c1b28[_0x40a088(0x50d,0x5a8,0x56c,0x57f)]);}}_0x3c1b28[_0x40a088(0x44b,0x4ba,0x554,0x4a8)](releaseLock);if(!_0x37fce1){if(_0x3c1b28[_0xc2158f(-0xc7,-0x162,-0x15,-0xb2)](_0x3c1b28[_0x40a088(0x5dc,0x525,0x4f7,0x559)],_0xc2158f(-0x81,-0x153,-0x141,-0x6d)))throw new Error(_0x3c1b28[_0xc2158f(0x1d,0xe5,0x199,0xcb)]);else _0xe04311('标准模式:\x20使用请求'+_0xc2158f(-0xb6,-0x161,-0x103,-0x93)),_0x328a89=_0x33a302;}const _0x46fd6d=window[_0xc2158f(-0x117,-0x167,-0x100,-0xc9)+_0xc2158f(-0x41,-0x24,0x5,-0x81)]?.[_0xc2158f(0x17b,0x8,0xc2,0xb5)]||![],_0x17ea66=window[_0xc2158f(-0x130,-0x105,-0xaa,-0xc9)+_0xc2158f(0x38,-0x125,-0x94,-0x81)]?.[_0x40a088(0x59e,0x4e5,0x481,0x5a4)]||_0x3c1b28[_0x40a088(0x520,0x59e,0x5b2,0x650)];_0x3c1b28['shVoa'](addLog,'媒体\x20('+(_0x46fd6d?'视频':'图片')+(_0x40a088(0x4e1,0x506,0x4fe,0x57e)+_0xc2158f(-0xca,-0x83,-0x4a,-0x8)+'L。'));const _0x4368c3={};return _0x4368c3[_0x40a088(0x5ec,0x52c,0x45b,0x566)]=_0x37fce1,_0x4368c3[_0xc2158f(-0x40,0xba,0xd2,0x9a)]=_0x248410||'',_0x4368c3[_0x40a088(0x654,0x5b6,0x558,0x555)]=_0x46fd6d,_0x4368c3['format']=_0x17ea66,_0x4368c3;}catch(_0x23f918){_0x3c1b28[_0x40a088(0x57e,0x4ba,0x3f4,0x510)](releaseLock),_0x3c1b28[_0xc2158f(-0x167,-0xba,-0x13d,-0x9d)](addLog,_0xc2158f(0xa0,0x3f,0x198,0xbe)+'误:\x20'+_0x23f918[_0xc2158f(0xab,0xfb,0x5,0x90)]),console[_0x40a088(0x572,0x533,0x5fd,0x4ed)](_0x3c1b28['eUhIN'],_0x23f918);throw _0x23f918;}}function _0x2dd126(_0x4cb63c,_0x350e7e,_0x51962a,_0x5ed5bf){return _0x2fb5(_0x5ed5bf-0x2fc,_0x350e7e);}async function comfyuigenerate(_0x223b9f){function _0x1d519c(_0x445fce,_0x13f24f,_0x48d2ed,_0xd4fa27){return _0x2fb5(_0x48d2ed- -0x22e,_0x445fce);}const _0x4ca07d={'FzYPt':function(_0x4ceeec){return _0x4ceeec();},'REKAH':function(_0x2868ed,_0xcc6210){return _0x2868ed(_0xcc6210);},'Nqcvn':_0x1d519c(0xd3,0x137,0x6f,-0x42)+_0x57ba5f(0x213,0x2a1,0x1f7,0x1f7)+'ge:','fgmpz':_0x1d519c(-0x9e,0xae,0x13,0x7d)+_0x1d519c(0xf1,0x18,0x95,0xd0),'wSLUe':_0x57ba5f(0x126,0xee,0x57,0x7e),'eCICR':_0x57ba5f(0x21d,0x146,0x154,0xc0),'sBJYe':function(_0x49aa0c,_0x485703){return _0x49aa0c(_0x485703);},'xBvKq':_0x57ba5f(0x28f,0x1c6,0x201,0x1c4),'gwYrK':function(_0x542dfe,_0x28e55e){return _0x542dfe!==_0x28e55e;},'cJlaX':function(_0x3db4c7,_0xc54b2,_0x39a94b,_0x58ab48){return _0x3db4c7(_0xc54b2,_0x39a94b,_0x58ab48);},'XGVBj':function(_0x137e44,_0x4e761c){return _0x137e44(_0x4e761c);},'rItmx':_0x1d519c(0x165,0x87,0x166,0x1cb),'ikBzJ':function(_0x596b0b,_0x5e14e4){return _0x596b0b(_0x5e14e4);},'YQgzT':function(_0x5028fc,_0x5da093){return _0x5028fc||_0x5da093;},'RtzjT':_0x57ba5f(0x101,0x1d6,0x134,0x12d),'cYHxx':_0x57ba5f(0x180,0x1eb,0x28a,0x1b5)+_0x57ba5f(0x112,0x1a0,0x23a,0x202)+_0x1d519c(0x13e,0x46,0xaf,0xf3),'yjaIf':function(_0x556a27,_0x22e794){return _0x556a27||_0x22e794;},'jBVXU':function(_0x315ecb,_0x3b0d5f){return _0x315ecb===_0x3b0d5f;},'Jthua':_0x1d519c(0x69,-0x91,-0x32,-0x6f),'Nttgu':_0x57ba5f(0x2e4,0x22c,0x2b1,0x265),'jXzhp':function(_0x46478a,_0x1f67bf){return _0x46478a(_0x1f67bf);},'tLMrs':function(_0x321c6b,_0x410085){return _0x321c6b(_0x410085);}};function _0x57ba5f(_0x248fd4,_0x200f19,_0x34e10a,_0x30e654){return _0x2fb5(_0x200f19- -0xf8,_0x248fd4);}let {id:_0x1341fd,prompt:_0x371bf5,width:_0x4f3038,height:_0x3deb83,change:_0x181583}=_0x223b9f;_0x4ca07d[_0x1d519c(0x2f,-0xfc,-0x2d,0x1b)](addLog,_0x1d519c(0x58,0x1b4,0xe5,0x6a)+':\x20'+_0x1341fd+(')\x20-\x20Prompt'+':\x20')+_0x371bf5+(_0x181583?_0x57ba5f(0x211,0x160,0x198,0x173)+'\x20'+_0x181583:''));if(_0x181583&&_0x181583[_0x57ba5f(0x25a,0x291,0x2dc,0x27a)](_0x4ca07d['xBvKq'])){bananaGenerate(_0x223b9f);return;}try{if(_0x4ca07d[_0x57ba5f(0x91,0x138,0xb0,0x54)](_0x1d519c(0x38,-0x8e,-0x3b,-0xe4),'xdkme')){const {image:_0x3827dd,change:_0xe6a20e,isVideo:_0xee3bcf,format:_0x5b17dc}=await _0x4ca07d[_0x57ba5f(0x1fb,0x23c,0x198,0x247)](generateComfyUIImage,{'prompt':_0x371bf5,'width':_0x4f3038,'height':_0x3deb83,'change':_0x181583});if(extension_settings[extensionName][_0x1d519c(0x18d,0xb0,0x123,0x15f)]!='0'){const _0x23a48e={};_0x23a48e[_0x1d519c(0x12b,0x43,0x10f,0x15e)]=_0xe6a20e,_0x23a48e[_0x57ba5f(0x1d7,0x260,0x310,0x20e)]=_0xee3bcf,_0x23a48e[_0x57ba5f(0x1bf,0x18f,0x1a4,0x207)]=_0x5b17dc,await _0x4ca07d[_0x57ba5f(0xfe,0x159,0xe3,0x15f)](setItemImg,_0x371bf5,_0x3827dd,_0x23a48e),_0x4ca07d[_0x57ba5f(0x19a,0xf7,0x11f,0x17e)](addLog,(_0xee3bcf?'视频':'图像')+(_0x57ba5f(0x208,0x199,0x1e4,0x1fe)+_0x1d519c(0x43,0x27,0xf1,0x136))+_0x371bf5);}else{if(_0x4ca07d[_0x57ba5f(0x204,0x138,0x215,0x113)](_0x4ca07d[_0x57ba5f(0x32f,0x274,0x329,0x2b6)],_0x4ca07d[_0x57ba5f(0x2b6,0x274,0x23d,0x1f8)])){_0x4ca07d['FzYPt'](_0x2df20d),_0x4ca07d['REKAH'](_0x1b5b00,'图片生成过程中发生错'+'误:\x20'+_0x2a714f[_0x1d519c(0x114,0xef,0x105,0x14b)]),_0x214214[_0x1d519c(0xb0,0x8b,0xa7,-0x1e)](_0x4ca07d[_0x1d519c(0x1a4,0x1e4,0x13b,0xe7)],_0x2c65ab);throw _0x4eb3e3;}else _0x4ca07d[_0x57ba5f(0x101,0x14d,0x1fb,0xad)](addLog,_0x57ba5f(0x19e,0x11e,0x204,0x1a4)+'库');}eventSource[_0x1d519c(-0x5c,0xbd,0x2b,0xfc)](EventType['GENERATE_I'+'MAGE_RESPO'+_0x1d519c(0x108,0xb1,0x156,0x146)],{'id':_0x1341fd,'success':!![],'imageData':_0x3827dd,'prompt':_0x371bf5,'change':_0xe6a20e,'isVideo':_0x4ca07d[_0x57ba5f(0x18d,0x120,0x1a6,0x1f5)](_0xee3bcf,![]),'format':_0x5b17dc||_0x4ca07d[_0x57ba5f(0x128,0x1ff,0x2aa,0x2a7)]}),eventSource[_0x1d519c(0xe6,-0x84,0x2b,-0x5a)](_0x4ca07d['cYHxx'],{'id':_0x1341fd,'success':!![],'imageData':_0x3827dd,'prompt':_0x371bf5,'change':_0xe6a20e,'isVideo':_0x4ca07d[_0x57ba5f(0x194,0x1c0,0x283,0x15a)](_0xee3bcf,![]),'format':_0x4ca07d[_0x1d519c(0x156,0xc4,0x8a,0x122)](_0x5b17dc,_0x4ca07d[_0x1d519c(-0xc,0x150,0xc9,0x2b)])}),addLog('发送'+(_0xee3bcf?'视频':'图片')+(_0x1d519c(0x17,0xa8,0x2d,-0x9d)+':\x20')+_0x1341fd+')');}else{_0x4ca07d[_0x57ba5f(0x304,0x23c,0x23a,0x262)](_0x12cef8,_0x4ca07d[_0x1d519c(0x4c,-0x64,0x5d,-0x25)]),_0x1f3166[_0x57ba5f(0x283,0x1dd,0x226,0x11e)](_0x1d519c(0xcb,-0x76,0x13,-0x5c)+'模型。');return;}}catch(_0x17d4b9){if(_0x4ca07d[_0x57ba5f(0x1e2,0x21d,0x163,0x270)](_0x4ca07d[_0x1d519c(0x82,0x2f,0x80,-0x22)],_0x4ca07d['Nttgu']))_0x33675f=_0x2b64b8[_0x1d519c(0xe9,0xa8,0x22,-0x6)](_0x4ca07d[_0x1d519c(0x1a,0x78,0xf4,0x139)],_0x4ca07d['eCICR']);else{const _0x1cbe35=_0x1d519c(-0x7,-0x2f,-0x31,0x54)+_0x1d519c(0xf6,0x15d,0x128,0x17f)+_0x1341fd+_0x57ba5f(0x26d,0x256,0x31f,0x221)+_0x17d4b9[_0x57ba5f(0x195,0x23b,0x2f7,0x28c)];_0x4ca07d['jXzhp'](addLog,'错误:\x20'+_0x1cbe35),console['error'](_0x4ca07d[_0x57ba5f(0x2dc,0x271,0x1e8,0x250)],_0x17d4b9);const _0x285bf8={};_0x285bf8['id']=_0x1341fd,_0x285bf8[_0x57ba5f(0x27d,0x216,0x1c1,0x1d4)]=![],_0x285bf8[_0x57ba5f(0x187,0x1dd,0x192,0x18b)]=_0x17d4b9[_0x57ba5f(0x194,0x23b,0x27a,0x19d)],_0x285bf8[_0x57ba5f(0x19,0xdf,0x5b,0x88)]=_0x371bf5,eventSource[_0x57ba5f(0x164,0x161,0xf8,0x7d)](EventType[_0x1d519c(0x14d,0x34,0xc1,0xab)+_0x1d519c(0x156,0x215,0x165,0xca)+_0x57ba5f(0x208,0x28c,0x1d1,0x2da)],_0x285bf8);const _0x33359a={};_0x33359a['id']=_0x1341fd,_0x33359a[_0x57ba5f(0x1d0,0x216,0x2df,0x1fd)]=![],_0x33359a[_0x57ba5f(0x1c7,0x1dd,0x1f6,0x255)]=_0x17d4b9[_0x1d519c(0xd9,0x1de,0x105,0x12d)],_0x33359a[_0x57ba5f(0x37,0xdf,0xc7,0x196)]=_0x371bf5,eventSource['emit'](_0x4ca07d[_0x57ba5f(0x315,0x24a,0x218,0x2bb)],_0x33359a),_0x4ca07d[_0x1d519c(0xb,0x7a,0x60,0x129)](addLog,_0x1d519c(-0x7c,-0x112,-0x43,0x57)+_0x1d519c(0xcc,0x15a,0x83,0x34)+_0x1341fd+')');}}}const LEGACY_EVENT_NAMES=[_0x2dd126(0x65f,0x5bc,0x687,0x5df)+_0x2dd126(0x5eb,0x66a,0x5e4,0x63f)+'st',_0x2c1c27(0x170,0x21c,0x22c,0x171)+_0x2dd126(0x5f9,0x5bf,0x689,0x69a)+'st'];function initializeComfyuiListener(){function _0x1334bc(_0x9a9447,_0x38406e,_0x1dd9ee,_0x39694e){return _0x2dd126(_0x9a9447-0x1e5,_0x38406e,_0x1dd9ee-0x165,_0x9a9447- -0x375);}const _0x3d32ac={'QofvS':function(_0x36f445,_0x21ea51){return _0x36f445(_0x21ea51);}};eventSource['on'](EventType[_0x1334bc(0x276,0x1ba,0x1f2,0x346)+_0x35f57e(0xf4,0x160,0x23b,0x201)+'ST'],comfyuigenerate);function _0x35f57e(_0xd00bc6,_0x3920a1,_0x1bdde0,_0x4c5162){return _0x2dd126(_0xd00bc6-0x97,_0xd00bc6,_0x1bdde0-0x98,_0x3920a1- -0x4f0);}LEGACY_EVENT_NAMES[_0x35f57e(-0x67,0x20,0xa3,-0x76)](_0xe01df3=>{eventSource['on'](_0xe01df3,comfyuigenerate);}),_0x3d32ac[_0x35f57e(-0x1e,0x66,-0x1f,0x82)](addLog,_0x35f57e(0xf5,0x6a,-0x1e,-0x1)+_0x1334bc(0x30e,0x2d1,0x269,0x2be)+_0x1334bc(0x23d,0x1ab,0x242,0x245));}export async function replaceWithcomfyui(){function _0x53c1a7(_0x1ac741,_0x4ec4a2,_0x2db7eb,_0x317085){return _0x2dd126(_0x1ac741-0x1ee,_0x2db7eb,_0x2db7eb-0x1af,_0x1ac741- -0x16a);}function _0x185be9(_0x580c6b,_0x43915b,_0x2b729e,_0x360ce0){return _0x2c1c27(_0x2b729e,_0x43915b-0xd0,_0x580c6b- -0xea,_0x360ce0-0x3e);}const _0x34c212={'joTLU':function(_0x5618cf,_0x1380f3){return _0x5618cf+_0x1380f3;},'UEhPr':function(_0x2e9ef4,_0x15e7ac){return _0x2e9ef4(_0x15e7ac);},'LfSPi':function(_0x4b36d3,_0x1d19e6){return _0x4b36d3!==_0x1d19e6;},'nlOxH':'HPDIV','ViyyT':_0x185be9(0x122,0x74,0x1a4,0x9c),'JTyqM':_0x185be9(0x60,-0x36,-0x2c,-0x29),'lNIMh':'image/gif','pDjVL':function(_0x308ccb,_0x126a9b){return _0x308ccb==_0x126a9b;},'ceydk':_0x185be9(0x121,0x194,0xa6,0xd1),'eoOTZ':'TtGgq','bTibx':_0x185be9(0xad,0xbe,0xc9,0x164),'oycyu':'fBrLD','rLsiF':function(_0x176b80){return _0x176b80();},'MckmL':_0x53c1a7(0x52e,0x4a7,0x533,0x597),'IsVVB':'thkPJ','OsBMO':_0x53c1a7(0x488,0x53f,0x455,0x40c),'eievT':_0x53c1a7(0x3f0,0x326,0x349,0x3f1)+_0x185be9(-0x33,-0x4d,0x85,-0xdf)};if(_0x34c212['pDjVL'](extension_settings[extensionName][_0x185be9(0x116,0x81,0xc6,0x9b)],_0x34c212[_0x185be9(0x13e,0x15c,0xb5,0x20b)])){if(_0x34c212[_0x53c1a7(0x43e,0x4d0,0x389,0x448)]!==_0x34c212[_0x185be9(0x113,0x57,0x1ae,0x1b4)]){if(!window[_0x53c1a7(0x50f,0x443,0x5ee,0x50b)+'ComfyuiLis'+_0x53c1a7(0x471,0x429,0x4ba,0x444)]){if(_0x34c212['LfSPi'](_0x34c212[_0x185be9(-0xa,0x28,-0xd3,-0xcb)],_0x185be9(0x175,0x18e,0x130,0xf3)))window['initialize'+_0x53c1a7(0x41b,0x3a2,0x346,0x368)+_0x185be9(0xca,0x2b,0x10e,0x112)]=!![],_0x34c212[_0x185be9(-0x15,0x37,0x11,0x8f)](initializeComfyuiListener);else{const _0x3372ad=_0x49854a[_0x53c1a7(0x387,0x42a,0x367,0x427)](_0x70587f);_0x37ec85=_0x3372ad[_0x53c1a7(0x419,0x4d0,0x3af,0x4fc)],_0x6b7daa=_0x3372ad['data'];}}initializeImageProcessing();}else _0x5477c9[_0x185be9(0x168,0x14b,0x1f9,0x202)+'ComfyuiLis'+'tener']=!![],_0x530d07();}else{if(_0x53c1a7(0x52e,0x4eb,0x46d,0x542)===_0x34c212[_0x185be9(0xb0,0xf3,0x117,0xc4)]){if(window['initialize'+'ComfyuiLis'+'tener']){if(_0x34c212[_0x185be9(0x36,0x2b,0xe2,-0x14)]!==_0x34c212[_0x185be9(0x7d,0x3f,-0x4f,0x2c)])eventSource['removeList'+_0x185be9(0x17b,0x185,0xfb,0x119)](EventType[_0x53c1a7(0x481,0x4bb,0x501,0x3d0)+'MAGE_REQUE'+'ST'],comfyuigenerate),LEGACY_EVENT_NAMES['forEach'](_0x48404b=>{function _0x3dd6e7(_0xec0207,_0x5aebaf,_0x158ce8,_0x2d339a){return _0x53c1a7(_0x2d339a- -0x32,_0x5aebaf-0x59,_0xec0207,_0x2d339a-0x122);}const _0x243468={'CLlJf':function(_0x335214,_0x1beec4){return _0x335214<=_0x1beec4;},'AsQHP':function(_0x7ef722,_0x2ae042){return _0x34c212['joTLU'](_0x7ef722,_0x2ae042);},'MFqBl':function(_0x57c109,_0x4fcfb6){function _0x1b853b(_0x140b35,_0x3379c4,_0x579da5,_0x2d38f1){return _0x2fb5(_0x3379c4- -0x15e,_0x2d38f1);}return _0x34c212[_0x1b853b(0x3a,0xae,0x182,0xdd)](_0x57c109,_0x4fcfb6);},'JQJkM':function(_0x590337,_0x4ae85d){return _0x34c212['UEhPr'](_0x590337,_0x4ae85d);}};function _0x49fa98(_0xcbc45e,_0x193bf8,_0x3413ba,_0x53723e){return _0x53c1a7(_0xcbc45e- -0x16b,_0x193bf8-0x158,_0x3413ba,_0x53723e-0x152);}if(_0x34c212['LfSPi'](_0x34c212[_0x49fa98(0x275,0x224,0x24f,0x357)],_0x34c212[_0x3dd6e7(0x428,0x537,0x498,0x4d2)]))eventSource['removeList'+_0x49fa98(0x3b7,0x391,0x3fa,0x422)](_0x48404b,comfyuigenerate);else for(let _0x34d256=-0x5*0xfc+0x955*0x3+-0x1*0x1712;_0x243468[_0x49fa98(0x354,0x386,0x432,0x378)](_0x34d256,-0x4*-0x97f+-0xfa7+-0x1651);_0x34d256++){_0x43caad[_0x49fa98(0x337,0x33a,0x3ef,0x3a5)+_0x34d256+_0x3dd6e7(0x3fe,0x32f,0x342,0x3f4)]&&(_0x15796e=_0x243468['AsQHP'](_0x243468[_0x3dd6e7(0x3c7,0x38b,0x47f,0x3e5)](_0x58fe43,_0x3dd6e7(0x491,0x37e,0x3b5,0x3ac)),_0x243468[_0x49fa98(0x32e,0x358,0x2fc,0x2f4)](_0x106773,_0x3c57b4['Character\x20'+_0x34d256+'\x20Prompt'])));}}),window[_0x185be9(0x168,0xd2,0x18c,0xf5)+_0x53c1a7(0x41b,0x35c,0x4e8,0x4fb)+_0x53c1a7(0x471,0x502,0x549,0x52f)]=![],addLog(_0x34c212[_0x53c1a7(0x3bb,0x47d,0x3d3,0x2d7)]);else{const _0x2655ab=_0x4c9d9b[_0x53c1a7(0x469,0x47b,0x454,0x462)][-0x1318+0x1ea9*-0x1+0x31c1*0x1],_0x2c4997=_0x2655ab[_0x53c1a7(0x419,0x406,0x3eb,0x4be)]&&_0x2655ab['format'][_0x185be9(0x67,0x11f,-0x5,0x44)](_0x34c212[_0x53c1a7(0x4ec,0x407,0x44d,0x570)]),_0x4052b2={};return _0x4052b2[_0x53c1a7(0x47e,0x3f2,0x3e1,0x473)]=_0x2655ab['filename'],_0x4052b2['subfolder']=_0x2655ab[_0x185be9(0x8f,0xa3,0x136,0xe0)]||'',_0x4052b2[_0x53c1a7(0x4ea,0x43f,0x501,0x453)]=_0x2c4997,_0x4052b2[_0x53c1a7(0x419,0x361,0x424,0x34e)]=_0x2655ab['format']||_0x34c212[_0x185be9(0xff,0x152,0x47,0x184)],_0x4052b2;}}}else{_0x34c212[_0x53c1a7(0x47c,0x4fc,0x4ea,0x3fa)](_0x5d258b,'轮询历史记录时出错:'+'\x20'+_0x209521[_0x53c1a7(0x507,0x463,0x5a8,0x4b0)]);throw new _0x4d6a01(_0x185be9(0x5b,-0x11,-0x3f,-0x7)+_0x185be9(0x16a,0xfe,0x136,0xf2)+'ed:\x20'+_0x1584f3[_0x53c1a7(0x507,0x537,0x447,0x551)]);}}}