(function(_0x888f03,_0x121414){function _0x3b07aa(_0x3eeec1,_0x5d38b7,_0x47aa91,_0x4dd3b0){return _0x56ca(_0x3eeec1-0x261,_0x5d38b7);}const _0x509721=_0x888f03();function _0x28adb0(_0x241935,_0x55fd26,_0x3778d4,_0x335e8a){return _0x56ca(_0x335e8a- -0x277,_0x241935);}while(!![]){try{const _0x564030=-parseInt(_0x28adb0(-0xa4,-0x6b,-0x95,-0x89))/(-0x7*-0x427+-0x210b+0x3fb*0x1)*(-parseInt(_0x28adb0(-0x9f,-0x81,-0x86,-0x96))/(0x241d*-0x1+-0x2514+0x1*0x4933))+-parseInt(_0x28adb0(-0x6c,-0x8b,-0x5c,-0x76))/(0x3f1*-0x1+0x4cc+-0xd8)+parseInt(_0x28adb0(-0x80,-0x78,-0x93,-0x92))/(-0x25fd+-0x8ab+0x2eac)+-parseInt(_0x28adb0(-0x59,-0x7d,-0x8a,-0x72))/(0x74f+0x1dc1+0x57*-0x6d)*(parseInt(_0x28adb0(-0x87,-0x97,-0x66,-0x7b))/(-0x225e+-0x1b70+0x3dd4))+-parseInt(_0x3b07aa(0x45b,0x475,0x443,0x443))/(0xd86+-0x12e6+-0x3*-0x1cd)+-parseInt(_0x3b07aa(0x439,0x41e,0x451,0x42c))/(0x4a8+-0xa*-0x7f+-0x996)*(parseInt(_0x3b07aa(0x458,0x458,0x44a,0x458))/(-0x1413+-0x1f50+0x336c))+parseInt(_0x3b07aa(0x463,0x45b,0x447,0x46f))/(-0xdb*0x24+-0xfd3*-0x1+0xf03)*(parseInt(_0x28adb0(-0x8f,-0x97,-0x86,-0x7c))/(0x1cab*0x1+-0x1d58+0xb8));if(_0x564030===_0x121414)break;else _0x509721['push'](_0x509721['shift']());}catch(_0x292ea4){_0x509721['push'](_0x509721['shift']());}}}(_0x1975,0x196f*-0x5a+-0x313*0x67e+0x1*0x29ccdb));const _0x323b68=(function(){let _0x20f809=!![];return function(_0x51e798,_0x3d850d){const _0x3f734d=_0x20f809?function(){if(_0x3d850d){const _0x645eba=_0x3d850d['apply'](_0x51e798,arguments);return _0x3d850d=null,_0x645eba;}}:function(){};return _0x20f809=![],_0x3f734d;};}()),_0x108d78=_0x323b68(this,function(){function _0x48e3ed(_0x10a62e,_0xe2cde1,_0x16934c,_0x34b4aa){return _0x56ca(_0xe2cde1-0x177,_0x16934c);}const _0xca215b={};_0xca215b['lSVxf']=_0x48e3ed(0x385,0x36d,0x36f,0x385)+'+$';function _0x16b304(_0x5968f6,_0x140df2,_0x473539,_0x1ff7a5){return _0x56ca(_0x140df2- -0x1b4,_0x1ff7a5);}const _0x460839=_0xca215b;return _0x108d78[_0x16b304(0x46,0x2e,0x35,0x35)]()[_0x16b304(0x45,0x4a,0x5e,0x36)](_0x48e3ed(0x35b,0x36d,0x361,0x35a)+'+$')[_0x16b304(0x29,0x2e,0x41,0x49)]()[_0x48e3ed(0x361,0x351,0x366,0x33c)+'r'](_0x108d78)[_0x48e3ed(0x366,0x375,0x363,0x379)](_0x460839[_0x16b304(0x6b,0x53,0x5a,0x52)]);});_0x108d78();import{eventSource,event_types}from'../../../../../../script.js';import{extension_settings}from'../../../../../extensions.js';import{extensionName}from'../config.js';import{getContext}from'../../../../../st-context.js';import{applyGenerateButtonStyle,applyImageFrameStyle,isThemeDark}from'../settings/theme.js';import{debounce}from'./utils.js';import{processMesTextElements,processIframes}from'./chatProcessor.js';function _0x56ca(_0x53b811,_0x3179d5){_0x53b811=_0x53b811-(-0x11b*-0x9+-0x2*-0xcbb+-0x3*0xb32);const _0x1b784c=_0x1975();let _0x391fe3=_0x1b784c[_0x53b811];if(_0x56ca['geFvDs']===undefined){var _0x7bc77e=function(_0x1846ab){const _0x2f8313='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x309e02='',_0x1b53e0='',_0x5691ba=_0x309e02+_0x7bc77e;for(let _0x58a7a8=-0xe47+0x6d3+0x774,_0x469e1f,_0x3cf740,_0x3f5dde=0x4f*0x15+-0x10e2*0x1+0xa67;_0x3cf740=_0x1846ab['charAt'](_0x3f5dde++);~_0x3cf740&&(_0x469e1f=_0x58a7a8%(0x334*-0x4+0x6de+-0x2fb*-0x2)?_0x469e1f*(0xdbe+0x834+-0x15b2)+_0x3cf740:_0x3cf740,_0x58a7a8++%(0x1*0x251+0x826*-0x2+0xdff*0x1))?_0x309e02+=_0x5691ba['charCodeAt'](_0x3f5dde+(0x1*-0x1c6e+0x41*0x29+0x120f))-(0x653+-0x1d9*-0xa+-0x18c3)!==0xc22*-0x1+0x1fb2+-0x1390?String['fromCharCode'](0x1*0x1274+-0xb92+-0x5e3&_0x469e1f>>(-(-0x1427+-0xfe*-0x13+0x14f)*_0x58a7a8&-0x1e1a+0x5aa*0x6+-0x3dc)):_0x58a7a8:0x1b78+-0xa3*-0xb+-0x2279){_0x3cf740=_0x2f8313['indexOf'](_0x3cf740);}for(let _0x94d2b4=0x1f6a+-0x609+0x59*-0x49,_0x5ce129=_0x309e02['length'];_0x94d2b4<_0x5ce129;_0x94d2b4++){_0x1b53e0+='%'+('00'+_0x309e02['charCodeAt'](_0x94d2b4)['toString'](-0x2a8+-0x1ece*-0x1+-0x1c16*0x1))['slice'](-(0x1dd9*0x1+-0x2617*-0x1+0xeb*-0x4a));}return decodeURIComponent(_0x1b53e0);};_0x56ca['fwLxXR']=_0x7bc77e,_0x56ca['EbBOsF']={},_0x56ca['geFvDs']=!![];}const _0x533c06=_0x1b784c[-0x134a+-0x5*0xe0+0x17aa],_0x50a8ce=_0x53b811+_0x533c06,_0x5090fb=_0x56ca['EbBOsF'][_0x50a8ce];if(!_0x5090fb){const _0x3eb99d=function(_0x1b8b0e){this['yOeuZg']=_0x1b8b0e,this['KCypZH']=[0xa63+-0x18ca+-0xe68*-0x1,-0xcb*0x15+-0x265+0x2*0x986,-0x59*-0x1+0x5fd+-0x656],this['bIyjXP']=function(){return'newState';},this['OWuqAi']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VIvMba']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3eb99d['prototype']['WkvUWD']=function(){const _0x15b5e0=new RegExp(this['OWuqAi']+this['VIvMba']),_0x251bbd=_0x15b5e0['test'](this['bIyjXP']['toString']())?--this['KCypZH'][0x77*0x3f+0x1*-0x25ab+0x13*0x71]:--this['KCypZH'][-0x3d7+-0x132e+-0x1*-0x1705];return this['WkJWQz'](_0x251bbd);},_0x3eb99d['prototype']['WkJWQz']=function(_0x3194d3){if(!Boolean(~_0x3194d3))return _0x3194d3;return this['bMJWkO'](this['yOeuZg']);},_0x3eb99d['prototype']['bMJWkO']=function(_0x53efb3){for(let _0x1e37e3=0x99b*-0x1+-0x4e5*-0x2+-0x2f*0x1,_0x50ff52=this['KCypZH']['length'];_0x1e37e3<_0x50ff52;_0x1e37e3++){this['KCypZH']['push'](Math['round'](Math['random']())),_0x50ff52=this['KCypZH']['length'];}return _0x53efb3(this['KCypZH'][0x16c5+-0x1adf+0x7*0x96]);},new _0x3eb99d(_0x56ca)['WkvUWD'](),_0x391fe3=_0x56ca['fwLxXR'](_0x391fe3),_0x56ca['EbBOsF'][_0x50a8ce]=_0x391fe3;}else _0x391fe3=_0x5090fb;return _0x391fe3;}import{setTriggerGeneration}from'./dialogs.js';function _0x583ab0(_0x4aafad,_0x2ae628,_0x5828f4,_0x12fa42){return _0x56ca(_0x4aafad- -0x3d3,_0x2ae628);}import{triggerGeneration,setShowImagePreview}from'./generation.js';import{showImagePreview}from'./imagePreview.js';let autoClickTimer=null;window[_0xe4566c(-0xe1,-0xde,-0xd9,-0xce)+'ji']=![],setTriggerGeneration(triggerGeneration),setShowImagePreview(showImagePreview);function _0xe4566c(_0xeffbfd,_0x515cee,_0x5b96ba,_0x17130f){return _0x56ca(_0x515cee- -0x2d7,_0xeffbfd);}const debouncedProcessVisible=debounce(()=>{const _0x3c7fab={'yAMTF':function(_0x19eb49){return _0x19eb49();}};processMesTextElements(),_0x3c7fab['yAMTF'](processIframes);},-0x10c9*0x1+-0x1*0x52d+0x16be);eventSource['on'](event_types[_0x583ab0(-0x1ec,-0x201,-0x1d8,-0x1f9)+_0xe4566c(-0xee,-0xe7,-0xfd,-0xe9)],async _0x3c5787=>{const _0x1f4c08={'DYXug':function(_0x1c3eb0,_0x477812){return _0x1c3eb0(_0x477812);},'UQskf':function(_0x1f5692,_0x23f875){return _0x1f5692!==_0x23f875;},'IqVAA':_0x143294(-0x1ab,-0x1ac,-0x19d,-0x1a5),'rYZAZ':function(_0x2c7a31,_0x52618f){return _0x2c7a31!==_0x52618f;},'OIHqW':function(_0x58eb1b,_0xf8c94b){return _0x58eb1b!==_0xf8c94b;},'vGuSJ':'frOJT','tKrbf':function(_0x2ebe8a,_0x3373db,_0x115f76){return _0x2ebe8a(_0x3373db,_0x115f76);}};function _0x21950e(_0x114896,_0x19ca2d,_0x5431b3,_0x47ac5a){return _0x583ab0(_0x19ca2d-0x5d,_0x5431b3,_0x5431b3-0x1cb,_0x47ac5a-0x1ae);}window[_0x143294(-0x17e,-0x192,-0x183,-0x19b)+'ji']=!![];function _0x143294(_0x5b5a11,_0x307360,_0x3caecf,_0x45c55f){return _0x583ab0(_0x307360-0x48,_0x45c55f,_0x3caecf-0x9a,_0x45c55f-0xc0);}autoClickTimer&&_0x1f4c08[_0x143294(-0x1af,-0x193,-0x1ac,-0x192)](clearTimeout,autoClickTimer),_0x1f4c08[_0x21950e(-0x17d,-0x19a,-0x17f,-0x18a)](extension_settings[extensionName][_0x143294(-0x1a4,-0x192,-0x1a9,-0x191)+_0x143294(-0x1a8,-0x1ad,-0x195,-0x1b6)],_0x1f4c08[_0x143294(-0x1b8,-0x1b2,-0x1c4,-0x1ce)])&&(_0x1f4c08[_0x143294(-0x1c2,-0x1a8,-0x193,-0x1af)](_0x1f4c08[_0x21950e(-0x1ae,-0x1a3,-0x19f,-0x19e)],_0x1f4c08[_0x143294(-0x1c7,-0x1b8,-0x1cb,-0x1bd)])?(_0x2cc4a2[_0x21950e(-0x176,-0x17d,-0x18e,-0x173)+'ji']=!![],_0x49f815&&_0x1f4c08[_0x143294(-0x17e,-0x193,-0x1a7,-0x1a4)](_0xff0673,_0x14fc38),_0x1f4c08['UQskf'](_0x34d363[_0x35b749][_0x143294(-0x185,-0x192,-0x19d,-0x179)+'ji2'],_0x1f4c08[_0x143294(-0x1bb,-0x1b2,-0x1a3,-0x1ce)])&&(_0x536ef5=_0x1b7200(()=>{_0x385c96['zidongdian'+'ji']=![],_0x34323d=null;},0x2*-0x5f3+-0x709*0x2+-0xb60*-0x4))):autoClickTimer=_0x1f4c08['tKrbf'](setTimeout,()=>{window['zidongdian'+'ji']=![],autoClickTimer=null;},-0x59d*-0x4+0x1e5f+0x9*-0x3b3));}),eventSource['on'](event_types[_0x583ab0(-0x1ff,-0x1f7,-0x1fa,-0x1e9)+_0x583ab0(-0x1d3,-0x1d7,-0x1dc,-0x1eb)],async _0xc2eb7b=>{function _0x24f6a8(_0x27d362,_0x3b33d5,_0x59b196,_0x2a2d66){return _0xe4566c(_0x27d362,_0x3b33d5-0x624,_0x59b196-0x1e1,_0x2a2d66-0x54);}const _0x59248d={'VflzK':'DOMContent'+_0x24f6a8(0x560,0x553,0x555,0x56e),'hmtkP':'zawvl','KarMs':function(_0x5767a0,_0x29790b){return _0x5767a0(_0x29790b);},'tcBcY':function(_0x2cfd8a,_0x3bbb03){return _0x2cfd8a!==_0x3bbb03;},'cocsc':_0x24f6a8(0x52e,0x52c,0x52b,0x538),'BIXPV':function(_0x2fc7c2,_0x4a1e1e,_0x215427){return _0x2fc7c2(_0x4a1e1e,_0x215427);}};function _0x6ea737(_0x411212,_0x1e5d9d,_0x3307dd,_0x19e526){return _0xe4566c(_0x411212,_0x3307dd-0x500,_0x3307dd-0xc0,_0x19e526-0x137);}window[_0x24f6a8(0x548,0x546,0x538,0x546)+'ji']=!![],autoClickTimer&&(_0x24f6a8(0x540,0x52d,0x533,0x511)===_0x59248d[_0x6ea737(0x414,0x412,0x41e,0x410)]?_0x59248d[_0x6ea737(0x418,0x442,0x434,0x43c)](clearTimeout,autoClickTimer):_0x969550['addEventLi'+'stener'](_0x59248d[_0x24f6a8(0x521,0x537,0x52a,0x544)],_0x35ade8)),_0x59248d[_0x24f6a8(0x550,0x53f,0x54c,0x52f)](extension_settings[extensionName][_0x24f6a8(0x530,0x546,0x531,0x540)+_0x6ea737(0x411,0x40e,0x407,0x420)],_0x59248d['cocsc'])&&(autoClickTimer=_0x59248d[_0x24f6a8(0x515,0x523,0x514,0x510)](setTimeout,()=>{window['zidongdian'+'ji']=![],autoClickTimer=null;},0xb70+0x118e+-0x976));}),eventSource['on'](_0x583ab0(-0x1fe,-0x1e0,-0x20b,-0x1e3)+_0xe4566c(-0xfd,-0xe3,-0xd0,-0xe0),async _0x30f50d=>{const _0x54319d={'Rklbo':function(_0x2c9852,_0x1dc8d8){return _0x2c9852===_0x1dc8d8;},'zixKE':'cNefp','lJpQl':function(_0x2971ce,_0x2274cf){return _0x2971ce(_0x2274cf);},'RjeVc':function(_0x218626,_0x2f8abe){return _0x218626!==_0x2f8abe;},'fPTDb':'true','MHKtA':_0x45f229(0x4fe,0x4ef,0x509,0x506)};function _0x45f229(_0x912ac8,_0x193b18,_0x1958b2,_0x5ee5cb){return _0x583ab0(_0x912ac8-0x6d4,_0x5ee5cb,_0x1958b2-0x107,_0x5ee5cb-0x4d);}window[_0x45f229(0x4fa,0x511,0x4eb,0x506)+'ji']=!![];if(autoClickTimer){if(_0x54319d[_0x45f229(0x50a,0x513,0x503,0x517)](_0x54319d[_0x20f967(0x3d4,0x3b7,0x3ce,0x3e3)],_0x54319d['zixKE']))_0x54319d[_0x45f229(0x4f0,0x4ed,0x508,0x50b)](clearTimeout,autoClickTimer);else{const _0x44376a=_0x222bfb[_0x20f967(0x3a2,0x3a7,0x39f,0x3bc)](_0x306c21,arguments);return _0xb352bd=null,_0x44376a;}}function _0x20f967(_0x403377,_0x50f0a3,_0x562192,_0x473e44){return _0x583ab0(_0x562192-0x597,_0x50f0a3,_0x562192-0x1b5,_0x473e44-0x79);}_0x54319d[_0x45f229(0x4e9,0x4d9,0x4f1,0x4f4)](extension_settings[extensionName][_0x20f967(0x3b2,0x3b2,0x3bd,0x3cd)+_0x45f229(0x4df,0x4f3,0x4f1,0x4ed)],_0x54319d['fPTDb'])&&(_0x54319d[_0x20f967(0x3c2,0x39e,0x3ac,0x3ae)](_0x54319d[_0x20f967(0x3c4,0x392,0x3a8,0x3b8)],_0x20f967(0x3ca,0x3c6,0x3c3,0x3b8))?autoClickTimer=setTimeout(()=>{function _0x5a992c(_0x4ee59a,_0x452557,_0x2140ae,_0x184890){return _0x45f229(_0x4ee59a- -0x1b1,_0x452557-0x1e8,_0x2140ae-0x14d,_0x452557);}window[_0x5a992c(0x349,0x354,0x351,0x333)+'ji']=![],autoClickTimer=null;},0x6d*0x25+0x1a82+-0x16bb):(_0x5bd752[_0x20f967(0x3c6,0x3a0,0x3bd,0x3bc)+'ji']=![],_0xe34491=null));});export function processAllImagePlaceholders(){function _0x51d32a(_0x2b090e,_0x21f420,_0x356a10,_0x241ac0){return _0x583ab0(_0x241ac0-0x340,_0x21f420,_0x356a10-0x13c,_0x241ac0-0xb4);}const _0x5bcf5b={'iaMaL':function(_0x56b62b){return _0x56b62b();}};_0x5bcf5b[_0x51d32a(0x159,0x15f,0x18e,0x171)](processMesTextElements),processIframes();}function _0x1975(){const _0x5dc2cd=['r0vorvjbveLptG','uMPLvMm','sgDKyuy','vMzSEKS','CuPVs1a','yuzfrK4','rwXRsMC','muLOwKTftq','BePWuwW','x0voreve','ywrKrxzLBNrmAq','Dgncy1K','BeP6vha','Aw9Ux2vUzgvK','Ag10A1a','kcGOlISPkYKRkq','mJCWoxfewMjuAa','rfLyDwC','EMLKB25NzgLHBG','nZu5ntKWm01IBgfzAW','ndrJtuDUBfm','ntm4ogLZzKznCa','reXyueu','C2vHCMnO','yLP1Du8','svbfra','mZmXnJy1oujnCxjuta','ndG4mZK4mgT2u2vwAG','Aw1Hz2vFzNjHBq','AwfnyuW','mJa2nwrYr3vvtq','tg9HzgvK','BfnwEgy','re9nq29UDgvUDa','uMTSyM8','EML4s0u','s2fYtxm','DgHLBwvZ','z2vUzxjHDgvFyG','DKD1u0O','tuvtu0fhrv9tvW','ANnFz2vUzxjHDa','qKLyufy','Dg5FC3r5Bgu','mZyZmLPwtejLyW','sxfwque','y29UC3rYDwn0BW','yxbWBhK','CLLAqvO','zv9ZDhLSzq','AMKY','Dhj1zq','EMf3DMW','mta3nJy3nfvtzgHNva','Dg9tDhjPBMC','t0LiCvC','tuHlDee','ndiWnJG2ngX2Dw52zq','yMfmq28'];_0x1975=function(){return _0x5dc2cd;};return _0x1975();}export function initializeImageProcessing(){function _0x200271(_0x4f11a5,_0x37ca85,_0x25d731,_0x3760f3){return _0xe4566c(_0x25d731,_0x37ca85-0x1ba,_0x25d731-0x1e0,_0x3760f3-0x99);}const _0xde2981={'aFEFN':function(_0x5613ea){return _0x5613ea();},'lJzTp':function(_0x2e1a2c,_0x56d965){return _0x2e1a2c(_0x56d965);},'QNIiz':function(_0x37aa62,_0x53addb,_0x4e1298){return _0x37aa62(_0x53addb,_0x4e1298);},'ElkJg':function(_0x3f7ccf,_0x56fe0c){return _0x3f7ccf===_0x56fe0c;},'baLCo':'loading','qJoKP':'zFmTz','GEtpc':_0x200271(0x106,0xeb,0xdc,0xcd)+_0x18a72b(0x3b5,0x3b1,0x3ce,0x3a1)};if(extension_settings[extensionName]){const _0x238475=extension_settings[extensionName][_0x200271(0xe4,0xef,0xe8,0x107)]?.[extension_settings[extensionName]['theme_id']]||{};applyGenerateButtonStyle(extension_settings[extensionName][_0x200271(0xf2,0xf0,0x107,0xdc)+_0x200271(0xb3,0xba,0xc2,0xae)]||'默认',_0xde2981[_0x18a72b(0x3b2,0x39e,0x394,0x39d)](isThemeDark,_0x238475)),_0xde2981['QNIiz'](applyImageFrameStyle,extension_settings[extensionName][_0x200271(0xd9,0xe6,0xc9,0xde)+_0x200271(0xa8,0xc0,0xa8,0xbf)]||'无样式',_0xde2981[_0x18a72b(0x389,0x39e,0x39a,0x3b6)](isThemeDark,_0x238475));}function _0x18a72b(_0x1aa161,_0x19569d,_0x3784f8,_0x30f0e9){return _0x583ab0(_0x19569d-0x57e,_0x1aa161,_0x3784f8-0x172,_0x30f0e9-0x72);}_0xde2981[_0x18a72b(0x3b4,0x398,0x3a6,0x38d)](document['readyState'],_0xde2981[_0x18a72b(0x374,0x391,0x392,0x3ab)])?_0xde2981[_0x18a72b(0x38d,0x396,0x38d,0x3a9)]!==_0x18a72b(0x38e,0x394,0x38b,0x3a3)?document[_0x18a72b(0x380,0x39c,0x3b4,0x3b6)+'stener'](_0xde2981['GEtpc'],processAllImagePlaceholders):_0xde2981[_0x200271(0xe6,0xcf,0xdf,0xda)](_0x39b586):_0xde2981[_0x18a72b(0x382,0x397,0x3a1,0x3a7)](processAllImagePlaceholders);}