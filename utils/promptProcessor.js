(function(_0x1ba7e5,_0x12c955){function _0x2a28e1(_0xa2a02b,_0x3aa8d6,_0x24fc8f,_0x1e20ec){return _0x2049(_0xa2a02b- -0x1a8,_0x1e20ec);}const _0x13ed37=_0x1ba7e5();function _0x11d71a(_0x1550ea,_0x3c68c8,_0x1f169a,_0x3dbe6e){return _0x2049(_0x1f169a-0xaf,_0x3c68c8);}while(!![]){try{const _0xa81544=parseInt(_0x11d71a(0x123,0x19d,0x168,0x146))/(-0x7*-0x221+-0xd*0xfe+0x40*-0x8)*(parseInt(_0x11d71a(0x1ff,0x21e,0x1ed,0x1b1))/(-0x2394+0x124d+0x1149))+-parseInt(_0x11d71a(0x18c,0x17e,0x1ad,0x19b))/(-0x9e+0x2345*0x1+0x2*-0x1152)*(parseInt(_0x11d71a(0x201,0x1d4,0x211,0x25b))/(-0x1487+0x14*-0xc9+0x3*0xc15))+parseInt(_0x2a28e1(-0x52,-0x38,-0x91,-0x69))/(0x138f*0x1+-0x4*0x605+0x53*0xe)+parseInt(_0x2a28e1(-0xad,-0xc5,-0x66,-0x6c))/(-0x21e*0x2+0x50b+-0xc9)*(parseInt(_0x11d71a(0x1cd,0x20e,0x207,0x215))/(0x21e2+-0xb31+-0x16aa))+parseInt(_0x2a28e1(-0x72,-0x2f,-0x80,-0x63))/(0xb55+0xd3d+0x1*-0x188a)+parseInt(_0x11d71a(0x23a,0x24a,0x213,0x1e6))/(-0x1*-0x611+0x3df*0x3+-0x11a5)*(-parseInt(_0x11d71a(0x1a5,0x18b,0x1e3,0x225))/(-0x511+-0xd*-0xf4+0x1*-0x749))+-parseInt(_0x11d71a(0x1c1,0x203,0x1d8,0x1b8))/(0xb3e+-0x256a+0x1*0x1a37)*(parseInt(_0x11d71a(0x1d6,0x221,0x212,0x226))/(0x2493+0x533+-0x1*0x29ba));if(_0xa81544===_0x12c955)break;else _0x13ed37['push'](_0x13ed37['shift']());}catch(_0x296b76){_0x13ed37['push'](_0x13ed37['shift']());}}}(_0x11fd,0x18f9c5+0x1631a1+-0x21940a));const _0x7887b7=(function(){function _0x165a40(_0x42d005,_0x47c622,_0x1c029c,_0x299af0){return _0x2049(_0x42d005-0x3d3,_0x299af0);}const _0x203e38={};_0x203e38[_0x165a40(0x518,0x4ff,0x55b,0x513)]=function(_0x8727dc,_0x4515cd){return _0x8727dc===_0x4515cd;},_0x203e38['TSADQ']=_0x27e514(0x7,-0x4e,0x5f,0x4b);const _0x22374d=_0x203e38;function _0x27e514(_0x244729,_0x59c20f,_0xaf15f5,_0x373c04){return _0x2049(_0x244729- -0xe9,_0x59c20f);}let _0x35953b=!![];return function(_0x2d6610,_0x324e26){const _0x2fabe={'nWeFs':function(_0x2c8bbf,_0x5a5494){function _0x3be7bb(_0x1d9bb1,_0x5a4942,_0xa10d0d,_0x5a4738){return _0x2049(_0x5a4738-0x360,_0x5a4942);}return _0x22374d[_0x3be7bb(0x4a8,0x4bb,0x4c9,0x4a5)](_0x2c8bbf,_0x5a5494);},'nGGPi':_0x22374d[_0xb57d0(-0x8,0x2c,-0x54,-0x29)]},_0x568413=_0x35953b?function(){function _0x3a8630(_0xae5e8c,_0x2eb6db,_0x157fde,_0x3d924a){return _0xb57d0(_0x3d924a- -0x165,_0x2eb6db-0x15a,_0x157fde-0x197,_0x157fde);}function _0x355a78(_0x5baadb,_0x5e8067,_0x2eda92,_0x2ba476){return _0xb57d0(_0x2ba476-0x59,_0x5e8067-0x1d3,_0x2eda92-0x88,_0x5baadb);}if(_0x324e26){if(_0x2fabe[_0x355a78(0xc1,0x38,0x6b,0x71)](_0x2fabe[_0x355a78(0x34,0x4,0x9b,0x46)],_0x2fabe['nGGPi'])){const _0x44bc1f=_0x324e26['apply'](_0x2d6610,arguments);return _0x324e26=null,_0x44bc1f;}else _0x54bcb0['add'](_0x3a8630(-0x135,-0x168,-0x10f,-0x159)+_0x3a8630(-0x146,-0x152,-0x11c,-0x143)+_0x4d61da+'@}');}}:function(){};_0x35953b=![];function _0xb57d0(_0x438e43,_0xf8fc60,_0x3b2546,_0x220af5){return _0x165a40(_0x438e43- -0x512,_0xf8fc60-0x79,_0x3b2546-0x158,_0x220af5);}return _0x568413;};}()),_0x2609b6=_0x7887b7(this,function(){const _0xfd53de={};function _0x45d1d7(_0xeb17bb,_0x342efe,_0x449d41,_0x30215a){return _0x2049(_0x342efe- -0x184,_0xeb17bb);}_0xfd53de[_0x45d1d7(-0x85,-0x4f,-0x22,-0x7f)]=_0x45d1d7(-0xb0,-0xb4,-0xa3,-0x7a)+'+$';function _0x1d9c8a(_0x41d783,_0x27acb0,_0x4d76f2,_0x14a837){return _0x2049(_0x4d76f2- -0x3d7,_0x27acb0);}const _0x43dccd=_0xfd53de;return _0x2609b6[_0x1d9c8a(-0x2d3,-0x278,-0x2cb,-0x2f8)]()[_0x45d1d7(-0x87,-0xb2,-0xe5,-0xd1)](_0x43dccd['WfuwM'])['toString']()['constructo'+'r'](_0x2609b6)[_0x45d1d7(-0xd7,-0xb2,-0x9c,-0xca)](_0x45d1d7(-0xf1,-0xb4,-0xca,-0x107)+'+$');});function _0x2049(_0x33551d,_0x5bfd12){_0x33551d=_0x33551d-(-0x24e4+-0x2588+0x4b1d);const _0x58c8ac=_0x11fd();let _0x26dedf=_0x58c8ac[_0x33551d];if(_0x2049['LPZFRG']===undefined){var _0x5a7095=function(_0x2f45fb){const _0x20d53d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xc9f71d='',_0x50393f='',_0x332b1e=_0xc9f71d+_0x5a7095;for(let _0x676baf=-0x2627+-0x3*0x435+0x2*0x1963,_0x77e790,_0x18bcf5,_0x5f0bb3=-0x1*-0x1f6a+0x14a*0xd+-0x302c*0x1;_0x18bcf5=_0x2f45fb['charAt'](_0x5f0bb3++);~_0x18bcf5&&(_0x77e790=_0x676baf%(0x10ea+-0x2065+-0x1*-0xf7f)?_0x77e790*(-0x11d1+0x2*-0x86+0x131d)+_0x18bcf5:_0x18bcf5,_0x676baf++%(-0x1742+-0x20b9*-0x1+-0x973))?_0xc9f71d+=_0x332b1e['charCodeAt'](_0x5f0bb3+(0x7ed*0x3+-0x168d+-0x130))-(-0x116b+-0x4*-0x683+-0x1*0x897)!==0x2163+0x1cfe+-0x3e61?String['fromCharCode'](0x78f*0x4+-0x1*0x11db+0x1*-0xb62&_0x77e790>>(-(-0x1c2c+-0x252e+-0xbc*-0x59)*_0x676baf&0x11b*-0xb+0xcc+0xb63)):_0x676baf:0x764+-0x1a3*0x12+-0x46a*-0x5){_0x18bcf5=_0x20d53d['indexOf'](_0x18bcf5);}for(let _0x2443ca=0x19*0x143+0x1e7b+-0x3e06,_0x43da84=_0xc9f71d['length'];_0x2443ca<_0x43da84;_0x2443ca++){_0x50393f+='%'+('00'+_0xc9f71d['charCodeAt'](_0x2443ca)['toString'](0x7*-0x24a+0x19b9+-0x9a3))['slice'](-(-0x22a3+-0x1*0x1ca3+0x32*0x144));}return decodeURIComponent(_0x50393f);};_0x2049['SHCjNY']=_0x5a7095,_0x2049['EzZmZF']={},_0x2049['LPZFRG']=!![];}const _0x3ebcbf=_0x58c8ac[-0x18d1+0x125d*-0x2+0x3d8b],_0x332597=_0x33551d+_0x3ebcbf,_0x42542e=_0x2049['EzZmZF'][_0x332597];if(!_0x42542e){const _0x4c81a7=function(_0x2a39ad){this['iqmuuh']=_0x2a39ad,this['epGSZB']=[0x111a+0x2321+-0xe*0x3bb,0x118*0x1b+0x1b2d+0x12e7*-0x3,-0x1*-0x419+0x81*0x42+-0x255b],this['mNFZNJ']=function(){return'newState';},this['cPrbFH']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ThKqQK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4c81a7['prototype']['nzIjVG']=function(){const _0x4f44b9=new RegExp(this['cPrbFH']+this['ThKqQK']),_0x3a4c08=_0x4f44b9['test'](this['mNFZNJ']['toString']())?--this['epGSZB'][-0x2215+0x2318+-0x2b*0x6]:--this['epGSZB'][0x2193+-0x841*-0x4+-0x4297];return this['pjRHgC'](_0x3a4c08);},_0x4c81a7['prototype']['pjRHgC']=function(_0x18e413){if(!Boolean(~_0x18e413))return _0x18e413;return this['pRnbDT'](this['iqmuuh']);},_0x4c81a7['prototype']['pRnbDT']=function(_0xa36ca8){for(let _0x4be617=0x1136+-0x5*0x471+0x1*0x4ff,_0x3aebfc=this['epGSZB']['length'];_0x4be617<_0x3aebfc;_0x4be617++){this['epGSZB']['push'](Math['round'](Math['random']())),_0x3aebfc=this['epGSZB']['length'];}return _0xa36ca8(this['epGSZB'][-0x3*0x33c+0x67b+0x339]);},new _0x4c81a7(_0x2049)['nzIjVG'](),_0x26dedf=_0x2049['SHCjNY'](_0x26dedf),_0x2049['EzZmZF'][_0x332597]=_0x26dedf;}else _0x26dedf=_0x42542e;return _0x26dedf;}_0x2609b6();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x31eb4b,_0x2da6e5){const _0x4c255d={};_0x4c255d[_0x16027e(0x370,0x370,0x33e,0x3bf)]=function(_0x13428d,_0x235697){return _0x13428d!==_0x235697;},_0x4c255d[_0x16027e(0x362,0x373,0x333,0x327)]=_0x16027e(0x301,0x324,0x357,0x33f);function _0x16027e(_0x5ff3d,_0xe03436,_0x29a910,_0x378da4){return _0x2049(_0x5ff3d-0x243,_0x378da4);}_0x4c255d[_0x16027e(0x307,0x300,0x2b8,0x2da)]=function(_0x5e8abc,_0x5698fe){return _0x5e8abc!==_0x5698fe;},_0x4c255d['fuBDa']=function(_0xd19167,_0x4ebe1f){return _0xd19167===_0x4ebe1f;},_0x4c255d[_0x3e2032(-0x16b,-0x14d,-0x199,-0x113)]=_0x16027e(0x37d,0x376,0x3bd,0x38c),_0x4c255d[_0x16027e(0x346,0x36e,0x390,0x361)]=function(_0x177e67,_0x456c8d){return _0x177e67!==_0x456c8d;};function _0x3e2032(_0x24a399,_0x28a069,_0xf3bb65,_0x509a1e){return _0x2049(_0x24a399- -0x29c,_0x28a069);}_0x4c255d['AoJVy']=_0x3e2032(-0x163,-0x165,-0x176,-0x165),_0x4c255d['ZDTjt']=_0x3e2032(-0x16a,-0x156,-0x140,-0x137);const _0x2f3fe3=_0x4c255d;if(!_0x31eb4b||!_0x2da6e5)return _0x2f3fe3[_0x3e2032(-0x148,-0x18b,-0x154,-0x11b)](_0x16027e(0x37d,0x3c3,0x3b8,0x36c),_0x2f3fe3[_0x16027e(0x374,0x3a1,0x37e,0x3c3)])?![]:(_0x332b1e&&_0x676baf[_0x16027e(0x33f,0x379,0x34c,0x31c)](_0x77e790)&&(_0x4f44b9&&_0xa36ca8[_0x16027e(0x367,0x344,0x30b,0x343)](_0x4be617)),_0x43da84[_0x3e2032(-0x1ce,-0x1e0,-0x21e,-0x228)](_0x4c81a7,_0x2a39ad||''));const _0x56b26e=_0x31eb4b[_0x3e2032(-0x1d9,-0x1a2,-0x1d8,-0x188)](',')[_0x3e2032(-0x17a,-0x1d6,-0x18c,-0x17e)](_0x2a28ef=>_0x2a28ef['trim']())[_0x3e2032(-0x171,-0x17a,-0x118,-0x1aa)](_0x33f59e=>_0x33f59e);if(_0x56b26e[_0x3e2032(-0x1e2,-0x1fb,-0x23d,-0x1e6)]===0x355*-0x5+-0x128*0x8+0x19e9){if(_0x2f3fe3[_0x3e2032(-0x199,-0x1c2,-0x19b,-0x17e)](_0x2f3fe3[_0x16027e(0x376,0x39e,0x31d,0x3b5)],_0x2f3fe3['ZDTjt']))return![];else{if(_0x1a3967['user']&&_0x2f3fe3[_0x3e2032(-0x16f,-0x18b,-0x1a6,-0x145)](_0x489e4c['user']['trim'](),'')){const _0xe8208d={};_0xe8208d['role']=_0x2f3fe3[_0x3e2032(-0x17d,-0x164,-0x12e,-0x14a)],_0xe8208d[_0x16027e(0x350,0x310,0x30b,0x35b)]=_0x205c0c[_0x16027e(0x301,0x321,0x2ea,0x307)],_0x190aaf[_0x3e2032(-0x1bd,-0x213,-0x1cf,-0x1ba)](_0xe8208d);}if(_0x2fc34f[_0x16027e(0x3aa,0x3c8,0x3f5,0x37a)]&&_0x2f3fe3[_0x3e2032(-0x1d8,-0x1bc,-0x230,-0x20c)](_0x4ef261[_0x16027e(0x3aa,0x352,0x3a6,0x370)][_0x3e2032(-0x1e0,-0x227,-0x1e3,-0x1cc)](),'')){const _0x28597b={};_0x28597b[_0x16027e(0x33c,0x34b,0x35a,0x384)]=_0x3e2032(-0x135,-0xda,-0x178,-0x135),_0x28597b[_0x16027e(0x350,0x389,0x36d,0x342)]=_0x830abe[_0x3e2032(-0x135,-0xef,-0x14f,-0xe3)],_0x2d1a3b[_0x16027e(0x322,0x31c,0x360,0x302)](_0x28597b);}}}for(const _0x40eec2 of _0x56b26e){if(_0x2da6e5[_0x3e2032(-0x1a0,-0x1b9,-0x163,-0x174)](_0x40eec2))return!![];}return![];}function _0x11fd(){const _0x132a29=['r0vpwLa','AM9PBG','wff4u0m','ChrstM0','wgLIyNC','uuTkC1a','t1zisem','DwXADLG','D0fSvxm','CMvWBgfJzq','y0jzDMi','wgPUugi','y2HHDe1LDgfKyq','ufbpshe','BK92BKK','Df90ExbLx2nVBG','sgnrAu8','CM9Szq','vKj4u0G','mJm0qNf0tefo','Aw5JBhvKzxm','B2fPs2i','mte0mJmXtefOEg5L','v0Hcz1q','BhL0AwO','DMfYAwfIBgvZ','BMPMzfK','qxnUzwK','zw5HyMXLza','Bwf0y2HbBgW','EfDQBge','zfHqq3a','E3VNLkJMIlFPNidMSyj9Fq','vuzbAxG','C3rYAw5NAwz5','CeD0AKy','Dg9tDhjPBMC','y29UDgvUDa','E3VKUiRKUiVMLOD9Fq','DMfYoJO','vfnstLK','tgvJD3e','yxbWBhK','BwvZC2fNzxm','rgrszLe','C216vhu','BgLhruS','uwP0D3q','CxL4wgS','ALvvCve','BNvjz00','EhDPtg0','Chvtu3e','B2zPBgu','rLvqtgm','q2z5u2W','y29UDgv4DerHDa','z2HUvNa','BwfW','D0rVEuq','ywrK','phvZzxi+','wejhA2K','Dgv4Da','sKzHy28','mtKZotnMt3rVCM0','uvrOCuy','zMLSDgvY','BKDhugK','tMrzve4','uKvPs2G','AMvsyLK','B1HuEgC','CMf0sfi','uhbAAwW','qw9kvNK','nZbIsvzYueq','v2z1D00','ndC2mZq2nePwANLWsq','vfnbrfe','AwLNwem','AgPkqKO','uxfUuLe','DhLWzq','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','t3rTzhm','ndK5mJCWzvDRqNPw','E0bNzxrNBg9Iyq','sMjxwMq','DxbNsgi','uNfNBuG','ueXgAxu','CMvXDwvZDfr5Ca','yKjbyxu','zw50CMLLCW','CuzXAvK','whnNuge','y29UDgv4Df9WCG','BMfTzte','E0bZzxrNBg9Iyq','u1PSEw0','vhrRDeG','EhrFChjVzMLSzq','E3VKUjBNLyZKUABOP6BLJ5f9Fq','AunRC2q','vfbSy0S','C3rYAw5N','DLbwBge','zNvcrge','sMrmt2u','mtK2ndiZnuvbEuTivq','BLDLrNm','mJK2ntK3vvrlANHu','EwTbC1a','E0bNzxr2yxi6oG','sxH2y0e','twvsq0u','C2fbDwC','vwvTqu4','zKvYrLK','DgvZDf9JB250zq','BhzHCJO6','ngLRrhvpuq','mti3mdHICNnor1C','mta4ndq3m1zfB1nrtW','s1vQvgm','wLrbvNO','yxnZAxn0yw50','zunYBei','rwHdtfm','q250vwO','ru1ht0i','zMLNCW','ExntyM0','yMDtA1G','DKnzzgO','u3fovve','nefYAejIqG','BgvUz3rO','tgzXzhe','DhjPBq','zLPXEM0','DxnLCG','AgLZDg9YEq','Cgvxvhy','BefPELy','zNrvs1K','C3bSAxq','BKvcC04','C3n4DuO','CMLHyMXLCW','EeXlsKK','BNbmqve','s1bhDK0','DhjPz2DLCK1Vza','vvDKs3G','A1vhBMi','uvPiwKu','CMvWBgfJzufSBa','v2jUDMy','kcGOlISPkYKRkq','DuTHB04','C2vHCMnO','q1jwBg8','ChDeAge','r0rtAxi','Eufpre4','E3T1C2vYFx0','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','E0bNzxr3B3jSza','txjVu04','E0bZzxr2yxi6oG','EwHryxG','ruTXExq','EKDnB08','ChvZAa','yMXjCNu','Dfrsr1i','E3TNzxr2yxi6oG','AxnbCNjHEq','A2v5CW','DhjPz2DLCLDVCG','B2jQzwn0','AKzpz1u'];_0x11fd=function(){return _0x132a29;};return _0x11fd();}export function mergeAdjacentMessages(_0x457602){const _0x545f05={'CnRli':_0x1ff318(-0x96,-0xce,-0x8e,-0x8e),'ZTAVz':'<user>','JbWZd':function(_0x485a39,_0x3a2680,_0x5dae37,_0x5afef8){return _0x485a39(_0x3a2680,_0x5dae37,_0x5afef8);},'GEOZP':function(_0x168855,_0x28c676){return _0x168855(_0x28c676);},'smzTu':function(_0x24c897,_0x435a2a){return _0x24c897===_0x435a2a;},'TPlcK':_0x1ff318(-0x3c,-0x6,-0x96,-0x47),'Qjtwt':function(_0x35b8cd,_0x403d55){return _0x35b8cd!==_0x403d55;},'ysSbm':function(_0x73b447,_0x8e3b17,_0x7e3145){return _0x73b447(_0x8e3b17,_0x7e3145);},'Xibbw':function(_0x5d1387,_0x225d45){return _0x5d1387===_0x225d45;},'UWdKx':_0x1ff318(-0x8a,-0x41,-0x2e,-0x7a),'PPOHq':function(_0x56e83c,_0x3b4961){return _0x56e83c===_0x3b4961;},'EKqyt':'HKyix'};if(!_0x457602||_0x457602[_0x1b7fed(-0x1be,-0x1af,-0x181,-0x17a)]===-0xdce+-0x275*0x9+0x3*0xbf9)return[];const _0x511bee=[];function _0x1b7fed(_0xfc6d91,_0x17e761,_0x2baea0,_0x48bc59){return _0x2049(_0xfc6d91- -0x278,_0x17e761);}let _0x473025=null;for(const _0x245f68 of _0x457602){if(_0x545f05[_0x1ff318(-0x5b,-0x1e,-0x79,-0x50)](_0x545f05[_0x1b7fed(-0x127,-0x13a,-0x150,-0x146)],_0x545f05[_0x1b7fed(-0x127,-0xfc,-0x148,-0xcb)])){if(!_0x473025){if(_0x545f05[_0x1b7fed(-0x161,-0x1ad,-0x167,-0x17f)]('HcQiO',_0x1ff318(-0x6e,-0x2b,-0x1b,-0x6d)))_0x55f42b=_0x4694a4[_0x1b7fed(-0x1aa,-0x175,-0x18a,-0x1a7)](_0x545f05['CnRli'],_0x3ffac9),_0x10feb5=_0x1155ca[_0x1ff318(-0x78,-0xd0,-0x91,-0x97)](_0x545f05[_0x1ff318(0x3d,-0x2e,-0x58,0x1)],_0x351089);else{const _0x1f6bae={..._0x245f68};_0x473025=_0x1f6bae;}}else{if(_0x545f05['smzTu'](_0x473025[_0x1ff318(-0x75,-0x35,-0x4a,-0x6c)],_0x245f68[_0x1ff318(-0xaa,-0x7d,-0xc5,-0x6c)]))_0x473025[_0x1ff318(-0x40,-0x31,-0x4e,-0x58)]=_0x545f05[_0x1b7fed(-0x1c3,-0x187,-0x1f6,-0x208)](mergeContent,_0x473025[_0x1b7fed(-0x16b,-0x174,-0x1a6,-0x1ba)],_0x245f68[_0x1b7fed(-0x16b,-0x1a8,-0x10f,-0x144)]);else{if(_0x545f05[_0x1ff318(-0x6a,-0x72,-0x7c,-0x79)](_0x1ff318(-0x60,-0x3d,-0x59,-0x7a),_0x545f05[_0x1b7fed(-0x1ad,-0x19d,-0x1bc,-0x1b6)])){_0x511bee['push'](_0x473025);const _0x1da48c={..._0x245f68};_0x473025=_0x1da48c;}else _0x382319[_0x1b7fed(-0x199,-0x1f1,-0x159,-0x161)](_0x52dca6);}}}else return _0x545f05[_0x1b7fed(-0x138,-0x147,-0x171,-0x107)](_0x4a9a6b,_0x544eae,_0x244982,_0x5c2bd0);}function _0x1ff318(_0x4acf75,_0x218e7e,_0x5692e7,_0x3b481a){return _0x2049(_0x3b481a- -0x165,_0x218e7e);}if(_0x473025){if(_0x545f05[_0x1ff318(-0x33,-0x2f,-0x1e,-0x70)](_0x545f05[_0x1b7fed(-0x19b,-0x1d0,-0x17a,-0x199)],_0x1b7fed(-0x16d,-0x1aa,-0x17c,-0x117))){const _0x7cd01a=_0x4532d8['trim'](),_0xe6a3de=_0x545f05[_0x1ff318(-0xc2,-0x86,-0x57,-0x7d)](_0x31a576,_0x7cd01a)||'';return _0x57494a&&_0x5e1f44[_0x1ff318(-0x5f,-0x91,-0x62,-0x41)]('{@getworld'+_0x1ff318(-0x6c,-0x9f,-0x9e,-0x56)+_0x7cd01a+'@}'),_0xe6a3de;}else _0x511bee[_0x1ff318(-0xc1,-0xb7,-0xc7,-0x86)](_0x473025);}return _0x511bee;}function mergeContent(_0x4ace9f,_0x101c85){const _0x384fa={'QZHZE':function(_0x13b8e4,_0x32633c,_0x34b926){return _0x13b8e4(_0x32633c,_0x34b926);},'qFqiY':function(_0x32bfde,_0x56765c){return _0x32bfde===_0x56765c;},'yAODN':'string','MeRCE':function(_0x465b88,_0x297cdb){return _0x465b88===_0x297cdb;},'JFaco':function(_0x41b7b6,_0x26635c){return _0x41b7b6===_0x26635c;},'uAjvR':_0xeee88e(0x48a,0x47b,0x460,0x483),'jFOgU':function(_0x330252,_0x2a8be2){return _0x330252+_0x2a8be2;},'XsgPa':function(_0x32a258,_0x4658f7){return _0x32a258(_0x4658f7);},'upgHb':_0x4650d8(0x238,0x1b7,0x1e4,0x224)};if(_0x384fa[_0x4650d8(0x225,0x1b7,0x204,0x22b)](typeof _0x4ace9f,_0x384fa[_0x4650d8(0x1bb,0x15e,0x193,0x1dc)])&&_0x384fa[_0x4650d8(0x1ff,0x25d,0x219,0x24f)](typeof _0x101c85,_0xeee88e(0x509,0x514,0x4c6,0x4df))){if(_0x384fa[_0x4650d8(0x1ce,0x237,0x1e5,0x18b)](_0x384fa['uAjvR'],'cEgQM'))_0x53e485['content']=_0x384fa[_0x4650d8(0x155,0x14a,0x18a,0x1b3)](_0x55f141,_0x435d76['content'],_0x44901d[_0xeee88e(0x4c4,0x4d6,0x468,0x4c7)]);else return _0x384fa[_0xeee88e(0x49e,0x4b6,0x48e,0x4e4)](_0x4ace9f+'\x0a',_0x101c85);}const _0x1e7940=_0x384fa[_0x4650d8(0x1ce,0x1db,0x205,0x202)](normalizeToArray,_0x4ace9f);function _0xeee88e(_0x17520c,_0x480b6e,_0x4e4d4e,_0x2c45d0){return _0x2049(_0x17520c-0x3b7,_0x4e4d4e);}const _0x5704be=_0x384fa['XsgPa'](normalizeToArray,_0x101c85),_0x27020e={};function _0x4650d8(_0x1a3bd9,_0x57237d,_0x232b7b,_0x21fdc5){return _0x2049(_0x232b7b-0xbd,_0x1a3bd9);}return _0x27020e[_0x4650d8(0x1e7,0x1e7,0x1f8,0x241)]=_0x384fa[_0xeee88e(0x4f8,0x4ae,0x54c,0x4b3)],_0x27020e[_0xeee88e(0x4de,0x4ce,0x4d7,0x50c)]='\x0a',[..._0x1e7940,_0x27020e,..._0x5704be];}function normalizeToArray(_0x2715ce){const _0x4bb190={'lytij':function(_0x125318,_0x110415,_0x94a6b0,_0x1a7d2c,_0xf4803b){return _0x125318(_0x110415,_0x94a6b0,_0x1a7d2c,_0xf4803b);},'wDoyD':function(_0x445efe,_0x4f730e){return _0x445efe===_0x4f730e;},'Wbnvf':_0x27e3fc(0x376,0x3cf,0x41d,0x39a),'lAizV':_0x27e3fc(0x3a9,0x3cc,0x395,0x382),'nuIgM':function(_0x270461,_0x576a8a){return _0x270461||_0x576a8a;}};function _0x27e3fc(_0x8ea2c4,_0x4b8723,_0x843da6,_0x43cee6){return _0x2049(_0x4b8723-0x2a5,_0x8ea2c4);}if(Array['isArray'](_0x2715ce)){if(_0x4bb190[_0x50a760(-0x85,-0x87,-0x4a,-0xa9)](_0x4bb190[_0x50a760(-0x11f,-0xdb,-0xd4,-0xd7)],_0x50a760(-0x47,-0x80,-0xc2,-0xdc)))return _0x2715ce;else{const _0x503b0d='{{getvar::'+_0x244640+'}}',_0x181e74=_0x5c6c4b[_0x41ffac]||'';_0x56fb90=_0x4bb190[_0x50a760(-0xfa,-0xaa,-0x67,-0x103)](_0x5ee503,_0x3fa715,_0x503b0d,_0x181e74,_0x3472cd);}}function _0x50a760(_0x1e775a,_0x18a18e,_0x3c3797,_0x30a1d9){return _0x2049(_0x18a18e- -0x1aa,_0x1e775a);}return[{'type':_0x4bb190[_0x27e3fc(0x35f,0x366,0x376,0x386)],'text':_0x4bb190[_0x27e3fc(0x3ea,0x3bf,0x3e4,0x3f4)](_0x2715ce,'')}];}export function replacePlaceholder(_0x4eb3e8,_0x5e4046,_0x192c51,_0x2f6b9c){function _0x7b1cef(_0x58297b,_0x113e04,_0x14b4f5,_0x8fa91b){return _0x2049(_0x14b4f5-0x5f,_0x8fa91b);}function _0x54e1db(_0x14ec45,_0x1bfd00,_0x3f7eb5,_0x445fc5){return _0x2049(_0x1bfd00-0x38,_0x3f7eb5);}const _0x3d50ae={'blIru':function(_0x3d721b,_0x27b019){return _0x3d721b===_0x27b019;},'uKaoN':_0x54e1db(0x1d3,0x18a,0x146,0x12f),'KUjTc':'SyTmU','saAug':function(_0x52077c,_0xd47ccb){return _0x52077c!==_0xd47ccb;},'WHBgT':_0x54e1db(0x170,0x166,0x111,0x13f),'xLKJI':_0x54e1db(0x12e,0x125,0xf2,0xf7),'EhCLS':_0x54e1db(0x169,0x11e,0x151,0x155),'WxBEq':function(_0x51c57d,_0x15a6c3,_0x46c8b4,_0x1ca214,_0x145ae2){return _0x51c57d(_0x15a6c3,_0x46c8b4,_0x1ca214,_0x145ae2);}};if(_0x3d50ae['blIru'](typeof _0x4eb3e8,_0x3d50ae[_0x54e1db(0xfa,0x109,0x114,0xd6)])){if(_0x192c51&&_0x4eb3e8[_0x54e1db(0x135,0x134,0xe0,0xfe)](_0x5e4046)){if(_0x3d50ae[_0x7b1cef(0x14f,0xe5,0x13f,0x102)](_0x3d50ae[_0x7b1cef(0x1cf,0x1bd,0x1c4,0x194)],'GRdbZ')){const _0x406ed1=_0x652ba3?function(){function _0x163822(_0x338a43,_0x48f4ea,_0x322e58,_0x50b573){return _0x7b1cef(_0x338a43-0xf4,_0x48f4ea-0x1db,_0x338a43- -0x1ae,_0x322e58);}if(_0x2a6243){const _0x1c4b93=_0x3f8717[_0x163822(-0x3d,-0x89,-0x2d,-0x5a)](_0x3e8f3a,arguments);return _0x2603cf=null,_0x1c4b93;}}:function(){};return _0x33cc6c=![],_0x406ed1;}else _0x2f6b9c&&(_0x3d50ae[_0x7b1cef(0x18e,0x168,0x1bc,0x204)](_0x3d50ae[_0x7b1cef(0x10b,0x1a4,0x15e,0x1b0)],_0x3d50ae[_0x7b1cef(0xfa,0x13b,0x126,0xce)])?_0x2f6b9c['add'](_0x5e4046):_0x5f57e1[_0x54e1db(0x17c,0x12c,0x173,0x123)+'ta']={});}return _0x4eb3e8['replaceAll'](_0x5e4046,_0x192c51||'');}if(Array['isArray'](_0x4eb3e8))return _0x4eb3e8['map'](_0x575774=>replacePlaceholder(_0x575774,_0x5e4046,_0x192c51,_0x2f6b9c));if(_0x4eb3e8&&_0x3d50ae['blIru'](typeof _0x4eb3e8,_0x3d50ae[_0x54e1db(0xcb,0xe9,0x133,0xeb)])){const _0x217236={};for(const _0x1e770f in _0x4eb3e8){_0x217236[_0x1e770f]=_0x3d50ae['WxBEq'](replacePlaceholder,_0x4eb3e8[_0x1e770f],_0x5e4046,_0x192c51,_0x2f6b9c);}return _0x217236;}return _0x4eb3e8;}export function replaceAllPlaceholders(_0x1dd02c,_0x1a75d7){const _0x3bc51c={'ulZvX':function(_0x55f01f,_0xed6c7){return _0x55f01f===_0xed6c7;},'vPVla':_0x5d92a3(-0x1d6,-0x1a0,-0x1e5,-0x1dc),'SqNUQ':function(_0x55541d,_0x27b3b0,_0x2e38c1,_0x51aad7){return _0x55541d(_0x27b3b0,_0x2e38c1,_0x51aad7);},'zGMoO':function(_0x27f5f2){return _0x27f5f2();},'mcmgj':_0x5d92a3(-0x186,-0x193,-0x150,-0x1a8),'GDSir':'hrqGq','ssgPW':_0x5d92a3(-0x1c8,-0x21b,-0x205,-0x1ec),'jEQlH':_0x16e504(0x356,0x350,0x39e,0x386),'puSSq':_0x16e504(0x40c,0x3a4,0x3df,0x3ce),'pwDha':function(_0x3c85da,_0x48e0b5,_0x21d871,_0x505a72,_0x8d1238){return _0x3c85da(_0x48e0b5,_0x21d871,_0x505a72,_0x8d1238);},'tTRGR':_0x16e504(0x3d7,0x3c2,0x3cc,0x3c6),'BGJvp':_0x5d92a3(-0x24b,-0x21a,-0x1e2,-0x208)+'}}','kUGnb':'{{通用角色启用列表'+'}}','cTsJO':function(_0x1b13da,_0x3a3643){return _0x1b13da>_0x3a3643;},'Lecwq':function(_0x370f7e,_0x18b250){return _0x370f7e===_0x18b250;},'UFAix':_0x5d92a3(-0x190,-0x18a,-0x156,-0x135),'utzYt':function(_0x214420,_0x40464b,_0xc28f5a){return _0x214420(_0x40464b,_0xc28f5a);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x1a75d7,_0x225361=new Set();let _0x4aeeac=_0x1dd02c;const _0x20f32f=_0x3bc51c[_0x5d92a3(-0x266,-0x214,-0x23f,-0x1f2)](getContext);function _0x16e504(_0x10b4e2,_0x5d1255,_0x5f1509,_0x3987ed){return _0x2049(_0x5f1509-0x290,_0x3987ed);}function _0x5d92a3(_0x17289c,_0x4506d0,_0x1b30a7,_0x44eb85){return _0x2049(_0x4506d0- -0x2f2,_0x17289c);}const _0x226f8c=_0x20f32f?.[_0x16e504(0x3b1,0x40b,0x3da,0x415)]||'';let _0x5686ba=worldBookContent;if(_0x5686ba){if(_0x3bc51c['mcmgj']!==_0x3bc51c[_0x5d92a3(-0x203,-0x21d,-0x206,-0x209)])_0x5686ba=_0x5686ba[_0x5d92a3(-0x1d8,-0x224,-0x267,-0x22b)](_0x3bc51c['ssgPW'],_0x226f8c),_0x5686ba=_0x5686ba[_0x5d92a3(-0x279,-0x224,-0x260,-0x255)](_0x5d92a3(-0x1ba,-0x1cd,-0x1f7,-0x1fc),_0x226f8c);else{if(!_0x17b7b6){const _0x13747c={..._0x27ab05};_0xd372e=_0x13747c;}else{if(_0x3bc51c[_0x5d92a3(-0x259,-0x203,-0x232,-0x259)](_0xbbb4d9[_0x16e504(0x331,0x3a2,0x389,0x38b)],_0x222e51['role']))_0x1c2115[_0x5d92a3(-0x1b3,-0x1e5,-0x227,-0x1a4)]=_0x4f15b5(_0x4a1bdc[_0x5d92a3(-0x1a7,-0x1e5,-0x1ec,-0x222)],_0x3bdfc1[_0x5d92a3(-0x1e0,-0x1e5,-0x1fb,-0x215)]);else{_0x1ce309['push'](_0x163a4e);const _0xd72f2d={..._0xcbc882};_0x569c8a=_0xd72f2d;}}}}_0x4aeeac=replacePlaceholder(_0x4aeeac,_0x3bc51c['jEQlH'],context,_0x225361),_0x4aeeac=replacePlaceholder(_0x4aeeac,_0x3bc51c[_0x5d92a3(-0x21f,-0x1d6,-0x19c,-0x18a)],_0x5686ba,_0x225361),_0x4aeeac=_0x3bc51c[_0x16e504(0x3a5,0x309,0x364,0x355)](replacePlaceholder,_0x4aeeac,'{{正文}}',body,_0x225361),_0x4aeeac=_0x3bc51c['pwDha'](replacePlaceholder,_0x4aeeac,_0x3bc51c[_0x16e504(0x344,0x387,0x371,0x395)],characterListText,_0x225361),_0x4aeeac=_0x3bc51c[_0x5d92a3(-0x20f,-0x21e,-0x1d7,-0x27a)](replacePlaceholder,_0x4aeeac,_0x3bc51c['BGJvp'],outfitEnableListText,_0x225361),_0x4aeeac=replacePlaceholder(_0x4aeeac,_0x3bc51c[_0x16e504(0x38f,0x342,0x35c,0x36d)],commonCharacterListText,_0x225361),_0x4aeeac=_0x3bc51c['pwDha'](replacePlaceholder,_0x4aeeac,_0x16e504(0x3ad,0x3ab,0x398,0x36a),userDemand,_0x225361);if(variables&&_0x3bc51c['cTsJO'](Object[_0x16e504(0x320,0x31d,0x374,0x355)](variables)[_0x5d92a3(-0x269,-0x238,-0x23e,-0x1fa)],0x1082*0x1+0x13*0x4b+0x1*-0x1613)){if(_0x3bc51c[_0x5d92a3(-0x210,-0x1e1,-0x1d2,-0x1bd)](_0x16e504(0x3d2,0x3cd,0x3d2,0x3be),_0x3bc51c[_0x16e504(0x37d,0x3e3,0x399,0x349)])){const _0x2bb4c5={'mZaqF':_0x16e504(0x3df,0x365,0x3b7,0x3c0),'PLFiu':_0x3bc51c[_0x5d92a3(-0x1c0,-0x19f,-0x174,-0x154)],'ybVzw':function(_0x165013,_0x3486f6,_0x6fc185,_0x3aba0c){function _0x96f1b1(_0x2d52ec,_0xe63557,_0x4ecdfd,_0x11cc05){return _0x16e504(_0x2d52ec-0x19,_0xe63557-0x1d4,_0x11cc05- -0x38,_0x4ecdfd);}return _0x3bc51c[_0x96f1b1(0x2d7,0x34b,0x310,0x310)](_0x165013,_0x3486f6,_0x6fc185,_0x3aba0c);}};return _0x4b8a3d[_0x16e504(0x362,0x37c,0x3b2,0x380)](_0xca89c7=>{function _0x5b3b23(_0x3ed048,_0x2c3830,_0x58f27a,_0x3564f5){return _0x5d92a3(_0x3ed048,_0x2c3830-0x3fa,_0x58f27a-0xe8,_0x3564f5-0x1c4);}function _0x2f91d2(_0xe62f90,_0x5c3b2c,_0x2f0e05,_0x343d2b){return _0x16e504(_0xe62f90-0x22,_0x5c3b2c-0x59,_0x5c3b2c-0x51,_0x343d2b);}if(_0xca89c7&&_0xca89c7[_0x5b3b23(0x21a,0x243,0x21b,0x200)]===_0x2bb4c5['mZaqF']&&typeof _0xca89c7[_0x5b3b23(0x22b,0x22f,0x24c,0x228)]===_0x2bb4c5[_0x5b3b23(0x212,0x24b,0x251,0x21e)])return{..._0xca89c7,'text':_0x2bb4c5['ybVzw'](_0x361d6e,_0xca89c7[_0x5b3b23(0x24b,0x22f,0x260,0x288)],_0x29c80a,_0x4ad518)};return _0xca89c7;});}else{const _0xd54056=/\{\{getvar::([^}]+)\}\}/g,_0x40043c=JSON[_0x5d92a3(-0x242,-0x1e8,-0x190,-0x1cf)](_0x4aeeac),_0xd4762b=[..._0x40043c[_0x5d92a3(-0x1fb,-0x1ed,-0x1fb,-0x1a6)](_0xd54056)],_0x404969=new Set();for(const _0x438d23 of _0xd4762b){_0x404969[_0x16e504(0x366,0x3bc,0x3b4,0x38f)](_0x438d23[-0x63*-0x26+0x1*-0xf8+-0xdb9]);}for(const _0x195815 of _0x404969){const _0x5626b0=_0x16e504(0x398,0x32e,0x372,0x325)+_0x195815+'}}',_0xbe3567=variables[_0x195815]||'';_0x4aeeac=_0x3bc51c[_0x16e504(0x394,0x318,0x364,0x351)](replacePlaceholder,_0x4aeeac,_0x5626b0,_0xbe3567,_0x225361);}}}_0x4aeeac=_0x3bc51c['utzYt'](processVariablePlaceholdersInMessages,_0x4aeeac,_0x225361);const _0x5c4ea4={};return _0x5c4ea4[_0x16e504(0x34d,0x3a6,0x3a3,0x3c1)]=_0x4aeeac,_0x5c4ea4['replacedVa'+_0x5d92a3(-0x209,-0x22c,-0x22d,-0x284)]=_0x225361,_0x5c4ea4;}function processVariablePlaceholdersInMessages(_0x2996a2,_0x1d0e19){const _0x2e9e2={'cBYvb':_0x559197(0x47e,0x492,0x4cd,0x468),'jeRbY':_0x5934d0(-0x3,-0x44,-0x58,-0x21),'myKRI':function(_0x3534a2,_0x512712,_0xcb2866,_0x29e4c7){return _0x3534a2(_0x512712,_0xcb2866,_0x29e4c7);},'OVHHC':function(_0x5c41fe){return _0x5c41fe();},'jUUqQ':_0x5934d0(-0x4f,-0x3f,-0x94,-0xb9)};if(!_0x2996a2||_0x2996a2['length']===0x23da+0x11d1+-0x35ab)return _0x2996a2;function _0x559197(_0x1a34ce,_0x2fa201,_0xb6fbf4,_0x5cfeb5){return _0x2049(_0x1a34ce-0x377,_0x2fa201);}function _0x5934d0(_0x375bd2,_0x1be2a2,_0x4e8240,_0xb07895){return _0x2049(_0x4e8240- -0x1a8,_0xb07895);}const _0x3380c2=_0x2e9e2[_0x5934d0(-0x68,-0x77,-0xba,-0xb3)](getContext);if(!_0x3380c2[_0x559197(0x46b,0x4ac,0x48b,0x4ac)+'ta']){if(_0x5934d0(-0xd6,-0xa6,-0x94,-0x4b)===_0x2e9e2[_0x559197(0x490,0x470,0x43e,0x466)])_0x3380c2[_0x5934d0(-0xa2,-0xc6,-0xb4,-0xe7)+'ta']={};else{const _0x53cf03=_0x5b63d0[_0x5934d0(-0x13c,-0xb8,-0xec,-0x144)](),_0x344e64=_0x3e9ba8[_0x5934d0(-0x108,-0xe9,-0xb4,-0x97)+'ta'][_0x559197(0x478,0x4a8,0x4c5,0x497)][_0x53cf03]||'';return _0x2b26cf&&_0x5a88eb[_0x5934d0(-0xd4,-0x9d,-0x84,-0x39)](_0x559197(0x4d1,0x4e0,0x4a0,0x4e8)+_0x53cf03+'@}'),_0x344e64;}}return!_0x3380c2[_0x5934d0(-0x92,-0xca,-0xb4,-0xf9)+'ta']['variables']&&(_0x3380c2[_0x559197(0x46b,0x449,0x443,0x420)+'ta'][_0x5934d0(-0x7a,-0x9a,-0xa7,-0x69)]={}),_0x2996a2[_0x559197(0x499,0x4a0,0x44d,0x490)](_0x257e99=>{function _0x566829(_0x1df810,_0x41f483,_0x1011d1,_0x196be4){return _0x559197(_0x196be4- -0x68b,_0x1df810,_0x1011d1-0x54,_0x196be4-0xc8);}function _0x4b0477(_0x25fe86,_0x5125d0,_0x3a383f,_0x52de87){return _0x559197(_0x3a383f- -0x1eb,_0x5125d0,_0x3a383f-0x5,_0x52de87-0xb9);}const _0x3e614e={'KPGvM':function(_0x52b808,_0x3822c8){return _0x52b808(_0x3822c8);}};if(_0x2e9e2[_0x4b0477(0x2a0,0x23c,0x27e,0x28f)]===_0x2e9e2[_0x566829(-0x1ec,-0x1cf,-0x240,-0x1e5)]){const _0x22ea9d=_0x3959de[_0x566829(-0x298,-0x26c,-0x280,-0x258)](),_0x2e8c10=_0x3e614e[_0x566829(-0x233,-0x235,-0x2a1,-0x24b)](_0x232167,_0x22ea9d)||'';return _0x1dc2ef&&_0x2b656e[_0x566829(-0x228,-0x234,-0x23b,-0x1f0)](_0x566829(-0x197,-0x226,-0x1ae,-0x1d5)+_0x4b0477(0x326,0x348,0x2ed,0x2e3)+_0x22ea9d+'@}'),_0x2e8c10;}else{if(!_0x257e99||!_0x257e99['content'])return _0x257e99;return{..._0x257e99,'content':_0x2e9e2['myKRI'](processContentVariables,_0x257e99[_0x4b0477(0x299,0x2a0,0x299,0x29d)],_0x3380c2,_0x1d0e19)};}});}function processContentVariables(_0x52ee10,_0x1aff85,_0x56bf2a){function _0x1812d0(_0x5f1032,_0x1ca465,_0x510398,_0x2f186b){return _0x2049(_0x510398-0x8a,_0x2f186b);}const _0x186df4={'DXgyj':function(_0x42901a,_0x3b208f){return _0x42901a===_0x3b208f;},'bgSkX':_0x96d2e6(0x11b,0xde,0xf1,0x11a),'xWjla':function(_0x44114c,_0x169353,_0xddb923,_0x5cdac4){return _0x44114c(_0x169353,_0xddb923,_0x5cdac4);},'xwiLm':function(_0x1dd0bf,_0x59040f){return _0x1dd0bf!==_0x59040f;},'SNeTo':_0x1812d0(0x206,0x22a,0x1e3,0x1bd)};function _0x96d2e6(_0xc4e77,_0xaf794,_0x5c9314,_0x2d9180){return _0x2049(_0xc4e77- -0x37,_0x5c9314);}if(_0x186df4['DXgyj'](typeof _0x52ee10,_0x186df4[_0x1812d0(0xf3,0x178,0x140,0x121)]))return _0x186df4[_0x96d2e6(0xcf,0x114,0xce,0x88)](processStringVariables,_0x52ee10,_0x1aff85,_0x56bf2a);if(Array[_0x96d2e6(0xac,0xf4,0xb4,0x96)](_0x52ee10)){if(_0x186df4[_0x96d2e6(0xe4,0x91,0x12b,0xcf)](_0x186df4['SNeTo'],_0x186df4['SNeTo'])){_0x1df111[_0x1812d0(0x173,0x183,0x169,0x134)](_0x53bb83);const _0x24d6aa={..._0x518096};_0x50db2c=_0x24d6aa;}else return _0x52ee10[_0x96d2e6(0xeb,0x119,0x11e,0x129)](_0x152e26=>{if(_0x152e26&&_0x186df4['DXgyj'](_0x152e26[_0x4dfbc1(-0x5c,-0x90,-0x2a,-0x71)],_0x4e2a14(-0x79,-0xba,-0xa4,-0x65))&&typeof _0x152e26['text']===_0x186df4[_0x4dfbc1(-0xdc,-0x102,-0xd0,-0xf6)])return{..._0x152e26,'text':_0x186df4[_0x4dfbc1(-0x88,-0x75,-0xa6,-0xa6)](processStringVariables,_0x152e26['text'],_0x1aff85,_0x56bf2a)};function _0x4e2a14(_0x4775de,_0x2024c2,_0x5cbc34,_0x7a85f5){return _0x96d2e6(_0x4775de- -0x169,_0x2024c2-0x1d0,_0x7a85f5,_0x7a85f5-0x54);}function _0x4dfbc1(_0x535a66,_0x4f8397,_0x4fe99d,_0x2456e7){return _0x1812d0(_0x535a66-0x1f0,_0x4f8397-0x1de,_0x2456e7- -0x236,_0x4fe99d);}return _0x152e26;});}return _0x52ee10;}function processStringVariables(_0x491a84,_0x16c60a,_0x50337a){const _0x8ccda2={'MroSN':function(_0x3150bf,_0x3e890a){return _0x3150bf!==_0x3e890a;},'XBGki':_0x107ac6(0xd6,0x91,0xbe,0x9c),'YZVPR':_0x107ac6(0x53,0x1c,0xab,0x5f),'yhQax':function(_0x3163c1,_0x10ab16,_0x50291e){return _0x3163c1(_0x10ab16,_0x50291e);},'JdLOe':function(_0x69bea8,_0x32051c){return _0x69bea8===_0x32051c;},'nOvnI':_0x107ac6(0xd4,0x100,0xe3,0xb2),'ghnVp':_0x107ac6(0xc5,0xa0,0x8a,0x8c),'oaiKb':function(_0x47b543,_0x2cb6e7){return _0x47b543(_0x2cb6e7);},'AeeTL':_0x107ac6(0x61,0xac,0xfd,0xba),'EMGOB':function(_0x7e9d2a,_0x119995){return _0x7e9d2a===_0x119995;},'rpBRm':_0x107ac6(0xa5,0x74,0x76,0xa4)};if(!_0x491a84)return _0x491a84;function _0x107ac6(_0x4be90f,_0x363cc2,_0x3433e0,_0x331b59){return _0x2049(_0x331b59- -0x5e,_0x363cc2);}function _0x5376a5(_0xc528d1,_0x187fe7,_0x4026d9,_0x2d99dd){return _0x2049(_0x2d99dd- -0x26e,_0x4026d9);}let _0xd75fba=_0x491a84;return _0xd75fba=_0xd75fba[_0x107ac6(0xa7,0x4a,0xd3,0x93)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x19438e,_0x239265,_0x5ba098)=>{function _0x54c32c(_0x480635,_0x13787d,_0x467ddb,_0x6df44){return _0x5376a5(_0x480635-0x3e,_0x13787d-0x95,_0x480635,_0x13787d- -0x2b);}function _0x3d5d40(_0xab67c6,_0x39a35e,_0x394d0b,_0x64194c){return _0x107ac6(_0xab67c6-0x1aa,_0x64194c,_0x394d0b-0x119,_0xab67c6-0xe6);}if(_0x8ccda2[_0x3d5d40(0x162,0x17c,0x195,0x11b)](_0x8ccda2[_0x54c32c(-0x143,-0x173,-0x154,-0x1a4)],_0x8ccda2['YZVPR'])){const _0x26d2b8=_0x239265['trim']();return _0x16c60a[_0x54c32c(-0x1f5,-0x1a5,-0x16e,-0x1a8)+'ta'][_0x3d5d40(0x189,0x1cc,0x1a1,0x17b)][_0x26d2b8]=_0x5ba098,_0x50337a&&_0x50337a[_0x54c32c(-0x17a,-0x175,-0x15d,-0x17a)](_0x3d5d40(0x163,0x194,0x163,0x179)+_0x26d2b8+'@}'),'';}else{const _0x491695={};return _0x491695[_0x3d5d40(0x1cc,0x21b,0x1da,0x1ce)+'e']=_0x58365c,_0x491695['contextDat'+'a']=_0x5aa3b8,_0x1c9092(_0x491695);}}),_0xd75fba=_0xd75fba[_0x5376a5(-0x151,-0x17d,-0x15e,-0x17d)](/\{@getvar::([^@]+)@\}/g,(_0x30bfd3,_0x197510)=>{const _0x3b0649=_0x197510[_0x40c100(0x2c9,0x2f1,0x2b6,0x25c)](),_0xb16224=_0x16c60a[_0x40c100(0x335,0x304,0x2ee,0x325)+'ta'][_0x56d84a(-0x6e,-0x8b,-0x74,-0x4c)][_0x3b0649]||'';function _0x56d84a(_0x478f70,_0x216d91,_0x49148d,_0x1edf59){return _0x107ac6(_0x478f70-0x19d,_0x216d91,_0x49148d-0x5c,_0x49148d- -0x117);}_0x50337a&&_0x50337a[_0x56d84a(-0x56,0x0,-0x51,-0x5d)](_0x56d84a(0x3f,0x31,-0x1b,-0x77)+_0x3b0649+'@}');function _0x40c100(_0x4786d1,_0x170227,_0x52e8ae,_0x5aca3f){return _0x5376a5(_0x4786d1-0x1e6,_0x170227-0x32,_0x4786d1,_0x52e8ae-0x468);}return _0xb16224;}),_0xd75fba=_0xd75fba[_0x107ac6(0xad,0x56,0xa5,0x93)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5dae9d,_0x45b9c6,_0x5c2b7a)=>{const _0x23cb9e=_0x45b9c6['trim']();_0x8ccda2[_0x4847ed(0x3dc,0x429,0x3b9,0x42d)](setglobalvar,_0x23cb9e,_0x5c2b7a);function _0x414c35(_0x21605f,_0x394854,_0x1d7746,_0x5296e6){return _0x5376a5(_0x21605f-0x12,_0x394854-0x40,_0x394854,_0x1d7746-0x352);}function _0x4847ed(_0x3bb2d4,_0x288aa9,_0x41ac68,_0x29e15b){return _0x107ac6(_0x3bb2d4-0x15f,_0x41ac68,_0x41ac68-0xda,_0x3bb2d4-0x35e);}if(_0x50337a){if(_0x8ccda2[_0x414c35(0x258,0x26b,0x239,0x206)](_0x8ccda2[_0x4847ed(0x3f6,0x415,0x3a8,0x3d5)],_0x4847ed(0x410,0x42f,0x415,0x3b4)))_0x50337a[_0x4847ed(0x424,0x3d4,0x453,0x407)](_0x4847ed(0x44b,0x43c,0x486,0x445)+'lvar::'+_0x23cb9e+'@}');else{const _0x5f79de=_0x3145e8['trim']();return _0x598f96[_0x4847ed(0x3f4,0x416,0x447,0x3cc)+'ta'][_0x4847ed(0x401,0x3e8,0x444,0x450)][_0x5f79de]=_0x519ebf,_0x2d401d&&_0x1f2ff8[_0x4847ed(0x424,0x434,0x42a,0x472)](_0x414c35(0x18a,0x195,0x1bf,0x1ef)+_0x5f79de+'@}'),'';}}return'';}),_0xd75fba=_0xd75fba[_0x107ac6(0x5f,0x3d,0x59,0x93)](/\{@getglobalvar::([^@]+)@\}/g,(_0x99bb45,_0x41e8e8)=>{function _0x2d85f9(_0x1534ce,_0x500d70,_0x16640e,_0x379738){return _0x5376a5(_0x1534ce-0x8f,_0x500d70-0x4b,_0x500d70,_0x379738-0x275);}function _0x57610b(_0x523c49,_0x5d0bf7,_0xf2a880,_0x267330){return _0x107ac6(_0x523c49-0x138,_0x523c49,_0xf2a880-0x169,_0x5d0bf7-0x425);}if(_0x8ccda2['MroSN'](_0x8ccda2[_0x2d85f9(0x16f,0xe1,0xf9,0x128)],_0x8ccda2[_0x57610b(0x4e3,0x4e8,0x4fc,0x51d)]))_0x14476c[_0x57610b(0x482,0x4bb,0x4e7,0x46f)+'ta'][_0x57610b(0x4c0,0x4c8,0x4ea,0x4e7)]={};else{const _0x27a4e5=_0x41e8e8[_0x57610b(0x4dc,0x483,0x473,0x4ac)](),_0x5d501c=_0x8ccda2['oaiKb'](getglobalvar,_0x27a4e5)||'';if(_0x50337a){if(_0x8ccda2['AeeTL']===_0x8ccda2['AeeTL'])_0x50337a[_0x2d85f9(0xd2,0x11a,0x16a,0x12b)]('{@getgloba'+_0x2d85f9(0x11f,0x131,0x126,0x168)+_0x27a4e5+'@}');else{if(_0x4cb594){const _0x5f05eb=_0x2a7738[_0x57610b(0x4b7,0x4d9,0x509,0x4e1)](_0x22cd89,arguments);return _0x1a6e16=null,_0x5f05eb;}}}return _0x5d501c;}}),_0xd75fba=_0xd75fba[_0x107ac6(0xdc,0xb0,0x3b,0x93)](/\{@getworldvar::([^@]+)@\}/g,(_0x30b0b7,_0x3b5ec0)=>{const _0xf71f48=_0x3b5ec0[_0x481d4d(-0x11a,-0xee,-0xec,-0xf0)]();function _0x481d4d(_0x45a43e,_0xd764f6,_0x3a250d,_0x37047e){return _0x107ac6(_0x45a43e-0x100,_0x37047e,_0x3a250d-0x1ae,_0x45a43e- -0x178);}const _0x20ea21=_0x8ccda2[_0x5b3056(0x1ae,0x19a,0x1e7,0x184)](getworldvar,_0xf71f48)||'';function _0x5b3056(_0x4a119c,_0x1422c0,_0x39e810,_0x267771){return _0x107ac6(_0x4a119c-0x15d,_0x4a119c,_0x39e810-0xc3,_0x1422c0-0xfb);}if(_0x50337a){if(_0x8ccda2[_0x5b3056(0x122,0x150,0x153,0x155)](_0x8ccda2['rpBRm'],_0x5b3056(0x1cd,0x19f,0x185,0x19a)))_0x50337a[_0x5b3056(0x219,0x1c1,0x1bd,0x1c6)](_0x5b3056(0x19e,0x176,0x157,0x18d)+'var::'+_0xf71f48+'@}');else{const _0x57f151={..._0x40afb9};_0x1ce3b0=_0x57f151;}}return _0x20ea21;}),_0xd75fba;}export function buildPromptWithTrigger(_0x304efc){const _0x3a42cf={'vCYdj':function(_0x4f84bb,_0x137f30){return _0x4f84bb===_0x137f30;},'FhRST':function(_0x275572){return _0x275572();},'npLAQ':function(_0x505349,_0x15ed26,_0x7dd286){return _0x505349(_0x15ed26,_0x7dd286);},'oXTxg':_0x37e35c(-0x205,-0x1e1,-0x206,-0x262),'IxvcA':_0x7e233a(0x305,0x391,0x300,0x342),'CntUj':'trigger','ftUKY':_0x37e35c(-0x1ef,-0x205,-0x201,-0x20d),'Lfqdq':function(_0x30f2b5,_0xb5f681){return _0x30f2b5!==_0xb5f681;},'XjnPb':_0x7e233a(0x2c9,0x344,0x312,0x30b),'UemAN':'NQcxF','iigXC':_0x7e233a(0x2d9,0x2e4,0x303,0x2b3),'SZlym':function(_0x14ffbd,_0xfc6d39){return _0x14ffbd!==_0xfc6d39;},'nKhDZ':_0x7e233a(0x38f,0x36f,0x3b0,0x35c),'Otmds':function(_0x228e97,_0x1e5785){return _0x228e97(_0x1e5785);}},{requestType:_0x3fc58b,contextData:_0x199da6}=_0x304efc,_0x12843b=extension_settings[extensionName]?.['llm_reques'+_0x37e35c(-0x1c9,-0x1bd,-0x1cf,-0x200)+_0x7e233a(0x2b9,0x2f2,0x2f5,0x2a9)]||{},_0x13e43c={};_0x13e43c['context_pr'+_0x37e35c(-0x168,-0x1dc,-0x1a9,-0x1d1)]='默认';const _0x3e3cc4=_0x12843b[_0x3fc58b]||_0x13e43c,_0x34b93a=_0x3e3cc4[_0x37e35c(-0x1a0,-0x1a0,-0x17d,-0x169)+_0x37e35c(-0x171,-0x1f2,-0x1a9,-0x152)]||'默认',_0x1bdaed=extension_settings[extensionName]?.[_0x37e35c(-0x12d,-0x1a9,-0x166,-0x15f)+_0x37e35c(-0x142,-0x199,-0x178,-0x12b)+'s']||{},_0xf59401=_0x1bdaed[_0x34b93a]||_0x1bdaed[Object['keys'](_0x1bdaed)[0x1*-0x161e+-0xd1*-0x2+0x147c]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x199da6,_0x4e00f1=[userDemand,context,body,worldBookContent][_0x37e35c(-0x1a3,-0x169,-0x19b,-0x1ae)](Boolean)[_0x7e233a(0x30f,0x316,0x2bd,0x2de)]('\x0a');function _0x37e35c(_0x12d77f,_0x21cbdb,_0x32893e,_0x351457){return _0x2049(_0x32893e- -0x2c6,_0x12d77f);}function _0x7e233a(_0x3f72cd,_0x36dbcd,_0x4a35cd,_0x114cd7){return _0x2049(_0x114cd7-0x1f5,_0x36dbcd);}const _0x5078d8=[];if(_0xf59401['entries']&&Array['isArray'](_0xf59401[_0x37e35c(-0x188,-0x19c,-0x180,-0x146)]))for(const _0x4386c4 of _0xf59401[_0x37e35c(-0x142,-0x1a2,-0x180,-0x1a9)]){if(_0x3a42cf[_0x7e233a(0x339,0x300,0x31e,0x325)]!==_0x3a42cf[_0x37e35c(-0x1c6,-0x195,-0x16b,-0x181)]){if(!_0x4386c4[_0x7e233a(0x2f6,0x2bf,0x31f,0x2f9)])continue;if(!_0x4386c4['content']||_0x4386c4['content'][_0x7e233a(0x2d5,0x267,0x2e4,0x2b1)]()==='')continue;if(_0x4386c4[_0x37e35c(-0x224,-0x230,-0x1fc,-0x220)+'e']===_0x3a42cf[_0x37e35c(-0x1ce,-0x20b,-0x214,-0x1cb)]){if(_0x3a42cf[_0x37e35c(-0x231,-0x1ee,-0x204,-0x1b0)]===_0x3a42cf['ftUKY']){if(!_0x3a42cf['npLAQ'](checkTriggerWords,_0x4386c4[_0x37e35c(-0x1b9,-0x214,-0x1e1,-0x225)+'ds'],_0x4e00f1)){if(_0x3a42cf[_0x7e233a(0x2ab,0x289,0x2a7,0x2b0)](_0x3a42cf[_0x7e233a(0x325,0x33a,0x290,0x2e8)],_0x3a42cf[_0x7e233a(0x35e,0x362,0x3af,0x353)]))continue;else{if(!_0x47e6e3||_0x3a42cf[_0x37e35c(-0x209,-0x1f7,-0x20f,-0x1dc)](_0xdff459[_0x7e233a(0x26c,0x2cb,0x2df,0x2af)],-0x2131+-0x237+0x2368))return _0x256d92;const _0x222f01=_0x3a42cf['FhRST'](_0x4cd9fe);return!_0x222f01[_0x7e233a(0x2f9,0x2d1,0x303,0x2e9)+'ta']&&(_0x222f01['chatMetada'+'ta']={}),!_0x222f01[_0x7e233a(0x336,0x2e2,0x30c,0x2e9)+'ta']['variables']&&(_0x222f01[_0x7e233a(0x2e0,0x325,0x318,0x2e9)+'ta'][_0x37e35c(-0x1a8,-0x1a9,-0x1c5,-0x20b)]={}),_0x116450['map'](_0x43b477=>{function _0x57b11c(_0x611d5c,_0x5abf66,_0xb543e7,_0x56a04f){return _0x7e233a(_0x611d5c-0x188,_0x611d5c,_0xb543e7-0x6,_0x5abf66-0x168);}function _0x3be965(_0x187a16,_0x4c6f12,_0x21bf47,_0x1cd471){return _0x37e35c(_0x1cd471,_0x4c6f12-0x12d,_0x4c6f12-0x38a,_0x1cd471-0x12c);}if(!_0x43b477||!_0x43b477[_0x57b11c(0x442,0x46a,0x4ab,0x421)])return _0x43b477;return{..._0x43b477,'content':_0x2c98a1(_0x43b477[_0x57b11c(0x4c5,0x46a,0x426,0x486)],_0x222f01,_0x513b4f)};});}}}else{const _0x34b7d5=_0x27c182[_0x37e35c(-0x1d2,-0x25b,-0x20a,-0x1f5)]();return _0x3a42cf[_0x7e233a(0x2b9,0x2d3,0x264,0x2bd)](_0x1f3528,_0x34b7d5,_0x4b4753),_0x47e245&&_0x5013a3[_0x7e233a(0x375,0x35e,0x336,0x319)](_0x7e233a(0x371,0x344,0x36e,0x340)+_0x37e35c(-0x11d,-0x13b,-0x165,-0x182)+_0x34b7d5+'@}'),'';}}const _0x5efb87={};_0x5efb87[_0x7e233a(0x2ed,0x2e8,0x292,0x2ee)]=_0x4386c4[_0x37e35c(-0x173,-0x1ed,-0x1cd,-0x1d6)]||_0x3a42cf[_0x7e233a(0x2d2,0x310,0x30d,0x32d)],_0x5efb87[_0x7e233a(0x344,0x308,0x304,0x302)]=_0x4386c4[_0x7e233a(0x2db,0x2aa,0x2bf,0x302)],_0x5078d8[_0x37e35c(-0x1e1,-0x207,-0x1e7,-0x1f5)](_0x5efb87);}else _0x51f900[_0x7e233a(0x2d5,0x308,0x327,0x319)](_0x3aefea);}else{if(_0xf59401[_0x37e35c(-0x1e8,-0x20c,-0x207,-0x25f)]&&Array[_0x37e35c(-0x196,-0x1f8,-0x1e3,-0x199)](_0xf59401['history']))for(const _0x561fd7 of _0xf59401[_0x7e233a(0x26d,0x295,0x2dc,0x2b4)]){if(_0x561fd7[_0x37e35c(-0x229,-0x1e4,-0x208,-0x1e8)]&&_0x3a42cf[_0x37e35c(-0x187,-0x139,-0x17a,-0x131)](_0x561fd7[_0x37e35c(-0x238,-0x218,-0x208,-0x1e1)][_0x7e233a(0x29d,0x2ec,0x2fe,0x2b1)](),'')){const _0x1d7a23={};_0x1d7a23[_0x37e35c(-0x206,-0x1e1,-0x1cd,-0x184)]=_0x7e233a(0x2d6,0x308,0x2cb,0x2b3),_0x1d7a23[_0x7e233a(0x2d4,0x2c6,0x335,0x302)]=_0x561fd7[_0x7e233a(0x277,0x29e,0x2de,0x2b3)],_0x5078d8['push'](_0x1d7a23);}if(_0x561fd7[_0x37e35c(-0x187,-0x11e,-0x15f,-0x112)]&&_0x3a42cf[_0x7e233a(0x2df,0x26b,0x2e9,0x2b0)](_0x561fd7[_0x37e35c(-0x155,-0x12a,-0x15f,-0x14d)][_0x37e35c(-0x1cd,-0x209,-0x20a,-0x25c)](),'')){const _0x3f80ad={};_0x3f80ad[_0x37e35c(-0x1f4,-0x1b3,-0x1cd,-0x218)]=_0x3a42cf['nKhDZ'],_0x3f80ad['content']=_0x561fd7[_0x7e233a(0x3ab,0x397,0x30d,0x35c)],_0x5078d8[_0x37e35c(-0x20e,-0x207,-0x1e7,-0x202)](_0x3f80ad);}}}const _0x27c9c9=_0x3a42cf[_0x7e233a(0x300,0x2de,0x349,0x332)](mergeAdjacentMessages,_0x5078d8),{messages:_0x25b752,replacedVariables:_0x397014}=replaceAllPlaceholders(_0x27c9c9,_0x199da6);return _0x25b752;}export function getProcessedPrompt(_0x1617d4,_0x449def){function _0x678ad3(_0x31b3ce,_0x5ace48,_0x4c0cb2,_0x52d5c5){return _0x2049(_0x5ace48-0x344,_0x4c0cb2);}const _0x3f1aa5={'JddqB':function(_0x47aa3e,_0x2d18a5){return _0x47aa3e(_0x2d18a5);}};function _0x5c75ba(_0x52c648,_0x4d4472,_0x3dfc11,_0x53b14a){return _0x2049(_0x52c648-0x3dc,_0x3dfc11);}const _0x299d36={};return _0x299d36[_0x5c75ba(0x520,0x56d,0x531,0x4de)+'e']=_0x1617d4,_0x299d36[_0x5c75ba(0x4fc,0x514,0x504,0x52f)+'a']=_0x449def,_0x3f1aa5['JddqB'](buildPromptWithTrigger,_0x299d36);}