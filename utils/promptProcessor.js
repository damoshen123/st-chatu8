(function(_0x4833cf,_0xfda61a){function _0x42cdde(_0x1e5f42,_0x1af9b2,_0x25f05f,_0x4aaead){return _0x5460(_0x1af9b2- -0x67,_0x1e5f42);}function _0x15f2a8(_0x13f535,_0x181ae3,_0x3bf6f1,_0x477de1){return _0x5460(_0x477de1-0x21c,_0x13f535);}const _0x5b833c=_0x4833cf();while(!![]){try{const _0x579154=parseInt(_0x42cdde(0x1c6,0x190,0x166,0x156))/(-0x12f0+0x162*0xe+-0x6b*0x1)*(-parseInt(_0x15f2a8(0x446,0x468,0x43f,0x42e))/(-0x1021+0x2*0x39e+-0x35*-0x2b))+-parseInt(_0x15f2a8(0x470,0x455,0x3fd,0x42c))/(0x1ffc+0x1*0x23e+-0x2237)+parseInt(_0x15f2a8(0x438,0x3f1,0x3b7,0x3fa))/(0x25f4+0x2268*-0x1+-0x388)*(-parseInt(_0x42cdde(0x18c,0x193,0x157,0x18b))/(-0x1*-0xf89+-0xa62+-0x12*0x49))+parseInt(_0x42cdde(0x18b,0x172,0x16a,0x1b8))/(0x1082*0x2+-0x2*-0x3bb+-0xc*0x35f)+parseInt(_0x42cdde(0x20d,0x1c0,0x1c9,0x18c))/(-0x16ef+-0x137*-0x5+-0x21*-0x83)+-parseInt(_0x42cdde(0x1ed,0x1d7,0x1bc,0x1df))/(0x7*0x3ed+-0x8eb*0x2+-0x99d)+parseInt(_0x15f2a8(0x44b,0x476,0x447,0x475))/(-0x3d1*-0x4+0x8ee+-0x1829);if(_0x579154===_0xfda61a)break;else _0x5b833c['push'](_0x5b833c['shift']());}catch(_0x19039f){_0x5b833c['push'](_0x5b833c['shift']());}}}(_0x5caf,-0xbe0c5+-0x3*-0x23d48+0xd5278));const _0x5d520a=(function(){const _0xbec4bb={};function _0x5f22e1(_0x4de60f,_0x5b0ada,_0x2599bc,_0x46fe1c){return _0x5460(_0x46fe1c- -0x36,_0x4de60f);}_0xbec4bb[_0x38d06b(-0x1f,-0x17,0x1a,-0x2d)]=_0x38d06b(0x40,-0x1,0x16,0x30);const _0x41859a=_0xbec4bb;let _0x2c639f=!![];function _0x38d06b(_0x1b6220,_0xf6313,_0x19edcb,_0x3290bd){return _0x5460(_0xf6313- -0x20a,_0x1b6220);}return function(_0x396df4,_0x27e9cf){const _0x469d2e={};_0x469d2e[_0x8fc55c(0xe2,0xd7,0x11d,0x10f)]=function(_0x5a170a,_0x43537e){return _0x5a170a===_0x43537e;},_0x469d2e[_0x8fc55c(0x11d,0xd8,0xff,0xdf)]=_0x41859a[_0x2937ce(0x55c,0x51b,0x51a,0x568)];const _0x18e2c0=_0x469d2e,_0x401a80=_0x2c639f?function(){function _0x21b615(_0x2b4a6c,_0x35ac27,_0xea2856,_0x3d97a1){return _0x2937ce(_0xea2856- -0x2db,_0x35ac27-0x10b,_0x3d97a1,_0x3d97a1-0xce);}function _0x585878(_0x1f5467,_0x503cc7,_0xe6e4d1,_0x1389cf){return _0x8fc55c(_0x503cc7-0xa3,_0x503cc7-0xa6,_0x1389cf,_0x1389cf-0x1cd);}if(_0x27e9cf){if(_0x18e2c0[_0x21b615(0x243,0x2d9,0x290,0x27a)](_0x18e2c0['nIDeo'],_0x585878(0x162,0x18c,0x1ab,0x187))){const _0x235dc2=_0x27e9cf['apply'](_0x396df4,arguments);return _0x27e9cf=null,_0x235dc2;}else return!![];}}:function(){};function _0x2937ce(_0x5cd130,_0x237469,_0x456587,_0x3de019){return _0x5f22e1(_0x456587,_0x237469-0x1ce,_0x456587-0x2c,_0x5cd130-0x39f);}_0x2c639f=![];function _0x8fc55c(_0xcd5b1a,_0x495fe4,_0x33cf83,_0x558f6e){return _0x5f22e1(_0x33cf83,_0x495fe4-0xc5,_0x33cf83-0x1a3,_0xcd5b1a- -0xea);}return _0x401a80;};}()),_0xb2e081=_0x5d520a(this,function(){const _0x2ea0a8={};function _0x85d8fe(_0x56adb7,_0x216c5e,_0x2ee6b1,_0x204e2b){return _0x5460(_0x216c5e-0x2e2,_0x2ee6b1);}_0x2ea0a8['QPBVt']=_0xc2006e(0x2d3,0x2ee,0x2af,0x311)+'+$';const _0x50f32c=_0x2ea0a8;function _0xc2006e(_0x308cef,_0x4aad3f,_0x34acff,_0x3a09d9){return _0x5460(_0x308cef-0xec,_0x3a09d9);}return _0xb2e081[_0xc2006e(0x300,0x2e5,0x2bf,0x2ea)]()['search'](_0x50f32c[_0xc2006e(0x33f,0x351,0x367,0x331)])[_0x85d8fe(0x4e7,0x4f6,0x504,0x4c5)]()['constructo'+'r'](_0xb2e081)[_0xc2006e(0x2db,0x307,0x316,0x2ad)](_0x50f32c['QPBVt']);});_0xb2e081();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x300de0,_0x594e8e){const _0x590a98={'nXzRt':function(_0x227772,_0x52e075,_0x4fa3e8,_0x1512c3){return _0x227772(_0x52e075,_0x4fa3e8,_0x1512c3);},'tBIBO':function(_0xfbbbda,_0x2e6c2d){return _0xfbbbda||_0x2e6c2d;},'BKIeM':_0x46ef43(-0x1cb,-0x148,-0x192,-0x1d7),'sDscm':'osGvj','bLZxi':function(_0x5864be,_0x1c3dff){return _0x5864be===_0x1c3dff;},'sTJva':function(_0x4c503e,_0x3fd7d8){return _0x4c503e!==_0x3fd7d8;},'IGlbx':'FsfDc','QztRO':function(_0x4c84e6,_0x62565a){return _0x4c84e6===_0x62565a;},'dZxvM':_0x46ef43(-0x124,-0xe4,-0x121,-0xef)};if(_0x590a98[_0x100466(0x1e5,0x1bc,0x16d,0x173)](!_0x300de0,!_0x594e8e))return _0x590a98['BKIeM']!==_0x590a98[_0x46ef43(-0x157,-0x142,-0x186,-0x1ab)]?![]:{..._0x412d23,'text':_0x590a98[_0x46ef43(-0x155,-0x141,-0x145,-0x118)](_0x5e8997,_0x5a5b87[_0x46ef43(-0x185,-0x172,-0x18e,-0x197)],_0x47a50b,_0x3016c0)};const _0x370cce=_0x300de0['split'](',')[_0x46ef43(-0x141,-0x19b,-0x17e,-0x173)](_0xc00f5a=>_0xc00f5a[_0x100466(0x127,0x16d,0x14e,0x136)]())[_0x100466(0x20a,0x1fe,0x1e4,0x1f4)](_0x143e00=>_0x143e00);if(_0x590a98[_0x100466(0x1d1,0x196,0x15d,0x15a)](_0x370cce['length'],0x166f+-0x1410+-0x25f))return _0x590a98[_0x100466(0x18a,0x1a8,0x183,0x159)](_0x590a98[_0x46ef43(-0x118,-0x167,-0x128,-0x10c)],_0x590a98[_0x100466(0x232,0x204,0x21d,0x246)])?![]:![];function _0x46ef43(_0x1146f2,_0x26e777,_0x385023,_0x246cda){return _0x5460(_0x385023- -0x38b,_0x1146f2);}for(const _0x21d377 of _0x370cce){if(_0x590a98[_0x46ef43(-0xfd,-0x14b,-0x13e,-0x139)](_0x590a98[_0x100466(0x164,0x17b,0x189,0x1b7)],_0x590a98[_0x46ef43(-0x174,-0x161,-0x1b1,-0x1a0)])){if(_0x594e8e[_0x100466(0x1d1,0x1f6,0x229,0x1da)](_0x21d377))return!![];}else _0x46a6ae[_0x46ef43(-0x11f,-0x14d,-0x142,-0x15b)+'ta'][_0x46ef43(-0x179,-0x1ae,-0x1bc,-0x20d)]={};}function _0x100466(_0x3c5600,_0x1dff20,_0x423d2f,_0x56e836){return _0x5460(_0x1dff20- -0x5f,_0x56e836);}return![];}function _0x5caf(){const _0x49bd53=['qw5IALO','t2nyCKG','DM1IC0e','suDSyNG','qLL5tw0','DhLWzq','uMP0u1q','E0bZzxrNBg9Iyq','rLPtB1C','zNDZyMO','zhnVCwe','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','E3VKUiRKUiVMLOD9Fq','BhzHCJO6','BuTovwq','DhjPBq','z2XkzKW','AwLgwxy','DMfYAwfIBgvZ','uvLvwee','B2z2vLO','BgXgC0G','s0ffCNO','BMfTzte','u2zhD0i','B0jzDxK','vNrlwvK','yw5dBNO','mJi4mtCWneD6uu5hwq','zfP4DK0','AxnbCNjHEq','BgvUz3rO','zMXXwMK','mZi2mJG0svDrDgzl','D0TxvwO','wxvbuge','y29UDgv4DerHDa','BgXTx3jLCxvLCW','B2zPBgu','E3T1C2vYFx0','yxnZAxn0yw50','rMjyrge','kcGOlISPkYKRkq','vLjmBLm','wLvduha','zw5HyMXLza','tLDTvxe','E3VKUjBNLyZKUABOP6BLJ5f9Fq','rxLKrhy','zuD6A1C','C2vHCMnO','CMvWBgfJzq','EwXVAMW','BvvWq00','rhfsCwe','A2v5CW','yKXAEgK','AMHvzKq','ntmWmti1tg1Ayu9z','y29UDgvUDa','rgDxAK8','mtbnAwPTCgi','BwvZC2fNzxm','qMXPt0i','Dgv4Da','sNntChy','CMvWBgfJzufSBa','wuL6Cfm','AM9PBG','y2rlDhC','wu93Beu','su1eCeK','C0rZy20','sNLMz2O','C1rkDMe','ChvZAa','uwP6quG','E0bNzxr2yxi6oG','EgP2swe','zw50CMLLCW','BwfW','shr4D1m','E3VNLkJMIlFPNidMSyj9Fq','mteXmZi0mfbrAePfrq','ywD5uuu','mLH4vwvYqq','q3r0thm','Dg9tDhjPBMC','wfnAvvy','tLHNqw4','qNfRq1O','BxHVzeS','zLLzA3u','CvL5zKK','DejjqK8','E0bZzxr2yxi6oG','wxDgwwe','z2Xfy3G','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','AKXJtuu','weDYC1i','rffrB0W','rwrWD0O','q0fkAeq','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','BgnTu3C','nJi0nJa1oe1qsNHVtG','Bwf0y2HbBgW','DLP3rwK','r3HJvwW','Egjnueu','tNnJzeu','CMHuD1a','E0bNzxrNBg9Iyq','CLflDxm','yMnLzxm','DgvZDf9JB250zq','C1zZDuC','s3PyBNK','CM9Szq','y2DztgC','sKDNDKK','yxbWBhK','we1Zr28','Aufkr0G','qKzAAfi','vxLwDKy','uvHqBgG','BKLezw8','nZaZndq4mhP1t0rnCq','DMfYoJO','DxnLCG','CMvXDwvZDfr5Ca','E3TNzxr2yxi6oG','AgLZDg9YEq','ELjdq0y','reTKzxa','BLH6uNq','phvZzxi+','qvfzq2S','y2HHDe1LDgfKyq','rKflDM0','zMLNCW','u2LpDwC','uxP0uK8','C3rYAw5N','uenMDgu','DhjPz2DLCK1Vza','qMHzAei','DfD6tLa','uvbcvNq','CKvNzu4','Aw5JBhvKzxm','uxzArfe','ywrK','y3DAD3m','mta4ntqWmtHgufHZDLe','wvrpz0G','wg5kCLe','CMLHyMXLCW','zMLSDgvY','BhHQtKC','E0bNzxr3B3jSza'];_0x5caf=function(){return _0x49bd53;};return _0x5caf();}export function mergeAdjacentMessages(_0x5407aa){const _0xec2ba5={'YuAPa':function(_0x575374,_0x42d9dc){return _0x575374===_0x42d9dc;},'glJfL':function(_0x2b17ef,_0x1b67ec){return _0x2b17ef!==_0x1b67ec;},'XGrsR':_0x5bad1c(0x186,0x160,0x16c,0x125),'BFZhR':function(_0xc1bec5,_0x2d6832,_0x4ff8f9){return _0xc1bec5(_0x2d6832,_0x4ff8f9);},'NXgAn':_0x2362ee(0x4fe,0x52a,0x4f5,0x4f5)};function _0x5bad1c(_0xb6816,_0x5d2975,_0x6e02e3,_0x1bf6d4){return _0x5460(_0x6e02e3- -0x98,_0xb6816);}if(!_0x5407aa||_0xec2ba5[_0x2362ee(0x4b0,0x4d6,0x4d9,0x51c)](_0x5407aa['length'],-0x1b*-0x8e+-0x1e0c+-0x283*-0x6))return[];const _0x5648cb=[];let _0xa9fb56=null;for(const _0x4fab51 of _0x5407aa){if(_0xec2ba5[_0x5bad1c(0x16c,0x122,0x135,0x156)](_0xec2ba5[_0x2362ee(0x4d0,0x556,0x51a,0x504)],_0xec2ba5[_0x5bad1c(0x19f,0x1cc,0x189,0x150)])){const _0xdfc9b9=_0x4235b5[_0x2362ee(0x574,0x53d,0x530,0x508)](_0x39473,arguments);return _0x1a8d89=null,_0xdfc9b9;}else{if(!_0xa9fb56){const _0x327da3={..._0x4fab51};_0xa9fb56=_0x327da3;}else{if(_0xa9fb56[_0x2362ee(0x505,0x4ed,0x52d,0x55c)]===_0x4fab51['role'])_0xa9fb56['content']=_0xec2ba5[_0x2362ee(0x520,0x528,0x533,0x57c)](mergeContent,_0xa9fb56['content'],_0x4fab51[_0x2362ee(0x4fb,0x4c8,0x4f1,0x4d3)]);else{if(_0xec2ba5[_0x2362ee(0x4a3,0x4bb,0x4d9,0x4ec)](_0x5bad1c(0x187,0x1cd,0x1d1,0x199),_0xec2ba5[_0x5bad1c(0x185,0x174,0x17e,0x132)]))return![];else{_0x5648cb[_0x2362ee(0x4e3,0x4f3,0x501,0x52b)](_0xa9fb56);const _0x2e8e60={..._0x4fab51};_0xa9fb56=_0x2e8e60;}}}}}_0xa9fb56&&_0x5648cb[_0x5bad1c(0x18e,0x14e,0x170,0x146)](_0xa9fb56);function _0x2362ee(_0x1c938d,_0x245c82,_0x1ec263,_0x345f04){return _0x5460(_0x1ec263-0x2f9,_0x1c938d);}return _0x5648cb;}function mergeContent(_0x3ed7ce,_0x1c0f10){const _0x2e23c2={'flqZi':function(_0x577301,_0x462c61){return _0x577301===_0x462c61;},'XMsGo':_0x574483(0x58d,0x58d,0x594,0x5e0),'QYUXA':function(_0x306dae,_0x35c25a){return _0x306dae+_0x35c25a;},'OcgLm':function(_0xd51a66,_0x3da275){return _0xd51a66+_0x3da275;},'xjvIa':function(_0x55cf9e,_0x5e3312){return _0x55cf9e(_0x5e3312);},'mUpCM':function(_0x5d9612,_0xa683ab){return _0x5d9612(_0xa683ab);},'uNOng':_0x574483(0x53c,0x583,0x543,0x595)};if(_0x2e23c2[_0x574483(0x4e6,0x530,0x523,0x528)](typeof _0x3ed7ce,_0x2e23c2[_0x53e9c8(0x522,0x550,0x523,0x57e)])&&_0x2e23c2['flqZi'](typeof _0x1c0f10,_0x2e23c2[_0x53e9c8(0x595,0x550,0x59b,0x591)]))return _0x2e23c2[_0x574483(0x4fd,0x513,0x516,0x52b)](_0x2e23c2['OcgLm'](_0x3ed7ce,'\x0a'),_0x1c0f10);const _0x5e70d6=_0x2e23c2[_0x574483(0x589,0x519,0x551,0x51e)](normalizeToArray,_0x3ed7ce),_0x47d289=_0x2e23c2[_0x53e9c8(0x4bc,0x50a,0x4e0,0x535)](normalizeToArray,_0x1c0f10),_0x5f3003={};function _0x574483(_0x502fe2,_0x164641,_0xea31d7,_0x2428b1){return _0x5460(_0xea31d7-0x346,_0x502fe2);}_0x5f3003[_0x53e9c8(0x565,0x57d,0x57b,0x5ca)]=_0x2e23c2['uNOng'];function _0x53e9c8(_0x786a47,_0x59773f,_0x5c74c2,_0x5357a0){return _0x5460(_0x59773f-0x318,_0x786a47);}return _0x5f3003[_0x53e9c8(0x527,0x515,0x4d8,0x505)]='\x0a',[..._0x5e70d6,_0x5f3003,..._0x47d289];}function normalizeToArray(_0x5ce767){const _0x1c396a={};_0x1c396a[_0x186c71(-0x13c,-0x131,-0x15b,-0x136)]=function(_0x40b8aa,_0x3493b8){return _0x40b8aa===_0x3493b8;};function _0x186c71(_0x245bb2,_0xe3d9dc,_0x5183fa,_0x4c9f95){return _0x5460(_0x245bb2- -0x381,_0x5183fa);}_0x1c396a['eGzkW']='vwkrc',_0x1c396a[_0x186c71(-0x16e,-0x11e,-0x1a8,-0x19c)]=_0x16edc3(0x415,0x3c8,0x3d5,0x3af),_0x1c396a['krvNy']=_0x186c71(-0x184,-0x13c,-0x1c3,-0x1b1);function _0x16edc3(_0x4a725d,_0x55b4de,_0x3b00a3,_0x7ccff6){return _0x5460(_0x3b00a3-0x1a6,_0x4a725d);}const _0xd7e5b6=_0x1c396a;if(Array[_0x16edc3(0x3be,0x375,0x381,0x3c0)](_0x5ce767))return _0xd7e5b6[_0x16edc3(0x42e,0x3d3,0x3eb,0x3f6)](_0xd7e5b6[_0x186c71(-0x193,-0x199,-0x1e3,-0x1ac)],_0xd7e5b6[_0x186c71(-0x16e,-0x19d,-0x135,-0x157)])?_0x58f482[_0x16edc3(0x3fc,0x3a9,0x3b3,0x391)](_0x51ce6c=>_0x3d922d(_0x51ce6c,_0x448620,_0x592a81,_0x494c19)):_0x5ce767;const _0x35ed66={};return _0x35ed66[_0x186c71(-0x11c,-0xd9,-0xdb,-0x14e)]=_0xd7e5b6['krvNy'],_0x35ed66['text']=_0x5ce767||'',[_0x35ed66];}export function replacePlaceholder(_0x3bc775,_0x55e90d,_0x1615ab,_0x2594ee){function _0x298296(_0x5d42bb,_0x4644c7,_0x1cfd09,_0x2b555e){return _0x5460(_0x4644c7-0x331,_0x5d42bb);}const _0x50b26e={'NUwjB':function(_0x445bca,_0x23badd,_0x4675fa,_0x35dffa){return _0x445bca(_0x23badd,_0x4675fa,_0x35dffa);},'KUowV':function(_0x4aa45b,_0x9b486b){return _0x4aa45b+_0x9b486b;},'XnJrQ':function(_0x4286b6,_0xe1c22){return _0x4286b6===_0xe1c22;},'KAErz':_0x3983a3(0x4b7,0x48a,0x4d9,0x4b2),'VtKYY':'srzOJ','ahTCr':_0x3983a3(0x44d,0x451,0x440,0x450),'EydDv':function(_0x246feb,_0x10658f){return _0x246feb||_0x10658f;},'PCfte':function(_0x3437c7,_0x45c3e9){return _0x3437c7!==_0x45c3e9;},'Hudaf':'SpsRL','AnbjZ':'object','SiOug':_0x298296(0x5a6,0x599,0x554,0x5ae),'BQaBJ':function(_0x464e4d,_0x17eb4f,_0x5ec569,_0x374f0d,_0x4c80e5){return _0x464e4d(_0x17eb4f,_0x5ec569,_0x374f0d,_0x4c80e5);}};if(_0x50b26e[_0x298296(0x5d0,0x58c,0x5b0,0x59a)](typeof _0x3bc775,_0x50b26e[_0x298296(0x541,0x504,0x4fa,0x517)])){if(_0x1615ab&&_0x3bc775[_0x298296(0x5b2,0x586,0x53a,0x568)](_0x55e90d)){if(_0x2594ee){if(_0x50b26e[_0x3983a3(0x45f,0x413,0x3f9,0x422)]===_0x50b26e['ahTCr']){if(!_0x5d7ef7||!_0x6697d6[_0x3983a3(0x46b,0x434,0x3ec,0x3ef)])return _0x209852;return{..._0x2a2222,'content':_0x50b26e['NUwjB'](_0x3f05e7,_0x278c7d[_0x3983a3(0x429,0x434,0x456,0x476)],_0x2d3127,_0x2a65d5)};}else _0x2594ee['add'](_0x55e90d);}}return _0x3bc775['replaceAll'](_0x55e90d,_0x50b26e[_0x298296(0x51e,0x51e,0x4f4,0x4e9)](_0x1615ab,''));}if(Array[_0x298296(0x515,0x50c,0x504,0x4d4)](_0x3bc775))return _0x50b26e[_0x3983a3(0x4c2,0x48b,0x497,0x4a2)](_0x50b26e['Hudaf'],_0x3983a3(0x49f,0x45a,0x4a1,0x486))?_0x3bc775['map'](_0x156c8c=>replacePlaceholder(_0x156c8c,_0x55e90d,_0x1615ab,_0x2594ee)):_0x50b26e['KUowV'](_0x1b2b61,'\x0a')+_0x41d684;if(_0x3bc775&&_0x50b26e[_0x3983a3(0x4da,0x497,0x4a0,0x4b5)](typeof _0x3bc775,_0x50b26e[_0x3983a3(0x4b3,0x49c,0x48f,0x45f)])){if(_0x50b26e[_0x298296(0x5c6,0x57d,0x56f,0x58d)]!==_0x3983a3(0x4e0,0x4a4,0x476,0x4d1))return _0x18073f;else{const _0x59c5d4={};for(const _0x151d7a in _0x3bc775){_0x59c5d4[_0x151d7a]=_0x50b26e['BQaBJ'](replacePlaceholder,_0x3bc775[_0x151d7a],_0x55e90d,_0x1615ab,_0x2594ee);}return _0x59c5d4;}}function _0x3983a3(_0xdf386b,_0x4e95e2,_0x2c791c,_0x115648){return _0x5460(_0x4e95e2-0x23c,_0x2c791c);}return _0x3bc775;}export function replaceAllPlaceholders(_0x4485d7,_0x512204){const _0x312dd7={'zujcJ':function(_0x2618c8,_0x397ab5){return _0x2618c8===_0x397ab5;},'CAJhD':_0x3fdb43(0x5c4,0x5c8,0x5a4,0x5a1),'DQQoL':function(_0x451be1,_0x55866b){return _0x451be1+_0x55866b;},'yahfo':function(_0x213f12,_0x1e5ca9){return _0x213f12(_0x1e5ca9);},'GxcUl':function(_0x16c974,_0x375021){return _0x16c974(_0x375021);},'hNmnv':_0x469d8c(-0x185,-0x13b,-0x160,-0x146),'BxZHX':_0x3fdb43(0x5b8,0x5e6,0x5ff,0x5f5),'QLCNW':_0x469d8c(-0x1ad,-0x1af,-0x1a9,-0x1a1),'QvZDQ':function(_0x50c492,_0x1d50cc,_0x207f2e,_0xbc0a67,_0x2ba04c){return _0x50c492(_0x1d50cc,_0x207f2e,_0xbc0a67,_0x2ba04c);},'iiFYv':'{{正文}}','BhYhB':_0x469d8c(-0x194,-0x124,-0x129,-0x168),'FAKvm':function(_0x3ca3aa,_0x408ee0,_0x1f1756,_0x5daed3,_0x10f347){return _0x3ca3aa(_0x408ee0,_0x1f1756,_0x5daed3,_0x10f347);},'PtWyo':_0x469d8c(-0x145,-0x148,-0xe1,-0x122)+'}}','YIzpS':_0x469d8c(-0x184,-0x1a0,-0x121,-0x16e)+'}}','qYyfI':_0x469d8c(-0x1cd,-0x16d,-0x144,-0x17e),'cgYLg':function(_0x60afc7,_0x1ec2d5){return _0x60afc7>_0x1ec2d5;},'ofvVZ':function(_0x237bb2,_0x447f1c){return _0x237bb2!==_0x447f1c;},'rhTwP':_0x3fdb43(0x600,0x5ce,0x5f1,0x580),'xfQzf':function(_0x3a7460,_0x20a045,_0x540339,_0x31a004,_0x44dc34){return _0x3a7460(_0x20a045,_0x540339,_0x31a004,_0x44dc34);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x512204,_0x19e506=new Set();let _0x21ed3e=_0x4485d7;const _0x5e02a4=getContext(),_0x58095e=_0x5e02a4?.[_0x3fdb43(0x55f,0x54e,0x50e,0x531)]||'';let _0x5be25d=worldBookContent;_0x5be25d&&(_0x5be25d=_0x5be25d['replaceAll'](_0x469d8c(-0x1bc,-0x1ef,-0x1e2,-0x1a9),_0x58095e),_0x5be25d=_0x5be25d['replaceAll'](_0x312dd7['hNmnv'],_0x58095e));function _0x469d8c(_0x28475e,_0x5704d6,_0x53cbfe,_0x338558){return _0x5460(_0x338558- -0x38d,_0x5704d6);}function _0x3fdb43(_0xba06a2,_0x5eec5e,_0x2fd075,_0x2c0e45){return _0x5460(_0x5eec5e-0x37a,_0x2fd075);}_0x21ed3e=replacePlaceholder(_0x21ed3e,_0x312dd7['BxZHX'],context,_0x19e506),_0x21ed3e=replacePlaceholder(_0x21ed3e,_0x312dd7['QLCNW'],_0x5be25d,_0x19e506),_0x21ed3e=_0x312dd7[_0x469d8c(-0x166,-0x11d,-0x14c,-0x137)](replacePlaceholder,_0x21ed3e,_0x312dd7[_0x469d8c(-0x198,-0x16e,-0x18f,-0x1bf)],body,_0x19e506),_0x21ed3e=_0x312dd7[_0x3fdb43(0x5d1,0x5d0,0x5e5,0x5c6)](replacePlaceholder,_0x21ed3e,_0x312dd7[_0x469d8c(-0x113,-0x13e,-0x163,-0x13c)],characterListText,_0x19e506),_0x21ed3e=_0x312dd7[_0x469d8c(-0x120,-0x192,-0x17d,-0x143)](replacePlaceholder,_0x21ed3e,_0x312dd7['PtWyo'],outfitEnableListText,_0x19e506),_0x21ed3e=replacePlaceholder(_0x21ed3e,_0x312dd7[_0x469d8c(-0x17c,-0x1d1,-0x1d4,-0x18d)],commonCharacterListText,_0x19e506),_0x21ed3e=replacePlaceholder(_0x21ed3e,_0x312dd7[_0x469d8c(-0x137,-0x18b,-0x19a,-0x173)],userDemand,_0x19e506);if(variables&&_0x312dd7[_0x469d8c(-0x19e,-0x189,-0x135,-0x158)](Object[_0x3fdb43(0x534,0x56e,0x53f,0x5c0)](variables)['length'],-0xa6e+0x2b5*-0xd+0xe5*0x33)){const _0x330013=/\{\{getvar::([^}]+)\}\}/g,_0x5891bc=JSON['stringify'](_0x21ed3e),_0x4f80ce=[..._0x5891bc[_0x3fdb43(0x560,0x5a2,0x5ce,0x5b9)](_0x330013)],_0x2a2dab=new Set();for(const _0x501c21 of _0x4f80ce){_0x2a2dab['add'](_0x501c21[-0x2*0xe00+-0x13+0x257*0xc]);}for(const _0xa3966e of _0x2a2dab){if(_0x312dd7[_0x469d8c(-0x17b,-0x1e5,-0x16c,-0x1bc)](_0x312dd7['rhTwP'],_0x312dd7[_0x3fdb43(0x59b,0x5a7,0x5da,0x55f)])){if(_0x312dd7['zujcJ'](typeof _0x170bcb,_0x312dd7[_0x469d8c(-0x144,-0x18d,-0x182,-0x169)])&&typeof _0x4ba9ad===_0x312dd7[_0x469d8c(-0x196,-0x198,-0x1b6,-0x169)])return _0x312dd7[_0x469d8c(-0x1af,-0x131,-0x17b,-0x16b)](_0x312dd7['DQQoL'](_0xe93115,'\x0a'),_0x388dc1);const _0x47a4bf=_0x312dd7['yahfo'](_0x14987a,_0x9f4ccc),_0x5f50e8=_0x312dd7[_0x3fdb43(0x5db,0x5a4,0x560,0x5a6)](_0x23db6a,_0x190084),_0x2b1397={};return _0x2b1397[_0x3fdb43(0x5ef,0x5df,0x5d6,0x5da)]=_0x3fdb43(0x52c,0x577,0x568,0x537),_0x2b1397[_0x469d8c(-0x1c5,-0x198,-0x160,-0x190)]='\x0a',[..._0x47a4bf,_0x2b1397,..._0x5f50e8];}else{const _0x32b0bd=_0x3fdb43(0x56c,0x5bc,0x570,0x584)+_0xa3966e+'}}',_0x21c270=variables[_0xa3966e]||'';_0x21ed3e=_0x312dd7['xfQzf'](replacePlaceholder,_0x21ed3e,_0x32b0bd,_0x21c270,_0x19e506);}}}_0x21ed3e=processVariablePlaceholdersInMessages(_0x21ed3e,_0x19e506);const _0x445cd8={};return _0x445cd8[_0x3fdb43(0x56d,0x575,0x5c0,0x524)]=_0x21ed3e,_0x445cd8['replacedVa'+_0x469d8c(-0xe0,-0x140,-0x160,-0x131)]=_0x19e506,_0x445cd8;}function processVariablePlaceholdersInMessages(_0x1a56f2,_0x57c4cf){function _0xa12dae(_0x2daac8,_0x5c6dcc,_0x5b5950,_0x5c058c){return _0x5460(_0x5c6dcc-0x78,_0x2daac8);}const _0x3c95c9={'gabpX':function(_0xb22c76,_0x536895){return _0xb22c76===_0x536895;},'pquXn':_0xa12dae(0x223,0x275,0x243,0x290),'Jyfgj':function(_0x1bd546,_0x16e647){return _0x1bd546===_0x16e647;},'YTOgH':'DZGvb','PfFPe':function(_0x3370fc,_0x6bc7d,_0xf393a9,_0x32676f){return _0x3370fc(_0x6bc7d,_0xf393a9,_0x32676f);},'fYYku':function(_0x31b161){return _0x31b161();},'llFsH':_0x52dc1f(0x19,0x1c,0x55,-0x27),'sVsuG':function(_0x4c3b31,_0x6820d2){return _0x4c3b31===_0x6820d2;},'EdpwJ':_0x52dc1f(-0x3a,0x2,-0x11,-0x6),'bcees':_0xa12dae(0x2c1,0x2de,0x2cb,0x2e1)};if(!_0x1a56f2||_0x3c95c9['gabpX'](_0x1a56f2[_0xa12dae(0x2a0,0x254,0x265,0x28a)],0xdd1+-0x19da+0xc09))return _0x1a56f2;function _0x52dc1f(_0x4a232a,_0x1fbff7,_0x3753f8,_0x445a4b){return _0x5460(_0x4a232a- -0x24b,_0x3753f8);}const _0x5560e6=_0x3c95c9[_0x52dc1f(-0x32,-0x2d,0x17,-0x6a)](getContext);if(!_0x5560e6['chatMetada'+'ta']){if(_0x3c95c9[_0x52dc1f(-0x79,-0x8c,-0x9b,-0x9e)]!==_0xa12dae(0x32e,0x2dc,0x2d0,0x2de)){const _0x5180fe=_0x450301[_0x52dc1f(-0x7f,-0x86,-0xb3,-0x35)]();return _0x5b648a(_0x5180fe,_0x6500d),_0x354585&&_0x44abe5[_0xa12dae(0x2bb,0x2cf,0x290,0x2d6)](_0xa12dae(0x2c2,0x2df,0x2ac,0x2b7)+_0xa12dae(0x2b5,0x2e5,0x2ca,0x2e8)+_0x5180fe+'@}'),'';}else _0x5560e6['chatMetada'+'ta']={};}if(!_0x5560e6[_0x52dc1f(-0x2,-0xc,-0xc,-0x15)+'ta'][_0xa12dae(0x204,0x247,0x202,0x215)]){if(_0x3c95c9[_0x52dc1f(-0x19,-0x40,0x1b,0x2)](_0x3c95c9[_0x52dc1f(-0x28,-0x1d,0x0,-0x62)],_0x3c95c9[_0xa12dae(0x2b8,0x2a8,0x2dc,0x2ef)]))return _0x3622ef[_0x52dc1f(-0x3e,-0x8e,-0x8,-0x3b)](_0x434c38=>{function _0x2d5df2(_0x78f217,_0x4059a0,_0x4e029f,_0x28d7b7){return _0xa12dae(_0x4059a0,_0x4e029f- -0xa3,_0x4e029f-0x64,_0x28d7b7-0x1d5);}function _0x8f3198(_0x3f0b02,_0x42a406,_0x4d5494,_0x5620f2){return _0xa12dae(_0x4d5494,_0x42a406-0x2a5,_0x4d5494-0x105,_0x5620f2-0x11f);}if(_0x434c38&&_0x3c95c9['gabpX'](_0x434c38['type'],_0x3c95c9['pquXn'])&&typeof _0x434c38[_0x8f3198(0x520,0x51a,0x533,0x561)]==='string')return{..._0x434c38,'text':_0x3e4123(_0x434c38[_0x8f3198(0x4d9,0x51a,0x562,0x4f3)],_0x54c9b7,_0x57e275)};return _0x434c38;});else _0x5560e6[_0xa12dae(0x271,0x2c1,0x2c0,0x2e8)+'ta'][_0xa12dae(0x282,0x247,0x22c,0x24c)]={};}return _0x1a56f2[_0xa12dae(0x251,0x285,0x2b4,0x23b)](_0xecda0e=>{function _0x3e3cf9(_0x1035ae,_0x3c973d,_0x2c06e7,_0x202e44){return _0x52dc1f(_0x3c973d- -0x145,_0x3c973d-0x77,_0x202e44,_0x202e44-0x5d);}function _0x2d1722(_0xf44c00,_0x4cfd,_0x3ab250,_0x1007fa){return _0xa12dae(_0xf44c00,_0x4cfd-0x77,_0x3ab250-0x2c,_0x1007fa-0xd1);}if(_0x3c95c9[_0x2d1722(0x2e1,0x2f5,0x2fc,0x323)](_0x3c95c9[_0x2d1722(0x31d,0x349,0x326,0x373)],_0x3c95c9[_0x3e3cf9(-0x147,-0x136,-0x179,-0xf7)])){if(!_0xecda0e||!_0xecda0e[_0x3e3cf9(-0x15c,-0x198,-0x1db,-0x1e3)])return _0xecda0e;return{..._0xecda0e,'content':_0x3c95c9['PfFPe'](processContentVariables,_0xecda0e[_0x3e3cf9(-0x1a2,-0x198,-0x1df,-0x14d)],_0x5560e6,_0x57c4cf)};}else{const _0x3d958c=_0x237ec1['trim'](),_0x461ac7=_0x3f3b11[_0x3e3cf9(-0x177,-0x147,-0x14f,-0x107)+'ta'][_0x3e3cf9(-0x1ab,-0x1c1,-0x1e8,-0x19f)][_0x3d958c]||'';return _0x3c1448&&_0x2fc2a1[_0x3e3cf9(-0x149,-0x139,-0x183,-0x10e)](_0x3e3cf9(-0x18d,-0x186,-0x180,-0x147)+_0x3d958c+'@}'),_0x461ac7;}});}function _0x5460(_0x4a1869,_0x2ff4f3){_0x4a1869=_0x4a1869-(-0x34c+0x8e+0x489*0x1);const _0x1be931=_0x5caf();let _0x5d1e11=_0x1be931[_0x4a1869];if(_0x5460['pQadsg']===undefined){var _0x8b4ee8=function(_0x34cd98){const _0x3c9a72='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x59bbac='',_0x333ce1='',_0x51327a=_0x59bbac+_0x8b4ee8;for(let _0x27e8ec=-0xab*-0x2d+-0x38*-0xf+-0x2157,_0x42ab12,_0x4f891c,_0x37d487=-0x63*-0x3a+-0x1*-0x25be+-0x3c2c;_0x4f891c=_0x34cd98['charAt'](_0x37d487++);~_0x4f891c&&(_0x42ab12=_0x27e8ec%(-0x2656+-0x1fc4+0x461e)?_0x42ab12*(0x1427+-0x1f1*0x1+0x1a2*-0xb)+_0x4f891c:_0x4f891c,_0x27e8ec++%(0x6*0x42b+-0x9b*0x3d+-0x1*-0xbf1))?_0x59bbac+=_0x51327a['charCodeAt'](_0x37d487+(0x20d1+-0x3*0xa81+-0x144))-(0x165c+-0x194c*0x1+0x2fa)!==-0x10fc+-0x1*0x1b44+0x2c40?String['fromCharCode'](-0xe5e+-0x158d+-0x5a*-0x69&_0x42ab12>>(-(-0x8*0x2ce+-0x3*0x469+0x23ad)*_0x27e8ec&0x1f4+0x3*-0x37+-0x7*0x2f)):_0x27e8ec:-0x1*-0x4+0x20d8+-0x20dc){_0x4f891c=_0x3c9a72['indexOf'](_0x4f891c);}for(let _0xca838c=-0xdd2+-0x254f*0x1+-0x3321*-0x1,_0xd13348=_0x59bbac['length'];_0xca838c<_0xd13348;_0xca838c++){_0x333ce1+='%'+('00'+_0x59bbac['charCodeAt'](_0xca838c)['toString'](0x2e*-0x59+0x73*-0x49+0x9c5*0x5))['slice'](-(-0x1*0x607+0x529*0x2+-0x449));}return decodeURIComponent(_0x333ce1);};_0x5460['XjtRSm']=_0x8b4ee8,_0x5460['TCsCFK']={},_0x5460['pQadsg']=!![];}const _0x336825=_0x1be931[-0x1728+0x4c*0x44+0x2f8],_0x588b74=_0x4a1869+_0x336825,_0x433b92=_0x5460['TCsCFK'][_0x588b74];if(!_0x433b92){const _0x5c2ef0=function(_0x5cf797){this['BTFFAd']=_0x5cf797,this['ttTUrB']=[-0x1*0x988+-0xd8b*-0x1+-0x402,-0x163e+0x197a*-0x1+0x2fb8,-0x4*-0x15b+-0x703+0x25*0xb],this['Zwtnrb']=function(){return'newState';},this['CyuhMr']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['zQWbpI']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5c2ef0['prototype']['vlPtAe']=function(){const _0x1a1cc2=new RegExp(this['CyuhMr']+this['zQWbpI']),_0x479603=_0x1a1cc2['test'](this['Zwtnrb']['toString']())?--this['ttTUrB'][-0x18e4+-0x1633+0x2f18]:--this['ttTUrB'][0x12e*-0x17+0x743*0x1+0x13df];return this['gRysSu'](_0x479603);},_0x5c2ef0['prototype']['gRysSu']=function(_0x28fa20){if(!Boolean(~_0x28fa20))return _0x28fa20;return this['bfKwgL'](this['BTFFAd']);},_0x5c2ef0['prototype']['bfKwgL']=function(_0x12aff5){for(let _0x229559=0xedf+-0x86*0x25+-0x1*-0x47f,_0x3e315f=this['ttTUrB']['length'];_0x229559<_0x3e315f;_0x229559++){this['ttTUrB']['push'](Math['round'](Math['random']())),_0x3e315f=this['ttTUrB']['length'];}return _0x12aff5(this['ttTUrB'][-0x2444+-0x2c*-0x52+0x2b*0x84]);},new _0x5c2ef0(_0x5460)['vlPtAe'](),_0x5d1e11=_0x5460['XjtRSm'](_0x5d1e11),_0x5460['TCsCFK'][_0x588b74]=_0x5d1e11;}else _0x5d1e11=_0x433b92;return _0x5d1e11;}function processContentVariables(_0x726a30,_0x266861,_0x163c54){function _0x51923e(_0x466140,_0x432099,_0x4b507c,_0x51198d){return _0x5460(_0x466140- -0xb7,_0x4b507c);}const _0x2a755b={};_0x2a755b[_0x51923e(0x132,0x167,0x128,0x110)]=function(_0x298262,_0x108e48){return _0x298262!==_0x108e48;},_0x2a755b[_0x16b0c1(0x102,0xf1,0x112,0xa6)]=_0x51923e(0x189,0x16b,0x18f,0x151),_0x2a755b[_0x51923e(0x114,0x137,0x117,0x125)]=function(_0x458e8c,_0x40fa4b){return _0x458e8c||_0x40fa4b;};function _0x16b0c1(_0x1a9f1d,_0x12fb2c,_0x346514,_0x4ba91e){return _0x5460(_0x12fb2c- -0x148,_0x346514);}_0x2a755b[_0x16b0c1(0x7d,0xb6,0xb8,0xe4)]=_0x51923e(0x134,0x172,0x12c,0xef),_0x2a755b[_0x51923e(0x16f,0x164,0x199,0x155)]=function(_0xdf32d2,_0x57a201){return _0xdf32d2===_0x57a201;},_0x2a755b[_0x16b0c1(0x109,0xd5,0xe9,0x110)]='text',_0x2a755b[_0x51923e(0x1a7,0x178,0x1cd,0x1e5)]=_0x16b0c1(0xd7,0x90,0x62,0x5c),_0x2a755b[_0x51923e(0x13a,0x149,0x101,0x120)]=_0x51923e(0x12e,0x164,0x12a,0xf9),_0x2a755b[_0x16b0c1(0x8a,0xbb,0xc2,0xf9)]=function(_0x1b5da0,_0x3d5642){return _0x1b5da0===_0x3d5642;},_0x2a755b[_0x51923e(0x1aa,0x1b0,0x18b,0x1f5)]=function(_0x42f08d,_0x4306c9){return _0x42f08d===_0x4306c9;},_0x2a755b[_0x16b0c1(0x124,0xe4,0x99,0xc8)]=_0x16b0c1(0x5b,0x9e,0x6b,0xab);const _0x63381e=_0x2a755b;if(_0x63381e[_0x16b0c1(0x97,0xbb,0xb0,0xee)](typeof _0x726a30,_0x16b0c1(0x112,0x106,0xc1,0xdc)))return processStringVariables(_0x726a30,_0x266861,_0x163c54);if(Array['isArray'](_0x726a30)){if(_0x63381e['OcXrH'](_0x63381e['NscdE'],'FbXDa'))return _0x726a30[_0x51923e(0x156,0x186,0x17b,0x11d)](_0x25ab31=>{function _0x1cef57(_0x112592,_0x29ddd4,_0x3981a8,_0x522a58){return _0x51923e(_0x112592-0x390,_0x29ddd4-0x1e,_0x3981a8,_0x522a58-0x198);}function _0x151c46(_0x4bc3cc,_0x5bd1fe,_0x2facf2,_0x46056f){return _0x16b0c1(_0x4bc3cc-0x4,_0x5bd1fe-0x2ad,_0x2facf2,_0x46056f-0xc1);}const _0xf0f439={'vmbsA':function(_0x5a8574,_0x25ce5c){return _0x63381e['mKNUd'](_0x5a8574,_0x25ce5c);}};if(_0x63381e[_0x151c46(0x378,0x363,0x37a,0x32e)]==='Hywlm')return _0x433b92&&_0x34cd98[_0x151c46(0x3e6,0x3ba,0x375,0x3f9)](_0x3c9a72)&&(_0x37d487&&_0x5c2ef0[_0x1cef57(0x530,0x50f,0x52e,0x56e)](_0x5cf797)),_0x27e8ec[_0x1cef57(0x4d8,0x505,0x4a2,0x4c6)](_0x42ab12,_0xf0f439[_0x151c46(0x3a9,0x3c7,0x3ff,0x3b8)](_0x4f891c,''));else{if(_0x25ab31&&_0x63381e[_0x151c46(0x3c8,0x38b,0x3db,0x393)](_0x25ab31[_0x151c46(0x392,0x3ca,0x3d8,0x39b)],_0x63381e[_0x151c46(0x396,0x382,0x33e,0x3af)])&&typeof _0x25ab31[_0x151c46(0x3b2,0x362,0x329,0x38e)]===_0x1cef57(0x527,0x55e,0x4f8,0x54c)){if(_0x63381e[_0x151c46(0x39b,0x34e,0x392,0x39b)]('pzvNH',_0x63381e[_0x1cef57(0x537,0x4e7,0x561,0x50c)]))return{..._0x25ab31,'text':processStringVariables(_0x25ab31[_0x151c46(0x34c,0x362,0x327,0x397)],_0x266861,_0x163c54)};else for(const _0x1e6ead of _0x4910c9[_0x151c46(0x39d,0x3a8,0x3ae,0x3d6)]){if(_0x1e6ead[_0x1cef57(0x519,0x528,0x531,0x543)]&&_0x63381e[_0x1cef57(0x4c2,0x47d,0x4be,0x4de)](_0x1e6ead[_0x1cef57(0x519,0x51a,0x51d,0x508)][_0x1cef57(0x4a5,0x4f3,0x45c,0x489)](),'')){const _0x58592c={};_0x58592c[_0x1cef57(0x50d,0x538,0x559,0x502)]=_0x63381e[_0x151c46(0x36a,0x39e,0x3d1,0x3d5)],_0x58592c['content']=_0x1e6ead[_0x151c46(0x3e9,0x3a5,0x3cd,0x3b2)],_0x11a4d1['push'](_0x58592c);}if(_0x1e6ead[_0x1cef57(0x4be,0x4e8,0x4ee,0x4fb)]&&_0x1e6ead[_0x151c46(0x387,0x34a,0x373,0x34e)][_0x1cef57(0x4a5,0x4cf,0x481,0x4c6)]()!==''){const _0x15839d={};_0x15839d[_0x151c46(0x393,0x399,0x3ea,0x389)]=_0x1cef57(0x4be,0x4d3,0x509,0x501),_0x15839d[_0x151c46(0x341,0x35d,0x384,0x366)]=_0x1e6ead[_0x1cef57(0x4be,0x4d7,0x46d,0x4ac)],_0x5ef9fd['push'](_0x15839d);}}}return _0x25ab31;}});else{if(_0x542c2e[_0x51923e(0x189,0x14f,0x15c,0x138)]&&_0x63381e['ZUCPp'](_0x584b45[_0x16b0c1(0x116,0xf8,0xb4,0x10d)][_0x51923e(0x115,0x108,0x11c,0xf4)](),'')){const _0x3c7ae5={};_0x3c7ae5['role']=_0x63381e[_0x16b0c1(0xa2,0xf1,0xec,0x107)],_0x3c7ae5[_0x51923e(0x141,0x101,0x17d,0x11a)]=_0x2478e9[_0x51923e(0x189,0x1d6,0x142,0x175)],_0x600434[_0x16b0c1(0xf6,0xc0,0x9f,0xfb)](_0x3c7ae5);}if(_0x3ab40a[_0x16b0c1(0x5f,0x9d,0xbe,0xc6)]&&_0x63381e[_0x16b0c1(0x59,0xa1,0xce,0x6d)](_0x1da94b[_0x51923e(0x12e,0x17e,0x166,0x146)]['trim'](),'')){const _0x1c21a5={};_0x1c21a5[_0x16b0c1(0x112,0xec,0x10a,0x13c)]=_0x63381e[_0x51923e(0x13a,0x123,0xf0,0xea)],_0x1c21a5[_0x51923e(0x141,0x16b,0x127,0x151)]=_0xe3cabe['assistant'],_0x402a17[_0x16b0c1(0x89,0xc0,0x8c,0xa1)](_0x1c21a5);}}}return _0x726a30;}function processStringVariables(_0x1a4777,_0x3b8aa8,_0x55cd4c){const _0x84f400={'KzXny':function(_0x49c8fa,_0xcf0737){return _0x49c8fa!==_0xcf0737;},'BqkCZ':_0x4f5f14(0x2ef,0x371,0x2d8,0x329),'JGgvI':function(_0x308bc4,_0x47b901,_0x7e89e7,_0x4afcd5,_0xec614f){return _0x308bc4(_0x47b901,_0x7e89e7,_0x4afcd5,_0xec614f);},'DGmhF':function(_0x1d6245,_0xaa2825,_0x3d7828){return _0x1d6245(_0xaa2825,_0x3d7828);},'TfoNY':function(_0x59d4b7,_0x270362){return _0x59d4b7===_0x270362;},'xhHFS':_0x506d7d(0x157,0x1c4,0x195,0x1c7),'mxodK':_0x506d7d(0x1bf,0x176,0x19e,0x19c),'jLcME':function(_0x3978bc,_0x31358c){return _0x3978bc(_0x31358c);},'cwZws':function(_0x17f7f7,_0x2fbf68){return _0x17f7f7(_0x2fbf68);}};function _0x4f5f14(_0x11b7e1,_0x5afc90,_0x5ad9ad,_0x172760){return _0x5460(_0x172760-0x100,_0x5ad9ad);}function _0x506d7d(_0x36072f,_0x3c3cd7,_0x20ecbd,_0x5a3408){return _0x5460(_0x20ecbd- -0x41,_0x3c3cd7);}if(!_0x1a4777)return _0x1a4777;let _0x43bedf=_0x1a4777;return _0x43bedf=_0x43bedf[_0x4f5f14(0x308,0x301,0x32a,0x2f0)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x3547b2,_0x23c610,_0x2378bf)=>{function _0xce8cd1(_0x4e667b,_0x9b30b1,_0x47d75c,_0x550146){return _0x506d7d(_0x4e667b-0xc0,_0x9b30b1,_0x47d75c-0x383,_0x550146-0x1bb);}const _0x5cf0ea=_0x23c610[_0xce8cd1(0x513,0x4be,0x50e,0x500)]();_0x3b8aa8[_0x14e3ae(0x5eb,0x590,0x594,0x5c7)+'ta']['variables'][_0x5cf0ea]=_0x2378bf;function _0x14e3ae(_0x2bfe17,_0x53680a,_0xb6cf65,_0x2b9fc7){return _0x506d7d(_0x2bfe17-0x7c,_0x2bfe17,_0x2b9fc7-0x3bf,_0x2b9fc7-0x16d);}return _0x55cd4c&&(_0x84f400[_0xce8cd1(0x530,0x567,0x575,0x593)](_0x84f400[_0xce8cd1(0x574,0x588,0x559,0x5a1)],_0x14e3ae(0x5ce,0x5d4,0x5cb,0x5a7))?_0x12aff5&&_0x5d6788[_0xce8cd1(0x565,0x570,0x599,0x599)](_0x5c92d9):_0x55cd4c[_0xce8cd1(0x57c,0x564,0x599,0x54c)](_0xce8cd1(0x54d,0x53d,0x55e,0x57d)+_0x5cf0ea+'@}')),'';}),_0x43bedf=_0x43bedf[_0x4f5f14(0x2df,0x2cd,0x33e,0x2f0)](/\{@getvar::([^@]+)@\}/g,(_0x182712,_0x18f2a9)=>{const _0x9d91a=_0x18f2a9['trim']();function _0x374c03(_0x12b293,_0x4bc30,_0x444caa,_0x565721){return _0x4f5f14(_0x12b293-0xe7,_0x4bc30-0x7,_0x12b293,_0x4bc30-0x189);}function _0xcebdf7(_0x31ca94,_0x2f724a,_0x11aa79,_0x4748ed){return _0x4f5f14(_0x31ca94-0x2b,_0x2f724a-0xa9,_0x2f724a,_0x31ca94-0x1f2);}const _0x5d3649=_0x3b8aa8[_0xcebdf7(0x53b,0x58c,0x58b,0x52c)+'ta'][_0xcebdf7(0x4c1,0x4e7,0x507,0x48b)][_0x9d91a]||'';return _0x55cd4c&&_0x55cd4c[_0xcebdf7(0x549,0x57e,0x53e,0x565)](_0xcebdf7(0x4fc,0x549,0x4cd,0x4bd)+_0x9d91a+'@}'),_0x5d3649;}),_0x43bedf=_0x43bedf[_0x4f5f14(0x324,0x2fb,0x324,0x2f0)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2fbc3b,_0x136cb4,_0x5a9f22)=>{function _0x2c223d(_0x1c140c,_0x40fc96,_0x1d19d5,_0x1966ac){return _0x4f5f14(_0x1c140c-0x126,_0x40fc96-0x1ad,_0x1966ac,_0x1c140c-0x1ca);}function _0x1f00e2(_0x39d2c4,_0x39f438,_0x37a6e2,_0x535031){return _0x4f5f14(_0x39d2c4-0x170,_0x39f438-0x6d,_0x37a6e2,_0x39d2c4-0x1);}const _0x5737fa=_0x136cb4[_0x1f00e2(0x2cd,0x318,0x317,0x2c0)]();_0x84f400['DGmhF'](setglobalvar,_0x5737fa,_0x5a9f22);if(_0x55cd4c){if(_0x84f400['TfoNY'](_0x84f400['xhHFS'],_0x84f400[_0x1f00e2(0x319,0x352,0x360,0x31d)])){const _0x30617c={};for(const _0x2e5ab6 in _0x3d1dfa){_0x30617c[_0x2e5ab6]=_0x84f400[_0x2c223d(0x500,0x4b4,0x4ea,0x54f)](_0x505224,_0x1be5a9[_0x2e5ab6],_0x32474c,_0x4e1710,_0xe77ed1);}return _0x30617c;}else _0x55cd4c[_0x1f00e2(0x358,0x324,0x398,0x338)]('{@setgloba'+_0x2c223d(0x537,0x4e9,0x566,0x505)+_0x5737fa+'@}');}return'';}),_0x43bedf=_0x43bedf[_0x506d7d(0x15e,0x176,0x1af,0x19c)](/\{@getglobalvar::([^@]+)@\}/g,(_0xd9ecbf,_0x12f625)=>{const _0x2a85cf=_0x12f625[_0x32c3c3(0x527,0x539,0x563,0x4f2)]();function _0x32c3c3(_0xe25020,_0x54041,_0x1ca11b,_0x5c99fa){return _0x506d7d(_0xe25020-0x5,_0x54041,_0xe25020-0x39c,_0x5c99fa-0xbe);}function _0x3cef0e(_0x1ceafe,_0xa5933f,_0x4b9022,_0x2c4b8b){return _0x506d7d(_0x1ceafe-0x8f,_0x1ceafe,_0xa5933f- -0xa1,_0x2c4b8b-0xbb);}const _0x5a0305=_0x84f400[_0x3cef0e(0xfc,0x13e,0x12c,0x150)](getglobalvar,_0x2a85cf)||'';return _0x55cd4c&&_0x55cd4c[_0x3cef0e(0x142,0x175,0x17e,0x13c)](_0x32c3c3(0x589,0x58a,0x58f,0x54d)+_0x3cef0e(0x1cc,0x18b,0x17e,0x18e)+_0x2a85cf+'@}'),_0x5a0305;}),_0x43bedf=_0x43bedf['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x266af1,_0x2cfbaa)=>{const _0x35df52=_0x2cfbaa[_0x5a5af0(0xc2,0x103,0xfc,0x123)](),_0x3dd3fa=_0x84f400[_0x5a5af0(0x158,0x18f,0x182,0x16c)](getworldvar,_0x35df52)||'';_0x55cd4c&&_0x55cd4c[_0x23d180(0x39e,0x34f,0x395,0x36b)](_0x23d180(0x3a6,0x378,0x369,0x3cc)+_0x5a5af0(0x1bf,0x176,0x147,0x14f)+_0x35df52+'@}');function _0x23d180(_0x1ee6dd,_0x58e399,_0xd7d389,_0x5d0e14){return _0x4f5f14(_0x1ee6dd-0x2d,_0x58e399-0x16d,_0x58e399,_0x1ee6dd-0x47);}function _0x5a5af0(_0x438a77,_0x273aa3,_0x2881a2,_0x4a2782){return _0x4f5f14(_0x438a77-0x78,_0x273aa3-0x18a,_0x4a2782,_0x273aa3- -0x1c9);}return _0x3dd3fa;}),_0x43bedf;}export function buildPromptWithTrigger(_0x20dd80){const _0x41cfaa={'AQYCk':'user','xbMPE':function(_0x1d245a,_0x59eb59){return _0x1d245a===_0x59eb59;},'QXPlh':'trigger','jhUfD':_0x1b76cd(0x412,0x429,0x454,0x42f),'zwCnM':function(_0x22da01,_0x1f0d9d,_0x39eaa0){return _0x22da01(_0x1f0d9d,_0x39eaa0);},'zRCCF':function(_0x1d75f8,_0x5c3d7e){return _0x1d75f8!==_0x5c3d7e;},'VRLnS':_0x1d1bc4(0x430,0x424,0x442,0x468),'tWzNP':'assistant','IQQnv':function(_0x56c8c3,_0x1a4f7d){return _0x56c8c3(_0x1a4f7d);},'HtxwS':function(_0x14efd7,_0x4cadc3,_0x3d26d4){return _0x14efd7(_0x4cadc3,_0x3d26d4);}},{requestType:_0x27dcac,contextData:_0x111fbc}=_0x20dd80,_0x5008bd=extension_settings[extensionName]?.[_0x1b76cd(0x41f,0x434,0x404,0x42b)+'t_type_con'+_0x1d1bc4(0x43f,0x487,0x465,0x478)]||{},_0x60cadd={};_0x60cadd['context_pr'+_0x1d1bc4(0x3e1,0x44a,0x45e,0x410)]='默认';function _0x1d1bc4(_0x41c411,_0x1d64c9,_0x1ec541,_0x1cfef9){return _0x5460(_0x1cfef9-0x22d,_0x1d64c9);}const _0x5c4013=_0x5008bd[_0x27dcac]||_0x60cadd;function _0x1b76cd(_0xe4093e,_0x8c8161,_0x585027,_0x41859e){return _0x5460(_0xe4093e-0x23d,_0x585027);}const _0x92da29=_0x5c4013['context_pr'+_0x1b76cd(0x420,0x3d7,0x402,0x3ed)]||'默认',_0x2baa8d=extension_settings[extensionName]?.[_0x1b76cd(0x46e,0x41e,0x422,0x477)+'xt_profile'+'s']||{},_0x5e9ea9=_0x2baa8d[_0x92da29]||_0x2baa8d[Object[_0x1b76cd(0x431,0x452,0x42c,0x47f)](_0x2baa8d)[0xe75*0x2+0xcc+-0xedb*0x2]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x111fbc,_0xf48ba=[userDemand,context,body,worldBookContent][_0x1d1bc4(0x4b1,0x489,0x449,0x48a)](Boolean)[_0x1b76cd(0x43e,0x451,0x48e,0x447)]('\x0a'),_0x1c9114=[];if(_0x5e9ea9[_0x1d1bc4(0x45c,0x403,0x43d,0x439)]&&Array['isArray'](_0x5e9ea9['entries']))for(const _0xe94343 of _0x5e9ea9[_0x1d1bc4(0x419,0x428,0x42d,0x439)]){if(!_0xe94343[_0x1d1bc4(0x437,0x41d,0x449,0x417)])continue;if(!_0xe94343[_0x1b76cd(0x435,0x448,0x465,0x42c)]||_0x41cfaa[_0x1b76cd(0x468,0x4ba,0x44a,0x4b0)](_0xe94343[_0x1b76cd(0x435,0x430,0x430,0x3ff)][_0x1d1bc4(0x3c6,0x3ea,0x420,0x3f9)](),''))continue;if(_0x41cfaa[_0x1b76cd(0x468,0x46a,0x468,0x435)](_0xe94343[_0x1d1bc4(0x4bd,0x479,0x45e,0x47d)+'e'],_0x41cfaa[_0x1b76cd(0x479,0x47f,0x48e,0x446)])){if(_0x41cfaa['jhUfD']!==_0x41cfaa[_0x1d1bc4(0x44b,0x445,0x41c,0x423)]){const _0x2ef129={};_0x2ef129[_0x1d1bc4(0x455,0x486,0x480,0x461)]=_0x41cfaa[_0x1b76cd(0x485,0x43c,0x439,0x4b4)],_0x2ef129[_0x1b76cd(0x435,0x421,0x41f,0x41a)]=_0x4bec64[_0x1d1bc4(0x498,0x45b,0x493,0x46d)],_0x4c5a6b[_0x1b76cd(0x445,0x48b,0x446,0x473)](_0x2ef129);}else{if(!_0x41cfaa['zwCnM'](checkTriggerWords,_0xe94343['triggerWor'+'ds'],_0xf48ba))continue;}}const _0x5dd416={};_0x5dd416[_0x1b76cd(0x471,0x438,0x4b4,0x456)]=_0xe94343[_0x1d1bc4(0x488,0x46d,0x45c,0x461)]||_0x1d1bc4(0x4ad,0x45e,0x429,0x46d),_0x5dd416['content']=_0xe94343[_0x1d1bc4(0x466,0x430,0x411,0x425)],_0x1c9114[_0x1b76cd(0x445,0x3f7,0x491,0x424)](_0x5dd416);}else{if(_0x5e9ea9[_0x1d1bc4(0x468,0x479,0x430,0x470)]&&Array[_0x1d1bc4(0x3be,0x45a,0x3bd,0x408)](_0x5e9ea9[_0x1d1bc4(0x498,0x4b2,0x463,0x470)]))for(const _0x3d7b6 of _0x5e9ea9['history']){if(_0x41cfaa[_0x1d1bc4(0x424,0x480,0x4a1,0x471)](_0x41cfaa[_0x1d1bc4(0x448,0x429,0x3fc,0x415)],_0x41cfaa[_0x1d1bc4(0x3e4,0x44b,0x42a,0x415)]))_0x6ccee4[_0x1d1bc4(0x47f,0x437,0x489,0x484)](_0x1b76cd(0x49c,0x4df,0x4d0,0x4a0)+_0x1b76cd(0x47c,0x453,0x495,0x4b1)+_0x1bdf0c+'@}');else{if(_0x3d7b6[_0x1d1bc4(0x47f,0x433,0x49c,0x46d)]&&_0x3d7b6['user']['trim']()!==''){const _0x763b45={};_0x763b45[_0x1d1bc4(0x453,0x473,0x480,0x461)]=_0x41cfaa[_0x1b76cd(0x485,0x4ce,0x47d,0x467)],_0x763b45[_0x1b76cd(0x435,0x3e4,0x40f,0x3f8)]=_0x3d7b6[_0x1d1bc4(0x42f,0x42a,0x46d,0x46d)],_0x1c9114['push'](_0x763b45);}if(_0x3d7b6[_0x1b76cd(0x422,0x435,0x473,0x438)]&&_0x3d7b6[_0x1b76cd(0x422,0x41f,0x458,0x443)]['trim']()!==''){const _0x53d52b={};_0x53d52b['role']=_0x41cfaa[_0x1d1bc4(0x445,0x469,0x47f,0x47f)],_0x53d52b[_0x1b76cd(0x435,0x3f4,0x456,0x44a)]=_0x3d7b6['assistant'],_0x1c9114[_0x1b76cd(0x445,0x441,0x488,0x457)](_0x53d52b);}}}}const _0x1fd5e2=_0x41cfaa['IQQnv'](mergeAdjacentMessages,_0x1c9114),{messages:_0x4677d6,replacedVariables:_0x1f6dad}=_0x41cfaa[_0x1b76cd(0x44b,0x470,0x44e,0x498)](replaceAllPlaceholders,_0x1fd5e2,_0x111fbc);return _0x4677d6;}export function getProcessedPrompt(_0x4b6429,_0x1bc2eb){function _0x38efc3(_0x33c040,_0x3e8a87,_0xcd3d3a,_0x5d8aba){return _0x5460(_0x33c040-0x2c2,_0xcd3d3a);}const _0x6b6e74={'CIEWJ':function(_0xdcf173,_0x2fadf8){return _0xdcf173(_0x2fadf8);}},_0x2bf816={};function _0x40ffa5(_0x427cb2,_0x38e750,_0x270da7,_0x535b84){return _0x5460(_0x270da7- -0x356,_0x38e750);}return _0x2bf816[_0x40ffa5(-0x10d,-0x14f,-0x115,-0x15b)+'e']=_0x4b6429,_0x2bf816[_0x40ffa5(-0x135,-0x1b3,-0x175,-0x145)+'a']=_0x1bc2eb,_0x6b6e74['CIEWJ'](buildPromptWithTrigger,_0x2bf816);}