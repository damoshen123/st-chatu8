(function(_0x630d52,_0x3f76a4){function _0x481d46(_0x5c8e14,_0x16deac,_0xfce13f,_0x282ffd){return _0x43dd(_0x282ffd- -0x35e,_0xfce13f);}const _0x410a55=_0x630d52();function _0x311e5a(_0x3fea4f,_0x25f2d1,_0x1870e3,_0x22d4b0){return _0x43dd(_0x25f2d1- -0x2d3,_0x1870e3);}while(!![]){try{const _0x327be1=parseInt(_0x481d46(-0x267,-0x28b,-0x1f6,-0x234))/(-0xa2+-0x252a*0x1+0x1*0x25cd)*(-parseInt(_0x481d46(-0x1b0,-0x1a3,-0x208,-0x1d7))/(0x40*-0x78+0x2007+-0x205))+-parseInt(_0x481d46(-0x1fe,-0x1c7,-0x175,-0x1be))/(-0x1*0x2690+0x215c+0x537)+-parseInt(_0x481d46(-0x24b,-0x206,-0x242,-0x24b))/(-0xf73+0x12c6+-0x34f)*(parseInt(_0x311e5a(-0x1dd,-0x1a3,-0x1eb,-0x161))/(-0x136a+-0xf53+0x22c2))+parseInt(_0x311e5a(-0x173,-0x1ba,-0x1b4,-0x17d))/(-0x3*0x959+0x3*0xa8a+0x65*-0x9)+parseInt(_0x311e5a(-0x125,-0x12a,-0x135,-0x15c))/(-0x1bb9+-0x42e+0x1fee)*(-parseInt(_0x311e5a(-0x17e,-0x198,-0x146,-0x1a2))/(0x16d6+0x5e*-0x4+-0x1556))+parseInt(_0x311e5a(-0x1d1,-0x179,-0x1b5,-0x164))/(0x11eb+0x236f+-0x1*0x3551)+parseInt(_0x481d46(-0x1b8,-0x1b7,-0x182,-0x1d5))/(0xef0+-0x5*0x714+0x56*0x3d);if(_0x327be1===_0x3f76a4)break;else _0x410a55['push'](_0x410a55['shift']());}catch(_0x5f4ad2){_0x410a55['push'](_0x410a55['shift']());}}}(_0xbe59,0x20*-0xa291+-0x1226d3+0x3398a1));function _0xbe59(){const _0x342ad0=['y29UDgvUDa','CMvWBgfJzufSBa','C2vHCMnO','wLrWrha','DhjPBq','CMvXDwvZDfr5Ca','t25AzxG','DxHQBwK','E0bNzxr3B3jSza','E3VKUjBNLyZKUABOP6BLJ5f9Fq','D2vSzLi','y29UDgv4DerHDa','E3T1C2vYFx0','AwfVvhe','vNjqtMC','w3bYB21WDfbYBW','AKfZEMK','BhzHCJO6','wgXjEvq','yxnZAxn0yw50','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','Cgf2Agq','nteZmtu2nKrUveTNEa','kcGOlISPkYKRkq','C3rYAw5N','EK1nyu4','DhLWzq','EeP5yLK','Bvnhvuu','t2DpqKK','C3bSAxq','AgLZDg9YEq','Dg1UEuq','zwveru8','ywrK','v012wvm','qM11zvK','sfvUwxG','Eg5yDMq','weTIuge','Dg9tDhjPBMC','ChvZAa','id0+ia','Avvdqxu','EhrFChjVzMLSzq','AK1pqLO','C1npvKW','rg9hENy','zLfWCvu','DhzHCJOG','q1L6AMy','E3VNLkJMIlFPNidMSyj9Fq','zfnct2m','y2vZC29YxsbZzq','CwrqtwG','s2XPtgq','B0f3DNC','DgL4Cwm','AwPKEMu','zw5HyMXLza','DxnLCG','DMfYAwfIBgvZ','AfbUB0K','B2zPBgu','C1vushm','AwrzzKS','Dgv4Da','nJiYndzzsvjxvwq','y2vZC29YxsbNzq','nde2ntK5ndbXrgXiqvq','tNzMD2O','phvZzxi+','s0HyzwO','vxjutLm','zw50CMLLCW','CMvWBgfJzwrwyq','y29UDgv4Df9WCG','AM9PBG','DhjPz2DLCLDVCG','BvHJzu8','vfzdvNu','EK5jr3G','DeDfBLC','EMDdswK','lI4U','tvngCK0','D1nhEfy','whzfy0W','C3f3C3O','wuTpzgG','DgDSB2jHBhzHCG','C3vIC3rYAw5N','ndiWnZGWmeT3ywDZqG','A2v5CW','sgXXBLy','ChjmCvy','ENvLwLu','B2jQzwn0','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','Cw9vDNK','DhjPz2DLCK1Vza','n3bLufnjua','AwveCNG','E0bZzxrNBg9Iyq','E0bNzxrNBg9Iyq','BwvZC2fNzxm','BxnHzwS','zufkyMy','CM9Szq','BgXTx3jLCxvLCW','C3rYAw5NAwz5','CMvWBgfJzq','DwTWAfG','u1jcu1O','q2fVvxC','DwX0ve0','y29UC3rYDwn0BW','wNDJv3q','DMfYoJO','AxnbCNjHEq','A1v6BfC','s2LbDeO','ExjLBeq','wfHTAu8','zMLSDgvY','EgX3Bgq','B1jluMy','Aw5JBhvKzxm','mtiWwNLurMrJ','suHds00','rK12D0i','tff2DeK','y2vZC29YxsdMNOtLU7O','r3jsCwi','nJeZmta0Awfws0P3','BgvUz3rO','yxbWBhK','zw50CMLLC0nVDq','E3TNzxr2yxi6oG','BLvqEgO','q0zQv3m','E0bZzxr2yxi6oG','BNbJAeC','y2HHDe1LDgfKyq','sgrtvMG','rLr3why','Ae10quu','zMLNCW','id0G','Dvvtsvu','E3VMRApMLOD9Fq','mJr5rML5BNq','BwvYz2vKq291BG','z2jNs3a','BwfW','Df90ExbLx2nVBG','BhDvyNK','mtC3mtKWtfPlB2vV','thz1wgm','tNDKDuC','turdrK4','rvzOrMW','z25TveW','wNDmquC','sg5PuNO','yxDVBeu','DxrTr04','tw9Awxe','nJeYndy1nMX5BwPkCa','DwzhBeG','DwLeB0u','Dg5Zqu4','Bg9N','wu9WA0m','BMH6uxG','E3VKUiRKUiVMLOD9Fq','yKjAAu8'];_0xbe59=function(){return _0x342ad0;};return _0xbe59();}const _0x269873=(function(){const _0x1fcef8={};_0x1fcef8[_0x21ea3d(-0xe,-0x52,-0x61,-0x50)]=function(_0x3736af,_0x3f983c){return _0x3736af!==_0x3f983c;};function _0x4230c7(_0x4b9297,_0x3268c2,_0x3bd3de,_0x326b03){return _0x43dd(_0x3268c2-0x30c,_0x326b03);}_0x1fcef8['qoUvy']=_0x21ea3d(-0x73,0x3,-0x29,-0x51),_0x1fcef8[_0x4230c7(0x3c9,0x422,0x40a,0x43f)]=_0x4230c7(0x401,0x420,0x41d,0x464);function _0x21ea3d(_0x27bbae,_0x3c5f68,_0x5be260,_0x20d35c){return _0x43dd(_0x20d35c- -0x1b1,_0x3c5f68);}_0x1fcef8['MoZYq']=_0x4230c7(0x4b3,0x496,0x4ee,0x4ea);const _0x36ca81=_0x1fcef8;let _0x228191=!![];return function(_0x2c6bf4,_0x216494){function _0x1341cd(_0x1aaddc,_0x382772,_0x3ff552,_0x137b0){return _0x21ea3d(_0x1aaddc-0x1e4,_0x137b0,_0x3ff552-0x133,_0x382772- -0x49);}function _0x3cdd27(_0x509294,_0x60125,_0x260fb6,_0x171858){return _0x21ea3d(_0x509294-0x1dd,_0x60125,_0x260fb6-0x176,_0x509294-0x122);}if(_0x36ca81['LQvtI']!==_0x36ca81[_0x1341cd(-0xba,-0xc0,-0xd5,-0x8f)]){const _0x1ce4fa=_0x228191?function(){function _0xfc8f41(_0x918153,_0x3c7e5d,_0x4aaa64,_0x353d78){return _0x1341cd(_0x918153-0x173,_0x3c7e5d-0x30f,_0x4aaa64-0xcd,_0x918153);}function _0x584860(_0x3ca8dc,_0x3fbade,_0x599531,_0x614f95){return _0x1341cd(_0x3ca8dc-0x8e,_0x599531- -0x1de,_0x599531-0x24,_0x3ca8dc);}if(_0x36ca81['OgOBI'](_0x36ca81['qoUvy'],_0x36ca81[_0xfc8f41(0x2bb,0x2bc,0x296,0x29e)]))return _0x54903f&&_0x31b8d9[_0x584860(-0x310,-0x310,-0x2c6,-0x2ee)](_0x2d3e68)&&(_0x4f3676&&_0x4acbc7[_0xfc8f41(0x245,0x27b,0x228,0x23f)](_0x42d05d)),_0x2daee6[_0xfc8f41(0x259,0x25a,0x230,0x253)](_0x2dd14c,_0x58715b||'');else{if(_0x216494){const _0x45343f=_0x216494[_0x584860(-0x264,-0x271,-0x2bd,-0x2b4)](_0x2c6bf4,arguments);return _0x216494=null,_0x45343f;}}}:function(){};return _0x228191=![],_0x1ce4fa;}else _0x4a859e[_0x3cdd27(0xde,0xfc,0xf8,0xa0)](_0x3344a9);};}()),_0x445c10=_0x269873(this,function(){const _0x28d696={};_0x28d696[_0x38b17d(-0x1fe,-0x20d,-0x1f2,-0x202)]='(((.+)+)+)'+'+$';function _0x20e6f9(_0x110dac,_0x2fad95,_0x5a77a6,_0x30deca){return _0x43dd(_0x5a77a6- -0x311,_0x110dac);}const _0x46754c=_0x28d696;function _0x38b17d(_0x2088e5,_0x50e648,_0x4312e2,_0x5d3554){return _0x43dd(_0x5d3554- -0x36b,_0x50e648);}return _0x445c10[_0x38b17d(-0x1eb,-0x1d6,-0x1ae,-0x1ff)]()[_0x38b17d(-0x266,-0x24d,-0x20f,-0x225)](_0x20e6f9(-0x1ad,-0x1f1,-0x1b6,-0x1bc)+'+$')[_0x38b17d(-0x1aa,-0x1cc,-0x1d2,-0x1ff)]()[_0x20e6f9(-0x182,-0x117,-0x159,-0x104)+'r'](_0x445c10)[_0x38b17d(-0x27a,-0x1d5,-0x22a,-0x225)](_0x46754c[_0x20e6f9(-0x179,-0x160,-0x1a8,-0x181)]);});_0x445c10();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';function _0x43dd(_0x3c9c8c,_0x50e03e){_0x3c9c8c=_0x3c9c8c-(-0xbea+-0x5*0x1cc+0x15f6);const _0x60dcbe=_0xbe59();let _0x5d91f4=_0x60dcbe[_0x3c9c8c];if(_0x43dd['FUbzhw']===undefined){var _0x403a1d=function(_0x42b570){const _0x31c07a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5cb633='',_0x48ecf6='',_0x54903f=_0x5cb633+_0x403a1d;for(let _0x31b8d9=-0x211*-0x8+0x4f2*-0x4+0x340,_0x2d3e68,_0x45d1d3,_0x295aab=0x4*-0x887+-0x2225+-0x65*-0xad;_0x45d1d3=_0x42b570['charAt'](_0x295aab++);~_0x45d1d3&&(_0x2d3e68=_0x31b8d9%(-0xcf1*-0x1+-0x296*0x1+-0xa57*0x1)?_0x2d3e68*(-0xdf0+0x1faf+-0x117f)+_0x45d1d3:_0x45d1d3,_0x31b8d9++%(-0xe9f+0x38a+0xb19))?_0x5cb633+=_0x54903f['charCodeAt'](_0x295aab+(-0x1*-0x25c+0x10dd+0x3*-0x665))-(-0x1*0x1391+0x2109+-0xd6e)!==0xb36+-0x1849+0xd13?String['fromCharCode'](0x21*-0x3a+-0xc11*0x1+0x1de*0xb&_0x2d3e68>>(-(0x1ec3+0x1795*0x1+-0x217*0x1a)*_0x31b8d9&0x150+-0x1b53+0xd7*0x1f)):_0x31b8d9:-0x261c+-0x1a8d*0x1+0x40a9){_0x45d1d3=_0x31c07a['indexOf'](_0x45d1d3);}for(let _0x3795e5=0xee1+0x23*0x34+0x1*-0x15fd,_0x2daee6=_0x5cb633['length'];_0x3795e5<_0x2daee6;_0x3795e5++){_0x48ecf6+='%'+('00'+_0x5cb633['charCodeAt'](_0x3795e5)['toString'](-0x892*0x1+-0xbb+0x3*0x31f))['slice'](-(0x653*-0x2+-0x16f9+-0x23a1*-0x1));}return decodeURIComponent(_0x48ecf6);};_0x43dd['mvCGWc']=_0x403a1d,_0x43dd['vgrDuL']={},_0x43dd['FUbzhw']=!![];}const _0x5e7410=_0x60dcbe[0x18c7*-0x1+-0x1d9f*-0x1+-0x4d8],_0x4b1d39=_0x3c9c8c+_0x5e7410,_0x1cab15=_0x43dd['vgrDuL'][_0x4b1d39];if(!_0x1cab15){const _0x2dd14c=function(_0x58715b){this['WWXAxc']=_0x58715b,this['iFAQEn']=[-0xf89+-0x145a+0x23e4,-0x51f+0x1*0x20d8+-0x97*0x2f,-0x161c+-0x2585+0x3ba1],this['bESPjN']=function(){return'newState';},this['muRWmf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['dlkFMK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2dd14c['prototype']['yZlqIq']=function(){const _0x4f3676=new RegExp(this['muRWmf']+this['dlkFMK']),_0x2cddd1=_0x4f3676['test'](this['bESPjN']['toString']())?--this['iFAQEn'][0x33*-0x75+-0x938+0x2088]:--this['iFAQEn'][-0xabd+0x1*-0x1a2d+0xd2*0x2d];return this['ffKPSB'](_0x2cddd1);},_0x2dd14c['prototype']['ffKPSB']=function(_0x3d8c0d){if(!Boolean(~_0x3d8c0d))return _0x3d8c0d;return this['DrjpEU'](this['WWXAxc']);},_0x2dd14c['prototype']['DrjpEU']=function(_0x4acbc7){for(let _0x42d05d=-0x2202+-0x1*-0x20a2+-0x16*-0x10,_0x350eba=this['iFAQEn']['length'];_0x42d05d<_0x350eba;_0x42d05d++){this['iFAQEn']['push'](Math['round'](Math['random']())),_0x350eba=this['iFAQEn']['length'];}return _0x4acbc7(this['iFAQEn'][0x1ab8+-0x1f7d+0x4c5]);},new _0x2dd14c(_0x43dd)['yZlqIq'](),_0x5d91f4=_0x43dd['mvCGWc'](_0x5d91f4),_0x43dd['vgrDuL'][_0x4b1d39]=_0x5d91f4;}else _0x5d91f4=_0x1cab15;return _0x5d91f4;}import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x401fca,_0x66f6da){function _0x5581b7(_0x44bd77,_0xa9122d,_0x2b3c71,_0x3eb17d){return _0x43dd(_0x3eb17d-0x369,_0x44bd77);}function _0x1089c2(_0x134c0d,_0xfa1010,_0x3860df,_0x2f2c2d){return _0x43dd(_0x3860df- -0x1bf,_0x134c0d);}const _0x3dfa01={};_0x3dfa01['EVhFl']=_0x5581b7(0x490,0x4ad,0x46f,0x4c4)+'+$',_0x3dfa01[_0x1089c2(0x23,0x33,-0x3,0x47)]=_0x1089c2(-0x46,-0x8b,-0x45,-0x11),_0x3dfa01['UQwhj']=function(_0x1cee23,_0x23b301){return _0x1cee23===_0x23b301;},_0x3dfa01['zMMaN']=_0x5581b7(0x4d0,0x4b6,0x496,0x4aa),_0x3dfa01[_0x1089c2(-0xda,-0x43,-0x9c,-0xb6)]=_0x5581b7(0x546,0x505,0x54f,0x500);const _0x3b096e=_0x3dfa01;if(!_0x401fca||!_0x66f6da){if(_0x3b096e[_0x5581b7(0x527,0x548,0x4e5,0x525)]!==_0x3b096e['kUzlW']){const _0x450ad0={};_0x450ad0[_0x5581b7(0x569,0x55e,0x4ca,0x519)]='assistant',_0x450ad0[_0x1089c2(-0x7d,-0xa5,-0x7b,-0x8c)]=_0x5041a1[_0x5581b7(0x4c6,0x515,0x4ff,0x4c0)],_0x18ab11[_0x1089c2(-0xa7,-0x2f,-0x52,-0x6e)](_0x450ad0);}else return![];}const _0x5011c5=_0x401fca[_0x1089c2(-0x7a,-0xa1,-0x5d,-0x93)](',')[_0x5581b7(0x4a8,0x472,0x465,0x496)](_0x51693c=>_0x51693c[_0x1089c2(-0x92,-0xbf,-0x77,-0x3e)]())['filter'](_0x24b76f=>_0x24b76f);if(_0x3b096e['UQwhj'](_0x5011c5['length'],0x14e7*-0x1+0xc02+0x8e5))return _0x3b096e[_0x5581b7(0x4fc,0x4e1,0x48e,0x4c6)]!==_0x3b096e[_0x1089c2(-0xc6,-0xc8,-0x9c,-0xee)]?![]:_0x29084b[_0x1089c2(-0x71,-0x80,-0x53,-0x28)]()[_0x1089c2(-0x58,-0x55,-0x79,-0xb9)](DZKfcP['EVhFl'])[_0x5581b7(0x4c9,0x49d,0x4a0,0x4d5)]()[_0x5581b7(0x517,0x53c,0x548,0x521)+'r'](_0x268fe9)[_0x1089c2(-0x89,-0x7f,-0x79,-0x4a)](DZKfcP[_0x5581b7(0x499,0x45d,0x486,0x49d)]);for(const _0x15c1bc of _0x5011c5){if(_0x66f6da['includes'](_0x15c1bc))return!![];}return![];}export function mergeAdjacentMessages(_0x2acbfa){const _0x123983={'onXJQ':function(_0x25882e,_0x21f90a){return _0x25882e===_0x21f90a;},'OnZex':function(_0x1227a5,_0x2211f8,_0x2da749){return _0x1227a5(_0x2211f8,_0x2da749);},'ultTM':function(_0x1c220e,_0x50c02f){return _0x1c220e===_0x50c02f;},'YKOdh':_0x59a12a(0x50,0xd,0x20,-0x2),'jAszi':function(_0x474fe9,_0x3b93f2,_0x5af7d4){return _0x474fe9(_0x3b93f2,_0x5af7d4);}};if(!_0x2acbfa||_0x2acbfa[_0x59a12a(-0x70,-0x20,-0x3a,-0x6a)]===-0x7*0xc7+0x3*0xb2+0x35b){if(_0x123983[_0x59a12a(0x82,-0x17,0x19,0x33)](_0x4da71d(0x451,0x432,0x431,0x42e),_0x123983[_0x59a12a(-0x22,0x8,0x5,0x19)])){if(!_0x28b4e8){const _0x66fef7={..._0x4b1b32};_0x46715f=_0x66fef7;}else{if(_0x123983['onXJQ'](_0x12d77e[_0x4da71d(0x486,0x50a,0x47c,0x4ba)],_0xf48511[_0x59a12a(0x20,0x1a,0x31,0x2c)]))_0x3b04b8[_0x4da71d(0x48e,0x40e,0x40b,0x44e)]=_0x123983[_0x4da71d(0x40c,0x463,0x48c,0x454)](_0x2539df,_0x2ecba2['content'],_0x393754['content']);else{_0x3ab13f['push'](_0x15694f);const _0x2bee84={..._0x3b6b32};_0x4c04f6=_0x2bee84;}}}else return[];}const _0x620793=[];function _0x4da71d(_0x42b11a,_0x14081f,_0x39ee37,_0x5163e0){return _0x43dd(_0x5163e0-0x30a,_0x42b11a);}let _0xd78e1=null;for(const _0x46c1f8 of _0x2acbfa){if(!_0xd78e1){const _0x319f4a={..._0x46c1f8};_0xd78e1=_0x319f4a;}else{if(_0x123983['onXJQ'](_0xd78e1[_0x4da71d(0x4f2,0x4e8,0x4e2,0x4ba)],_0x46c1f8[_0x4da71d(0x4fd,0x512,0x4d7,0x4ba)]))_0xd78e1[_0x59a12a(-0x73,-0x8a,-0x65,-0x40)]=_0x123983[_0x4da71d(0x496,0x44b,0x4a1,0x45e)](mergeContent,_0xd78e1['content'],_0x46c1f8['content']);else{_0x620793[_0x59a12a(0x30,-0x51,-0x48,-0x17)](_0xd78e1);const _0x46ff39={..._0x46c1f8};_0xd78e1=_0x46ff39;}}}function _0x59a12a(_0x4b40ed,_0x59da8a,_0x41e206,_0x325b8c){return _0x43dd(_0x325b8c- -0x184,_0x41e206);}return _0xd78e1&&_0x620793[_0x59a12a(0x37,0xb,-0x34,-0x17)](_0xd78e1),_0x620793;}function mergeContent(_0x37eaa6,_0x3144fa){const _0x305e8a={'wSGxV':_0x47d1fb(0x19d,0x18c,0x190,0x1a2),'UrTNS':function(_0x1205f9,_0x373f69){return _0x1205f9===_0x373f69;},'gnmTL':function(_0x40126a,_0x162b77){return _0x40126a+_0x162b77;},'npchG':function(_0x1d70a3,_0x364440){return _0x1d70a3+_0x364440;},'sUTHs':function(_0x5e5c9f,_0x41efbb){return _0x5e5c9f(_0x41efbb);},'eMsmG':_0x47d1fb(0x1c7,0x1b3,0x1d3,0x1ab)};if(typeof _0x37eaa6===_0x305e8a[_0x5635fb(-0x1b6,-0x1be,-0x1bc,-0x20c)]&&_0x305e8a[_0x5635fb(-0x24d,-0x1f6,-0x223,-0x219)](typeof _0x3144fa,_0x5635fb(-0x247,-0x1f4,-0x260,-0x24a)))return _0x305e8a[_0x47d1fb(0x176,0x14a,0x18b,0x1c2)](_0x305e8a[_0x5635fb(-0x2a9,-0x250,-0x270,-0x285)](_0x37eaa6,'\x0a'),_0x3144fa);const _0x46150a=normalizeToArray(_0x37eaa6),_0x51a991=_0x305e8a[_0x47d1fb(0x1c5,0x1d8,0x208,0x1ad)](normalizeToArray,_0x3144fa);function _0x47d1fb(_0x207997,_0x4cf432,_0x414b48,_0x11ea0c){return _0x43dd(_0x207997-0x41,_0x4cf432);}const _0xaa5adc={};_0xaa5adc[_0x47d1fb(0x19f,0x15a,0x1f2,0x15c)]=_0x305e8a['eMsmG'],_0xaa5adc[_0x47d1fb(0x1c7,0x177,0x1f2,0x205)]='\x0a';function _0x5635fb(_0x391a69,_0x3476fc,_0x1fa0ec,_0x50a3ed){return _0x43dd(_0x50a3ed- -0x3a6,_0x1fa0ec);}return[..._0x46150a,_0xaa5adc,..._0x51a991];}function normalizeToArray(_0x3726cb){const _0xffb1ee={};_0xffb1ee[_0x4b3ba6(0x463,0x4a1,0x47a,0x441)]=_0x4b3ba6(0x47f,0x4af,0x4d4,0x4a2);function _0x4b3ba6(_0x258c87,_0x59e39c,_0x461817,_0x358b89){return _0x43dd(_0x258c87-0x2f9,_0x358b89);}_0xffb1ee[_0x4b3ba6(0x464,0x437,0x429,0x4bd)]=function(_0x1e874a,_0x53420e){return _0x1e874a||_0x53420e;};const _0x12c961=_0xffb1ee;if(Array['isArray'](_0x3726cb))return _0x3726cb;function _0x308711(_0x1aaa9e,_0x4303b3,_0x1882b9,_0x4e15f8){return _0x43dd(_0x4e15f8-0x3d3,_0x1aaa9e);}return[{'type':_0x12c961['xnXvd'],'text':_0x12c961[_0x4b3ba6(0x464,0x475,0x44b,0x49c)](_0x3726cb,'')}];}export function replacePlaceholder(_0x4408d0,_0x22aa04,_0x318e03,_0x35f388){const _0x27a4b8={'GrRqb':function(_0x492d88,_0x14761b,_0x1aa346,_0x147994){return _0x492d88(_0x14761b,_0x1aa346,_0x147994);},'SuClv':function(_0xbafba5,_0xa3bca9,_0x2e6e53,_0x3e1d7c){return _0xbafba5(_0xa3bca9,_0x2e6e53,_0x3e1d7c);},'LzutN':function(_0x4471c1,_0x3b94ce){return _0x4471c1(_0x3b94ce);},'oAwvw':_0x558da5(0x1dd,0x198,0x1ca,0x1e6),'yrelD':function(_0x49e936,_0x4f323f){return _0x49e936===_0x4f323f;},'ieDrx':_0x558da5(0x156,0x1a0,0x1ea,0x17a),'NwduG':'qbQSX','uiDoE':function(_0x1375b9,_0x2d14c1){return _0x1375b9!==_0x2d14c1;},'mXceO':'OlyzD','DoGzv':function(_0x1259c3,_0x4ac6c3,_0x59b07c,_0x394733,_0x361515){return _0x1259c3(_0x4ac6c3,_0x59b07c,_0x394733,_0x361515);}};function _0x558da5(_0x4b9f1c,_0xa6da2b,_0xb4ab79,_0x11e542){return _0x43dd(_0xa6da2b-0x3c,_0xb4ab79);}function _0x37db75(_0xd527f,_0x2e8890,_0x5f27d3,_0x232102){return _0x43dd(_0x232102- -0x1b,_0xd527f);}if(typeof _0x4408d0===_0x27a4b8[_0x37db75(0x1b4,0x1b8,0x148,0x161)]){if(_0x318e03&&_0x4408d0[_0x37db75(0x11c,0xda,0xfb,0xf7)](_0x22aa04)){if(_0x35f388){if(_0x27a4b8[_0x37db75(0x173,0x1c4,0x191,0x1a3)](_0x558da5(0x1ba,0x1a0,0x14f,0x18e),_0x27a4b8[_0x37db75(0x1ad,0x153,0x18d,0x18f)]))_0x35f388[_0x37db75(0x164,0x191,0x132,0x14b)](_0x22aa04);else{if(!_0x190bd1||_0x18608f[_0x558da5(0x14d,0x156,0x16f,0x107)]===-0x11b3+-0x119*-0x1+-0x109a*-0x1)return _0x34b39b;const _0x5d2f4d=_0x50a572();return!_0x5d2f4d[_0x37db75(0xf5,0xb7,0x12f,0x107)+'ta']&&(_0x5d2f4d[_0x558da5(0x120,0x15e,0x10e,0x162)+'ta']={}),!_0x5d2f4d[_0x558da5(0x122,0x15e,0x158,0x109)+'ta'][_0x558da5(0x1ae,0x1bd,0x1bd,0x1b5)]&&(_0x5d2f4d[_0x37db75(0x151,0x103,0x111,0x107)+'ta']['variables']={}),_0x211839['map'](_0xbb330d=>{function _0x41288e(_0x419326,_0x71af40,_0x1ae8d8,_0x5dd08b){return _0x558da5(_0x419326-0x1f1,_0x71af40-0x28b,_0x419326,_0x5dd08b-0x11b);}function _0x39dd20(_0x1ae803,_0x3dad9d,_0x16b420,_0xfa4d28){return _0x558da5(_0x1ae803-0x9e,_0x16b420-0x6,_0x1ae803,_0xfa4d28-0x152);}if(!_0xbb330d||!_0xbb330d[_0x41288e(0x3e9,0x40b,0x3f8,0x41d)])return _0xbb330d;return{..._0xbb330d,'content':_0x27a4b8[_0x39dd20(0x108,0x151,0x15a,0x15a)](_0x52ea56,_0xbb330d[_0x41288e(0x3c1,0x40b,0x3d9,0x400)],_0x5d2f4d,_0x1e7104)};});}}}return _0x4408d0['replaceAll'](_0x22aa04,_0x318e03||'');}if(Array[_0x558da5(0x1fa,0x1f7,0x24f,0x1e7)](_0x4408d0)){if(_0x27a4b8[_0x558da5(0x1e0,0x1fa,0x225,0x24c)]('PCxbn',_0x27a4b8[_0x558da5(0x163,0x16e,0x136,0x177)])){if(!_0x373428||!_0x28433f['content'])return _0x7aadd0;return{..._0x44788a,'content':_0x27a4b8['SuClv'](_0x14c13b,_0x5b189b[_0x37db75(0x132,0xf7,0xe2,0x129)],_0x135aa2,_0x4b7849)};}else return _0x4408d0[_0x558da5(0x17d,0x169,0x127,0x114)](_0x50a6b6=>replacePlaceholder(_0x50a6b6,_0x22aa04,_0x318e03,_0x35f388));}if(_0x4408d0&&_0x27a4b8[_0x558da5(0x1e0,0x1fa,0x1a4,0x21a)](typeof _0x4408d0,_0x558da5(0x192,0x1e1,0x1a7,0x209))){const _0x358cfc={};for(const _0x59abe1 in _0x4408d0){if(_0x27a4b8[_0x558da5(0x13d,0x179,0x166,0x176)](_0x27a4b8[_0x37db75(0x155,0x13a,0x15c,0x178)],_0x27a4b8[_0x37db75(0x154,0x145,0x122,0x178)])){const _0x61465d=_0x3ee6df[_0x37db75(0x15d,0x13c,0x158,0x12d)](),_0x31cf9b=_0x4f873f(_0x61465d)||'';return _0x4ffdec[_0x558da5(0x1a9,0x17b,0x137,0x16d)](_0x558da5(0x14c,0x18f,0x18e,0x160)+_0x37db75(0x199,0x196,0x1af,0x16d)+'tworldvar:'+'\x20'+_0x61465d+_0x37db75(0x18e,0x1a4,0x10f,0x153)+_0x27a4b8['LzutN'](_0x36dc72,_0x31cf9b)[_0x558da5(0x225,0x1db,0x1d9,0x1a2)](0x37*0x10+-0x8bb+0x54b,0x2533+-0x107c+-0x1485)+_0x37db75(0x15d,0x19d,0x1cc,0x17d)),_0x36330a&&_0x2cfde6[_0x558da5(0x158,0x1a2,0x1c0,0x167)](_0x37db75(0xfa,0x132,0xe5,0x131)+_0x37db75(0x17a,0x199,0x183,0x19f)+_0x61465d+'@}'),_0x31cf9b;}else _0x358cfc[_0x59abe1]=_0x27a4b8[_0x558da5(0x1fe,0x1af,0x178,0x15d)](replacePlaceholder,_0x4408d0[_0x59abe1],_0x22aa04,_0x318e03,_0x35f388);}return _0x358cfc;}return _0x4408d0;}export function replaceAllPlaceholders(_0x2bfeb6,_0x938ff8){const _0x40b70c={'hMtAE':_0x55aa8b(0x149,0x15d,0x11c,0x158),'tgzZp':_0x504bbc(0x361,0x36b,0x38f,0x330),'lwUby':function(_0x5735b7,_0x26fba9,_0x28c6be,_0x508aa9){return _0x5735b7(_0x26fba9,_0x28c6be,_0x508aa9);},'sFHsJ':_0x504bbc(0x3b2,0x35f,0x3b7,0x35f),'HvIFZ':_0x504bbc(0x388,0x39a,0x38c,0x35a),'uUSIU':function(_0xea2fe3,_0x273937,_0xcfd7b6,_0x5af8a7,_0x2746b1){return _0xea2fe3(_0x273937,_0xcfd7b6,_0x5af8a7,_0x2746b1);},'prLqV':_0x504bbc(0x392,0x351,0x357,0x38e),'XXmiO':_0x55aa8b(0x126,0xf9,0xe3,0xdc),'pavhd':function(_0x4da4b3,_0x11b624,_0x2bf822,_0x485671,_0x3e17a4){return _0x4da4b3(_0x11b624,_0x2bf822,_0x485671,_0x3e17a4);},'soWir':_0x55aa8b(0x72,0x111,0xbf,0xc7),'ZwLAG':function(_0x35f7f0,_0x2dc2ac,_0x4fb0eb,_0x491588,_0x17bfff){return _0x35f7f0(_0x2dc2ac,_0x4fb0eb,_0x491588,_0x17bfff);},'BJbNT':'{{角色启用列表}}','dSBOc':_0x504bbc(0x395,0x3b5,0x3c9,0x3b6)+'}}','SoqbU':_0x504bbc(0x30f,0x367,0x3b4,0x312)+'}}','ufGlH':_0x55aa8b(0xd5,0xe2,0x10d,0x108),'KiAtJ':function(_0x1d9ec4,_0x2a9e2d){return _0x1d9ec4===_0x2a9e2d;},'SRBSZ':_0x504bbc(0x401,0x3ab,0x3b7,0x3a2),'tGEnW':function(_0x292a07,_0x2c8c92,_0x3b5317,_0x15becc,_0x2519f6){return _0x292a07(_0x2c8c92,_0x3b5317,_0x15becc,_0x2519f6);},'jsQeb':function(_0xac57b9,_0x56b969,_0x957434){return _0xac57b9(_0x56b969,_0x957434);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x938ff8,_0x481361=new Set();let _0x1d2de7=_0x2bfeb6;const _0x3729b3=getContext(),_0x4ec591=_0x3729b3?.['name1']||'';let _0x18118c=worldBookContent;_0x18118c&&(_0x18118c=_0x18118c[_0x55aa8b(0x90,0xcd,0xdb,0xbd)](_0x40b70c['sFHsJ'],_0x4ec591),_0x18118c=_0x18118c['replaceAll'](_0x40b70c['HvIFZ'],_0x4ec591));_0x1d2de7=_0x40b70c[_0x504bbc(0x318,0x337,0x366,0x300)](replacePlaceholder,_0x1d2de7,_0x40b70c[_0x504bbc(0x39f,0x3b2,0x3c8,0x3a3)],context,_0x481361),_0x1d2de7=_0x40b70c[_0x504bbc(0x37b,0x337,0x300,0x340)](replacePlaceholder,_0x1d2de7,_0x40b70c[_0x55aa8b(0x182,0x114,0x155,0x139)],_0x18118c,_0x481361),_0x1d2de7=_0x40b70c[_0x504bbc(0x3a3,0x368,0x3bb,0x311)](replacePlaceholder,_0x1d2de7,_0x40b70c['soWir'],body,_0x481361);function _0x504bbc(_0x26ec79,_0x44c3c2,_0x4de78e,_0x859cb9){return _0x43dd(_0x44c3c2-0x20f,_0x859cb9);}function _0x55aa8b(_0x566ee4,_0x144e66,_0x5c7720,_0x2d063d){return _0x43dd(_0x5c7720- -0x6a,_0x2d063d);}_0x1d2de7=_0x40b70c[_0x55aa8b(0xe7,0x8c,0xcc,0x107)](replacePlaceholder,_0x1d2de7,_0x40b70c['BJbNT'],characterListText,_0x481361),_0x1d2de7=_0x40b70c[_0x504bbc(0x337,0x368,0x372,0x360)](replacePlaceholder,_0x1d2de7,_0x40b70c[_0x55aa8b(0x12d,0x151,0x10e,0xcb)],outfitEnableListText,_0x481361),_0x1d2de7=replacePlaceholder(_0x1d2de7,_0x40b70c['SoqbU'],commonCharacterListText,_0x481361),_0x1d2de7=replacePlaceholder(_0x1d2de7,_0x40b70c[_0x55aa8b(0xc0,0xca,0xd2,0x117)],userDemand,_0x481361);if(variables&&Object['keys'](variables)[_0x504bbc(0x2d5,0x329,0x37b,0x378)]>-0x5*-0x5ab+0x2293+0x1*-0x3eea){if(_0x40b70c[_0x504bbc(0x41f,0x3cc,0x3b1,0x3e2)](_0x40b70c[_0x504bbc(0x3d8,0x3c4,0x41b,0x370)],_0x40b70c[_0x55aa8b(0x132,0x154,0x14b,0x11b)])){const _0x281629=/\{\{getvar::([^}]+)\}\}/g,_0x357e87=JSON[_0x55aa8b(0x107,0x191,0x148,0x17c)](_0x1d2de7),_0x3367fa=[..._0x357e87['matchAll'](_0x281629)],_0x137d64=new Set();for(const _0x1179d0 of _0x3367fa){_0x137d64[_0x55aa8b(0x112,0xe1,0xfc,0xc8)](_0x1179d0[0x20bf+-0x1539*0x1+-0x1*0xb85]);}for(const _0x2a2769 of _0x137d64){const _0x3eec1d=_0x504bbc(0x306,0x32c,0x334,0x30e)+_0x2a2769+'}}',_0x20c3af=variables[_0x2a2769]||'';_0x1d2de7=_0x40b70c[_0x504bbc(0x378,0x3a5,0x3f1,0x37d)](replacePlaceholder,_0x1d2de7,_0x3eec1d,_0x20c3af,_0x481361);}}else return _0x1610ed['map'](_0x4336c5=>{function _0x558ccf(_0x41811b,_0x32048b,_0x4c3bfc,_0x2c0e35){return _0x504bbc(_0x41811b-0xb6,_0x4c3bfc- -0x4e4,_0x4c3bfc-0x101,_0x2c0e35);}if(_0x4336c5&&_0x4336c5[_0x558ccf(-0x1bf,-0x147,-0x177,-0x18c)]===_0x40b70c[_0x4b2856(0x237,0x28b,0x24f,0x25c)]&&typeof _0x4336c5[_0x558ccf(-0x142,-0x184,-0x14f,-0x155)]===_0x40b70c['tgzZp'])return{..._0x4336c5,'text':_0x40b70c[_0x4b2856(0x284,0x295,0x2c2,0x2c7)](_0x3ba6ae,_0x4336c5[_0x4b2856(0x313,0x2ec,0x2bf,0x2aa)],_0x35f5e4,_0x4d39f6)};function _0x4b2856(_0x3e5e9a,_0x3077ac,_0x5e6eef,_0x558a8b){return _0x504bbc(_0x3e5e9a-0x16c,_0x3077ac- -0xa9,_0x5e6eef-0x12e,_0x5e6eef);}return _0x4336c5;});}_0x1d2de7=_0x40b70c['jsQeb'](processVariablePlaceholdersInMessages,_0x1d2de7,_0x481361);const _0x1cfeca={};return _0x1cfeca[_0x55aa8b(0x185,0x11e,0x143,0x11d)]=_0x1d2de7,_0x1cfeca['replacedVa'+'riables']=_0x481361,_0x1cfeca;}function processVariablePlaceholdersInMessages(_0x1a20ab,_0xa526cc){const _0x49e203={'MxfYF':function(_0x314bbe,_0x4a426e,_0x237aa3,_0x3736df){return _0x314bbe(_0x4a426e,_0x237aa3,_0x3736df);},'KliLd':function(_0x4f25b7,_0x1bb0b3){return _0x4f25b7===_0x1bb0b3;},'yUPvh':_0x3b073c(0x2c7,0x2ec,0x303,0x30c)};function _0x8e2750(_0xc19354,_0x1f6c74,_0x1fb830,_0x2eb046){return _0x43dd(_0x2eb046- -0x77,_0x1fb830);}if(!_0x1a20ab||_0x49e203[_0x8e2750(0xce,0x11e,0x13a,0x104)](_0x1a20ab[_0x3b073c(0x303,0x31a,0x29c,0x2f3)],0x361+-0x1891+0x1530))return _0x1a20ab;const _0x166180=getContext();if(!_0x166180['chatMetada'+'ta']){if(_0x49e203['KliLd'](_0x49e203['yUPvh'],_0x3b073c(0x319,0x327,0x2c5,0x30c)))_0x166180[_0x8e2750(0xac,0x61,0x104,0xab)+'ta']={};else{const _0x359cc6=_0x19366e?function(){function _0x5e0e6c(_0x1c7570,_0x411bd6,_0x3023f7,_0x22390d){return _0x3b073c(_0x411bd6,_0x411bd6-0xbc,_0x3023f7-0xec,_0x1c7570-0x108);}if(_0x932d46){const _0x1da320=_0x565bd9[_0x5e0e6c(0x3fc,0x3f9,0x415,0x436)](_0x291f1f,arguments);return _0x265345=null,_0x1da320;}}:function(){};return _0x556717=![],_0x359cc6;}}function _0x3b073c(_0x22ed03,_0x20c772,_0x230fe0,_0x3cf232){return _0x43dd(_0x3cf232-0x1d9,_0x22ed03);}return!_0x166180['chatMetada'+'ta'][_0x8e2750(0xfb,0x14d,0xc0,0x10a)]&&(_0x166180[_0x8e2750(0xc3,0xd3,0x55,0xab)+'ta'][_0x3b073c(0x346,0x37e,0x318,0x35a)]={}),_0x1a20ab[_0x3b073c(0x2d1,0x2c4,0x33b,0x306)](_0x5072fb=>{function _0x2473e3(_0x98706a,_0x6ac270,_0x451d5d,_0x478742){return _0x3b073c(_0x451d5d,_0x6ac270-0x132,_0x451d5d-0x18d,_0x6ac270- -0x213);}function _0x49633b(_0x1ce0c1,_0x4e635e,_0x16e73c,_0x59a646){return _0x8e2750(_0x1ce0c1-0x6c,_0x4e635e-0xfc,_0x1ce0c1,_0x4e635e- -0x23);}if(!_0x5072fb||!_0x5072fb[_0x2473e3(0x115,0x10a,0xc0,0xd9)])return _0x5072fb;return{..._0x5072fb,'content':_0x49e203['MxfYF'](processContentVariables,_0x5072fb[_0x49633b(0xfd,0xaa,0xd9,0xb9)],_0x166180,_0xa526cc)};});}function processContentVariables(_0x41ca58,_0x5c100d,_0x82c563){const _0x2dfc83={'idYfK':function(_0xebca6a,_0x40dbb2){return _0xebca6a(_0x40dbb2);},'wkwmF':_0x295613(-0x31,-0x4d,-0x68,-0x4c),'CaoUw':_0x87b737(-0xa,0x4a,-0xc,0xa),'sanuY':function(_0x47ba40,_0x48eeab){return _0x47ba40===_0x48eeab;},'iUCAu':function(_0x55cacb,_0x5d7cad){return _0x55cacb===_0x5d7cad;},'utmGN':'string','XlIyT':function(_0x8cd4aa,_0x4d2393){return _0x8cd4aa!==_0x4d2393;},'oVrsc':_0x295613(-0xf0,-0xdc,-0x94,-0x94),'xcQQa':function(_0x102330,_0x1166dc,_0x34ce48,_0x3814d6){return _0x102330(_0x1166dc,_0x34ce48,_0x3814d6);},'qgRvL':_0x87b737(-0x25,-0x34,-0x8b,-0x3c),'KJrdB':_0x87b737(-0x52,-0x41,0x15,-0x15)};if(_0x2dfc83[_0x87b737(-0x27,-0x4f,-0x31,-0xd)](typeof _0x41ca58,_0x2dfc83[_0x87b737(-0x2b,-0x42,-0x1c,-0x43)])){if(_0x2dfc83[_0x87b737(-0x18,-0x1a,-0x60,-0x26)]('XUvXo',_0x2dfc83['oVrsc']))return _0x2dfc83['xcQQa'](processStringVariables,_0x41ca58,_0x5c100d,_0x82c563);else{const _0x4ba73d={};return _0x4ba73d['requestTyp'+'e']=_0x36153a,_0x4ba73d[_0x295613(-0x8d,-0xac,-0xa9,-0xf7)+'a']=_0x422772,_0x2dfc83[_0x295613(-0x65,-0x76,-0x1f,-0x68)](_0x2b685a,_0x4ba73d);}}function _0x87b737(_0x4c0e63,_0x3a3960,_0x547ab1,_0x105704){return _0x43dd(_0x105704- -0x17c,_0x3a3960);}if(Array[_0x87b737(0x22,0x41,-0xc,0x3f)](_0x41ca58)){if(_0x2dfc83['XlIyT'](_0x2dfc83['qgRvL'],_0x2dfc83['KJrdB']))return _0x41ca58[_0x295613(-0xf3,-0xce,-0x10f,-0xe9)](_0x9748b4=>{function _0x4f0cef(_0x20e69d,_0x5d7b74,_0x3f60dd,_0x2df307){return _0x87b737(_0x20e69d-0x11,_0x5d7b74,_0x3f60dd-0x17f,_0x2df307-0x7);}function _0x58e914(_0x1a6fad,_0x175162,_0x45fd12,_0x4752ab){return _0x87b737(_0x1a6fad-0x119,_0x45fd12,_0x45fd12-0x5f,_0x175162-0x51d);}if(_0x4f0cef(0x0,0xa,-0x83,-0x3e)!==_0x2dfc83['wkwmF']){if(_0x9748b4&&_0x9748b4[_0x58e914(0x4f3,0x4ff,0x4cc,0x503)]===_0x2dfc83[_0x58e914(0x521,0x557,0x59a,0x56b)]&&_0x2dfc83['sanuY'](typeof _0x9748b4[_0x58e914(0x4e6,0x527,0x56d,0x51f)],'string'))return{..._0x9748b4,'text':processStringVariables(_0x9748b4[_0x4f0cef(0x4e,0x57,-0x40,0x11)],_0x5c100d,_0x82c563)};return _0x9748b4;}else return{..._0x137224,'text':_0x18dd64(_0x3fe746[_0x4f0cef(0x22,0x52,0x62,0x11)],_0x2c5576,_0x25fb34)};});else _0x58f400[_0x295613(-0x52,-0x95,-0x6f,-0x56)](_0x295613(-0x17,-0x4f,-0x74,0x4)+_0x87b737(0x29,-0x18,0x18,-0x27)+_0x32d72a+'@}');}function _0x295613(_0x289865,_0x39e747,_0x159c24,_0x20acd9){return _0x43dd(_0x39e747- -0x1fb,_0x289865);}return _0x41ca58;}function processStringVariables(_0x5158a9,_0x19e2d4,_0x9ff373){const _0x869bbe={'ukphX':function(_0x25d4a5,_0x1fd3ca){return _0x25d4a5(_0x1fd3ca);},'CYzjf':function(_0x1aeb0c,_0x3384ae){return _0x1aeb0c!==_0x3384ae;},'ZaYie':'vkUeM','HlqnV':function(_0x407ed8,_0x142d15,_0x2c8d4c){return _0x407ed8(_0x142d15,_0x2c8d4c);},'zNIGx':function(_0x16afaf,_0x167b56){return _0x16afaf===_0x167b56;},'nUPxj':_0x398cb6(-0xca,-0xc9,-0xed,-0x117),'LqyMX':function(_0x4d66fa,_0x38725e){return _0x4d66fa===_0x38725e;},'KHXej':_0x26a36b(0x51e,0x559,0x55d,0x4e6),'XvEcL':function(_0x51b2c9,_0x3883b5){return _0x51b2c9===_0x3883b5;},'MSFrM':'string','iaoTq':function(_0xd758f,_0x3a4b55,_0x5c0c4e,_0x590f1f){return _0xd758f(_0x3a4b55,_0x5c0c4e,_0x590f1f);},'xlwld':_0x26a36b(0x4ea,0x4a2,0x509,0x518),'gbgKp':_0x398cb6(-0x33,-0x61,-0x6b,-0x88),'jMOBZ':_0x26a36b(0x4e6,0x4d8,0x4a7,0x491),'LvuXc':function(_0x3f77dc,_0x11aa29){return _0x3f77dc(_0x11aa29);},'NgzBo':function(_0x279cc3,_0x585b52){return _0x279cc3(_0x585b52);},'sSOVL':function(_0x25942f,_0x3556e4){return _0x25942f===_0x3556e4;},'bBZiO':_0x26a36b(0x4a9,0x4a6,0x4f6,0x4a7)};if(!_0x5158a9)return _0x5158a9;let _0x589a4d=_0x5158a9;function _0x398cb6(_0x43c94e,_0x315164,_0x228231,_0x4788f7){return _0x43dd(_0x315164- -0x210,_0x228231);}function _0x26a36b(_0x5cf8c9,_0x285801,_0x1de385,_0x36fe2d){return _0x43dd(_0x5cf8c9-0x398,_0x36fe2d);}return _0x589a4d=_0x589a4d[_0x26a36b(0x54b,0x524,0x55b,0x50d)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x332523,_0x6bd945,_0x257eb8)=>{function _0x4deee4(_0x11f8ff,_0x5b1fb0,_0x3477c1,_0x4b7a6c){return _0x398cb6(_0x11f8ff-0x81,_0x3477c1-0x520,_0x11f8ff,_0x4b7a6c-0x104);}function _0x36f3d8(_0x1e2039,_0x507912,_0x10fa5e,_0x25e1ea){return _0x398cb6(_0x1e2039-0x1ef,_0x1e2039-0x220,_0x10fa5e,_0x25e1ea-0x16e);}const _0x7b397c=_0x6bd945['trim']();return console[_0x4deee4(0x408,0x40d,0x44f,0x454)](_0x4deee4(0x493,0x48b,0x463,0x493)+_0x4deee4(0x4c9,0x488,0x489,0x4e1)+_0x36f3d8(0x185,0x199,0x1d4,0x1cb)+_0x7b397c+_0x36f3d8(0x137,0x169,0xf3,0x18d)+_0x257eb8[_0x36f3d8(0x1af,0x1f1,0x169,0x18b)](-0x1*0x1819+-0x4ab+0x4*0x731,0x26d1+-0x63a*-0x3+-0x394d*0x1)+_0x36f3d8(0x1a8,0x1bd,0x180,0x166)),_0x19e2d4[_0x4deee4(0x488,0x478,0x432,0x3e7)+'ta'][_0x4deee4(0x45e,0x476,0x491,0x491)][_0x7b397c]=_0x257eb8,_0x9ff373&&_0x9ff373[_0x4deee4(0x46d,0x47a,0x476,0x466)](_0x4deee4(0x406,0x416,0x430,0x480)+_0x7b397c+'@}'),'';}),_0x589a4d=_0x589a4d[_0x26a36b(0x54b,0x593,0x55c,0x589)](/\{@getvar::([^@]+)@\}/g,(_0x3a641b,_0x21c82c)=>{const _0x9676f5=_0x21c82c[_0x159ae4(-0x202,-0x227,-0x240,-0x234)](),_0x388e84=_0x19e2d4['chatMetada'+'ta'][_0x5a4cba(0x470,0x466,0x4ae,0x46c)][_0x9676f5]||'';function _0x5a4cba(_0x31d6db,_0x4bc337,_0xa0d746,_0x482b1c){return _0x26a36b(_0x4bc337- -0xb3,_0x4bc337-0xd3,_0xa0d746-0x16f,_0xa0d746);}console[_0x159ae4(-0x24d,-0x271,-0x230,-0x23d)](_0x159ae4(-0x1f1,-0x273,-0x211,-0x229)+_0x159ae4(-0x1d4,-0x20a,-0x21d,-0x1f4)+'tvar:\x20'+_0x9676f5+_0x159ae4(-0x231,-0x228,-0x1db,-0x20e)+_0x869bbe[_0x5a4cba(0x458,0x499,0x46d,0x4ef)](String,_0x388e84)[_0x5a4cba(0x42d,0x484,0x4d2,0x4ab)](0x4fc+-0x4*0x76f+0x10*0x18c,-0x14dc+0xff3*-0x2+0x34f4)+_0x159ae4(-0x1c0,-0x1dc,-0x20d,-0x1e4));function _0x159ae4(_0x884a80,_0x8314ff,_0x183d9a,_0x3daff8){return _0x398cb6(_0x884a80-0x19c,_0x3daff8- -0x16c,_0x884a80,_0x3daff8-0x123);}return _0x9ff373&&(_0x869bbe['CYzjf']('vkUeM',_0x869bbe['ZaYie'])?_0x568265['add']('{@getworld'+'var::'+_0x20075b+'@}'):_0x9ff373[_0x5a4cba(0x42f,0x44b,0x411,0x486)]('{@getvar::'+_0x9676f5+'@}')),_0x388e84;}),_0x589a4d=_0x589a4d[_0x26a36b(0x54b,0x544,0x506,0x55b)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0xe664e2,_0x50a8b1,_0x1f47a0)=>{const _0x49906f=_0x50a8b1[_0x3b317f(-0x150,-0x1ab,-0x15e,-0x15c)]();console['log'](_0x3b317f(-0x19e,-0x1a9,-0x11e,-0x151)+'cessor]\x20se'+_0x3b317f(-0x159,-0xea,-0x14e,-0x106)+':\x20'+_0x49906f+'\x20=\x20'+_0x1f47a0[_0x536fc6(0x22d,0x21c,0x225,0x234)](-0x159e+0xbf4+0x4d5*0x2,-0x11c1*-0x2+0x771+-0x2ac1)+_0x536fc6(0x245,0x1eb,0x21e,0x1c8)),_0x869bbe[_0x536fc6(0x1f5,0x1e3,0x228,0x25f)](setglobalvar,_0x49906f,_0x1f47a0);if(_0x9ff373){if(_0x869bbe[_0x536fc6(0x248,0x1e2,0x21b,0x1c4)](_0x3b317f(-0x10b,-0xd9,-0x14a,-0x110),_0x869bbe[_0x3b317f(-0x1b4,-0x136,-0x1ac,-0x186)]))return!![];else _0x9ff373[_0x536fc6(0x20b,0x229,0x1ec,0x1be)]('{@setgloba'+'lvar::'+_0x49906f+'@}');}function _0x536fc6(_0x31e5b6,_0x5f058c,_0x75e57a,_0x41acbb){return _0x26a36b(_0x75e57a- -0x312,_0x5f058c-0xe8,_0x75e57a-0x186,_0x41acbb);}function _0x3b317f(_0x1d9dde,_0x30577f,_0x1079be,_0x1e280f){return _0x398cb6(_0x1d9dde-0x113,_0x1e280f- -0x94,_0x30577f,_0x1e280f-0x142);}return'';}),_0x589a4d=_0x589a4d[_0x398cb6(-0xa7,-0x5d,-0x4e,-0x70)](/\{@getglobalvar::([^@]+)@\}/g,(_0x5cfd85,_0x1fb644)=>{function _0x5d6f4b(_0x2d09fd,_0x3c06c3,_0x188b1f,_0x2b2933){return _0x398cb6(_0x2d09fd-0xed,_0x2d09fd-0x5d6,_0x188b1f,_0x2b2933-0x12c);}function _0x13e0bf(_0x2f9f6f,_0x390f47,_0x112837,_0x2ce25f){return _0x26a36b(_0x2f9f6f- -0x32e,_0x390f47-0x51,_0x112837-0x2e,_0x112837);}if('wZBeq'!==_0x869bbe[_0x13e0bf(0x17a,0x16e,0x130,0x157)]){const _0x4ecff1=_0x1fb644['trim'](),_0x26ac84=_0x869bbe['ukphX'](getglobalvar,_0x4ecff1)||'';return console[_0x5d6f4b(0x505,0x544,0x533,0x504)](_0x5d6f4b(0x519,0x514,0x4ec,0x4de)+_0x13e0bf(0x1f2,0x1d4,0x1b7,0x1ce)+_0x5d6f4b(0x564,0x525,0x591,0x53a)+':\x20'+_0x4ecff1+_0x13e0bf(0x1d8,0x220,0x212,0x1e0)+_0x869bbe[_0x13e0bf(0x21e,0x243,0x21c,0x1cb)](String,_0x26ac84)['substring'](-0xd56+0x201+0xb55,0x2*-0xa49+-0x59*-0x18+-0x109*-0xc)+_0x13e0bf(0x202,0x225,0x204,0x23a)),_0x9ff373&&(_0x869bbe[_0x5d6f4b(0x53c,0x54e,0x56a,0x527)](_0x869bbe[_0x5d6f4b(0x4f2,0x4eb,0x4d5,0x4db)],_0x869bbe[_0x5d6f4b(0x537,0x55c,0x575,0x56c)])?_0x9ff373[_0x5d6f4b(0x52c,0x4d6,0x4d9,0x52a)](_0x5d6f4b(0x572,0x5bb,0x52d,0x52a)+_0x13e0bf(0x1bf,0x1a3,0x1ca,0x1a7)+_0x4ecff1+'@}'):_0x5baa85['add'](_0x5d6f4b(0x571,0x558,0x52a,0x5a6)+_0x5d6f4b(0x51b,0x4ca,0x529,0x574)+_0x43e6b3+'@}')),_0x26ac84;}else{if(_0x5e87e1&&_0x869bbe['LqyMX'](_0x3b6ce2[_0x5d6f4b(0x524,0x4fd,0x4ea,0x4f2)],_0x869bbe[_0x5d6f4b(0x552,0x566,0x53e,0x594)])&&_0x869bbe[_0x13e0bf(0x205,0x249,0x1b7,0x1e7)](typeof _0x169ad6[_0x13e0bf(0x1f0,0x208,0x22a,0x223)],_0x869bbe[_0x5d6f4b(0x55f,0x5a8,0x57a,0x54c)]))return{..._0x546181,'text':_0x869bbe[_0x5d6f4b(0x517,0x521,0x520,0x4d2)](_0x32d561,_0x3007d8[_0x13e0bf(0x1f0,0x221,0x1cb,0x1ca)],_0x1b2c70,_0x20482d)};return _0x5e632d;}}),_0x589a4d=_0x589a4d[_0x26a36b(0x54b,0x517,0x58f,0x531)](/\{@getworldvar::([^@]+)@\}/g,(_0x5a016e,_0x4c936a)=>{const _0x4fcf4c=_0x4c936a[_0xef209c(-0x136,-0x1c8,-0x14c,-0x18e)](),_0x82b1b5=_0x869bbe[_0x50e663(0x183,0x188,0x178,0x18f)](getworldvar,_0x4fcf4c)||'';console['log'](_0xef209c(-0x15c,-0x1c3,-0x161,-0x183)+_0x50e663(0x1ad,0x1cd,0x1cf,0x18f)+'tworldvar:'+'\x20'+_0x4fcf4c+_0x50e663(0x1e8,0x1ec,0x1b5,0x1a6)+_0x869bbe['NgzBo'](String,_0x82b1b5)[_0xef209c(-0x116,-0x134,-0x185,-0x137)](-0x284*-0xe+0x1a97*0x1+0x3dcf*-0x1,0xd5e+0xdc1+-0x1aed*0x1)+_0xef209c(-0x132,-0xfb,-0x173,-0x13e));if(_0x9ff373){if(_0x869bbe[_0x50e663(0x1e9,0x1ae,0x1b9,0x1e1)](_0xef209c(-0x1f2,-0x208,-0x214,-0x1c5),_0x869bbe[_0xef209c(-0x180,-0x1d5,-0x1d5,-0x193)]))_0x9ff373[_0x50e663(0x1c3,0x19c,0x1ad,0x180)](_0xef209c(-0x146,-0x140,-0x15c,-0x18a)+_0x50e663(0x1cb,0x1b9,0x201,0x23f)+_0x4fcf4c+'@}');else{const _0x3f1ff2=_0x236bfa['apply'](_0x2246e5,arguments);return _0x3d5f28=null,_0x3f1ff2;}}function _0xef209c(_0x3a75bf,_0x7e4d3d,_0x723fc9,_0x577a74){return _0x26a36b(_0x577a74- -0x66e,_0x7e4d3d-0x2,_0x723fc9-0x11d,_0x3a75bf);}function _0x50e663(_0x23cac5,_0x1dda33,_0x3bf46f,_0x3715ae){return _0x26a36b(_0x3bf46f- -0x351,_0x1dda33-0x1d8,_0x3bf46f-0x1c9,_0x3715ae);}return _0x82b1b5;}),_0x589a4d;}export function buildPromptWithTrigger(_0x517a3c){const _0x191e2f={'tnsAN':function(_0x552e8a,_0x423947){return _0x552e8a===_0x423947;},'awolE':'trigger','FMvwB':function(_0x6bf49a,_0x347443,_0x256e95){return _0x6bf49a(_0x347443,_0x256e95);},'xJybY':'user','BmueY':function(_0x17088b,_0x344af8){return _0x17088b===_0x344af8;},'jJeoG':_0x1710d1(0x433,0x3cd,0x411,0x40c),'tixqc':_0x58ca39(-0x290,-0x222,-0x241,-0x27a),'PkpCV':function(_0x1e511b,_0xed1feb){return _0x1e511b!==_0xed1feb;},'ZwcWt':function(_0x7d3fb6,_0x6d1213){return _0x7d3fb6!==_0x6d1213;},'DuTCE':_0x58ca39(-0x251,-0x24c,-0x268,-0x257),'zueZU':function(_0x5d7a5d,_0x55817f){return _0x5d7a5d(_0x55817f);},'eeDEO':_0x58ca39(-0x25d,-0x2bc,-0x26c,-0x2c2)+_0x58ca39(-0x2cd,-0x2dd,-0x2a8,-0x252)+'完成:'},{requestType:_0x1e2a87,contextData:_0x28cf93}=_0x517a3c,_0xf6e1ef=extension_settings[extensionName]?.[_0x1710d1(0x49b,0x4ad,0x4ad,0x472)+_0x1710d1(0x440,0x3df,0x3ae,0x3ef)+_0x58ca39(-0x2a3,-0x27d,-0x299,-0x2ca)]||{};function _0x58ca39(_0x4e6492,_0x2bd2ed,_0x4b7f53,_0x399021){return _0x43dd(_0x4b7f53- -0x3bf,_0x399021);}const _0x5e5b40={};_0x5e5b40[_0x1710d1(0x48a,0x432,0x48d,0x451)+_0x1710d1(0x486,0x415,0x3f4,0x444)]='默认';const _0x428eba=_0xf6e1ef[_0x1e2a87]||_0x5e5b40,_0x13ca59=_0x428eba['context_pr'+_0x58ca39(-0x1e9,-0x256,-0x23c,-0x27e)]||'默认';function _0x1710d1(_0x16cf6d,_0x181c5d,_0x15588b,_0x4a5ca7){return _0x43dd(_0x4a5ca7-0x2c1,_0x16cf6d);}const _0x1741d3=extension_settings[extensionName]?.['test_conte'+_0x1710d1(0x416,0x47d,0x481,0x431)+'s']||{},_0x2840fc=_0x1741d3[_0x13ca59]||_0x1741d3[Object[_0x58ca39(-0x25b,-0x1e1,-0x21e,-0x1cc)](_0x1741d3)[0x924+0x1*-0xb6f+-0x1*-0x24b]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x28cf93,_0xbced06=[userDemand,context,body,worldBookContent][_0x58ca39(-0x20d,-0x232,-0x1ff,-0x20c)](Boolean)[_0x1710d1(0x44f,0x44c,0x420,0x452)]('\x0a'),_0x18f0d5=[];if(_0x2840fc['entries']&&Array[_0x1710d1(0x496,0x498,0x467,0x47c)](_0x2840fc[_0x1710d1(0x44a,0x3fb,0x478,0x44f)]))for(const _0x3ea4fb of _0x2840fc[_0x58ca39(-0x273,-0x1f8,-0x231,-0x21c)]){if(!_0x3ea4fb[_0x1710d1(0x415,0x3fa,0x404,0x440)])continue;if(!_0x3ea4fb[_0x58ca39(-0x2ae,-0x2cc,-0x27b,-0x264)]||_0x3ea4fb['content']['trim']()==='')continue;if(_0x191e2f[_0x58ca39(-0x294,-0x271,-0x281,-0x2a1)](_0x3ea4fb[_0x58ca39(-0x258,-0x21c,-0x217,-0x1d9)+'e'],_0x191e2f[_0x1710d1(0x3a9,0x3d2,0x3e4,0x3f9)])){if(!_0x191e2f[_0x1710d1(0x3cc,0x3eb,0x3d0,0x3d6)](checkTriggerWords,_0x3ea4fb[_0x58ca39(-0x27c,-0x232,-0x22d,-0x1dc)+'ds'],_0xbced06))continue;}const _0x241c1d={};_0x241c1d['role']=_0x3ea4fb['role']||_0x191e2f[_0x1710d1(0x410,0x3ea,0x45a,0x420)],_0x241c1d[_0x58ca39(-0x22a,-0x290,-0x27b,-0x233)]=_0x3ea4fb['content'],_0x18f0d5[_0x58ca39(-0x244,-0x277,-0x252,-0x226)](_0x241c1d);}else{if(_0x2840fc['history']&&Array[_0x58ca39(-0x1d5,-0x232,-0x204,-0x252)](_0x2840fc[_0x1710d1(0x453,0x3cd,0x419,0x424)]))for(const _0x20d68b of _0x2840fc[_0x58ca39(-0x291,-0x28d,-0x25c,-0x274)]){if(_0x191e2f[_0x58ca39(-0x294,-0x216,-0x257,-0x244)](_0x191e2f['jJeoG'],_0x191e2f[_0x1710d1(0x48b,0x47d,0x484,0x43e)])){const _0x5a2e38=_0x58ca39(-0x2ae,-0x2e6,-0x2a2,-0x2c7)+_0x1f875c+'}}',_0x4ea47d=_0x4c74f4[_0x5d3290]||'';_0x123313=_0x378a9e(_0x17c0b9,_0x5a2e38,_0x4ea47d,_0x2ce8e7);}else{if(_0x20d68b['user']&&_0x191e2f['PkpCV'](_0x20d68b[_0x58ca39(-0x228,-0x284,-0x23f,-0x292)]['trim'](),'')){const _0x55930a={};_0x55930a['role']=_0x1710d1(0x490,0x42d,0x47e,0x441),_0x55930a[_0x58ca39(-0x2c9,-0x255,-0x27b,-0x295)]=_0x20d68b[_0x1710d1(0x43b,0x439,0x403,0x441)],_0x18f0d5['push'](_0x55930a);}if(_0x20d68b[_0x58ca39(-0x24b,-0x24f,-0x268,-0x263)]&&_0x191e2f[_0x58ca39(-0x1d7,-0x211,-0x206,-0x1df)](_0x20d68b['assistant'][_0x58ca39(-0x230,-0x27c,-0x277,-0x25c)](),'')){const _0x3273c0={};_0x3273c0[_0x58ca39(-0x1da,-0x1da,-0x20f,-0x266)]=_0x191e2f['DuTCE'],_0x3273c0['content']=_0x20d68b[_0x58ca39(-0x260,-0x26e,-0x268,-0x231)],_0x18f0d5[_0x1710d1(0x44d,0x477,0x455,0x42e)](_0x3273c0);}}}}const _0x4562eb=_0x191e2f[_0x58ca39(-0x1d3,-0x252,-0x21b,-0x1e3)](mergeAdjacentMessages,_0x18f0d5),{messages:_0x28aff1,replacedVariables:_0x51641e}=replaceAllPlaceholders(_0x4562eb,_0x28cf93),_0x480165={};return _0x480165['requestTyp'+'e']=_0x1e2a87,_0x480165[_0x58ca39(-0x2e9,-0x266,-0x2a3,-0x2e3)+'nt']=_0x18f0d5[_0x58ca39(-0x283,-0x2c8,-0x2a5,-0x275)],_0x480165[_0x58ca39(-0x25b,-0x245,-0x294,-0x2ea)+'t']=_0x4562eb[_0x1710d1(0x401,0x3c3,0x433,0x3db)],_0x480165['finalCount']=_0x28aff1['length'],_0x480165[_0x58ca39(-0x25b,-0x1e2,-0x230,-0x27d)+'riables']=[..._0x51641e],console[_0x1710d1(0x3c1,0x423,0x402,0x400)](_0x191e2f[_0x1710d1(0x446,0x467,0x409,0x426)],_0x480165),_0x28aff1;}export function getProcessedPrompt(_0x293d94,_0x622c14){const _0x4d4ea0={'fQpqU':function(_0x41378d,_0xcbd1f9){return _0x41378d(_0xcbd1f9);}},_0x1ead75={};function _0x320650(_0x57a9e6,_0x1dabb9,_0x271bcf,_0x478b62){return _0x43dd(_0x478b62- -0x34f,_0x57a9e6);}_0x1ead75[_0x130dda(0x38,0xc,0x60,0x49)+'e']=_0x293d94,_0x1ead75[_0x320650(-0x210,-0x1f6,-0x1ea,-0x200)+'a']=_0x622c14;function _0x130dda(_0x2d918b,_0x2e34e9,_0x4c98cd,_0x3976d6){return _0x43dd(_0x4c98cd- -0xe9,_0x2e34e9);}return _0x4d4ea0[_0x320650(-0x1a3,-0x204,-0x1d7,-0x1db)](buildPromptWithTrigger,_0x1ead75);}