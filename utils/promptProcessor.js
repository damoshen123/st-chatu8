(function(_0x4449d9,_0x2b7603){function _0x18d62b(_0xba5aef,_0x3fea67,_0xba5611,_0x36278f){return _0x4ae5(_0xba5aef- -0xcb,_0x36278f);}const _0x1cd286=_0x4449d9();function _0x2abfbf(_0x1e783f,_0x28222b,_0x243574,_0x43532b){return _0x4ae5(_0x1e783f-0x86,_0x243574);}while(!![]){try{const _0x221249=parseInt(_0x18d62b(0x15e,0x14f,0xff,0x12a))/(0xa*-0x3d1+-0xa01+0x302c)+-parseInt(_0x18d62b(0x10f,0xec,0x13c,0x154))/(-0x25*0x3+0xe71*-0x1+-0x3*-0x4f6)+-parseInt(_0x18d62b(0x142,0x12b,0x184,0xfe))/(0x17d5*-0x1+0x17f6+-0x2*0xf)+parseInt(_0x2abfbf(0x2a5,0x250,0x2d0,0x2ee))/(-0x1*-0xd05+-0xad*0x2b+0x89*0x1e)+-parseInt(_0x18d62b(0x15a,0x117,0x11a,0x150))/(0x25c3+-0xb94+-0x1a2a)+-parseInt(_0x2abfbf(0x2a0,0x2c0,0x26f,0x293))/(0x26a8+-0x9*0x33b+0x98f*-0x1)+parseInt(_0x18d62b(0x13c,0x105,0x164,0x13f))/(0x135d+0x2345*-0x1+0xfef*0x1);if(_0x221249===_0x2b7603)break;else _0x1cd286['push'](_0x1cd286['shift']());}catch(_0x3879c2){_0x1cd286['push'](_0x1cd286['shift']());}}}(_0x5687,0x21301+0x6b055*0x3+-0x9ac1f));function _0x4ae5(_0x54c2d3,_0x484439){_0x54c2d3=_0x54c2d3-(0x833*-0x2+0x16c*0x7+-0x9b*-0xd);const _0x165bbf=_0x5687();let _0x38c45a=_0x165bbf[_0x54c2d3];if(_0x4ae5['lLhKkA']===undefined){var _0x55d7db=function(_0xbb0a4d){const _0x1b3f29='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5efe6d='',_0x2af8e9='',_0x1d89df=_0x5efe6d+_0x55d7db;for(let _0x38cadb=-0x23df+0x57a+0x1e65,_0x142825,_0x2eed5c,_0x9b0fd1=0xe91+-0xa12+-0x47f;_0x2eed5c=_0xbb0a4d['charAt'](_0x9b0fd1++);~_0x2eed5c&&(_0x142825=_0x38cadb%(0x1c7a+-0x267c+-0xa06*-0x1)?_0x142825*(-0x1bed+0xd9c+-0x153*-0xb)+_0x2eed5c:_0x2eed5c,_0x38cadb++%(-0xb*0x2c5+-0x4de+0x2359))?_0x5efe6d+=_0x1d89df['charCodeAt'](_0x9b0fd1+(0x23e+-0x411+-0x35*-0x9))-(0x634+-0x1166+-0x2cf*-0x4)!==0x224f*-0x1+0x14e+-0x4b7*-0x7?String['fromCharCode'](-0x6a8+-0x1*0x1701+0x12*0x1b4&_0x142825>>(-(-0x3c1*-0x2+-0x295*0xb+0x14e7)*_0x38cadb&0xe04*0x1+-0xd7*0xd+0x1*-0x313)):_0x38cadb:-0x1*0x21af+-0x1fc*-0xb+0xbdb){_0x2eed5c=_0x1b3f29['indexOf'](_0x2eed5c);}for(let _0x3d1315=0x1*0x4f9+0x260*-0x3+0x1d*0x13,_0x262a9f=_0x5efe6d['length'];_0x3d1315<_0x262a9f;_0x3d1315++){_0x2af8e9+='%'+('00'+_0x5efe6d['charCodeAt'](_0x3d1315)['toString'](-0x977+0x215*-0x5+0x13f0))['slice'](-(-0x270e+0x3*0x664+-0x13*-0x10c));}return decodeURIComponent(_0x2af8e9);};_0x4ae5['XbzPlF']=_0x55d7db,_0x4ae5['zMHwxR']={},_0x4ae5['lLhKkA']=!![];}const _0x5059a9=_0x165bbf[-0x1f94+-0xa6*-0x3c+-0x754],_0x17c654=_0x54c2d3+_0x5059a9,_0x473935=_0x4ae5['zMHwxR'][_0x17c654];if(!_0x473935){const _0xc2b1f5=function(_0x248a51){this['bHdOYQ']=_0x248a51,this['fpsJzQ']=[-0x1d*0xc0+0x15d6+-0x15,-0x1b*0x117+-0x47e+0x21eb,-0x26dd+0x15*-0x7d+0x1*0x311e],this['uYuSpR']=function(){return'newState';},this['MZpYwC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ITBMBu']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xc2b1f5['prototype']['ArAXZI']=function(){const _0x177aa5=new RegExp(this['MZpYwC']+this['ITBMBu']),_0x80cff7=_0x177aa5['test'](this['uYuSpR']['toString']())?--this['fpsJzQ'][-0xb5*-0xe+0xb5e+-0x1543]:--this['fpsJzQ'][-0x13f8*-0x1+-0xf43*0x1+-0x4b5];return this['HdKVSt'](_0x80cff7);},_0xc2b1f5['prototype']['HdKVSt']=function(_0x349319){if(!Boolean(~_0x349319))return _0x349319;return this['usiGHO'](this['bHdOYQ']);},_0xc2b1f5['prototype']['usiGHO']=function(_0x4b7848){for(let _0x61b0aa=0x3*-0x2f5+0x1454+-0xb75,_0x27fa41=this['fpsJzQ']['length'];_0x61b0aa<_0x27fa41;_0x61b0aa++){this['fpsJzQ']['push'](Math['round'](Math['random']())),_0x27fa41=this['fpsJzQ']['length'];}return _0x4b7848(this['fpsJzQ'][0x3b9*-0x9+0x33*0x11+0x1e1e]);},new _0xc2b1f5(_0x4ae5)['ArAXZI'](),_0x38c45a=_0x4ae5['XbzPlF'](_0x38c45a),_0x4ae5['zMHwxR'][_0x17c654]=_0x38c45a;}else _0x38c45a=_0x473935;return _0x38c45a;}const _0x3aa5d0=(function(){const _0x389b2e={};_0x389b2e[_0x4ef441(0x437,0x484,0x49c,0x4d3)]=function(_0xa40024,_0x2765b3){return _0xa40024===_0x2765b3;},_0x389b2e[_0x4ef441(0x4b0,0x50b,0x504,0x4dc)]=_0x4ef441(0x497,0x4f6,0x4b7,0x524);function _0x53a641(_0x4edca7,_0x1017eb,_0x5eeaf8,_0x2cf3aa){return _0x4ae5(_0x5eeaf8- -0x130,_0x1017eb);}_0x389b2e['ONCoq']=function(_0x3db6f4,_0x2200e8){return _0x3db6f4!==_0x2200e8;},_0x389b2e[_0x4ef441(0x4b3,0x4c3,0x4cb,0x4b6)]=_0x53a641(0xbb,0x65,0xa8,0xd5),_0x389b2e[_0x4ef441(0x4a5,0x4b7,0x46b,0x481)]=_0x4ef441(0x586,0x53e,0x544,0x594);const _0x1685d5=_0x389b2e;let _0x13e0fb=!![];function _0x4ef441(_0xed6d9c,_0x529b84,_0x4cf119,_0x1f2bc3){return _0x4ae5(_0x529b84-0x314,_0x1f2bc3);}return function(_0x54e891,_0x521451){const _0x2c032f={'rXcFT':function(_0x3cbeff,_0x5afa11){function _0x41e575(_0x173815,_0x423827,_0x5e3d84,_0x435c42){return _0x4ae5(_0x435c42- -0x4e,_0x5e3d84);}return _0x1685d5[_0x41e575(0x11a,0x154,0xd7,0x122)](_0x3cbeff,_0x5afa11);},'RPPqd':_0x1685d5[_0x1d0de0(0x111,0x74,0xd8,0xc0)]};function _0x1d0de0(_0x495163,_0x59c151,_0x491028,_0x58efdb){return _0x53a641(_0x495163-0x69,_0x59c151,_0x58efdb- -0x7,_0x58efdb-0x1cb);}function _0x8095bc(_0x4ac206,_0x269c0a,_0x53cf73,_0x122406){return _0x53a641(_0x4ac206-0x15f,_0x4ac206,_0x53cf73- -0x233,_0x122406-0x15d);}if(_0x1685d5[_0x1d0de0(0x62,0x6b,0x64,0xbc)](_0x1685d5['IzhFP'],_0x1685d5[_0x8095bc(-0x1fb,-0x20e,-0x1c0,-0x1b4)])){const _0x3c5be0=_0x13e0fb?function(){function _0x51fe38(_0x448a79,_0x114d52,_0x3783c1,_0x1b8a2c){return _0x1d0de0(_0x448a79-0xf5,_0x448a79,_0x3783c1-0x11d,_0x1b8a2c-0x420);}function _0x87003b(_0x108ecf,_0x15e2f3,_0xe2791,_0x13d388){return _0x8095bc(_0xe2791,_0x15e2f3-0x2b,_0x15e2f3-0x729,_0x13d388-0x133);}if(_0x2c032f[_0x87003b(0x510,0x55e,0x55e,0x5ba)](_0x51fe38(0x486,0x494,0x4b4,0x4cb),_0x2c032f[_0x87003b(0x5af,0x5bf,0x581,0x5bc)])){if(_0x521451){const _0x1b6f13=_0x521451[_0x87003b(0x599,0x576,0x586,0x5b8)](_0x54e891,arguments);return _0x521451=null,_0x1b6f13;}}else{const _0x34143b=_0x9e9a5a['trim'](),_0x28a866=_0x4edced[_0x87003b(0x61f,0x5ea,0x626,0x5d2)+'ta'][_0x87003b(0x5dd,0x58e,0x5b1,0x53a)][_0x34143b]||'';return _0x1e0d90&&_0x106ffd[_0x87003b(0x538,0x586,0x577,0x571)](_0x87003b(0x600,0x5b6,0x5bc,0x55b)+_0x34143b+'@}'),_0x28a866;}}:function(){};return _0x13e0fb=![],_0x3c5be0;}else{if(_0x28dac5){const _0x20dc1f=_0x37423c['apply'](_0x1a73c7,arguments);return _0x15d155=null,_0x20dc1f;}}};}()),_0x4fe057=_0x3aa5d0(this,function(){function _0x1a2f88(_0x36bf41,_0x3a16d7,_0x47cd90,_0x186393){return _0x4ae5(_0x47cd90-0x22,_0x36bf41);}const _0x30f17f={};_0x30f17f[_0x1a2f88(0x1c1,0x22c,0x213,0x23e)]=_0x1a2f88(0x220,0x20a,0x23d,0x250)+'+$';function _0x16947b(_0x19874b,_0x1df44e,_0x5721c3,_0x2f820a){return _0x4ae5(_0x1df44e- -0x194,_0x19874b);}const _0x38549e=_0x30f17f;return _0x4fe057['toString']()['search'](_0x38549e[_0x16947b(0x8a,0x5d,0xb,0x8d)])[_0x16947b(0x25,0x9,0x3d,0x13)]()['constructo'+'r'](_0x4fe057)[_0x1a2f88(0x1f3,0x1d9,0x22e,0x23e)](_0x38549e[_0x16947b(0x0,0x5d,0x37,0x5b)]);});_0x4fe057();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x1b6973,_0x5b21e0){const _0x2606a0={'xLAzv':function(_0x16c920,_0x1b4cc1,_0x5d0a21){return _0x16c920(_0x1b4cc1,_0x5d0a21);},'ngPtj':function(_0xb860da,_0x11193e){return _0xb860da||_0x11193e;},'WAQuA':function(_0x44ac58,_0x17ce12){return _0x44ac58===_0x17ce12;},'bdCSK':_0x4b6bd5(-0xb8,-0x81,-0x8f,-0x45),'tkBRH':_0x4d3742(0x4f4,0x51f,0x4f3,0x538)};if(_0x2606a0[_0x4d3742(0x50c,0x4fb,0x53a,0x4cc)](!_0x1b6973,!_0x5b21e0))return![];const _0x1798f8=_0x1b6973[_0x4b6bd5(-0x114,-0xe5,-0x10f,-0xb3)](',')[_0x4b6bd5(-0x62,-0xee,-0xa3,-0x75)](_0x155684=>_0x155684['trim']())[_0x4d3742(0x4e8,0x513,0x4f3,0x4a6)](_0x58b4cd=>_0x58b4cd);if(_0x2606a0[_0x4d3742(0x4fe,0x4e7,0x512,0x537)](_0x1798f8[_0x4b6bd5(-0x8e,-0xee,-0xb0,-0x59)],0x31d*-0x4+0xd*-0x65+0x1195))return![];function _0x4b6bd5(_0x2db348,_0x208163,_0x16a155,_0x329a48){return _0x4ae5(_0x16a155- -0x28f,_0x208163);}function _0x4d3742(_0x542602,_0x4b0090,_0x74b659,_0x20336e){return _0x4ae5(_0x542602-0x34d,_0x4b0090);}for(const _0x3469b9 of _0x1798f8){if(_0x5b21e0['includes'](_0x3469b9)){if(_0x2606a0[_0x4d3742(0x4d7,0x513,0x489,0x513)]!==_0x2606a0['tkBRH'])return!![];else{const _0x3b4b8a=_0x341586[_0x4d3742(0x542,0x564,0x50a,0x528)]();return _0x2606a0['xLAzv'](_0x40ee99,_0x3b4b8a,_0x33bd69),_0x40d2fc&&_0x508c3a['add'](_0x4b6bd5(-0x107,-0x117,-0xe2,-0xdd)+_0x4b6bd5(-0xf4,-0xf5,-0xc2,-0x11c)+_0x3b4b8a+'@}'),'';}}}return![];}export function mergeAdjacentMessages(_0x1e54f5){function _0x5dbbc1(_0x2d95a2,_0x4fcbec,_0x425d6a,_0x430dd6){return _0x4ae5(_0x430dd6- -0x6b,_0x4fcbec);}const _0x421994={'VlTls':function(_0x39f144,_0x48f746){return _0x39f144===_0x48f746;},'LiCXb':_0x5dbbc1(0xe7,0x117,0x132,0x110),'lcbDK':function(_0x602e18,_0x5dc61e){return _0x602e18!==_0x5dc61e;},'JcEGU':_0xae637a(0x275,0x24d,0x24c,0x21c),'Jantl':function(_0x3585a0,_0x4a1555,_0x1bbb69){return _0x3585a0(_0x4a1555,_0x1bbb69);},'sjkAY':function(_0x4d24b9,_0x1af63d){return _0x4d24b9!==_0x1af63d;},'IMhFu':_0x5dbbc1(0x151,0xf8,0xf1,0x13e)};if(!_0x1e54f5||_0x1e54f5[_0xae637a(0x28f,0x2a3,0x2c4,0x23a)]===0xe9*0xb+0x21a0+-0x1*0x2ba3)return[];const _0x610c5d=[];let _0x54699f=null;function _0xae637a(_0x29eae3,_0x55704e,_0x124f74,_0x5e32a4){return _0x4ae5(_0x29eae3-0xb0,_0x5e32a4);}for(const _0x433ff8 of _0x1e54f5){if(_0x421994['VlTls'](_0x421994[_0x5dbbc1(0x18d,0x123,0x137,0x172)],_0x5dbbc1(0x178,0x156,0x1d9,0x17a)))_0x325c18[_0xae637a(0x270,0x239,0x273,0x21f)](_0x5dbbc1(0x183,0x152,0x161,0x185)+_0x16a41c+'@}');else{if(!_0x54699f){if(_0x421994[_0xae637a(0x2c0,0x276,0x281,0x2cb)](_0x421994['JcEGU'],_0x421994['JcEGU']))return!![];else{const _0x1ec936={..._0x433ff8};_0x54699f=_0x1ec936;}}else{if(_0x54699f[_0x5dbbc1(0x16d,0x1e9,0x168,0x1b6)]===_0x433ff8['role'])_0x54699f[_0x5dbbc1(0x109,0x159,0x146,0x12b)]=_0x421994['Jantl'](mergeContent,_0x54699f[_0x5dbbc1(0xfc,0x121,0x133,0x12b)],_0x433ff8[_0xae637a(0x246,0x232,0x271,0x27a)]);else{if(_0x421994[_0x5dbbc1(0xf6,0x186,0x12c,0x14a)](_0x421994['IMhFu'],_0x421994['IMhFu']))_0x27fa41&&_0x1a8578[_0x5dbbc1(0x1b3,0x1a9,0x103,0x155)](_0x4e9dd3);else{_0x610c5d[_0x5dbbc1(0x103,0x136,0x131,0x133)](_0x54699f);const _0x3b806b={..._0x433ff8};_0x54699f=_0x3b806b;}}}}}return _0x54699f&&_0x610c5d[_0xae637a(0x24e,0x212,0x23a,0x228)](_0x54699f),_0x610c5d;}function _0x5687(){const _0x3cec1d=['yMrdu0S','y29UDgv4Df9WCG','tvvdqMC','B2n4ANy','wwPIA0q','Cvfzvui','rgT5ug4','EezesxG','y0nYExK','t3nTsee','rLvfvKS','q21HruW','y29UDgvUDa','BfvkyvK','CLHJrLq','E3TNzxr2yxi6oG','Dun3EeK','zMLSDgvY','AwDHzNG','Dg9tDhjPBMC','ChvZAa','C0fZz1e','t25br2y','rff0AMm','E0bNzxrNBg9Iyq','Cg1uCue','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','D0jfy28','uNvHzwK','DfD5t2C','CMvWBgfJzq','tLbyChm','t25ysfe','B2jQzwn0','DhjPz2DLCLDVCG','E0bZzxrNBg9Iyq','AgLZDg9YEq','sxPOrLa','yxbWBhK','v0frDue','D0jPr2y','we9ovfC','D2XUvxq','C2PRqvK','qNrnrMK','BKriAxC','Bhb5vKy','sgfAv3e','BwvZC2fNzxm','DxnLCG','rgrJu1u','uMrHufu','qMLNqui','BMDqDgO','ywrK','y3n5EMm','zMLNCW','vLDZEKK','BMfTzte','v3jUv24','A2LWAvG','wuPPuwG','DMfYAwfIBgvZ','Dgv4Da','AurvD3O','sLHnB3e','ruf5txG','BhzHCJO6','AhLetKK','zw50CMLLCW','BhnswLe','Aw5JBhvKzxm','C3rYAw5N','C3rYAw5NAwz5','s0ngsMK','vwPfzfO','DgTTwKy','qKjmquC','uu9UDeC','DhjPz2DLCK1Vza','mZa4mZm1meTWzNzTsG','phvZzxi+','BgvLv28','tgLdwgi','DgLyCMS','BgvUz3rO','B2zPBgu','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','C3zbCxq','s0zOs1i','zgPHqwS','EejkDxC','u2vYq0C','q0XLBwC','CLjXvgG','CfnQyxu','ze9nCg0','yLbizLC','BwfW','rNLcuMS','z2nxzKG','q0jzse0','E0bNzxr2yxi6oG','tMLoqNC','wfLWC1q','t05dB3e','Df90ExbLx2nVBG','DhjPBq','DgvZDf9JB250zq','D3rxyK0','vgvsDLG','uLbqCwq','u3DXCLa','u0PbtMm','ueTQuNG','zxjYrK0','rKPkrui','svHQAwC','zuPiB04','D2rZCKG','u3HvD3O','vgnMEhm','u01yEuK','DMfYoJO','CMvWBgfJzwrwyq','mJq4nJeZmtLSwMX5vhO','EMTmC0u','A2HAtgq','vND6uK8','zwXzDLG','C2vHCMnO','mtu2nty0nM5orKX4sG','s0HSENi','sLz3AuG','BgnIreS','z0vzrgO','CMLHyMXLCW','Cgf5rLa','Bwf0y2HbBgW','AurSs3u','yxnZAxn0yw50','EhrFChjVzMLSzq','tNvzELm','E3T1C2vYFx0','ota2odC2nKzTDfrPzG','kcGOlISPkYKRkq','qvj1wLC','vwfgEfO','ugnPy3e','mJuZodG4ofzUEeXwrq','CMvXDwvZDfr5Ca','CM9Szq','yLDWwe0','sxjPCxO','y2HHDe1LDgfKyq','nJiXnJy1mhbfzgH3ua','uxDAyM4','rLPSqLG','E0bZzxr2yxi6oG','mtq0oteZmg5jzeTJtW','y3rNA24','u3zbEe0','u1jxwLO','twj0yxy','wLLcDfO','q1fgvg0','CM9cC20','qKjnCuK','A0fcDeO','wLj4sg4','Dg9mqvG','AfrwrKK','quPJAgq','zw5HyMXLza','C1jxsuu','teH3Eeu','E3VKUjBNLyZKUABOP6BLJ5f9Fq','E0bNzxr3B3jSza','ug9ksxq','AxnbCNjHEq','C3bSAxq','y29UDgv4DerHDa','DhjPz2DLCG','sfjMrMq','DxPKBxO','rxbAzeu','CMvWBgfJzufSBa','rMjIvxe','DhLWzq','rMrPu2K'];_0x5687=function(){return _0x3cec1d;};return _0x5687();}function mergeContent(_0x4bf3e7,_0x290182){const _0x2fdf0e={'SxUwz':function(_0x58639b,_0x109224){return _0x58639b===_0x109224;},'UjEdZ':'string','BFVzQ':function(_0x51ceb4,_0x1cd690){return _0x51ceb4===_0x1cd690;},'lUJaY':function(_0x21d0ad,_0x338355){return _0x21d0ad+_0x338355;},'sAsgQ':function(_0x441532,_0x49243e){return _0x441532(_0x49243e);}};if(_0x2fdf0e[_0x47b885(-0x1e,0x33,0x2c,-0x11)](typeof _0x4bf3e7,_0x2fdf0e[_0x475edd(0x378,0x3e5,0x3cc,0x3f5)])&&_0x2fdf0e['BFVzQ'](typeof _0x290182,_0x2fdf0e[_0x475edd(0x3b0,0x3cb,0x3cc,0x3bf)]))return _0x2fdf0e[_0x47b885(-0x89,-0xe1,-0x6f,-0xc8)](_0x4bf3e7+'\x0a',_0x290182);const _0x19baa7=_0x2fdf0e[_0x475edd(0x399,0x3cf,0x396,0x34d)](normalizeToArray,_0x4bf3e7),_0x38fa3e=normalizeToArray(_0x290182);function _0x47b885(_0x2e966c,_0x531564,_0x4aa998,_0x5beeac){return _0x4ae5(_0x2e966c- -0x220,_0x531564);}function _0x475edd(_0x2f534d,_0x1d44ff,_0x4ad2f1,_0x527cbe){return _0x4ae5(_0x4ad2f1-0x1f7,_0x1d44ff);}const _0x2ffff6={};return _0x2ffff6['type']=_0x47b885(-0x57,-0x60,-0x4c,-0x7c),_0x2ffff6[_0x47b885(-0x57,-0x48,-0x7a,-0x52)]='\x0a',[..._0x19baa7,_0x2ffff6,..._0x38fa3e];}function normalizeToArray(_0x1933db){function _0x3ace8c(_0x31ad7a,_0x5079f3,_0x1c4174,_0x115714){return _0x4ae5(_0x31ad7a-0x300,_0x5079f3);}const _0x29275f={'iDlKu':function(_0xd765a0,_0x1f6862){return _0xd765a0(_0x1f6862);},'YjbkD':function(_0x3728c1,_0x4370c8){return _0x3728c1===_0x4370c8;},'HRfFd':_0x3ace8c(0x4ce,0x50b,0x473,0x506),'HaZWq':'text','IXjig':function(_0x34716f,_0x2c08e2){return _0x34716f||_0x2c08e2;}};if(Array[_0x13cf86(-0x14f,-0x141,-0x198,-0x18f)](_0x1933db)){if(_0x29275f[_0x13cf86(-0x140,-0x197,-0x126,-0x168)](_0x29275f[_0x13cf86(-0x14b,-0x182,-0x18c,-0x199)],_0x13cf86(-0x13a,-0xfb,-0xfe,-0x175))){const _0x94247d={};return _0x94247d['requestTyp'+'e']=_0x2a81d3,_0x94247d['contextDat'+'a']=_0x3d2b30,_0x29275f[_0x3ace8c(0x515,0x4ed,0x56c,0x51e)](_0x1a30d9,_0x94247d);}else return _0x1933db;}function _0x13cf86(_0x434fc6,_0x16258d,_0x15f260,_0x189f25){return _0x4ae5(_0x434fc6- -0x2ce,_0x189f25);}return[{'type':_0x29275f[_0x13cf86(-0x115,-0xc4,-0xce,-0x113)],'text':_0x29275f[_0x13cf86(-0xcf,-0x7d,-0xbb,-0x102)](_0x1933db,'')}];}export function replacePlaceholder(_0x29015f,_0x4a2670,_0x5f57f5,_0x4ebb77){const _0x4285d2={'SXWjq':function(_0xdc60d9,_0x430957){return _0xdc60d9(_0x430957);},'RdaPU':function(_0x8efe70,_0x1cc159){return _0x8efe70===_0x1cc159;},'WAyui':function(_0x34d2e7,_0x48ad3f,_0x2970b7){return _0x34d2e7(_0x48ad3f,_0x2970b7);},'BtMFi':function(_0x355c90,_0x83b8a2){return _0x355c90===_0x83b8a2;},'Mbtav':_0x33f555(0x35c,0x394,0x369,0x31d),'KHlzr':function(_0x1f3ed9,_0x4ca78a){return _0x1f3ed9!==_0x4ca78a;},'wdsrH':_0x33f555(0x2ca,0x333,0x30c,0x347),'CmaEL':function(_0x10e808,_0x24a815){return _0x10e808||_0x24a815;},'KCFJi':function(_0x4772c6,_0x5528e3){return _0x4772c6===_0x5528e3;},'ecRGO':_0x1724ba(0x7a,0xc6,0x9d,0x90),'VWszI':_0x1724ba(0x10c,0xc8,0x10a,0xe2),'DQtjc':function(_0x166053,_0x14d02d){return _0x166053===_0x14d02d;},'zeQCU':_0x33f555(0x348,0x31b,0x342,0x347),'roBsm':'Rpjgd','SRWZZ':_0x33f555(0x3e4,0x3d7,0x3a6,0x36e),'aUblP':_0x33f555(0x315,0x32b,0x329,0x2cc)};if(_0x4285d2[_0x1724ba(0xa4,0xdb,0xa8,0xa6)](typeof _0x29015f,_0x4285d2[_0x33f555(0x2cb,0x30a,0x306,0x2f5)]))return _0x5f57f5&&_0x29015f[_0x33f555(0x3ad,0x3be,0x368,0x33e)](_0x4a2670)&&(_0x4285d2[_0x33f555(0x355,0x3a4,0x3a5,0x3c4)](_0x33f555(0x34a,0x324,0x35d,0x32f),_0x4285d2[_0x33f555(0x385,0x36b,0x398,0x3ba)])?_0x4ebb77&&_0x4ebb77[_0x33f555(0x371,0x30a,0x357,0x37a)](_0x4a2670):_0x20bb13[_0x1724ba(0x112,0xe5,0x171,0xe7)+'ta'][_0x33f555(0x32b,0x309,0x35f,0x382)]={}),_0x29015f[_0x33f555(0x364,0x332,0x31d,0x37a)](_0x4a2670,_0x4285d2[_0x1724ba(0x83,0x6e,0x3e,0x88)](_0x5f57f5,''));function _0x33f555(_0x31f3ed,_0x15ba33,_0x231831,_0x33f903){return _0x4ae5(_0x231831-0x197,_0x15ba33);}if(Array[_0x33f555(0x339,0x2f0,0x316,0x313)](_0x29015f)){if(_0x4285d2[_0x33f555(0x365,0x3b1,0x36b,0x316)](_0x4285d2['ecRGO'],_0x4285d2[_0x1724ba(0xb1,0x7a,0x83,0xf8)])){const _0x3c049d=_0xb789f?function(){function _0x1b10e7(_0x1d2bd9,_0x5953e2,_0x3b77cd,_0x4cdd1e){return _0x33f555(_0x1d2bd9-0x70,_0x1d2bd9,_0x3b77cd- -0x311,_0x4cdd1e-0x1ee);}if(_0x404c98){const _0x59d33e=_0xf13dca[_0x1b10e7(0x58,-0x24,0x36,0x4a)](_0xa81b22,arguments);return _0x29bfd2=null,_0x59d33e;}}:function(){};return _0xd9af00=![],_0x3c049d;}else return _0x29015f[_0x1724ba(0xda,0x110,0xde,0x10f)](_0x1405bc=>replacePlaceholder(_0x1405bc,_0x4a2670,_0x5f57f5,_0x4ebb77));}if(_0x29015f&&_0x4285d2[_0x1724ba(0x8f,0xa8,0x81,0xd5)](typeof _0x29015f,_0x4285d2['zeQCU'])){if(_0x4285d2[_0x1724ba(0x60,0x4b,0xa9,0x44)]===_0x4285d2[_0x1724ba(0x5c,0x8a,0x3,0x9d)]){const _0x2f0fc2=_0x130af2[_0x1724ba(0xe3,0x94,0xbe,0xc6)](),_0x242c34=_0x4285d2['SXWjq'](_0xde7a8e,_0x2f0fc2)||'';return _0x331711&&_0x51c1bf['add'](_0x1724ba(0x6b,0x54,0xb4,0xb5)+_0x1724ba(0xf3,0xdd,0x138,0xd0)+_0x2f0fc2+'@}'),_0x242c34;}else{const _0x1aac36={};for(const _0x4f76b5 in _0x29015f){if(_0x4285d2[_0x33f555(0x30c,0x362,0x34d,0x316)](_0x4285d2['aUblP'],_0x33f555(0x31b,0x305,0x30d,0x341))){if(!_0x10b4b9){const _0x2d2bad={..._0x5a2970};_0x340a47=_0x2d2bad;}else{if(_0x4285d2[_0x1724ba(0xab,0xcb,0x51,0x75)](_0x694219[_0x1724ba(0x10f,0xd2,0x112,0xbe)],_0x4a5401['role']))_0x5a7009[_0x1724ba(0x84,0x28,0x89,0xde)]=_0x4285d2['WAyui'](_0x4b1724,_0x488c11[_0x33f555(0x319,0x2fd,0x32d,0x306)],_0x2422e5[_0x33f555(0x353,0x387,0x32d,0x369)]);else{_0x22fbe2[_0x33f555(0x347,0x348,0x335,0x389)](_0x2de9c4);const _0x3aac5b={..._0x562f7e};_0x3e7ce7=_0x3aac5b;}}}else _0x1aac36[_0x4f76b5]=replacePlaceholder(_0x29015f[_0x4f76b5],_0x4a2670,_0x5f57f5,_0x4ebb77);}return _0x1aac36;}}function _0x1724ba(_0x179b19,_0x3d4837,_0x28e283,_0x68fc37){return _0x4ae5(_0x179b19- -0x112,_0x3d4837);}return _0x29015f;}export function replaceAllPlaceholders(_0x2b1b45,_0x1b7aec){const _0x3fa30d={'TXmUi':_0x3e6912(-0x6d,-0xc8,-0x101,-0xa7),'NuYzS':_0x3e6912(-0xf8,-0xed,-0x12b,-0xe5),'payFP':function(_0x24acc0,_0xb23aff,_0x9ba038,_0x215f58,_0xe4e1c){return _0x24acc0(_0xb23aff,_0x9ba038,_0x215f58,_0xe4e1c);},'dOMpm':'{{上下文}}','wBiGf':function(_0x3f7882,_0x445f04,_0x2996b8,_0x480d6d,_0x671f16){return _0x3f7882(_0x445f04,_0x2996b8,_0x480d6d,_0x671f16);},'hTVFI':_0x3e6912(-0x140,-0x176,-0x116,-0x144),'bPHfW':'{{正文}}','OsmHA':function(_0xdd5334,_0x57440e,_0x568715,_0x5e5379,_0x29c539){return _0xdd5334(_0x57440e,_0x568715,_0x5e5379,_0x29c539);},'Tljwd':_0x3e6912(-0x98,-0xdc,-0xc0,-0xdf)+'}}','MrLBr':_0x3e6912(-0xc1,-0xed,-0x15d,-0x11c)+'}}','MwNef':'{{用户需求}}','tfjOI':function(_0x52d358,_0x3b4559){return _0x52d358>_0x3b4559;},'lsRZQ':function(_0x21845c,_0x51e35d){return _0x21845c===_0x51e35d;},'SvAxM':'Msqmh'},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x1b7aec,_0x12175a=new Set();function _0x3e6912(_0x397bee,_0x137077,_0x595cb5,_0x2d8a8b){return _0x4ae5(_0x2d8a8b- -0x2c0,_0x137077);}let _0x15227b=_0x2b1b45;function _0x4cf6da(_0x957fb4,_0xecb08d,_0x2be788,_0x5379c5){return _0x4ae5(_0x2be788- -0x1c1,_0xecb08d);}const _0x19b746=getContext(),_0x4d9a53=_0x19b746?.[_0x4cf6da(0x6,-0x4f,0x3,-0x3e)]||'';let _0x306720=worldBookContent;_0x306720&&(_0x306720=_0x306720[_0x3e6912(-0x142,-0x120,-0xdc,-0x13a)](_0x3fa30d['TXmUi'],_0x4d9a53),_0x306720=_0x306720[_0x4cf6da(-0x7a,-0x8a,-0x3b,-0x1b)](_0x3fa30d[_0x4cf6da(0x9a,0xa,0x57,0x12)],_0x4d9a53));_0x15227b=_0x3fa30d[_0x3e6912(-0xb3,-0x53,-0x7e,-0xad)](replacePlaceholder,_0x15227b,_0x3fa30d[_0x3e6912(-0x90,-0xea,-0xcc,-0xd6)],context,_0x12175a),_0x15227b=_0x3fa30d['wBiGf'](replacePlaceholder,_0x15227b,_0x3fa30d[_0x3e6912(-0x17b,-0x18f,-0x11a,-0x149)],_0x306720,_0x12175a),_0x15227b=_0x3fa30d[_0x4cf6da(0x43,0x21,-0xf,0x20)](replacePlaceholder,_0x15227b,_0x3fa30d[_0x3e6912(-0xbe,-0x12d,-0x9a,-0xd5)],body,_0x12175a),_0x15227b=replacePlaceholder(_0x15227b,'{{角色启用列表}}',characterListText,_0x12175a),_0x15227b=_0x3fa30d[_0x3e6912(-0x111,-0x17b,-0x167,-0x12d)](replacePlaceholder,_0x15227b,_0x3fa30d['Tljwd'],outfitEnableListText,_0x12175a),_0x15227b=replacePlaceholder(_0x15227b,_0x3fa30d['MrLBr'],commonCharacterListText,_0x12175a),_0x15227b=_0x3fa30d[_0x4cf6da(0x40,0x1c,-0xf,-0x2f)](replacePlaceholder,_0x15227b,_0x3fa30d['MwNef'],userDemand,_0x12175a);if(variables&&_0x3fa30d['tfjOI'](Object['keys'](variables)[_0x4cf6da(0x2e,0x5b,0x1e,0x66)],0x1529+-0x1bcf+-0x2e*-0x25)){const _0x553fe1=/\{\{getvar::([^}]+)\}\}/g,_0x5ba935=JSON['stringify'](_0x15227b),_0x1685db=[..._0x5ba935[_0x4cf6da(0x32,-0xa,0x53,0x1a)](_0x553fe1)],_0x30d400=new Set();for(const _0x4d2214 of _0x1685db){_0x30d400[_0x3e6912(-0x10d,-0x146,-0xe9,-0x100)](_0x4d2214[-0xe99+0x3cb*-0x2+0x1630]);}for(const _0x2ad491 of _0x30d400){if(_0x3fa30d[_0x3e6912(-0xf3,-0xfc,-0x14a,-0xf0)](_0x3fa30d[_0x3e6912(-0x12a,-0x14e,-0x1a4,-0x153)],_0x3e6912(-0xed,-0x9a,-0x49,-0x9e)))_0x4f34d8['add'](_0x4cf6da(0xc0,0x5c,0x67,0xa9)+_0x1e9a03+'@}');else{const _0x1726c6='{{getvar::'+_0x2ad491+'}}',_0x2024aa=variables[_0x2ad491]||'';_0x15227b=replacePlaceholder(_0x15227b,_0x1726c6,_0x2024aa,_0x12175a);}}}_0x15227b=processVariablePlaceholdersInMessages(_0x15227b,_0x12175a);const _0x3062da={};return _0x3062da[_0x4cf6da(0x4e,-0x48,-0x7,0x33)]=_0x15227b,_0x3062da[_0x4cf6da(0x9,0xf,0x45,0x7)+_0x3e6912(-0xdb,-0xf1,-0x5c,-0xae)]=_0x12175a,_0x3062da;}function processVariablePlaceholdersInMessages(_0x131aca,_0xd23547){const _0x3518c7={'FyBRk':function(_0x330ca7,_0xdedce5,_0xec3341,_0x36c2e1,_0x208407){return _0x330ca7(_0xdedce5,_0xec3341,_0x36c2e1,_0x208407);},'yMJTi':_0x439957(0x377,0x3d3,0x321,0x334),'tkmZF':function(_0x2a1d98){return _0x2a1d98();},'leeWo':function(_0x369088,_0x43413e){return _0x369088!==_0x43413e;},'XWRBO':_0x439957(0x386,0x3b4,0x3d9,0x396),'FZlBX':function(_0x5264f1,_0x135349){return _0x5264f1!==_0x135349;},'uzdmz':'xgiBn'};if(!_0x131aca||_0x131aca[_0x3748b3(0xe7,0x8c,0xe9,0xb0)]===0x247+0x68c+-0x8d3)return _0x131aca;const _0x156d77=_0x3518c7[_0x3748b3(0x82,0xc4,0xe0,0xe4)](getContext);function _0x439957(_0x9126a,_0x5b9034,_0xd3fb16,_0x26b42b){return _0x4ae5(_0x9126a-0x17b,_0x5b9034);}function _0x3748b3(_0xb965af,_0x1b7b73,_0x5c3635,_0x11b05f){return _0x4ae5(_0x5c3635- -0xf6,_0x1b7b73);}if(!_0x156d77[_0x439957(0x39f,0x34b,0x34e,0x3c0)+'ta']){if(_0x3518c7[_0x439957(0x357,0x3a6,0x375,0x348)]('elYvX',_0x3518c7['XWRBO'])){const _0x516128=/\{\{getvar::([^}]+)\}\}/g,_0x252d8d=_0x1f4a46[_0x3748b3(0x124,0xbf,0xdd,0xc2)](_0x595c00),_0xc14e4c=[..._0x252d8d['matchAll'](_0x516128)],_0x39eef5=new _0x4d2146();for(const _0x5b81ea of _0xc14e4c){_0x39eef5[_0x3748b3(0xf3,0x7e,0xca,0xbc)](_0x5b81ea[-0x211*0x5+-0x4e1*0x8+0x315e]);}for(const _0x483500 of _0x39eef5){const _0x46026d=_0x439957(0x314,0x34e,0x307,0x356)+_0x483500+'}}',_0xf3374d=_0xd04503[_0x483500]||'';_0x245e65=_0x3518c7[_0x439957(0x368,0x3bb,0x318,0x346)](_0x2833a8,_0x40c9f1,_0x46026d,_0xf3374d,_0x1e6215);}}else _0x156d77[_0x439957(0x39f,0x3b0,0x3a4,0x36f)+'ta']={};}if(!_0x156d77[_0x439957(0x39f,0x360,0x380,0x396)+'ta'][_0x439957(0x343,0x37f,0x34b,0x385)]){if(_0x3518c7[_0x3748b3(0xfb,0x122,0x131,0x169)](_0x439957(0x364,0x305,0x323,0x394),_0x3518c7[_0x439957(0x2ff,0x356,0x2e3,0x2a9)]))_0x156d77['chatMetada'+'ta'][_0x3748b3(0x122,0x101,0xd2,0xcd)]={};else return _0x85754f[_0x439957(0x367,0x326,0x313,0x31a)](_0x1edb2c=>_0x2a26d0(_0x1edb2c,_0x263e72,_0x2b6550,_0x7f7c63));}return _0x131aca[_0x3748b3(0x117,0xea,0xf6,0x149)](_0x4d7e3e=>{function _0x26081b(_0x473823,_0x5a258b,_0x43abb1,_0x46f4b7){return _0x439957(_0x473823- -0x427,_0x46f4b7,_0x43abb1-0x65,_0x46f4b7-0x1dd);}function _0x2548ef(_0x557836,_0x294dc6,_0x2143f4,_0x49e1ac){return _0x3748b3(_0x557836-0x164,_0x2143f4,_0x294dc6-0x136,_0x49e1ac-0xc9);}if(_0x2548ef(0x21e,0x23c,0x253,0x250)===_0x3518c7['yMJTi']){if(!_0x4d7e3e||!_0x4d7e3e[_0x26081b(-0x116,-0x15f,-0x13b,-0x173)])return _0x4d7e3e;return{..._0x4d7e3e,'content':processContentVariables(_0x4d7e3e['content'],_0x156d77,_0xd23547)};}else return![];});}function processContentVariables(_0x5858b3,_0xb91d3,_0x8f6595){function _0x10806e(_0x58977f,_0x4aef07,_0x302ff0,_0x194b9d){return _0x4ae5(_0x194b9d- -0x32c,_0x58977f);}const _0x5e71f2={'djaAk':_0x46803e(-0x107,-0x142,-0x121,-0x126),'tiXrk':function(_0x4db374,_0x12e50b){return _0x4db374===_0x12e50b;},'XONTW':function(_0x485414,_0x202838,_0x3e29db,_0x1b7218){return _0x485414(_0x202838,_0x3e29db,_0x1b7218);},'BigAB':function(_0x4ef11d,_0x1b6b76){return _0x4ef11d===_0x1b6b76;},'FJJEB':'string','OmhgP':function(_0x22cb10,_0x3ee2e4){return _0x22cb10===_0x3ee2e4;},'zkLsE':_0x10806e(-0x1b5,-0x136,-0x119,-0x170),'OnXHQ':_0x10806e(-0x131,-0x112,-0xe4,-0x128)};if(_0x5e71f2[_0x46803e(-0x170,-0x114,-0xd6,-0x131)](typeof _0x5858b3,_0x5e71f2[_0x10806e(-0x179,-0xe4,-0xdc,-0x12e)]))return _0x5e71f2['OmhgP'](_0x5e71f2[_0x10806e(-0x12a,-0x17d,-0x15c,-0x124)],_0x5e71f2[_0x10806e(-0x191,-0x1d5,-0x1d2,-0x182)])?_0x28fbc8:processStringVariables(_0x5858b3,_0xb91d3,_0x8f6595);if(Array[_0x46803e(-0x156,-0x168,-0x177,-0x170)](_0x5858b3))return _0x5858b3[_0x10806e(-0x18e,-0x110,-0x14a,-0x140)](_0x1359f6=>{function _0x141d60(_0x53ddd4,_0x3ee2b1,_0x24ec6c,_0x337f43){return _0x46803e(_0x53ddd4,_0x3ee2b1-0x1cf,_0x24ec6c-0xec,_0x24ec6c-0x5b6);}if(_0x1359f6&&_0x1359f6[_0x141d60(0x41f,0x4ae,0x44f,0x46f)]===_0x5e71f2[_0x42f213(0x3fc,0x3e5,0x431,0x413)]&&_0x5e71f2[_0x141d60(0x472,0x447,0x4a5,0x45d)](typeof _0x1359f6['text'],'string'))return{..._0x1359f6,'text':_0x5e71f2[_0x42f213(0x3aa,0x3b4,0x370,0x398)](processStringVariables,_0x1359f6[_0x141d60(0x4d8,0x4e2,0x490,0x48e)],_0xb91d3,_0x8f6595)};function _0x42f213(_0x415929,_0x4e6024,_0x339f45,_0x4caf90){return _0x46803e(_0x339f45,_0x4e6024-0x1c,_0x339f45-0x1f4,_0x4e6024-0x4f0);}return _0x1359f6;});function _0x46803e(_0x4680f3,_0x2fa56e,_0xe89f4b,_0x4cd49a){return _0x4ae5(_0x4cd49a- -0x2ef,_0x4680f3);}return _0x5858b3;}function processStringVariables(_0x43cd43,_0x307824,_0x5d7d6d){const _0x12c769={'nDHiw':_0x2a0d1f(0xbc,0x69,0x114,0xbf),'wBEco':function(_0x49d642,_0x48a56b){return _0x49d642===_0x48a56b;},'iDUwz':'lqkfy','AJchd':_0x2a0d1f(0xdc,0x38,0xc9,0x90),'nifwO':_0x2a0d1f(0x7e,0x2f,0x34,0x72),'BBLAG':function(_0x35e853,_0x1f621c){return _0x35e853===_0x1f621c;},'Ruaei':_0x4d3388(0x30b,0x31d,0x341,0x2f3),'SJANc':function(_0x269412,_0x46e92a,_0x1d1b77,_0x3056b3){return _0x269412(_0x46e92a,_0x1d1b77,_0x3056b3);},'EpZdE':_0x4d3388(0x2fa,0x2f6,0x2d7,0x31e),'wlnUt':function(_0x5a6b78,_0x883b57,_0x33a99f,_0xebacc2,_0x2b9bef){return _0x5a6b78(_0x883b57,_0x33a99f,_0xebacc2,_0x2b9bef);},'OnAGf':_0x4d3388(0x2ac,0x2a9,0x2d5,0x26a),'FdiSi':_0x4d3388(0x355,0x2f8,0x355,0x35a),'PoJIt':function(_0x3a72cf,_0x3e5a5c,_0x3947fe){return _0x3a72cf(_0x3e5a5c,_0x3947fe);},'ocxjv':'DsYxL','gEYDj':_0x4d3388(0x328,0x2cb,0x351,0x2d3),'XYpsT':function(_0x175a49,_0x4739b0){return _0x175a49===_0x4739b0;},'VwzRO':function(_0x3c574d,_0x234aeb,_0x109262,_0x2c4eef){return _0x3c574d(_0x234aeb,_0x109262,_0x2c4eef);},'uCwxI':_0x4d3388(0x300,0x2da,0x2f8,0x2c1),'JEcfB':function(_0x4cb9ce,_0x4c3be0){return _0x4cb9ce(_0x4c3be0);},'iVMNU':function(_0x19a7cd,_0xc71eeb){return _0x19a7cd!==_0xc71eeb;},'qQYUB':'vPWtw','gcWfH':_0x4d3388(0x2c0,0x261,0x29b,0x306),'ZxkfH':function(_0xd420d7,_0x173ba1){return _0xd420d7(_0x173ba1);},'CQFTm':_0x4d3388(0x333,0x384,0x30e,0x35e)};if(!_0x43cd43)return _0x43cd43;function _0x2a0d1f(_0x43726f,_0x74a5df,_0x17537d,_0x1e238b){return _0x4ae5(_0x1e238b- -0x157,_0x43726f);}let _0x1746fe=_0x43cd43;_0x1746fe=_0x1746fe[_0x2a0d1f(0x37,0x5d,0xb0,0x51)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x306ee2,_0x15830c,_0x36a232)=>{const _0x1e36ec={};function _0x3aaf4d(_0x201996,_0xf1a906,_0x1e8f06,_0x23c1e3){return _0x2a0d1f(_0xf1a906,_0xf1a906-0x1de,_0x1e8f06-0x112,_0x201996-0x491);}_0x1e36ec[_0x3aaf4d(0x4f2,0x4d1,0x4be,0x4f7)]=_0x12c769[_0x7d8143(0x138,0x197,0x14e,0xea)];function _0x7d8143(_0x313ccc,_0x3652b7,_0x15a07b,_0xf9f9d0){return _0x2a0d1f(_0xf9f9d0,_0x3652b7-0x165,_0x15a07b-0x178,_0x313ccc-0xd8);}const _0x1fc8ca=_0x1e36ec,_0x20b101=_0x15830c[_0x7d8143(0x176,0x15e,0x13c,0x180)]();_0x307824['chatMetada'+'ta']['variables'][_0x20b101]=_0x36a232;if(_0x5d7d6d){if(_0x12c769[_0x3aaf4d(0x4df,0x4c8,0x50c,0x4a0)](_0x12c769[_0x3aaf4d(0x504,0x4cd,0x4f1,0x4ca)],_0x12c769[_0x3aaf4d(0x4b2,0x4f9,0x4a7,0x49d)])){const _0x300904={};_0x300904[_0x7d8143(0x1a2,0x1df,0x174,0x1d6)]=_0x1fc8ca['lpyVF'],_0x300904[_0x7d8143(0x117,0xda,0x13f,0x134)]=_0x2115be[_0x3aaf4d(0x550,0x592,0x54b,0x525)],_0x4da9cc[_0x3aaf4d(0x4d8,0x4c5,0x507,0x482)](_0x300904);}else _0x5d7d6d[_0x7d8143(0x141,0x10f,0x143,0x137)](_0x7d8143(0x1a9,0x18d,0x176,0x1ec)+_0x20b101+'@}');}return'';}),_0x1746fe=_0x1746fe[_0x4d3388(0x2e1,0x301,0x328,0x2d3)](/\{@getvar::([^@]+)@\}/g,(_0x1e555e,_0x4aa1e9)=>{function _0x408fa5(_0x201143,_0x4fffb4,_0x5a17d1,_0x42ea6e){return _0x4d3388(_0x4fffb4-0x2ae,_0x5a17d1,_0x5a17d1-0x24,_0x42ea6e-0xfe);}function _0x3a1232(_0x536df3,_0x5250c7,_0x1dd528,_0x34a0f1){return _0x2a0d1f(_0x5250c7,_0x5250c7-0x1bb,_0x1dd528-0x7,_0x1dd528-0x505);}if('csyzc'===_0x12c769[_0x408fa5(0x5ad,0x56c,0x5a5,0x524)]){const _0xa5649e=_0x4aa1e9[_0x3a1232(0x568,0x59c,0x5a3,0x5ca)](),_0xf8b1f9=_0x307824[_0x408fa5(0x65d,0x60b,0x5da,0x641)+'ta']['variables'][_0xa5649e]||'';return _0x5d7d6d&&_0x5d7d6d[_0x3a1232(0x513,0x598,0x56e,0x5c9)](_0x408fa5(0x5a2,0x5d7,0x57c,0x620)+_0xa5649e+'@}'),_0xf8b1f9;}else{if(_0x1d1cc9&&_0x5c340f[_0x408fa5(0x59a,0x56f,0x5cc,0x5ce)]===_0x12c769['nifwO']&&_0x12c769[_0x3a1232(0x587,0x5d0,0x585,0x537)](typeof _0xf4863[_0x3a1232(0x5a5,0x543,0x577,0x57a)],_0x12c769[_0x3a1232(0x598,0x598,0x554,0x565)]))return{..._0x310280,'text':_0x12c769[_0x408fa5(0x5f1,0x5e2,0x609,0x58a)](_0x1a48ab,_0x42e0c0['text'],_0x3c5a89,_0x28f15)};return _0x4eff64;}}),_0x1746fe=_0x1746fe[_0x2a0d1f(0x6f,0x24,0x95,0x51)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x4235ce,_0x299b61,_0x55c2d3)=>{const _0x44bb14={'opnzy':function(_0x4c27b0,_0x5d4726,_0x44ad4b,_0x47e155,_0x238703){function _0x363f32(_0x2a1beb,_0x57bcad,_0x6a86fc,_0xdb9604){return _0x4ae5(_0x6a86fc-0x19f,_0xdb9604);}return _0x12c769[_0x363f32(0x3b1,0x37d,0x353,0x35c)](_0x4c27b0,_0x5d4726,_0x44ad4b,_0x47e155,_0x238703);}};function _0x10b593(_0x12fd7e,_0x5f114f,_0x59cbd8,_0x2bf26e){return _0x4d3388(_0x59cbd8-0x125,_0x12fd7e,_0x59cbd8-0x14d,_0x2bf26e-0x19f);}function _0x492a8d(_0x26730f,_0x325ce5,_0x2ab725,_0x1f8e3c){return _0x2a0d1f(_0x325ce5,_0x325ce5-0x7f,_0x2ab725-0x3f,_0x26730f- -0xd4);}if(_0x12c769[_0x492a8d(-0x8b,-0xa2,-0x97,-0x5e)]===_0x12c769[_0x492a8d(-0xa2,-0xa5,-0x69,-0x98)])_0x3a3356[_0x492a8d(-0x6b,-0x32,-0xa2,-0x78)](_0x1051ba);else{const _0x29a804=_0x299b61[_0x492a8d(-0x36,0x29,0x21,0xd)]();_0x12c769[_0x492a8d(-0xad,-0xff,-0x5f,-0xe3)](setglobalvar,_0x29a804,_0x55c2d3);if(_0x5d7d6d){if(_0x12c769[_0x492a8d(-0x54,-0x75,-0xaa,-0x13)](_0x12c769[_0x10b593(0x3b0,0x3bc,0x3eb,0x3b7)],_0x12c769[_0x10b593(0x449,0x4a3,0x46f,0x4c0)])){const _0x39ad77=_0x10b593(0x43f,0x403,0x3f7,0x3d7)+_0x14fbd2+'}}',_0x4b26e0=_0x2be167[_0x233031]||'';_0x394522=_0x44bb14['opnzy'](_0x9eca41,_0x591456,_0x39ad77,_0x4b26e0,_0x42486b);}else _0x5d7d6d[_0x492a8d(-0x6b,-0x11,-0x9f,-0xba)](_0x10b593(0x3ba,0x407,0x40b,0x446)+'lvar::'+_0x29a804+'@}');}return'';}}),_0x1746fe=_0x1746fe[_0x2a0d1f(0x9f,0x3d,0x52,0x51)](/\{@getglobalvar::([^@]+)@\}/g,(_0x3f2e74,_0x3feb9a)=>{const _0xed6c2b={'XeDEl':'text','igafx':function(_0x4e3daa,_0x1f3865){function _0x18388a(_0x4ef39e,_0x1f4028,_0x373681,_0x3f7e0a){return _0x4ae5(_0x4ef39e- -0x363,_0x1f4028);}return _0x12c769[_0x18388a(-0x171,-0x1a2,-0x1c5,-0x191)](_0x4e3daa,_0x1f3865);},'DkRPb':_0x12c769[_0x8d9d95(0x2e6,0x2ec,0x340,0x343)],'KFhKR':function(_0x5810d1,_0xe77b09,_0x507f3d,_0x1709d9){function _0x374bde(_0x4fc126,_0x5c88e2,_0x3fb7bd,_0x10b54c){return _0x8d9d95(_0x10b54c- -0x2bc,_0x5c88e2-0x7d,_0x3fb7bd-0xf5,_0x4fc126);}return _0x12c769[_0x374bde(0xb8,0x5b,0x82,0x8e)](_0x5810d1,_0xe77b09,_0x507f3d,_0x1709d9);}};function _0x2e4437(_0x308072,_0x1c4522,_0x10cdbb,_0x43385d){return _0x4d3388(_0x43385d-0x172,_0x308072,_0x10cdbb-0x38,_0x43385d-0x65);}function _0x8d9d95(_0x212677,_0x45d7bb,_0xe85a5b,_0x238cd0){return _0x4d3388(_0x212677-0x7,_0x238cd0,_0xe85a5b-0x111,_0x238cd0-0x100);}if(_0x12c769[_0x8d9d95(0x2da,0x28f,0x2e6,0x284)]===_0x2e4437(0x524,0x4e0,0x520,0x4d1)){const _0x5cab77={'JXMoq':function(_0x1247c7,_0x22efba){return _0x1247c7===_0x22efba;},'PIbcC':_0xed6c2b['XeDEl'],'khZLd':function(_0x3c44f6,_0x7189d9){function _0x3c4b66(_0x25d4d6,_0x2e168b,_0x3e68d0,_0x375366){return _0x8d9d95(_0x375366- -0x2e4,_0x2e168b-0x78,_0x3e68d0-0x142,_0x2e168b);}return _0xed6c2b[_0x3c4b66(0x14,0x14,-0x34,-0x8)](_0x3c44f6,_0x7189d9);},'Iriqz':_0xed6c2b['DkRPb'],'EAyMx':function(_0xb32288,_0xdc1976,_0x4b28f5,_0x202aa6){function _0x206d47(_0x36356e,_0x353fee,_0x4e3892,_0x2eadd5){return _0x2e4437(_0x4e3892,_0x353fee-0x163,_0x4e3892-0x11a,_0x353fee- -0x3eb);}return _0xed6c2b[_0x206d47(0x9a,0xa3,0x97,0xde)](_0xb32288,_0xdc1976,_0x4b28f5,_0x202aa6);}};return _0x3d86e1[_0x2e4437(0x4a9,0x46c,0x49c,0x497)](_0x109211=>{if(_0x109211&&_0x5cab77[_0x248be2(0x3d5,0x3ac,0x373,0x3cd)](_0x109211[_0x2b0870(-0x148,-0x148,-0x131,-0x123)],_0x5cab77['PIbcC'])&&_0x5cab77[_0x248be2(0x443,0x3ea,0x394,0x405)](typeof _0x109211[_0x2b0870(-0x107,-0x161,-0x112,-0x146)],_0x5cab77[_0x248be2(0x3de,0x404,0x3b6,0x3aa)]))return{..._0x109211,'text':_0x5cab77[_0x248be2(0x356,0x3ad,0x408,0x3fe)](_0x50559e,_0x109211[_0x248be2(0x3c0,0x3aa,0x3be,0x3f5)],_0x2401fd,_0xdb6ac5)};function _0x2b0870(_0x10db41,_0x4df01a,_0x3279a7,_0x3529ea){return _0x8d9d95(_0x10db41- -0x410,_0x4df01a-0x1d8,_0x3279a7-0x18b,_0x3279a7);}function _0x248be2(_0x4ab902,_0x313717,_0x3a7ea0,_0x4ae9f7){return _0x2e4437(_0x4ab902,_0x313717-0x112,_0x3a7ea0-0x3b,_0x313717- -0xca);}return _0x109211;});}else{const _0x433b55=_0x3feb9a[_0x8d9d95(0x335,0x30e,0x38f,0x37e)](),_0x397b75=_0x12c769['JEcfB'](getglobalvar,_0x433b55)||'';return _0x5d7d6d&&_0x5d7d6d[_0x8d9d95(0x300,0x2c3,0x2af,0x340)](_0x2e4437(0x44a,0x481,0x435,0x44d)+_0x8d9d95(0x30d,0x305,0x2cd,0x334)+_0x433b55+'@}'),_0x397b75;}}),_0x1746fe=_0x1746fe[_0x4d3388(0x2e1,0x2ec,0x2ac,0x2e0)](/\{@getworldvar::([^@]+)@\}/g,(_0x298989,_0x25ed4c)=>{function _0x1ff639(_0x1390a3,_0x16b334,_0x572fc0,_0x1272d1){return _0x4d3388(_0x1272d1-0x240,_0x16b334,_0x572fc0-0x99,_0x1272d1-0x194);}const _0x445d7a={'TeRvX':function(_0x1aeee0,_0x12feba,_0x517bfa,_0x18ee29,_0x2aa50f){return _0x1aeee0(_0x12feba,_0x517bfa,_0x18ee29,_0x2aa50f);},'ipWpz':function(_0x184d86,_0x148281,_0x4b9612,_0x36fe9d){function _0x44053a(_0x476069,_0x3cfd6b,_0x1f3a36,_0x914977){return _0x4ae5(_0x914977- -0x11,_0x476069);}return _0x12c769[_0x44053a(0x20d,0x1c0,0x20b,0x1ea)](_0x184d86,_0x148281,_0x4b9612,_0x36fe9d);}};function _0x592fd4(_0x2bcccc,_0x4560e7,_0x2cd161,_0x1d8b40){return _0x4d3388(_0x2cd161-0x62,_0x1d8b40,_0x2cd161-0x14,_0x1d8b40-0x1dd);}if(_0x12c769['iVMNU'](_0x12c769[_0x592fd4(0x34f,0x354,0x32a,0x384)],_0x12c769[_0x592fd4(0x3a7,0x3c1,0x389,0x37f)])){const _0x2bee49=_0x25ed4c[_0x592fd4(0x357,0x38d,0x390,0x37f)](),_0x2ab14c=_0x12c769['ZxkfH'](getworldvar,_0x2bee49)||'';return _0x5d7d6d&&(_0x12c769[_0x592fd4(0x32d,0x2f1,0x30c,0x2e8)]!==_0x1ff639(0x5b4,0x548,0x5c1,0x573)?_0x266eb9[_0x197263]=_0x445d7a[_0x1ff639(0x586,0x58f,0x525,0x571)](_0x2b2aab,_0x44c03d[_0x455748],_0x520692,_0x340346,_0x4342bc):_0x5d7d6d['add']('{@getworld'+'var::'+_0x2bee49+'@}')),_0x2ab14c;}else return{..._0x102af7,'text':_0x445d7a['ipWpz'](_0x57e4f7,_0x3059ac[_0x592fd4(0x307,0x311,0x364,0x37d)],_0x1a8ee6,_0x161df4)};});function _0x4d3388(_0xf3af5,_0x2c15ab,_0x215079,_0x599a14){return _0x4ae5(_0xf3af5-0x139,_0x2c15ab);}return _0x1746fe;}export function buildPromptWithTrigger(_0x464f32){const _0x508fa2={'DWbWZ':function(_0x2e8f3c,_0x166b28){return _0x2e8f3c!==_0x166b28;},'kABtJ':_0x44abc6(0x17a,0x193,0x160,0x1f0),'UaFxZ':function(_0x5f439b,_0x488038){return _0x5f439b!==_0x488038;},'ZyWua':_0x4b1921(0x23b,0x247,0x1fc,0x20e),'RHDDN':function(_0x8516e6,_0x8b9f47){return _0x8516e6===_0x8b9f47;},'xFDIx':_0x44abc6(0x237,0x1db,0x189,0x203),'CvkTX':_0x44abc6(0x20a,0x1c0,0x1f1,0x1fd),'sRWIE':function(_0xf778c0,_0x2b36bf){return _0xf778c0===_0x2b36bf;},'rQwaM':_0x4b1921(0x19f,0x1b3,0x1e6,0x154),'DkyPn':function(_0x3654e6,_0x477629,_0xa77efb){return _0x3654e6(_0x477629,_0xa77efb);},'wceCY':function(_0x796f53,_0xaae493){return _0x796f53!==_0xaae493;}},{requestType:_0x27a23c,contextData:_0x5ac3a9}=_0x464f32,_0x192abf=extension_settings[extensionName]?.['llm_reques'+_0x44abc6(0x1d1,0x1cc,0x170,0x1ec)+_0x44abc6(0x1cf,0x19a,0x1b0,0x16d)]||{},_0x532369={};_0x532369['context_pr'+_0x44abc6(0x1be,0x1b8,0x167,0x1ee)]='默认';const _0x4ed95b=_0x192abf[_0x27a23c]||_0x532369,_0x33156b=_0x4ed95b[_0x44abc6(0x137,0x163,0x174,0x110)+'ofile']||'默认',_0x4b4169=extension_settings[extensionName]?.[_0x44abc6(0x210,0x1ce,0x174,0x1ce)+_0x4b1921(0x29c,0x248,0x28b,0x20e)+'s']||{},_0x57d3e2=_0x4b4169[_0x33156b]||_0x4b4169[Object['keys'](_0x4b4169)[-0x1*0x116b+-0x21ab+0x1*0x3316]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x5ac3a9;function _0x44abc6(_0x1ae25e,_0x35d90f,_0x27f11b,_0x272e00){return _0x4ae5(_0x35d90f- -0x28,_0x1ae25e);}const _0x1a18b6=[userDemand,context,body,worldBookContent]['filter'](Boolean)['join']('\x0a');function _0x4b1921(_0x2b262f,_0x1f52a8,_0x4656e7,_0x17dba0){return _0x4ae5(_0x1f52a8-0x31,_0x4656e7);}const _0x50dbb0=[];if(_0x57d3e2[_0x4b1921(0x1b1,0x200,0x1f9,0x248)]&&Array[_0x4b1921(0x177,0x1b0,0x1be,0x1bb)](_0x57d3e2[_0x4b1921(0x20c,0x200,0x1be,0x252)])){if(_0x508fa2['RHDDN'](_0x508fa2[_0x4b1921(0x1c4,0x1c2,0x1dd,0x1b0)],_0x508fa2['CvkTX'])){if(_0x41d204[_0x4b1921(0x1d6,0x1ec,0x21e,0x19a)]&&_0x508fa2['DWbWZ'](_0x499319[_0x4b1921(0x242,0x1ec,0x1a5,0x203)][_0x44abc6(0x1af,0x1cd,0x227,0x185)](),'')){const _0x3b88af={};_0x3b88af[_0x4b1921(0x212,0x252,0x1f9,0x277)]=_0x508fa2[_0x44abc6(0x148,0x14c,0x19f,0x197)],_0x3b88af[_0x44abc6(0x195,0x16e,0x136,0x121)]=_0x11af9d[_0x4b1921(0x20c,0x1ec,0x1ea,0x1be)],_0x591b82['push'](_0x3b88af);}if(_0x2e165c[_0x4b1921(0x28b,0x247,0x215,0x29c)]&&_0x508fa2[_0x4b1921(0x249,0x24e,0x208,0x26b)](_0x4d62c2['assistant']['trim'](),'')){const _0x1fb3ba={};_0x1fb3ba['role']=_0x508fa2['ZyWua'],_0x1fb3ba['content']=_0x4a9ae1[_0x4b1921(0x276,0x247,0x256,0x20b)],_0x25381d[_0x44abc6(0x198,0x176,0x199,0x1ba)](_0x1fb3ba);}}else for(const _0x37e4d1 of _0x57d3e2[_0x44abc6(0x18c,0x1a7,0x1b2,0x201)]){if(!_0x37e4d1[_0x4b1921(0x1d5,0x1aa,0x1cd,0x176)])continue;if(!_0x37e4d1[_0x44abc6(0x163,0x16e,0x141,0x11c)]||_0x37e4d1['content'][_0x44abc6(0x1e5,0x1cd,0x18c,0x20d)]()==='')continue;if(_0x508fa2[_0x4b1921(0x18b,0x1ab,0x1c7,0x1ed)](_0x37e4d1[_0x44abc6(0x1dd,0x1b1,0x1a6,0x1a5)+'e'],_0x508fa2['rQwaM'])){if(!_0x508fa2[_0x44abc6(0x19e,0x168,0x1c2,0x1b8)](checkTriggerWords,_0x37e4d1[_0x4b1921(0x1c9,0x1dd,0x1eb,0x1d3)+'ds'],_0x1a18b6))continue;}const _0x1e32b6={};_0x1e32b6[_0x44abc6(0x1ce,0x1f9,0x1d5,0x1b2)]=_0x37e4d1[_0x44abc6(0x209,0x1f9,0x1f2,0x207)]||_0x508fa2['kABtJ'],_0x1e32b6[_0x4b1921(0x214,0x1c7,0x190,0x16e)]=_0x37e4d1[_0x44abc6(0x12b,0x16e,0x127,0x1b8)],_0x50dbb0[_0x44abc6(0x128,0x176,0x13e,0x12c)](_0x1e32b6);}}else{if(_0x57d3e2[_0x4b1921(0x1ec,0x1df,0x1a6,0x21b)]&&Array[_0x44abc6(0xff,0x157,0x16f,0x15f)](_0x57d3e2[_0x4b1921(0x1df,0x1df,0x1af,0x235)]))for(const _0x31e148 of _0x57d3e2[_0x4b1921(0x22d,0x1df,0x23c,0x1ec)]){if(_0x31e148[_0x4b1921(0x237,0x1ec,0x1e4,0x1aa)]&&_0x31e148[_0x44abc6(0x1eb,0x193,0x17f,0x164)]['trim']()!==''){if(_0x44abc6(0x1a4,0x1be,0x20d,0x169)===_0x44abc6(0x1a5,0x1d5,0x1b6,0x1dc))_0x17a135[_0x4b1921(0x1cf,0x1f1,0x1a1,0x1a5)](_0x44abc6(0x19f,0x17a,0x16d,0x133)+_0x44abc6(0x1b8,0x1a5,0x1ee,0x184)+_0x1b131b+'@}');else{const _0x4740f1={};_0x4740f1[_0x44abc6(0x1c2,0x1f9,0x251,0x1f1)]=_0x508fa2[_0x44abc6(0x109,0x14c,0x15b,0x167)],_0x4740f1[_0x4b1921(0x1e3,0x1c7,0x1ce,0x1ca)]=_0x31e148[_0x44abc6(0x153,0x193,0x18a,0x14c)],_0x50dbb0[_0x4b1921(0x17f,0x1cf,0x188,0x1b3)](_0x4740f1);}}if(_0x31e148[_0x4b1921(0x237,0x247,0x262,0x270)]&&_0x508fa2['wceCY'](_0x31e148[_0x44abc6(0x197,0x1ee,0x1e9,0x1f4)][_0x4b1921(0x1d0,0x226,0x1e5,0x26b)](),'')){const _0x5d0657={};_0x5d0657[_0x4b1921(0x257,0x252,0x206,0x267)]=_0x4b1921(0x233,0x247,0x29b,0x2a6),_0x5d0657[_0x4b1921(0x219,0x1c7,0x1f9,0x204)]=_0x31e148[_0x4b1921(0x26f,0x247,0x21a,0x222)],_0x50dbb0[_0x44abc6(0x196,0x176,0x118,0x142)](_0x5d0657);}}}const _0x5d4ac5=mergeAdjacentMessages(_0x50dbb0),{messages:_0x96f0e,replacedVariables:_0x1a0a18}=_0x508fa2[_0x4b1921(0x207,0x1c1,0x1ee,0x218)](replaceAllPlaceholders,_0x5d4ac5,_0x5ac3a9);return _0x96f0e;}export function getProcessedPrompt(_0x5eb264,_0x6cddf7){const _0x6777c1={};_0x6777c1[_0x3a2835(-0x1c4,-0x1e7,-0x1a6,-0x1a3)+'e']=_0x5eb264;function _0x3a2835(_0x5c36f4,_0x50f43f,_0x56d3a9,_0x3d5570){return _0x4ae5(_0x5c36f4- -0x3e4,_0x56d3a9);}function _0x3e9107(_0x500439,_0x378df1,_0xb1e34c,_0x5b4d3c){return _0x4ae5(_0x500439-0xb9,_0x378df1);}return _0x6777c1[_0x3e9107(0x23a,0x226,0x1f6,0x292)+'a']=_0x6cddf7,buildPromptWithTrigger(_0x6777c1);}