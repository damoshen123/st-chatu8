(function(_0x263031,_0x5ec3d0){const _0x4b0044=_0x263031();function _0x467618(_0x149ded,_0x3cf1f8,_0x288c84,_0x416c30){return _0x180a(_0x149ded-0x39c,_0x288c84);}function _0x5be024(_0x40cbb7,_0x2ff980,_0x2c7342,_0x12f5b3){return _0x180a(_0x2ff980- -0xc9,_0x12f5b3);}while(!![]){try{const _0x150976=-parseInt(_0x5be024(0x182,0x18d,0x1ac,0x1d7))/(0x2359*0x1+0xba0+-0x2ef8)+-parseInt(_0x5be024(0x118,0x12f,0x118,0x129))/(0xf7*0x18+0x1*-0x1ad+-0xef*0x17)+-parseInt(_0x467618(0x5d2,0x600,0x5d7,0x61b))/(-0x4*0x76d+0x2162+0x3*-0x139)+parseInt(_0x467618(0x613,0x5d6,0x62e,0x5c6))/(0x1120+0x1dcf+0x1*-0x2eeb)*(-parseInt(_0x5be024(0x140,0x184,0x14f,0x147))/(0x28*0xd7+-0x3*0x658+0x11*-0xdb))+-parseInt(_0x467618(0x5ac,0x596,0x598,0x55f))/(0x2062+-0x15a7+-0xab5)*(-parseInt(_0x467618(0x611,0x601,0x5e2,0x5f9))/(0x11*-0x1ed+0x81d*-0x4+0x1*0x4138))+parseInt(_0x467618(0x5e8,0x600,0x5b0,0x630))/(-0xa8d*0x3+-0x146*-0x4+-0x1a97*-0x1)+parseInt(_0x467618(0x5d9,0x603,0x5d4,0x596))/(0x1656+-0x2495*-0x1+-0x3ae2);if(_0x150976===_0x5ec3d0)break;else _0x4b0044['push'](_0x4b0044['shift']());}catch(_0x493c94){_0x4b0044['push'](_0x4b0044['shift']());}}}(_0x3fe0,0x2ac0b+0x378eb+-0x3*0xd11b));const _0x171178=(function(){let _0x1bae34=!![];return function(_0x386e4b,_0x3e3173){const _0x45d6d8=_0x1bae34?function(){function _0x28cf24(_0x44eb3c,_0x36bb47,_0x44c612,_0x4c38b3){return _0x180a(_0x44eb3c- -0x282,_0x44c612);}if(_0x3e3173){const _0x741c14=_0x3e3173[_0x28cf24(-0x4b,-0x8f,-0x80,-0x23)](_0x386e4b,arguments);return _0x3e3173=null,_0x741c14;}}:function(){};return _0x1bae34=![],_0x45d6d8;};}()),_0x5eae7f=_0x171178(this,function(){function _0x3021b7(_0xad1eb8,_0x4992f9,_0x266587,_0x4adeff){return _0x180a(_0xad1eb8-0x36e,_0x4992f9);}function _0x4bd136(_0x43b268,_0x271101,_0x25bdc1,_0x1e2851){return _0x180a(_0x25bdc1- -0x3d5,_0x43b268);}return _0x5eae7f['toString']()[_0x3021b7(0x5cf,0x5a2,0x581,0x5d0)](_0x3021b7(0x587,0x586,0x551,0x5a2)+'+$')['toString']()[_0x3021b7(0x595,0x5be,0x5b1,0x5c4)+'r'](_0x5eae7f)[_0x4bd136(-0x1bb,-0x171,-0x174,-0x150)](_0x3021b7(0x587,0x5c1,0x5c9,0x594)+'+$');});_0x5eae7f();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x4553d5,_0x1c112c){const _0x57afa0={};_0x57afa0[_0x32f83a(-0x16d,-0x143,-0x101,-0x14e)]=function(_0x3c1342,_0x17a015){return _0x3c1342||_0x17a015;},_0x57afa0['aiXVL']=function(_0x2d54bd,_0x37ff15){return _0x2d54bd===_0x37ff15;},_0x57afa0[_0x481515(0x212,0x21a,0x202,0x25f)]='cAWEA',_0x57afa0[_0x32f83a(-0x12a,-0x19a,-0x117,-0x14f)]=_0x32f83a(-0x187,-0x1a4,-0x160,-0x186);const _0x2d6f26=_0x57afa0;if(_0x2d6f26['bTviL'](!_0x4553d5,!_0x1c112c))return![];const _0x107b4b=_0x4553d5['split'](',')['map'](_0x5d3250=>_0x5d3250[_0x32f83a(-0x142,-0x15f,-0x198,-0x18e)]())[_0x481515(0x1dd,0x1d0,0x1bc,0x1aa)](_0x249f6b=>_0x249f6b);if(_0x2d6f26[_0x32f83a(-0x132,-0x10e,-0x130,-0x142)](_0x107b4b['length'],-0x1d*0x75+-0x24e7+0x3228)){if(_0x2d6f26[_0x32f83a(-0x120,-0x145,-0xf8,-0x142)](_0x481515(0x1a0,0x1cc,0x1cc,0x1c3),_0x2d6f26[_0x481515(0x212,0x1dd,0x1d9,0x1db)]))_0x285118['add'](_0x32f83a(-0x168,-0x158,-0x10c,-0x128)+_0x554994+'@}');else return![];}for(const _0x597f94 of _0x107b4b){if(_0x1c112c[_0x481515(0x1a7,0x178,0x19c,0x18d)](_0x597f94))return _0x2d6f26[_0x481515(0x1ec,0x1a0,0x19f,0x1f6)]===_0x2d6f26[_0x481515(0x1ec,0x1c7,0x211,0x1f9)]?!![]:!![];}function _0x481515(_0x2c4688,_0x6f6f90,_0x4e58a3,_0x56bf99){return _0x180a(_0x2c4688- -0x76,_0x6f6f90);}function _0x32f83a(_0x10af0e,_0x18c7cd,_0x4da450,_0x1943ba){return _0x180a(_0x1943ba- -0x3b1,_0x18c7cd);}return![];}export function mergeAdjacentMessages(_0x1fa3cf){const _0x1ef820={'RJzDi':function(_0x70fcd0,_0x175ab1,_0x48d065){return _0x70fcd0(_0x175ab1,_0x48d065);},'IEUxm':function(_0x2d8ce3,_0x313ffb,_0x328bec){return _0x2d8ce3(_0x313ffb,_0x328bec);},'RNVhr':function(_0x5c600c,_0x5e0552){return _0x5c600c===_0x5e0552;},'PnHMM':function(_0x532827,_0xcc50d8){return _0x532827!==_0xcc50d8;},'THTAe':_0x33781c(0x5af,0x5fb,0x5ae,0x598),'LuXjC':function(_0x10b4b7,_0x5ab443){return _0x10b4b7===_0x5ab443;},'dqgUm':function(_0x263370,_0x523815){return _0x263370!==_0x523815;},'YncDv':_0x3ae84e(0x3c4,0x3a3,0x377,0x37f),'FFGdl':_0x33781c(0x5a8,0x5b1,0x5ee,0x5eb)};function _0x3ae84e(_0x46c7ce,_0x3078da,_0x98f825,_0x22715c){return _0x180a(_0x3078da-0x151,_0x22715c);}if(!_0x1fa3cf||_0x1ef820['RNVhr'](_0x1fa3cf[_0x33781c(0x5a0,0x5d2,0x5b4,0x5c8)],-0x9*-0x440+0x761+-0x1*0x2da1))return[];const _0x370f42=[];let _0x182a0f=null;for(const _0x6f8180 of _0x1fa3cf){if(_0x1ef820[_0x3ae84e(0x41b,0x3dd,0x3c9,0x3a6)](_0x1ef820['THTAe'],_0x1ef820[_0x3ae84e(0x309,0x34f,0x39d,0x37a)]))_0x23d19a[_0x3ae84e(0x3a0,0x370,0x346,0x3a7)]=_0x1ef820['RJzDi'](_0x2f230e,_0x4f6718['content'],_0x397f0d[_0x3ae84e(0x3a6,0x370,0x3bf,0x396)]);else{if(!_0x182a0f){const _0x4acbdc={..._0x6f8180};_0x182a0f=_0x4acbdc;}else{if(_0x1ef820[_0x3ae84e(0x3ca,0x3e1,0x3b9,0x3f6)](_0x182a0f[_0x3ae84e(0x347,0x34c,0x36c,0x34a)],_0x6f8180[_0x3ae84e(0x33a,0x34c,0x392,0x31a)])){if(_0x33781c(0x5b5,0x64e,0x601,0x603)===_0x33781c(0x5c8,0x614,0x601,0x61a))_0x182a0f['content']=_0x1ef820[_0x33781c(0x555,0x55c,0x576,0x55e)](mergeContent,_0x182a0f[_0x3ae84e(0x360,0x370,0x32c,0x386)],_0x6f8180[_0x3ae84e(0x365,0x370,0x343,0x354)]);else{if(!_0x5e028f){const _0x297026={..._0x5b47c3};_0x564508=_0x297026;}else{if(_0x591cc5[_0x33781c(0x53f,0x563,0x56e,0x589)]===_0x4d0ce0[_0x33781c(0x548,0x58f,0x56e,0x54b)])_0x3d3b8d[_0x33781c(0x58c,0x599,0x592,0x5db)]=_0x1ef820['IEUxm'](_0x2b7e34,_0x15af4d[_0x33781c(0x584,0x576,0x592,0x56c)],_0xaeaa25['content']);else{_0x1bed00[_0x3ae84e(0x3b2,0x38d,0x3d6,0x39f)](_0x21a7ad);const _0x544251={..._0x301c4e};_0x3d2453=_0x544251;}}}}else{if(_0x1ef820['dqgUm'](_0x1ef820['YncDv'],_0x1ef820['FFGdl'])){_0x370f42[_0x33781c(0x570,0x5a9,0x5af,0x5ed)](_0x182a0f);const _0x1fbba9={..._0x6f8180};_0x182a0f=_0x1fbba9;}else{if(_0x500b4d[_0x33781c(0x5aa,0x5bc,0x590,0x5b7)](_0x168e4c))return!![];}}}}}_0x182a0f&&_0x370f42['push'](_0x182a0f);function _0x33781c(_0x2bee40,_0x20d7f8,_0x3e1f1e,_0x3ad057){return _0x180a(_0x3e1f1e-0x373,_0x20d7f8);}return _0x370f42;}function _0x180a(_0x8428d2,_0x4d255c){_0x8428d2=_0x8428d2-(0x192e+-0x83*-0x39+-0x26*0x161);const _0x4467c8=_0x3fe0();let _0x5339ca=_0x4467c8[_0x8428d2];if(_0x180a['QZgDkA']===undefined){var _0x1d7879=function(_0x4c67ea){const _0x2fea5d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x19de96='',_0x4c60a4='',_0x2d2acb=_0x19de96+_0x1d7879;for(let _0x4a417c=-0x1ea5+0x1abc+0x4d*0xd,_0x266b76,_0x5e45fd,_0x2104af=0x14b3+-0x1c74+-0x18d*-0x5;_0x5e45fd=_0x4c67ea['charAt'](_0x2104af++);~_0x5e45fd&&(_0x266b76=_0x4a417c%(-0x3f2+-0x1dd1*-0x1+-0x19db)?_0x266b76*(0x1e15+0x9d0+0xd37*-0x3)+_0x5e45fd:_0x5e45fd,_0x4a417c++%(-0xb*-0x311+0x2*-0xefe+-0x3bb))?_0x19de96+=_0x2d2acb['charCodeAt'](_0x2104af+(-0x1880+-0x12d0+0x2b5a))-(-0x11fe+0x1*-0x2f0+-0x29f*-0x8)!==0xf85+-0x2ff*-0x1+-0x1e*0x9e?String['fromCharCode'](-0x71*-0xc+-0x74*-0x6+-0x705&_0x266b76>>(-(-0x44c+-0x12eb+-0x1739*-0x1)*_0x4a417c&0x268f+0x1ced*-0x1+-0x4*0x267)):_0x4a417c:0x21f1+-0x180f*-0x1+-0x3a00){_0x5e45fd=_0x2fea5d['indexOf'](_0x5e45fd);}for(let _0x503ee9=0xa3f+-0x716+0x329*-0x1,_0x31e5c3=_0x19de96['length'];_0x503ee9<_0x31e5c3;_0x503ee9++){_0x4c60a4+='%'+('00'+_0x19de96['charCodeAt'](_0x503ee9)['toString'](0xb19+-0x24d8+0x19cf))['slice'](-(0x147*-0x9+0xb06+0x7b));}return decodeURIComponent(_0x4c60a4);};_0x180a['ZaRNZt']=_0x1d7879,_0x180a['CNMBqg']={},_0x180a['QZgDkA']=!![];}const _0x257279=_0x4467c8[0x21d3+-0x1*-0x241+-0x2414],_0x300d78=_0x8428d2+_0x257279,_0x94c462=_0x180a['CNMBqg'][_0x300d78];if(!_0x94c462){const _0xabac3=function(_0x5647c4){this['jFCyoA']=_0x5647c4,this['FKVQiR']=[-0x1d*0x4+0x2*0xcfe+-0x1987*0x1,0xcc*0x2b+0x22*0xa+-0x2398,0xda9+0x3*0x6d3+-0x2222],this['OPDVZx']=function(){return'newState';},this['OitHpb']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['cdTpcO']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xabac3['prototype']['KmEZtk']=function(){const _0x5690d1=new RegExp(this['OitHpb']+this['cdTpcO']),_0x28e12d=_0x5690d1['test'](this['OPDVZx']['toString']())?--this['FKVQiR'][0x50b+-0x56e+-0x14*-0x5]:--this['FKVQiR'][-0xfb0+0x892*-0x4+-0x31f8*-0x1];return this['qgLEkC'](_0x28e12d);},_0xabac3['prototype']['qgLEkC']=function(_0x26ab8a){if(!Boolean(~_0x26ab8a))return _0x26ab8a;return this['kKpYGJ'](this['jFCyoA']);},_0xabac3['prototype']['kKpYGJ']=function(_0x217961){for(let _0x596116=-0xf*-0x152+0x1*0x150b+-0x1*0x28d9,_0x45a732=this['FKVQiR']['length'];_0x596116<_0x45a732;_0x596116++){this['FKVQiR']['push'](Math['round'](Math['random']())),_0x45a732=this['FKVQiR']['length'];}return _0x217961(this['FKVQiR'][-0x5d4+-0x25c+-0x4*-0x20c]);},new _0xabac3(_0x180a)['KmEZtk'](),_0x5339ca=_0x180a['ZaRNZt'](_0x5339ca),_0x180a['CNMBqg'][_0x300d78]=_0x5339ca;}else _0x5339ca=_0x94c462;return _0x5339ca;}function mergeContent(_0x200a33,_0x46224b){const _0x4e8fd5={'PkTzd':function(_0x245b66,_0x232abb,_0x83924,_0x29d889){return _0x245b66(_0x232abb,_0x83924,_0x29d889);},'XPdWY':function(_0x9ed9ed,_0x2d8d74){return _0x9ed9ed===_0x2d8d74;},'dAoqb':_0x41ecf0(0x4b0,0x4bc,0x4a4,0x49e),'AtJuM':_0x41ecf0(0x4c7,0x4a1,0x4ce,0x4b8),'wvPRU':function(_0x47d527,_0x26ad2e){return _0x47d527+_0x26ad2e;},'TAmwJ':function(_0x19ec22,_0x10899f){return _0x19ec22+_0x10899f;},'jVLRf':function(_0x16357f,_0x2dc49f){return _0x16357f(_0x2dc49f);},'HtUWw':_0x2247aa(0x5cb,0x58b,0x58b,0x5e1)};if(_0x4e8fd5[_0x2247aa(0x5c2,0x5eb,0x606,0x58f)](typeof _0x200a33,_0x4e8fd5[_0x2247aa(0x57e,0x5b5,0x576,0x595)])&&_0x4e8fd5['XPdWY'](typeof _0x46224b,_0x4e8fd5[_0x2247aa(0x57e,0x550,0x58c,0x5a8)]))return _0x4e8fd5[_0x41ecf0(0x52f,0x4e9,0x528,0x4a7)](_0x4e8fd5[_0x41ecf0(0x4d5,0x4fc,0x502,0x4fd)],_0x4e8fd5['AtJuM'])?_0x4e8fd5[_0x41ecf0(0x4a6,0x4e6,0x4d6,0x4ee)](_0x4e8fd5[_0x2247aa(0x5f2,0x62b,0x609,0x5f3)](_0x200a33,'\x0a'),_0x46224b):{..._0x47f147,'text':_0x4e8fd5[_0x2247aa(0x5b2,0x5fb,0x5c7,0x5b0)](_0x3c28a5,_0x21ee03[_0x41ecf0(0x4d3,0x4f2,0x507,0x522)],_0xb27288,_0xfe9d37)};const _0x1913e4=normalizeToArray(_0x200a33),_0x562cdf=_0x4e8fd5[_0x2247aa(0x57c,0x59d,0x596,0x530)](normalizeToArray,_0x46224b);function _0x2247aa(_0x2f329f,_0x14bc1f,_0x54e41e,_0x2698fe){return _0x180a(_0x2f329f-0x367,_0x14bc1f);}const _0x14b664={};_0x14b664['type']=_0x4e8fd5[_0x41ecf0(0x508,0x4e8,0x4cc,0x4b3)],_0x14b664[_0x2247aa(0x5cb,0x5dc,0x61a,0x610)]='\x0a';function _0x41ecf0(_0x12aa7c,_0x2364f1,_0xe79659,_0x5b0a9d){return _0x180a(_0x2364f1-0x28e,_0x12aa7c);}return[..._0x1913e4,_0x14b664,..._0x562cdf];}function normalizeToArray(_0x55e27a){const _0x2e15ab={};_0x2e15ab[_0x27d5f2(0x424,0x456,0x47d,0x422)]='text';function _0x39ef2a(_0x30651b,_0xb9cf09,_0x3594cf,_0x1538f6){return _0x180a(_0x1538f6- -0x2e5,_0x3594cf);}_0x2e15ab[_0x27d5f2(0x45e,0x464,0x495,0x4a6)]=function(_0x28df83,_0x6d6d45){return _0x28df83||_0x6d6d45;};function _0x27d5f2(_0x104f14,_0x12d4a4,_0x514c62,_0x3978fc){return _0x180a(_0x12d4a4-0x235,_0x3978fc);}const _0x593fd9=_0x2e15ab;if(Array[_0x27d5f2(0x4b0,0x49d,0x46b,0x4b5)](_0x55e27a))return _0x55e27a;return[{'type':_0x593fd9['AMjff'],'text':_0x593fd9[_0x39ef2a(-0x8e,-0x9a,-0xdd,-0xb6)](_0x55e27a,'')}];}export function replacePlaceholder(_0x532258,_0x35ed62,_0x2a09fd,_0x278f6d){const _0x4fbc88={};_0x4fbc88[_0x4b73a2(-0x1dd,-0x1c2,-0x21e,-0x190)]=function(_0x2706f9,_0xa7924c){return _0x2706f9===_0xa7924c;};function _0x2744ed(_0x5ee4eb,_0x2900a6,_0x926f53,_0x5ffdaa){return _0x180a(_0x2900a6- -0xee,_0x5ffdaa);}_0x4fbc88['zPbOv']=_0x2744ed(0x124,0x140,0x17e,0x16f),_0x4fbc88[_0x4b73a2(-0x165,-0x164,-0x1b1,-0x15e)]=_0x2744ed(0x186,0x169,0x172,0x17a),_0x4fbc88[_0x2744ed(0x149,0x138,0x136,0x173)]=function(_0x225044,_0x5c2a3f){return _0x225044===_0x5c2a3f;},_0x4fbc88[_0x2744ed(0x131,0x155,0x15b,0x151)]=_0x2744ed(0x19e,0x191,0x17f,0x17b);const _0x7e00a1=_0x4fbc88;function _0x4b73a2(_0x500f38,_0x4b3da3,_0x77e107,_0x19a98d){return _0x180a(_0x500f38- -0x3d6,_0x19a98d);}if(_0x7e00a1[_0x4b73a2(-0x1dd,-0x1ef,-0x1a2,-0x1e1)](typeof _0x532258,_0x7e00a1['zPbOv']))return _0x2a09fd&&_0x532258[_0x2744ed(0x11a,0x12f,0x130,0x105)](_0x35ed62)&&(_0x278f6d&&_0x278f6d[_0x4b73a2(-0x1c5,-0x17c,-0x1dc,-0x1d8)](_0x35ed62)),_0x532258['replaceAll'](_0x35ed62,_0x2a09fd||'');if(Array[_0x2744ed(0x13a,0x17a,0x193,0x18b)](_0x532258)){if(_0x7e00a1[_0x2744ed(0xe1,0x10b,0x14a,0x13d)](_0x7e00a1[_0x2744ed(0x1d0,0x183,0x147,0x155)],_0x7e00a1[_0x4b73a2(-0x165,-0x16d,-0x11d,-0x193)]))return _0x532258[_0x4b73a2(-0x15c,-0x19a,-0x135,-0x18b)](_0x3b0119=>replacePlaceholder(_0x3b0119,_0x35ed62,_0x2a09fd,_0x278f6d));else _0x25d1c2[_0x4b73a2(-0x1a6,-0x1b1,-0x194,-0x163)+'ta'][_0x4b73a2(-0x16c,-0x154,-0x1a1,-0x164)]={};}if(_0x532258&&_0x7e00a1[_0x4b73a2(-0x1b0,-0x166,-0x17b,-0x1c8)](typeof _0x532258,_0x7e00a1['GtVEf'])){const _0x564314={};for(const _0x3e0005 in _0x532258){_0x564314[_0x3e0005]=replacePlaceholder(_0x532258[_0x3e0005],_0x35ed62,_0x2a09fd,_0x278f6d);}return _0x564314;}return _0x532258;}export function replaceAllPlaceholders(_0x12523d,_0x531db9){const _0x453289={'TzhyR':function(_0x1d7e4b){return _0x1d7e4b();},'rFEDX':function(_0x2da7f8,_0x1f2394){return _0x2da7f8===_0x1f2394;},'xFRLM':'tNALj','ToAXS':_0x5d6099(0x6c,0x25,0x67,0x9a),'iwpIX':function(_0x4ca895,_0x133d54,_0x3fb22f,_0x407126,_0x12795f){return _0x4ca895(_0x133d54,_0x3fb22f,_0x407126,_0x12795f);},'fanng':_0x29c8c1(0x12e,0x179,0x1a3,0x156),'nDwHJ':function(_0x266b9c,_0x114183,_0x4a7408,_0x57b3a1,_0x333683){return _0x266b9c(_0x114183,_0x4a7408,_0x57b3a1,_0x333683);},'cfxTf':_0x29c8c1(0x213,0x1da,0x1f3,0x1d5),'qXNBv':function(_0x330b96,_0xe17328,_0x22ea73,_0x25daa2,_0x16fa0e){return _0x330b96(_0xe17328,_0x22ea73,_0x25daa2,_0x16fa0e);},'OLphQ':'{{正文}}','yPPaY':_0x29c8c1(0x13c,0x1a9,0x16f,0x183),'PHmXF':function(_0x5056b7,_0xd5e4b7,_0x164b82,_0x19a085,_0x2fc9ae){return _0x5056b7(_0xd5e4b7,_0x164b82,_0x19a085,_0x2fc9ae);},'Fxohp':_0x29c8c1(0x1c4,0x194,0x200,0x1ba)+'}}','JloWa':function(_0x5f3fb4,_0x12ffc8,_0xc2cf8b,_0x596ad3,_0x5d45a2){return _0x5f3fb4(_0x12ffc8,_0xc2cf8b,_0x596ad3,_0x5d45a2);},'WKBET':'{{通用角色启用列表'+'}}','fSkNe':function(_0x4356f6,_0x1fbe3c,_0x4d980e,_0x2b7ed8,_0x27fcdd){return _0x4356f6(_0x1fbe3c,_0x4d980e,_0x2b7ed8,_0x27fcdd);},'lFKhu':function(_0x31c72a,_0x5e5287){return _0x31c72a>_0x5e5287;},'ZksCR':function(_0x5bed0a,_0x3c3084,_0x27c88b){return _0x5bed0a(_0x3c3084,_0x27c88b);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x531db9,_0x45c61c=new Set();let _0x18c41a=_0x12523d;const _0x13aac9=_0x453289[_0x29c8c1(0x1ba,0x17a,0x1a5,0x1c3)](getContext),_0x471e3b=_0x13aac9?.[_0x5d6099(0x89,0xce,0xd2,0x41)]||'';let _0x39afde=worldBookContent;if(_0x39afde){if(_0x453289['rFEDX'](_0x453289[_0x5d6099(0x79,0x67,0x33,0xab)],_0x453289['xFRLM']))_0x39afde=_0x39afde[_0x5d6099(0x45,0x64,0x3d,0x22)](_0x453289[_0x5d6099(-0x4,-0x49,-0x46,-0x1)],_0x471e3b),_0x39afde=_0x39afde['replaceAll'](_0x5d6099(0x6d,0xb3,0xb3,0xb2),_0x471e3b);else{const _0xb39cc6=_0x35cc36[_0x5d6099(0x29,-0x1f,0x18,0x23)]();return _0x996226[_0x29c8c1(0x15f,0x1c6,0x14d,0x181)+'ta'][_0x5d6099(0x70,0x2a,0x80,0x6b)][_0xb39cc6]=_0x284547,_0x56c072&&_0x5170f4[_0x29c8c1(0x13d,0x1aa,0x145,0x162)]('{@setvar::'+_0xb39cc6+'@}'),'';}}_0x18c41a=_0x453289[_0x29c8c1(0x144,0x19a,0x14e,0x17b)](replacePlaceholder,_0x18c41a,_0x453289[_0x5d6099(0x3e,0x32,0x20,0x49)],context,_0x45c61c),_0x18c41a=_0x453289['nDwHJ'](replacePlaceholder,_0x18c41a,_0x453289[_0x29c8c1(0x1a6,0x176,0x1a3,0x15c)],_0x39afde,_0x45c61c);function _0x29c8c1(_0xf8713d,_0x1b3c17,_0x20e6fd,_0x5956f0){return _0x180a(_0x5956f0- -0xaf,_0x1b3c17);}function _0x5d6099(_0x1a010d,_0x458f18,_0x39401b,_0x455610){return _0x180a(_0x1a010d- -0x1fa,_0x458f18);}_0x18c41a=_0x453289['qXNBv'](replacePlaceholder,_0x18c41a,_0x453289[_0x5d6099(0x4e,0x3,0x3d,0x71)],body,_0x45c61c),_0x18c41a=_0x453289[_0x29c8c1(0x1a3,0x20b,0x1a7,0x1e0)](replacePlaceholder,_0x18c41a,_0x453289['yPPaY'],characterListText,_0x45c61c),_0x18c41a=_0x453289[_0x29c8c1(0x139,0x117,0x191,0x15b)](replacePlaceholder,_0x18c41a,_0x453289['Fxohp'],outfitEnableListText,_0x45c61c),_0x18c41a=_0x453289[_0x29c8c1(0x20a,0x205,0x1d3,0x1d8)](replacePlaceholder,_0x18c41a,_0x453289[_0x29c8c1(0x1fe,0x18a,0x192,0x1ce)],commonCharacterListText,_0x45c61c),_0x18c41a=_0x453289['fSkNe'](replacePlaceholder,_0x18c41a,_0x29c8c1(0x1b1,0x18e,0x1bc,0x185),userDemand,_0x45c61c);if(variables&&_0x453289['lFKhu'](Object[_0x29c8c1(0x15e,0x18d,0x14f,0x191)](variables)['length'],0x2421+-0xd8f+-0x1692)){const _0x35d928=/\{\{getvar::([^}]+)\}\}/g,_0x106d0d=JSON['stringify'](_0x18c41a),_0x489a00=[..._0x106d0d[_0x5d6099(0x2e,-0x6,-0x18,0x75)](_0x35d928)],_0x100bca=new Set();for(const _0x396b7b of _0x489a00){_0x100bca[_0x29c8c1(0x1a9,0x158,0x19d,0x162)](_0x396b7b[-0x1390+-0x1f42+0x32d3]);}for(const _0x2db015 of _0x100bca){const _0x507f8f='{{getvar::'+_0x2db015+'}}',_0x1cb8ac=variables[_0x2db015]||'';_0x18c41a=replacePlaceholder(_0x18c41a,_0x507f8f,_0x1cb8ac,_0x45c61c);}}_0x18c41a=_0x453289[_0x29c8c1(0x178,0x173,0x1d6,0x197)](processVariablePlaceholdersInMessages,_0x18c41a,_0x45c61c);const _0x31f25e={};return _0x31f25e[_0x29c8c1(0x1db,0x17c,0x1b8,0x1c7)]=_0x18c41a,_0x31f25e['replacedVa'+_0x5d6099(0xc,0x38,-0x37,0x4c)]=_0x45c61c,_0x31f25e;}function _0x3fe0(){const _0x7230c9=['mZyWz21SyLH4','ywrK','E0bZzxrNBg9Iyq','tvDAzNG','y29UDgv4DerHDa','ALzmuMy','quDjCKm','zefVCwi','tffWCwy','kcGOlISPkYKRkq','rvzxuhi','qM5XD2S','sgP0quO','Aw5JBhvKzxm','E0bNzxrNBg9Iyq','y29UDgvUDa','yxnZAxn0yw50','qu1QzMy','vKX0rMG','DhjPBq','wg9NwK0','EhrFChjVzMLSzq','yNfez0C','y29UC3rYDwn0BW','Bwf0y2HbBgW','B2jYq20','AxDWsvG','CLb5vwG','qu51rMC','sMLRrwC','C3rYAw5N','D2jODvm','y2HHDe1LDgfKyq','BhzHCJO6','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','B3fry2m','E3VNLkJMIlFPNidMSyj9Fq','ChHUzMK','mtiYnJuZnunlEvniDG','yxbWBhK','zMfUBMC','CejftxC','uhrQvfq','BurSDuW','ChvZAa','ntK2odqXm0LUDMHkzW','zKXxzfO','CMvWBgfJzufSBa','A2v5CW','BgvUz3rO','AM9PBG','r3rwrwy','AfPvrxu','wxDUv3C','wMTZq1i','E0bNzxr2yxi6oG','t0XWAfe','ve1UAhi','zw50CMLLCW','ugTuEMq','mZeXmdG4mgPtr0PfCa','mtC1odi2nvPpu3ruvq','ww1MEeO','y29UDgv4Df9WCG','y2vzDLy','q09rze4','u3HoBwy','zMLSDgvY','uM1Uzgm','swHIuMW','mZq1odu1yNbMzNLL','AxfkDwe','D3zquLu','CgXvueu','shrvv3C','wfbKv1K','AwHJtKC','CgTOqNe','qwziCxi','r1bjA3a','rwPZy0O','C2vHCMnO','BK1TD1y','yLr2AuW','Dgv4Da','zw5HyMXLza','E3T1C2vYFx0','phvZzxi+','AxnbCNjHEq','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','DMfYAwfIBgvZ','DhjPz2DLCG','zNb3u2O','v3Pvwe4','qxrkDu0','ywLyvKW','t0zSCK0','vLb5zM0','vhPOEvi','Eezste0','A1zWEu0','nduXotjyvMrKtKC','BwvZC2fNzxm','nhPkB2POBq','te5IDxe','BuzREe0','BwfW','uhzzzMm','zNLTweG','v0Tcrvq','s2nVvhu','B2jQzwn0','y0H5B3O','DxnLCG','zwHYA2y','BMfTzte','E3VKUjBNLyZKUABOP6BLJ5f9Fq','DhjPz2DLCK1Vza','tLbrDg0','sMXVv2e','zLrLDKC','E0bZzxr2yxi6oG','CNbNrKi','vefTD0O','ug5itu0','B2zPBgu','BxzhB3G','BKr3seO','thvyAKm','sgnZwK4','tgPMyMW','CMvWBgfJzq','vg9bwfm','Df90ExbLx2nVBG','mtGXodC4s01OtfvA','DNPSzMq','C1fUtK0','CM9Szq','zMLNCW','D1LUEMy','veHuqwu','D3HYEgy','qLvPBKq','tMroD0G','DgvZDf9JB250zq','uKP6rgK','DhLWzq','E3VKUiRKUiVMLOD9Fq','CMLHyMXLCW','DMfYoJO','y0jivva','D2fwuLe','ueHTwey','y2z4vgy','AgLZDg9YEq','wLv0DLi','u0Tvvvq','D0jJDNm'];_0x3fe0=function(){return _0x7230c9;};return _0x3fe0();}function processVariablePlaceholdersInMessages(_0x51993b,_0x6c469c){const _0x3bb314={'COQdN':function(_0x1a15a6,_0x427170,_0x5004ed,_0x5ed158){return _0x1a15a6(_0x427170,_0x5004ed,_0x5ed158);},'wYnzf':function(_0x1c78c5,_0x58ad7f,_0x553d72,_0x561c8d){return _0x1c78c5(_0x58ad7f,_0x553d72,_0x561c8d);},'YwnWw':function(_0xfa73a5,_0x1d55b4){return _0xfa73a5===_0x1d55b4;},'plUPE':function(_0x2a2fef){return _0x2a2fef();},'HcsZN':'ExlET','cHyoz':function(_0x2704d0,_0xf76450){return _0x2704d0!==_0xf76450;},'IhbRl':_0xba1c77(0x47e,0x473,0x4b6,0x4a0)};function _0xf097f2(_0x1f71b8,_0x5e53dd,_0x3b15ae,_0x3e700d){return _0x180a(_0x5e53dd- -0x128,_0x3b15ae);}if(!_0x51993b||_0x3bb314[_0xba1c77(0x48a,0x461,0x46d,0x467)](_0x51993b[_0xba1c77(0x486,0x469,0x439,0x4c2)],0x1*0x386+0x2*0x6e6+0x8a9*-0x2))return _0x51993b;function _0xba1c77(_0x5c97fe,_0x432856,_0x2b5bb9,_0x4106e8){return _0x180a(_0x5c97fe-0x245,_0x2b5bb9);}const _0x4206e1=_0x3bb314[_0xf097f2(0x110,0x131,0xf8,0x134)](getContext);if(!_0x4206e1[_0xf097f2(0xed,0x108,0x141,0x155)+'ta']){if(_0x3bb314[_0xf097f2(0xfc,0xcb,0xcf,0xd3)]!==_0x3bb314['HcsZN']){if(!_0x3c9cd6||!_0x3bbfb2[_0xf097f2(0xc2,0xf7,0xad,0xaa)])return _0xcd8d0d;return{..._0x5f1f64,'content':_0x3bb314[_0xba1c77(0x496,0x48e,0x479,0x4e2)](_0x210e03,_0x3a08ea[_0xba1c77(0x464,0x438,0x4ae,0x450)],_0x14f3e1,_0x18ec0b)};}else _0x4206e1[_0xba1c77(0x475,0x473,0x472,0x4aa)+'ta']={};}return!_0x4206e1[_0xf097f2(0xeb,0x108,0xbe,0xef)+'ta'][_0xf097f2(0x188,0x142,0x166,0x15b)]&&(_0x3bb314[_0xf097f2(0x117,0x158,0x15e,0x19f)](_0x3bb314['IhbRl'],_0x3bb314[_0xf097f2(0x122,0x12d,0x11c,0x13b)])?_0x5b4c9b['chatMetada'+'ta']={}:_0x4206e1[_0xf097f2(0xe5,0x108,0x10d,0x131)+'ta']['variables']={}),_0x51993b[_0xba1c77(0x4bf,0x4f6,0x4ad,0x4b6)](_0x259bad=>{function _0x48869b(_0x33cc6c,_0x1df7ff,_0x74fca8,_0x1327c1){return _0xba1c77(_0x33cc6c- -0x5ac,_0x1df7ff-0xe5,_0x74fca8,_0x1327c1-0x1b3);}function _0xc110a8(_0x402412,_0x4af55d,_0xb14d69,_0xb94141){return _0xba1c77(_0xb94141- -0x5c1,_0x4af55d-0x80,_0x402412,_0xb94141-0x46);}if(!_0x259bad||!_0x259bad[_0x48869b(-0x148,-0x15c,-0x139,-0x105)])return _0x259bad;return{..._0x259bad,'content':_0x3bb314[_0x48869b(-0x16a,-0x185,-0x15a,-0x1af)](processContentVariables,_0x259bad[_0xc110a8(-0x14d,-0x184,-0x139,-0x15d)],_0x4206e1,_0x6c469c)};});}function processContentVariables(_0x24bb25,_0x1a23d2,_0x4bd940){function _0xfce67d(_0x3efeea,_0x52bc8a,_0x295b11,_0x44cfd6){return _0x180a(_0x52bc8a- -0x35,_0x44cfd6);}const _0x27f863={};_0x27f863['Rmndc']=_0xfce67d(0x270,0x22f,0x24b,0x255),_0x27f863[_0xfce67d(0x212,0x214,0x237,0x23f)]=function(_0x110922,_0xd6f513){return _0x110922===_0xd6f513;},_0x27f863[_0x1647c5(0x310,0x2d9,0x2fa,0x2a7)]='string',_0x27f863[_0xfce67d(0x263,0x238,0x210,0x278)]=function(_0x27ab90,_0x23c20b){return _0x27ab90===_0x23c20b;};function _0x1647c5(_0x46745d,_0x130518,_0x3c0fe7,_0x254344){return _0x180a(_0x130518-0xc1,_0x254344);}_0x27f863[_0x1647c5(0x2ea,0x2cf,0x2d3,0x304)]='aeuJX';const _0x183c7f=_0x27f863;if(_0x183c7f[_0xfce67d(0x22f,0x238,0x250,0x234)](typeof _0x24bb25,_0x1647c5(0x2de,0x2ef,0x33d,0x2d5)))return processStringVariables(_0x24bb25,_0x1a23d2,_0x4bd940);if(Array[_0x1647c5(0x2dc,0x329,0x364,0x332)](_0x24bb25))return _0x24bb25[_0x1647c5(0x31d,0x33b,0x335,0x2f6)](_0x336596=>{function _0x25a02e(_0x50944a,_0x56715e,_0x4260e6,_0x59167e){return _0xfce67d(_0x50944a-0x65,_0x50944a- -0x183,_0x4260e6-0xaa,_0x4260e6);}function _0x40dfd1(_0x1621bb,_0x3fb3fc,_0x4733fd,_0x1a6650){return _0x1647c5(_0x1621bb-0x18b,_0x4733fd- -0xf7,_0x4733fd-0x1bc,_0x3fb3fc);}if(_0x336596&&_0x336596['type']===_0x183c7f[_0x25a02e(0x9c,0x5f,0x59,0x50)]&&_0x183c7f[_0x40dfd1(0x207,0x1ed,0x213,0x1f9)](typeof _0x336596['text'],_0x183c7f[_0x25a02e(0x60,0x6e,0x9d,0x8f)])){if(_0x183c7f[_0x40dfd1(0x218,0x210,0x237,0x252)](_0x183c7f[_0x40dfd1(0x1fb,0x225,0x1d8,0x226)],_0x183c7f[_0x40dfd1(0x1fa,0x1d6,0x1d8,0x1e6)]))return{..._0x336596,'text':processStringVariables(_0x336596[_0x40dfd1(0x244,0x263,0x22e,0x227)],_0x1a23d2,_0x4bd940)};else _0x4f68fc['push'](_0x2580da);}return _0x336596;});return _0x24bb25;}function processStringVariables(_0x41a935,_0x4036fc,_0x1d3910){const _0x2a1f62={'ihcNG':function(_0x59680f,_0x206c85){return _0x59680f!==_0x206c85;},'Ljfbl':'NgVuQ','AfHqr':function(_0x1e062c,_0x3f048d){return _0x1e062c===_0x3f048d;},'KbZMX':function(_0x19f5e3,_0x39a5e1){return _0x19f5e3===_0x39a5e1;},'gKgaI':function(_0x2e852e,_0x5d956d){return _0x2e852e===_0x5d956d;},'sQnNM':_0x2c01d3(0x579,0x532,0x574,0x54b),'mHKfi':_0x2c01d3(0x543,0x513,0x55b,0x578),'pxnfi':function(_0x46b431,_0x1f7857,_0x1627cd){return _0x46b431(_0x1f7857,_0x1627cd);},'YqxBj':function(_0x48ea60,_0x3e8694){return _0x48ea60!==_0x3e8694;},'NPQtm':function(_0x680bc1,_0x29288c){return _0x680bc1(_0x29288c);},'pkhBq':function(_0x36aedf,_0x51c3a5){return _0x36aedf!==_0x51c3a5;},'obrCm':_0x3250bb(0x13c,0x166,0x1c5,0x185)};if(!_0x41a935)return _0x41a935;let _0x47dd13=_0x41a935;_0x47dd13=_0x47dd13['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x573dae,_0x505b50,_0x32b72f)=>{function _0x1d13f8(_0x5e1279,_0x49905c,_0x2432fb,_0x4cc7b8){return _0x2c01d3(_0x49905c- -0x2c1,_0x5e1279,_0x2432fb-0x40,_0x4cc7b8-0x179);}const _0x3667c7=_0x505b50[_0x1d13f8(0x234,0x277,0x2a5,0x23d)]();_0x4036fc[_0x1d13f8(0x25e,0x284,0x2b2,0x2a8)+'ta'][_0xf2a4fa(-0xe1,-0xcd,-0xfc,-0xae)][_0x3667c7]=_0x32b72f;_0x1d3910&&_0x1d3910['add'](_0xf2a4fa(-0xc2,-0x109,-0xef,-0x10b)+_0x3667c7+'@}');function _0xf2a4fa(_0x22cb70,_0x361a9f,_0x232fe5,_0x24fdb1){return _0x3250bb(_0x22cb70-0x16e,_0x361a9f-0x35,_0x24fdb1,_0x22cb70- -0x2d0);}return'';}),_0x47dd13=_0x47dd13[_0x3250bb(0x15a,0x1c7,0x1c6,0x17a)](/\{@getvar::([^@]+)@\}/g,(_0x37861e,_0x475f94)=>{const _0x3b66d2=_0x475f94[_0x136ba8(0x11f,0xf8,0x114,0x13b)](),_0x49f687=_0x4036fc['chatMetada'+'ta'][_0x136ba8(0x16a,0x191,0x15b,0x167)][_0x3b66d2]||'';function _0x136ba8(_0x52b04e,_0x580da5,_0x39a59b,_0x2eec2b){return _0x2c01d3(_0x39a59b- -0x424,_0x580da5,_0x39a59b-0x105,_0x2eec2b-0x43);}if(_0x1d3910){if(_0x2a1f62[_0x136ba8(0x148,0x13f,0x14d,0x134)](_0x2a1f62[_0x12765b(0xed,0x9e,0xc0,0xa1)],_0x12765b(0xf7,0xdd,0x91,0xcc)))_0x1d3910['add'](_0x136ba8(0x179,0x14e,0x138,0x143)+_0x3b66d2+'@}');else{const _0x48c89f={..._0x58f82c};_0xa53437=_0x48c89f;}}function _0x12765b(_0x1e923f,_0x27a2a7,_0x5af96f,_0x5694fb){return _0x2c01d3(_0x27a2a7- -0x46b,_0x5af96f,_0x5af96f-0x1bc,_0x5694fb-0xf6);}return _0x49f687;});function _0x3250bb(_0x27e90d,_0x14bef4,_0x290a8c,_0x36fa58){return _0x180a(_0x36fa58- -0x7b,_0x290a8c);}_0x47dd13=_0x47dd13[_0x2c01d3(0x50a,0x4bf,0x4d8,0x4e8)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x72c660,_0x2e9023,_0x588ffd)=>{function _0x13eae8(_0x2adb99,_0x136e4e,_0x3558c4,_0x297870){return _0x2c01d3(_0x136e4e-0x3b,_0x297870,_0x3558c4-0x18c,_0x297870-0x1c);}function _0x57a3c6(_0x49d2fb,_0x1571f5,_0x2833ee,_0x53bbbf){return _0x2c01d3(_0x2833ee- -0x6af,_0x1571f5,_0x2833ee-0xf4,_0x53bbbf-0xc0);}if(_0x2a1f62[_0x57a3c6(-0x14d,-0x11b,-0x13c,-0x15e)](_0x57a3c6(-0x15e,-0x123,-0x121,-0x154),_0x13eae8(0x5c5,0x5b0,0x5e3,0x59c))){const _0x27f97f={'wBcvs':function(_0x418be4,_0x53125d){function _0x38514f(_0x367233,_0x790343,_0x7f39e,_0x4fe487){return _0x13eae8(_0x367233-0x158,_0x7f39e- -0x536,_0x7f39e-0x85,_0x790343);}return _0x2a1f62[_0x38514f(0x78,0x5d,0x78,0x75)](_0x418be4,_0x53125d);},'eQNgm':function(_0x13bf0a,_0x43ba1b){return _0x2a1f62['KbZMX'](_0x13bf0a,_0x43ba1b);},'ZUtvR':_0x13eae8(0x550,0x57e,0x5b5,0x539),'NdNwH':function(_0x780eba,_0x38240c,_0xf7c417,_0x15bbd1){return _0x780eba(_0x38240c,_0xf7c417,_0x15bbd1);}};return _0x1f8e62[_0x13eae8(0x5ff,0x5ca,0x5d4,0x595)](_0x3df78b=>{if(_0x3df78b&&_0x27f97f[_0x33b7df(-0x8,-0x5f,-0x39,-0x10)](_0x3df78b['type'],'text')&&_0x27f97f['eQNgm'](typeof _0x3df78b[_0x33b7df(0x1e,-0x1b,0x1c,-0x1b)],_0x27f97f[_0x33b7df(0x3,-0x3a,-0x3b,-0x2d)]))return{..._0x3df78b,'text':_0x27f97f[_0x3e2724(0x173,0x1a0,0x1b8,0x133)](_0x1f3b9c,_0x3df78b[_0x3e2724(0x1d6,0x1d1,0x1b2,0x222)],_0x3b5f99,_0x482026)};function _0x3e2724(_0x2b22cd,_0x59e830,_0x177970,_0x307f5e){return _0x13eae8(_0x2b22cd-0x197,_0x2b22cd- -0x3de,_0x177970-0x12c,_0x177970);}function _0x33b7df(_0x3d887a,_0x21cc60,_0x318619,_0x5a9e27){return _0x13eae8(_0x3d887a-0xc2,_0x318619- -0x598,_0x318619-0x8c,_0x5a9e27);}return _0x3df78b;});}else{const _0x163831=_0x2e9023[_0x13eae8(0x53c,0x573,0x58e,0x529)]();_0x2a1f62[_0x13eae8(0x562,0x585,0x56f,0x5aa)](setglobalvar,_0x163831,_0x588ffd);if(_0x1d3910){if(_0x2a1f62['YqxBj'](_0x57a3c6(-0x11b,-0xfb,-0x12a,-0x10b),_0x57a3c6(-0x130,-0x133,-0x12a,-0x167))){if(_0x5e7f6b&&_0x2a1f62['gKgaI'](_0x1316d1[_0x13eae8(0x53c,0x554,0x55e,0x5a3)],_0x2a1f62[_0x13eae8(0x551,0x54a,0x56d,0x53c)])&&_0x2a1f62['gKgaI'](typeof _0x36253f[_0x13eae8(0x59d,0x5b4,0x5af,0x5f4)],_0x2a1f62['mHKfi']))return{..._0x4961e7,'text':_0xb5541c(_0x49dc6e[_0x57a3c6(-0x17b,-0x116,-0x136,-0x11c)],_0xf41db3,_0x51fd32)};return _0x504e32;}else _0x1d3910[_0x13eae8(0x519,0x561,0x552,0x52a)](_0x57a3c6(-0x15c,-0x15d,-0x188,-0x17f)+'lvar::'+_0x163831+'@}');}return'';}});function _0x2c01d3(_0x1db30b,_0x424d4a,_0x4d87c9,_0x1c766c){return _0x180a(_0x1db30b-0x315,_0x424d4a);}return _0x47dd13=_0x47dd13[_0x3250bb(0x13f,0x14b,0x1c8,0x17a)](/\{@getglobalvar::([^@]+)@\}/g,(_0x3a27d4,_0x4df847)=>{const _0x1f0993=_0x4df847[_0x1cdd7c(0x4e,0xe2,0xa5,0x9d)]();function _0x1cdd7c(_0x32e298,_0x582385,_0x42fe29,_0xd34f4a){return _0x3250bb(_0x32e298-0x41,_0x582385-0x18e,_0x582385,_0xd34f4a- -0x10b);}function _0xf7a04d(_0x42f7ad,_0x58655e,_0x1abe03,_0x5ad6af){return _0x2c01d3(_0x42f7ad- -0x3f9,_0x58655e,_0x1abe03-0x81,_0x5ad6af-0xfc);}const _0x397f0e=_0x2a1f62[_0x1cdd7c(0x12e,0x106,0x110,0x100)](getglobalvar,_0x1f0993)||'';return _0x1d3910&&_0x1d3910[_0xf7a04d(0x12d,0xfb,0x119,0x175)]('{@getgloba'+'lvar::'+_0x1f0993+'@}'),_0x397f0e;}),_0x47dd13=_0x47dd13[_0x2c01d3(0x50a,0x516,0x4fb,0x4cd)](/\{@getworldvar::([^@]+)@\}/g,(_0x40e2bf,_0x30144)=>{function _0x4d2f9f(_0x21480a,_0x33fdeb,_0x2a8997,_0x3c348d){return _0x3250bb(_0x21480a-0xf,_0x33fdeb-0x162,_0x2a8997,_0x21480a-0x45b);}function _0x298174(_0x1b96f3,_0x18c178,_0x2e25d7,_0x5b2c74){return _0x2c01d3(_0x1b96f3- -0x1d4,_0x5b2c74,_0x2e25d7-0x1b4,_0x5b2c74-0x169);}if(_0x2a1f62[_0x4d2f9f(0x63d,0x66d,0x665,0x5ef)](_0x298174(0x341,0x38b,0x356,0x377),_0x2a1f62[_0x298174(0x36a,0x344,0x32f,0x39b)]))_0x39a0eb[_0x4d2f9f(0x5f1,0x60c,0x619,0x5fe)](_0x4d2f9f(0x5fe,0x611,0x648,0x61b)+_0x4d2f9f(0x611,0x64b,0x656,0x619)+_0x35d421+'@}');else{const _0x4d5285=_0x30144['trim'](),_0x13fc2d=_0x2a1f62[_0x298174(0x3c7,0x3de,0x3a6,0x3cb)](getworldvar,_0x4d5285)||'';return _0x1d3910&&_0x1d3910['add']('{@getworld'+_0x298174(0x348,0x31b,0x345,0x34f)+_0x4d5285+'@}'),_0x13fc2d;}}),_0x47dd13;}export function buildPromptWithTrigger(_0x12dfe9){const _0x27ab16={'KcoTu':function(_0x523fb9,_0x24d1a6,_0x2c320e,_0x18b2b9){return _0x523fb9(_0x24d1a6,_0x2c320e,_0x18b2b9);},'Bnqwk':function(_0xaaaf3e,_0x54e1f5){return _0xaaaf3e===_0x54e1f5;},'rpgFB':function(_0x350f86){return _0x350f86();},'fLWdZ':'user','EVWPr':function(_0xa5280e,_0x4b76d6){return _0xa5280e+_0x4b76d6;},'ehrkf':function(_0x4da218,_0x271d7b){return _0x4da218!==_0x271d7b;},'GPIkp':function(_0x490397,_0x45555f){return _0x490397===_0x45555f;},'OmjXk':_0x2ebecc(0x10e,0x138,0x136,0x139),'fymXH':function(_0x71efe1,_0x300255){return _0x71efe1===_0x300255;},'Dsfks':function(_0xc18e12,_0x1c6d8c,_0x47cb3d){return _0xc18e12(_0x1c6d8c,_0x47cb3d);},'LNbuq':'aWpuD','XogZM':_0x319fc1(0x1b7,0x187,0x1ac,0x1d5),'iWega':function(_0x1c01ce,_0x370807){return _0x1c01ce!==_0x370807;},'ANuFg':_0x2ebecc(0x157,0x133,0x16d,0x13a),'kVpyM':_0x2ebecc(0xdf,0xd0,0xd7,0xea),'JikEg':_0x2ebecc(0x11b,0x10a,0xf5,0xcd),'ceYvV':_0x319fc1(0x1b5,0x1e8,0x19b,0x1e8),'cBHUP':function(_0x4c1166,_0x59d093,_0x53b55f){return _0x4c1166(_0x59d093,_0x53b55f);}},{requestType:_0x4113c9,contextData:_0x2bcf30}=_0x12dfe9,_0x21b691=extension_settings[extensionName]?.['llm_reques'+_0x319fc1(0x18c,0x1ac,0x169,0x15f)+_0x2ebecc(0x8f,0x100,0xd2,0xca)]||{},_0x30c84b={};_0x30c84b[_0x2ebecc(0x109,0xf8,0x157,0x11d)+_0x2ebecc(0x110,0x19f,0x19a,0x15b)]='默认';const _0x45b4ba=_0x21b691[_0x4113c9]||_0x30c84b,_0x5f4a57=_0x45b4ba[_0x319fc1(0x1e4,0x1da,0x231,0x1fe)+'ofile']||'默认',_0xf5bb02=extension_settings[extensionName]?.[_0x319fc1(0x197,0x17b,0x1c6,0x1da)+_0x319fc1(0x1ba,0x1b4,0x17d,0x184)+'s']||{},_0x93a2d=_0xf5bb02[_0x5f4a57]||_0xf5bb02[Object[_0x2ebecc(0xc4,0xfb,0xdc,0x10e)](_0xf5bb02)[-0x459+0x1058+-0xbff]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x2bcf30;function _0x2ebecc(_0x2d7adc,_0x308b31,_0x19ad19,_0x326f94){return _0x180a(_0x326f94- -0x132,_0x308b31);}const _0x261c1a=[userDemand,context,body,worldBookContent]['filter'](Boolean)[_0x319fc1(0x1d7,0x1f9,0x1cf,0x1b7)]('\x0a'),_0x473f38=[];if(_0x93a2d[_0x2ebecc(0x108,0x132,0x124,0x118)]&&Array[_0x319fc1(0x1fd,0x1f0,0x1d2,0x21f)](_0x93a2d[_0x319fc1(0x1df,0x1c3,0x22b,0x213)])){if(_0x27ab16[_0x319fc1(0x217,0x20c,0x1ff,0x1fa)](_0x2ebecc(0xfd,0xe7,0xdd,0x108),'PtjTT'))_0x4ec6d0[_0x319fc1(0x1a6,0x18b,0x178,0x175)]('{@setgloba'+_0x319fc1(0x1c6,0x1c4,0x18c,0x197)+_0x48b36b+'@}');else for(const _0x559a0f of _0x93a2d[_0x2ebecc(0xd6,0x15b,0x155,0x118)]){if(!_0x559a0f[_0x2ebecc(0x158,0x14f,0xf1,0x133)])continue;if(!_0x559a0f[_0x319fc1(0x1b4,0x1e3,0x1a9,0x1b3)]||_0x27ab16[_0x2ebecc(0xea,0x109,0x15a,0x12d)](_0x559a0f[_0x319fc1(0x1b4,0x180,0x192,0x1fb)][_0x2ebecc(0x108,0xdb,0xe8,0xf1)](),''))continue;if(_0x27ab16[_0x2ebecc(0x15c,0x110,0x115,0x12d)](_0x559a0f[_0x319fc1(0x21a,0x1e4,0x1cb,0x25d)+'e'],_0x27ab16['OmjXk'])){if(_0x27ab16[_0x2ebecc(0x151,0xfe,0xfc,0x14a)]('KtqUp',_0x319fc1(0x1e3,0x1d3,0x202,0x20f)))return[];else{if(!_0x27ab16['Dsfks'](checkTriggerWords,_0x559a0f['triggerWor'+'ds'],_0x261c1a))continue;}}const _0x5bc8f1={};_0x5bc8f1[_0x2ebecc(0x10b,0xa7,0xd8,0xc9)]=_0x559a0f[_0x2ebecc(0xb3,0xc5,0xaa,0xc9)]||_0x319fc1(0x216,0x1ee,0x1ce,0x1d1),_0x5bc8f1[_0x2ebecc(0x128,0xbe,0xc1,0xed)]=_0x559a0f['content'],_0x473f38[_0x319fc1(0x1d1,0x192,0x1cd,0x1af)](_0x5bc8f1);}}else{if(_0x93a2d['history']&&Array['isArray'](_0x93a2d[_0x2ebecc(0xc8,0x9c,0xa7,0xda)])){if(_0x27ab16['ehrkf'](_0x319fc1(0x19e,0x155,0x1d4,0x1d1),_0x27ab16[_0x319fc1(0x20d,0x1c7,0x238,0x21a)]))for(const _0x389c8c of _0x93a2d[_0x2ebecc(0xb6,0xbe,0x91,0xda)]){if(_0x27ab16[_0x2ebecc(0x10b,0xce,0x123,0xe9)](_0x27ab16['XogZM'],_0x27ab16[_0x319fc1(0x1b9,0x1af,0x202,0x19f)])){if(_0x389c8c[_0x2ebecc(0x11d,0x15e,0x13a,0x14f)]&&_0x389c8c['user'][_0x2ebecc(0x108,0xe9,0xa9,0xf1)]()!==''){if(_0x27ab16['iWega'](_0x27ab16[_0x2ebecc(0xc2,0xfd,0xdb,0xfa)],_0x27ab16[_0x2ebecc(0x136,0x137,0x139,0xfa)])){if(_0x11c8cb){const _0x331a4f=_0x277c50[_0x319fc1(0x1cc,0x186,0x1d6,0x1a4)](_0x19bb01,arguments);return _0x2c1a78=null,_0x331a4f;}}else{const _0x29d44c={};_0x29d44c[_0x2ebecc(0xb0,0xb3,0x89,0xc9)]=_0x2ebecc(0x144,0x105,0x181,0x14f),_0x29d44c[_0x319fc1(0x1b4,0x16b,0x182,0x1aa)]=_0x389c8c[_0x2ebecc(0x13d,0x112,0x136,0x14f)],_0x473f38['push'](_0x29d44c);}}if(_0x389c8c[_0x319fc1(0x1b5,0x16a,0x202,0x1b0)]&&_0x389c8c[_0x319fc1(0x1b5,0x1f7,0x1a7,0x1f4)][_0x2ebecc(0x121,0xfa,0xa4,0xf1)]()!==''){if(_0x27ab16[_0x319fc1(0x209,0x233,0x1fc,0x1d3)]===_0x27ab16[_0x2ebecc(0xc2,0x142,0x114,0xfb)]){if(!_0x59dcbb||_0x27ab16[_0x2ebecc(0xae,0x126,0xb2,0xe9)](_0x413fea[_0x2ebecc(0x107,0x15a,0xc5,0x10f)],-0x2527*0x1+-0x1751+-0xa14*-0x6))return _0x2d699b;const _0x432eb7=_0x27ab16[_0x2ebecc(0x179,0x149,0x163,0x158)](_0x215c4a);return!_0x432eb7[_0x2ebecc(0xd0,0xc9,0xbd,0xfe)+'ta']&&(_0x432eb7[_0x2ebecc(0xd7,0x10c,0xba,0xfe)+'ta']={}),!_0x432eb7[_0x319fc1(0x1c5,0x1c9,0x19a,0x1a6)+'ta'][_0x2ebecc(0x14a,0x101,0x150,0x138)]&&(_0x432eb7[_0x319fc1(0x1c5,0x1a2,0x1ec,0x20c)+'ta'][_0x2ebecc(0x16d,0x142,0x114,0x138)]={}),_0x156284[_0x2ebecc(0x113,0x127,0x144,0x148)](_0xbc295f=>{if(!_0xbc295f||!_0xbc295f[_0x27015c(0x36b,0x36b,0x367,0x3a9)])return _0xbc295f;function _0x27015c(_0xecbcf8,_0x1728c0,_0x453a4e,_0x44a2aa){return _0x319fc1(_0x453a4e-0x1b3,_0x1728c0-0x63,_0x1728c0,_0x44a2aa-0x172);}function _0x14b8c5(_0x455fba,_0x19054b,_0x43b5ac,_0x13b22a){return _0x319fc1(_0x19054b- -0x29d,_0x19054b-0x12a,_0x13b22a,_0x13b22a-0x18b);}return{..._0xbc295f,'content':_0x27ab16[_0x27015c(0x3ce,0x37d,0x3c6,0x3f1)](_0x459174,_0xbc295f[_0x27015c(0x3a7,0x389,0x367,0x3af)],_0x432eb7,_0x5b3e92)};});}else{const _0xbe3205={};_0xbe3205[_0x2ebecc(0xe4,0xfb,0x92,0xc9)]=_0x27ab16[_0x2ebecc(0x12e,0x151,0xf3,0x11e)],_0xbe3205[_0x319fc1(0x1b4,0x168,0x175,0x185)]=_0x389c8c[_0x319fc1(0x1b5,0x16c,0x1db,0x18f)],_0x473f38['push'](_0xbe3205);}}}else{const _0x5ed037={};_0x5ed037['role']=_0x27ab16[_0x319fc1(0x1d3,0x208,0x1a0,0x18e)],_0x5ed037[_0x2ebecc(0x114,0xc6,0xb7,0xed)]=_0x35736b['user'],_0x1bbd2f['push'](_0x5ed037);}}else return _0x27ab16[_0x319fc1(0x1af,0x1f2,0x161,0x1e2)](_0x20a06c,'\x0a')+_0x4eb07c;}}const _0xb772ae=mergeAdjacentMessages(_0x473f38),{messages:_0x3d093f,replacedVariables:_0x43fd6f}=_0x27ab16[_0x319fc1(0x19d,0x19f,0x176,0x1dc)](replaceAllPlaceholders,_0xb772ae,_0x2bcf30);function _0x319fc1(_0x3b7bc7,_0x4387f7,_0x279e2e,_0x160180){return _0x180a(_0x3b7bc7- -0x6b,_0x279e2e);}return _0x3d093f;}export function getProcessedPrompt(_0x52b1e6,_0x490bc2){function _0x3e7ff1(_0x261c9c,_0x5479b1,_0x4a1e26,_0x202ab3){return _0x180a(_0x5479b1- -0x27b,_0x202ab3);}const _0x535901={'hZUEu':function(_0x21a3e7,_0x4523b6){return _0x21a3e7(_0x4523b6);}};function _0x1e3918(_0x288d4f,_0x41e66f,_0x1f4f75,_0x2d7902){return _0x180a(_0x2d7902-0x1b3,_0x41e66f);}const _0x41c72d={};return _0x41c72d['requestTyp'+'e']=_0x52b1e6,_0x41c72d[_0x3e7ff1(-0x5e,-0x67,-0xa9,-0x93)+'a']=_0x490bc2,_0x535901[_0x3e7ff1(-0x15,-0x37,-0x58,-0x79)](buildPromptWithTrigger,_0x41c72d);}