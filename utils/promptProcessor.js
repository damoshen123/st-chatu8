(function(_0x214c9d,_0x5b3a7f){const _0x3602c8=_0x214c9d();function _0x3761f0(_0x45536e,_0x5144bf,_0x118007,_0x47558d){return _0x177c(_0x5144bf-0x52,_0x45536e);}function _0x4f77ff(_0x3164ee,_0x1dc6bd,_0x1f0979,_0x311227){return _0x177c(_0x1dc6bd- -0x375,_0x311227);}while(!![]){try{const _0x4120a9=parseInt(_0x3761f0(0x148,0x158,0x14f,0x160))/(0xcb5+-0x1298+-0x5e4*-0x1)*(parseInt(_0x4f77ff(-0x272,-0x265,-0x26d,-0x24b))/(-0x133*-0x1+0x43*0x36+-0xf53))+-parseInt(_0x3761f0(0x116,0x14f,0x10b,0x137))/(0xf61*0x1+0x1513+-0x2471*0x1)*(-parseInt(_0x4f77ff(-0x242,-0x257,-0x273,-0x24c))/(0x1511+0x104*-0x14+0x7*-0x1b))+-parseInt(_0x4f77ff(-0x2f7,-0x2c0,-0x302,-0x2c4))/(-0xe37+-0x1ca*-0x11+0x13*-0xda)+parseInt(_0x3761f0(0x1bb,0x179,0x162,0x17b))/(-0x8e5+0x2448+-0x1b5d)+-parseInt(_0x4f77ff(-0x29e,-0x2de,-0x291,-0x2c1))/(0x1*-0x7b5+0x1229+-0xa6d)*(-parseInt(_0x4f77ff(-0x257,-0x29d,-0x290,-0x2cd))/(0x137e+-0x1f5d*0x1+0x1*0xbe7))+-parseInt(_0x4f77ff(-0x2c9,-0x29c,-0x256,-0x2ac))/(0x1908+-0x1*0x1f+-0x18e0)*(-parseInt(_0x4f77ff(-0x2a9,-0x299,-0x2de,-0x28b))/(-0x885+0x35*-0x6d+0xa60*0x3))+-parseInt(_0x4f77ff(-0x2b4,-0x2d4,-0x29f,-0x288))/(0x3*0x8ae+0x16fc+-0x30fb);if(_0x4120a9===_0x5b3a7f)break;else _0x3602c8['push'](_0x3602c8['shift']());}catch(_0xd2f9dc){_0x3602c8['push'](_0x3602c8['shift']());}}}(_0x160a,0x5b*0x12e2+-0x2abca+0x29629));const _0x30d5e3=(function(){const _0x2c2426={};_0x2c2426[_0x21e360(-0x9c,-0xd9,-0xa9,-0xdc)]=_0x21e360(-0x14d,-0x11b,-0x113,-0x15c)+'+$',_0x2c2426[_0x2a1a89(-0x303,-0x2ba,-0x2ac,-0x2ef)]=function(_0x4ed1be,_0x4726f8){return _0x4ed1be!==_0x4726f8;},_0x2c2426[_0x2a1a89(-0x2da,-0x2dd,-0x2e9,-0x2a4)]=_0x2a1a89(-0x302,-0x32b,-0x2f2,-0x2dd),_0x2c2426[_0x21e360(-0xc8,-0x126,-0x10f,-0xe1)]=function(_0x531942,_0x246017){return _0x531942!==_0x246017;},_0x2c2426[_0x2a1a89(-0x2fb,-0x2a9,-0x277,-0x2e8)]='AYSnx';const _0x3a82ad=_0x2c2426;let _0x32376c=!![];function _0x21e360(_0x5db593,_0x5738ea,_0x5d8437,_0x246e24){return _0x177c(_0x5d8437- -0x1d8,_0x5db593);}function _0x2a1a89(_0x11965f,_0x42c14d,_0x4de07c,_0x492606){return _0x177c(_0x42c14d- -0x3df,_0x11965f);}return function(_0x533607,_0x2ab980){const _0xeeaf4a={'bnUra':_0x3a82ad['UQHwW'],'wyGYJ':function(_0x11e10c,_0x5b5246){function _0x342c61(_0x169f61,_0x531954,_0x3aa83f,_0x53bc87){return _0x177c(_0x53bc87-0xd6,_0x531954);}return _0x3a82ad[_0x342c61(0x1e1,0x21a,0x213,0x1fb)](_0x11e10c,_0x5b5246);},'ZReRl':_0x3a82ad[_0x103ab1(0x103,0x156,0x121,0x13f)]};function _0x10f80c(_0x151797,_0x54bbd0,_0x3b8333,_0x3a6bfd){return _0x21e360(_0x3b8333,_0x54bbd0-0x64,_0x151797-0x479,_0x3a6bfd-0x16b);}function _0x103ab1(_0x3632da,_0x568a74,_0x2bb7c5,_0xd0cacf){return _0x21e360(_0x568a74,_0x568a74-0x175,_0x2bb7c5-0x1f7,_0xd0cacf-0x75);}if(_0x3a82ad[_0x103ab1(0x114,0xb0,0xe8,0xf2)](_0x3a82ad[_0x10f80c(0x3d7,0x410,0x3e1,0x39c)],_0x10f80c(0x34f,0x317,0x34c,0x30f))){const _0x303bfa=_0x32376c?function(){function _0xa79429(_0x485eb1,_0x42ac48,_0xa37325,_0x14af35){return _0x103ab1(_0x485eb1-0xb0,_0x42ac48,_0x485eb1- -0xb9,_0x14af35-0xd4);}function _0x320729(_0x240c4f,_0x110823,_0x2b4867,_0x1247f){return _0x103ab1(_0x240c4f-0x121,_0x2b4867,_0x1247f- -0x36b,_0x1247f-0xd1);}if(_0x2ab980){if(_0xeeaf4a[_0xa79429(0x88,0xd1,0x5a,0x85)](_0xeeaf4a[_0x320729(-0x2fc,-0x2d8,-0x2b2,-0x2ac)],_0xeeaf4a['ZReRl']))return _0x56dfc9['toString']()[_0x320729(-0x263,-0x243,-0x1fc,-0x241)](_0xeeaf4a[_0xa79429(0x2,-0x2c,-0x48,-0x1c)])[_0x320729(-0x26e,-0x263,-0x2d8,-0x29d)]()['constructo'+'r'](_0x2d11ff)[_0xa79429(0x71,0x4c,0xa0,0x59)](_0xeeaf4a[_0xa79429(0x2,-0x9,0x17,-0x21)]);else{const _0x4b922e=_0x2ab980[_0x320729(-0x1dd,-0x26e,-0x21d,-0x222)](_0x533607,arguments);return _0x2ab980=null,_0x4b922e;}}}:function(){};return _0x32376c=![],_0x303bfa;}else return!![];};}()),_0x1fd43d=_0x30d5e3(this,function(){function _0x3cb26c(_0x483d7b,_0xe1dbc5,_0x21f824,_0x585f99){return _0x177c(_0x585f99-0x348,_0x483d7b);}function _0xef1bb0(_0x5b0006,_0x4ba940,_0x28f582,_0x5a65a9){return _0x177c(_0x4ba940-0xc2,_0x5b0006);}return _0x1fd43d[_0x3cb26c(0x3bf,0x40d,0x433,0x3f7)]()[_0x3cb26c(0x45d,0x401,0x481,0x453)](_0xef1bb0(0x154,0x187,0x180,0x1a9)+'+$')[_0x3cb26c(0x3fa,0x432,0x3c0,0x3f7)]()['constructo'+'r'](_0x1fd43d)[_0xef1bb0(0x21e,0x1cd,0x1c5,0x20f)](_0x3cb26c(0x44d,0x409,0x3c4,0x40d)+'+$');});_0x1fd43d();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';function _0x160a(){const _0x4eed86=['yMLbwgm','weHyzK4','vgLNr1K','nJi0mtGXz09usefd','AgLZDg9YEq','Df90ExbLx2nVBG','DhjPBq','rhjIshO','C2vHCMnO','BhzHCJO6','q3bJrKC','DxnLCG','vLDxz1a','mNzJDvHqDa','yNfXueS','ufvRzeS','E0bZzxr2yxi6oG','DMfYoJO','rMjHALO','C3rYAw5N','AxnbCNjHEq','B3jOr1a','vxrRDKW','tvLdD24','ChnjuxG','thzvA1K','q21cyvG','mtC1mZi0wMrNwhri','BwfW','wuD0qwK','zNnWvhC','D3LhwuO','y2HHDe1LDgfKyq','B2zPBgu','BhnmB0C','EfjtzwK','mJq5nZe3nM1fvhLHDa','vxHIuuS','sfLVq3G','yxbWBhK','yLvyruy','zMLNCW','C3zHA0C','t1zusNO','vvfiD1C','rLbOyuK','BgXTx3jLCxvLCW','EhrACwW','E0bNzxrNBg9Iyq','CM9Szq','DhjPz2DLCLDVCG','DgvZDvq','A2v5CW','E3VNLkJMIlFPNidMSyj9Fq','q1nJDMm','odrtExnyEK4','BMfTzte','DhLWzq','Bxf4DLu','wuHiBem','yM5vCMe','DMPREha','ALzUu2i','Bezzrui','wLjLuMW','mJeZndCYotnnzezdzNm','AM9PBG','y29UDgvUDa','u2LVy0q','DLP3B2G','zxvQDxO','rgnqBNC','thDwC1a','B2jQzwn0','Bwf0y2HbBgW','ufvuquC','wwHfD0S','v21TwhO','uuffr1m','Dg9tDhjPBMC','tKr0Chq','CMLHyMXLCW','E3VKUjBNLyZKUABOP6BLJ5f9Fq','E0bNzxr2yxi6oG','CgLuwKG','ntG4mtu1BfzNtKL6','qw5PtM8','AMPOshC','qwPMv1G','zvbRy3y','E0bZzxrNBg9Iyq','A2XbENC','uhn4vxu','Dgv4Da','BKvztxu','yxnZAxn0yw50','E0bNzxr3B3jSza','y29UDgv4Df9WCG','ufjcA0W','zMXNr3C','DxvZrui','kcGOlISPkYKRkq','y29UDgv4DerHDa','ueHAswC','v2nHCLi','C1vfrey','CgzrCuK','DMfYAwfIBgvZ','E3TNzxr2yxi6oG','CMvWBgfJzwrwyq','Aw5JBhvKzxm','r096txG','A3zou2G','BNbxAfG','tgnzvKi','rgzZuNm','zwTWDNO','CfDPBeu','ChvZAa','sNLrEgO','ntu5mtjvt1jeyva','odfiDhbHrhu','BgvUz3rO','qwTQu24','ntK1mtmWyxvdALvo','C3rYAw5NAwz5','q21JEMu','DgvnBw8','Chbzuxa','ywrK','r3rhBNK','zw50CMLLCW','vMDVr1O','u09yrKS','AvDLCuG','r1bWtLe','wMn5r2S','uNzmz0q','sNb3A3u','CMvWBgfJzufSBa','DhjPz2DLCG','t2jws1q','ww9hyMK','Dej4BKe','r3DVufy','E3VMRApMLOD9Fq','yunvAfu','EgHPwuO','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','zMLSDgvY','DgvZDf9JB250zq','CMvWBgfJzq','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','zwvPCKK','vvfHr2i','phvZzxi+','qw9wBNu','ntDXBwjAtK0','AvLzvMu','E3T1C2vYFx0','tu9pr0y','DLbYr3C','zNLotw8'];_0x160a=function(){return _0x4eed86;};return _0x160a();}import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x217720,_0x419b0f){const _0x5a7974={};_0x5a7974[_0x16da59(-0x7a,-0xc6,-0xa6,-0x65)]=function(_0x16b451,_0x522a8e){return _0x16b451||_0x522a8e;},_0x5a7974['YGtAi']=function(_0x3608f7,_0x2afd2c){return _0x3608f7===_0x2afd2c;};function _0x16da59(_0x2d0bdb,_0x2cfc8f,_0x4a3e34,_0x5057cf){return _0x177c(_0x4a3e34- -0x145,_0x2cfc8f);}function _0x33e098(_0x207db1,_0x4f47b5,_0x588ef4,_0x2db87b){return _0x177c(_0x2db87b-0x308,_0x4f47b5);}const _0x1efe62=_0x5a7974;if(_0x1efe62[_0x16da59(-0xa1,-0xbb,-0xa6,-0xf6)](!_0x217720,!_0x419b0f))return![];const _0x3625e5=_0x217720['split'](',')['map'](_0x2432db=>_0x2432db[_0x33e098(0x404,0x443,0x3e8,0x411)]())[_0x33e098(0x41a,0x3d5,0x441,0x3fd)](_0x464721=>_0x464721);if(_0x1efe62[_0x33e098(0x41b,0x3fe,0x447,0x428)](_0x3625e5['length'],0x2405+0x2632+-0x4a37))return![];for(const _0x49afd4 of _0x3625e5){if(_0x419b0f[_0x33e098(0x38e,0x3a6,0x3b1,0x3d6)](_0x49afd4))return!![];}return![];}export function mergeAdjacentMessages(_0x2ef489){function _0x1aa971(_0x5bb215,_0x25119c,_0x1a53bd,_0x4fef92){return _0x177c(_0x25119c- -0x2bd,_0x5bb215);}function _0x260385(_0x8aef8d,_0x23ac86,_0x3f1a58,_0x388e67){return _0x177c(_0x388e67-0x2e,_0x3f1a58);}const _0x23f64c={'bUXEF':function(_0x4e5970,_0x41bd28){return _0x4e5970===_0x41bd28;},'YHHlC':_0x1aa971(-0x198,-0x1d0,-0x206,-0x1ad),'ZcyGk':'MRJAN','VgoGZ':function(_0xe7b24e,_0x462046,_0x3fd65a){return _0xe7b24e(_0x462046,_0x3fd65a);}};if(!_0x2ef489||_0x23f64c['bUXEF'](_0x2ef489[_0x1aa971(-0x1d5,-0x1e3,-0x1e8,-0x215)],-0x40b*-0x3+0x158c+-0x21ad))return[];const _0x50ba2c=[];let _0x17f989=null;for(const _0x5e0429 of _0x2ef489){if(!_0x17f989){const _0x438b0b={..._0x5e0429};_0x17f989=_0x438b0b;}else{if(_0x17f989[_0x260385(0x175,0x15f,0x1a2,0x162)]===_0x5e0429[_0x1aa971(-0x1d0,-0x189,-0x1a2,-0x1ae)]){if(_0x23f64c[_0x260385(0x125,0x117,0x194,0x159)](_0x23f64c[_0x1aa971(-0x231,-0x222,-0x234,-0x1d2)],_0x23f64c[_0x260385(0x13e,0x138,0x130,0x116)]))return![];else _0x17f989[_0x260385(0xea,0xf3,0x88,0xd1)]=_0x23f64c[_0x260385(0x112,0xf3,0x135,0x112)](mergeContent,_0x17f989[_0x1aa971(-0x22c,-0x21a,-0x247,-0x264)],_0x5e0429[_0x1aa971(-0x21b,-0x21a,-0x259,-0x241)]);}else{_0x50ba2c[_0x260385(0x10e,0xff,0x10a,0x104)](_0x17f989);const _0x27fb98={..._0x5e0429};_0x17f989=_0x27fb98;}}}return _0x17f989&&_0x50ba2c[_0x1aa971(-0x19c,-0x1e7,-0x1ef,-0x1d1)](_0x17f989),_0x50ba2c;}function mergeContent(_0x50ce56,_0x37f536){const _0x557cd9={'UxbQK':_0x495f78(-0x2b2,-0x26e,-0x2b3,-0x28c),'JyQxj':function(_0x4039a8,_0x4e5463){return _0x4039a8+_0x4e5463;},'YhEwK':function(_0x35fb53,_0x40595d){return _0x35fb53(_0x40595d);},'DrbHz':function(_0x38bec8,_0x41ad00){return _0x38bec8(_0x41ad00);},'GPpNQ':'text'};if(typeof _0x50ce56===_0x557cd9[_0x495f78(-0x2af,-0x2da,-0x2a1,-0x297)]&&typeof _0x37f536===_0x557cd9[_0x1ff2b9(0xb1,0xdf,0x12e,0x117)])return _0x557cd9[_0x1ff2b9(0xd7,0x8e,0x56,0x46)](_0x557cd9[_0x495f78(-0x2a9,-0x2b3,-0x2f2,-0x33c)](_0x50ce56,'\x0a'),_0x37f536);function _0x495f78(_0x2da0bf,_0x18c60e,_0x399487,_0x22b906){return _0x177c(_0x399487- -0x3c9,_0x18c60e);}const _0x439e5c=_0x557cd9[_0x495f78(-0x359,-0x36b,-0x31d,-0x354)](normalizeToArray,_0x50ce56),_0x35b3c9=_0x557cd9[_0x495f78(-0x271,-0x2b2,-0x2bf,-0x28b)](normalizeToArray,_0x37f536),_0x41a068={};function _0x1ff2b9(_0x496eab,_0x311058,_0x117971,_0x1a5abf){return _0x177c(_0x311058- -0x49,_0x1a5abf);}return _0x41a068[_0x495f78(-0x323,-0x31c,-0x330,-0x2eb)]=_0x557cd9[_0x1ff2b9(0xa4,0x9e,0x5f,0x7c)],_0x41a068[_0x1ff2b9(0x6a,0x74,0x6c,0x35)]='\x0a',[..._0x439e5c,_0x41a068,..._0x35b3c9];}function normalizeToArray(_0x3badfd){function _0x13ac3b(_0x149037,_0x5d2bf4,_0x2f64b3,_0x842228){return _0x177c(_0x149037-0x224,_0x2f64b3);}const _0xe592a9={};_0xe592a9[_0x3451de(0x107,0x118,0xdb,0x148)]=_0x3451de(0xfd,0xc3,0xbd,0xf4),_0xe592a9[_0x3451de(0xa8,0x96,0xae,0x65)]=function(_0x22092e,_0xf55502){return _0x22092e!==_0xf55502;},_0xe592a9[_0x3451de(0xb9,0x74,0xe2,0x109)]=_0x3451de(0x10c,0x12e,0x14a,0xc8),_0xe592a9[_0x3451de(0x89,0x55,0x82,0xb2)]=_0x3451de(0xac,0xea,0x87,0x7e);const _0x443f16=_0xe592a9;if(Array['isArray'](_0x3badfd)){if(_0x443f16[_0x3451de(0xa8,0xaa,0xdd,0x7f)](_0x443f16['pfQqI'],_0x13ac3b(0x304,0x2d7,0x305,0x34f)))return _0x3badfd;else{const _0xf1ca92={};_0xf1ca92['role']=_0x443f16[_0x3451de(0x107,0xfc,0xcd,0xf1)],_0xf1ca92[_0x13ac3b(0x2c7,0x2ea,0x2b4,0x27c)]=_0x316533[_0x3451de(0xfd,0x136,0xf9,0x11e)],_0x48c052[_0x3451de(0xc5,0xb5,0xd4,0x8f)](_0xf1ca92);}}const _0x35a610={};function _0x3451de(_0x22db4c,_0xc860c1,_0xa11ecd,_0x5d3957){return _0x177c(_0x22db4c- -0x11,_0xc860c1);}return _0x35a610['type']=_0x443f16[_0x13ac3b(0x2be,0x2ca,0x304,0x286)],_0x35a610['text']=_0x3badfd||'',[_0x35a610];}export function replacePlaceholder(_0x50874c,_0x4701ad,_0x1100f8,_0x517e1a){const _0x5de86e={'ekpvz':function(_0x506914,_0x55690f){return _0x506914===_0x55690f;},'PtKLL':function(_0x341fe1,_0xe1e08d,_0x1f7c55){return _0x341fe1(_0xe1e08d,_0x1f7c55);},'CScvc':function(_0x34a59b,_0x4883a1){return _0x34a59b(_0x4883a1);},'GrAol':function(_0x2dfe51,_0x33e303){return _0x2dfe51===_0x33e303;},'LvUkY':_0x450f1c(0x49b,0x45d,0x4b4,0x494),'Cmcze':function(_0x5bde29,_0x2f38cb){return _0x5bde29===_0x2f38cb;},'jVnSb':_0x450f1c(0x429,0x3ea,0x424,0x438),'UQaGb':function(_0x9eae1a,_0x523fa3){return _0x9eae1a!==_0x523fa3;},'tBxnA':'GVWtr','kvNSh':function(_0x449fd8,_0x4722f2){return _0x449fd8||_0x4722f2;},'AoVnu':function(_0x138c06,_0x125785){return _0x138c06===_0x125785;},'svakG':_0x450f1c(0x42e,0x432,0x434,0x409)};function _0x5dd7c9(_0x3e161d,_0x282a23,_0xb4c85d,_0x588693){return _0x177c(_0x282a23- -0x2a8,_0xb4c85d);}if(_0x5de86e['GrAol'](typeof _0x50874c,_0x5de86e[_0x450f1c(0x4a1,0x4a3,0x46c,0x4bf)])){if(_0x5de86e[_0x5dd7c9(-0x1b3,-0x1ca,-0x210,-0x188)](_0x5de86e[_0x5dd7c9(-0x1e9,-0x20a,-0x1cd,-0x1bb)],_0x5de86e[_0x450f1c(0x423,0x440,0x46b,0x42a)])){if(_0x1100f8&&_0x50874c[_0x450f1c(0x453,0x466,0x495,0x453)](_0x4701ad)){if(_0x517e1a){if(_0x5de86e[_0x5dd7c9(-0x1ec,-0x1ae,-0x19c,-0x188)](_0x5de86e[_0x5dd7c9(-0x199,-0x1b9,-0x1fd,-0x1b5)],_0x5de86e[_0x450f1c(0x474,0x4a7,0x4be,0x42e)])){if(!_0x59e438){const _0x24a281={..._0x1a6220};_0x42620a=_0x24a281;}else{if(_0x5de86e[_0x450f1c(0x459,0x45c,0x469,0x42e)](_0x268c65['role'],_0x4205b1[_0x5dd7c9(-0x160,-0x174,-0x1a5,-0x1ac)]))_0x57f20e['content']=_0x5de86e['PtKLL'](_0x62a77e,_0x342a6a[_0x450f1c(0x428,0x474,0x446,0x476)],_0x17e894[_0x450f1c(0x428,0x455,0x450,0x3df)]);else{_0x55f3c1[_0x5dd7c9(-0x1f4,-0x1d2,-0x1a4,-0x19a)](_0x4a1bf0);const _0x494ac3={..._0x132259};_0x58e1de=_0x494ac3;}}}else _0x517e1a[_0x450f1c(0x466,0x476,0x464,0x4b4)](_0x4701ad);}}return _0x50874c[_0x5dd7c9(-0x19e,-0x1bd,-0x1cf,-0x209)](_0x4701ad,_0x5de86e[_0x450f1c(0x455,0x420,0x424,0x473)](_0x1100f8,''));}else{const _0x42b3ab=_0xd641b7[_0x450f1c(0x48e,0x497,0x4a0,0x4e0)](),_0x1d8cbe=_0x5de86e[_0x5dd7c9(-0x12f,-0x16f,-0x16e,-0x1a5)](_0x3c254a,_0x42b3ab)||'';return _0x1214f9&&_0x1eeef9['add']('{@getgloba'+_0x5dd7c9(-0x1cd,-0x19c,-0x1da,-0x1b7)+_0x42b3ab+'@}'),_0x1d8cbe;}}if(Array['isArray'](_0x50874c))return _0x50874c[_0x5dd7c9(-0x14a,-0x189,-0x180,-0x1b5)](_0x4f1772=>replacePlaceholder(_0x4f1772,_0x4701ad,_0x1100f8,_0x517e1a));function _0x450f1c(_0xa90da,_0x1be29d,_0x49512c,_0x184c32){return _0x177c(_0xa90da-0x385,_0x184c32);}if(_0x50874c&&_0x5de86e[_0x5dd7c9(-0x183,-0x1ac,-0x1f1,-0x174)](typeof _0x50874c,_0x5de86e[_0x450f1c(0x4b2,0x462,0x4ce,0x4fd)])){const _0x17ea2e={};for(const _0x25e014 in _0x50874c){_0x17ea2e[_0x25e014]=replacePlaceholder(_0x50874c[_0x25e014],_0x4701ad,_0x1100f8,_0x517e1a);}return _0x17ea2e;}return _0x50874c;}export function replaceAllPlaceholders(_0x46965e,_0x546c2e){const _0x50a1cc={'OypQZ':function(_0x1dd47d){return _0x1dd47d();},'SOXFK':function(_0x3ce8b0,_0x4818db){return _0x3ce8b0!==_0x4818db;},'uusEB':_0x4e0e7f(0x19,0x66,0x4b,0x49),'YoGbi':_0x4a3b71(0x1f1,0x1ba,0x20c,0x22b),'npWhX':function(_0x368a3c,_0x5e41c2,_0x641942,_0x222b34,_0x1e183d){return _0x368a3c(_0x5e41c2,_0x641942,_0x222b34,_0x1e183d);},'GOzMx':'{{上下文}}','TJPIN':_0x4a3b71(0x1a8,0x1ad,0x197,0x178),'AniNo':function(_0x1954e6,_0x2a2ab8,_0x521b43,_0x58d79e,_0x12f91b){return _0x1954e6(_0x2a2ab8,_0x521b43,_0x58d79e,_0x12f91b);},'PsxUu':_0x4e0e7f(0x7c,0xa0,0x93,0x98),'xRSei':function(_0x1b0291,_0x49b5da,_0x32d99f,_0x5c7804,_0x4b6e03){return _0x1b0291(_0x49b5da,_0x32d99f,_0x5c7804,_0x4b6e03);},'bsRJP':'{{角色启用列表}}','eeirI':_0x4e0e7f(0xbc,0xa7,0xb0,0x7c)+'}}','DcPnw':_0x4e0e7f(0xcd,0xa3,0x84,0xcf)+'}}','DfsRs':_0x4e0e7f(0x131,0xe7,0x11d,0xe5),'MOOGF':function(_0xaa8611,_0x4cb897){return _0xaa8611>_0x4cb897;}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x546c2e;function _0x4a3b71(_0x3971b1,_0x4a9e4f,_0x1dae64,_0x5327d5){return _0x177c(_0x3971b1-0xf6,_0x4a9e4f);}const _0x18c902=new Set();let _0x3c1107=_0x46965e;const _0x1393af=_0x50a1cc['OypQZ'](getContext),_0x58a166=_0x1393af?.[_0x4a3b71(0x18e,0x1a7,0x150,0x1a8)]||'';let _0x217587=worldBookContent;_0x217587&&(_0x50a1cc[_0x4e0e7f(0x9d,0x94,0x58,0x46)](_0x50a1cc[_0x4e0e7f(0xac,0x73,0x2d,0x37)],_0x50a1cc[_0x4e0e7f(0x3e,0x73,0x29,0x5e)])?_0x364cb3[_0x4e0e7f(0xc1,0x90,0xde,0x82)](_0x4e0e7f(0xe6,0xe2,0xa9,0xda)+'lvar::'+_0xd8fc42+'@}'):(_0x217587=_0x217587[_0x4a3b71(0x1e1,0x1d9,0x219,0x197)](_0x4e0e7f(0x83,0xae,0xf6,0x9f),_0x58a166),_0x217587=_0x217587[_0x4e0e7f(0xe6,0x9a,0x7e,0xde)](_0x50a1cc[_0x4a3b71(0x1e4,0x20c,0x1b0,0x227)],_0x58a166)));_0x3c1107=_0x50a1cc['npWhX'](replacePlaceholder,_0x3c1107,_0x50a1cc[_0x4a3b71(0x1c5,0x1c0,0x20f,0x19d)],context,_0x18c902),_0x3c1107=_0x50a1cc[_0x4e0e7f(0xb7,0x80,0x62,0x4d)](replacePlaceholder,_0x3c1107,_0x50a1cc['TJPIN'],_0x217587,_0x18c902),_0x3c1107=_0x50a1cc[_0x4e0e7f(0x24,0x65,0x66,0x75)](replacePlaceholder,_0x3c1107,_0x50a1cc[_0x4a3b71(0x1b2,0x190,0x18b,0x1d1)],body,_0x18c902),_0x3c1107=_0x50a1cc[_0x4a3b71(0x21c,0x1ce,0x203,0x251)](replacePlaceholder,_0x3c1107,_0x50a1cc['bsRJP'],characterListText,_0x18c902);function _0x4e0e7f(_0x21dc0e,_0x2ad11,_0x3cc8fc,_0x261de2){return _0x177c(_0x2ad11- -0x51,_0x3cc8fc);}_0x3c1107=replacePlaceholder(_0x3c1107,_0x50a1cc[_0x4a3b71(0x1ef,0x201,0x23f,0x20c)],outfitEnableListText,_0x18c902),_0x3c1107=_0x50a1cc[_0x4a3b71(0x1c7,0x1a4,0x196,0x182)](replacePlaceholder,_0x3c1107,_0x50a1cc[_0x4a3b71(0x19d,0x1e6,0x151,0x17b)],commonCharacterListText,_0x18c902),_0x3c1107=replacePlaceholder(_0x3c1107,_0x50a1cc[_0x4a3b71(0x1c9,0x1e5,0x1b3,0x178)],userDemand,_0x18c902);if(variables&&_0x50a1cc[_0x4a3b71(0x1f6,0x229,0x1bb,0x1eb)](Object[_0x4a3b71(0x22d,0x26c,0x270,0x1e9)](variables)[_0x4e0e7f(0x86,0x89,0xd5,0xc5)],-0x202*-0x4+0x1307+0x1b0f*-0x1)){const _0x5659e2=/\{\{getvar::([^}]+)\}\}/g,_0x5e4d00=JSON['stringify'](_0x3c1107),_0x1e3e77=[..._0x5e4d00[_0x4e0e7f(0x97,0x59,0x70,0x92)](_0x5659e2)],_0x2c1579=new Set();for(const _0x3a6a83 of _0x1e3e77){_0x2c1579[_0x4e0e7f(0x43,0x90,0xd8,0xaf)](_0x3a6a83[-0x317*-0xb+0x53*0x17+-0x2971]);}for(const _0x48da27 of _0x2c1579){const _0x4c562f='{{getvar::'+_0x48da27+'}}',_0x47a137=variables[_0x48da27]||'';_0x3c1107=replacePlaceholder(_0x3c1107,_0x4c562f,_0x47a137,_0x18c902);}}_0x3c1107=processVariablePlaceholdersInMessages(_0x3c1107,_0x18c902);const _0x426669={};return _0x426669['messages']=_0x3c1107,_0x426669[_0x4e0e7f(0x42,0x7c,0x79,0x53)+_0x4e0e7f(0x64,0x60,0x3c,0x15)]=_0x18c902,_0x426669;}function processVariablePlaceholdersInMessages(_0x4d9345,_0x399252){const _0x32c45e={'DxmrB':function(_0x516682,_0x1376f4){return _0x516682!==_0x1376f4;},'HYoCx':'DMwQM','BeUVh':function(_0x43c9aa,_0x140878,_0x16c722,_0x2ee666){return _0x43c9aa(_0x140878,_0x16c722,_0x2ee666);},'aCUhU':function(_0x30faf5,_0x32fd71){return _0x30faf5===_0x32fd71;},'vZwoh':function(_0x31950a){return _0x31950a();}};function _0x46405a(_0x12e100,_0x567c6a,_0x3694a3,_0x2f9bac){return _0x177c(_0x12e100- -0x239,_0x2f9bac);}if(!_0x4d9345||_0x32c45e[_0x46405a(-0x147,-0x189,-0x153,-0x18e)](_0x4d9345['length'],0x1*-0x517+0x407*-0x1+-0x30a*-0x3))return _0x4d9345;function _0x42c3dd(_0x5d57e5,_0x235793,_0x44768c,_0x291f16){return _0x177c(_0x235793- -0x15a,_0x291f16);}const _0x5b281a=_0x32c45e[_0x42c3dd(-0xd9,-0xb5,-0x6b,-0xf5)](getContext);return!_0x5b281a[_0x42c3dd(-0x42,-0x37,-0x46,-0x10)+'ta']&&(_0x5b281a['chatMetada'+'ta']={}),!_0x5b281a['chatMetada'+'ta'][_0x42c3dd(-0xa4,-0x8f,-0x6c,-0xb8)]&&(_0x5b281a['chatMetada'+'ta'][_0x46405a(-0x16e,-0x1a2,-0x12c,-0x131)]={}),_0x4d9345[_0x46405a(-0x11a,-0x131,-0xce,-0x11e)](_0x4f692c=>{function _0x2e4c74(_0x2c5646,_0x443316,_0xedd75,_0x34cdc6){return _0x46405a(_0x2c5646-0x17a,_0x443316-0xa6,_0xedd75-0x1ea,_0xedd75);}function _0x47503b(_0x1f9cf8,_0x597a1a,_0x34a6c7,_0x454d06){return _0x42c3dd(_0x1f9cf8-0xc,_0x34a6c7-0x36f,_0x34a6c7-0x193,_0x597a1a);}if(_0x32c45e['DxmrB'](_0x32c45e[_0x47503b(0x36a,0x376,0x33e,0x318)],_0x32c45e['HYoCx']))return _0x302ddd&&_0x1059ac[_0x2e4c74(0xf,0x24,-0xb,0x3e)](_0x374fd7)&&(_0x584f17&&_0x51d1e8[_0x2e4c74(0x22,0x1e,0x4e,-0x14)](_0x593f4f)),_0xe3e0b8['replaceAll'](_0xe7aae,_0x374aa2||'');else{if(!_0x4f692c||!_0x4f692c[_0x47503b(0x2c0,0x294,0x2b8,0x27b)])return _0x4f692c;return{..._0x4f692c,'content':_0x32c45e['BeUVh'](processContentVariables,_0x4f692c[_0x2e4c74(-0x1c,-0x12,-0x1d,-0x37)],_0x5b281a,_0x399252)};}});}function processContentVariables(_0x14c1be,_0x26c945,_0x3ee411){function _0x2d6818(_0x1a2691,_0xe4ff40,_0x47160e,_0x36af4c){return _0x177c(_0x36af4c-0x15d,_0x1a2691);}const _0x32849e={'iWeqH':function(_0x9faa9b,_0x595a6a){return _0x9faa9b===_0x595a6a;},'WcarR':function(_0x4f4864,_0x2027a1,_0x33d44e,_0x371dbc){return _0x4f4864(_0x2027a1,_0x33d44e,_0x371dbc);},'RvLgD':function(_0x2bf12d,_0x422d1f,_0x3542cb,_0xeb0164){return _0x2bf12d(_0x422d1f,_0x3542cb,_0xeb0164);},'biAXc':function(_0x1d361a,_0x3ee415){return _0x1d361a===_0x3ee415;},'GwoPV':'string','psIQx':function(_0x446f30,_0xc1ee9d,_0x5250cf,_0x465b23){return _0x446f30(_0xc1ee9d,_0x5250cf,_0x465b23);},'vjkxp':function(_0x5573b3,_0x524a70){return _0x5573b3!==_0x524a70;},'wbDnX':_0x46b353(0x431,0x467,0x460,0x437)};if(_0x32849e[_0x2d6818(0x252,0x233,0x27d,0x260)](typeof _0x14c1be,_0x32849e[_0x2d6818(0x28a,0x215,0x207,0x24d)]))return _0x32849e[_0x2d6818(0x284,0x247,0x297,0x278)](processStringVariables,_0x14c1be,_0x26c945,_0x3ee411);function _0x46b353(_0x218c81,_0x2a7161,_0x3e0800,_0x3400e7){return _0x177c(_0x3400e7-0x38a,_0x3e0800);}if(Array[_0x2d6818(0x2b5,0x265,0x273,0x274)](_0x14c1be))return _0x32849e[_0x2d6818(0x1d9,0x1b6,0x237,0x1fa)](_0x32849e['wbDnX'],_0x46b353(0x4a2,0x47e,0x448,0x474))?_0x14c1be[_0x46b353(0x4e7,0x4d7,0x482,0x4a9)](_0x236f7c=>{function _0x3a105c(_0x2e5458,_0x44d34e,_0x5e41ed,_0xd10b7e){return _0x46b353(_0x2e5458-0xf8,_0x44d34e-0xb6,_0xd10b7e,_0x2e5458- -0x74d);}if(_0x236f7c&&_0x236f7c[_0x451fd0(0x53,-0x2,0x2e,0x40)]===_0x451fd0(0x52,0x2c,0x52,0x60)&&_0x32849e[_0x3a105c(-0x2dd,-0x2cb,-0x2fb,-0x2bf)](typeof _0x236f7c[_0x451fd0(0x9b,0x3,0x52,0x6)],'string'))return{..._0x236f7c,'text':_0x32849e[_0x451fd0(0x96,0x56,0x5d,0xa4)](processStringVariables,_0x236f7c[_0x3a105c(-0x306,-0x2de,-0x312,-0x30d)],_0x26c945,_0x3ee411)};function _0x451fd0(_0x357153,_0x519d2d,_0x35cabf,_0xef7ec4){return _0x2d6818(_0xef7ec4,_0x519d2d-0x19b,_0x35cabf-0x17d,_0x35cabf- -0x1c8);}return _0x236f7c;}):{..._0x430bb3,'text':_0x32849e[_0x2d6818(0x246,0x208,0x28c,0x246)](_0x99dff3,_0x200e3a['text'],_0x230101,_0x4b0d74)};return _0x14c1be;}function _0x177c(_0x17881b,_0x14994c){_0x17881b=_0x17881b-(-0xa*0x12f+-0x1cd*0x2+0x1007);const _0x8b69e3=_0x160a();let _0x42a255=_0x8b69e3[_0x17881b];if(_0x177c['HkZFhl']===undefined){var _0x302ddd=function(_0x154f69){const _0x2fcbfa='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xe3e0b8='',_0xe7aae='',_0x374aa2=_0xe3e0b8+_0x302ddd;for(let _0x584f17=0x2593*-0x1+-0xe7c+0x340f,_0x29a7a1,_0x2312e5,_0x51d1e8=0x476+0x1ead+-0x2323;_0x2312e5=_0x154f69['charAt'](_0x51d1e8++);~_0x2312e5&&(_0x29a7a1=_0x584f17%(0x13f2+0x19cd+0x17*-0x1fd)?_0x29a7a1*(0x1389+-0x2186+0xe3d)+_0x2312e5:_0x2312e5,_0x584f17++%(-0x242f+0x3*0x17e+0x3*0xa93))?_0xe3e0b8+=_0x374aa2['charCodeAt'](_0x51d1e8+(-0x22d6+0xd63+0x1*0x157d))-(-0x107*-0x15+0x9f6+-0xb*0x2dd)!==-0xb93*0x2+-0xe9d+0x25c3*0x1?String['fromCharCode'](-0x225+0x310*0xa+-0x1b7c&_0x29a7a1>>(-(0x19*0xd5+-0x1a39+0x5*0x116)*_0x584f17&-0x2*-0x4af+0x1aa3*0x1+-0x23fb*0x1)):_0x584f17:-0x77d+0xf05+-0x8*0xf1){_0x2312e5=_0x2fcbfa['indexOf'](_0x2312e5);}for(let _0x593f4f=0x6*0x482+-0x22*0x10f+-0x479*-0x2,_0x23f77f=_0xe3e0b8['length'];_0x593f4f<_0x23f77f;_0x593f4f++){_0xe7aae+='%'+('00'+_0xe3e0b8['charCodeAt'](_0x593f4f)['toString'](0x2467*-0x1+-0x74*0x2b+0x37f3))['slice'](-(-0x75c*-0x5+-0x1bdd+0x1*-0x8ed));}return decodeURIComponent(_0xe7aae);};_0x177c['hcwqvF']=_0x302ddd,_0x177c['cPHRaB']={},_0x177c['HkZFhl']=!![];}const _0x1059ac=_0x8b69e3[-0xd6*0xf+-0x2314+-0x17cf*-0x2],_0x374fd7=_0x17881b+_0x1059ac,_0x658a8a=_0x177c['cPHRaB'][_0x374fd7];if(!_0x658a8a){const _0x4afa32=function(_0x693257){this['mqoIeT']=_0x693257,this['bqhSBr']=[0x197*-0x14+-0x8d6+-0x67*-0x65,-0x1493+-0x2*0x6be+0x220f,0x233d+0x5ca+-0x2907],this['uQAasz']=function(){return'newState';},this['yCafBC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['iZXVmJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4afa32['prototype']['TYjANP']=function(){const _0x3d2c0e=new RegExp(this['yCafBC']+this['iZXVmJ']),_0x296aa5=_0x3d2c0e['test'](this['uQAasz']['toString']())?--this['bqhSBr'][-0x3*-0x8bb+-0x1*0x669+-0x53*0x3d]:--this['bqhSBr'][-0x6*-0x32b+0x89*0xc+0x3e*-0x69];return this['MGFKtZ'](_0x296aa5);},_0x4afa32['prototype']['MGFKtZ']=function(_0x12f1d4){if(!Boolean(~_0x12f1d4))return _0x12f1d4;return this['ZWFLit'](this['mqoIeT']);},_0x4afa32['prototype']['ZWFLit']=function(_0x35be28){for(let _0x110872=-0x1*-0x1804+-0xfb*-0x1b+0x205*-0x19,_0x571e4a=this['bqhSBr']['length'];_0x110872<_0x571e4a;_0x110872++){this['bqhSBr']['push'](Math['round'](Math['random']())),_0x571e4a=this['bqhSBr']['length'];}return _0x35be28(this['bqhSBr'][0x2379*0x1+-0x1*0x1e2f+-0x54a]);},new _0x4afa32(_0x177c)['TYjANP'](),_0x42a255=_0x177c['hcwqvF'](_0x42a255),_0x177c['cPHRaB'][_0x374fd7]=_0x42a255;}else _0x42a255=_0x658a8a;return _0x42a255;}function processStringVariables(_0x3a9a73,_0x39c208,_0x582902){const _0x8a3896={'VWWgP':function(_0x260d47,_0x11320c,_0x8bb127){return _0x260d47(_0x11320c,_0x8bb127);},'XHXfN':function(_0x288b6b,_0x4252c9){return _0x288b6b(_0x4252c9);},'TigGY':function(_0x872cca,_0x2e8d41){return _0x872cca!==_0x2e8d41;},'CpcFG':'enqLr','fspTw':_0x325769(0x57,-0x18,0x17,0x23),'aWkCn':function(_0x4abc9d,_0x5b3e14){return _0x4abc9d===_0x5b3e14;},'FPhaI':_0x3faf65(0x361,0x34e,0x362,0x339),'klAzw':function(_0x39d059,_0x548439,_0x42009f,_0x360f6a){return _0x39d059(_0x548439,_0x42009f,_0x360f6a);},'AjfWX':function(_0x17ce0c,_0x43d05b){return _0x17ce0c===_0x43d05b;},'eujuz':_0x3faf65(0x2ff,0x316,0x2d5,0x2ea),'AkjSn':_0x325769(0x6f,0x89,0x5b,0x61)};if(!_0x3a9a73)return _0x3a9a73;function _0x325769(_0x2623a9,_0x3fb744,_0x47e356,_0x5724a3){return _0x177c(_0x47e356- -0xa6,_0x5724a3);}let _0x2d771f=_0x3a9a73;function _0x3faf65(_0x695738,_0x2a5f7b,_0x4b380e,_0x812d1){return _0x177c(_0x812d1-0x223,_0x695738);}return _0x2d771f=_0x2d771f[_0x325769(0x34,0x19,0x51,0x37)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x9ccae1,_0x2f6663,_0x4c61fa)=>{const _0x1122c2=_0x2f6663[_0x1f3870(-0x223,-0x2a5,-0x269,-0x260)]();_0x39c208[_0x4c797(0x7c,0x61,0x7c,0x6b)+'ta']['variables'][_0x1122c2]=_0x4c61fa;function _0x1f3870(_0x31ff51,_0x5edf8f,_0x13b1a6,_0x487a42){return _0x3faf65(_0x5edf8f,_0x5edf8f-0x17c,_0x13b1a6-0x25,_0x13b1a6- -0x595);}function _0x4c797(_0x162306,_0x16f66e,_0x43218d,_0xb56cd1){return _0x3faf65(_0xb56cd1,_0x16f66e-0x96,_0x43218d-0x100,_0x43218d- -0x2ca);}return _0x582902&&_0x582902['add'](_0x4c797(0x8f,0x87,0x6c,0x48)+_0x1122c2+'@}'),'';}),_0x2d771f=_0x2d771f[_0x325769(0x4c,0x8d,0x51,0x34)](/\{@getvar::([^@]+)@\}/g,(_0x2eabbd,_0x523bc9)=>{const _0x1bef3b=_0x523bc9[_0x2af110(-0xc6,-0x111,-0xc3,-0xe3)](),_0x1a6fb6=_0x39c208['chatMetada'+'ta'][_0x3e589a(0x250,0x266,0x24c,0x20a)][_0x1bef3b]||'';function _0x3e589a(_0x4815b9,_0x2331c9,_0x4b53af,_0x3f9ecf){return _0x325769(_0x4815b9-0x1de,_0x2331c9-0xe,_0x4b53af-0x227,_0x2331c9);}function _0x2af110(_0x3a1a69,_0x407525,_0x3f09e8,_0x185406){return _0x325769(_0x3a1a69-0xb8,_0x407525-0x15,_0x185406- -0x146,_0x407525);}return _0x582902&&_0x582902[_0x3e589a(0x2ad,0x2a9,0x262,0x28e)](_0x2af110(-0x16c,-0x18a,-0x103,-0x139)+_0x1bef3b+'@}'),_0x1a6fb6;}),_0x2d771f=_0x2d771f[_0x325769(0x5,0x69,0x51,0x4d)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x13a3ba,_0x2e43f3,_0x260f8e)=>{const _0x58089a=_0x2e43f3[_0xb28c5(-0xcc,-0xe8,-0x9f,-0x7e)]();function _0xb28c5(_0x248b1b,_0x2a7b9b,_0x52c802,_0x1c3316){return _0x325769(_0x248b1b-0x1ee,_0x2a7b9b-0x8,_0x248b1b- -0x12f,_0x1c3316);}_0x8a3896[_0x3e1cb5(-0x1fb,-0x1a9,-0x1fa,-0x1d5)](setglobalvar,_0x58089a,_0x260f8e);function _0x3e1cb5(_0x35372a,_0x2d1e13,_0x515a4d,_0x5b2640){return _0x3faf65(_0x35372a,_0x2d1e13-0xfd,_0x515a4d-0x1bc,_0x515a4d- -0x52c);}return _0x582902&&_0x582902[_0x3e1cb5(-0x22c,-0x234,-0x228,-0x26f)]('{@setgloba'+_0x3e1cb5(-0x1d2,-0x1ea,-0x1fd,-0x223)+_0x58089a+'@}'),'';}),_0x2d771f=_0x2d771f[_0x325769(0x42,0x5f,0x51,0xf)](/\{@getglobalvar::([^@]+)@\}/g,(_0x39cb30,_0x1a0526)=>{function _0x39cb98(_0xb57282,_0x280c5a,_0x5ef413,_0xbd729){return _0x325769(_0xb57282-0x49,_0x280c5a-0x14,_0xb57282-0x176,_0xbd729);}function _0xf7c82e(_0x2c7fdd,_0x4144db,_0x18c732,_0x5b74f7){return _0x3faf65(_0x2c7fdd,_0x4144db-0x10d,_0x18c732-0x13e,_0x4144db- -0x192);}const _0x28795a=_0x1a0526['trim'](),_0x20d744=_0x8a3896[_0x39cb98(0x1d4,0x1ce,0x20a,0x19c)](getglobalvar,_0x28795a)||'';return _0x582902&&(_0x8a3896[_0xf7c82e(0x1d4,0x196,0x1e6,0x152)]('enqLr',_0x8a3896[_0xf7c82e(0x164,0x19e,0x1c9,0x1d4)])?_0xb1ec0f[_0xf7c82e(0x125,0x172,0x15f,0x130)](_0xf7c82e(0x126,0x144,0xff,0x192)+_0x380e92+'@}'):_0x582902[_0x39cb98(0x1b1,0x1bf,0x1c0,0x163)](_0xf7c82e(0x1fa,0x1c4,0x216,0x20b)+'lvar::'+_0x28795a+'@}')),_0x20d744;}),_0x2d771f=_0x2d771f[_0x3faf65(0x31e,0x2db,0x31f,0x31a)](/\{@getworldvar::([^@]+)@\}/g,(_0x5db364,_0x223240)=>{const _0x4847ec=_0x223240[_0x55e136(0x3eb,0x413,0x405,0x407)](),_0x4ce4ba=getworldvar(_0x4847ec)||'';if(_0x582902){if(_0x8a3896[_0x5a41e6(0x160,0x135,0x16f,0x12d)](_0x8a3896[_0x55e136(0x364,0x364,0x38f,0x3a4)],_0x8a3896[_0x55e136(0x390,0x3e2,0x3bc,0x3d9)])){if(_0x349d83&&_0x3627da['type']===_0x8a3896[_0x55e136(0x3ec,0x40e,0x407,0x41f)]&&_0x8a3896['aWkCn'](typeof _0x11e465[_0x5a41e6(0x165,0x1a8,0x13c,0x153)],_0x8a3896[_0x55e136(0x3f7,0x41b,0x3e3,0x42e)]))return{..._0x3baddb,'text':_0x8a3896[_0x5a41e6(0x163,0x165,0x16f,0x156)](_0x1a861a,_0x37f0ac[_0x55e136(0x3fc,0x3a4,0x38f,0x3bb)],_0x3c5ce9,_0x42d4e7)};return _0x1d233d;}else _0x582902[_0x5a41e6(0x189,0x1cf,0x178,0x194)](_0x55e136(0x389,0x3cf,0x404,0x3be)+_0x5a41e6(0x1bc,0x1fd,0x206,0x1ac)+_0x4847ec+'@}');}function _0x5a41e6(_0x5f57e1,_0x11db22,_0x55f10d,_0x3ecf5a){return _0x3faf65(_0x11db22,_0x11db22-0x1ca,_0x55f10d-0x5c,_0x5f57e1- -0x17b);}function _0x55e136(_0x52b988,_0x28f786,_0x35cae6,_0x330db8){return _0x3faf65(_0x52b988,_0x28f786-0xd1,_0x35cae6-0xbb,_0x330db8-0xdb);}return _0x4ce4ba;}),_0x2d771f;}export function buildPromptWithTrigger(_0x3552c7){const _0x3923ca={'pWilE':function(_0x37da58,_0x5c0b12){return _0x37da58!==_0x5c0b12;},'SHEAg':_0x4e2faf(0x164,0x11b,0x1ae,0x172),'flgGw':_0x4e2faf(0x182,0x196,0x1be,0x162),'xtZql':function(_0x51c046,_0x14484b){return _0x51c046===_0x14484b;},'iYYVe':_0x517c1b(-0x98,-0x68,-0x8c,-0x54),'MYCwn':_0x517c1b(-0xc6,-0xbb,-0xd4,-0x10f),'STNDr':_0x517c1b(-0xa5,-0xc9,-0x7a,-0x7f),'PUkdK':function(_0x29fe4f,_0x38d34d,_0x4f1d20){return _0x29fe4f(_0x38d34d,_0x4f1d20);},'NDtpt':function(_0x3e70f1,_0x597a4d){return _0x3e70f1!==_0x597a4d;},'PRBkL':function(_0x542bdd,_0x45cea5){return _0x542bdd===_0x45cea5;},'LcYVB':_0x517c1b(-0x6f,-0x40,-0x3c,-0xbe),'uOthF':_0x4e2faf(0x17f,0x19f,0x1ce,0x137),'LwVsP':_0x4e2faf(0x19f,0x1a2,0x1ca,0x1ef),'UtkvL':_0x517c1b(-0xc5,-0x91,-0x8d,-0xc8),'GtGny':function(_0x2819cb,_0x32971f){return _0x2819cb(_0x32971f);}},{requestType:_0x3795d4,contextData:_0x365f86}=_0x3552c7;function _0x4e2faf(_0x51129d,_0xc4b819,_0x4287a6,_0x30a5f5){return _0x177c(_0x51129d-0x71,_0x4287a6);}const _0x2efb81=extension_settings[extensionName]?.[_0x517c1b(-0x53,-0x1c,-0x14,-0x86)+_0x4e2faf(0x179,0x152,0x135,0x1b1)+_0x4e2faf(0x19d,0x165,0x1b2,0x161)]||{},_0x2906ca={};_0x2906ca[_0x517c1b(-0xc3,-0xb2,-0x99,-0x107)+_0x517c1b(-0x60,-0x93,-0x62,-0x34)]='默认';function _0x517c1b(_0x24323d,_0x3c8622,_0x5452b6,_0x2531ea){return _0x177c(_0x24323d- -0x184,_0x3c8622);}const _0x29c9c9=_0x2efb81[_0x3795d4]||_0x2906ca,_0x3eab89=_0x29c9c9['context_pr'+'ofile']||'默认',_0x5bbfbb=extension_settings[extensionName]?.[_0x517c1b(-0x8e,-0xcf,-0xac,-0x45)+'xt_profile'+'s']||{},_0x485da7=_0x5bbfbb[_0x3eab89]||_0x5bbfbb[Object[_0x4e2faf(0x1a8,0x1ed,0x1fa,0x1a3)](_0x5bbfbb)[0x31*-0x89+0x476*0x6+-0x8b]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x365f86,_0x4835a5=[userDemand,context,body,worldBookContent]['filter'](Boolean)[_0x4e2faf(0x113,0x14d,0x13f,0x147)]('\x0a'),_0x2a4cc1=[];if(_0x485da7[_0x4e2faf(0x154,0x167,0x174,0x199)]&&Array[_0x517c1b(-0x6d,-0x82,-0xb7,-0x33)](_0x485da7[_0x517c1b(-0xa1,-0x74,-0x6b,-0xf2)])){if(_0x3923ca[_0x517c1b(-0xaf,-0x9d,-0xaf,-0xe7)](_0x3923ca['SHEAg'],_0x3923ca[_0x4e2faf(0x134,0x141,0x16a,0x131)]))for(const _0x39e44c of _0x485da7[_0x517c1b(-0xa1,-0xb4,-0xdd,-0xc2)]){if(!_0x39e44c['enabled'])continue;if(!_0x39e44c[_0x4e2faf(0x114,0x15a,0x117,0x13e)]||_0x3923ca['xtZql'](_0x39e44c[_0x4e2faf(0x114,0x119,0x153,0x111)][_0x4e2faf(0x17a,0x1c4,0x1c7,0x1cc)](),''))continue;if(_0x3923ca[_0x517c1b(-0x52,-0x78,-0x33,-0x48)](_0x39e44c['triggerMod'+'e'],_0x3923ca[_0x4e2faf(0x16f,0x1ae,0x19b,0x13d)])){if(_0x3923ca['xtZql'](_0x3923ca[_0x4e2faf(0x18b,0x1c4,0x19b,0x188)],_0x3923ca['STNDr']))_0x4c1ee7['add']('{@setgloba'+'lvar::'+_0x1f70fc+'@}');else{if(!_0x3923ca[_0x4e2faf(0x183,0x18c,0x14e,0x168)](checkTriggerWords,_0x39e44c[_0x4e2faf(0x1a6,0x1d9,0x182,0x1f0)+'ds'],_0x4835a5))continue;}}const _0x24e6b4={};_0x24e6b4[_0x517c1b(-0x50,-0x28,-0x54,-0x6c)]=_0x39e44c[_0x4e2faf(0x1a5,0x1a5,0x1b7,0x1da)]||'user',_0x24e6b4[_0x4e2faf(0x114,0xe0,0x108,0xf0)]=_0x39e44c[_0x4e2faf(0x114,0x10e,0x101,0xd2)],_0x2a4cc1[_0x4e2faf(0x147,0x10b,0x125,0x13b)](_0x24e6b4);}else{const _0x281211=/\{\{getvar::([^}]+)\}\}/g,_0x3bd800=_0x332768[_0x4e2faf(0x14e,0x18f,0x135,0x10e)](_0x3efffc),_0x24fd75=[..._0x3bd800['matchAll'](_0x281211)],_0x3cfd98=new _0x42d939();for(const _0x2ce1e4 of _0x24fd75){_0x3cfd98[_0x517c1b(-0xa3,-0x73,-0xd1,-0x70)](_0x2ce1e4[-0x20f6*0x1+-0x54*0x6b+0x4413]);}for(const _0x512224 of _0x3cfd98){const _0x46b441=_0x517c1b(-0xb8,-0xd3,-0x6a,-0x9d)+_0x512224+'}}',_0x4d9449=_0x2d1b56[_0x512224]||'';_0xd11ddf=_0x41c7b4(_0x302453,_0x46b441,_0x4d9449,_0x11f4d7);}}}else{if(_0x485da7[_0x517c1b(-0x7d,-0x88,-0x69,-0xb5)]&&Array['isArray'](_0x485da7[_0x4e2faf(0x178,0x197,0x1a2,0x1b2)]))for(const _0x364ce8 of _0x485da7[_0x517c1b(-0x7d,-0x91,-0xca,-0x55)]){if(_0x364ce8[_0x4e2faf(0x17f,0x1cb,0x1cb,0x1c8)]&&_0x3923ca[_0x4e2faf(0x121,0x135,0x105,0xe9)](_0x364ce8['user'][_0x517c1b(-0x7b,-0xa1,-0x48,-0xa1)](),'')){if(_0x3923ca[_0x517c1b(-0xc2,-0x81,-0xec,-0x109)](_0x3923ca[_0x4e2faf(0x143,0x110,0xf9,0x158)],_0x4e2faf(0x186,0x18e,0x1d1,0x1ac))){const _0x2acd24={};_0x2acd24[_0x517c1b(-0x50,-0x81,-0x9f,-0x1)]=_0x3923ca['uOthF'],_0x2acd24[_0x517c1b(-0xe1,-0xb7,-0x132,-0xf8)]=_0x364ce8[_0x4e2faf(0x17f,0x1a4,0x150,0x15e)],_0x2a4cc1[_0x517c1b(-0xae,-0x66,-0xfb,-0xef)](_0x2acd24);}else return _0x52491f[_0x517c1b(-0x65,-0x54,-0xaf,-0x80)](_0x2a395b=>_0x40d3c0(_0x2a395b,_0x45af1f,_0x55f366,_0x54e448));}if(_0x364ce8[_0x517c1b(-0xc5,-0xd5,-0xf4,-0xa3)]&&_0x364ce8[_0x517c1b(-0xc5,-0xf4,-0xcd,-0x9d)][_0x4e2faf(0x17a,0x19b,0x155,0x1b1)]()!==''){if(_0x3923ca[_0x517c1b(-0x52,-0x59,-0x86,-0x73)](_0x3923ca[_0x517c1b(-0xdc,-0xa9,-0x12e,-0xac)],_0x517c1b(-0x56,-0x6c,-0x81,-0x7d))){const _0x571553={};_0x571553[_0x4e2faf(0x1a5,0x1df,0x1d8,0x164)]=_0x3923ca[_0x4e2faf(0x18a,0x13d,0x147,0x19f)],_0x571553['content']=_0x364ce8[_0x517c1b(-0xc5,-0xff,-0xd6,-0x88)],_0x2a4cc1['push'](_0x571553);}else{const _0x113fc2=_0x40c20f[_0x517c1b(-0x7b,-0x44,-0xc6,-0x3a)]();return _0x35eafc(_0x113fc2,_0x3e681c),_0x4b29ae&&_0xb53a8d[_0x4e2faf(0x152,0x10a,0x167,0x104)](_0x4e2faf(0x12b,0x12b,0x163,0x15a)+_0x4e2faf(0x17d,0x1c1,0x1c3,0x1b5)+_0x113fc2+'@}'),'';}}}}const _0xb9b868=_0x3923ca[_0x517c1b(-0xa2,-0xb7,-0x56,-0xc9)](mergeAdjacentMessages,_0x2a4cc1),{messages:_0x4ef638,replacedVariables:_0x10f7d0}=replaceAllPlaceholders(_0xb9b868,_0x365f86);return _0x4ef638;}export function getProcessedPrompt(_0x441654,_0x4fdf12){function _0x50771e(_0x48c2c1,_0x2af270,_0xb57988,_0x45438e){return _0x177c(_0x2af270-0x130,_0x48c2c1);}const _0x5ac479={'PUTAG':function(_0x4fe400,_0xde230b){return _0x4fe400(_0xde230b);}},_0x3b0db6={};_0x3b0db6['requestTyp'+'e']=_0x441654,_0x3b0db6[_0xb5559f(0x100,0xd0,0x10c,0xe0)+'a']=_0x4fdf12;function _0xb5559f(_0x558d48,_0xea55ad,_0x27fabd,_0x2c1c3b){return _0x177c(_0x27fabd-0x46,_0x558d48);}return _0x5ac479[_0xb5559f(0xab,0xac,0xf1,0xf6)](buildPromptWithTrigger,_0x3b0db6);}