(function(_0x48cb53,_0x2b310d){function _0xc21272(_0x28be0d,_0x27a2e7,_0x3a1226,_0x40acbb){return _0x4003(_0x40acbb-0xcd,_0x3a1226);}function _0xde169(_0x17b2bd,_0x3d4d27,_0x5de996,_0x262f42){return _0x4003(_0x262f42- -0x32e,_0x17b2bd);}const _0x380fbd=_0x48cb53();while(!![]){try{const _0xaf6593=-parseInt(_0xde169(-0xeb,-0x12a,-0x12b,-0x108))/(0x3e1*-0x2+0x1b18+-0x1355)+-parseInt(_0xde169(-0x12d,-0x11c,-0x152,-0x125))/(0x5a5+-0x1010+0x11*0x9d)+parseInt(_0xc21272(0x27f,0x28b,0x27e,0x2c3))/(0x3*-0xb03+-0x22b*0xb+0x38e5)*(parseInt(_0xde169(-0x18e,-0x129,-0x122,-0x154))/(-0x1d12+-0x2*-0xbb0+0x5b6))+parseInt(_0xde169(-0x118,-0x10c,-0xff,-0xdd))/(-0x1148*0x1+0x1*0xbc5+0x588*0x1)*(parseInt(_0xc21272(0x341,0x2df,0x364,0x317))/(0x3a1*-0x3+0x1*-0x1186+0x1c6f))+parseInt(_0xc21272(0x307,0x2b1,0x2b5,0x2d2))/(0x4*-0x263+0xb76+-0x1*0x1e3)+parseInt(_0xc21272(0x2c8,0x2ae,0x2c4,0x2d3))/(-0x16e5+0xd*0x1f+-0x71e*-0x3)+-parseInt(_0xc21272(0x30d,0x30a,0x2dc,0x2ec))/(-0x9e+-0x46f+0x516)*(-parseInt(_0xde169(-0x143,-0x145,-0x151,-0x107))/(0x4*0x62f+-0x128*0x1+0x2e*-0x83));if(_0xaf6593===_0x2b310d)break;else _0x380fbd['push'](_0x380fbd['shift']());}catch(_0x445a3b){_0x380fbd['push'](_0x380fbd['shift']());}}}(_0x7343,-0x1*0x7ec27+0x7b*-0x1707+0x1ced72));const _0x395ea6=(function(){let _0x4d3bff=!![];return function(_0x2bda1f,_0xd6f722){const _0x26028e=_0x4d3bff?function(){function _0xd9e4ec(_0x3c5659,_0x357a71,_0x22e7a1,_0x46aee6){return _0x4003(_0x46aee6- -0x319,_0x22e7a1);}if(_0xd6f722){const _0xb2a232=_0xd6f722[_0xd9e4ec(-0x143,-0x12d,-0x118,-0x10c)](_0x2bda1f,arguments);return _0xd6f722=null,_0xb2a232;}}:function(){};return _0x4d3bff=![],_0x26028e;};}()),_0x316cd7=_0x395ea6(this,function(){const _0x54e101={};_0x54e101['NTvSy']=_0x3c51b2(0x5ab,0x5d2,0x591,0x599)+'+$';function _0x3c51b2(_0x1a09cb,_0x5e6d88,_0x10faaf,_0x532d35){return _0x4003(_0x10faaf-0x35c,_0x1a09cb);}const _0x35e5c7=_0x54e101;function _0x408dac(_0x589f6c,_0x4071bd,_0x54327d,_0x24a7a2){return _0x4003(_0x4071bd-0x2e8,_0x54327d);}return _0x316cd7['toString']()[_0x3c51b2(0x559,0x4fe,0x531,0x50f)](_0x35e5c7['NTvSy'])[_0x3c51b2(0x57f,0x592,0x56f,0x53c)]()[_0x408dac(0x4b0,0x4b9,0x4a9,0x4c4)+'r'](_0x316cd7)[_0x3c51b2(0x530,0x544,0x531,0x51c)](_0x35e5c7['NTvSy']);});_0x316cd7();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x3c85d8,_0x28ff55){const _0xefcfa9={'iMnYF':function(_0x1a68a6,_0x53e5ac,_0x5c166a,_0x3dfe88,_0x50f3fe){return _0x1a68a6(_0x53e5ac,_0x5c166a,_0x3dfe88,_0x50f3fe);},'zxPvk':function(_0x83852a,_0x5a3dab){return _0x83852a===_0x5a3dab;},'hprDo':_0x23ccbd(0x4be,0x48e,0x4f1,0x4d5),'AzUba':'uIrkU'};if(!_0x3c85d8||!_0x28ff55)return![];function _0x23ccbd(_0x1939f8,_0x511648,_0x43010e,_0x28b24f){return _0x4003(_0x1939f8-0x2a4,_0x511648);}function _0x2feebf(_0x454afc,_0x3850b2,_0xcfdb46,_0x36e708){return _0x4003(_0x36e708-0xf1,_0x3850b2);}const _0x531c6e=_0x3c85d8[_0x2feebf(0x34f,0x33f,0x360,0x325)](',')[_0x2feebf(0x326,0x2b6,0x2dc,0x2e0)](_0x2cc91c=>_0x2cc91c[_0x2feebf(0x2e3,0x351,0x348,0x30d)]())[_0x2feebf(0x30e,0x36e,0x362,0x350)](_0x316671=>_0x316671);if(_0xefcfa9[_0x2feebf(0x322,0x304,0x2f7,0x306)](_0x531c6e['length'],-0x3*-0xab5+0x25c2+-0x45e1)){if(_0xefcfa9[_0x2feebf(0x36e,0x313,0x33d,0x33c)]!==_0x2feebf(0x33a,0x340,0x2ec,0x30c))return![];else{if(_0x164eae[_0x2feebf(0x371,0x317,0x356,0x346)](_0x14e302))return!![];}}for(const _0xaca2e1 of _0x531c6e){if(_0x28ff55[_0x23ccbd(0x4f9,0x508,0x4b1,0x4d1)](_0xaca2e1)){if(_0xefcfa9[_0x23ccbd(0x4b9,0x47c,0x4ed,0x48c)](_0xefcfa9[_0x2feebf(0x310,0x338,0x2a2,0x2ef)],_0xefcfa9[_0x23ccbd(0x4a2,0x4a8,0x487,0x4de)]))return!![];else{const _0x37617b={};for(const _0x3a1717 in _0xef6a6a){_0x37617b[_0x3a1717]=_0xefcfa9[_0x23ccbd(0x4e7,0x526,0x52c,0x52a)](_0x40a685,_0xd3fd21[_0x3a1717],_0x471c43,_0x58744d,_0x1e6a23);}return _0x37617b;}}}return![];}export function mergeAdjacentMessages(_0x5c2362){const _0x3b95f2={'RlNNd':function(_0x3ff7be,_0x1423b9){return _0x3ff7be===_0x1423b9;},'JUaZA':_0x518df8(0x487,0x4ca,0x496,0x4ae),'XFkgp':function(_0x4da435,_0x43f81d,_0x25c722){return _0x4da435(_0x43f81d,_0x25c722);}};if(!_0x5c2362||_0x5c2362[_0x518df8(0x47f,0x4bf,0x4c1,0x4ac)]===0x220b+-0x1095+-0x1176)return[];const _0x1f8cfd=[];function _0x442fd6(_0x24b737,_0x3e6ca8,_0x5f2b12,_0x410de1){return _0x4003(_0x5f2b12-0xda,_0x24b737);}let _0x2c5062=null;function _0x518df8(_0x348b53,_0x504707,_0x42a0d8,_0x2b45f9){return _0x4003(_0x348b53-0x2a3,_0x504707);}for(const _0x187503 of _0x5c2362){if(!_0x2c5062){const _0x6fd7d5={..._0x187503};_0x2c5062=_0x6fd7d5;}else{if(_0x3b95f2[_0x518df8(0x4c0,0x492,0x4f5,0x4fd)](_0x2c5062['role'],_0x187503['role'])){if(_0x3b95f2['JUaZA']!==_0x3b95f2[_0x442fd6(0x300,0x2d5,0x2f3,0x339)]){if(!_0x38421c||!_0x5d28a4[_0x442fd6(0x30b,0x34f,0x310,0x340)])return _0x38b167;return{..._0xad9c21,'content':_0xf47e55(_0x3d3583[_0x518df8(0x4d9,0x51d,0x506,0x49f)],_0x30b8bd,_0x4343b7)};}else _0x2c5062['content']=_0x3b95f2[_0x518df8(0x46e,0x43f,0x480,0x47f)](mergeContent,_0x2c5062[_0x518df8(0x4d9,0x4f3,0x49e,0x4d5)],_0x187503[_0x442fd6(0x2e4,0x2d9,0x310,0x2e4)]);}else{_0x1f8cfd[_0x518df8(0x4aa,0x4c3,0x45f,0x4d8)](_0x2c5062);const _0x492515={..._0x187503};_0x2c5062=_0x492515;}}}return _0x2c5062&&_0x1f8cfd['push'](_0x2c5062),_0x1f8cfd;}function mergeContent(_0x5674a0,_0x2cc452){const _0x54466f={'kBbSD':function(_0x291f0a,_0x54af46){return _0x291f0a===_0x54af46;},'uwbUb':_0x29f46c(0x53a,0x500,0x4b4,0x547),'MLbNT':function(_0x340797,_0x4d0a0f){return _0x340797===_0x4d0a0f;},'XBExj':function(_0x5156d8,_0x5d3216){return _0x5156d8===_0x5d3216;},'DuoxX':_0x5efce4(0x2ee,0x2d3,0x2c4,0x301),'OTwSI':_0x5efce4(0x2f7,0x302,0x32a,0x338),'XgKKk':function(_0x309401,_0x4bc2a3){return _0x309401+_0x4bc2a3;},'TbOKt':function(_0x13b5e9,_0x5dcc76){return _0x13b5e9+_0x5dcc76;},'OzHSK':function(_0x250a86,_0x2073d0){return _0x250a86(_0x2073d0);},'wSTuR':_0x5efce4(0x2fa,0x2f4,0x2fe,0x30e)};if(_0x54466f[_0x5efce4(0x2a7,0x2ca,0x294,0x2a3)](typeof _0x5674a0,_0x54466f[_0x29f46c(0x4ad,0x4bc,0x4d3,0x4f9)])&&_0x54466f[_0x5efce4(0x308,0x31b,0x327,0x31e)](typeof _0x2cc452,_0x54466f[_0x5efce4(0x27a,0x249,0x266,0x267)])){if(_0x54466f['XBExj'](_0x54466f['DuoxX'],_0x54466f[_0x29f46c(0x598,0x54c,0x54d,0x55e)]))_0x335500[_0x5efce4(0x2cb,0x2e3,0x294,0x2de)](_0x29f46c(0x4f5,0x4c2,0x4b4,0x4b1)+_0x58683d+'@}');else return _0x54466f[_0x29f46c(0x4aa,0x4b8,0x489,0x492)](_0x54466f[_0x5efce4(0x291,0x264,0x261,0x250)](_0x5674a0,'\x0a'),_0x2cc452);}const _0x1b64f7=normalizeToArray(_0x5674a0),_0x2027f9=_0x54466f[_0x29f46c(0x507,0x4d9,0x4bd,0x4c2)](normalizeToArray,_0x2cc452);function _0x29f46c(_0x13fec7,_0x9dfef1,_0x1a67d7,_0x5bba0e){return _0x4003(_0x9dfef1-0x2ec,_0x5bba0e);}function _0x5efce4(_0xf9e40e,_0x5c7989,_0x424a59,_0x2ea147){return _0x4003(_0xf9e40e-0xaa,_0x5c7989);}const _0x51e4b3={};return _0x51e4b3['type']=_0x54466f[_0x5efce4(0x2e6,0x316,0x2cd,0x2a2)],_0x51e4b3['text']='\x0a',[..._0x1b64f7,_0x51e4b3,..._0x2027f9];}function normalizeToArray(_0x2bd982){const _0x2e4127={};function _0x3497ae(_0x1c4b2b,_0x875c4a,_0x16bca2,_0x561bf4){return _0x4003(_0x875c4a-0x290,_0x16bca2);}_0x2e4127[_0x348c1e(0x14a,0x122,0x161,0x181)]=_0x3497ae(0x4dd,0x4e0,0x510,0x4cb),_0x2e4127[_0x348c1e(0x135,0x130,0x102,0x123)]=function(_0x2d89d3,_0x46666d){return _0x2d89d3||_0x46666d;};function _0x348c1e(_0x3b53dd,_0x5d0e73,_0x177af5,_0x6da577){return _0x4003(_0x3b53dd- -0x10a,_0x6da577);}const _0xe566d=_0x2e4127;if(Array['isArray'](_0x2bd982))return _0x2bd982;return[{'type':_0xe566d['cJwLH'],'text':_0xe566d[_0x3497ae(0x4dd,0x4cf,0x4cd,0x512)](_0x2bd982,'')}];}export function replacePlaceholder(_0x81f722,_0x3ca37a,_0x28465f,_0x48e1f3){const _0x11ce20={'rZGKa':'assistant','smvKq':'string','KTMUy':function(_0x17a639,_0xeaf1e4){return _0x17a639!==_0xeaf1e4;},'xLaPz':_0x1c94b6(0x51e,0x51a,0x545,0x504),'JMwTg':_0x1c94b6(0x52a,0x566,0x568,0x4f8),'hRrLY':function(_0x3a4d92,_0x4db64f){return _0x3a4d92===_0x4db64f;},'GtSqE':function(_0x4396de,_0x40d731,_0x28b8aa,_0x46f9ee,_0x48b43c){return _0x4396de(_0x40d731,_0x28b8aa,_0x46f9ee,_0x48b43c);}};if(typeof _0x81f722===_0x11ce20['smvKq']){if(_0x28465f&&_0x81f722['includes'](_0x3ca37a)){if(_0x11ce20[_0x1c94b6(0x4e0,0x507,0x505,0x4a5)](_0x11ce20[_0x4a6460(-0xd8,-0x118,-0x15d,-0x10e)],_0x11ce20[_0x4a6460(-0xf3,-0x118,-0x10b,-0x15b)])){const _0x541a67={};_0x541a67[_0x4a6460(-0xeb,-0xa2,-0x82,-0x55)]=_0x11ce20[_0x4a6460(-0x141,-0x102,-0xf1,-0x129)],_0x541a67['content']=_0x1279a4['assistant'],_0x4a06ef[_0x1c94b6(0x4d6,0x4bb,0x517,0x50a)](_0x541a67);}else _0x48e1f3&&(_0x11ce20[_0x4a6460(-0xf3,-0xea,-0xf4,-0xef)](_0x1c94b6(0x52a,0x50e,0x4f1,0x550),_0x11ce20[_0x4a6460(-0x111,-0xc8,-0xe4,-0x8c)])?_0x4c8c10[_0x1c94b6(0x4a7,0x4b2,0x45c,0x4aa)+'ta'][_0x1c94b6(0x4a8,0x4ad,0x4bc,0x473)]={}:_0x48e1f3[_0x1c94b6(0x4f0,0x4f9,0x50d,0x4b3)](_0x3ca37a));}return _0x81f722[_0x4a6460(-0xd2,-0x10a,-0xc9,-0x14d)](_0x3ca37a,_0x28465f||'');}function _0x4a6460(_0x413c85,_0x2dfc71,_0x2ed7f1,_0x16b743){return _0x4003(_0x2dfc71- -0x2fb,_0x16b743);}if(Array[_0x1c94b6(0x532,0x563,0x555,0x579)](_0x81f722))return _0x81f722['map'](_0x31e708=>replacePlaceholder(_0x31e708,_0x3ca37a,_0x28465f,_0x48e1f3));if(_0x81f722&&_0x11ce20[_0x4a6460(-0x122,-0x10f,-0x145,-0xee)](typeof _0x81f722,'object')){const _0x16bbe4={};for(const _0x3c9a2e in _0x81f722){_0x16bbe4[_0x3c9a2e]=_0x11ce20[_0x4a6460(-0xfd,-0x124,-0xd9,-0xff)](replacePlaceholder,_0x81f722[_0x3c9a2e],_0x3ca37a,_0x28465f,_0x48e1f3);}return _0x16bbe4;}function _0x1c94b6(_0x402994,_0xf64fd7,_0x409157,_0x53cc78){return _0x4003(_0x402994-0x2cf,_0x53cc78);}return _0x81f722;}export function replaceAllPlaceholders(_0x4cc995,_0x39008b){const _0x3a7c1b={'vUmhD':function(_0x429764){return _0x429764();},'PGKrc':'{{user}}','Bvinn':_0x5ce072(-0x196,-0x20b,-0x1c3,-0x1db),'NFJrx':function(_0x16d177,_0x4126bd,_0x2eb502,_0x494638,_0x2cf76c){return _0x16d177(_0x4126bd,_0x2eb502,_0x494638,_0x2cf76c);},'NhCNe':_0x386e26(0x56,0x5d,0x3b,0x1d),'phcHR':_0x5ce072(-0x1bd,-0x1a9,-0x1e0,-0x20e),'OreRu':_0x386e26(-0x1,0x6,0x1b,0x45),'WSpXJ':function(_0x32449b,_0x401572,_0x3ee59c,_0xa23532,_0x8c9377){return _0x32449b(_0x401572,_0x3ee59c,_0xa23532,_0x8c9377);},'nmbZz':_0x5ce072(-0x1c1,-0x1cc,-0x1c6,-0x1cd),'cZLva':_0x386e26(0x5a,0xa,0x4e,0x1f)+'}}','GQfYV':function(_0x4dabf7,_0x229598,_0xe87784,_0x3637f0,_0x195e8b){return _0x4dabf7(_0x229598,_0xe87784,_0x3637f0,_0x195e8b);},'CGWho':_0x386e26(-0xb,0x7,0x4a,0x24)+'}}','SZkRd':_0x5ce072(-0x1c4,-0x193,-0x198,-0x1e4),'pnfbU':function(_0x537108,_0x93d224,_0x1c52b1){return _0x537108(_0x93d224,_0x1c52b1);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x39008b,_0x5f1a5d=new Set();let _0x22ca74=_0x4cc995;const _0xaea6c1=_0x3a7c1b['vUmhD'](getContext);function _0x5ce072(_0x2ed5d7,_0x3c05d4,_0x48ebbc,_0x27081b){return _0x4003(_0x48ebbc- -0x3ae,_0x2ed5d7);}const _0x3e7a22=_0xaea6c1?.['name1']||'';let _0x3f5bd1=worldBookContent;_0x3f5bd1&&(_0x3f5bd1=_0x3f5bd1['replaceAll'](_0x3a7c1b['PGKrc'],_0x3e7a22),_0x3f5bd1=_0x3f5bd1['replaceAll'](_0x3a7c1b[_0x386e26(0x79,0x86,0x67,0x42)],_0x3e7a22));_0x22ca74=_0x3a7c1b['NFJrx'](replacePlaceholder,_0x22ca74,_0x3a7c1b[_0x386e26(0x7e,-0x7,0x3f,0x37)],context,_0x5f1a5d),_0x22ca74=replacePlaceholder(_0x22ca74,_0x3a7c1b['phcHR'],_0x3f5bd1,_0x5f1a5d),_0x22ca74=_0x3a7c1b[_0x5ce072(-0x199,-0x1a9,-0x17d,-0x145)](replacePlaceholder,_0x22ca74,_0x3a7c1b[_0x386e26(0xa9,0xa0,0xa9,0x62)],body,_0x5f1a5d),_0x22ca74=_0x3a7c1b[_0x386e26(0x2b,-0x1,-0x10,0x30)](replacePlaceholder,_0x22ca74,_0x3a7c1b[_0x386e26(0xd9,0xb4,0xda,0x95)],characterListText,_0x5f1a5d),_0x22ca74=replacePlaceholder(_0x22ca74,_0x3a7c1b[_0x5ce072(-0x1e3,-0x1f8,-0x1ad,-0x188)],outfitEnableListText,_0x5f1a5d),_0x22ca74=_0x3a7c1b[_0x5ce072(-0x14c,-0x11f,-0x14d,-0x13c)](replacePlaceholder,_0x22ca74,_0x3a7c1b[_0x5ce072(-0x1be,-0x1cb,-0x1b3,-0x1ed)],commonCharacterListText,_0x5f1a5d),_0x22ca74=replacePlaceholder(_0x22ca74,_0x3a7c1b['SZkRd'],userDemand,_0x5f1a5d);if(variables&&Object[_0x5ce072(-0x1fc,-0x1cd,-0x1e4,-0x19f)](variables)['length']>0x1*-0x363+-0x1*-0x134f+-0xfec){const _0x3c24a8=/\{\{getvar::([^}]+)\}\}/g,_0x540caf=JSON[_0x5ce072(-0x1f1,-0x1a9,-0x1c9,-0x1b8)](_0x22ca74),_0x3d2fd8=[..._0x540caf[_0x386e26(0x62,0x8,0xe,0x52)](_0x3c24a8)],_0x8c1270=new Set();for(const _0x501514 of _0x3d2fd8){_0x8c1270[_0x386e26(0x55,0x35,0x20,0x63)](_0x501514[-0x12f4*-0x1+-0x7ce*-0x4+-0x322b]);}for(const _0x3536cd of _0x8c1270){const _0x1a2c9f=_0x5ce072(-0x1c2,-0x1b1,-0x1b4,-0x1a8)+_0x3536cd+'}}',_0x18c032=variables[_0x3536cd]||'';_0x22ca74=_0x3a7c1b[_0x5ce072(-0x149,-0x15f,-0x14d,-0x120)](replacePlaceholder,_0x22ca74,_0x1a2c9f,_0x18c032,_0x5f1a5d);}}_0x22ca74=_0x3a7c1b[_0x386e26(0xc4,0x7f,0x82,0x79)](processVariablePlaceholdersInMessages,_0x22ca74,_0x5f1a5d);const _0x4e9af7={};function _0x386e26(_0x14cc96,_0x2b4e2e,_0x36f78a,_0x3997a1){return _0x4003(_0x3997a1- -0x1be,_0x36f78a);}return _0x4e9af7[_0x386e26(0x3e,0x66,0x55,0x2c)]=_0x22ca74,_0x4e9af7[_0x5ce072(-0x131,-0x18b,-0x160,-0x19c)+_0x386e26(0x27,0x3c,-0x10,0x21)]=_0x5f1a5d,_0x4e9af7;}function processVariablePlaceholdersInMessages(_0xdb287,_0x3ef41f){const _0x35a9f7={'ezsaH':function(_0xb9c679,_0x1e2102){return _0xb9c679===_0x1e2102;},'qIksp':'text','FBkZF':_0x2f32d6(-0x155,-0x135,-0x17f,-0x1bf),'IbYXB':function(_0x1f8880,_0x1d76cd,_0x7f984f,_0x2844c7){return _0x1f8880(_0x1d76cd,_0x7f984f,_0x2844c7);},'LauXv':function(_0x5062bf,_0x5c1756,_0x2fa4b2,_0x3b2105){return _0x5062bf(_0x5c1756,_0x2fa4b2,_0x3b2105);},'isCTa':function(_0x5a8958,_0xe8eda2){return _0x5a8958===_0xe8eda2;},'TowaC':_0x2f32d6(-0x178,-0x143,-0x139,-0x107),'CTFFW':_0x93d45a(0x244,0x219,0x279,0x250)};if(!_0xdb287||_0xdb287[_0x2f32d6(-0x1c3,-0x1a3,-0x1b7,-0x184)]===0x24e1+0x1*0x1cd+-0x26ae)return _0xdb287;const _0x28815f=getContext();function _0x93d45a(_0x3bb1af,_0x5922,_0x1e2841,_0x29ea93){return _0x4003(_0x29ea93-0x39,_0x1e2841);}function _0x2f32d6(_0x2ccc08,_0x2034cc,_0xdc4da5,_0x205e6a){return _0x4003(_0xdc4da5- -0x393,_0x2034cc);}!_0x28815f[_0x93d45a(0x1e9,0x1f3,0x1d2,0x211)+'ta']&&(_0x28815f[_0x2f32d6(-0x18e,-0x198,-0x1bb,-0x1da)+'ta']={});if(!_0x28815f[_0x93d45a(0x234,0x1ee,0x24f,0x211)+'ta'][_0x2f32d6(-0x185,-0x1fe,-0x1ba,-0x206)]){if(_0x35a9f7[_0x2f32d6(-0x184,-0x137,-0x156,-0x169)](_0x35a9f7['TowaC'],_0x35a9f7['CTFFW'])){const _0x57fb59={'tyPXv':function(_0x5a91f1,_0x235d92){function _0x5ea496(_0x494753,_0x3d3580,_0x3db932,_0x3984b4){return _0x2f32d6(_0x494753-0x12e,_0x494753,_0x3d3580-0x759,_0x3984b4-0x138);}return _0x35a9f7[_0x5ea496(0x579,0x5af,0x583,0x5ad)](_0x5a91f1,_0x235d92);},'HBhxX':_0x35a9f7['qIksp'],'oUzoy':function(_0x5694bd,_0xc6dd32){function _0x27508c(_0x15dd53,_0x304007,_0x57b2f8,_0xc0cee3){return _0x2f32d6(_0x15dd53-0xd1,_0x15dd53,_0x57b2f8-0x188,_0xc0cee3-0x2c);}return _0x35a9f7[_0x27508c(0x2a,-0x61,-0x22,-0x31)](_0x5694bd,_0xc6dd32);},'aDrkQ':_0x35a9f7['FBkZF'],'Ibbni':function(_0x4ee8a4,_0x39ab5d,_0x4eadf8,_0xe6ff9a){function _0x524368(_0x5b9b87,_0x4e90c4,_0x1efad3,_0x3aae36){return _0x93d45a(_0x5b9b87-0x1b5,_0x4e90c4-0x104,_0x1efad3,_0x5b9b87-0xa8);}return _0x35a9f7[_0x524368(0x31a,0x2f7,0x35b,0x2d0)](_0x4ee8a4,_0x39ab5d,_0x4eadf8,_0xe6ff9a);}};return _0x15e13b[_0x93d45a(0x212,0x262,0x1dc,0x228)](_0x45509a=>{if(_0x45509a&&_0x57fb59['tyPXv'](_0x45509a[_0x1df0de(0x384,0x33d,0x3bc,0x34e)],_0x57fb59[_0x1df0de(0x37b,0x36d,0x33b,0x362)])&&_0x57fb59[_0x92f96e(0x475,0x4b9,0x4ef,0x503)](typeof _0x45509a[_0x1df0de(0x38d,0x386,0x3ba,0x399)],_0x57fb59['aDrkQ']))return{..._0x45509a,'text':_0x57fb59[_0x92f96e(0x4a7,0x476,0x437,0x444)](_0x3c5d90,_0x45509a[_0x92f96e(0x487,0x4c4,0x490,0x50b)],_0x103601,_0x5b42c8)};function _0x1df0de(_0x475f7a,_0x5bb0d9,_0x3703c4,_0x1a544b){return _0x93d45a(_0x475f7a-0x41,_0x5bb0d9-0x1ba,_0x3703c4,_0x475f7a-0x104);}function _0x92f96e(_0x2f4de9,_0x36f833,_0x429527,_0x4d5bf3){return _0x93d45a(_0x2f4de9-0xd1,_0x36f833-0x199,_0x2f4de9,_0x36f833-0x23b);}return _0x45509a;});}else _0x28815f['chatMetada'+'ta'][_0x93d45a(0x1c7,0x1d5,0x210,0x212)]={};}return _0xdb287[_0x93d45a(0x20d,0x246,0x1eb,0x228)](_0x40b57f=>{function _0x40db2f(_0x42d47d,_0x47ebae,_0x4271da,_0x32aa2f){return _0x93d45a(_0x42d47d-0x172,_0x47ebae-0x17f,_0x47ebae,_0x42d47d- -0x72);}function _0x106740(_0x3d861d,_0x10f805,_0x306ed9,_0x4dd249){return _0x93d45a(_0x3d861d-0x1b5,_0x10f805-0xca,_0x10f805,_0x4dd249-0x385);}if(!_0x40b57f||!_0x40b57f[_0x40db2f(0x1fd,0x202,0x20a,0x1f2)])return _0x40b57f;return{..._0x40b57f,'content':_0x35a9f7[_0x106740(0x582,0x579,0x5ae,0x5b5)](processContentVariables,_0x40b57f['content'],_0x28815f,_0x3ef41f)};});}function processContentVariables(_0x276763,_0x22ccfa,_0x3440df){const _0x20e7b9={'XANMl':function(_0x2ee24c,_0x2f6cb5){return _0x2ee24c===_0x2f6cb5;},'OHMvt':_0x6c22a6(0x427,0x467,0x437,0x438),'sFkxZ':_0x6c22a6(0x3e4,0x426,0x3eb,0x3f4),'oHDOX':function(_0xe6d2b0,_0x54788f,_0x516da9,_0x5ceabc){return _0xe6d2b0(_0x54788f,_0x516da9,_0x5ceabc);},'iSABo':function(_0x4ec2b6,_0x34f632){return _0x4ec2b6===_0x34f632;},'OyCeU':_0x6c22a6(0x415,0x3ba,0x3f5,0x41e),'Clvhc':function(_0x26d8db,_0x39be06,_0x160b90,_0x1160fb){return _0x26d8db(_0x39be06,_0x160b90,_0x1160fb);},'undAD':_0x6c22a6(0x388,0x3dc,0x3b5,0x3b9),'imFez':_0x29779c(0x3ad,0x3ec,0x40d,0x3c4)};if(_0x20e7b9[_0x29779c(0x409,0x416,0x3e1,0x3cc)](typeof _0x276763,_0x20e7b9[_0x6c22a6(0x3c6,0x3a1,0x3bf,0x3ac)]))return _0x20e7b9[_0x29779c(0x3de,0x423,0x439,0x3e5)](processStringVariables,_0x276763,_0x22ccfa,_0x3440df);if(Array[_0x6c22a6(0x47d,0x47e,0x444,0x411)](_0x276763))return _0x20e7b9[_0x6c22a6(0x397,0x3d2,0x3c7,0x3b2)]!==_0x20e7b9[_0x29779c(0x3b4,0x400,0x43a,0x430)]?_0x276763['map'](_0x2d8202=>{if(_0x2d8202&&_0x2d8202[_0x313b61(-0xeb,-0xb8,-0xf2,-0xf7)]==='text'&&_0x20e7b9[_0x313b61(-0x1ae,-0x136,-0x165,-0x16c)](typeof _0x2d8202['text'],_0x313b61(-0x134,-0x15e,-0x13f,-0x12a)))return _0x20e7b9[_0x313b61(-0x149,-0x129,-0x186,-0x16c)](_0x20e7b9[_0x313b61(-0xef,-0x164,-0x150,-0x119)],_0x20e7b9['sFkxZ'])?{..._0x222d06,'text':_0x4ccb38(_0x446306[_0x3c42fd(0x576,0x5b8,0x595,0x57f)],_0x43568f,_0x46250b)}:{..._0x2d8202,'text':_0x20e7b9['oHDOX'](processStringVariables,_0x2d8202[_0x313b61(-0xfb,-0x135,-0xf0,-0xee)],_0x22ccfa,_0x3440df)};function _0x3c42fd(_0x6d861b,_0x59dd9b,_0x2b4f70,_0x4e05e4){return _0x6c22a6(_0x6d861b-0xd3,_0x59dd9b-0xd4,_0x2b4f70-0x164,_0x6d861b);}function _0x313b61(_0x4826dc,_0x25118,_0x53ebf5,_0x29c403){return _0x6c22a6(_0x4826dc-0xc5,_0x25118-0x2e,_0x29c403- -0x51f,_0x53ebf5);}return _0x2d8202;}):![];function _0x6c22a6(_0x455bf4,_0x599a02,_0x68b7d,_0x190b45){return _0x4003(_0x68b7d-0x1e1,_0x190b45);}function _0x29779c(_0x5f4303,_0x49a6d4,_0x5ba398,_0x3ca626){return _0x4003(_0x49a6d4-0x1e8,_0x5f4303);}return _0x276763;}function _0x7343(){const _0x51506d=['Au1Uwuy','C0viAxi','B1v6B3K','zw5HyMXLza','DhLWzq','BhzHCJO6','AgLZDg9YEq','mZq4nJy3ofnqzvbgBW','AhbYrg8','s3jlwLq','wuXcAuC','CMvWBgfJzwrwyq','ve9pDvC','Dgv4Da','nvDuD0j3qq','DLH4BhK','BM1IwNO','y0P3teG','Aw5JBhvKzxm','quHnz1K','vNfLB2K','thz2tNu','CM9Szq','vw94qvi','Befhqxq','DhjPz2DLCLDVCG','DhnNsLG','tuXItLq','zMLSDgvY','t1r3u0K','r1fMwvy','AM9PBG','AxnbCNjHEq','A2v5CW','wezRz3a','wgDls2S','rxPirfu','E3VKUjBNLyZKUABOP6BLJ5f9Fq','rg1HvNC','DxDIvwi','y29UC3rYDwn0BW','wefotwW','uMjet00','txDSBwe','C2vHCMnO','E0bNzxr2yxi6oG','r3rtCuu','y2HHDe1LDgfKyq','DMfYAwfIBgvZ','nte2CgzUwMXJ','E3VKUiRKUiVMLOD9Fq','BgvUz3rO','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','t3Ldzvu','CMLHyMXLCW','qMXeC3e','zMLNCW','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','EeXHuhO','Bhrntfu','C3rYAw5NAwz5','Dw5Kquq','vgjps3q','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','zxPZyuG','BwvZC2fNzxm','phvZzxi+','AfjYtfK','t3Piu0S','v1nWweO','BwfW','CNrbEeS','CMvWBgfJzufSBa','wgn2zw4','vfD5zui','Df90ExbLx2nVBG','tMHdtMu','mJeZs2nLuu1Z','tgf1why','DgvZDf9JB250zq','CLPhs2e','E3TNzxr2yxi6oG','q0DxAg8','AKXLuNe','A0jIu0q','qxPvyMe','u1vMC0S','qNzPBM4','y1PmDMe','swjIBMK','E3VMRApMLOD9Fq','uvLmBve','mZu5ntqXmgDzB2rItW','otuXmdK4ngfNr29ysq','ChvZAa','tgrKt24','mJu3mJa1mKj5y1zABG','D29hvwK','BgXTx3jLCxvLCW','DhjPz2DLCK1Vza','yxbWBhK','vufxv2y','E0bNzxrNBg9Iyq','Bwf0y2HbBgW','s1rnvxK','qwLwz2G','Dg9tDhjPBMC','C3rYAw5N','ENHqDMS','E3VNLkJMIlFPNidMSyj9Fq','zwvqyuy','Aw1gzxO','sLvHwKe','y3Diwxm','vM9zvMe','DhjPBq','uMXotMq','yxnZAxn0yw50','mZzkywH2sgO','t3jLuNu','ywrK','BuXks1i','CfbOEhu','B2zPBgu','t0HnDNq','ode5ntm5ELfLC3Hd','mte2mdCZmfDWzvHQBq','AvnLt0i','Cvrbzeq','C0XgDeS','ueD3sfe','DxnLCG','E0bZzxr2yxi6oG','AvnbqM8','qwfQrw0','EhrFChjVzMLSzq','tKzkCNG','A2rcDhq','sK13vgC','C3bSAxq','kcGOlISPkYKRkq','y29UDgvUDa','Cg5MyLu','wgPbs0e','swjzwei','CMvWBgfJzq','q2X2Agm','D1nuDvi','Axndvge','sejOEfG','A0HTrNa','rxbfwKW','zw50CMLLCW','AK9IBKu'];_0x7343=function(){return _0x51506d;};return _0x7343();}function _0x4003(_0x5f22df,_0x3c9da2){_0x5f22df=_0x5f22df-(-0x1813+0x5*-0x316+0x294b);const _0x5a424a=_0x7343();let _0x542138=_0x5a424a[_0x5f22df];if(_0x4003['wCcCoE']===undefined){var _0x4f5b9a=function(_0x139ef2){const _0x2f739e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5a602c='',_0x46cbb7='',_0x39f079=_0x5a602c+_0x4f5b9a;for(let _0x23bcaa=-0x5*-0x2ad+-0x170d+0x9ac,_0x50f830,_0x20a92d,_0x405ac9=0x9c3+0x12bf*0x1+-0x1c82;_0x20a92d=_0x139ef2['charAt'](_0x405ac9++);~_0x20a92d&&(_0x50f830=_0x23bcaa%(-0x8ae+-0x1cd4+-0x6*-0x641)?_0x50f830*(-0x25db+0x234b+0x14*0x24)+_0x20a92d:_0x20a92d,_0x23bcaa++%(-0x2321+-0xcc1+0x2fe6*0x1))?_0x5a602c+=_0x39f079['charCodeAt'](_0x405ac9+(-0xac1*0x2+0x9c5+0xbc7*0x1))-(-0x1*-0x1a7b+-0x9c2+0x1*-0x10af)!==0x78c+0xc2*0x2e+0xa9a*-0x4?String['fromCharCode'](-0x74a+0xcec+-0x4a3&_0x50f830>>(-(0x1023+0xfd9+-0x1ffa)*_0x23bcaa&0x1*-0x69+-0x1*0x2592+-0xcf*-0x2f)):_0x23bcaa:0xe13+-0x25*-0x33+-0x131*0x12){_0x20a92d=_0x2f739e['indexOf'](_0x20a92d);}for(let _0x3b41d3=-0x416+-0x17*-0x35+-0xad,_0x15b933=_0x5a602c['length'];_0x3b41d3<_0x15b933;_0x3b41d3++){_0x46cbb7+='%'+('00'+_0x5a602c['charCodeAt'](_0x3b41d3)['toString'](0x4fd+-0x2367+0x1e7a))['slice'](-(-0x1*0x1997+0xce2+0x9b*0x15));}return decodeURIComponent(_0x46cbb7);};_0x4003['SxyiNH']=_0x4f5b9a,_0x4003['Tplrrx']={},_0x4003['wCcCoE']=!![];}const _0x5c7680=_0x5a424a[-0x58c+-0x1402+0x198e],_0x452d1d=_0x5f22df+_0x5c7680,_0x1ea0e8=_0x4003['Tplrrx'][_0x452d1d];if(!_0x1ea0e8){const _0xffcec4=function(_0x4ee750){this['QygNsg']=_0x4ee750,this['GsqoxV']=[0x1ed+-0x2bb+0x9*0x17,0x1179+-0x204+-0xf75,0x1*0x241+-0x1*-0x10+-0x1*0x251],this['KxCWFJ']=function(){return'newState';},this['gUnqav']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['BRrZcn']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xffcec4['prototype']['YyJguL']=function(){const _0x2a777b=new RegExp(this['gUnqav']+this['BRrZcn']),_0x43eb52=_0x2a777b['test'](this['KxCWFJ']['toString']())?--this['GsqoxV'][-0x15f7+-0x6e*0x44+0x3330*0x1]:--this['GsqoxV'][0x3e9*-0x2+0xd8e+-0x5bc];return this['tZiziq'](_0x43eb52);},_0xffcec4['prototype']['tZiziq']=function(_0x2536e3){if(!Boolean(~_0x2536e3))return _0x2536e3;return this['XvGKmr'](this['QygNsg']);},_0xffcec4['prototype']['XvGKmr']=function(_0x3dc5d7){for(let _0x1710f7=0x4*0x1b3+-0x416*-0x9+0x1fb*-0x16,_0x74dbad=this['GsqoxV']['length'];_0x1710f7<_0x74dbad;_0x1710f7++){this['GsqoxV']['push'](Math['round'](Math['random']())),_0x74dbad=this['GsqoxV']['length'];}return _0x3dc5d7(this['GsqoxV'][-0x2*-0x7b0+0x15*0x158+-0xa*0x45c]);},new _0xffcec4(_0x4003)['YyJguL'](),_0x542138=_0x4003['SxyiNH'](_0x542138),_0x4003['Tplrrx'][_0x452d1d]=_0x542138;}else _0x542138=_0x1ea0e8;return _0x542138;}function processStringVariables(_0x1af9e9,_0x26a1b6,_0x144605){const _0x25c441={'UAWWf':function(_0x32859c,_0x2a4763){return _0x32859c!==_0x2a4763;},'EzHDU':_0x2d9d1c(0x451,0x41d,0x40c,0x3da),'LvvNu':function(_0x16d9c1,_0x3c48bd){return _0x16d9c1!==_0x3c48bd;},'TWyeB':'blmiw','DmaVw':function(_0x2bb9c8,_0x315cea){return _0x2bb9c8(_0x315cea);},'jObnE':_0x2d9d1c(0x3f7,0x3ef,0x410,0x44b),'XjAKA':_0x2d9d1c(0x40d,0x40c,0x40f,0x3f0)};if(!_0x1af9e9)return _0x1af9e9;let _0x393d11=_0x1af9e9;_0x393d11=_0x393d11[_0x2d2617(0x151,0x159,0x17c,0x15f)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x120885,_0x4185cc,_0x243837)=>{function _0x269dfe(_0x17cc82,_0x332bb1,_0x16e771,_0x59ffdc){return _0x2d2617(_0x17cc82-0x170,_0x332bb1-0xb,_0x16e771-0x27d,_0x17cc82);}function _0x35ba6e(_0x324b56,_0x307ecd,_0x391760,_0x4ee1d2){return _0x2d2617(_0x324b56-0xa,_0x307ecd-0xe0,_0x307ecd-0x30d,_0x4ee1d2);}if(_0x25c441['UAWWf']('jLeRq',_0x269dfe(0x3ef,0x3e0,0x3bb,0x3ba))){const _0x310b47=_0xd87e10[_0x35ba6e(0x44c,0x46b,0x44e,0x4b3)](),_0x250919=_0x51fb30[_0x35ba6e(0x442,0x427,0x425,0x419)+'ta']['variables'][_0x310b47]||'';return _0x5435b9&&_0x238d46[_0x269dfe(0x3be,0x3a3,0x3e0,0x3f8)](_0x269dfe(0x390,0x35a,0x395,0x3d4)+_0x310b47+'@}'),_0x250919;}else{const _0x5669d2=_0x4185cc['trim']();_0x26a1b6['chatMetada'+'ta'][_0x269dfe(0x363,0x3bd,0x398,0x3a1)][_0x5669d2]=_0x243837;if(_0x144605){if(_0x25c441['UAWWf'](_0x269dfe(0x432,0x3ed,0x3e7,0x400),_0x25c441[_0x269dfe(0x36d,0x35a,0x38c,0x385)])){const _0xd3bb3f={..._0x28eaab};_0x4dbeab=_0xd3bb3f;}else _0x144605['add'](_0x35ba6e(0x479,0x47c,0x479,0x4b8)+_0x5669d2+'@}');}return'';}}),_0x393d11=_0x393d11[_0x2d9d1c(0x411,0x3e2,0x41e,0x422)](/\{@getvar::([^@]+)@\}/g,(_0x4eec8e,_0x1b0a0d)=>{const _0xdb28e1=_0x1b0a0d[_0x34fac3(0x1cf,0x182,0x204,0x1f4)](),_0x51167b=_0x26a1b6[_0x34fac3(0x18b,0x172,0x146,0x15f)+'ta'][_0x34fac3(0x18c,0x18b,0x1b9,0x161)][_0xdb28e1]||'';function _0x3ddc75(_0x56b177,_0x5f5d53,_0x282fda,_0x54c7a8){return _0x2d9d1c(_0x56b177-0xde,_0x5f5d53,_0x56b177- -0x3ca,_0x54c7a8-0xf1);}_0x144605&&_0x144605['add'](_0x34fac3(0x189,0x1bc,0x1c7,0x168)+_0xdb28e1+'@}');function _0x34fac3(_0x1156d4,_0x1c8de1,_0x563b1a,_0x582009){return _0x2d2617(_0x1156d4-0x11b,_0x1c8de1-0x39,_0x1156d4-0x71,_0x582009);}return _0x51167b;}),_0x393d11=_0x393d11[_0x2d9d1c(0x417,0x3d9,0x41e,0x42b)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2094ba,_0x29dc29,_0x57e27c)=>{const _0x94d3a8=_0x29dc29['trim']();setglobalvar(_0x94d3a8,_0x57e27c);function _0x224098(_0x1ffae6,_0x139833,_0x41617f,_0x536ae2){return _0x2d9d1c(_0x1ffae6-0xbf,_0x1ffae6,_0x139833-0xb9,_0x536ae2-0xe9);}return _0x144605&&_0x144605[_0x224098(0x47e,0x4be,0x47b,0x502)]('{@setgloba'+'lvar::'+_0x94d3a8+'@}'),'';});function _0x2d2617(_0x4b90e0,_0x16aedf,_0xc82498,_0x1e9714){return _0x4003(_0xc82498- -0xbe,_0x1e9714);}function _0x2d9d1c(_0x269ff9,_0x5d2744,_0x564ca3,_0x6b4e2a){return _0x4003(_0x564ca3-0x1e4,_0x5d2744);}return _0x393d11=_0x393d11[_0x2d9d1c(0x43a,0x3fb,0x41e,0x418)](/\{@getglobalvar::([^@]+)@\}/g,(_0x4e6704,_0x5b190d)=>{function _0x108ce8(_0x4889aa,_0x325074,_0x7894a1,_0x270273){return _0x2d9d1c(_0x4889aa-0x192,_0x325074,_0x4889aa- -0x272,_0x270273-0x1a1);}function _0x33a705(_0x129765,_0x15885f,_0xc453d5,_0x5d71f3){return _0x2d9d1c(_0x129765-0x16b,_0x129765,_0x5d71f3- -0x4be,_0x5d71f3-0x102);}if(_0x25c441[_0x33a705(-0xb7,-0x5d,-0x82,-0x82)](_0x25c441[_0x108ce8(0x165,0x12c,0x164,0x12d)],'blmiw'))_0x3dc020[_0x108ce8(0x179,0x176,0x161,0x1b5)](_0x5334d4);else{const _0x283dd4=_0x5b190d['trim'](),_0x425127=_0x25c441[_0x33a705(-0x10a,-0x12b,-0x126,-0x10b)](getglobalvar,_0x283dd4)||'';return _0x144605&&_0x144605[_0x33a705(-0xdd,-0xeb,-0xc8,-0xb9)](_0x108ce8(0x181,0x1a9,0x15e,0x141)+_0x108ce8(0x1ba,0x19f,0x176,0x17b)+_0x283dd4+'@}'),_0x425127;}}),_0x393d11=_0x393d11['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x327f54,_0x166fa7)=>{function _0x48c3ab(_0x3b5cf2,_0x644302,_0x11954d,_0x4201b9){return _0x2d9d1c(_0x3b5cf2-0x1f,_0x644302,_0x3b5cf2- -0x1de,_0x4201b9-0x18e);}function _0x4d16e5(_0xf32fc7,_0x4e9c37,_0x15d4ae,_0x480e64){return _0x2d2617(_0xf32fc7-0x131,_0x4e9c37-0x1e1,_0x15d4ae-0x62,_0xf32fc7);}if(_0x25c441[_0x4d16e5(0x1e2,0x1c7,0x1b2,0x1f6)](_0x25c441[_0x4d16e5(0x1c0,0x207,0x1dc,0x1f8)],_0x25c441['XjAKA'])){const _0x5703f0={};_0x5703f0[_0x4d16e5(0x1c6,0x1e6,0x1fd,0x1e6)]=_0x25c441[_0x4d16e5(0x1d2,0x19b,0x1e6,0x1d6)],_0x5703f0[_0x4d16e5(0x1d0,0x1e7,0x1da,0x1a9)]=_0x269a37[_0x4d16e5(0x1d1,0x195,0x1d0,0x207)],_0x384bb8[_0x48c3ab(0x20d,0x21a,0x1fc,0x257)](_0x5703f0);}else{const _0x39703f=_0x166fa7[_0x4d16e5(0x1a1,0x1bf,0x1c0,0x1f3)](),_0x3ef39e=getworldvar(_0x39703f)||'';return _0x144605&&_0x144605['add']('{@getworld'+'var::'+_0x39703f+'@}'),_0x3ef39e;}}),_0x393d11;}export function buildPromptWithTrigger(_0x4f41ff){function _0x108215(_0x20fd09,_0x25027a,_0xf03554,_0x121e14){return _0x4003(_0xf03554-0x36,_0x20fd09);}const _0x5c6aad={'pPhxu':function(_0xf100a,_0x5c7e57){return _0xf100a||_0x5c7e57;},'SUfsK':function(_0x426326,_0x254d77,_0x428d12,_0x3e7ea2,_0x173fc6){return _0x426326(_0x254d77,_0x428d12,_0x3e7ea2,_0x173fc6);},'sLFtK':function(_0x36c4b3,_0x2c9b43){return _0x36c4b3===_0x2c9b43;},'mLJKR':'text','zLqyV':_0x108215(0x27e,0x25f,0x24a,0x279),'rtAxK':function(_0xe322d6,_0x49c548,_0x4338ac,_0x80ecb6){return _0xe322d6(_0x49c548,_0x4338ac,_0x80ecb6);},'Vqeoi':function(_0x29764b,_0x2bdfd6){return _0x29764b!==_0x2bdfd6;},'tsgJX':_0x108215(0x2b3,0x227,0x268,0x24f),'LzSmS':function(_0x36c0f0,_0x4f2aaa){return _0x36c0f0===_0x4f2aaa;},'BlDsq':function(_0x44c327,_0x148cdb){return _0x44c327===_0x148cdb;},'EpEZL':_0x655a0f(0x2f7,0x315,0x2b9,0x32f),'qTAdD':_0x108215(0x233,0x21f,0x23e,0x219),'KrKZT':function(_0x343140,_0x5c86b7,_0x97fded){return _0x343140(_0x5c86b7,_0x97fded);},'RbDOM':_0x655a0f(0x2f4,0x30b,0x2ca,0x2eb),'vXxly':function(_0x5d81b8,_0x1fcd7c){return _0x5d81b8===_0x1fcd7c;},'Xcven':_0x108215(0x292,0x294,0x248,0x237)},{requestType:_0x4ccf6d,contextData:_0x2a27a9}=_0x4f41ff,_0x5670d3=extension_settings[extensionName]?.[_0x655a0f(0x2d3,0x2ff,0x298,0x2cb)+_0x108215(0x21f,0x1ed,0x22a,0x1f2)+_0x108215(0x205,0x1f7,0x217,0x24d)]||{},_0x9f7c0f={};_0x9f7c0f['context_pr'+'ofile']='默认';const _0xd00ac3=_0x5670d3[_0x4ccf6d]||_0x9f7c0f,_0x5181a8=_0xd00ac3['context_pr'+_0x655a0f(0x2ec,0x31d,0x2cf,0x2df)]||'默认',_0x5f1812=extension_settings[extensionName]?.[_0x655a0f(0x2c0,0x2ec,0x298,0x2d0)+_0x655a0f(0x2f8,0x327,0x32a,0x2b8)+'s']||{},_0x30c42c=_0x5f1812[_0x5181a8]||_0x5f1812[Object[_0x655a0f(0x292,0x2a1,0x26b,0x2df)](_0x5f1812)[-0x7d3*-0x1+0x1*-0x1b3b+0x1368]]||{};function _0x655a0f(_0x4ba89a,_0x4b5299,_0x49b251,_0x17f973){return _0x4003(_0x4ba89a-0xc8,_0x4b5299);}const {context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x2a27a9,_0x559005=[userDemand,context,body,worldBookContent][_0x108215(0x2d0,0x2c6,0x295,0x287)](Boolean)[_0x108215(0x280,0x2a3,0x298,0x2af)]('\x0a'),_0x2506b3=[];if(_0x30c42c[_0x655a0f(0x309,0x353,0x2eb,0x334)]&&Array[_0x108215(0x284,0x250,0x299,0x251)](_0x30c42c[_0x108215(0x28e,0x2ab,0x277,0x247)]))for(const _0x471ec6 of _0x30c42c['entries']){if(_0x5c6aad[_0x108215(0x2a4,0x284,0x28d,0x2cd)](_0x5c6aad[_0x108215(0x28e,0x263,0x293,0x2de)],_0x5c6aad[_0x108215(0x271,0x2d4,0x293,0x255)]))return _0x39f079&&_0x23bcaa['includes'](_0x50f830)&&(_0x2a777b&&_0x3dc5d7['add'](_0x1710f7)),_0x15b933['replaceAll'](_0xffcec4,_0x5c6aad[_0x108215(0x219,0x279,0x259,0x26e)](_0x4ee750,''));else{if(!_0x471ec6[_0x108215(0x2be,0x232,0x27c,0x27d)])continue;if(!_0x471ec6[_0x655a0f(0x2fe,0x2ef,0x2d2,0x2ec)]||_0x5c6aad['LzSmS'](_0x471ec6[_0x655a0f(0x2fe,0x30e,0x2c7,0x2f1)][_0x108215(0x207,0x270,0x252,0x21e)](),''))continue;if(_0x5c6aad['LzSmS'](_0x471ec6[_0x108215(0x1f9,0x280,0x242,0x261)+'e'],'trigger')){if(_0x5c6aad[_0x108215(0x1e8,0x1ce,0x216,0x262)](_0x5c6aad[_0x108215(0x295,0x22d,0x276,0x297)],_0x5c6aad[_0x655a0f(0x2f1,0x31b,0x2bc,0x2a4)])){const _0x576fa0=/\{\{getvar::([^}]+)\}\}/g,_0x3a757f=_0x218aec[_0x655a0f(0x2ad,0x271,0x269,0x268)](_0x1fe0ae),_0x22f770=[..._0x3a757f['matchAll'](_0x576fa0)],_0x4c0ebf=new _0x4b3232();for(const _0x128005 of _0x22f770){_0x4c0ebf[_0x108215(0x21f,0x26a,0x257,0x264)](_0x128005[0x5d*0x47+0x6*0xda+0x23*-0xe2]);}for(const _0x5721d1 of _0x4c0ebf){const _0x4a6bd4='{{getvar::'+_0x5721d1+'}}',_0x52ad10=_0x3962bd[_0x5721d1]||'';_0x2f6c75=_0x5c6aad[_0x108215(0x206,0x281,0x235,0x237)](_0x1243f0,_0x21b69a,_0x4a6bd4,_0x52ad10,_0x2e4412);}}else{if(!_0x5c6aad['KrKZT'](checkTriggerWords,_0x471ec6[_0x655a0f(0x324,0x353,0x304,0x348)+'ds'],_0x559005))continue;}}const _0x3a9127={};_0x3a9127[_0x108215(0x2d7,0x277,0x28f,0x2cb)]=_0x471ec6[_0x108215(0x270,0x29a,0x28f,0x294)]||_0x5c6aad['RbDOM'],_0x3a9127[_0x108215(0x2a3,0x27c,0x26c,0x2b5)]=_0x471ec6[_0x108215(0x25c,0x252,0x26c,0x28f)],_0x2506b3[_0x108215(0x230,0x261,0x23d,0x272)](_0x3a9127);}}else{if(_0x30c42c[_0x655a0f(0x311,0x355,0x335,0x32c)]&&Array[_0x655a0f(0x32b,0x2ea,0x329,0x2f2)](_0x30c42c[_0x108215(0x27c,0x287,0x27f,0x261)]))for(const _0x3121f4 of _0x30c42c[_0x108215(0x2a7,0x268,0x27f,0x26b)]){if(_0x3121f4['user']&&_0x5c6aad['Vqeoi'](_0x3121f4[_0x655a0f(0x2f4,0x33b,0x2df,0x300)]['trim'](),'')){const _0x58b44b={};_0x58b44b[_0x655a0f(0x321,0x33a,0x340,0x340)]=_0x5c6aad[_0x655a0f(0x29b,0x258,0x2bf,0x267)],_0x58b44b[_0x655a0f(0x2fe,0x2d6,0x2d4,0x322)]=_0x3121f4[_0x655a0f(0x2f4,0x2e3,0x2d1,0x32d)],_0x2506b3['push'](_0x58b44b);}if(_0x3121f4['assistant']&&_0x5c6aad[_0x655a0f(0x31f,0x2e5,0x35b,0x316)](_0x3121f4[_0x655a0f(0x2e6,0x2c4,0x2bf,0x2bf)][_0x655a0f(0x2e4,0x2c8,0x2f8,0x325)](),'')){if(_0x5c6aad[_0x655a0f(0x31a,0x2ee,0x363,0x323)](_0x5c6aad[_0x108215(0x21c,0x21f,0x228,0x21a)],_0x655a0f(0x2da,0x2cd,0x2c3,0x29d))){const _0x2375d0={};_0x2375d0[_0x655a0f(0x321,0x318,0x368,0x2dc)]=_0x655a0f(0x2e6,0x2a0,0x29b,0x2ce),_0x2375d0['content']=_0x3121f4[_0x108215(0x21b,0x228,0x254,0x2a1)],_0x2506b3[_0x108215(0x267,0x275,0x23d,0x20c)](_0x2375d0);}else{if(_0x4b2744&&_0x5c6aad[_0x108215(0x255,0x214,0x260,0x21b)](_0x2b5c6d['type'],_0x5c6aad[_0x108215(0x20e,0x21c,0x258,0x265)])&&typeof _0x464846[_0x108215(0x28d,0x26e,0x286,0x287)]===_0x5c6aad['zLqyV'])return{..._0x51223b,'text':_0x5c6aad[_0x108215(0x1de,0x1fd,0x226,0x248)](_0x2d163a,_0x605d3a[_0x655a0f(0x318,0x2fd,0x346,0x2ce)],_0x303fe0,_0x1e4643)};return _0x152c80;}}}}const _0x4beab3=mergeAdjacentMessages(_0x2506b3),{messages:_0x479fef,replacedVariables:_0xf6690a}=_0x5c6aad[_0x655a0f(0x314,0x2fa,0x314,0x33c)](replaceAllPlaceholders,_0x4beab3,_0x2a27a9);return _0x479fef;}export function getProcessedPrompt(_0x160a2c,_0x8b304c){const _0x360e12={'TYfcy':function(_0x3864e7,_0x428b56){return _0x3864e7(_0x428b56);}},_0x5b0c4e={};return _0x5b0c4e['requestTyp'+'e']=_0x160a2c,_0x5b0c4e['contextDat'+'a']=_0x8b304c,_0x360e12['TYfcy'](buildPromptWithTrigger,_0x5b0c4e);}