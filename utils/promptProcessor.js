(function(_0x5051e1,_0x28ec2d){const _0xeb2c45=_0x5051e1();function _0x50c0a1(_0x5a03b2,_0x4ac5cf,_0x587b8a,_0x50e259){return _0x5c11(_0x587b8a- -0x1c3,_0x50e259);}function _0x56cd7a(_0x18b55d,_0x261741,_0x111207,_0x5c716c){return _0x5c11(_0x261741-0x23c,_0x111207);}while(!![]){try{const _0x546c77=parseInt(_0x56cd7a(0x3d2,0x39f,0x358,0x383))/(0x20ca+-0x1405+-0xcc4*0x1)*(-parseInt(_0x50c0a1(-0xc1,-0xe4,-0xb9,-0xfe))/(0x118a+0x269c+-0x1*0x3824))+parseInt(_0x56cd7a(0x371,0x38a,0x388,0x385))/(-0x46*0x66+-0xcb6+0x289d)*(parseInt(_0x56cd7a(0x3c3,0x3ab,0x3f0,0x363))/(0x1471*0x1+0x1d*-0xd+-0x12f4))+-parseInt(_0x56cd7a(0x3bf,0x3aa,0x3e8,0x39d))/(0x227b+-0x1088+-0x1b*0xaa)*(-parseInt(_0x56cd7a(0x306,0x30f,0x332,0x309))/(-0x11*-0x3+0x6*0x4d+-0x27*0xd))+-parseInt(_0x56cd7a(0x2fb,0x328,0x317,0x300))/(0x1ae5+-0x14fb+-0xb*0x89)+-parseInt(_0x50c0a1(-0x23,-0x95,-0x73,-0x7f))/(-0x23a5+0x3d*-0x6d+0x3da6)+parseInt(_0x50c0a1(-0x1b,-0x7f,-0x62,-0x53))/(0x35*0x7f+-0x9*-0x3ad+-0x3b57)*(parseInt(_0x50c0a1(-0x59,-0x77,-0x80,-0xae))/(0xb3*0x17+0x187b+-0x2886))+parseInt(_0x56cd7a(0x3c0,0x37e,0x3ae,0x348))/(0x1*-0x1e41+-0x1*-0xc+0x1e40*0x1);if(_0x546c77===_0x28ec2d)break;else _0xeb2c45['push'](_0xeb2c45['shift']());}catch(_0x4e1b43){_0xeb2c45['push'](_0xeb2c45['shift']());}}}(_0x2e5d,-0x519b5+-0xc*0xbb19+0x1259fc));const _0x573417=(function(){let _0x2bc08e=!![];return function(_0x361d67,_0x4341e5){const _0x1ee51f=_0x2bc08e?function(){if(_0x4341e5){const _0x10b74e=_0x4341e5['apply'](_0x361d67,arguments);return _0x4341e5=null,_0x10b74e;}}:function(){};return _0x2bc08e=![],_0x1ee51f;};}()),_0x106d27=_0x573417(this,function(){function _0x311e79(_0x4a3390,_0x26c8fb,_0x29c107,_0x5f1b70){return _0x5c11(_0x26c8fb-0x12c,_0x5f1b70);}const _0x411e55={};_0x411e55[_0x311e79(0x2a7,0x274,0x2ba,0x263)]='(((.+)+)+)'+'+$';const _0x58a58d=_0x411e55;function _0x3a1130(_0x366816,_0x506998,_0x245f6f,_0x9e9d0){return _0x5c11(_0x245f6f- -0x288,_0x506998);}return _0x106d27[_0x311e79(0x1c9,0x212,0x216,0x25e)]()[_0x3a1130(-0x1d8,-0x1dc,-0x1a7,-0x1a0)](_0x58a58d[_0x311e79(0x2a9,0x274,0x228,0x27b)])[_0x3a1130(-0x16a,-0x183,-0x1a2,-0x1f2)]()['constructo'+'r'](_0x106d27)[_0x3a1130(-0x17f,-0x174,-0x1a7,-0x1ee)](_0x58a58d[_0x3a1130(-0xf3,-0x133,-0x140,-0x147)]);});function _0x2e5d(){const _0x3e4578=['CM9Szq','AgLZDg9YEq','yxbWBhK','v25Lzey','yK54CuK','thDwqui','q21dvwW','teT6twC','BgTUq3i','y29UDgvUDa','zfDLze8','BwLJzfu','DNHiC0C','CvP2vem','ywnyywy','B0rqD2i','ufHWCfy','vMr3t3i','C3rYAw5N','Dgv4Da','B3vis0W','C2ziAxe','rNPiEhq','vxLdwvG','DgTHy0e','AKPpAxy','mtyYmZGZmxnJENDesW','mtiWndmWtLPiv0jH','EePMDNy','uKLwzeS','E0bNzxr2yxi6oG','zMLNCW','D1fNAvO','u01lAxi','y29UDgv4Df9WCG','E3VNLkJMIlFPNidMSyj9Fq','E3TNzxr2yxi6oG','zKrIC3G','mZG3v3nqsfv6','t3bnrfG','mJCYmJK3nKXhEKzOCW','v3jdCvC','zKXKseG','Bwf0y2HbBgW','sfjltvO','AvPXyuW','DhjPBq','ywrK','qNzbwMi','CMvXDwvZDfr5Ca','vg1hvK4','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','DvzYBvO','ELDrtwO','B2zPBgu','rKf4rKC','DuHOCwK','mte3EffutuvX','AuXxwKK','mvbcq1fzDW','DMfYoJO','BwvZC2fNzxm','CMvWBgfJzq','CMrAz2y','yKzAEei','EuPWBMm','DgvZDf9JB250zq','u0vzzwu','zejrzhq','ChvZAa','ntvcDw9QBue','mtmWmtjRvu9owLu','y29UDgv4DerHDa','tKTPswG','mJGXmdy0CKjcrene','DNzkBKO','vu9VsMC','E0bZzxr2yxi6oG','B2XJseK','EhLVwMO','DhjPz2DLCLDVCG','DNzYv0e','BevgA1q','yxbfDMO','AvDSq1C','y2HHDe1LDgfKyq','tMncwMm','ENrcDMe','C2vHCMnO','B0jvqvG','EKPMqNq','AxnbCNjHEq','Aw5JBhvKzxm','Dg9tDhjPBMC','BM5cA1y','AwPjq2O','r1zWqvC','CMvWBgfJzufSBa','uLDtyva','mZuXotiZnKzuD215zq','sw5Xq2S','BMfTzte','sNLfsKS','DxnLCG','wxHcy1q','z3PJtKu','t3bWEvO','E3VMRApMLOD9Fq','BhzHCJO6','ueDTEui','zw50CMLLCW','ywDmrLO','DMfYAwfIBgvZ','DhjPz2DLCK1Vza','AM9PBG','CNjkuvy','Ag1lAKq','rfnLAfG','DKDrEfi','EvPkz1u','B2jQzwn0','B1vnugW','Df90ExbLx2nVBG','uMjQBe4','CMvWBgfJzwrwyq','sLDhyvu','ChPkzxK','zefKvMC','CwHps3u','mJa0nJq0Ag5utNHR','CfnRt00','DhLWzq','yxnZAxn0yw50','zMLSDgvY','wgnnzLG','zfLVwem','sKzwsKm','AK1Xv0O','E3VKUiRKUiVMLOD9Fq','AxnMDfi','ugD4rxu','u3jSD2W','r1npEey','v3PzDg8','ug1ssxm','Ag9nvw4','BgvUz3rO','Cw5JA3i','v1fpquO','A3rzDwe','yxrpBeK','E0bNzxr3B3jSza','C2rgreu','BwfW','uNPlDe8','ELbxtue','DhjPz2DLCG','ywvHue0','ChruvMm'];_0x2e5d=function(){return _0x3e4578;};return _0x2e5d();}_0x106d27();function _0x5c11(_0x597cba,_0x119c3d){_0x597cba=_0x597cba-(-0x79*0x14+-0x1*0x164d+0x2092*0x1);const _0x2e7cf4=_0x2e5d();let _0x4f9de7=_0x2e7cf4[_0x597cba];if(_0x5c11['fRVXSw']===undefined){var _0x2af4b7=function(_0x185252){const _0x1c9ea5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x103ae0='',_0x344239='',_0x376480=_0x103ae0+_0x2af4b7;for(let _0x17f8a4=-0x5d3+0x9*-0x2b2+-0xa07*-0x3,_0x12c690,_0x53bb18,_0x4c0420=0x11f5+0x30*-0x64+0xcb;_0x53bb18=_0x185252['charAt'](_0x4c0420++);~_0x53bb18&&(_0x12c690=_0x17f8a4%(-0x1d34+-0x9f5*0x1+0x272d)?_0x12c690*(-0x1*0x1c64+-0x4bd*-0x1+0x17e7)+_0x53bb18:_0x53bb18,_0x17f8a4++%(0x152a*0x1+-0xc4f*-0x1+-0x2175))?_0x103ae0+=_0x376480['charCodeAt'](_0x4c0420+(0x1c82+-0x1*-0x33f+-0x1fb7))-(-0x2*0x123e+-0x1c78+0x40fe)!==-0x25d6+-0x6a*0x55+0x1ec*0x26?String['fromCharCode'](0xfec+0x270e+-0x35fb&_0x12c690>>(-(-0x113c*-0x1+0xbfd*0x3+-0x11bb*0x3)*_0x17f8a4&-0x41*-0x32+-0x17ae+0xb02)):_0x17f8a4:0x28*0x2e+0x5*-0x37b+0xa37){_0x53bb18=_0x1c9ea5['indexOf'](_0x53bb18);}for(let _0x2e19b1=0x92*0x39+-0x1*-0x1a14+-0x3a96,_0x55978a=_0x103ae0['length'];_0x2e19b1<_0x55978a;_0x2e19b1++){_0x344239+='%'+('00'+_0x103ae0['charCodeAt'](_0x2e19b1)['toString'](0x1640+0x59+0x1689*-0x1))['slice'](-(-0x1c83*0x1+0x15*0x33+-0x1*-0x1856));}return decodeURIComponent(_0x344239);};_0x5c11['UPuwNa']=_0x2af4b7,_0x5c11['XJfGam']={},_0x5c11['fRVXSw']=!![];}const _0x133d8f=_0x2e7cf4[-0xb42+-0x1672+-0x1*-0x21b4],_0x17f4c8=_0x597cba+_0x133d8f,_0x47b60c=_0x5c11['XJfGam'][_0x17f4c8];if(!_0x47b60c){const _0x5d3d96=function(_0x5af163){this['mSiruO']=_0x5af163,this['ohIWqD']=[0xe7e+0xc0*0x10+-0x1a7d,0x1*-0x1cab+-0x16fc+-0x1*-0x33a7,-0x1672+0x17c3+0x151*-0x1],this['CoYMVH']=function(){return'newState';},this['gTJWTc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['HfbrnN']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5d3d96['prototype']['arXVuI']=function(){const _0x328eee=new RegExp(this['gTJWTc']+this['HfbrnN']),_0x666431=_0x328eee['test'](this['CoYMVH']['toString']())?--this['ohIWqD'][-0x1*0x1fed+-0x1*-0x3ac+-0x2*-0xe21]:--this['ohIWqD'][0x1327+0x23c2+-0x36e9];return this['kNKrBz'](_0x666431);},_0x5d3d96['prototype']['kNKrBz']=function(_0x14eb3f){if(!Boolean(~_0x14eb3f))return _0x14eb3f;return this['HYWFUj'](this['mSiruO']);},_0x5d3d96['prototype']['HYWFUj']=function(_0x210016){for(let _0x2f74a6=0x19f+0x14bf+-0x332*0x7,_0x563e0f=this['ohIWqD']['length'];_0x2f74a6<_0x563e0f;_0x2f74a6++){this['ohIWqD']['push'](Math['round'](Math['random']())),_0x563e0f=this['ohIWqD']['length'];}return _0x210016(this['ohIWqD'][0x2*0x7cd+0x1a5f*-0x1+0xac5]);},new _0x5d3d96(_0x5c11)['arXVuI'](),_0x4f9de7=_0x5c11['UPuwNa'](_0x4f9de7),_0x5c11['XJfGam'][_0x17f4c8]=_0x4f9de7;}else _0x4f9de7=_0x47b60c;return _0x4f9de7;}import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x27d776,_0x2317bc){function _0x5461c0(_0x5f04dc,_0x14bedf,_0xd4e851,_0x4d808a){return _0x5c11(_0x14bedf- -0x26a,_0x4d808a);}const _0xb05555={};_0xb05555[_0x5461c0(-0x173,-0x18d,-0x15e,-0x183)]=function(_0x56cd44,_0x4cd4a2){return _0x56cd44||_0x4cd4a2;},_0xb05555['ptTVc']=function(_0x25cdc4,_0x285ce6){return _0x25cdc4===_0x285ce6;},_0xb05555[_0x5461c0(-0x12f,-0x16e,-0x19c,-0x138)]=function(_0x4d9bf0,_0x4e5577){return _0x4d9bf0===_0x4e5577;},_0xb05555[_0x176a85(0x298,0x2c9,0x27c,0x2a9)]=_0x176a85(0x285,0x23e,0x27c,0x236);const _0x495a85=_0xb05555;if(_0x495a85[_0x5461c0(-0x17f,-0x18d,-0x148,-0x179)](!_0x27d776,!_0x2317bc))return![];const _0x5e935c=_0x27d776['split'](',')['map'](_0x29e3fe=>_0x29e3fe['trim']())[_0x176a85(0x216,0x29c,0x227,0x262)](_0x3e4996=>_0x3e4996);function _0x176a85(_0xa0aea2,_0x1519df,_0x292c74,_0x1251e7){return _0x5c11(_0x1251e7-0x154,_0x1519df);}if(_0x495a85[_0x5461c0(-0x16b,-0x143,-0x165,-0x150)](_0x5e935c[_0x176a85(0x28a,0x2a9,0x26f,0x26f)],0x2635*0x1+0x1*-0xbdd+-0x1a58))return![];for(const _0x549ad6 of _0x5e935c){if(_0x495a85['rrJQV'](_0x495a85[_0x176a85(0x2e2,0x2da,0x2e0,0x2a9)],_0x495a85[_0x176a85(0x296,0x274,0x2cf,0x2a9)])){if(_0x2317bc['includes'](_0x549ad6))return!![];}else _0x12fbe6[_0x4a6919]=_0x5bb51b(_0x378bbb[_0x190300],_0x2d41d8,_0x52dcba,_0x161079);}return![];}export function mergeAdjacentMessages(_0x564cf0){const _0x511d00={};function _0x3c2a8b(_0x1e2451,_0x45a22e,_0x3e43a1,_0x32b98){return _0x5c11(_0x3e43a1- -0x1b,_0x45a22e);}_0x511d00[_0x13be96(0x20d,0x1d4,0x1e0,0x20a)]=function(_0x14dea8,_0x4e19a7){return _0x14dea8===_0x4e19a7;},_0x511d00[_0x3c2a8b(0xf1,0xc3,0xd8,0x10b)]='GEXUx',_0x511d00['vvrWA']=_0x13be96(0x1d6,0x1f9,0x1fd,0x1e9),_0x511d00[_0x3c2a8b(0x120,0xa8,0xf4,0xdc)]=function(_0x457bc3,_0x4130d6){return _0x457bc3!==_0x4130d6;};function _0x13be96(_0x1c90f1,_0x9671f4,_0x1a2457,_0x15ccfc){return _0x5c11(_0x15ccfc-0xec,_0x1a2457);}_0x511d00[_0x13be96(0x282,0x213,0x234,0x239)]=_0x3c2a8b(0x15d,0x10b,0x151,0x12c);const _0x561946=_0x511d00;if(!_0x564cf0||_0x561946['ktYua'](_0x564cf0['length'],0x3*0xe5+0x1b7*-0x11+0x1a78))return[];const _0xff6f23=[];let _0x6bd411=null;for(const _0x4f52fc of _0x564cf0){if(!_0x6bd411){if(_0x561946['ktYua'](_0x561946['OppyZ'],_0x561946[_0x3c2a8b(0xf1,0xe5,0xd8,0xac)])){const _0x417c1a={..._0x4f52fc};_0x6bd411=_0x417c1a;}else{const _0xba25cb=_0x431f1d?function(){function _0x54236f(_0x2b03ce,_0x1c1dd3,_0x27fb03,_0x2b3061){return _0x13be96(_0x2b03ce-0xda,_0x1c1dd3-0x45,_0x2b3061,_0x2b03ce-0xae);}if(_0xd2236f){const _0x133da6=_0x528c90[_0x54236f(0x2c4,0x293,0x2de,0x2cc)](_0x2d9e36,arguments);return _0x5a2331=null,_0x133da6;}}:function(){};return _0x4aaa47=![],_0xba25cb;}}else{if(_0x561946[_0x13be96(0x221,0x1e7,0x23c,0x20a)](_0x6bd411[_0x13be96(0x202,0x1e1,0x24e,0x214)],_0x4f52fc[_0x3c2a8b(0x129,0x106,0x10d,0xd3)]))_0x3c2a8b(0x9e,0xce,0xe2,0x95)!==_0x561946[_0x3c2a8b(0xb9,0xda,0xbf,0x9a)]?_0xcb3532[_0x3c2a8b(0x191,0x17b,0x152,0x17c)](_0x13a283):_0x6bd411[_0x13be96(0x20e,0x24b,0x23f,0x21d)]=mergeContent(_0x6bd411[_0x13be96(0x25e,0x262,0x241,0x21d)],_0x4f52fc[_0x13be96(0x262,0x22f,0x1eb,0x21d)]);else{_0xff6f23['push'](_0x6bd411);const _0x19d2ce={..._0x4f52fc};_0x6bd411=_0x19d2ce;}}}return _0x6bd411&&(_0x561946[_0x13be96(0x249,0x1cd,0x1fb,0x1fb)](_0x561946['fDbsx'],_0x3c2a8b(0xe4,0xe3,0x115,0xdf))?_0xff6f23['push'](_0x6bd411):_0x14b1fb[_0x3c2a8b(0x14c,0x17d,0x13c,0x181)](_0x3c2a8b(0xfb,0x145,0x12b,0x145)+_0x46d97b+'@}')),_0xff6f23;}function mergeContent(_0x15f58a,_0x2bd3d6){const _0x2217da={'ijICj':_0x41eed8(0x406,0x414,0x3f7,0x3eb),'dYoXC':function(_0x222a55,_0x11b0da){return _0x222a55+_0x11b0da;},'BvAZb':function(_0x3e2d81,_0x1340c1){return _0x3e2d81(_0x1340c1);},'PXppV':function(_0x3f8548,_0x43147f){return _0x3f8548(_0x43147f);},'xJfvv':_0x135760(-0x1ae,-0x198,-0x1ce,-0x1b8)};if(typeof _0x15f58a===_0x135760(-0x1af,-0x1f3,-0x1c7,-0x1e8)&&typeof _0x2bd3d6===_0x2217da[_0x135760(-0x201,-0x1c5,-0x1b7,-0x1b2)])return _0x2217da[_0x41eed8(0x3d9,0x3e2,0x3ce,0x3c1)](_0x15f58a+'\x0a',_0x2bd3d6);function _0x41eed8(_0x2b6ff6,_0x3ff55e,_0x44290c,_0x4b2911){return _0x5c11(_0x4b2911-0x2b1,_0x2b6ff6);}const _0x30dd67=_0x2217da[_0x135760(-0x191,-0x1c6,-0x191,-0x161)](normalizeToArray,_0x15f58a),_0x5cdf3c=_0x2217da[_0x135760(-0x1b1,-0x177,-0x1cc,-0x1ef)](normalizeToArray,_0x2bd3d6),_0x45a440={};function _0x135760(_0x1ba287,_0x3851db,_0x4fc04a,_0x4dfd4f){return _0x5c11(_0x1ba287- -0x2e9,_0x3851db);}return _0x45a440['type']=_0x2217da[_0x41eed8(0x42e,0x3cc,0x3fc,0x3f5)],_0x45a440[_0x41eed8(0x3b3,0x3c6,0x3d0,0x3ec)]='\x0a',[..._0x30dd67,_0x45a440,..._0x5cdf3c];}function normalizeToArray(_0x410faa){const _0xb2d2ea={'uVrmZ':function(_0x10fa87,_0x452ef6){return _0x10fa87===_0x452ef6;},'wWMvx':function(_0x2d754d,_0x5c66b9,_0x212f4a){return _0x2d754d(_0x5c66b9,_0x212f4a);},'RbjlN':_0x1e3785(0x21e,0x24a,0x21d,0x20e),'tcCxs':_0x44a292(-0x14d,-0x147,-0x12d,-0x13d)};function _0x44a292(_0x5d6ca4,_0x1b6d41,_0x1b0f99,_0x28256f){return _0x5c11(_0x1b6d41- -0x282,_0x1b0f99);}if(Array[_0x44a292(-0x19c,-0x19e,-0x1c3,-0x1c9)](_0x410faa)){if(_0xb2d2ea[_0x1e3785(0x24a,0x247,0x22a,0x214)](_0xb2d2ea[_0x44a292(-0x1bb,-0x17e,-0x1b8,-0x156)],_0xb2d2ea[_0x1e3785(0x222,0x1ef,0x20d,0x1a7)]))return _0x410faa;else{if(!_0x12c997){const _0x19a415={..._0x31dd70};_0x4f84f6=_0x19a415;}else{if(_0xb2d2ea[_0x44a292(-0x159,-0x126,-0xe8,-0x171)](_0x1b33b3[_0x44a292(-0x11c,-0x15a,-0x12f,-0x10d)],_0x1e83de[_0x44a292(-0x148,-0x15a,-0x18b,-0x173)]))_0x4c1910[_0x44a292(-0x18c,-0x151,-0x160,-0x12c)]=_0xb2d2ea['wWMvx'](_0x58d4f5,_0x2d5bd3[_0x44a292(-0x10d,-0x151,-0x14c,-0x14b)],_0x2594b4[_0x1e3785(0x250,0x21c,0x211,0x201)]);else{_0x4ad84a['push'](_0x301d04);const _0x11cd15={..._0xdf70b9};_0x10f5ea=_0x11cd15;}}}}const _0x34147b={};function _0x1e3785(_0x57cf70,_0x345bbf,_0x254e31,_0x5ad880){return _0x5c11(_0x345bbf-0xeb,_0x254e31);}return _0x34147b['type']=_0xb2d2ea['tcCxs'],_0x34147b[_0x44a292(-0x173,-0x147,-0x101,-0x171)]=_0x410faa||'',[_0x34147b];}export function replacePlaceholder(_0x27e58e,_0x24d5e8,_0x52536a,_0x2756c9){const _0x520b1d={'bNxqI':function(_0x29f77d,_0x1c3bbd,_0x5dabc5,_0x91a704){return _0x29f77d(_0x1c3bbd,_0x5dabc5,_0x91a704);},'atOlI':function(_0xa2fbd6,_0x316813){return _0xa2fbd6+_0x316813;},'YxBcT':function(_0x5364ef,_0x364ba2){return _0x5364ef===_0x364ba2;},'OpMDX':'WQOAJ','nnBkV':_0xd9984(0x111,0xb0,0xff,0xe8),'agLFZ':function(_0x14f350,_0x2c12e7){return _0x14f350===_0x2c12e7;},'hwnSU':_0xd9984(0xec,0xae,0xc4,0x87),'vvJnJ':function(_0x113e37,_0x1da1f4,_0x29858a,_0x5cdd41,_0x37ae22){return _0x113e37(_0x1da1f4,_0x29858a,_0x5cdd41,_0x37ae22);}};if(_0x520b1d[_0x3ea3f0(-0x25e,-0x24b,-0x2a1,-0x22f)](typeof _0x27e58e,_0x3ea3f0(-0x215,-0x25f,-0x1f2,-0x257))){if(_0x52536a&&_0x27e58e[_0xd9984(0xc7,0x88,0xa3,0x9f)](_0x24d5e8)){if(_0x3ea3f0(-0x232,-0x216,-0x222,-0x1e4)===_0x520b1d[_0xd9984(0x13c,0x109,0x10d,0x134)]){if(_0x2756c9){if(_0x520b1d[_0x3ea3f0(-0x25e,-0x27b,-0x271,-0x265)](_0x520b1d[_0xd9984(0x7a,0x87,0xa5,0xa0)],_0x520b1d[_0x3ea3f0(-0x268,-0x21c,-0x244,-0x251)]))_0x2756c9[_0x3ea3f0(-0x1f8,-0x214,-0x1fd,-0x22b)](_0x24d5e8);else{_0x416052[_0xd9984(0x162,0x106,0x12b,0x174)](_0x3e55d1);const _0x206336={..._0x3c23a6};_0x4ba332=_0x206336;}}}else{if(!_0x4f6376||!_0x487336[_0xd9984(0x111,0xeb,0xef,0x10d)])return _0x2e378a;return{..._0x236b36,'content':_0x520b1d[_0x3ea3f0(-0x223,-0x236,-0x21b,-0x1ea)](_0x1547f8,_0x10b734['content'],_0x399360,_0x422a60)};}}return _0x27e58e[_0x3ea3f0(-0x265,-0x23e,-0x21a,-0x2b5)](_0x24d5e8,_0x52536a||'');}if(Array[_0x3ea3f0(-0x26b,-0x274,-0x270,-0x25c)](_0x27e58e))return _0x27e58e[_0xd9984(0x11a,0x128,0xe0,0xe4)](_0x2221ae=>replacePlaceholder(_0x2221ae,_0x24d5e8,_0x52536a,_0x2756c9));if(_0x27e58e&&_0x520b1d['agLFZ'](typeof _0x27e58e,_0xd9984(0xb6,0xbc,0xbf,0xf8))){const _0x3b6332={};for(const _0x1ccafe in _0x27e58e){if(_0x520b1d[_0x3ea3f0(-0x257,-0x20a,-0x226,-0x22b)](_0x520b1d['hwnSU'],'JWGaU'))_0x3b6332[_0x1ccafe]=_0x520b1d[_0x3ea3f0(-0x27b,-0x244,-0x2ad,-0x26a)](replacePlaceholder,_0x27e58e[_0x1ccafe],_0x24d5e8,_0x52536a,_0x2756c9);else return _0x520b1d[_0x3ea3f0(-0x230,-0x25b,-0x223,-0x244)](_0x2ebb9a+'\x0a',_0x18f1b4);}return _0x3b6332;}function _0x3ea3f0(_0x48216e,_0x240248,_0x77b7e8,_0x287113){return _0x5c11(_0x48216e- -0x34f,_0x287113);}function _0xd9984(_0x4fd7b9,_0x303f10,_0x2f3577,_0x107449){return _0x5c11(_0x2f3577- -0x42,_0x107449);}return _0x27e58e;}export function replaceAllPlaceholders(_0x2bad1f,_0x27f69f){const _0x5556cd={'sfHiq':function(_0x3feab8,_0x42e763){return _0x3feab8===_0x42e763;},'jMqWJ':_0x1291a0(-0x20a,-0x1ee,-0x1ca,-0x1de),'ueczf':function(_0x1f1123){return _0x1f1123();},'HRKMZ':function(_0x45d5bc,_0x4fa080){return _0x45d5bc!==_0x4fa080;},'oUMPl':_0x1291a0(-0x20b,-0x1fc,-0x225,-0x230),'xyoZj':'{{user}}','zPWMA':function(_0x95c650,_0x5f11fd,_0x399f79,_0x4db891,_0x566e26){return _0x95c650(_0x5f11fd,_0x399f79,_0x4db891,_0x566e26);},'VdwOr':_0x1291a0(-0x1c6,-0x216,-0x219,-0x244),'SHDTw':'{{世界书触发}}','PmRIs':_0x232a5e(0xe4,0x12f,0x11a,0x13d),'SEYee':_0x1291a0(-0x20e,-0x1ce,-0x180,-0x191)+'}}','iLWZI':_0x232a5e(0x165,0x186,0x184,0x17b),'DSehX':function(_0x47914b,_0x268743){return _0x47914b>_0x268743;},'pSkOM':_0x232a5e(0x102,0x131,0x105,0xe4),'HMDIh':function(_0x4a864f,_0x23ba60,_0x2d3c24,_0x29086d,_0x319db6){return _0x4a864f(_0x23ba60,_0x2d3c24,_0x29086d,_0x319db6);},'rwdbP':function(_0x2f04ca,_0x1ae917,_0x215c44){return _0x2f04ca(_0x1ae917,_0x215c44);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x27f69f,_0x9bceea=new Set();function _0x232a5e(_0x436d5f,_0x24bca1,_0x5d15a4,_0xa424e8){return _0x5c11(_0x24bca1-0x3b,_0x436d5f);}let _0x3d1591=_0x2bad1f;const _0x77243e=_0x5556cd['ueczf'](getContext),_0x27036a=_0x77243e?.[_0x232a5e(0x13b,0x129,0x14d,0x168)]||'';let _0x19092f=worldBookContent;if(_0x19092f){if(_0x5556cd[_0x1291a0(-0x1f6,-0x1d5,-0x189,-0x191)](_0x232a5e(0x159,0x177,0x1bf,0x149),_0x5556cd[_0x232a5e(0x162,0x13d,0x11b,0x140)]))_0x19092f=_0x19092f['replaceAll'](_0x5556cd[_0x232a5e(0x153,0x113,0x105,0x109)],_0x27036a),_0x19092f=_0x19092f[_0x232a5e(0x134,0x125,0xfb,0x134)]('<user>',_0x27036a);else{const _0x59ad75={'gzcNE':function(_0x2079ed,_0x358021){function _0x59142b(_0x4f1f5d,_0x518ae7,_0xf3e208,_0x101fe5){return _0x1291a0(_0x4f1f5d-0x6,_0x518ae7-0x70f,_0x101fe5,_0x101fe5-0x67);}return _0x5556cd[_0x59142b(0x52d,0x523,0x53e,0x520)](_0x2079ed,_0x358021);},'tkacA':_0x5556cd[_0x1291a0(-0x262,-0x217,-0x1d8,-0x254)],'NcBZc':_0x232a5e(0x12d,0x175,0x135,0x183),'MyYvq':function(_0x5533e7,_0x5a8693,_0x2886f9,_0x294e2a){return _0x5533e7(_0x5a8693,_0x2886f9,_0x294e2a);}};return _0x3c1c4[_0x232a5e(0x118,0x15d,0x136,0x198)](_0x397fb5=>{if(_0x397fb5&&_0x59ad75[_0x26501e(0x2a6,0x263,0x21f,0x288)](_0x397fb5['type'],_0x59ad75[_0x1c4d6a(0x4c2,0x4df,0x4cf,0x494)])&&typeof _0x397fb5[_0x26501e(0x27e,0x2ac,0x26c,0x2a0)]===_0x59ad75[_0x26501e(0x225,0x250,0x208,0x270)])return{..._0x397fb5,'text':_0x59ad75['MyYvq'](_0x32fbdf,_0x397fb5[_0x26501e(0x288,0x2ac,0x2ba,0x290)],_0x5d7c58,_0x27e82c)};function _0x26501e(_0x1d1a75,_0xf2e9ff,_0x2a5d9a,_0x2828a3){return _0x232a5e(_0x1d1a75,_0xf2e9ff-0x136,_0x2a5d9a-0xff,_0x2828a3-0x4f);}function _0x1c4d6a(_0x218837,_0x5d537e,_0x1a57d3,_0x53e7c2){return _0x232a5e(_0x53e7c2,_0x5d537e-0x364,_0x1a57d3-0x126,_0x53e7c2-0x5c);}return _0x397fb5;});}}_0x3d1591=_0x5556cd[_0x232a5e(0x137,0x15f,0x14c,0x158)](replacePlaceholder,_0x3d1591,_0x5556cd[_0x1291a0(-0x1be,-0x1f0,-0x1c0,-0x1a4)],context,_0x9bceea),_0x3d1591=_0x5556cd[_0x232a5e(0x119,0x15f,0x180,0x115)](replacePlaceholder,_0x3d1591,_0x5556cd['SHDTw'],_0x19092f,_0x9bceea),_0x3d1591=_0x5556cd[_0x1291a0(-0x215,-0x205,-0x1be,-0x251)](replacePlaceholder,_0x3d1591,_0x5556cd[_0x1291a0(-0x1c4,-0x210,-0x234,-0x1f1)],body,_0x9bceea),_0x3d1591=_0x5556cd[_0x232a5e(0x140,0x15f,0x156,0x150)](replacePlaceholder,_0x3d1591,'{{角色启用列表}}',characterListText,_0x9bceea),_0x3d1591=replacePlaceholder(_0x3d1591,_0x5556cd[_0x1291a0(-0x1f9,-0x1be,-0x172,-0x1da)],outfitEnableListText,_0x9bceea),_0x3d1591=_0x5556cd[_0x232a5e(0x169,0x15f,0x199,0x137)](replacePlaceholder,_0x3d1591,'{{通用角色启用列表'+'}}',commonCharacterListText,_0x9bceea),_0x3d1591=_0x5556cd[_0x232a5e(0x184,0x15f,0x194,0x15b)](replacePlaceholder,_0x3d1591,_0x5556cd[_0x1291a0(-0x1cc,-0x1c7,-0x1ef,-0x1f2)],userDemand,_0x9bceea);if(variables&&_0x5556cd[_0x232a5e(0x106,0x139,0x17e,0x15f)](Object['keys'](variables)[_0x232a5e(0x143,0x156,0x15f,0x116)],-0x185f+-0x25db*0x1+0x3e3a)){if(_0x5556cd[_0x1291a0(-0x244,-0x21e,-0x20c,-0x1e2)]==='koffv')return![];else{const _0x2b494f=/\{\{getvar::([^}]+)\}\}/g,_0x20c733=JSON['stringify'](_0x3d1591),_0x37efa7=[..._0x20c733[_0x1291a0(-0x1a8,-0x1d6,-0x1c0,-0x1e9)](_0x2b494f)],_0x2e9b74=new Set();for(const _0x9f8aa4 of _0x37efa7){_0x2e9b74['add'](_0x9f8aa4[0xef2*-0x1+-0x1ad9*0x1+0x4*0xa73]);}for(const _0x10b03c of _0x2e9b74){const _0x4f4031=_0x232a5e(0x185,0x187,0x1cc,0x165)+_0x10b03c+'}}',_0x445d05=variables[_0x10b03c]||'';_0x3d1591=_0x5556cd['HMDIh'](replacePlaceholder,_0x3d1591,_0x4f4031,_0x445d05,_0x9bceea);}}}_0x3d1591=_0x5556cd['rwdbP'](processVariablePlaceholdersInMessages,_0x3d1591,_0x9bceea);const _0x1e5d9b={};_0x1e5d9b[_0x232a5e(0x1cf,0x1a0,0x167,0x154)]=_0x3d1591;function _0x1291a0(_0x1f50ef,_0x1c1e5a,_0x2f1d8f,_0x5f1c95){return _0x5c11(_0x1c1e5a- -0x329,_0x2f1d8f);}return _0x1e5d9b[_0x232a5e(0x113,0x140,0x115,0x12e)+'riables']=_0x9bceea,_0x1e5d9b;}function processVariablePlaceholdersInMessages(_0x44abfc,_0x55fa51){const _0x1d653b={'hoMUn':function(_0xdce5a4,_0x3fd354){return _0xdce5a4===_0x3fd354;},'UOoJg':_0x2bb20f(0x2e0,0x2ce,0x2dc,0x2e8),'WrCqW':_0x2bb20f(0x2bb,0x2fd,0x2f9,0x2be),'RIVdK':function(_0x28cd62,_0xc49f66,_0x19011f,_0x55db40){return _0x28cd62(_0xc49f66,_0x19011f,_0x55db40);},'gwodQ':function(_0x1e6479){return _0x1e6479();},'qZvTC':_0x465436(-0x200,-0x1ad,-0x1fd,-0x238)};if(!_0x44abfc||_0x44abfc[_0x2bb20f(0x2db,0x2ea,0x2eb,0x2f7)]===-0x23c1+0x6d5+-0x9a4*-0x3)return _0x44abfc;const _0x315365=_0x1d653b['gwodQ'](getContext);if(!_0x315365[_0x2bb20f(0x262,0x2ad,0x27c,0x26b)+'ta']){if(_0x1d653b[_0x465436(-0x1f7,-0x247,-0x209,-0x211)](_0x1d653b[_0x2bb20f(0x32b,0x304,0x338,0x326)],_0x1d653b[_0x2bb20f(0x2b6,0x304,0x30a,0x332)]))_0x315365[_0x465436(-0x238,-0x258,-0x245,-0x27d)+'ta']={};else{if(_0x51863e[_0x465436(-0x265,-0x1f0,-0x23e,-0x202)](_0x431f9e))return!![];}}function _0x465436(_0x37f79f,_0x166b4a,_0x2d69ff,_0xf99bd4){return _0x5c11(_0x2d69ff- -0x323,_0x166b4a);}!_0x315365[_0x465436(-0x27d,-0x27c,-0x245,-0x202)+'ta'][_0x2bb20f(0x2bb,0x2c8,0x293,0x29c)]&&(_0x315365[_0x2bb20f(0x2f0,0x2ad,0x2a9,0x2c9)+'ta'][_0x2bb20f(0x29b,0x2c8,0x2cf,0x2ad)]={});function _0x2bb20f(_0x1e7549,_0x9917d4,_0x579602,_0x4cf117){return _0x5c11(_0x9917d4-0x1cf,_0x1e7549);}return _0x44abfc['map'](_0x191ef6=>{function _0x1898e0(_0x5c2d99,_0x94555a,_0x290fe4,_0x369ff5){return _0x465436(_0x5c2d99-0xd7,_0x369ff5,_0x290fe4-0xb9,_0x369ff5-0x158);}function _0x4f4870(_0x32e0cf,_0x17ed90,_0x18461e,_0xa912ca){return _0x2bb20f(_0x17ed90,_0x32e0cf- -0x2b2,_0x18461e-0x124,_0xa912ca-0x132);}if(_0x1d653b['hoMUn'](_0x1d653b[_0x1898e0(-0x190,-0x1ab,-0x195,-0x164)],_0x1d653b[_0x1898e0(-0xd2,-0xcc,-0x119,-0x160)]))_0x309da5[_0x1898e0(-0x153,-0x112,-0x113,-0xcf)]('{@getworld'+'var::'+_0x355962+'@}');else{if(!_0x191ef6||!_0x191ef6[_0x4f4870(0x4e,0x21,0x4a,0xc)])return _0x191ef6;return{..._0x191ef6,'content':_0x1d653b[_0x1898e0(-0x151,-0x13d,-0x125,-0x131)](processContentVariables,_0x191ef6[_0x1898e0(-0x168,-0x155,-0x139,-0x155)],_0x315365,_0x55fa51)};}});}function processContentVariables(_0x367949,_0x3a3b67,_0x5caaf5){const _0x9fc0cf={'fEfxk':function(_0x64ab38,_0x587881){return _0x64ab38||_0x587881;},'WzYto':function(_0x2abc7b,_0x38f2a0){return _0x2abc7b!==_0x38f2a0;},'InqCk':_0x849214(0x52c,0x4f7,0x50d,0x4e2),'WnedF':'string','GSOxF':function(_0x1936f6,_0x305ab0){return _0x1936f6===_0x305ab0;},'GVpAW':_0x849214(0x4d5,0x52b,0x4a5,0x4e3),'dAdVg':function(_0x333de6,_0x104f42,_0x264670,_0x5080b0){return _0x333de6(_0x104f42,_0x264670,_0x5080b0);},'micdU':function(_0x5cb72e,_0x3250e6){return _0x5cb72e===_0x3250e6;},'UyCYX':function(_0x2f9d35,_0x170d81){return _0x2f9d35===_0x170d81;},'qnckr':_0x849214(0x539,0x4b6,0x512,0x4ee),'RWSaP':_0x849214(0x4d4,0x483,0x4b6,0x4a9)};if(_0x9fc0cf[_0x849214(0x507,0x4d2,0x541,0x500)](typeof _0x367949,'string')){if(_0x9fc0cf[_0x1d751a(0x2c9,0x290,0x27a,0x25b)](_0x9fc0cf[_0x1d751a(0x283,0x212,0x257,0x20a)],_0x9fc0cf[_0x849214(0x4ff,0x4b7,0x4d5,0x4e9)]))return _0x9fc0cf[_0x1d751a(0x280,0x26b,0x243,0x259)](processStringVariables,_0x367949,_0x3a3b67,_0x5caaf5);else _0x392154[_0x849214(0x4aa,0x47d,0x4d0,0x4ab)+'ta']['variables']={};}if(Array['isArray'](_0x367949)){if(_0x9fc0cf[_0x849214(0x511,0x4fb,0x4ca,0x500)](_0x9fc0cf[_0x849214(0x4df,0x497,0x4f7,0x4b8)],_0x9fc0cf[_0x849214(0x485,0x4e6,0x473,0x4b8)]))return _0x367949[_0x1d751a(0x26a,0x27c,0x25d,0x250)](_0x156f1c=>{function _0x26cf40(_0x39d0bc,_0x7517e,_0x38384a,_0x55dac9){return _0x849214(_0x39d0bc-0x29,_0x7517e-0xd9,_0x39d0bc,_0x55dac9- -0x3e4);}function _0x130d9a(_0x42992f,_0x28968,_0x410532,_0x20c024){return _0x1d751a(_0x42992f-0x1c9,_0x42992f,_0x20c024-0x51,_0x20c024-0xce);}if(_0x9fc0cf[_0x130d9a(0x2d7,0x254,0x28a,0x2a4)](_0x9fc0cf[_0x26cf40(0xe6,0x96,0xa9,0xd6)],_0x9fc0cf[_0x26cf40(0x114,0xed,0x9c,0xd6)]))_0x210016&&_0x47a583['add'](_0x48fa4a);else{if(_0x156f1c&&_0x156f1c['type']==='text'&&typeof _0x156f1c[_0x130d9a(0x305,0x30e,0x2e9,0x2c7)]===_0x9fc0cf[_0x130d9a(0x2a5,0x2b0,0x2c9,0x2b7)])return _0x9fc0cf[_0x130d9a(0x283,0x2c3,0x26c,0x2a3)](_0x130d9a(0x2ec,0x29e,0x2b8,0x2a2),_0x9fc0cf[_0x26cf40(0xf4,0x8e,0xe8,0xd2)])?{..._0x156f1c,'text':_0x9fc0cf[_0x130d9a(0x2c8,0x24d,0x287,0x294)](processStringVariables,_0x156f1c['text'],_0x3a3b67,_0x5caaf5)}:(_0x47b60c&&_0x185252['includes'](_0x1c9ea5)&&(_0x4c0420&&_0x5d3d96[_0x26cf40(0x162,0x133,0x16e,0x140)](_0x5af163)),_0x17f8a4[_0x26cf40(0xcf,0x8a,0x8b,0xd3)](_0x12c690,_0x9fc0cf['fEfxk'](_0x53bb18,'')));return _0x156f1c;}});else _0x53537b['chatMetada'+'ta']={};}function _0x1d751a(_0x370e23,_0x977e08,_0x3b8af9,_0x49a2dc){return _0x5c11(_0x3b8af9-0x13b,_0x977e08);}function _0x849214(_0x823f4f,_0x2dbc71,_0xa423fc,_0x4dd33e){return _0x5c11(_0x4dd33e-0x3cd,_0xa423fc);}return _0x367949;}function processStringVariables(_0x5625d1,_0x590eaf,_0x524925){function _0x12f58c(_0x2ccda7,_0x40720c,_0x54bfb3,_0x5c28b0){return _0x5c11(_0x40720c-0x333,_0x2ccda7);}const _0x485378={'KabFp':function(_0x3aca2c,_0x4c6af9){return _0x3aca2c!==_0x4c6af9;},'rdZgf':_0x11963f(-0x239,-0x26a,-0x265,-0x275),'acXaf':function(_0x4af333,_0x39c051){return _0x4af333===_0x39c051;},'isftR':_0x12f58c(0x459,0x46e,0x452,0x450),'yZJgU':function(_0x344898,_0x1f5f90){return _0x344898===_0x1f5f90;},'vxHsG':_0x12f58c(0x478,0x46d,0x497,0x426),'oDPwb':function(_0x2f38ba,_0x101f34,_0x59911b,_0xded631){return _0x2f38ba(_0x101f34,_0x59911b,_0xded631);},'ztBva':'PSfut','oMQaY':function(_0xec6ab7,_0x13e499){return _0xec6ab7(_0x13e499);},'xrPfY':function(_0x4f1da5,_0x56fc60){return _0x4f1da5!==_0x56fc60;},'LKzMg':_0x11963f(-0x2b3,-0x287,-0x2fa,-0x2c4),'uHhqi':function(_0x576e3c,_0x31e506){return _0x576e3c(_0x31e506);}};if(!_0x5625d1)return _0x5625d1;let _0x1e4bd6=_0x5625d1;_0x1e4bd6=_0x1e4bd6['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x51fe5d,_0x2d2344,_0xc78968)=>{const _0x494ef1=_0x2d2344[_0x18b290(-0x156,-0x14a,-0x174,-0x16b)]();function _0x18b290(_0x42995d,_0x520830,_0x3dcc23,_0x3d3842){return _0x11963f(_0x3d3842-0xe1,_0x520830,_0x3dcc23-0x1c1,_0x3d3842-0xa8);}_0x590eaf[_0x18b290(-0x1c9,-0x1d8,-0x213,-0x1e3)+'ta'][_0x7227f4(-0x29,-0x66,-0x2e,0x25)][_0x494ef1]=_0xc78968;function _0x7227f4(_0x5e03aa,_0x3086cb,_0x3597b9,_0x1ae663){return _0x12f58c(_0x1ae663,_0x5e03aa- -0x455,_0x3597b9-0xb0,_0x1ae663-0x8e);}if(_0x524925){if(_0x485378['KabFp'](_0x485378[_0x7227f4(0x45,0x56,0x91,0x5d)],_0x485378[_0x7227f4(0x45,0x64,0x58,0x68)])){if(_0x46724f){const _0x33bca1=_0x33a6b9[_0x7227f4(0x8,-0x26,-0x3d,-0x4)](_0x305e8,arguments);return _0x5a2b2e=null,_0x33bca1;}}else _0x524925['add'](_0x7227f4(-0x4c,-0x2d,-0x37,-0x31)+_0x494ef1+'@}');}return'';}),_0x1e4bd6=_0x1e4bd6[_0x11963f(-0x23c,-0x218,-0x221,-0x26f)](/\{@getvar::([^@]+)@\}/g,(_0x5f5b34,_0x1e921c)=>{const _0x4f0caa=_0x1e921c[_0x74bb56(0xd6,0xb1,0x77,0x8e)](),_0x56aa37=_0x590eaf[_0x74bb56(-0x2b,0x27,0x5a,0x16)+'ta'][_0x74bb56(0x4b,0x7b,0x5e,0x31)][_0x4f0caa]||'';function _0x1631cd(_0x29d01a,_0x5587c3,_0x1c5532,_0x5c4a48){return _0x12f58c(_0x29d01a,_0x1c5532- -0x28b,_0x1c5532-0x10a,_0x5c4a48-0x1ad);}function _0x74bb56(_0x402dd3,_0x21fb22,_0x5cfd34,_0x51ebe7){return _0x12f58c(_0x402dd3,_0x51ebe7- -0x3fb,_0x5cfd34-0x1b4,_0x51ebe7-0x22);}if(_0x524925){if(_0x485378[_0x74bb56(0x18,-0x1d,-0x28,0x18)]==='PSfut')_0x524925[_0x74bb56(0xc3,0xa9,0x5e,0x8f)](_0x74bb56(0xcd,0x7d,0x6d,0x7e)+_0x4f0caa+'@}');else{if(_0x1589e1&&_0x485378[_0x1631cd(0x1a7,0x1de,0x1de,0x222)](_0x436199[_0x74bb56(0x21,0x63,0x6,0x44)],_0x485378[_0x74bb56(0x31,0x8a,0x5f,0x4c)])&&_0x485378[_0x1631cd(0x168,0x1f8,0x1a8,0x1e8)](typeof _0x553c05[_0x74bb56(0x4b,0x51,0xb6,0x73)],_0x485378[_0x1631cd(0x1ff,0x203,0x1dc,0x20b)]))return{..._0x45c4c9,'text':_0x485378[_0x74bb56(0x3d,0x57,0x86,0x6f)](_0x4b90bb,_0x57a034[_0x74bb56(0xad,0xba,0x40,0x73)],_0x481c64,_0x4a17b3)};return _0x9f91bc;}}return _0x56aa37;}),_0x1e4bd6=_0x1e4bd6[_0x12f58c(0x451,0x499,0x48a,0x4a1)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5cef91,_0x2cf30c,_0xb0d41b)=>{function _0x31bd12(_0x18e1b8,_0x3fb1ed,_0x973fe9,_0x157c52){return _0x12f58c(_0x157c52,_0x18e1b8- -0x426,_0x973fe9-0x24,_0x157c52-0x11e);}const _0x17c6d7=_0x2cf30c[_0xcd8775(-0x248,-0x21c,-0x242,-0x26c)]();setglobalvar(_0x17c6d7,_0xb0d41b);function _0xcd8775(_0x1302ea,_0xcd9fc6,_0x6ce516,_0x34ed0f){return _0x11963f(_0x1302ea-0x4,_0x34ed0f,_0x6ce516-0x14f,_0x34ed0f-0x77);}return _0x524925&&_0x524925[_0xcd8775(-0x247,-0x288,-0x237,-0x27f)]('{@setgloba'+_0x31bd12(0x2,-0x15,-0xd,0x9)+_0x17c6d7+'@}'),'';});function _0x11963f(_0x20a4ea,_0x59e60b,_0xbcdc1b,_0x17c04a){return _0x5c11(_0x20a4ea- -0x3a2,_0x59e60b);}return _0x1e4bd6=_0x1e4bd6['replace'](/\{@getglobalvar::([^@]+)@\}/g,(_0x1e41d8,_0x1383af)=>{const _0x131c0c=_0x1383af['trim'](),_0x11c949=_0x485378['oMQaY'](getglobalvar,_0x131c0c)||'';return _0x524925&&_0x524925['add']('{@getgloba'+'lvar::'+_0x131c0c+'@}'),_0x11c949;}),_0x1e4bd6=_0x1e4bd6[_0x11963f(-0x23c,-0x1f1,-0x1fe,-0x1f5)](/\{@getworldvar::([^@]+)@\}/g,(_0x324a3c,_0x25eee8)=>{function _0x3c8307(_0x538179,_0x864de5,_0x5badf9,_0x4c9b04){return _0x11963f(_0x4c9b04-0x36b,_0x864de5,_0x5badf9-0x86,_0x4c9b04-0x93);}function _0x10984d(_0x4e9eaa,_0x2414c6,_0x25cd07,_0x463cd0){return _0x11963f(_0x2414c6-0x97,_0x463cd0,_0x25cd07-0xf1,_0x463cd0-0x1c0);}if(_0x485378['xrPfY'](_0x485378[_0x10984d(-0x1a4,-0x1dc,-0x1e6,-0x1db)],_0x3c8307(0x9d,0xa8,0xcd,0xb8)))return![];else{const _0xfc683b=_0x25eee8['trim'](),_0x43d850=_0x485378[_0x3c8307(0x149,0x127,0x136,0x129)](getworldvar,_0xfc683b)||'';return _0x524925&&_0x524925[_0x10984d(-0x16e,-0x1b4,-0x171,-0x1c9)](_0x10984d(-0x1ba,-0x1eb,-0x1e4,-0x1f9)+_0x3c8307(0x156,0x130,0xf2,0x12d)+_0xfc683b+'@}'),_0x43d850;}}),_0x1e4bd6;}export function buildPromptWithTrigger(_0x27a8ab){const _0xb09243={'PCnxV':function(_0x2090a4,_0x5c5889,_0x451b0d,_0x5c2475,_0x457b4a){return _0x2090a4(_0x5c5889,_0x451b0d,_0x5c2475,_0x457b4a);},'FzHxt':_0x1a71a3(0x2f8,0x334,0x346,0x31f),'BlTCf':function(_0x2872ee,_0x3722b7){return _0x2872ee||_0x3722b7;},'fLdHH':function(_0x2e57f4,_0xfa3be6){return _0x2e57f4===_0xfa3be6;},'zWQMj':_0x1a71a3(0x356,0x355,0x33d,0x371),'pzJey':_0x5caf52(-0x1c7,-0x1f6,-0x1eb,-0x1ef),'lEFkT':function(_0x28a0fb,_0x39da65,_0x44a6dc){return _0x28a0fb(_0x39da65,_0x44a6dc);},'qhOKu':'user','oUjzI':function(_0x517be9,_0x1d58c4){return _0x517be9!==_0x1d58c4;},'RzKtO':'xVMuw','HCMKI':function(_0x2a5d16,_0x3383a9){return _0x2a5d16!==_0x3383a9;},'olcHI':_0x5caf52(-0x218,-0x22c,-0x24e,-0x203),'NKiIh':_0x5caf52(-0x1b5,-0x1ff,-0x1e6,-0x1ba),'bFZxB':'assistant','TiMXO':function(_0x375609,_0x2c2564){return _0x375609(_0x2c2564);}},{requestType:_0x573285,contextData:_0x35fc0c}=_0x27a8ab,_0x35ce9b=extension_settings[extensionName]?.['llm_reques'+_0x5caf52(-0x217,-0x1e9,-0x1e7,-0x211)+_0x1a71a3(0x386,0x303,0x352,0x308)]||{},_0x1e3e5d={};_0x1e3e5d[_0x1a71a3(0x3a4,0x365,0x355,0x382)+'ofile']='默认';const _0x3e9590=_0x35ce9b[_0x573285]||_0x1e3e5d;function _0x5caf52(_0x157f52,_0x1fa709,_0x2a9c3c,_0x1e51ad){return _0x5c11(_0x1e51ad- -0x314,_0x2a9c3c);}const _0x2e0438=_0x3e9590[_0x1a71a3(0x397,0x382,0x355,0x320)+_0x1a71a3(0x383,0x34a,0x369,0x38c)]||'默认',_0x5c95fd=extension_settings[extensionName]?.[_0x1a71a3(0x387,0x38b,0x375,0x35a)+'xt_profile'+'s']||{},_0x5bc7f9=_0x5c95fd[_0x2e0438]||_0x5c95fd[Object['keys'](_0x5c95fd)[0x1bc9+0x34d+-0x1f16]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x35fc0c;function _0x1a71a3(_0x39c8bc,_0x8bc4f5,_0x5b5f05,_0x40eebb){return _0x5c11(_0x5b5f05-0x20b,_0x40eebb);}const _0x4e2a00=[userDemand,context,body,worldBookContent][_0x5caf52(-0x1dd,-0x1f5,-0x1be,-0x206)](Boolean)[_0x1a71a3(0x32b,0x338,0x306,0x31a)]('\x0a'),_0x1988db=[];if(_0x5bc7f9[_0x1a71a3(0x31e,0x2b8,0x302,0x342)]&&Array[_0x5caf52(-0x255,-0x265,-0x1f8,-0x230)](_0x5bc7f9[_0x1a71a3(0x2f2,0x2f1,0x302,0x2e5)]))for(const _0x4cc922 of _0x5bc7f9[_0x5caf52(-0x229,-0x23d,-0x1f9,-0x21d)]){if(_0xb09243[_0x5caf52(-0x19d,-0x1a3,-0x1e3,-0x1c2)](_0xb09243[_0x1a71a3(0x325,0x3b2,0x368,0x383)],_0x5caf52(-0x1cf,-0x1d8,-0x1bc,-0x1cb))){const _0x37119a=_0x5caf52(-0x1c6,-0x1a5,-0x1a6,-0x1c8)+_0x1e3f22+'}}',_0x5785c6=_0x172ee0[_0x124222]||'';_0x33ee77=_0xb09243['PCnxV'](_0x14ded2,_0x519317,_0x37119a,_0x5785c6,_0x1568e1);}else{if(!_0x4cc922['enabled'])continue;if(!_0x4cc922[_0x5caf52(-0x1ac,-0x1e7,-0x1b7,-0x1e3)]||_0xb09243[_0x5caf52(-0x1e4,-0x1bd,-0x188,-0x1c2)](_0x4cc922['content'][_0x5caf52(-0x1ba,-0x177,-0x189,-0x1be)](),''))continue;if(_0xb09243[_0x1a71a3(0x35d,0x363,0x35d,0x329)](_0x4cc922[_0x5caf52(-0x216,-0x235,-0x21e,-0x21a)+'e'],_0xb09243[_0x5caf52(-0x1e7,-0x1fe,-0x213,-0x20d)])){if(!_0xb09243[_0x1a71a3(0x2ae,0x30e,0x2e6,0x2c5)](checkTriggerWords,_0x4cc922[_0x1a71a3(0x29f,0x29d,0x2e4,0x2c7)+'ds'],_0x4e2a00))continue;}const _0x501b6e={};_0x501b6e[_0x1a71a3(0x304,0x2f9,0x333,0x32a)]=_0x4cc922[_0x5caf52(-0x1ea,-0x1db,-0x1d8,-0x1ec)]||_0xb09243[_0x1a71a3(0x358,0x2df,0x314,0x33b)],_0x501b6e[_0x5caf52(-0x1de,-0x1ec,-0x1bc,-0x1e3)]=_0x4cc922['content'],_0x1988db[_0x1a71a3(0x3c7,0x355,0x378,0x34f)](_0x501b6e);}}else{if(_0x5bc7f9[_0x1a71a3(0x2f0,0x2f6,0x334,0x343)]&&Array['isArray'](_0x5bc7f9[_0x1a71a3(0x344,0x32f,0x334,0x34a)]))for(const _0x57985b of _0x5bc7f9[_0x5caf52(-0x1d6,-0x19c,-0x1e7,-0x1eb)]){if(_0x57985b[_0x1a71a3(0x33c,0x2d0,0x2fb,0x2ba)]&&_0x57985b['user'][_0x5caf52(-0x170,-0x1b2,-0x20a,-0x1be)]()!==''){if(_0xb09243['oUjzI'](_0xb09243[_0x5caf52(-0x1e0,-0x1aa,-0x23f,-0x1f1)],_0xb09243[_0x5caf52(-0x236,-0x1f7,-0x1a9,-0x1f1)])){if(_0x31ba0a[_0x5caf52(-0x26b,-0x1e0,-0x215,-0x230)](_0xf7a498))return _0x3eb58d;return[{'type':_0xb09243[_0x5caf52(-0x1fb,-0x1c6,-0x189,-0x1d6)],'text':_0xb09243['BlTCf'](_0xf801e1,'')}];}else{const _0x577825={};_0x577825[_0x5caf52(-0x1cd,-0x233,-0x1a9,-0x1ec)]=_0xb09243[_0x1a71a3(0x331,0x2c8,0x314,0x2d1)],_0x577825[_0x1a71a3(0x34b,0x381,0x33c,0x31f)]=_0x57985b[_0x5caf52(-0x262,-0x22d,-0x25d,-0x224)],_0x1988db[_0x1a71a3(0x391,0x346,0x378,0x3b3)](_0x577825);}}if(_0x57985b['assistant']&&_0xb09243['oUjzI'](_0x57985b['assistant'][_0x1a71a3(0x39e,0x39c,0x361,0x361)](),'')){if(_0xb09243['HCMKI'](_0xb09243[_0x5caf52(-0x253,-0x277,-0x252,-0x23d)],_0xb09243[_0x1a71a3(0x2c8,0x2e3,0x2dd,0x2e5)])){const _0x136913={};_0x136913['role']=_0xb09243[_0x5caf52(-0x166,-0x186,-0x186,-0x1ac)],_0x136913[_0x1a71a3(0x358,0x35b,0x33c,0x32c)]=_0x57985b[_0x5caf52(-0x237,-0x1e1,-0x247,-0x207)],_0x1988db[_0x1a71a3(0x37b,0x3b8,0x378,0x342)](_0x136913);}else return[];}}}const _0xdb8080=_0xb09243['TiMXO'](mergeAdjacentMessages,_0x1988db),{messages:_0x3dc8f8,replacedVariables:_0x25a936}=_0xb09243[_0x5caf52(-0x22a,-0x289,-0x278,-0x239)](replaceAllPlaceholders,_0xdb8080,_0x35fc0c);return _0x3dc8f8;}export function getProcessedPrompt(_0x3c77ee,_0x1c768b){const _0x291a52={'zJfBt':function(_0x379dc7,_0x33bfbd){return _0x379dc7(_0x33bfbd);}},_0x3fb5fc={};function _0xeeff3(_0x1af60c,_0x248858,_0xe1b4c5,_0xa3de8d){return _0x5c11(_0xe1b4c5-0x29f,_0x1af60c);}_0x3fb5fc[_0xeeff3(0x3ad,0x3ba,0x3f8,0x3b3)+'e']=_0x3c77ee,_0x3fb5fc[_0x174c6(-0x316,-0x322,-0x356,-0x310)+'a']=_0x1c768b;function _0x174c6(_0x13ee3a,_0x4dc063,_0x4eea26,_0x31155e){return _0x5c11(_0x31155e- -0x3e1,_0x13ee3a);}return _0x291a52[_0xeeff3(0x3cb,0x3cd,0x382,0x341)](buildPromptWithTrigger,_0x3fb5fc);}