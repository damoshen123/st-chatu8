(function(_0x2b50b2,_0x579f15){const _0x5a55bc=_0x2b50b2();function _0x45f9dc(_0x5513b6,_0x18b5e9,_0x1aab6d,_0x30d0fc){return _0x233a(_0x5513b6-0x32f,_0x18b5e9);}function _0x183277(_0x430484,_0x36d1b3,_0x5c6aca,_0xb630d0){return _0x233a(_0xb630d0- -0x3ab,_0x430484);}while(!![]){try{const _0x5a12a9=parseInt(_0x183277(-0x206,-0x25b,-0x1ea,-0x23d))/(-0x3*0x92d+0x1d05+-0x17d)*(-parseInt(_0x183277(-0x266,-0x28b,-0x200,-0x24a))/(-0x1160+-0x1e35+-0x189*-0x1f))+parseInt(_0x183277(-0x279,-0x262,-0x297,-0x24d))/(-0x20ec+-0x32*-0x40+0x146f)+-parseInt(_0x183277(-0x1ad,-0x1c6,-0x1de,-0x1ff))/(-0x8d9*-0x1+-0x1*-0x97+-0x96c)*(parseInt(_0x45f9dc(0x508,0x4ba,0x513,0x4f1))/(0x20*0x22+-0x19ee+0xb*0x1f9))+-parseInt(_0x183277(-0x27f,-0x212,-0x282,-0x25b))/(0x2256+-0xdbb+0x1495*-0x1)+parseInt(_0x183277(-0x1f7,-0x1cc,-0x236,-0x1f4))/(0x20b+-0x1d*-0x1d+0x54d*-0x1)+-parseInt(_0x183277(-0x24f,-0x1fe,-0x203,-0x251))/(-0x521*-0x1+-0x1*0x162a+0x1111)*(parseInt(_0x183277(-0x19c,-0x20e,-0x1fe,-0x1c2))/(0x4f2+0x164f*-0x1+0x1166))+parseInt(_0x183277(-0x1c7,-0x1e0,-0x1d9,-0x207))/(-0x15a*-0x12+0x4e9*-0x2+-0x4*0x39e)*(parseInt(_0x183277(-0x23c,-0x283,-0x261,-0x252))/(0x1a78+-0x11be+-0x9*0xf7));if(_0x5a12a9===_0x579f15)break;else _0x5a55bc['push'](_0x5a55bc['shift']());}catch(_0x17d630){_0x5a55bc['push'](_0x5a55bc['shift']());}}}(_0x2cc4,-0x73919*-0x1+-0xbf*0x1e7+-0x61add*-0x1));const _0x17d16e=(function(){const _0x2208a8={};_0x2208a8[_0x452b11(0x16e,0x17a,0x169,0x177)]='TpIWD';const _0x5a14f=_0x2208a8;function _0x452b11(_0x3ae62f,_0x192251,_0x7f28d8,_0x4f3767){return _0x233a(_0x3ae62f- -0x11,_0x192251);}let _0x2725f5=!![];return function(_0x524d1c,_0x2b1399){const _0x4c3070={};_0x4c3070[_0x1ccc88(0x37c,0x372,0x361,0x34f)]=_0x5a14f[_0x1d93a2(-0x165,-0x14b,-0xef,-0x133)],_0x4c3070[_0x1ccc88(0x38c,0x3a6,0x32b,0x357)]='rEAkI';function _0x1d93a2(_0x23a8e3,_0x3ee90b,_0x1870c7,_0x370d82){return _0x452b11(_0x370d82- -0x2a1,_0x3ee90b,_0x1870c7-0x19b,_0x370d82-0x59);}const _0x4b3547=_0x4c3070,_0x2718f0=_0x2725f5?function(){function _0x275579(_0x4306cc,_0x1febc2,_0x10067d,_0x4a81b5){return _0x1d93a2(_0x4306cc-0x1c,_0x10067d,_0x10067d-0x8c,_0x4a81b5- -0x32);}function _0x505440(_0x1ec9b2,_0x5232df,_0x1eb0e6,_0x31f0f8){return _0x1d93a2(_0x1ec9b2-0xc,_0x1eb0e6,_0x1eb0e6-0x5,_0x5232df-0x213);}if(_0x2b1399){if(_0x4b3547[_0x275579(-0x117,-0xe6,-0xfd,-0x11c)]===_0x4b3547[_0x505440(0xf1,0x131,0x11d,0x163)])_0x7b5bba[_0x505440(0xf5,0x10b,0xed,0xbe)]('{@setvar::'+_0x5b857b+'@}');else{const _0xca5e46=_0x2b1399[_0x505440(0xf2,0xe4,0xec,0x96)](_0x524d1c,arguments);return _0x2b1399=null,_0xca5e46;}}}:function(){};function _0x1ccc88(_0x137ed3,_0x44d8bf,_0x5142a2,_0x55f8bb){return _0x452b11(_0x55f8bb-0x198,_0x5142a2,_0x5142a2-0xb8,_0x55f8bb-0x6);}return _0x2725f5=![],_0x2718f0;};}()),_0x1b1261=_0x17d16e(this,function(){function _0x11849b(_0x5a6774,_0xf09a3,_0x6914be,_0x31d3c6){return _0x233a(_0x31d3c6- -0x1f1,_0x6914be);}function _0x5af890(_0x1f1ec6,_0xd0c5c1,_0x501626,_0x2cd321){return _0x233a(_0x501626-0x251,_0x2cd321);}return _0x1b1261['toString']()['search'](_0x11849b(-0x7d,-0x1b,-0x81,-0x43)+'+$')[_0x11849b(-0x44,-0x63,-0x55,-0x3b)]()['constructo'+'r'](_0x1b1261)['search']('(((.+)+)+)'+'+$');});_0x1b1261();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';function _0x2cc4(){const _0x223959=['u0jvrfu','Ehf2uMy','DvHiB24','yxbWBhK','DhLWzq','ChvZAa','z21vrKy','AxnbCNjHEq','wgDPz28','BwPlwxG','zwLcsM0','weHRsMW','z052qKG','phvZzxi+','DvLnCgK','reTdCvm','vK5eC1m','ywrLtuq','wuvPtKm','DwP4sue','DLrOyKq','tuXju0e','tefIBu4','uKvsA0e','s2rntfi','y29UDgvUDa','yMLYzfq','q2zcrxy','Dgv4Da','vgP5BfG','zMLSDgvY','tuv2veS','A2HrCMu','uLHRB0e','y29UDgv4Df9WCG','reLIAxC','mtbWuKHzugG','E0bNzxr2yxi6oG','EM9Vvxu','DhjPz2DLCK1Vza','tKvQtNC','tvrpC1m','ywrK','Dw5Irgm','mJyXmLP3CwX0BW','BgvUz3rO','kcGOlISPkYKRkq','A3b6D3u','tLD3qwK','rfnWzM0','E3VMRApMLOD9Fq','tKjtDLK','u21ws0y','uNbxzMC','Dg9tDhjPBMC','ndi1otuWmeDTC3zvBW','C3rYAw5NAwz5','BvbwB2S','A3j1AKi','qNfkAKi','CLDszNa','BKnNBK8','vu9RBu0','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','q0fOzgG','re5MtLC','DMfYAwfIBgvZ','A3fbuLm','BwzTt0G','zMTysLG','zwPvCuW','AwnmCuy','s0fKv3q','q1zPEMK','E3VNLkJMIlFPNidMSyj9Fq','CMvWBgfJzq','sMXszeu','rvviBxi','whHYrNq','BhzHCJO6','zgHTs3C','B2zPBgu','AM9PBG','E3VKUjBNLyZKUABOP6BLJ5f9Fq','AgLZDg9YEq','DhjPBq','yMTAEfy','EgL5Dgm','C1nLwwe','mJaYmfHMD3rPva','y1vkq04','C3rYAw5N','E0bNzxrNBg9Iyq','DMfYoJO','AhHtqKC','v0DJDMG','AhDOv3y','rfflq0i','vuHPqu0','Efz1y0W','DhjPz2DLCLDVCG','D2TkvuO','EhrFChjVzMLSzq','z2jfrKi','A2v5CW','ouDVu3DNsq','vgvlyNq','AMnyquq','ywL0whm','DMjVAfK','CMvWBgfJzufSBa','CfjLrwK','y014AgS','AMrrBhu','zev4Dui','CKPQDum','Du5wvee','DhncA0i','BwfW','B0XoBhe','tvr3zMG','y29UDgv4DerHDa','ntG1mZGXnM1RCwvfzG','E3TNzxr2yxi6oG','DNzgwfu','E0bNzxr3B3jSza','vxfXAuS','AMXdyvm','CKHvAwW','twTrt1m','CM9Szq','nti3mZa0ofjnBhnXDG','mta1mtGZmKvfCwD4qG','DxnLCG','E3T1C2vYFx0','vfPkqxC','mZu4mtu1m3DftgjSuq','zw50CMLLCW','CMvXDwvZDfr5Ca','mZCYndjVAhzcBMG','E0bZzxrNBg9Iyq','y2HHDe1LDgfKyq','AKzdDvK','seLiugm','s2DNzg4','B1vwyLK','CKjbtg8','v3bJEM8','yvLXCe8','CMvWBgfJzwrwyq','A2LZsMq','vLbiA2e','n0vSzxjtuW','BMfTzte','yxnZAxn0yw50','qMHzre0','DMfgC0S','uxDsAuq','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','DgvZDf9JB250zq','zw5HyMXLza','uxfHzee','uNzOAuq','zhfOEuC','BeX6q2K','Aw5JBhvKzxm','vMjWy2G','A2jyt3m','CMLHyMXLCW','qM92q1G'];_0x2cc4=function(){return _0x223959;};return _0x2cc4();}export function checkTriggerWords(_0x403313,_0x3dfc81){const _0x403543={'Kggdn':function(_0x50720c,_0x26cbae){return _0x50720c===_0x26cbae;},'rWRfp':function(_0x27c9ae,_0x5e0fd7,_0x2510b6){return _0x27c9ae(_0x5e0fd7,_0x2510b6);},'vSKGQ':function(_0x37e579,_0x43e5ff,_0x456640,_0x293873,_0x534afa){return _0x37e579(_0x43e5ff,_0x456640,_0x293873,_0x534afa);},'jFCuY':function(_0x534031,_0x42821e){return _0x534031===_0x42821e;},'cUJCN':'niMyQ','tbRvt':function(_0x392f8b,_0x5a3049){return _0x392f8b===_0x5a3049;},'CVizi':function(_0x3e5e1e,_0x1b0f56){return _0x3e5e1e!==_0x1b0f56;},'kqARS':_0x454a37(0x5f,0x38,0x4c,0x65)};if(!_0x403313||!_0x3dfc81){if(_0x403543[_0x454a37(-0x11,-0x1f,0x0,0x30)](_0x454a37(0x79,0x4a,0x49,0x66),_0x403543[_0x454a37(0x23,0x57,0x1f,0x57)])){if(!_0xd25d96){const _0x3ef67d={..._0x15d7e1};_0x4e24a7=_0x3ef67d;}else{if(_0x403543[_0x454a37(-0x47,-0x1d,-0x66,-0x53)](_0x224164['role'],_0x2566f4[_0x454a37(-0x3b,-0x2b,-0x68,0x23)]))_0x5e0e0d['content']=_0x403543[_0x26337f(0x72,0xad,0x6c,0x48)](_0x16893c,_0x1a0f64[_0x454a37(-0x4,0x16,0xd,0x56)],_0x5b4fe7['content']);else{_0x151a24[_0x26337f(0x40,0x73,0x35,0x28)](_0x1ede4b);const _0x309cf8={..._0x388983};_0x5d26d2=_0x309cf8;}}}else return![];}const _0x397078=_0x403313['split'](',')[_0x454a37(-0x44,-0x37,0x1,-0xb)](_0xeaee9a=>_0xeaee9a['trim']())[_0x26337f(0x2d,0x3c,0x4e,0x2c)](_0x3ab6f6=>_0x3ab6f6);function _0x454a37(_0x4a0c73,_0x5ab7fe,_0x308182,_0x20d04a){return _0x233a(_0x5ab7fe- -0x183,_0x4a0c73);}if(_0x403543['tbRvt'](_0x397078[_0x454a37(-0x2a,0x2a,-0x1b,-0x18)],0x26e3+0x1673+-0x3d56)){if(_0x403543[_0x26337f(0x2c,0xa5,0x79,0x54)](_0x454a37(-0xb,0x38,-0x13,0x23),_0x403543[_0x454a37(0x23,0x40,0x6,-0xd)])){const _0x1dd9a6=_0x454a37(-0x87,-0x32,-0x6d,-0x29)+_0x56b2a3+'}}',_0x549a8c=_0x302faf[_0x1a425e]||'';_0x2fb0b2=_0x403543['vSKGQ'](_0x492631,_0x473d14,_0x1dd9a6,_0x549a8c,_0xd15eef);}else return![];}for(const _0x16602c of _0x397078){if(_0x3dfc81[_0x454a37(-0x47,-0x8,-0x1,-0x58)](_0x16602c))return!![];}function _0x26337f(_0x46821a,_0x32372c,_0x33a8f4,_0x592268){return _0x233a(_0x33a8f4- -0x150,_0x46821a);}return![];}export function mergeAdjacentMessages(_0x31237b){const _0x21a847={'rBALo':_0x36f5d0(0x1c2,0x1fb,0x1c3,0x17a),'SmVKF':function(_0x3b830e,_0x27f23d){return _0x3b830e||_0x27f23d;},'UHiAM':_0x3f95b8(0xef,0x101,0xff,0xce),'jcXAD':'<user>','TZJAw':_0x36f5d0(0x133,0x19c,0x16f,0x17f),'krujB':function(_0x5818c7,_0x120e00){return _0x5818c7===_0x120e00;},'wyUzK':_0x36f5d0(0x182,0x19e,0x1b0,0x1d5),'ejUqL':function(_0x36ce95,_0x5e03e3,_0x3823ff){return _0x36ce95(_0x5e03e3,_0x3823ff);},'MEvTK':function(_0x5a28ac,_0x546527){return _0x5a28ac===_0x546527;},'VPHka':_0x36f5d0(0x1e3,0x231,0x206,0x24f),'RvhiD':_0x3f95b8(0x131,0x13b,0x17e,0x176)};if(!_0x31237b||_0x31237b['length']===0x232e+-0x12ae*-0x2+-0x1*0x488a)return[];const _0x1d33a2=[];function _0x3f95b8(_0x301a35,_0x399db0,_0x479606,_0x3ee681){return _0x233a(_0x399db0- -0x5b,_0x3ee681);}let _0x18e965=null;function _0x36f5d0(_0x205ed0,_0xb3b6dc,_0x243656,_0x261f39){return _0x233a(_0x243656-0x27,_0x205ed0);}for(const _0x3bd136 of _0x31237b){if(_0x3f95b8(0x187,0x191,0x1e4,0x162)!==_0x21a847[_0x3f95b8(0xba,0x102,0x113,0xe1)]){if(!_0x18e965){const _0x5941f0={..._0x3bd136};_0x18e965=_0x5941f0;}else{if(_0x21a847[_0x36f5d0(0x1cd,0x1fb,0x1e1,0x1a0)](_0x18e965[_0x3f95b8(0x13b,0xfd,0xe6,0x13c)],_0x3bd136[_0x36f5d0(0x16a,0x18f,0x17f,0x145)])){if(_0x21a847['wyUzK']===_0x3f95b8(0x142,0x12e,0x115,0x115))_0x18e965[_0x3f95b8(0x11c,0x13e,0x192,0x127)]=_0x21a847[_0x3f95b8(0x19d,0x16b,0x15b,0x157)](mergeContent,_0x18e965[_0x3f95b8(0x172,0x13e,0x154,0xec)],_0x3bd136[_0x3f95b8(0x117,0x13e,0x158,0xfb)]);else{if(_0x4d87aa[_0x3f95b8(0xfd,0x12c,0xda,0x10d)](_0xbbde36))return _0x37a28a;return[{'type':_0x21a847[_0x3f95b8(0xd4,0x10d,0xcd,0x128)],'text':_0x21a847[_0x36f5d0(0x207,0x207,0x1db,0x19f)](_0x10e403,'')}];}}else{if(_0x21a847[_0x36f5d0(0x1c0,0x181,0x1c6,0x174)](_0x21a847[_0x36f5d0(0x1c0,0x1dd,0x194,0x178)],_0x21a847[_0x36f5d0(0x1e8,0x18e,0x19f,0x17c)]))_0x31eaa4[_0x3f95b8(0x16b,0x14f,0x161,0x196)](_0x3f95b8(0x15b,0x14a,0x143,0x110)+_0x1a780c+'@}');else{_0x1d33a2[_0x36f5d0(0x19e,0x195,0x1ac,0x1ad)](_0x18e965);const _0x3db1ef={..._0x3bd136};_0x18e965=_0x3db1ef;}}}}else _0x35fa33=_0xa753b6[_0x3f95b8(0x17b,0x193,0x16e,0x13e)](_0x21a847[_0x36f5d0(0x259,0x1d9,0x209,0x1c2)],_0x3ca44b),_0x9b3735=_0x5afd24[_0x3f95b8(0x18a,0x193,0x1a3,0x1c7)](_0x21a847[_0x3f95b8(0x1b7,0x190,0x1c8,0x1a0)],_0x2b8147);}return _0x18e965&&_0x1d33a2['push'](_0x18e965),_0x1d33a2;}function mergeContent(_0x4615bb,_0x51ef71){const _0x2a3cc8={'TjylX':function(_0x5e5b42,_0x382beb){return _0x5e5b42===_0x382beb;},'vThbD':_0x292eca(-0x10c,-0x142,-0x132,-0xf2),'KoRmg':function(_0x5d23a9,_0x34c9de){return _0x5d23a9+_0x34c9de;},'jdQlu':function(_0x40a893,_0xca129d){return _0x40a893+_0xca129d;},'rJjuC':function(_0x2a3efe,_0x449b6c){return _0x2a3efe(_0x449b6c);},'birdT':_0x292eca(-0x185,-0x152,-0x15a,-0x131)};function _0x292eca(_0x56fdce,_0x39ac79,_0xb5e5cb,_0x3ad349){return _0x233a(_0x3ad349- -0x2cd,_0x56fdce);}if(_0x2a3cc8[_0x292eca(-0xfa,-0xef,-0xe3,-0x130)](typeof _0x4615bb,_0x2a3cc8[_0x292eca(-0x183,-0x135,-0x148,-0x139)])&&_0x2a3cc8['TjylX'](typeof _0x51ef71,'string'))return _0x2a3cc8['KoRmg'](_0x2a3cc8[_0x4cde03(0x3b4,0x32c,0x38f,0x378)](_0x4615bb,'\x0a'),_0x51ef71);function _0x4cde03(_0x2fdd5f,_0x41d9fc,_0x559231,_0x425e2d){return _0x233a(_0x425e2d-0x231,_0x41d9fc);}const _0xd25dfa=_0x2a3cc8[_0x4cde03(0x3be,0x37f,0x380,0x37a)](normalizeToArray,_0x4615bb),_0x36914b=_0x2a3cc8[_0x4cde03(0x3b9,0x3b9,0x3b6,0x37a)](normalizeToArray,_0x51ef71),_0xb604a9={};return _0xb604a9[_0x292eca(-0x12a,-0x16a,-0x14f,-0x149)]=_0x2a3cc8[_0x4cde03(0x3a5,0x39e,0x394,0x3cb)],_0xb604a9[_0x4cde03(0x3b7,0x3a5,0x387,0x3cd)]='\x0a',[..._0xd25dfa,_0xb604a9,..._0x36914b];}function normalizeToArray(_0x2b8bae){if(Array[_0x1a792a(0x181,0x15a,0x117,0x169)](_0x2b8bae))return _0x2b8bae;const _0x347988={};function _0x1a792a(_0x49efc1,_0x47242b,_0x1c9c2d,_0x4cca5b){return _0x233a(_0x47242b- -0x2d,_0x1c9c2d);}_0x347988[_0x1a792a(0x121,0x157,0x155,0x189)]=_0x62e4ec(-0x1f,0x1f,-0x35,-0x7a);function _0x62e4ec(_0x687866,_0x563cd6,_0x449439,_0x1e22a3){return _0x233a(_0x449439- -0x1d1,_0x563cd6);}return _0x347988[_0x62e4ec(-0x4e,-0x74,-0x35,-0x29)]=_0x2b8bae||'',[_0x347988];}export function replacePlaceholder(_0x6113f4,_0x317681,_0x21043b,_0x2bfcfd){const _0x217e48={'CfBEv':function(_0x145532,_0x1559c0){return _0x145532===_0x1559c0;},'gbEFB':_0x40f5dd(-0x146,-0x199,-0x178,-0x194),'DQKCB':function(_0x13fdee,_0x32c4d4){return _0x13fdee+_0x32c4d4;},'oLNlq':function(_0x124af3,_0x3f201e){return _0x124af3(_0x3f201e);},'DNfNW':_0x40f5dd(-0x185,-0x162,-0x164,-0x13f),'MTwfh':function(_0x45c183,_0x49c0e7){return _0x45c183===_0x49c0e7;},'cWpNw':function(_0x36ef91,_0x4d2533){return _0x36ef91!==_0x4d2533;},'NWwAi':'BzVhS','gmUFF':function(_0x14b283,_0x1efb76){return _0x14b283||_0x1efb76;},'UFSOw':'object','wkJUJ':function(_0x10709f,_0x178136,_0x3e5ee2,_0xaa3b9c,_0x521443){return _0x10709f(_0x178136,_0x3e5ee2,_0xaa3b9c,_0x521443);}};function _0x40f5dd(_0xa282dc,_0x156af9,_0x33e8ba,_0x5db7c7){return _0x233a(_0xa282dc- -0x321,_0x33e8ba);}if(_0x217e48[_0x40f5dd(-0x1d3,-0x188,-0x1e5,-0x205)](typeof _0x6113f4,_0x217e48[_0x40f5dd(-0x13a,-0x10e,-0x180,-0x16b)])){if(_0x21043b&&_0x6113f4[_0x41a08d(0x254,0x203,0x1ca,0x1ed)](_0x317681)){if(_0x217e48['cWpNw'](_0x217e48[_0x41a08d(0x26a,0x238,0x1f5,0x277)],_0x217e48[_0x40f5dd(-0x171,-0x1c6,-0x1bc,-0x1c2)])){if(_0x217e48[_0x41a08d(0x1e1,0x223,0x1dc,0x25f)](typeof _0x1a1f81,_0x217e48[_0x41a08d(0x23a,0x26f,0x2b7,0x283)])&&_0x217e48[_0x41a08d(0x26a,0x223,0x25f,0x1fd)](typeof _0xaae8e9,_0x217e48[_0x41a08d(0x2a2,0x26f,0x21c,0x25d)]))return _0x217e48[_0x41a08d(0x27b,0x269,0x245,0x291)](_0x217e48['DQKCB'](_0x5ae796,'\x0a'),_0x764968);const _0x163f22=_0x217e48[_0x41a08d(0x18c,0x1d5,0x1c6,0x1d8)](_0x1a17e2,_0x359745),_0x16c1ea=_0x217e48['oLNlq'](_0x5eb185,_0x1afd6a),_0x5eec18={};return _0x5eec18[_0x40f5dd(-0x19d,-0x16d,-0x1dd,-0x175)]=_0x217e48[_0x41a08d(0x21e,0x249,0x256,0x284)],_0x5eec18[_0x40f5dd(-0x185,-0x1be,-0x198,-0x15b)]='\x0a',[..._0x163f22,_0x5eec18,..._0x16c1ea];}else _0x2bfcfd&&_0x2bfcfd[_0x41a08d(0x1e1,0x232,0x226,0x268)](_0x317681);}return _0x6113f4['replaceAll'](_0x317681,_0x217e48[_0x41a08d(0x1fc,0x20e,0x220,0x22f)](_0x21043b,''));}function _0x41a08d(_0x2bf954,_0x2a736d,_0xb48be8,_0x1b0f27){return _0x233a(_0x2a736d-0x88,_0xb48be8);}if(Array['isArray'](_0x6113f4))return _0x6113f4['map'](_0x4d0e41=>replacePlaceholder(_0x4d0e41,_0x317681,_0x21043b,_0x2bfcfd));if(_0x6113f4&&_0x217e48[_0x40f5dd(-0x186,-0x1a2,-0x153,-0x18f)](typeof _0x6113f4,_0x217e48['UFSOw'])){const _0x3b973f={};for(const _0x1b8d61 in _0x6113f4){_0x3b973f[_0x1b8d61]=_0x217e48[_0x41a08d(0x226,0x26d,0x24f,0x2a6)](replacePlaceholder,_0x6113f4[_0x1b8d61],_0x317681,_0x21043b,_0x2bfcfd);}return _0x3b973f;}return _0x6113f4;}export function replaceAllPlaceholders(_0x17ce1a,_0x2997fd){const _0x3703e9={'MTOsS':function(_0x3515fa,_0x46e3b4,_0x5c47d3,_0x1cb7a7,_0x24e236){return _0x3515fa(_0x46e3b4,_0x5c47d3,_0x1cb7a7,_0x24e236);},'kbXOs':function(_0x2edd49){return _0x2edd49();},'koUsT':_0x4112ef(0x419,0x44a,0x423,0x455),'adeMD':_0x4112ef(0x441,0x47b,0x499,0x484),'DIbiw':'{{上下文}}','SBUDU':function(_0xda7d7,_0x44143f,_0x18675e,_0x4a4967,_0x1432b3){return _0xda7d7(_0x44143f,_0x18675e,_0x4a4967,_0x1432b3);},'RpWfg':_0x28e16b(0x46b,0x4be,0x471,0x49a),'xTgqc':function(_0x54499e,_0x327d88,_0x5beda9,_0x57dfac,_0x2b2a0e){return _0x54499e(_0x327d88,_0x5beda9,_0x57dfac,_0x2b2a0e);},'oUVbY':_0x4112ef(0x472,0x4a0,0x4ca,0x4ae),'lXFgy':function(_0x52b4d0,_0x53ad0c,_0x4522ec,_0x41439e,_0x487d82){return _0x52b4d0(_0x53ad0c,_0x4522ec,_0x41439e,_0x487d82);},'UOkmM':'{{通用服装启用列表'+'}}','nCgnO':function(_0x27ae43,_0x1a0798,_0x49e35f,_0x11b273,_0x3373ce){return _0x27ae43(_0x1a0798,_0x49e35f,_0x11b273,_0x3373ce);},'hxSBG':_0x28e16b(0x440,0x415,0x45d,0x434)+'}}','cMxhk':_0x4112ef(0x4d7,0x4b8,0x472,0x4c6),'xVucL':function(_0x5ed491,_0x2a0dfc){return _0x5ed491>_0x2a0dfc;},'uXHon':function(_0x1fe280,_0x2ecdcc){return _0x1fe280!==_0x2ecdcc;},'uNVTA':_0x4112ef(0x4ae,0x4db,0x52b,0x4b0),'ouJqU':_0x4112ef(0x4cd,0x49f,0x4d5,0x478),'xqvRf':_0x28e16b(0x45c,0x466,0x431,0x3fc),'gNvBH':function(_0x4c9446,_0x1c05e5,_0x4d36ae){return _0x4c9446(_0x1c05e5,_0x4d36ae);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x2997fd,_0x3e430b=new Set();let _0x1397a8=_0x17ce1a;function _0x4112ef(_0x7d3ff2,_0x304871,_0x46583b,_0x44538d){return _0x233a(_0x304871-0x2ee,_0x44538d);}const _0x2d4371=_0x3703e9[_0x4112ef(0x451,0x46b,0x42e,0x4a8)](getContext),_0x3b0d96=_0x2d4371?.[_0x28e16b(0x3cc,0x3dc,0x40d,0x3bd)]||'';let _0x1ac773=worldBookContent;_0x1ac773&&(_0x1ac773=_0x1ac773[_0x4112ef(0x4e0,0x4dc,0x51c,0x49a)](_0x3703e9['koUsT'],_0x3b0d96),_0x1ac773=_0x1ac773['replaceAll'](_0x3703e9[_0x28e16b(0x434,0x43c,0x42f,0x41c)],_0x3b0d96));_0x1397a8=_0x3703e9[_0x4112ef(0x4d9,0x497,0x481,0x4af)](replacePlaceholder,_0x1397a8,_0x3703e9[_0x28e16b(0x467,0x405,0x441,0x415)],context,_0x3e430b),_0x1397a8=_0x3703e9[_0x4112ef(0x4ae,0x46e,0x4a0,0x48e)](replacePlaceholder,_0x1397a8,_0x3703e9[_0x4112ef(0x461,0x4a3,0x460,0x4dc)],_0x1ac773,_0x3e430b),_0x1397a8=_0x3703e9['xTgqc'](replacePlaceholder,_0x1397a8,_0x3703e9[_0x28e16b(0x440,0x44b,0x405,0x3b4)],body,_0x3e430b),_0x1397a8=_0x3703e9[_0x4112ef(0x4da,0x497,0x460,0x4ea)](replacePlaceholder,_0x1397a8,_0x28e16b(0x3fb,0x441,0x412,0x3e9),characterListText,_0x3e430b);function _0x28e16b(_0xb3edbb,_0xfbfe70,_0x41c7a9,_0x2c86fc){return _0x233a(_0x41c7a9-0x29e,_0xfbfe70);}_0x1397a8=_0x3703e9['lXFgy'](replacePlaceholder,_0x1397a8,_0x3703e9[_0x28e16b(0x470,0x48f,0x45c,0x442)],outfitEnableListText,_0x3e430b),_0x1397a8=_0x3703e9[_0x28e16b(0x499,0x427,0x45b,0x42f)](replacePlaceholder,_0x1397a8,_0x3703e9[_0x28e16b(0x461,0x4bd,0x47c,0x498)],commonCharacterListText,_0x3e430b),_0x1397a8=replacePlaceholder(_0x1397a8,_0x3703e9[_0x4112ef(0x521,0x4de,0x4b0,0x4ae)],userDemand,_0x3e430b);if(variables&&_0x3703e9[_0x28e16b(0x4a3,0x490,0x481,0x465)](Object[_0x28e16b(0x485,0x498,0x486,0x477)](variables)[_0x28e16b(0x43d,0x3fe,0x44b,0x419)],-0x14d8+0x1e1e+-0x946)){if(_0x3703e9['uXHon'](_0x3703e9['uNVTA'],_0x3703e9[_0x4112ef(0x464,0x438,0x486,0x3e8)])){if(!_0xf19302||!_0x384109[_0x28e16b(0x400,0x479,0x437,0x46b)])return _0x1115fe;return{..._0x245c31,'content':_0x45a0b(_0x312409[_0x28e16b(0x441,0x43f,0x437,0x47d)],_0x1739b3,_0x49cfa1)};}else{const _0x165ab9=/\{\{getvar::([^}]+)\}\}/g,_0x4a7c54=JSON[_0x4112ef(0x468,0x4a6,0x4f9,0x4b4)](_0x1397a8),_0x17ba49=[..._0x4a7c54['matchAll'](_0x165ab9)],_0x1fa13d=new Set();for(const _0x345015 of _0x17ba49){if(_0x3703e9[_0x4112ef(0x467,0x470,0x482,0x470)](_0x3703e9['ouJqU'],_0x3703e9[_0x28e16b(0x40d,0x456,0x41f,0x3cf)]))_0x1fa13d['add'](_0x345015[-0xcec+-0x3*-0xaa9+-0x130e]);else{const _0x403386={};for(const _0x1ced28 in _0x1e62f3){_0x403386[_0x1ced28]=_0x3703e9[_0x28e16b(0x3f8,0x3f3,0x447,0x420)](_0x4b2342,_0x185715[_0x1ced28],_0x4980ef,_0x15d43b,_0x880a2d);}return _0x403386;}}for(const _0x5853bd of _0x1fa13d){const _0x436394=_0x28e16b(0x3d1,0x410,0x3ef,0x3f0)+_0x5853bd+'}}',_0x16f96d=variables[_0x5853bd]||'';_0x1397a8=_0x3703e9[_0x28e16b(0x43c,0x421,0x45b,0x422)](replacePlaceholder,_0x1397a8,_0x436394,_0x16f96d,_0x3e430b);}}}_0x1397a8=_0x3703e9[_0x4112ef(0x47a,0x47a,0x42f,0x461)](processVariablePlaceholdersInMessages,_0x1397a8,_0x3e430b);const _0x394d47={};return _0x394d47['messages']=_0x1397a8,_0x394d47[_0x4112ef(0x48e,0x459,0x49a,0x47c)+_0x4112ef(0x4b1,0x46c,0x472,0x49f)]=_0x3e430b,_0x394d47;}function processVariablePlaceholdersInMessages(_0xb71297,_0x34d4ba){const _0x38cc6d={'bhEQD':function(_0x8fbb67,_0x2d3ccd){return _0x8fbb67===_0x2d3ccd;},'DwAiz':_0x55bd10(0x37e,0x3c3,0x380,0x358),'bkZxV':function(_0x41dffc,_0x3c889f,_0x1c2cfc,_0x240913){return _0x41dffc(_0x3c889f,_0x1c2cfc,_0x240913);},'TeKbt':function(_0x1e5f1a,_0x142de9){return _0x1e5f1a===_0x142de9;},'MLISA':function(_0x5d2eb7){return _0x5d2eb7();}};if(!_0xb71297||_0x38cc6d[_0x317d2e(0x1b8,0x187,0x19e,0x1bc)](_0xb71297[_0x317d2e(0x1a3,0x186,0x1a0,0x17f)],-0x23b5+-0x3e6+0x279b))return _0xb71297;const _0x5528b9=_0x38cc6d[_0x55bd10(0x38b,0x34e,0x398,0x354)](getContext);function _0x55bd10(_0x15baed,_0x17c959,_0x781ce5,_0x5dbb74){return _0x233a(_0x15baed-0x1f6,_0x17c959);}function _0x317d2e(_0x5a9d15,_0x37653c,_0xc3f6e3,_0x163fd9){return _0x233a(_0x163fd9- -0x2e,_0x5a9d15);}return!_0x5528b9['chatMetada'+'ta']&&(_0x5528b9[_0x317d2e(0x107,0x113,0x125,0x135)+'ta']={}),!_0x5528b9[_0x55bd10(0x359,0x31f,0x388,0x305)+'ta']['variables']&&(_0x5528b9[_0x55bd10(0x359,0x30c,0x353,0x31e)+'ta']['variables']={}),_0xb71297[_0x55bd10(0x342,0x308,0x356,0x314)](_0x1383a8=>{function _0x292915(_0x1392a5,_0x51e53c,_0x3afdc2,_0xbbacc){return _0x317d2e(_0x51e53c,_0x51e53c-0xe2,_0x3afdc2-0x1e4,_0x1392a5-0x102);}function _0xead8db(_0x4c405b,_0x35c9ff,_0x11c608,_0x46a209){return _0x317d2e(_0x11c608,_0x35c9ff-0x55,_0x11c608-0x192,_0x35c9ff-0x1ae);}if(_0x38cc6d['bhEQD'](_0x38cc6d['DwAiz'],_0x292915(0x25f,0x20d,0x22d,0x2b1)))_0x4acea2['add'](_0x117793);else{if(!_0x1383a8||!_0x1383a8[_0xead8db(0x366,0x319,0x308,0x337)])return _0x1383a8;return{..._0x1383a8,'content':_0x38cc6d[_0xead8db(0x342,0x356,0x365,0x31e)](processContentVariables,_0x1383a8[_0x292915(0x26d,0x224,0x266,0x258)],_0x5528b9,_0x34d4ba)};}});}function processContentVariables(_0x5d2b8f,_0x238935,_0x410521){const _0xd303ae={'vvFXU':function(_0x29b8eb,_0x26c8d4,_0xe6feea,_0x10e0ee){return _0x29b8eb(_0x26c8d4,_0xe6feea,_0x10e0ee);},'unbDc':function(_0x19bb54,_0x9d4b3){return _0x19bb54===_0x9d4b3;},'mfmOH':function(_0x17d291,_0x195653){return _0x17d291===_0x195653;},'BhYDM':_0x56c661(0x39b,0x329,0x372,0x327),'gljrv':function(_0x40edd3,_0x2122ac){return _0x40edd3!==_0x2122ac;},'UqqiK':_0x2f3c67(-0x1e7,-0x217,-0x1c2,-0x192),'nhvDg':function(_0x5470f5,_0x104648,_0x18e629,_0x3e5dcb){return _0x5470f5(_0x104648,_0x18e629,_0x3e5dcb);},'cMcye':'icbZm'};function _0x2f3c67(_0x46afb0,_0x40cbdf,_0x58d70f,_0xdcb64d){return _0x233a(_0x58d70f- -0x359,_0xdcb64d);}if(typeof _0x5d2b8f===_0xd303ae[_0x56c661(0x312,0x2c2,0x308,0x347)])return _0xd303ae[_0x2f3c67(-0x17d,-0x166,-0x1ae,-0x1cd)]('RERkA',_0xd303ae[_0x56c661(0x305,0x31c,0x2eb,0x2d5)])?_0xd303ae['nhvDg'](processStringVariables,_0x5d2b8f,_0x238935,_0x410521):_0xd303ae[_0x56c661(0x2cd,0x2b1,0x2e9,0x2e2)](_0x54ab33,_0x3b6c49,_0x225d10,_0x31d463);function _0x56c661(_0xc019e9,_0x4ccf9f,_0x5cd2f3,_0x16db1b){return _0x233a(_0x5cd2f3-0x197,_0x4ccf9f);}if(Array['isArray'](_0x5d2b8f))return _0xd303ae[_0x56c661(0x33c,0x3a6,0x35b,0x36d)](_0xd303ae['cMcye'],'Bzwcf')?![]:_0x5d2b8f[_0x2f3c67(-0x225,-0x1f6,-0x20d,-0x243)](_0x1738e4=>{function _0x49fd3a(_0x565e23,_0x37b288,_0x1cd89c,_0x540b16){return _0x2f3c67(_0x565e23-0x26,_0x37b288-0xe0,_0x37b288-0x56a,_0x565e23);}function _0x3d19c8(_0x2bf43e,_0x3ca53c,_0x2f7899,_0x1d2388){return _0x2f3c67(_0x2bf43e-0x80,_0x3ca53c-0xa3,_0x2bf43e- -0x43,_0x2f7899);}if(_0x1738e4&&_0xd303ae['unbDc'](_0x1738e4[_0x3d19c8(-0x218,-0x205,-0x201,-0x237)],'text')&&_0xd303ae['mfmOH'](typeof _0x1738e4[_0x3d19c8(-0x200,-0x254,-0x1bb,-0x1f0)],_0xd303ae[_0x49fd3a(0x3c7,0x382,0x3b1,0x367)])){if(_0xd303ae['gljrv']('zBSoS','EKzhk'))return{..._0x1738e4,'text':processStringVariables(_0x1738e4['text'],_0x238935,_0x410521)};else _0x5e15ba['content']=_0x446096(_0x25eaa4['content'],_0x5d9a91[_0x3d19c8(-0x203,-0x1f8,-0x24a,-0x257)]);}return _0x1738e4;});return _0x5d2b8f;}function processStringVariables(_0x563f05,_0x365d4b,_0x43c091){function _0x465cff(_0x4ab007,_0x2447b6,_0xb5a0b5,_0x44f450){return _0x233a(_0xb5a0b5- -0x3b1,_0x44f450);}const _0x2886b2={'IQuVl':'text','Wpczo':function(_0x206d8b,_0x4ae90b,_0x206e4e,_0x184435){return _0x206d8b(_0x4ae90b,_0x206e4e,_0x184435);},'khQre':function(_0x4a8421,_0x26135b){return _0x4a8421!==_0x26135b;},'zwGVl':_0x1808a0(-0x128,-0x13a,-0x118,-0x115),'tzjwO':_0x465cff(-0x240,-0x28e,-0x256,-0x20d),'kisJd':_0x1808a0(-0x170,-0x100,-0x1a2,-0x154),'sSeYa':_0x465cff(-0x1fe,-0x1f4,-0x21f,-0x22d),'EoseL':_0x465cff(-0x22b,-0x24f,-0x238,-0x253),'XxrFt':function(_0x182d02,_0x49dfa4,_0x14e268){return _0x182d02(_0x49dfa4,_0x14e268);},'NEjNw':_0x1808a0(-0xfc,-0x178,-0xfd,-0x136),'xiytc':_0x465cff(-0x269,-0x243,-0x221,-0x253),'icLqF':function(_0x353467,_0x3aca7f){return _0x353467(_0x3aca7f);},'aYqpO':function(_0x5b2540,_0x3b3ee2){return _0x5b2540(_0x3b3ee2);},'vaFsK':function(_0x1e549b,_0x3b3fb3){return _0x1e549b===_0x3b3fb3;},'NBSvY':_0x465cff(-0x1b2,-0x200,-0x1d1,-0x226)};if(!_0x563f05)return _0x563f05;let _0x59cda6=_0x563f05;function _0x1808a0(_0x1a40e6,_0x126774,_0xc4aba2,_0x4375b3){return _0x233a(_0x4375b3- -0x2c4,_0x1a40e6);}return _0x59cda6=_0x59cda6[_0x465cff(-0x1a2,-0x1ba,-0x1e6,-0x216)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x26b408,_0x3a1944,_0x3bbd92)=>{const _0x33a427={'QqadA':_0x2886b2['IQuVl'],'MkQOS':function(_0x426d01,_0x8a4886){return _0x426d01===_0x8a4886;},'DKCqS':function(_0x5aa31c,_0x2bac03,_0x589dba,_0x21e1ef){function _0x5543a1(_0x5edd5d,_0x1fb52e,_0x4ef3ba,_0x499c07){return _0x233a(_0x4ef3ba-0x164,_0x499c07);}return _0x2886b2[_0x5543a1(0x2be,0x2ff,0x2cd,0x301)](_0x5aa31c,_0x2bac03,_0x589dba,_0x21e1ef);}};function _0x2ea932(_0x516504,_0x44e498,_0x3609a2,_0x374d61){return _0x1808a0(_0x374d61,_0x44e498-0x1ed,_0x3609a2-0x1d1,_0x516504-0x1b8);}function _0x1a720c(_0x223bf7,_0x6a8ef7,_0x5c27be,_0x2985b5){return _0x465cff(_0x223bf7-0x146,_0x6a8ef7-0x105,_0x2985b5-0x54b,_0x6a8ef7);}if(_0x2886b2[_0x1a720c(0x2e9,0x302,0x303,0x33a)](_0x2886b2['zwGVl'],_0x1a720c(0x36e,0x318,0x35d,0x349)))return _0x2812f1['map'](_0x32d352=>{function _0x387bbc(_0x2da7cf,_0x179ce5,_0x18dd3c,_0xdf253f){return _0x1a720c(_0x2da7cf-0xcf,_0x2da7cf,_0x18dd3c-0xce,_0x179ce5-0xa6);}function _0x25c2e7(_0x5d941e,_0x5bee00,_0x362580,_0x30ee84){return _0x2ea932(_0x5bee00- -0xb9,_0x5bee00-0x1c4,_0x362580-0x179,_0x362580);}if(_0x32d352&&_0x32d352[_0x25c2e7(-0x7a,-0x41,-0x51,-0x71)]===_0x33a427[_0x387bbc(0x3da,0x3b7,0x386,0x365)]&&_0x33a427[_0x387bbc(0x3cc,0x397,0x3e1,0x3c4)](typeof _0x32d352[_0x387bbc(0x394,0x3dc,0x3ae,0x388)],_0x387bbc(0x413,0x41b,0x3e0,0x439)))return{..._0x32d352,'text':_0x33a427[_0x387bbc(0x3e1,0x3cf,0x3f2,0x3aa)](_0x49e12d,_0x32d352[_0x25c2e7(-0x40,-0x29,-0x27,0x13)],_0x25c9ca,_0x48772f)};return _0x32d352;});else{const _0x1eed28=_0x3a1944[_0x2ea932(0xc9,0xc4,0x10f,0x76)]();return _0x365d4b[_0x1a720c(0x338,0x2ba,0x313,0x2fd)+'ta'][_0x1a720c(0x33a,0x394,0x32d,0x35c)][_0x1eed28]=_0x3bbd92,_0x43c091&&_0x43c091[_0x1a720c(0x335,0x30c,0x331,0x344)]('{@setvar::'+_0x1eed28+'@}'),'';}}),_0x59cda6=_0x59cda6['replace'](/\{@getvar::([^@]+)@\}/g,(_0x5e65ba,_0x2055fb)=>{function _0x9fc20b(_0x16113b,_0x40c92f,_0x3201eb,_0xdb588c){return _0x1808a0(_0x16113b,_0x40c92f-0x19b,_0x3201eb-0x17d,_0xdb588c- -0x85);}function _0x5c7e9c(_0x535eb5,_0x67cf54,_0x30e310,_0x285eec){return _0x465cff(_0x535eb5-0x5,_0x67cf54-0x13b,_0x535eb5-0x705,_0x30e310);}if(_0x2886b2[_0x5c7e9c(0x4f4,0x4d1,0x4f7,0x4d1)](_0x5c7e9c(0x4f5,0x4b1,0x532,0x51e),_0x9fc20b(-0x1f4,-0x18e,-0x16a,-0x1a8))){if(_0x513dd7[_0x5c7e9c(0x4af,0x46e,0x4df,0x47d)]&&_0x55b612[_0x9fc20b(-0x203,-0x1fe,-0x219,-0x1ee)][_0x9fc20b(-0x194,-0x15b,-0x14a,-0x174)]()!==''){const _0x2d8493={};_0x2d8493['role']=_0x2886b2['tzjwO'],_0x2d8493['content']=_0x3dc5ef[_0x9fc20b(-0x227,-0x1be,-0x1af,-0x1ee)],_0x56bd81[_0x5c7e9c(0x4d9,0x4e8,0x49f,0x4db)](_0x2d8493);}if(_0x4652e1[_0x9fc20b(-0x19e,-0x199,-0x1b6,-0x1d9)]&&_0x2886b2[_0x9fc20b(-0x171,-0x1f7,-0x1ca,-0x1a9)](_0x405208[_0x9fc20b(-0x211,-0x1ea,-0x22e,-0x1d9)][_0x5c7e9c(0x529,0x57e,0x55a,0x53a)](),'')){const _0x3bdb06={};_0x3bdb06['role']=_0x2886b2[_0x5c7e9c(0x4c0,0x46e,0x46d,0x4aa)],_0x3bdb06['content']=_0x4e3c07[_0x5c7e9c(0x4c4,0x4a2,0x484,0x485)],_0x203117[_0x9fc20b(-0x1ab,-0x1cb,-0x189,-0x1c4)](_0x3bdb06);}}else{const _0x31c6b4=_0x2055fb[_0x5c7e9c(0x529,0x52c,0x53d,0x4f6)](),_0x28a927=_0x365d4b[_0x5c7e9c(0x4b7,0x47a,0x48e,0x4e0)+'ta']['variables'][_0x31c6b4]||'';return _0x43c091&&_0x43c091[_0x5c7e9c(0x4fe,0x4ce,0x539,0x528)](_0x5c7e9c(0x4f9,0x4bd,0x51d,0x4cf)+_0x31c6b4+'@}'),_0x28a927;}}),_0x59cda6=_0x59cda6['replace'](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x23d89d,_0x46f644,_0x1ac9df)=>{function _0x23fa69(_0x31ab1a,_0x5d4a2b,_0x453a62,_0x271a2c){return _0x465cff(_0x31ab1a-0x1d8,_0x5d4a2b-0x25,_0x5d4a2b-0x1b4,_0x271a2c);}function _0x296ff8(_0x3f24f1,_0x27d88c,_0x5d1877,_0x2ce636){return _0x1808a0(_0x3f24f1,_0x27d88c-0x3f,_0x5d1877-0x113,_0x2ce636-0x79);}if(_0x2886b2[_0x23fa69(-0x45,-0x25,0x15,-0x7a)]!==_0x2886b2['EoseL']){const _0x471875=_0x46f644[_0x296ff8(-0x9b,-0xb9,-0x21,-0x76)]();return _0x2886b2[_0x296ff8(-0x3a,-0xae,-0x96,-0x7d)](setglobalvar,_0x471875,_0x1ac9df),_0x43c091&&(_0x2886b2['khQre'](_0x2886b2[_0x23fa69(-0x47,-0x55,-0x47,-0xa9)],_0x23fa69(-0xa8,-0x83,-0xcb,-0xa3))?_0x43c091[_0x23fa69(-0x21,-0x53,-0x53,-0x2b)](_0x296ff8(-0x138,-0x96,-0xb5,-0xe9)+_0x296ff8(-0x74,-0x76,-0xcc,-0x7c)+_0x471875+'@}'):_0x31db22[_0x296ff8(-0x83,-0xb8,-0x100,-0xc6)](_0x52fd3a)),'';}else _0x2f6988[_0x23fa69(-0x7e,-0x53,-0x65,-0x11)]('{@getworld'+'var::'+_0x5b5a71+'@}');}),_0x59cda6=_0x59cda6['replace'](/\{@getglobalvar::([^@]+)@\}/g,(_0x1002ae,_0x865863)=>{function _0x2e29c7(_0x78b285,_0x5644c8,_0x46c4b4,_0x4e93f9){return _0x465cff(_0x78b285-0x166,_0x5644c8-0x1ca,_0x78b285-0x17f,_0x4e93f9);}function _0x52b7a5(_0x413f30,_0x596e80,_0x10965a,_0x5dc029){return _0x465cff(_0x413f30-0x1cd,_0x596e80-0xd6,_0x5dc029-0x2c6,_0x596e80);}if(_0x52b7a5(0x9e,0xed,0x8a,0xa5)!==_0x2886b2[_0x2e29c7(-0x5b,-0x7d,-0x99,-0x17)])_0x334dde['add'](_0x2e29c7(-0xd0,-0x91,-0x119,-0xce)+_0x52b7a5(0xc2,0x11f,0x102,0xe4)+_0x29a0df+'@}');else{const _0x5b6573=_0x865863[_0x2e29c7(-0x5d,-0x4b,-0x52,-0x27)](),_0x1c4543=_0x2886b2[_0x52b7a5(0xd7,0x10c,0xf3,0xdc)](getglobalvar,_0x5b6573)||'';return _0x43c091&&_0x43c091['add'](_0x52b7a5(0x136,0xad,0x107,0xf1)+_0x52b7a5(0x117,0xbd,0xc9,0xe4)+_0x5b6573+'@}'),_0x1c4543;}}),_0x59cda6=_0x59cda6[_0x465cff(-0x209,-0x216,-0x1e6,-0x1c5)](/\{@getworldvar::([^@]+)@\}/g,(_0x233eb7,_0x19e55a)=>{const _0x51a72e={'eiBJm':function(_0x526184,_0x512336){function _0x585826(_0xbb1ec,_0x3d4ea0,_0x3a27cb,_0x668426){return _0x233a(_0x668426- -0x35e,_0xbb1ec);}return _0x2886b2[_0x585826(-0x1f0,-0x213,-0x1aa,-0x1f4)](_0x526184,_0x512336);}},_0x300d53=_0x19e55a[_0x527c18(0x55f,0x56a,0x54d,0x52e)](),_0x55564b=_0x2886b2[_0x25f11c(0x34d,0x32c,0x31c,0x36c)](getworldvar,_0x300d53)||'';if(_0x43c091){if(_0x2886b2[_0x527c18(0x4fc,0x52a,0x4d5,0x4b5)](_0x2886b2[_0x527c18(0x53d,0x55d,0x56b,0x592)],_0x527c18(0x543,0x4fe,0x50e,0x576))){const _0xd607e2=_0x7f6520['trim'](),_0x563d66=_0x51a72e[_0x25f11c(0x36d,0x376,0x32b,0x362)](_0x374c02,_0xd607e2)||'';return _0x583e08&&_0x88fed1[_0x25f11c(0x38d,0x3c6,0x3d3,0x39e)]('{@getgloba'+_0x527c18(0x559,0x58c,0x56d,0x55e)+_0xd607e2+'@}'),_0x563d66;}else _0x43c091[_0x25f11c(0x38d,0x39d,0x395,0x353)](_0x527c18(0x4dd,0x4a6,0x4fc,0x48d)+_0x25f11c(0x3c0,0x3fe,0x3c4,0x3e8)+_0x300d53+'@}');}function _0x527c18(_0x5034da,_0x52111b,_0x520d18,_0xa5a81b){return _0x1808a0(_0x520d18,_0x52111b-0xa8,_0x520d18-0x164,_0x5034da-0x64e);}function _0x25f11c(_0x5ee0e0,_0xd9179b,_0x5925ba,_0x599a09){return _0x465cff(_0x5ee0e0-0x8e,_0xd9179b-0x194,_0x5ee0e0-0x594,_0x5925ba);}return _0x55564b;}),_0x59cda6;}export function buildPromptWithTrigger(_0x4a0717){function _0x57d3d6(_0x1c1455,_0x54101c,_0x555c44,_0x18579f){return _0x233a(_0x1c1455- -0x6a,_0x555c44);}const _0x5edaad={'zooUu':function(_0x24c80e,_0x5f21ae){return _0x24c80e!==_0x5f21ae;},'QwRiD':_0x57d3d6(0xf1,0xad,0xdb,0x132),'JlRdE':_0x57d3d6(0x106,0xe0,0xff,0x150),'KdMLR':function(_0x4640f8,_0x55b6e6){return _0x4640f8===_0x55b6e6;},'jlCaS':function(_0x543b1d,_0x3601b0){return _0x543b1d===_0x3601b0;},'jbAEp':'trigger','rHUil':_0x57d3d6(0x15b,0x160,0x16d,0x158),'uuUbN':function(_0x5365db,_0x683591,_0x324032){return _0x5365db(_0x683591,_0x324032);},'Vbpch':function(_0x7aec0f,_0x24ac2d){return _0x7aec0f!==_0x24ac2d;},'CAhdh':_0x57d3d6(0xfb,0xaa,0x126,0xdb),'tsBkB':'LaOXo','nlJNy':function(_0x37cd56,_0x252c3b){return _0x37cd56(_0x252c3b);}},{requestType:_0x3fd7d1,contextData:_0x123440}=_0x4a0717,_0x709819=extension_settings[extensionName]?.['llm_reques'+'t_type_con'+'figs']||{},_0x14ca4c={};_0x14ca4c[_0x57d3d6(0x138,0xf6,0x126,0x10c)+_0x2f7ae3(0x255,0x258,0x281,0x29c)]='默认';const _0x14e833=_0x709819[_0x3fd7d1]||_0x14ca4c,_0x1479d4=_0x14e833[_0x57d3d6(0x138,0x15d,0x187,0xed)+_0x2f7ae3(0x2b3,0x22f,0x281,0x2d5)]||'默认';function _0x2f7ae3(_0x2342a8,_0x5ec113,_0x3b47de,_0x46c41d){return _0x233a(_0x3b47de-0xb0,_0x46c41d);}const _0xeacdcc=extension_settings[extensionName]?.[_0x2f7ae3(0x201,0x24b,0x225,0x248)+_0x57d3d6(0x17c,0x1a7,0x133,0x183)+'s']||{},_0x11e3a6=_0xeacdcc[_0x1479d4]||_0xeacdcc[Object[_0x2f7ae3(0x269,0x25b,0x298,0x2d4)](_0xeacdcc)[0xc85*0x2+-0x2*0xba7+-0x1bc]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x123440,_0x35ee49=[userDemand,context,body,worldBookContent]['filter'](Boolean)[_0x57d3d6(0x168,0x114,0x1ad,0x177)]('\x0a'),_0x8dcd12=[];if(_0x11e3a6['entries']&&Array[_0x2f7ae3(0x27c,0x286,0x237,0x266)](_0x11e3a6[_0x57d3d6(0xf5,0x125,0x109,0xbf)]))for(const _0x56e9b3 of _0x11e3a6['entries']){if(!_0x56e9b3[_0x2f7ae3(0x238,0x240,0x226,0x23c)])continue;if(!_0x56e9b3[_0x2f7ae3(0x23c,0x262,0x249,0x205)]||_0x5edaad[_0x57d3d6(0x12e,0x10c,0x177,0x176)](_0x56e9b3[_0x2f7ae3(0x250,0x265,0x249,0x25a)]['trim'](),''))continue;if(_0x5edaad[_0x2f7ae3(0x1df,0x1f7,0x205,0x214)](_0x56e9b3[_0x2f7ae3(0x275,0x288,0x257,0x233)+'e'],_0x5edaad['jbAEp'])){if(_0x57d3d6(0x185,0x173,0x142,0x19b)!==_0x5edaad[_0x57d3d6(0xec,0xbb,0x140,0x121)]){if(!_0x5edaad['uuUbN'](checkTriggerWords,_0x56e9b3[_0x57d3d6(0x17a,0x163,0x170,0x195)+'ds'],_0x35ee49))continue;}else for(const _0x5b2a6c of _0x49196c[_0x57d3d6(0x16a,0x18f,0x115,0x132)]){if(_0x5b2a6c[_0x57d3d6(0xf1,0x13d,0xab,0x129)]&&_0x5edaad[_0x57d3d6(0x13c,0x18c,0x144,0x167)](_0x5b2a6c[_0x57d3d6(0xf1,0xd0,0xbe,0xa2)][_0x2f7ae3(0x289,0x254,0x285,0x23d)](),'')){const _0x136063={};_0x136063[_0x2f7ae3(0x1d6,0x1e5,0x208,0x1e3)]=_0x5edaad['QwRiD'],_0x136063[_0x57d3d6(0x12f,0x17e,0x146,0x114)]=_0x5b2a6c['user'],_0x9988d1[_0x57d3d6(0x11b,0x111,0x144,0x150)](_0x136063);}if(_0x5b2a6c[_0x57d3d6(0x106,0x159,0x127,0xf7)]&&_0x5edaad['zooUu'](_0x5b2a6c[_0x2f7ae3(0x202,0x246,0x220,0x247)][_0x2f7ae3(0x250,0x2a2,0x285,0x25b)](),'')){const _0x3ce89f={};_0x3ce89f[_0x57d3d6(0xee,0xd3,0xa4,0xf7)]=_0x5edaad[_0x57d3d6(0x162,0x1a9,0x114,0x1aa)],_0x3ce89f[_0x57d3d6(0x12f,0x17f,0xe9,0x110)]=_0x5b2a6c[_0x57d3d6(0x106,0xbb,0x157,0x151)],_0x266f41['push'](_0x3ce89f);}}}const _0x38a909={};_0x38a909[_0x2f7ae3(0x207,0x221,0x208,0x1c6)]=_0x56e9b3[_0x57d3d6(0xee,0xdd,0xf7,0x110)]||_0x5edaad[_0x2f7ae3(0x200,0x26e,0x223,0x218)],_0x38a909[_0x57d3d6(0x12f,0x15c,0x113,0x122)]=_0x56e9b3[_0x57d3d6(0x12f,0x154,0x170,0x154)],_0x8dcd12['push'](_0x38a909);}else{if(_0x11e3a6[_0x57d3d6(0x16a,0x1b0,0x116,0x140)]&&Array[_0x2f7ae3(0x20b,0x276,0x237,0x211)](_0x11e3a6[_0x57d3d6(0x16a,0x157,0x1be,0x1a2)])){if(_0x5edaad[_0x2f7ae3(0x212,0x239,0x22c,0x1e6)](_0x57d3d6(0xfb,0xc0,0xc6,0xfa),_0x5edaad[_0x57d3d6(0x156,0x173,0x14c,0x17c)]))return[];else for(const _0x8d669d of _0x11e3a6[_0x57d3d6(0x16a,0x185,0x152,0x13d)]){if(_0x5edaad[_0x2f7ae3(0x21e,0x1c8,0x1fb,0x21c)]===_0x5edaad[_0x2f7ae3(0x238,0x24f,0x1fb,0x244)]){if(_0x8d669d['user']&&_0x8d669d[_0x57d3d6(0xf1,0xa0,0x12a,0xc0)][_0x2f7ae3(0x2a6,0x274,0x285,0x2ae)]()!==''){const _0x1502e3={};_0x1502e3[_0x2f7ae3(0x1f9,0x252,0x208,0x231)]=_0x5edaad[_0x57d3d6(0x109,0xe5,0xbd,0x12a)],_0x1502e3[_0x57d3d6(0x12f,0x14c,0x176,0xdd)]=_0x8d669d['user'],_0x8dcd12[_0x2f7ae3(0x27a,0x1f8,0x235,0x254)](_0x1502e3);}if(_0x8d669d[_0x57d3d6(0x106,0x12f,0xfb,0xb1)]&&_0x5edaad[_0x2f7ae3(0x21d,0x214,0x256,0x204)](_0x8d669d['assistant'][_0x2f7ae3(0x258,0x275,0x285,0x24f)](),'')){const _0x3ec8c6={};_0x3ec8c6[_0x57d3d6(0xee,0xc4,0x140,0xc1)]=_0x5edaad[_0x57d3d6(0x162,0x144,0x16d,0x140)],_0x3ec8c6[_0x57d3d6(0x12f,0xed,0x171,0x144)]=_0x8d669d['assistant'],_0x8dcd12[_0x2f7ae3(0x266,0x1e0,0x235,0x27e)](_0x3ec8c6);}}else{const _0x13d7c8={};_0x13d7c8['role']='user',_0x13d7c8['content']=_0x44a05a['user'],_0x205b09['push'](_0x13d7c8);}}}}const _0xb34b67=_0x5edaad['nlJNy'](mergeAdjacentMessages,_0x8dcd12),{messages:_0x165d64,replacedVariables:_0x10f042}=_0x5edaad['uuUbN'](replaceAllPlaceholders,_0xb34b67,_0x123440);return _0x165d64;}function _0x233a(_0x31b95e,_0x1e148e){_0x31b95e=_0x31b95e-(-0xe*-0x1f3+-0x23fb+0x9f8);const _0x2421c0=_0x2cc4();let _0x50fb8c=_0x2421c0[_0x31b95e];if(_0x233a['rNZUKJ']===undefined){var _0x4501ef=function(_0x3e2e44){const _0x36f6ac='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4fc544='',_0x100148='',_0x3a2a20=_0x4fc544+_0x4501ef;for(let _0x5a5ee1=-0xa35+0xbc3*0x3+-0xa*0x282,_0x5f0b47,_0x1691cc,_0x4053e1=-0x1432+-0x1*-0x507+0xf2b;_0x1691cc=_0x3e2e44['charAt'](_0x4053e1++);~_0x1691cc&&(_0x5f0b47=_0x5a5ee1%(0x1bc9+0xd*-0x2b0+-0x5*-0x16f)?_0x5f0b47*(0x21ea+-0x1*-0x695+-0x283f)+_0x1691cc:_0x1691cc,_0x5a5ee1++%(0x1bc0+0x1*0x1999+-0x7b*0x6f))?_0x4fc544+=_0x3a2a20['charCodeAt'](_0x4053e1+(-0x1481+-0xca*-0x1f+-0x1*0x3eb))-(-0x2182*0x1+0x8ed+-0x21*-0xbf)!==-0x1999*0x1+-0x7db*0x2+0x294f?String['fromCharCode'](-0x16*-0x14b+-0x5a*-0x1+-0x1bcd&_0x5f0b47>>(-(-0x59b*-0x5+0x1a9f+-0x36a4)*_0x5a5ee1&0x22af+-0x15*0x159+-0x65c)):_0x5a5ee1:-0x4b1*-0x2+-0x217+-0x74b){_0x1691cc=_0x36f6ac['indexOf'](_0x1691cc);}for(let _0x5bba97=-0x66*0x4b+-0x313*0x3+0x271b,_0x312cb4=_0x4fc544['length'];_0x5bba97<_0x312cb4;_0x5bba97++){_0x100148+='%'+('00'+_0x4fc544['charCodeAt'](_0x5bba97)['toString'](0x23be+-0xae4*0x2+-0x6*0x251))['slice'](-(0x1742+-0x582*-0x2+-0x2244));}return decodeURIComponent(_0x100148);};_0x233a['odKkxP']=_0x4501ef,_0x233a['rXltce']={},_0x233a['rNZUKJ']=!![];}const _0x141b6d=_0x2421c0[-0x2241+0x10f3+-0x5*-0x376],_0x36bc47=_0x31b95e+_0x141b6d,_0xb780c2=_0x233a['rXltce'][_0x36bc47];if(!_0xb780c2){const _0x538c15=function(_0x3f7059){this['GWXcyN']=_0x3f7059,this['pWGsFr']=[-0x22dc+0x2f*0x7a+0xc77,0x11d*-0x10+0xe9*-0x1c+0x146*0x22,0x1a79+-0x4*0xa3+-0x17ed],this['xPwBWE']=function(){return'newState';},this['nfEjZd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ItIrOE']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x538c15['prototype']['bEDJAe']=function(){const _0x524a50=new RegExp(this['nfEjZd']+this['ItIrOE']),_0x13410f=_0x524a50['test'](this['xPwBWE']['toString']())?--this['pWGsFr'][-0x1b73+0x1adb*0x1+0x99]:--this['pWGsFr'][-0xb*-0x338+-0x2104+-0x264];return this['dcKGEE'](_0x13410f);},_0x538c15['prototype']['dcKGEE']=function(_0x3ac566){if(!Boolean(~_0x3ac566))return _0x3ac566;return this['kNkeKD'](this['GWXcyN']);},_0x538c15['prototype']['kNkeKD']=function(_0x3d55bf){for(let _0x281c06=0x126e+0x85*-0x8+-0xe46,_0x36ac5b=this['pWGsFr']['length'];_0x281c06<_0x36ac5b;_0x281c06++){this['pWGsFr']['push'](Math['round'](Math['random']())),_0x36ac5b=this['pWGsFr']['length'];}return _0x3d55bf(this['pWGsFr'][-0x231a+-0x1d74+-0x408e*-0x1]);},new _0x538c15(_0x233a)['bEDJAe'](),_0x50fb8c=_0x233a['odKkxP'](_0x50fb8c),_0x233a['rXltce'][_0x36bc47]=_0x50fb8c;}else _0x50fb8c=_0xb780c2;return _0x50fb8c;}export function getProcessedPrompt(_0x5ca60c,_0x124f50){function _0x46b190(_0x456926,_0x3ecd49,_0x3ea6ac,_0x26edd5){return _0x233a(_0x3ea6ac- -0x26a,_0x26edd5);}const _0x4ff0d0={'raSnk':function(_0x2042ea,_0x304a61){return _0x2042ea(_0x304a61);}},_0x499c8e={};_0x499c8e[_0x45fe30(0x53b,0x578,0x56f,0x551)+'e']=_0x5ca60c,_0x499c8e[_0x45fe30(0x52a,0x4eb,0x547,0x53f)+'a']=_0x124f50;function _0x45fe30(_0x56ca16,_0x42415a,_0x51f1d7,_0x3adf8c){return _0x233a(_0x56ca16-0x3db,_0x51f1d7);}return _0x4ff0d0['raSnk'](buildPromptWithTrigger,_0x499c8e);}