(function(_0x428234,_0x48006b){function _0x2eeae8(_0x10d6cb,_0x8dd861,_0x3e8eda,_0x4e26c6){return _0x17c5(_0x4e26c6- -0x5c,_0x10d6cb);}const _0x2aaa6d=_0x428234();function _0x4f9397(_0x55ad37,_0x57b0a2,_0x3de063,_0xba5e21){return _0x17c5(_0xba5e21-0x1e6,_0x55ad37);}while(!![]){try{const _0x1ac1ef=parseInt(_0x4f9397(0x398,0x319,0x39d,0x352))/(0x1817*-0x1+-0x2621+-0x1*-0x3e39)*(-parseInt(_0x4f9397(0x308,0x294,0x2b1,0x2e3))/(-0x3*0x347+-0x9f4+0x13cb))+-parseInt(_0x2eeae8(0xf1,0xdc,0x123,0xe8))/(0x2380+-0x1*0x6d5+-0xe*0x20c)+-parseInt(_0x4f9397(0x2cf,0x325,0x307,0x300))/(0x2015*0x1+0x1c9+-0x21da)+-parseInt(_0x2eeae8(0xad,0xab,0x82,0xbc))/(0xfd*0x25+-0x16d1+-0xdbb)*(-parseInt(_0x2eeae8(0x107,0xdb,0xe0,0x10c))/(-0x1e2d+0x21a7+0x11*-0x34))+parseInt(_0x2eeae8(0xff,0xbb,0xae,0xce))/(0x5*-0x337+-0x85b*0x4+0x3186)+-parseInt(_0x2eeae8(0xe6,0xb3,0x101,0xc6))/(-0xb89+-0x106*0x26+0x3275)+parseInt(_0x2eeae8(0xd6,0x71,0x6f,0x9f))/(0xc51+-0x1*-0x1fcd+-0x2c15)*(parseInt(_0x4f9397(0x345,0x369,0x378,0x353))/(0x1*-0x11+0xc4a+-0xc2f));if(_0x1ac1ef===_0x48006b)break;else _0x2aaa6d['push'](_0x2aaa6d['shift']());}catch(_0x41d4bd){_0x2aaa6d['push'](_0x2aaa6d['shift']());}}}(_0x266e,0x13c1a1*-0x1+-0x3*-0x8a037+0x86e3f));const _0x48f99b=(function(){const _0xec8f={};function _0x353f84(_0x3a5367,_0x2bb0e0,_0x5a482e,_0x3c3144){return _0x17c5(_0x3a5367-0xd8,_0x3c3144);}_0xec8f[_0x5ec832(0xf4,0xd0,0x123,0x14b)]=function(_0x38a788,_0x61146e){return _0x38a788!==_0x61146e;},_0xec8f[_0x353f84(0x24e,0x27b,0x221,0x2a4)]='OQfdw',_0xec8f[_0x353f84(0x1fd,0x1db,0x251,0x23c)]=_0x5ec832(0xf7,0xc0,0xa2,0xc7);const _0x13a825=_0xec8f;function _0x5ec832(_0xc22c10,_0x3dd900,_0x1a6a9f,_0x5e0ac3){return _0x17c5(_0xc22c10- -0x3,_0x5e0ac3);}let _0x5bb454=!![];return function(_0x39ab8b,_0x9465b4){function _0x23a683(_0x103c34,_0x5d1fa1,_0xce67e3,_0x50f7d3){return _0x5ec832(_0xce67e3-0x38f,_0x5d1fa1-0x193,_0xce67e3-0x47,_0x103c34);}const _0x4c5464={'gAkUm':function(_0x29390a,_0x14dd2f){function _0x42ee1a(_0x4e2421,_0x43b5d5,_0x171a17,_0x3f940d){return _0x17c5(_0x3f940d- -0x7b,_0x43b5d5);}return _0x13a825[_0x42ee1a(0x65,0x49,0x2b,0x7c)](_0x29390a,_0x14dd2f);},'dxWeB':_0x13a825[_0x23a683(0x53f,0x519,0x502,0x554)],'nYfEx':_0x13a825['dGNeZ']},_0x5967b8=_0x5bb454?function(){function _0x5c782f(_0x1dfbec,_0x521e7a,_0x580036,_0x341dae){return _0x23a683(_0x341dae,_0x521e7a-0x173,_0x1dfbec-0x57,_0x341dae-0xb9);}function _0x46b349(_0x30d690,_0x3aa3a6,_0xd10113,_0xd7e7e1){return _0x23a683(_0x3aa3a6,_0x3aa3a6-0xef,_0x30d690- -0x1f3,_0xd7e7e1-0x143);}if(_0x4c5464[_0x5c782f(0x552,0x500,0x519,0x57e)](_0x4c5464[_0x5c782f(0x4d0,0x514,0x4eb,0x505)],_0x4c5464[_0x46b349(0x26f,0x2a2,0x21a,0x237)])){if(_0x9465b4){const _0x12af30=_0x9465b4[_0x46b349(0x2c8,0x298,0x323,0x317)](_0x39ab8b,arguments);return _0x9465b4=null,_0x12af30;}}else _0x5aaae1['chatMetada'+'ta'][_0x5c782f(0x54c,0x524,0x4f7,0x50f)]={};}:function(){};return _0x5bb454=![],_0x5967b8;};}()),_0x5e2c1c=_0x48f99b(this,function(){function _0x2e88fa(_0x20c67c,_0x51f32a,_0x3a3e2f,_0x196221){return _0x17c5(_0x196221-0xc0,_0x3a3e2f);}function _0x3d72af(_0x25bde5,_0xe65111,_0x397acf,_0x55b5ff){return _0x17c5(_0x25bde5- -0x23e,_0x397acf);}return _0x5e2c1c[_0x3d72af(-0xe4,-0xae,-0x90,-0x108)]()[_0x2e88fa(0x1dd,0x1e1,0x1e2,0x221)](_0x2e88fa(0x18b,0x1d7,0x1de,0x1cd)+'+$')['toString']()[_0x2e88fa(0x152,0x155,0x183,0x1aa)+'r'](_0x5e2c1c)[_0x3d72af(-0xdd,-0xc1,-0x127,-0x10d)](_0x2e88fa(0x19f,0x1df,0x1b4,0x1cd)+'+$');});_0x5e2c1c();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x33debc,_0x3773f3){const _0x47e7db={'czRZA':function(_0x4af4b2,_0x273897,_0x1c167e,_0x32e0f6,_0x53caa6){return _0x4af4b2(_0x273897,_0x1c167e,_0x32e0f6,_0x53caa6);},'ZTOcx':function(_0x5e9fd9,_0x582dcf){return _0x5e9fd9||_0x582dcf;},'OyFbK':function(_0x28a5cf,_0x1b35f0){return _0x28a5cf!==_0x1b35f0;},'UcPSz':_0x55fd15(0x422,0x40c,0x45d,0x3d4),'iiWjE':_0x3bbc7f(-0x3d,-0x87,-0x65,-0x52)};if(_0x47e7db['ZTOcx'](!_0x33debc,!_0x3773f3))return![];function _0x3bbc7f(_0x2431f6,_0x14351a,_0x2d296d,_0x13189c){return _0x17c5(_0x13189c- -0x1b5,_0x14351a);}const _0x3f23a3=_0x33debc[_0x3bbc7f(-0x10e,-0xb3,-0xfb,-0xdc)](',')[_0x3bbc7f(-0xc1,-0x1a,-0x9d,-0x67)](_0x45ad31=>_0x45ad31['trim']())[_0x3bbc7f(-0x57,-0x54,-0x40,-0x7c)](_0x3706a1=>_0x3706a1);if(_0x3f23a3[_0x55fd15(0x4ab,0x467,0x4b8,0x484)]===0x5*0x551+0x21*0x81+-0x159b*0x2)return![];function _0x55fd15(_0x568eaa,_0xb26326,_0x15cb6f,_0x57f1af){return _0x17c5(_0xb26326-0x30b,_0x568eaa);}for(const _0x125446 of _0x3f23a3){if(_0x47e7db[_0x3bbc7f(-0x96,-0x35,-0x75,-0x75)](_0x47e7db['UcPSz'],_0x47e7db['iiWjE'])){if(_0x3773f3['includes'](_0x125446))return!![];}else{const _0x10a866=/\{\{getvar::([^}]+)\}\}/g,_0x4d20c2=_0x5362af['stringify'](_0x7f0950),_0x1fa363=[..._0x4d20c2[_0x3bbc7f(-0x6,-0x6,-0xa1,-0x4f)](_0x10a866)],_0x2fb593=new _0xd7d738();for(const _0x2ce62b of _0x1fa363){_0x2fb593[_0x55fd15(0x421,0x43f,0x40e,0x46a)](_0x2ce62b[-0x23b2+-0x19*-0x117+0x4*0x21d]);}for(const _0x56dc19 of _0x2fb593){const _0xab1eb4=_0x55fd15(0x4a3,0x464,0x4be,0x459)+_0x56dc19+'}}',_0x10a55f=_0x3cbc8d[_0x56dc19]||'';_0x4be134=_0x47e7db[_0x3bbc7f(-0x5d,-0x21,-0xa8,-0x7b)](_0x409ca0,_0x18345a,_0xab1eb4,_0x10a55f,_0x5ea9de);}}}return![];}export function mergeAdjacentMessages(_0x336a98){const _0x35fe5a={'hQOzW':function(_0x5227ed,_0x20e7a2,_0x89c497,_0x3605c9,_0x49db3c){return _0x5227ed(_0x20e7a2,_0x89c497,_0x3605c9,_0x49db3c);},'UYQYN':function(_0x3cc169,_0x3e4918,_0x53c239,_0xd6f187){return _0x3cc169(_0x3e4918,_0x53c239,_0xd6f187);},'FAtSh':function(_0x5c06d5,_0x268e48){return _0x5c06d5===_0x268e48;},'CBxwf':_0x3cfd30(0x347,0x352,0x349,0x353),'pjfvf':_0x5ac643(-0x9c,-0xf7,-0xaf,-0xef),'epNkK':'xnxCC','RoNrp':function(_0x889fbc,_0x421c85,_0x50b5bd){return _0x889fbc(_0x421c85,_0x50b5bd);},'bjyyJ':_0x5ac643(-0x153,-0x11f,-0x178,-0x144),'mBrXL':'AkmGm'};if(!_0x336a98||_0x35fe5a[_0x5ac643(-0x149,-0x179,-0x174,-0x15d)](_0x336a98[_0x3cfd30(0x35b,0x34f,0x34a,0x338)],-0x2547+0x206*0x12+0xdb))return[];const _0x4b7ffe=[];function _0x3cfd30(_0x342b2b,_0x4f14f7,_0xf8771c,_0x1852d6){return _0x17c5(_0xf8771c-0x1ee,_0x4f14f7);}let _0x190d25=null;function _0x5ac643(_0xc33b0e,_0x2f2adf,_0xf7cd79,_0x399e09){return _0x17c5(_0x2f2adf- -0x25c,_0x399e09);}for(const _0x58e201 of _0x336a98){if(!_0x190d25){if(_0x35fe5a['CBxwf']===_0x35fe5a[_0x5ac643(-0x10d,-0x110,-0xee,-0x148)])_0x57d40b[_0x5ac643(-0xe8,-0x128,-0x11f,-0x17d)](_0x21e57a[-0x24c7+0x28e+0x223a]);else{const _0x84bada={..._0x58e201};_0x190d25=_0x84bada;}}else{if(_0x35fe5a['FAtSh'](_0x190d25[_0x3cfd30(0x2a7,0x33c,0x2e4,0x314)],_0x58e201['role']))'xnxCC'!==_0x35fe5a['epNkK']?_0x2f658c[_0x20e9bb]=_0x35fe5a[_0x3cfd30(0x2e8,0x2d6,0x2e2,0x2e7)](_0x1b4657,_0x26ff2f[_0x17348b],_0x179807,_0x336b8d,_0x20b3c5):_0x190d25['content']=_0x35fe5a[_0x5ac643(-0x13f,-0xf1,-0xa3,-0x10e)](mergeContent,_0x190d25[_0x5ac643(-0x10a,-0x125,-0x108,-0x100)],_0x58e201[_0x5ac643(-0x133,-0x125,-0xdb,-0x121)]);else{if(_0x35fe5a[_0x5ac643(-0x132,-0x179,-0x1bf,-0x1cc)](_0x35fe5a['bjyyJ'],_0x35fe5a[_0x5ac643(-0x170,-0x148,-0x127,-0x11f)]))return _0x35fe5a[_0x5ac643(-0x19a,-0x169,-0x1a4,-0x190)](_0x455a1f,_0x44a0a2,_0x1d5d2c,_0x12c6bc);else{_0x4b7ffe[_0x5ac643(-0x10a,-0x10b,-0x141,-0x13f)](_0x190d25);const _0x7888c6={..._0x58e201};_0x190d25=_0x7888c6;}}}}return _0x190d25&&_0x4b7ffe[_0x3cfd30(0x2e4,0x2ee,0x33f,0x398)](_0x190d25),_0x4b7ffe;}function mergeContent(_0x25f913,_0x50feca){function _0x51eefa(_0x3b15e8,_0x4342e9,_0x10c059,_0x3a3748){return _0x17c5(_0x10c059-0x32b,_0x3a3748);}const _0x148771={'bybMV':function(_0x4a4f73,_0x5b835d){return _0x4a4f73===_0x5b835d;},'BvrYJ':_0x641e15(0x46,0x2a,-0xe,0x1e),'YXTSp':function(_0x8e09f8,_0x3d601e){return _0x8e09f8+_0x3d601e;},'TSpjX':function(_0x450d0e,_0x55a5a4){return _0x450d0e(_0x55a5a4);},'hdMdC':function(_0x25f95a,_0x3d7741){return _0x25f95a(_0x3d7741);},'xcvCa':_0x51eefa(0x40c,0x43e,0x408,0x42b)};if(_0x148771[_0x641e15(0x2,-0xa,0x28,-0x1c)](typeof _0x25f913,_0x148771[_0x51eefa(0x449,0x440,0x40a,0x424)])&&_0x148771[_0x51eefa(0x3d4,0x420,0x411,0x3d5)](typeof _0x50feca,_0x641e15(0x8,0x15,-0x6,0x1e)))return _0x148771[_0x51eefa(0x436,0x446,0x456,0x403)](_0x148771[_0x641e15(0x6,0x2,-0x30,0x29)](_0x25f913,'\x0a'),_0x50feca);const _0x34bb84=_0x148771[_0x51eefa(0x4a5,0x469,0x4b4,0x49d)](normalizeToArray,_0x25f913),_0x182748=_0x148771['hdMdC'](normalizeToArray,_0x50feca),_0x32d630={};_0x32d630[_0x641e15(0x63,0x9a,0xd6,0x7c)]=_0x148771[_0x641e15(0x59,0x64,0x49,0x7a)],_0x32d630[_0x51eefa(0x3d8,0x427,0x408,0x3f2)]='\x0a';function _0x641e15(_0x5ef48d,_0x166310,_0x34f728,_0xe1eb11){return _0x17c5(_0xe1eb11- -0x102,_0x166310);}return[..._0x34bb84,_0x32d630,..._0x182748];}function _0x266e(){const _0x52d2f5=['AhryD04','E0bNzxr2yxi6oG','we1REe4','CevyAMK','u0fSzxO','CxfSq0q','vNbVCMC','wwPpy1e','y2HHDe1LDgfKyq','kcGOlISPkYKRkq','Efnquwi','qxfvywm','DeDtuhC','BMHYsNy','BwvZC2fNzxm','y29UDgv4Df9WCG','BujYweW','r2vIzhe','B1jODwi','B0PVC2S','mJiYmtC1uxL2yMrv','E3T1C2vYFx0','nZaXotu2ogDvDKrdBa','yND5AuG','rfvKuKe','Cw14vLm','BhzHCJO6','zgLhAw4','C3rYAw5N','EeHftLO','nZCXodCXmM9ftK5QDW','y1feruy','A290ug4','zeDozvO','B2P2C1i','wurQueG','uuPiAM8','DxfQt00','mJy5ndq0n0TqtuzJua','wvHuu3a','BxveC3a','qNzZz1m','thnMrgm','yxbWBhK','zxjNEfi','E0bZzxrNBg9Iyq','zw50CMLLCW','v1j1rLu','ywrK','Cu1NAMu','CfLsB3a','y29UDgvUDa','DKXqzhG','zMLSDgvY','y3PswKe','DgvZDf9JB250zq','q1DTEwe','ugfmEem','yMnjANG','CMvXDwvZDfr5Ca','t3LgyKS','swLcsg4','E3VKUiRKUiVMLOD9Fq','sKrOsve','mJm4mdy4m2rrEwruwG','r2Dmuvu','phvZzxi+','CMvWBgfJzq','q2TwCMi','rgzTBuq','yxnZAxn0yw50','vfP2u1q','CgPMDMy','AgLZDg9YEq','BwfW','Aw5JBhvKzxm','A2PqEvy','ChvZAa','CurYBxC','sNDizxa','sgjVy2C','uhnXuw0','Dxb2AMy','B2jQzwn0','BMfTzte','E3TNzxr2yxi6oG','Dg9tDhjPBMC','C3P6s2e','BgvUz3rO','q0DsvMy','su10CuW','AfPeqNe','E0bNzxrNBg9Iyq','C2vHCMnO','u3fiwwW','vg1MCfa','qu5vALO','qMXSwLC','Bwf0y2HbBgW','DhjPBq','nZH5r3HJufK','DMfYAwfIBgvZ','zxvlD1y','uM9oCNa','nty1mujoshvMEa','ndbsruzTAK0','BKf1sfO','z0fRvw0','svHctu0','Een3CNe','zw5HyMXLza','C1PYzKu','vuzysgu','E3VMRApMLOD9Fq','DvvpCxG','Bw9Tv1K','DhjPz2DLCG','DhjPz2DLCK1Vza','wuPbB0W','A2v5CW','Egn2q2e','r2PQrLC','DhLWzq','uLjWB2W','E0bNzxr3B3jSza','AergwNa','AxnbCNjHEq','u3PsDhm','EhrFChjVzMLSzq','B2zPBgu','CMvWBgfJzwrwyq','E0bZzxr2yxi6oG','A09Rq0W','vfnWALG','yMP4r0C','q0PYvNa','BLLMrxG','C3rYAw5NAwz5','EKHTsKC','C3bSAxq','Df90ExbLx2nVBG','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','AwXpAMG','Dgv4Da','CMLHyMXLCW','qNzYwuO','DxnLCG','yMH1rfq','BLrODwW','rKf0u2G','D253ug8','BgXTx3jLCxvLCW','yNLItvy','D05NEu0','EvfHvMG','ugf1A0C','y29UC3rYDwn0BW','CMvWBgfJzufSBa','EMv3DwO','zhHxzui','quPnz24','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','wuLRqNi','D1bYELm','tuDxsgC','vvLrwu4','AffpELC','Aw95wvK','CM9Szq','rhzAzgm','AM9PBG','E3VNLkJMIlFPNidMSyj9Fq','yvHmDxq','odqZmtu5nKHHvNHPzW','sevlBLG','odzAChzMA3y','DMfYoJO','Egn1vMy','ChP3wMW','y2HquhG','svbys2m','ywzbCfm'];_0x266e=function(){return _0x52d2f5;};return _0x266e();}function normalizeToArray(_0x5adc9f){function _0x5e2b0d(_0x215748,_0x573ec8,_0x56dd06,_0x3c4a52){return _0x17c5(_0x573ec8- -0x37c,_0x3c4a52);}function _0x5c5053(_0x509905,_0x148069,_0x1e0842,_0x21865c){return _0x17c5(_0x509905-0x27c,_0x21865c);}const _0xccf0f4={'tGSPw':function(_0x173765,_0x132af1,_0x1eff54,_0x10f19b){return _0x173765(_0x132af1,_0x1eff54,_0x10f19b);},'sZLuj':function(_0x5bf76c,_0x18def4){return _0x5bf76c===_0x18def4;},'qmxVS':function(_0x109192){return _0x109192();},'IiBHn':'GoGxo','Vporg':'text','YJAoL':function(_0x108c0d,_0x1ee54e){return _0x108c0d||_0x1ee54e;}};if(Array[_0x5c5053(0x3fe,0x3d3,0x3be,0x3ea)](_0x5adc9f)){if(_0xccf0f4[_0x5c5053(0x3bd,0x3e1,0x374,0x3e1)]===_0xccf0f4[_0x5e2b0d(-0x248,-0x23b,-0x271,-0x26c)])return _0x5adc9f;else{if(!_0x239323||_0xccf0f4['sZLuj'](_0x5ade5d['length'],-0xa*0xa5+0x2bf+0x3b3))return _0x1a0613;const _0x1ac09a=_0xccf0f4[_0x5c5053(0x399,0x396,0x3aa,0x387)](_0x4bbfc4);return!_0x1ac09a[_0x5c5053(0x388,0x38e,0x3a8,0x3c6)+'ta']&&(_0x1ac09a[_0x5c5053(0x388,0x383,0x387,0x377)+'ta']={}),!_0x1ac09a[_0x5e2b0d(-0x28c,-0x270,-0x246,-0x217)+'ta']['variables']&&(_0x1ac09a[_0x5c5053(0x388,0x368,0x365,0x32f)+'ta'][_0x5e2b0d(-0x225,-0x213,-0x1f4,-0x224)]={}),_0x49760d['map'](_0x3b73e0=>{function _0x116111(_0x2a25c6,_0x4aae6e,_0x1ea4eb,_0x25ff1a){return _0x5e2b0d(_0x2a25c6-0x71,_0x1ea4eb- -0x4c,_0x1ea4eb-0xa7,_0x2a25c6);}function _0x662e1(_0x2ec878,_0x186010,_0x1ccb28,_0x122ed3){return _0x5e2b0d(_0x2ec878-0x5a,_0x1ccb28-0x1fe,_0x1ccb28-0x53,_0x2ec878);}if(!_0x3b73e0||!_0x3b73e0[_0x116111(-0x2b7,-0x289,-0x291,-0x292)])return _0x3b73e0;return{..._0x3b73e0,'content':_0xccf0f4[_0x662e1(-0x5c,-0x8e,-0x6e,-0x44)](_0x56c546,_0x3b73e0[_0x662e1(-0x56,0xe,-0x47,-0x2b)],_0x1ac09a,_0x5c5014)};});}}return[{'type':_0xccf0f4[_0x5e2b0d(-0x280,-0x272,-0x263,-0x2b2)],'text':_0xccf0f4[_0x5e2b0d(-0x1f8,-0x202,-0x1bf,-0x218)](_0x5adc9f,'')}];}function _0x17c5(_0x479d86,_0x475ce6){_0x479d86=_0x479d86-(0x207f*0x1+-0x2*0x2db+-0x19f4);const _0xdd4bab=_0x266e();let _0x4aff84=_0xdd4bab[_0x479d86];if(_0x17c5['VfCMPc']===undefined){var _0x14d955=function(_0x3132c4){const _0x4f7e5c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x39eed6='',_0x553175='',_0x1e952c=_0x39eed6+_0x14d955;for(let _0x15a8a0=-0x246a+0x127f+0x11eb,_0x4ae37e,_0x4a718a,_0x444873=-0xe*0x12d+-0x1d5*-0x1+0xea1;_0x4a718a=_0x3132c4['charAt'](_0x444873++);~_0x4a718a&&(_0x4ae37e=_0x15a8a0%(0x629+-0x1b8d+0x1568)?_0x4ae37e*(-0x1e9*0x1+0x3*-0x4bf+0x1066)+_0x4a718a:_0x4a718a,_0x15a8a0++%(0x1462+0xebe*0x1+-0x1c*0x141))?_0x39eed6+=_0x1e952c['charCodeAt'](_0x444873+(-0x5d0*0x4+-0x23c9*0x1+0x3b13))-(0x10*-0x185+0x25e0+-0xd86)!==0x1127*0x1+0x3c5*0x3+-0x1c76?String['fromCharCode'](0x863+-0xeed+-0x3*-0x283&_0x4ae37e>>(-(-0x1e3d+0x1*0x173+-0x13*-0x184)*_0x15a8a0&0x1*0x1167+0x1764+0x15*-0x1f1)):_0x15a8a0:0x13e0+0x7db*0x3+-0x3*0xe7b){_0x4a718a=_0x4f7e5c['indexOf'](_0x4a718a);}for(let _0x5f2d6e=-0x917+-0x75*0x8+-0xfb*-0xd,_0x2293b4=_0x39eed6['length'];_0x5f2d6e<_0x2293b4;_0x5f2d6e++){_0x553175+='%'+('00'+_0x39eed6['charCodeAt'](_0x5f2d6e)['toString'](-0x19f3+0x2af*-0x1+0x1cb2))['slice'](-(0x976+-0x925*0x2+0x8d6));}return decodeURIComponent(_0x553175);};_0x17c5['ePcGsG']=_0x14d955,_0x17c5['SeEcbz']={},_0x17c5['VfCMPc']=!![];}const _0x2884f9=_0xdd4bab[-0x2621+-0x1822*-0x1+0xdff],_0x4b3655=_0x479d86+_0x2884f9,_0x5ac051=_0x17c5['SeEcbz'][_0x4b3655];if(!_0x5ac051){const _0xf6bc97=function(_0x16f91d){this['rutuzt']=_0x16f91d,this['AUdHPV']=[0x1e32+0x1ecf+-0x7a*0x80,-0x1e29*-0x1+-0x11b1+0x428*-0x3,0x4*-0x671+-0x2247+0x3c0b],this['reGitJ']=function(){return'newState';},this['DJaSqE']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['jmvaiv']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xf6bc97['prototype']['QAnbFE']=function(){const _0x43d4df=new RegExp(this['DJaSqE']+this['jmvaiv']),_0x55f99d=_0x43d4df['test'](this['reGitJ']['toString']())?--this['AUdHPV'][-0x1*-0x11d9+0xcfb+-0x1ed3*0x1]:--this['AUdHPV'][-0x11ac+-0xd79*-0x1+0x433];return this['PkUGhN'](_0x55f99d);},_0xf6bc97['prototype']['PkUGhN']=function(_0x2c243f){if(!Boolean(~_0x2c243f))return _0x2c243f;return this['LDcosb'](this['rutuzt']);},_0xf6bc97['prototype']['LDcosb']=function(_0x3e2e9f){for(let _0x2c95b4=-0x9*-0x419+-0x144a+-0x1097,_0x1ca02d=this['AUdHPV']['length'];_0x2c95b4<_0x1ca02d;_0x2c95b4++){this['AUdHPV']['push'](Math['round'](Math['random']())),_0x1ca02d=this['AUdHPV']['length'];}return _0x3e2e9f(this['AUdHPV'][-0xc5a+0x5*0x689+-0x1453]);},new _0xf6bc97(_0x17c5)['QAnbFE'](),_0x4aff84=_0x17c5['ePcGsG'](_0x4aff84),_0x17c5['SeEcbz'][_0x4b3655]=_0x4aff84;}else _0x4aff84=_0x5ac051;return _0x4aff84;}export function replacePlaceholder(_0x2bed09,_0x54c414,_0x22baa2,_0x2e28ca){const _0x2e16d0={'CJrVp':function(_0x4b8503,_0x872bc9){return _0x4b8503===_0x872bc9;},'AJMgn':_0x43a26f(-0x24b,-0x2a1,-0x256,-0x29c),'ANUjZ':'string','zHmJG':function(_0x4b3aaa,_0x20c04c,_0x341dab,_0xd3372e,_0x49ee78){return _0x4b3aaa(_0x20c04c,_0x341dab,_0xd3372e,_0x49ee78);},'xCwrq':function(_0xa7cd1a,_0x4af746){return _0xa7cd1a===_0x4af746;},'PaukG':function(_0x3df988,_0x5ea41b,_0x1dfd63,_0x11f59f){return _0x3df988(_0x5ea41b,_0x1dfd63,_0x11f59f);},'CkVrb':function(_0xbd27fd,_0x171b95){return _0xbd27fd!==_0x171b95;},'yQaVh':_0x4f4a91(0x478,0x491,0x4a5,0x4bd),'oJosk':'hLAtL','upvjf':_0x4f4a91(0x4c8,0x4df,0x4ca,0x4c5),'htXwN':function(_0x194536,_0xb196e5){return _0x194536||_0xb196e5;},'JwHep':_0x43a26f(-0x270,-0x1ea,-0x263,-0x234),'GjjFW':_0x4f4a91(0x4eb,0x4e9,0x4cf,0x4fe),'UFXHe':_0x43a26f(-0x259,-0x254,-0x273,-0x222),'OiHnp':_0x4f4a91(0x508,0x524,0x573,0x517),'nThul':'STXfR','afApS':_0x4f4a91(0x4a3,0x4da,0x500,0x498),'bwyiH':_0x43a26f(-0x218,-0x21d,-0x27b,-0x252)};if(_0x2e16d0[_0x4f4a91(0x4dd,0x486,0x46a,0x43c)](typeof _0x2bed09,_0x2e16d0[_0x4f4a91(0x54d,0x515,0x53e,0x4e3)])){if(_0x4f4a91(0x459,0x495,0x46d,0x46a)!==_0x2e16d0[_0x4f4a91(0x512,0x4c8,0x4cc,0x4dc)]){if(_0x22baa2&&_0x2bed09[_0x43a26f(-0x1fc,-0x217,-0x232,-0x22a)](_0x54c414)){if(_0x2e16d0[_0x43a26f(-0x223,-0x200,-0x1f0,-0x208)](_0x2e16d0[_0x43a26f(-0x244,-0x1d4,-0x243,-0x223)],_0x43a26f(-0x21b,-0x230,-0x270,-0x229)))return _0x25e772[_0x43a26f(-0x266,-0x200,-0x1f6,-0x22b)](_0x25ae8a=>{function _0x5e2600(_0x32fe74,_0x3fe673,_0x35abfa,_0x49f128){return _0x4f4a91(_0x32fe74-0x46,_0x32fe74- -0x53,_0x35abfa,_0x49f128-0xb0);}if(_0x25ae8a&&_0x2e16d0[_0x5e2600(0x433,0x45a,0x444,0x428)](_0x25ae8a[_0x1c3ace(-0x225,-0x230,-0x22d,-0x24a)],_0x2e16d0[_0x1c3ace(-0x2cb,-0x2e6,-0x2bd,-0x2bf)])&&_0x2e16d0[_0x1c3ace(-0x2a1,-0x297,-0x2d6,-0x32e)](typeof _0x25ae8a['text'],_0x2e16d0[_0x5e2600(0x4c2,0x4f5,0x505,0x4c7)]))return{..._0x25ae8a,'text':_0x38cdf5(_0x25ae8a[_0x5e2600(0x43b,0x48c,0x422,0x472)],_0xf67ff4,_0x42e9f8)};function _0x1c3ace(_0x29be09,_0x20574f,_0x33b752,_0x42250f){return _0x43a26f(_0x20574f,_0x20574f-0x50,_0x33b752-0x12f,_0x33b752- -0x32);}return _0x25ae8a;});else _0x2e28ca&&_0x2e28ca['add'](_0x54c414);}return _0x2bed09[_0x43a26f(-0x25c,-0x28b,-0x245,-0x28e)](_0x54c414,_0x2e16d0[_0x4f4a91(0x483,0x4b5,0x4ed,0x502)](_0x22baa2,''));}else{const _0x8c03cb={};for(const _0x55573e in _0x3b1f25){_0x8c03cb[_0x55573e]=_0x2e16d0['zHmJG'](_0x278845,_0x27a9f2[_0x55573e],_0x3a7f13,_0x3d4ee3,_0xd9e97a);}return _0x8c03cb;}}function _0x43a26f(_0x595d23,_0x53c1a8,_0x52fd8,_0x157d01){return _0x17c5(_0x157d01- -0x379,_0x595d23);}function _0x4f4a91(_0x37935d,_0x54b347,_0x160cce,_0x43e0ea){return _0x17c5(_0x54b347-0x3b1,_0x160cce);}if(Array[_0x43a26f(-0x20a,-0x1d2,-0x20b,-0x1f7)](_0x2bed09)){if(_0x2e16d0[_0x43a26f(-0x209,-0x1d0,-0x1ec,-0x226)]===_0x2e16d0[_0x4f4a91(0x57d,0x52e,0x57b,0x537)]){if(_0x12ca36&&_0x2e16d0['CJrVp'](_0x501cdf[_0x43a26f(-0x237,-0x21f,-0x1d4,-0x1fb)],_0x43a26f(-0x264,-0x2a4,-0x25d,-0x29c))&&_0x2e16d0[_0x43a26f(-0x1ee,-0x257,-0x1e1,-0x208)](typeof _0x5de42a[_0x43a26f(-0x254,-0x29b,-0x290,-0x29c)],_0x43a26f(-0x288,-0x244,-0x217,-0x259)))return{..._0x73d197,'text':_0x2e16d0[_0x4f4a91(0x49d,0x49a,0x49e,0x489)](_0x38c729,_0x26fd89[_0x43a26f(-0x2ee,-0x2bc,-0x2a5,-0x29c)],_0x2b80bd,_0x32b3fd)};return _0x1db60c;}else return _0x2bed09[_0x4f4a91(0x547,0x4ff,0x525,0x521)](_0xc31008=>replacePlaceholder(_0xc31008,_0x54c414,_0x22baa2,_0x2e28ca));}if(_0x2bed09&&typeof _0x2bed09===_0x2e16d0[_0x43a26f(-0x1b4,-0x233,-0x251,-0x205)]){if(_0x2e16d0[_0x43a26f(-0x1eb,-0x279,-0x202,-0x231)](_0x2e16d0['OiHnp'],_0x2e16d0[_0x43a26f(-0x2a0,-0x246,-0x28f,-0x297)])){const _0x581174={};for(const _0x53d1ed in _0x2bed09){if(_0x2e16d0[_0x43a26f(-0x28c,-0x25b,-0x28d,-0x2a4)](_0x2e16d0[_0x4f4a91(0x4e4,0x4b4,0x49a,0x47c)],_0x2e16d0[_0x4f4a91(0x4b9,0x4cc,0x4d8,0x4f8)]))return _0x475ce6;else _0x581174[_0x53d1ed]=_0x2e16d0[_0x4f4a91(0x471,0x489,0x45c,0x484)](replacePlaceholder,_0x2bed09[_0x53d1ed],_0x54c414,_0x22baa2,_0x2e28ca);}return _0x581174;}else{if(_0x2bc670[_0x4f4a91(0x493,0x491,0x47e,0x4be)]&&_0x2e16d0[_0x4f4a91(0x4e0,0x4f9,0x525,0x4ed)](_0x2b1702['user']['trim'](),'')){const _0x2157f2={};_0x2157f2[_0x43a26f(-0x23e,-0x278,-0x28d,-0x283)]=_0x2e16d0[_0x43a26f(-0x2c0,-0x244,-0x2d9,-0x291)],_0x2157f2[_0x4f4a91(0x538,0x4e8,0x52c,0x533)]=_0x3913a2[_0x43a26f(-0x283,-0x2b0,-0x272,-0x299)],_0x4a1aff[_0x4f4a91(0x520,0x502,0x4e1,0x551)](_0x2157f2);}if(_0x434254['assistant']&&_0x28f40e['assistant'][_0x4f4a91(0x553,0x518,0x52b,0x571)]()!==''){const _0x4893f7={};_0x4893f7[_0x43a26f(-0x24b,-0x26d,-0x229,-0x283)]=_0x43a26f(-0x21e,-0x1eb,-0x241,-0x22f),_0x4893f7[_0x4f4a91(0x4ff,0x4e8,0x51f,0x516)]=_0x108eeb[_0x43a26f(-0x276,-0x204,-0x251,-0x22f)],_0x1b4fe0[_0x4f4a91(0x4af,0x502,0x538,0x4fd)](_0x4893f7);}}}return _0x2bed09;}export function replaceAllPlaceholders(_0x575bce,_0x264500){const _0x5012c8={'PsqQm':function(_0xbad18a,_0x59d25b){return _0xbad18a===_0x59d25b;},'Gebdq':_0x2c3c9b(0x39f,0x388,0x33d,0x35f),'ergxR':_0xfb4524(0x33c,0x317,0x313,0x34d),'JwStQ':_0xfb4524(0x319,0x344,0x2fe,0x38c),'seZCT':_0xfb4524(0x362,0x340,0x359,0x376),'agnaP':'{{世界书触发}}','oRhub':_0xfb4524(0x3b3,0x373,0x381,0x3c5),'kotPn':function(_0x248c29,_0x2f016c,_0x5ae791,_0x2a19a3,_0x2df904){return _0x248c29(_0x2f016c,_0x5ae791,_0x2a19a3,_0x2df904);},'wNgyM':'{{角色启用列表}}','AqUac':_0xfb4524(0x31d,0x2d9,0x2ba,0x2a2)+'}}','gPizQ':_0x2c3c9b(0x38f,0x315,0x316,0x345)+'}}','CGRVf':function(_0x51f87c,_0x93bd5a){return _0x51f87c>_0x93bd5a;},'pzwZl':function(_0x3a7e6a,_0x44844e){return _0x3a7e6a===_0x44844e;},'ioyYY':'ojvsR','ImOlE':function(_0x2df9a7,_0x3aa929,_0xcae65f,_0x451bea,_0x2af2fd){return _0x2df9a7(_0x3aa929,_0xcae65f,_0x451bea,_0x2af2fd);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x264500,_0x356a6f=new Set();let _0x5f0db5=_0x575bce;function _0x2c3c9b(_0x1c7695,_0x13d4c9,_0x1ef48c,_0x6fdadc){return _0x17c5(_0x6fdadc-0x256,_0x1c7695);}const _0x22f282=getContext();function _0xfb4524(_0x38e353,_0x2655d9,_0x42ba3b,_0x27b081){return _0x17c5(_0x2655d9-0x1fe,_0x38e353);}const _0xf96095=_0x22f282?.[_0xfb4524(0x306,0x356,0x376,0x315)]||'';let _0x4e09e7=worldBookContent;if(_0x4e09e7){if(_0x5012c8[_0xfb4524(0x350,0x353,0x32f,0x36b)](_0x5012c8[_0xfb4524(0x2e8,0x313,0x36d,0x34f)],_0x2c3c9b(0x346,0x3ae,0x334,0x35f)))_0x4e09e7=_0x4e09e7[_0x2c3c9b(0x38a,0x31a,0x2fc,0x341)](_0x5012c8[_0x2c3c9b(0x3a8,0x3ae,0x384,0x386)],_0xf96095),_0x4e09e7=_0x4e09e7['replaceAll'](_0x5012c8['JwStQ'],_0xf96095);else return!![];}_0x5f0db5=replacePlaceholder(_0x5f0db5,_0x5012c8['seZCT'],context,_0x356a6f),_0x5f0db5=replacePlaceholder(_0x5f0db5,_0x5012c8['agnaP'],_0x4e09e7,_0x356a6f),_0x5f0db5=replacePlaceholder(_0x5f0db5,_0x5012c8[_0xfb4524(0x359,0x314,0x35d,0x334)],body,_0x356a6f),_0x5f0db5=_0x5012c8[_0x2c3c9b(0x35d,0x3cd,0x3b6,0x37a)](replacePlaceholder,_0x5f0db5,_0x5012c8[_0xfb4524(0x335,0x2e5,0x2ab,0x311)],characterListText,_0x356a6f),_0x5f0db5=_0x5012c8[_0x2c3c9b(0x341,0x36b,0x378,0x37a)](replacePlaceholder,_0x5f0db5,_0x5012c8[_0x2c3c9b(0x313,0x35e,0x326,0x365)],outfitEnableListText,_0x356a6f),_0x5f0db5=_0x5012c8[_0xfb4524(0x2e7,0x322,0x2df,0x2cd)](replacePlaceholder,_0x5f0db5,_0x5012c8['gPizQ'],commonCharacterListText,_0x356a6f),_0x5f0db5=replacePlaceholder(_0x5f0db5,_0xfb4524(0x30c,0x2f7,0x319,0x2be),userDemand,_0x356a6f);if(variables&&_0x5012c8[_0xfb4524(0x331,0x35b,0x30f,0x3af)](Object['keys'](variables)[_0xfb4524(0x37a,0x35a,0x333,0x39e)],-0xed*0xe+-0xc7d*-0x3+-0x33*0x7b)){const _0x16d363=/\{\{getvar::([^}]+)\}\}/g,_0x28350c=JSON[_0x2c3c9b(0x333,0x2e1,0x350,0x32d)](_0x5f0db5),_0x5abb2e=[..._0x28350c['matchAll'](_0x16d363)],_0x126485=new Set();for(const _0x201e57 of _0x5abb2e){if(_0x5012c8[_0x2c3c9b(0x3ad,0x343,0x338,0x356)](_0x2c3c9b(0x33b,0x3d0,0x326,0x37c),_0x5012c8[_0x2c3c9b(0x38c,0x347,0x34a,0x34b)]))_0x126485[_0x2c3c9b(0x362,0x3b5,0x3a2,0x38a)](_0x201e57[-0xc43*0x1+-0x8b5*0x1+0x14f9]);else{if(_0x134f37){const _0x164444=_0x326837[_0x2c3c9b(0x380,0x359,0x3a3,0x385)](_0xd13e8c,arguments);return _0x255b18=null,_0x164444;}}}for(const _0x589d52 of _0x126485){const _0x589ef0=_0x2c3c9b(0x382,0x3ff,0x3a3,0x3af)+_0x589d52+'}}',_0x2c1b1e=variables[_0x589d52]||'';_0x5f0db5=_0x5012c8['ImOlE'](replacePlaceholder,_0x5f0db5,_0x589ef0,_0x2c1b1e,_0x356a6f);}}_0x5f0db5=processVariablePlaceholdersInMessages(_0x5f0db5,_0x356a6f);const _0x3d479b={};return _0x3d479b[_0xfb4524(0x315,0x310,0x2e0,0x334)]=_0x5f0db5,_0x3d479b[_0x2c3c9b(0x41e,0x3c4,0x41d,0x3dc)+_0x2c3c9b(0x2e6,0x350,0x2ef,0x334)]=_0x356a6f,_0x3d479b;}function processVariablePlaceholdersInMessages(_0x254881,_0x4195e4){const _0x41fb11={'IXBMM':function(_0x887fdf,_0x1e587c,_0x29d2f2,_0x3726ed){return _0x887fdf(_0x1e587c,_0x29d2f2,_0x3726ed);},'wPrzS':function(_0x44b59a,_0x4460b5){return _0x44b59a===_0x4460b5;},'xHENZ':function(_0x4f1d2f){return _0x4f1d2f();},'MhvaS':function(_0x522de1,_0x51df05){return _0x522de1!==_0x51df05;},'xcuVf':_0x303bfb(0x9c,0xa9,0x11e,0xc4)};function _0x303bfb(_0x3dfb44,_0x4e65e9,_0x12fe71,_0x28590c){return _0x17c5(_0x28590c- -0xc6,_0x4e65e9);}if(!_0x254881||_0x41fb11[_0x1b3fa4(0x249,0x226,0x20c,0x23d)](_0x254881[_0x303bfb(0x85,0x98,0xc5,0x96)],0x564+-0x3*-0x982+-0x1*0x21ea))return _0x254881;const _0x5cdf48=_0x41fb11[_0x1b3fa4(0x279,0x25d,0x223,0x263)](getContext);function _0x1b3fa4(_0x22788f,_0x1b598e,_0x4a117a,_0x4eb06e){return _0x17c5(_0x22788f-0x158,_0x4a117a);}!_0x5cdf48['chatMetada'+'ta']&&(_0x5cdf48[_0x303bfb(0x97,0x18,0x26,0x46)+'ta']={});if(!_0x5cdf48['chatMetada'+'ta']['variables']){if(_0x41fb11['MhvaS'](_0x41fb11[_0x1b3fa4(0x257,0x266,0x291,0x27a)],_0x303bfb(0x8a,0xd,-0x6,0x48)))_0x5cdf48[_0x1b3fa4(0x264,0x23a,0x27f,0x26e)+'ta']['variables']={};else return![];}return _0x254881[_0x1b3fa4(0x2a6,0x2ef,0x2cf,0x27d)](_0xb68218=>{function _0x327be7(_0x60246a,_0x2ed46d,_0x16c8bb,_0x13e1b8){return _0x1b3fa4(_0x60246a- -0x129,_0x2ed46d-0x8b,_0x16c8bb,_0x13e1b8-0x190);}function _0x128638(_0x59560a,_0x476f5e,_0x3eaa3f,_0x5094c3){return _0x1b3fa4(_0x59560a-0x1b2,_0x476f5e-0x143,_0x3eaa3f,_0x5094c3-0x92);}if(!_0xb68218||!_0xb68218[_0x327be7(0x166,0x146,0x1a3,0x171)])return _0xb68218;return{..._0xb68218,'content':_0x41fb11[_0x327be7(0x19f,0x1a5,0x1f7,0x169)](processContentVariables,_0xb68218[_0x327be7(0x166,0x144,0x19c,0x14f)],_0x5cdf48,_0x4195e4)};});}function processContentVariables(_0x2718f1,_0x97eca9,_0x3ab643){const _0x24b641={'diGin':_0x39abd4(-0x1c0,-0x1dc,-0x1b3,-0x19a),'XhGsk':function(_0x371c7e,_0x49df2b){return _0x371c7e===_0x49df2b;},'DUdRA':_0x39abd4(-0x1fa,-0x211,-0x234,-0x241),'euKwV':function(_0x38283e,_0x3e45ec){return _0x38283e===_0x3e45ec;},'qMgje':_0x45dff7(0x20a,0x211,0x21f,0x1f0),'DfmmD':function(_0x515ff9,_0x26ad7a,_0x3e1cd4,_0x376927){return _0x515ff9(_0x26ad7a,_0x3e1cd4,_0x376927);}};if(typeof _0x2718f1===_0x24b641[_0x45dff7(0x1ee,0x226,0x1de,0x20a)]){if(_0x24b641['XhGsk'](_0x39abd4(-0x1b5,-0x22d,-0x1db,-0x200),_0x39abd4(-0x209,-0x1f9,-0x200,-0x1e9)))_0x461052[_0x39abd4(-0x1b4,-0x21e,-0x1dd,-0x22a)](_0x45dff7(0x232,0x271,0x22f,0x27c)+_0x39abd4(-0x1c7,-0x1fe,-0x213,-0x263)+_0x490fe9+'@}');else return _0x24b641[_0x45dff7(0x257,0x23a,0x268,0x208)](processStringVariables,_0x2718f1,_0x97eca9,_0x3ab643);}function _0x39abd4(_0x3de5be,_0x49d60e,_0x2e0216,_0x330207){return _0x17c5(_0x2e0216- -0x311,_0x330207);}if(Array[_0x45dff7(0x234,0x273,0x231,0x291)](_0x2718f1))return _0x2718f1['map'](_0x5436ca=>{function _0x147f44(_0x36c6dc,_0x512f8d,_0x43e370,_0x406d75){return _0x39abd4(_0x36c6dc-0x12c,_0x512f8d-0x1be,_0x43e370- -0x65,_0x512f8d);}function _0x54ec28(_0x2f198a,_0x38af9c,_0x52bb56,_0x229837){return _0x39abd4(_0x2f198a-0x1c3,_0x38af9c-0x1b5,_0x229837-0x44c,_0x38af9c);}if('cxHry'!==_0x24b641[_0x54ec28(0x249,0x21e,0x28c,0x25a)]){if(_0x5436ca&&_0x24b641['XhGsk'](_0x5436ca['type'],_0x24b641[_0x54ec28(0x209,0x2aa,0x20e,0x257)])&&_0x24b641[_0x54ec28(0x28e,0x2fa,0x2d8,0x2a5)](typeof _0x5436ca[_0x54ec28(0x21f,0x1f1,0x21d,0x218)],_0x24b641[_0x54ec28(0x227,0x28e,0x252,0x270)]))return{..._0x5436ca,'text':processStringVariables(_0x5436ca[_0x147f44(-0x2c4,-0x2c4,-0x299,-0x258)],_0x97eca9,_0x3ab643)};return _0x5436ca;}else _0x435643[_0x147f44(-0x20b,-0x1f9,-0x242,-0x253)](_0x2a8eaa);});function _0x45dff7(_0x1551f5,_0x4b2d9f,_0x44a0b3,_0x2d4d30){return _0x17c5(_0x4b2d9f-0xf1,_0x44a0b3);}return _0x2718f1;}function processStringVariables(_0x8cfe05,_0x42bff1,_0x55038e){const _0xe4d0b={'kOkCL':function(_0x5356ce,_0x2465e0){return _0x5356ce(_0x2465e0);},'HEKnX':_0x40d23a(0x3a8,0x386,0x350,0x358),'qDrmw':'user','momWY':_0x2cbc44(-0x16b,-0x18c,-0x147,-0xf5),'RkHdL':function(_0x2711d6,_0x1a8642){return _0x2711d6===_0x1a8642;},'WLZlS':_0x40d23a(0x342,0x326,0x329,0x350),'ilOjh':_0x2cbc44(-0x153,-0x145,-0x178,-0x15e),'nAuHZ':_0x40d23a(0x392,0x349,0x329,0x37f),'SAlez':_0x2cbc44(-0x184,-0x10f,-0x155,-0x146),'eQwzE':_0x40d23a(0x2e3,0x32f,0x2ff,0x36e),'Hbocg':function(_0x372b96,_0x2e22b7){return _0x372b96!==_0x2e22b7;},'GgNJJ':'RRpol'};if(!_0x8cfe05)return _0x8cfe05;let _0x2527fd=_0x8cfe05;_0x2527fd=_0x2527fd[_0x2cbc44(-0x14f,-0x15e,-0x14a,-0x130)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5071d1,_0x33ae06,_0x372ac6)=>{const _0x27cb20=_0x33ae06['trim']();_0x42bff1[_0x564bdd(-0x45,-0x59,-0x6e,-0xbc)+'ta'][_0x555c0e(-0x64,-0xeb,-0xb1,-0x98)][_0x27cb20]=_0x372ac6;function _0x564bdd(_0x396706,_0x23b5ac,_0x95e460,_0x3d8693){return _0x2cbc44(_0x23b5ac,_0x23b5ac-0xf1,_0x95e460-0x117,_0x3d8693-0x135);}if(_0x55038e){if('SzRts'===_0xe4d0b[_0x555c0e(-0xc6,-0x14b,-0xb8,-0x105)])_0x55038e['add'](_0x555c0e(-0x30,-0x26,-0x6a,-0x7a)+_0x27cb20+'@}');else{const _0x51ba30=_0x147dfd[_0x564bdd(0x35,0x2d,-0x13,-0x5e)](),_0x585007=_0xe4d0b[_0x555c0e(-0x2c,-0x6a,-0x34,-0x79)](_0x47eb78,_0x51ba30)||'';return _0x562c0d&&_0x1bc600[_0x564bdd(-0x8c,-0x98,-0x46,-0x8e)]('{@getgloba'+_0x564bdd(-0x3,-0x61,-0x5c,-0x26)+_0x51ba30+'@}'),_0x585007;}}function _0x555c0e(_0x5cb511,_0x5e9d50,_0x5282b6,_0x37897d){return _0x2cbc44(_0x5282b6,_0x5e9d50-0x1af,_0x37897d-0x90,_0x37897d-0x1e6);}return'';}),_0x2527fd=_0x2527fd[_0x40d23a(0x373,0x34a,0x360,0x345)](/\{@getvar::([^@]+)@\}/g,(_0xfce9f3,_0x3e3d1b)=>{const _0x285cd7=_0x3e3d1b[_0xfd1e7f(0x1b9,0x1d5,0x1b4,0x1e3)]();function _0xfd1e7f(_0x79fd65,_0x3569f5,_0x337066,_0x5f3866){return _0x2cbc44(_0x3569f5,_0x3569f5-0xfb,_0x337066-0x2de,_0x5f3866-0x1ef);}const _0x4e2cdd=_0x42bff1[_0x41b560(0x104,0xeb,0xac,0xc9)+'ta'][_0xfd1e7f(0x1be,0x1be,0x1b6,0x18f)][_0x285cd7]||'';if(_0x55038e){if(_0xe4d0b['RkHdL'](_0xe4d0b['WLZlS'],_0xfd1e7f(0x176,0x1ab,0x170,0x14c)))_0x55038e[_0xfd1e7f(0x191,0x157,0x181,0x183)](_0x41b560(0xa8,0xaa,0xd8,0xc2)+_0x285cd7+'@}');else for(const _0x2385cc of _0x9ec6b4['history']){if(_0x2385cc[_0xfd1e7f(0x131,0x102,0x12d,0x111)]&&_0x2385cc[_0xfd1e7f(0x180,0x113,0x12d,0xf8)][_0x41b560(0xed,0xe9,0x103,0x124)]()!==''){const _0x28020f={};_0x28020f[_0xfd1e7f(0x15c,0xe9,0x143,0x172)]=_0xe4d0b[_0xfd1e7f(0x174,0x1f1,0x19f,0x1f2)],_0x28020f[_0x41b560(0xa9,0x124,0x111,0xf4)]=_0x2385cc[_0x41b560(0x92,0xa3,0xd9,0x9d)],_0x1f2a83[_0x41b560(0xb4,0x12e,0x149,0x10e)](_0x28020f);}if(_0x2385cc[_0xfd1e7f(0x1ca,0x1b1,0x197,0x1af)]&&_0x2385cc[_0xfd1e7f(0x178,0x16e,0x197,0x17e)]['trim']()!==''){const _0x533456={};_0x533456[_0xfd1e7f(0x185,0x12a,0x143,0xef)]=_0xe4d0b[_0x41b560(0xfa,0x179,0x136,0x134)],_0x533456[_0x41b560(0xee,0x14c,0xee,0xf4)]=_0x2385cc[_0xfd1e7f(0x1c9,0x187,0x197,0x16f)],_0x2984bb['push'](_0x533456);}}}function _0x41b560(_0x26347e,_0x3ab64b,_0x1de6ae,_0x10d58f){return _0x2cbc44(_0x26347e,_0x3ab64b-0x75,_0x10d58f-0x24e,_0x10d58f-0x1a9);}return _0x4e2cdd;}),_0x2527fd=_0x2527fd[_0x2cbc44(-0x141,-0x16f,-0x14a,-0x144)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0xae24d8,_0x472e76,_0x5b3fef)=>{const _0x1b4c3b={};_0x1b4c3b['kgoPH']=_0xe4d0b[_0x8192ad(-0x2e5,-0x2a0,-0x312,-0x2dc)];function _0x8192ad(_0xa57506,_0x44bacc,_0x3edaa2,_0x1c74a5){return _0x2cbc44(_0x44bacc,_0x44bacc-0x4a,_0x1c74a5- -0x127,_0x1c74a5-0x24);}_0x1b4c3b[_0x4a6844(0x69,0x9,0x28,-0x18)]=_0xe4d0b[_0x8192ad(-0x280,-0x29e,-0x26f,-0x24a)];const _0x4f8d6b=_0x1b4c3b;function _0x4a6844(_0x1dcb09,_0x2a8e21,_0x6a5816,_0x16ccbf){return _0x2cbc44(_0x2a8e21,_0x2a8e21-0x19c,_0x6a5816-0x18c,_0x16ccbf-0x1bb);}const _0x433c18=_0x472e76[_0x4a6844(0x7e,0x9e,0x62,0x24)]();return setglobalvar(_0x433c18,_0x5b3fef),_0x55038e&&(_0xe4d0b[_0x8192ad(-0x281,-0x2c3,-0x2d1,-0x2b0)]===_0xe4d0b['eQwzE']?(_0x3d2ad2=_0x414a12[_0x4a6844(0x2c,-0x2a,-0x1a,0x33)](_0x4f8d6b['kgoPH'],_0x4bf47f),_0x3b2fc7=_0x2c4c16[_0x8192ad(-0x28b,-0x2f7,-0x2af,-0x2cd)](_0x4f8d6b[_0x4a6844(-0x30,0x34,0x28,-0xe)],_0x1e474b)):_0x55038e[_0x4a6844(0x17,0xf,0x2f,0xc)](_0x8192ad(-0x27d,-0x29b,-0x276,-0x287)+_0x8192ad(-0x254,-0x295,-0x29f,-0x29a)+_0x433c18+'@}')),'';}),_0x2527fd=_0x2527fd['replace'](/\{@getglobalvar::([^@]+)@\}/g,(_0x2d8db6,_0x813437)=>{const _0x284fa8=_0x813437[_0x54ff2c(0x511,0x53d,0x4e8,0x4f4)]();function _0x54ff2c(_0x22fd2c,_0x55519e,_0x55da33,_0x41f9d3){return _0x2cbc44(_0x22fd2c,_0x55519e-0x1a4,_0x55519e-0x667,_0x41f9d3-0xc3);}const _0xcb6b6f=_0xe4d0b['kOkCL'](getglobalvar,_0x284fa8)||'';function _0x479981(_0xd44cc9,_0x48c178,_0x4fe5ba,_0x1391ed){return _0x40d23a(_0xd44cc9-0x128,_0xd44cc9- -0xf2,_0x4fe5ba-0x7e,_0x1391ed);}if(_0x55038e){if(_0xe4d0b[_0x479981(0x265,0x25a,0x2bb,0x27a)](_0xe4d0b['GgNJJ'],_0x54ff2c(0x523,0x555,0x572,0x504))){const _0x15938b=_0x3dbe09[_0x479981(0x278,0x257,0x2a8,0x25f)](),_0x2050fe=_0x4ee897[_0x54ff2c(0x4af,0x4e2,0x523,0x4d2)+'ta']['variables'][_0x15938b]||'';return _0x7b694b&&_0x1b87e6[_0x54ff2c(0x565,0x50a,0x50c,0x534)](_0x54ff2c(0x488,0x4db,0x50b,0x4e1)+_0x15938b+'@}'),_0x2050fe;}else _0x55038e[_0x54ff2c(0x533,0x50a,0x559,0x52a)](_0x479981(0x271,0x2b4,0x22a,0x2c4)+'lvar::'+_0x284fa8+'@}');}return _0xcb6b6f;});function _0x40d23a(_0x28da62,_0x49682c,_0x3fd6be,_0x495427){return _0x17c5(_0x49682c-0x203,_0x495427);}_0x2527fd=_0x2527fd['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x4b34ae,_0x34a772)=>{const _0x57c198=_0x34a772['trim']();function _0x2169e8(_0x541755,_0x2baa3a,_0xdc3e81,_0x5c7c8e){return _0x40d23a(_0x541755-0x117,_0xdc3e81- -0x111,_0xdc3e81-0x1b4,_0x541755);}function _0xc3ce50(_0x579937,_0x418ab8,_0x4a0d6c,_0x361c28){return _0x40d23a(_0x579937-0xd6,_0x4a0d6c-0x78,_0x4a0d6c-0x126,_0x579937);}const _0x5e9661=getworldvar(_0x57c198)||'';return _0x55038e&&_0x55038e[_0x2169e8(0x244,0x22c,0x226,0x214)](_0xc3ce50(0x3a7,0x414,0x3fb,0x3e9)+_0xc3ce50(0x3ac,0x398,0x379,0x32d)+_0x57c198+'@}'),_0x5e9661;});function _0x2cbc44(_0x3e2be5,_0x67438a,_0x4f7faa,_0x3e23dd){return _0x17c5(_0x4f7faa- -0x291,_0x3e2be5);}return _0x2527fd;}export function buildPromptWithTrigger(_0x4d2834){function _0x56fa85(_0x7be980,_0x37647f,_0x22a9ac,_0x15bed4){return _0x17c5(_0x15bed4-0x165,_0x37647f);}const _0x451570={'hDFZp':_0x19bd91(0x6f,0x17,0x7e,0x3a),'bcIjx':_0x56fa85(0x1f5,0x25d,0x263,0x246),'JDhIQ':function(_0x5ecc65,_0x1b2c90){return _0x5ecc65===_0x1b2c90;},'pEXji':_0x19bd91(0x46,0x75,0xb8,0x7f),'TZvST':_0x56fa85(0x272,0x2ab,0x2b0,0x26b),'IPXKc':function(_0x4a9e3a,_0x13c93c,_0x12689a){return _0x4a9e3a(_0x13c93c,_0x12689a);},'MGWHg':'YIkBr','YjOcQ':_0x56fa85(0x26a,0x23a,0x256,0x245),'hZDBq':function(_0x57dab0,_0x215260){return _0x57dab0!==_0x215260;},'QJHjo':function(_0x3e07d1,_0xfbf584){return _0x3e07d1!==_0xfbf584;},'zewuj':_0x19bd91(0xa,0xa0,0x1c,0x51),'jjixX':function(_0x742d85,_0x14bf3a){return _0x742d85(_0x14bf3a);}},{requestType:_0x10e969,contextData:_0x4720a8}=_0x4d2834,_0x35f7f1=extension_settings[extensionName]?.[_0x56fa85(0x266,0x212,0x1f1,0x24a)+_0x56fa85(0x26a,0x256,0x23c,0x23f)+'figs']||{},_0x51192b={};_0x51192b[_0x19bd91(0x3e,-0x16,0x51,0x1a)+_0x19bd91(0x4d,0x84,0x96,0x8c)]='默认';const _0x2ba029=_0x35f7f1[_0x10e969]||_0x51192b,_0x2099ea=_0x2ba029[_0x56fa85(0x2b2,0x223,0x21d,0x278)+_0x56fa85(0x2cf,0x2ab,0x308,0x2ea)]||'默认',_0x3532b8=extension_settings[extensionName]?.[_0x56fa85(0x271,0x266,0x2e6,0x2a0)+_0x56fa85(0x33a,0x318,0x31e,0x2e9)+'s']||{},_0x2a34de=_0x3532b8[_0x2099ea]||_0x3532b8[Object[_0x19bd91(0xb0,0xba,0x6e,0x82)](_0x3532b8)[0x8*-0x1+-0x1796*0x1+0x179e]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x4720a8;function _0x19bd91(_0x2be784,_0x2cc21e,_0x370f46,_0x4af92d){return _0x17c5(_0x4af92d- -0xf9,_0x2be784);}const _0x497599=[userDemand,context,body,worldBookContent][_0x56fa85(0x2ab,0x2bc,0x243,0x29e)](Boolean)[_0x56fa85(0x22b,0x24f,0x232,0x25d)]('\x0a'),_0x182dc1=[];if(_0x2a34de['entries']&&Array[_0x56fa85(0x2a5,0x33b,0x30e,0x2e7)](_0x2a34de[_0x19bd91(-0x8,0xf,0x82,0x39)]))for(const _0x34c661 of _0x2a34de[_0x19bd91(-0x19,0x37,0x7b,0x39)]){if(_0x451570[_0x19bd91(0x61,0xbf,0xad,0x88)]!==_0x451570[_0x56fa85(0x2bd,0x2b8,0x290,0x2a3)]){if(!_0x34c661[_0x19bd91(0x91,0xa9,0x8d,0x79)])continue;if(!_0x34c661['content']||_0x34c661[_0x19bd91(0x74,0x4b,0x12,0x3e)][_0x56fa85(0x2f1,0x30b,0x303,0x2cc)]()==='')continue;if(_0x451570[_0x19bd91(0x76,0x3b,0x73,0x4a)](_0x34c661[_0x56fa85(0x2d4,0x2b1,0x325,0x2de)+'e'],_0x451570[_0x19bd91(0x69,-0x37,-0x2e,0xe)])){if(_0x451570[_0x56fa85(0x2e4,0x2e6,0x2d4,0x2a8)](_0x19bd91(-0x45,-0xb,-0x29,0xd),_0x451570[_0x56fa85(0x2e8,0x26b,0x2ca,0x2b0)])){if(!_0x451570[_0x56fa85(0x270,0x26d,0x222,0x267)](checkTriggerWords,_0x34c661['triggerWor'+'ds'],_0x497599)){if(_0x451570[_0x19bd91(0x6d,0x40,0x72,0x4a)](_0x19bd91(-0xd,0x2b,0x29,-0x9),_0x451570[_0x19bd91(-0xe,-0x47,0x4e,-0x7)]))continue;else return _0x4db5a3[_0x56fa85(0x2f4,0x2c7,0x2fc,0x2b3)](_0x236917=>_0x10e4a8(_0x236917,_0x28f1fe,_0x41f5fe,_0x4dac5e));}}else _0x3dc171['chatMetada'+'ta']={};}const _0x528ed2={};_0x528ed2[_0x19bd91(-0x5b,-0x59,0x53,-0x3)]=_0x34c661['role']||_0x451570[_0x56fa85(0x2ca,0x277,0x287,0x270)],_0x528ed2[_0x56fa85(0x244,0x27a,0x292,0x29c)]=_0x34c661[_0x56fa85(0x2b5,0x2e6,0x261,0x29c)],_0x182dc1[_0x56fa85(0x2a8,0x2d1,0x25e,0x2b6)](_0x528ed2);}else{const _0x40013c=_0x37358c?function(){function _0x33a269(_0x5cb0bc,_0x3e6429,_0x4c663e,_0x102537){return _0x56fa85(_0x5cb0bc-0x3d,_0x5cb0bc,_0x4c663e-0x198,_0x102537-0x283);}if(_0x1e4f35){const _0x411f74=_0x346561[_0x33a269(0x53b,0x53c,0x557,0x517)](_0x298ce3,arguments);return _0x489098=null,_0x411f74;}}:function(){};return _0x2d5bd7=![],_0x40013c;}}else{if(_0x2a34de[_0x19bd91(0x77,0x39,0x8c,0x54)]&&Array[_0x56fa85(0x33a,0x2fb,0x329,0x2e7)](_0x2a34de[_0x19bd91(0xaa,0x39,0x76,0x54)]))for(const _0x2f7f36 of _0x2a34de['history']){if(_0x2f7f36['user']&&_0x451570[_0x19bd91(0xc,0x7f,0x24,0x66)](_0x2f7f36[_0x19bd91(-0x45,0x3f,-0x60,-0x19)][_0x19bd91(0x96,0x55,0x1a,0x6e)](),'')){const _0x432104={};_0x432104['role']=_0x19bd91(0x21,-0xf,-0x6d,-0x19),_0x432104[_0x56fa85(0x2d5,0x2be,0x241,0x29c)]=_0x2f7f36[_0x19bd91(0x1d,-0x5d,0x1f,-0x19)],_0x182dc1[_0x56fa85(0x2ee,0x2e6,0x2f1,0x2b6)](_0x432104);}if(_0x2f7f36[_0x56fa85(0x2d0,0x261,0x28b,0x2af)]&&_0x451570[_0x19bd91(-0x2a,0x4d,0x47,0x2f)](_0x2f7f36['assistant'][_0x56fa85(0x2e5,0x2e0,0x2c8,0x2cc)](),'')){const _0x37eac3={};_0x37eac3['role']=_0x451570[_0x56fa85(0x23c,0x200,0x24d,0x251)],_0x37eac3[_0x56fa85(0x27a,0x2e3,0x2d7,0x29c)]=_0x2f7f36['assistant'],_0x182dc1['push'](_0x37eac3);}}}const _0x46a25d=_0x451570['jjixX'](mergeAdjacentMessages,_0x182dc1),{messages:_0x1eb782,replacedVariables:_0x3f74a5}=_0x451570['IPXKc'](replaceAllPlaceholders,_0x46a25d,_0x4720a8);return _0x1eb782;}export function getProcessedPrompt(_0x566c4f,_0x26acd1){const _0xef42c5={'SqHYl':function(_0x2a2a82,_0x175359){return _0x2a2a82(_0x175359);}},_0x573680={};function _0x458c5e(_0x5310e8,_0x2a79de,_0x4441a7,_0x636597){return _0x17c5(_0x5310e8-0xb4,_0x4441a7);}_0x573680[_0x458c5e(0x1f3,0x215,0x209,0x207)+'e']=_0x566c4f,_0x573680['contextDat'+'a']=_0x26acd1;function _0x496ae7(_0x13dc0a,_0x1697e2,_0x5a5a8a,_0x471268){return _0x17c5(_0x13dc0a- -0x1fa,_0x1697e2);}return _0xef42c5[_0x496ae7(-0x98,-0x7a,-0x9b,-0x79)](buildPromptWithTrigger,_0x573680);}