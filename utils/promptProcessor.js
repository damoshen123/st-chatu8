(function(_0x2dbcf8,_0x173743){function _0x210b5c(_0x27f28a,_0x1e7d70,_0x3d4087,_0x550b30){return _0x3e85(_0x1e7d70-0x1be,_0x27f28a);}const _0x8ec44=_0x2dbcf8();function _0x30a806(_0x36757f,_0x31f0f9,_0x377e8e,_0x1dfcc6){return _0x3e85(_0x36757f- -0x17b,_0x377e8e);}while(!![]){try{const _0xf23efc=parseInt(_0x30a806(0x44,0x7d,0x7c,0x43))/(0x2047+-0x1de9+-0x5*0x79)*(parseInt(_0x30a806(0x26,-0x2a,0x48,0x16))/(0xbcf*-0x2+-0x2607+0x1*0x3da7))+parseInt(_0x210b5c(0x38f,0x3a7,0x3f0,0x3c9))/(-0x522+0x1f3b+0x15*-0x13e)+-parseInt(_0x30a806(0x4c,0x35,0x2d,0x28))/(-0x2124+-0x2045*0x1+-0x745*-0x9)+parseInt(_0x30a806(0x68,0x9f,0x57,0x28))/(0x125+0x169a+-0x17ba)*(-parseInt(_0x210b5c(0x3ae,0x394,0x3c0,0x3a6))/(-0x132f*0x2+-0x1*0x1a91+-0x45*-0xf1))+parseInt(_0x210b5c(0x34a,0x380,0x338,0x341))/(-0x1*0x1c45+-0xd3d*0x2+0x921*0x6)*(parseInt(_0x30a806(0x2a,0x4d,0x12,0x73))/(-0xb50+-0x1f29+-0x117*-0x27))+-parseInt(_0x210b5c(0x3a5,0x359,0x37f,0x3a1))/(-0x190f+0x11e*-0x17+0x1965*0x2)+parseInt(_0x30a806(0x1d,0x20,0x55,-0x14))/(-0x18a4+-0xd*-0xc4+0xeba);if(_0xf23efc===_0x173743)break;else _0x8ec44['push'](_0x8ec44['shift']());}catch(_0x2f6cc5){_0x8ec44['push'](_0x8ec44['shift']());}}}(_0x1637,0x5fc08+-0xdbc7b+0x13570d));const _0x5c9707=(function(){let _0x10a7f0=!![];return function(_0x238748,_0x32b261){const _0x37d6e2=_0x10a7f0?function(){if(_0x32b261){const _0x5f145f=_0x32b261['apply'](_0x238748,arguments);return _0x32b261=null,_0x5f145f;}}:function(){};return _0x10a7f0=![],_0x37d6e2;};}()),_0x1248d9=_0x5c9707(this,function(){function _0x499b0d(_0x1be12e,_0xd694e4,_0x3061a0,_0x10e654){return _0x3e85(_0xd694e4- -0x2e6,_0x3061a0);}const _0x55d00f={};_0x55d00f[_0x499b0d(-0x16b,-0x12d,-0x132,-0x13a)]=_0x35e7f9(0x22f,0x22a,0x214,0x26e)+'+$';function _0x35e7f9(_0xd41a88,_0x1f21da,_0x18c550,_0x221b85){return _0x3e85(_0xd41a88-0x4a,_0x18c550);}const _0x1d03e2=_0x55d00f;return _0x1248d9[_0x499b0d(-0x10d,-0xfa,-0xc1,-0xdf)]()[_0x499b0d(-0xfa,-0x14c,-0x132,-0x184)](_0x1d03e2[_0x35e7f9(0x203,0x232,0x1ce,0x1bd)])[_0x499b0d(-0xab,-0xfa,-0xe2,-0x12c)]()[_0x35e7f9(0x1fc,0x1aa,0x1e5,0x1e8)+'r'](_0x1248d9)['search'](_0x1d03e2[_0x35e7f9(0x203,0x1f4,0x1e9,0x1f5)]);});_0x1248d9();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x3f5510,_0x3a5e03){const _0x3d6e06={};_0x3d6e06[_0xb2756f(0x594,0x617,0x5e3,0x5d2)]=_0x49df96(0x36,-0xf,0x88,-0x1c);function _0xb2756f(_0x5badc2,_0x5d3a97,_0x8a51dd,_0x3ea16c){return _0x3e85(_0x3ea16c-0x3d5,_0x8a51dd);}_0x3d6e06[_0xb2756f(0x5a7,0x58f,0x52f,0x569)]=function(_0x37e1cd,_0x3876c9){return _0x37e1cd===_0x3876c9;},_0x3d6e06['RXLbj']=_0x49df96(-0x11,-0x3e,-0x1e,-0x41),_0x3d6e06[_0x49df96(0x1,-0x1c,-0x21,0xb)]=_0x49df96(0x26,-0x5,-0xe,0x6a),_0x3d6e06['DPpCz']=_0x49df96(-0x24,0x5,-0x1c,-0x6a),_0x3d6e06[_0xb2756f(0x55f,0x5ed,0x571,0x5a5)]=_0xb2756f(0x625,0x5ff,0x5c0,0x5f8),_0x3d6e06[_0x49df96(-0xc,0x1,0x3a,-0x42)]=_0x49df96(0x58,0x82,0x36,0x96),_0x3d6e06['bAlFK']='evCja',_0x3d6e06[_0x49df96(-0xb,-0x22,0x1c,0x14)]=_0xb2756f(0x59a,0x5f0,0x598,0x5ae);function _0x49df96(_0x1de8aa,_0x1e0cc9,_0x2ab1af,_0x1d0659){return _0x3e85(_0x1de8aa- -0x1cc,_0x1d0659);}const _0x22698e=_0x3d6e06;if(!_0x3f5510||!_0x3a5e03){if(_0x22698e[_0xb2756f(0x583,0x5f5,0x601,0x5c5)]!==_0x22698e[_0x49df96(0x24,0x5b,0x2e,-0x11)])_0x14d9b9=_0x42d6b3[_0xb2756f(0x5d7,0x5f1,0x5eb,0x5b5)](_0x22698e[_0x49df96(0x31,0xa,0x20,0x1)],_0x20ba01),_0xd4e364=_0x29c9ab[_0xb2756f(0x601,0x5df,0x5fe,0x5b5)](_0x49df96(0x8,0x49,0x28,-0x4),_0x42820d);else return![];}const _0x501d39=_0x3f5510[_0xb2756f(0x571,0x574,0x548,0x57b)](',')['map'](_0x13d587=>_0x13d587[_0xb2756f(0x5fc,0x57b,0x5fe,0x5c2)]())[_0xb2756f(0x623,0x5de,0x5c0,0x5d6)](_0x1c2d0d=>_0x1c2d0d);if(_0x22698e[_0xb2756f(0x568,0x5b7,0x562,0x569)](_0x501d39[_0x49df96(-0x1b,-0x5d,0x2b,-0x18)],-0x10c*-0xb+0x1442+-0xe*0x245)){if(_0x22698e['LzwZe'](_0x22698e['TxoQL'],_0x22698e[_0xb2756f(0x5a0,0x5c7,0x5da,0x595)])){if(_0x20af51&&_0x22698e['LzwZe'](_0xa656ec[_0xb2756f(0x586,0x5b9,0x5db,0x5bd)],_0x22698e[_0x49df96(0x27,-0x18,-0x26,-0x1c)])&&_0x22698e[_0xb2756f(0x517,0x57e,0x524,0x569)](typeof _0x31d500[_0x49df96(-0x11,-0x1c,0x1f,0x16)],_0x22698e[_0xb2756f(0x594,0x563,0x5af,0x5a2)]))return{..._0x2db467,'text':_0x1d071a(_0x193bcd[_0xb2756f(0x56d,0x57c,0x5cc,0x590)],_0x391167,_0x9aeaf6)};return _0x38df55;}else return![];}for(const _0x5df417 of _0x501d39){if(_0x22698e[_0x49df96(-0x39,-0x71,-0x4d,-0x2d)]!==_0xb2756f(0x5b1,0x5f8,0x61e,0x5e4)){if(_0x3a5e03['includes'](_0x5df417))return _0x22698e[_0x49df96(-0xb,-0x48,-0x31,-0x15)]!==_0x22698e['ctIhd']?![]:!![];}else _0x55b736[_0x49df96(0xe,-0x26,0x51,-0x16)](_0x301649[-0x3db+-0x1*-0xc41+-0x865]);}return![];}export function mergeAdjacentMessages(_0x1a7750){function _0x172a5b(_0x2767c4,_0x18bc8d,_0x2da833,_0x3762bc){return _0x3e85(_0x2767c4- -0x1d6,_0x2da833);}const _0x31117c={'ISFYV':function(_0x3137fa,_0x215c21,_0x531d0b,_0x3f6caa){return _0x3137fa(_0x215c21,_0x531d0b,_0x3f6caa);},'cRVkN':function(_0x28a909,_0x30e8e1){return _0x28a909===_0x30e8e1;},'dMAIw':function(_0x31ee89,_0x18dad9){return _0x31ee89!==_0x18dad9;},'sgLeR':_0x172a5b(0x41,0x5a,0x80,0x7b),'GlSDr':'OduAA','XTOHr':function(_0xc65b70,_0x3e9fd7,_0x46e4fd){return _0xc65b70(_0x3e9fd7,_0x46e4fd);}};if(!_0x1a7750||_0x31117c['cRVkN'](_0x1a7750[_0x11211e(0x250,0x202,0x241,0x20c)],0xfb*0xe+0x17e2+0x74*-0x53))return[];function _0x11211e(_0x50b315,_0x3040ee,_0x4e6dd6,_0x2861cf){return _0x3e85(_0x3040ee-0x51,_0x2861cf);}const _0x557cd6=[];let _0x5026a6=null;for(const _0x449cbe of _0x1a7750){if(_0x31117c[_0x172a5b(-0x7,0x7,0xd,-0x55)](_0x11211e(0x23c,0x268,0x26c,0x2b0),_0x31117c[_0x172a5b(0x2f,0x14,0x77,0x11)])){if(_0x28d3be['includes'](_0x255368))return!![];}else{if(!_0x5026a6){if(_0x31117c[_0x172a5b(0x32,-0x12,0x43,-0x3)](_0x31117c[_0x11211e(0x1e9,0x1df,0x1da,0x1db)],'OduAA')){const _0x52e7b7={..._0x449cbe};_0x5026a6=_0x52e7b7;}else return{..._0x3f6b73,'text':_0x31117c[_0x172a5b(0x1f,0x3c,0x2,0x4b)](_0x232685,_0x17c2b6[_0x11211e(0x21d,0x20c,0x214,0x220)],_0x23ec26,_0x46ae8b)};}else{if(_0x31117c[_0x172a5b(0x32,0x75,0x25,-0x11)](_0x5026a6[_0x11211e(0x262,0x229,0x215,0x26a)],_0x449cbe['role']))_0x5026a6[_0x172a5b(-0x8,-0x23,0x48,0x2f)]=_0x31117c[_0x172a5b(-0x33,-0xd,0x7,-0x3a)](mergeContent,_0x5026a6[_0x172a5b(-0x8,-0x43,-0x1b,-0x15)],_0x449cbe[_0x172a5b(-0x8,-0x1a,-0x2a,-0x20)]);else{_0x557cd6[_0x172a5b(0x5b,0xa0,0x9e,0x2a)](_0x5026a6);const _0x58f414={..._0x449cbe};_0x5026a6=_0x58f414;}}}}return _0x5026a6&&_0x557cd6[_0x11211e(0x26d,0x282,0x257,0x275)](_0x5026a6),_0x557cd6;}function _0x1637(){const _0x152274=['EgXIELu','zw5HyMXLza','DMfYoJO','qMn2AMS','E0bNzxr3B3jSza','yxnZAxn0yw50','ChvZAa','r2Xtrhi','CwjSq1a','BwXpDhK','s1HLuMW','E0bZzxrNBg9Iyq','yKfSrKS','thP3wMu','zuXmEMS','A2v5CW','EhrFChjVzMLSzq','mtmWmJa0mezyELzetq','CMvWBgfJzwrwyq','C2vHCMnO','nda2ntKWm0rMEe9qEG','BhzHCJO6','qMvWDhm','BMfTzte','D3bMvuK','r1PQB2e','mteXnZCZohjYAuDlyq','txz0z04','wfrpshi','z3zrEMm','mtq0yuTIEuPH','C3bSAxq','t05Qz3i','yxH3C0e','zhHdEK4','seHOtei','uvrxqvy','uvjdENy','y0nnt2K','DxnLCG','CMvXDwvZDfr5Ca','Ag1oB2u','BgvUz3rO','y29UC3rYDwn0BW','rgvVBvq','BwfW','AKTrsg0','AfbOD0m','txzqtLO','rKnrD2q','AuH4EK0','r1bIC2q','Dgv4Da','DgvZDf9JB250zq','E3VKUjBNLyZKUABOP6BLJ5f9Fq','u09YC2S','mMjZAg5ODa','yuLwB0C','y3rjAgq','mty1mtKZz25cshPO','veznugK','qMPdsLe','CvLSB1i','vKz4B1C','mZu0ndq4me9bz0nZrW','Efj1Eg0','B0Hoqxi','y29UDgv4Df9WCG','C2DPDuu','E3VMRApMLOD9Fq','Ae1Rt3y','y29UDgvUDa','ze1bsxC','vhHVuuW','yvfOtfC','v29fy0m','EeTzEhO','phvZzxi+','BwvZC2fNzxm','mJu4A2nJAwLV','Bwf0y2HbBgW','CM9Szq','EMPfB1O','ywrK','z2PHvKq','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','BgXTx3jLCxvLCW','yxjmsNC','E0bNzxr2yxi6oG','CMvWBgfJzufSBa','AvDVuMi','tM55ywW','mtiWodq1rfn2tfLd','E0bZzxr2yxi6oG','kcGOlISPkYKRkq','y0LeDKW','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','DhLWzq','ndm5mty0mfzqzMvICa','DhjPz2DLCK1Vza','y29UDgv4DerHDa','Dg9tDhjPBMC','DhjPBq','twzvyxi','zw50CMLLCW','rfbWq3O','y0ziCwe','C3rYAw5N','uLHmyMO','ELz1u1K','svngwvy','zMLNCW','B2jQzwn0','AxnbCNjHEq','B2zPBgu','rgTVsuC','sLLlExG','rwn6tLG','tgjgDvi','Df90ExbLx2nVBG','CLr6txu','Bef0uvG','zMLSDgvY','E3T1C2vYFx0','C3rYAw5NAwz5','DMfYAwfIBgvZ','C2Dmzvi','Aw5JBhvKzxm','BujNB1m','y1jwA04','E0bNzxrNBg9Iyq','s0DZBhG','tNnJsLO','CMLHyMXLCW','DhjPz2DLCG','vwLMAgi','teTdq3u','CMvWBgfJzq','qKzqvKy','zMnXCwS','q3Pbr3G','E3TNzxr2yxi6oG','E3VKUiRKUiVMLOD9Fq','yMTAwNK','u2ruAfG','whvcq0S','D1DXBhC','D0roB1m','E3VNLkJMIlFPNidMSyj9Fq','y2HHDe1LDgfKyq','DvzwDKO','yMrVELu','AgLZDg9YEq','BM96u1i','svrpv2G','vxrRq0G','BxnjEuS','y2jswNO','tK5KDM4','tNLIDNG','EKHfEhq','D1zHs20','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','AeXTzfm'];_0x1637=function(){return _0x152274;};return _0x1637();}function mergeContent(_0x3f2701,_0x43942d){function _0x31e526(_0x2ba1b9,_0x45ac2d,_0x32b37a,_0x3cc0a7){return _0x3e85(_0x3cc0a7-0x2b1,_0x32b37a);}const _0x150e9b={'Nnyal':function(_0xdcc1b1,_0x1460e4){return _0xdcc1b1===_0x1460e4;},'MvPNZ':'string','DkoIG':function(_0x5ab471,_0x592400){return _0x5ab471(_0x592400);}};if(_0x150e9b[_0x31e526(0x475,0x496,0x4aa,0x493)](typeof _0x3f2701,_0x150e9b[_0x31e526(0x474,0x476,0x45a,0x468)])&&_0x150e9b[_0x31e526(0x4a9,0x4e5,0x44e,0x493)](typeof _0x43942d,_0x150e9b['MvPNZ']))return _0x3f2701+'\x0a'+_0x43942d;const _0x1fa289=_0x150e9b[_0x31e526(0x489,0x48b,0x4be,0x4ab)](normalizeToArray,_0x3f2701),_0x2ffc24=_0x150e9b[_0x4366da(-0x13a,-0x105,-0x145,-0x10d)](normalizeToArray,_0x43942d),_0xbd0d7a={};_0xbd0d7a[_0x4366da(-0x111,-0x117,-0xf2,-0x143)]=_0x31e526(0x473,0x45b,0x45e,0x46c);function _0x4366da(_0x446754,_0x122b47,_0x2c8168,_0x279b23){return _0x3e85(_0x122b47- -0x2ff,_0x279b23);}return _0xbd0d7a[_0x31e526(0x47b,0x484,0x490,0x46c)]='\x0a',[..._0x1fa289,_0xbd0d7a,..._0x2ffc24];}function _0x3e85(_0x76f940,_0x2342b4){_0x76f940=_0x76f940-(-0x7e1*0x3+-0x1a69*-0x1+-0x3*0x68);const _0x4d6260=_0x1637();let _0x55800=_0x4d6260[_0x76f940];if(_0x3e85['iiVDIy']===undefined){var _0x17a539=function(_0x19db7f){const _0x54a64b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5a8102='',_0x539e4c='',_0x1889f1=_0x5a8102+_0x17a539;for(let _0xa8c187=-0x11da+0x1282*0x1+-0x54*0x2,_0x8bb7cf,_0x30c2ed,_0xa09a78=0x1249+-0x84f*-0x1+-0x1a98;_0x30c2ed=_0x19db7f['charAt'](_0xa09a78++);~_0x30c2ed&&(_0x8bb7cf=_0xa8c187%(-0xcb+-0x78*-0x1d+-0xcc9)?_0x8bb7cf*(-0xfa5*-0x2+-0x860+-0x16aa)+_0x30c2ed:_0x30c2ed,_0xa8c187++%(-0x624+0x397*0x8+0x1690*-0x1))?_0x5a8102+=_0x1889f1['charCodeAt'](_0xa09a78+(-0x1710+-0xbc6+0x30*0xba))-(0x1*-0x2345+-0x3b*0x9+0x2562)!==0x52*0x17+-0x152d+0xdcf?String['fromCharCode'](-0x59f+-0x87e+-0xf1c*-0x1&_0x8bb7cf>>(-(0xd4a+-0xc58+-0x1e*0x8)*_0xa8c187&0x15d5+-0x181f+0x4*0x94)):_0xa8c187:-0x1*-0x1e23+0x1*0xbe9+-0x2a0c){_0x30c2ed=_0x54a64b['indexOf'](_0x30c2ed);}for(let _0x55bd1f=-0x1*0xd5+-0x3c*-0x7d+-0x1c77,_0xa6097d=_0x5a8102['length'];_0x55bd1f<_0xa6097d;_0x55bd1f++){_0x539e4c+='%'+('00'+_0x5a8102['charCodeAt'](_0x55bd1f)['toString'](0x46*0x6d+0x21c1*-0x1+0x403))['slice'](-(-0x3f1*0x4+0xc91+0x1*0x335));}return decodeURIComponent(_0x539e4c);};_0x3e85['oCxiBf']=_0x17a539,_0x3e85['GXqdoV']={},_0x3e85['iiVDIy']=!![];}const _0x100b25=_0x4d6260[0x26e6+-0x77a+-0x1f6c*0x1],_0x364e5c=_0x76f940+_0x100b25,_0x1c9aaa=_0x3e85['GXqdoV'][_0x364e5c];if(!_0x1c9aaa){const _0x21ee63=function(_0x22aeca){this['KfiZuj']=_0x22aeca,this['NTGLmQ']=[0xfd3*0x2+0x1*-0x509+-0x1a9c,0x1946+-0x7*-0x245+-0x2929,-0x1e39+-0x1*-0x166f+0x2*0x3e5],this['quYmKx']=function(){return'newState';},this['WMAbCy']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['SpqiuR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x21ee63['prototype']['vfKKSV']=function(){const _0x1212de=new RegExp(this['WMAbCy']+this['SpqiuR']),_0x5296a5=_0x1212de['test'](this['quYmKx']['toString']())?--this['NTGLmQ'][0x149f+0x9e1+-0x1e7f]:--this['NTGLmQ'][-0x1ca3+0x1596+0x70d];return this['joPfrb'](_0x5296a5);},_0x21ee63['prototype']['joPfrb']=function(_0x181b66){if(!Boolean(~_0x181b66))return _0x181b66;return this['oUyvqw'](this['KfiZuj']);},_0x21ee63['prototype']['oUyvqw']=function(_0x3a75ae){for(let _0x2a4007=-0x34f+0xf66+0xc17*-0x1,_0x55f2b6=this['NTGLmQ']['length'];_0x2a4007<_0x55f2b6;_0x2a4007++){this['NTGLmQ']['push'](Math['round'](Math['random']())),_0x55f2b6=this['NTGLmQ']['length'];}return _0x3a75ae(this['NTGLmQ'][-0x1d*-0x93+-0x1*-0x2086+0x312d*-0x1]);},new _0x21ee63(_0x3e85)['vfKKSV'](),_0x55800=_0x3e85['oCxiBf'](_0x55800),_0x3e85['GXqdoV'][_0x364e5c]=_0x55800;}else _0x55800=_0x1c9aaa;return _0x55800;}function normalizeToArray(_0x186276){const _0x3e0d57={};_0x3e0d57['qYloR']=function(_0x51cdee,_0xa18ad2){return _0x51cdee===_0xa18ad2;},_0x3e0d57[_0x291563(0x463,0x48b,0x461,0x49f)]='NscJZ',_0x3e0d57['FCQwd']=_0x291563(0x3f8,0x3e2,0x431,0x3e8),_0x3e0d57[_0x291563(0x44e,0x45b,0x409,0x46f)]=function(_0x1765dd,_0x1b5422){return _0x1765dd||_0x1b5422;};function _0x4d4b0e(_0x122956,_0x41095e,_0x6104cd,_0x59ea7b){return _0x3e85(_0x41095e-0x37d,_0x6104cd);}const _0x17b741=_0x3e0d57;if(Array[_0x291563(0x435,0x3f4,0x462,0x400)](_0x186276)){if(_0x17b741[_0x4d4b0e(0x552,0x542,0x568,0x559)](_0x17b741[_0x4d4b0e(0x5bd,0x5a3,0x58e,0x5c2)],_0x4d4b0e(0x57c,0x588,0x57e,0x57b)))return _0x186276;else{_0x3b824d[_0x291563(0x46e,0x448,0x4ac,0x459)](_0x4dedd9);const _0x181143={..._0x4372bd};_0x52cdc3=_0x181143;}}function _0x291563(_0x4d6e80,_0x358089,_0x1ee426,_0x2db365){return _0x3e85(_0x4d6e80-0x23d,_0x2db365);}return[{'type':_0x17b741[_0x291563(0x3f5,0x40d,0x3c8,0x3f4)],'text':_0x17b741[_0x4d4b0e(0x5ad,0x58e,0x56d,0x5df)](_0x186276,'')}];}export function replacePlaceholder(_0x7b0e44,_0x2f7c00,_0x11e759,_0x123481){const _0x155e28={'eLLzk':function(_0x51709b,_0x185cc4){return _0x51709b||_0x185cc4;},'ONjgr':_0x2e45a1(0xa6,0xa9,0xf0,0x66),'oHNAr':function(_0xcc7093,_0x5d0a99){return _0xcc7093!==_0x5d0a99;},'OKRrt':_0x238f93(0x514,0x4c3,0x4d3,0x4cb),'cIDvL':_0x2e45a1(0x3d,0x50,0x4,0x8b),'EAenV':function(_0x22d8c3,_0x506f65){return _0x22d8c3===_0x506f65;},'EczNX':'RlqBe','xlbzU':function(_0x43483e,_0x57b79c,_0x2fecea,_0x115d74,_0x4ba59e){return _0x43483e(_0x57b79c,_0x2fecea,_0x115d74,_0x4ba59e);}};if(typeof _0x7b0e44===_0x238f93(0x55c,0x59d,0x541,0x526)){if('WNpQl'!==_0x155e28[_0x2e45a1(0x26,0x74,0x39,0x56)])return _0x11e759&&_0x7b0e44['includes'](_0x2f7c00)&&(_0x123481&&(_0x155e28[_0x238f93(0x533,0x4fc,0x51e,0x547)](_0x238f93(0x56a,0x52a,0x571,0x59f),_0x155e28['OKRrt'])?_0x123481[_0x238f93(0x544,0x557,0x501,0x503)](_0x2f7c00):_0x33da1b[_0x238f93(0x544,0x54f,0x591,0x580)](_0x2e45a1(0xae,0xa4,0x8c,0x98)+_0x2e45a1(0xac,0xfc,0x8b,0xe7)+_0x265d87+'@}'))),_0x7b0e44[_0x238f93(0x54a,0x543,0x53c,0x50f)](_0x2f7c00,_0x155e28['eLLzk'](_0x11e759,''));else{if(_0x37a7e6[_0x238f93(0x562,0x51c,0x577,0x538)](_0x1bdd4e))return _0x34f054;return[{'type':_0x238f93(0x525,0x540,0x524,0x574),'text':_0x155e28[_0x238f93(0x4ff,0x548,0x4da,0x543)](_0x29cfb9,'')}];}}if(Array['isArray'](_0x7b0e44))return _0x155e28[_0x238f93(0x533,0x561,0x567,0x56b)]('viRuI',_0x155e28[_0x2e45a1(0x65,0x2e,0x36,0x5f)])?_0x7b0e44[_0x2e45a1(0x33,0x70,0x7d,0x11)](_0x4dfe04=>replacePlaceholder(_0x4dfe04,_0x2f7c00,_0x11e759,_0x123481)):(_0x5a8102&&_0x539e4c[_0x2e45a1(0x85,0x3b,0xb9,0xc5)](_0x1889f1)&&(_0x21ee63&&_0x5296a5[_0x238f93(0x544,0x54e,0x569,0x578)](_0x181b66)),_0xa09a78[_0x2e45a1(0x5f,0x80,0x86,0x44)](_0x55bd1f,_0x155e28[_0x2e45a1(0x14,0x9,-0x2b,0x62)](_0xa6097d,'')));function _0x238f93(_0x409bb3,_0x2e0252,_0x16f2a,_0x119400){return _0x3e85(_0x409bb3-0x36a,_0x2e0252);}function _0x2e45a1(_0x58171e,_0x3e7f4f,_0x53b5ab,_0x566605){return _0x3e85(_0x58171e- -0x181,_0x566605);}if(_0x7b0e44&&_0x155e28['EAenV'](typeof _0x7b0e44,_0x2e45a1(0x76,0x76,0xc4,0x3b))){const _0x576799={};for(const _0x55cf0c in _0x7b0e44){if(_0x155e28[_0x2e45a1(0x48,0x1,0x82,-0x5)]('DJqPY',_0x155e28[_0x238f93(0x566,0x553,0x584,0x563)]))_0x576799[_0x55cf0c]=_0x155e28[_0x2e45a1(0xaa,0xd1,0x70,0x98)](replacePlaceholder,_0x7b0e44[_0x55cf0c],_0x2f7c00,_0x11e759,_0x123481);else return![];}return _0x576799;}return _0x7b0e44;}export function replaceAllPlaceholders(_0x39c6a0,_0x1d3489){const _0x2b574a={'Uifhb':function(_0xd9e238){return _0xd9e238();},'nozSR':_0x21ef46(0x2df,0x2ea,0x2fd,0x2e2),'NNdvn':function(_0x34b486,_0x28596d,_0x403423,_0x3b978f,_0x19f77c){return _0x34b486(_0x28596d,_0x403423,_0x3b978f,_0x19f77c);},'KGslx':_0x21ef46(0x2f2,0x2eb,0x2da,0x2fe),'fcqqk':_0x21ef46(0x29a,0x267,0x2a8,0x273),'fbOfo':_0x21ef46(0x2b9,0x2e5,0x291,0x2b8),'mlOty':function(_0x7cebd5,_0x2b64a6,_0x5006e1,_0x33f61c,_0x49cb84){return _0x7cebd5(_0x2b64a6,_0x5006e1,_0x33f61c,_0x49cb84);},'Bcvjk':_0x21ef46(0x306,0x2be,0x30b,0x2b8)+'}}','sKBbu':_0x13895c(0x172,0x15c,0x178,0x1bd),'gNtuK':function(_0x1996f1,_0x34244f){return _0x1996f1>_0x34244f;},'gjaVD':function(_0x564b36,_0x57adc9){return _0x564b36!==_0x57adc9;},'hPhwC':'kSRJn','VFxoW':function(_0xcbfe0a,_0x4f2519){return _0xcbfe0a===_0x4f2519;},'GZjoa':_0x13895c(0xe8,0xb6,0x128,0xfb),'wpfUI':function(_0x337617,_0x32ea42,_0x1a8e33,_0x583ef9,_0x4d3449){return _0x337617(_0x32ea42,_0x1a8e33,_0x583ef9,_0x4d3449);},'ITOWh':function(_0xc2061c,_0x1a618c,_0x238966){return _0xc2061c(_0x1a618c,_0x238966);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x1d3489,_0x4644d4=new Set();let _0x3fa0a4=_0x39c6a0;const _0xd1d4c1=_0x2b574a[_0x13895c(0x165,0x11b,0x146,0x19f)](getContext),_0x304bec=_0xd1d4c1?.[_0x21ef46(0x27b,0x244,0x2b3,0x2b3)]||'';let _0x51f369=worldBookContent;_0x51f369&&(_0x51f369=_0x51f369[_0x21ef46(0x2bd,0x2ed,0x26f,0x287)](_0x2b574a[_0x21ef46(0x2fd,0x323,0x2ea,0x2c5)],_0x304bec),_0x51f369=_0x51f369[_0x21ef46(0x2bd,0x2e4,0x2c2,0x272)](_0x21ef46(0x2b1,0x2d5,0x27b,0x2e8),_0x304bec));_0x3fa0a4=_0x2b574a['NNdvn'](replacePlaceholder,_0x3fa0a4,_0x2b574a[_0x13895c(0x161,0x114,0x151,0x193)],context,_0x4644d4),_0x3fa0a4=replacePlaceholder(_0x3fa0a4,_0x2b574a[_0x21ef46(0x2ef,0x333,0x334,0x2ee)],_0x51f369,_0x4644d4),_0x3fa0a4=replacePlaceholder(_0x3fa0a4,_0x21ef46(0x2a9,0x295,0x260,0x29f),body,_0x4644d4),_0x3fa0a4=_0x2b574a[_0x21ef46(0x302,0x33c,0x347,0x2ef)](replacePlaceholder,_0x3fa0a4,_0x2b574a['fbOfo'],characterListText,_0x4644d4);function _0x21ef46(_0x111801,_0x388ceb,_0x47360c,_0x6595ca){return _0x3e85(_0x111801-0xdd,_0x388ceb);}_0x3fa0a4=_0x2b574a[_0x13895c(0xe7,0x12a,0xec,0xe7)](replacePlaceholder,_0x3fa0a4,_0x2b574a[_0x13895c(0x185,0x159,0x193,0x15e)],outfitEnableListText,_0x4644d4),_0x3fa0a4=_0x2b574a['NNdvn'](replacePlaceholder,_0x3fa0a4,_0x13895c(0x13e,0x15f,0x107,0x10e)+'}}',commonCharacterListText,_0x4644d4),_0x3fa0a4=replacePlaceholder(_0x3fa0a4,_0x2b574a['sKBbu'],userDemand,_0x4644d4);if(variables&&_0x2b574a['gNtuK'](Object[_0x13895c(0xed,0x10e,0x100,0xb4)](variables)[_0x13895c(0x108,0xe4,0x120,0x157)],-0x2189+0x2*-0x64+0x2251)){if(_0x2b574a[_0x13895c(0x132,0x10d,0x15d,0x17f)](_0x13895c(0x16d,0x1b1,0x18a,0x13f),_0x2b574a[_0x21ef46(0x293,0x294,0x241,0x2a1)])){const _0x16d2bd=/\{\{getvar::([^}]+)\}\}/g,_0x403ba8=JSON['stringify'](_0x3fa0a4),_0x10891f=[..._0x403ba8[_0x21ef46(0x2b4,0x2b6,0x272,0x2a8)](_0x16d2bd)],_0x3b3259=new Set();for(const _0x3a232a of _0x10891f){if(_0x2b574a[_0x21ef46(0x2a3,0x261,0x260,0x260)](_0x2b574a[_0x21ef46(0x27d,0x2cb,0x28d,0x293)],_0x13895c(0xe8,0x123,0xf6,0xef)))_0x3b3259['add'](_0x3a232a[-0x171c+0x5*0x65b+0x1*-0x8aa]);else{const _0x538ca0=_0x28891a[_0x21ef46(0x2ca,0x287,0x2f8,0x2f4)](),_0x558fbf=_0x3f081c[_0x13895c(0x173,0x180,0x19d,0x121)+'ta']['variables'][_0x538ca0]||'';return _0x5b944d&&_0x468d95[_0x13895c(0x131,0xfe,0x12e,0x159)](_0x13895c(0x136,0x145,0xf7,0x13b)+_0x538ca0+'@}'),_0x558fbf;}}for(const _0x37d60a of _0x3b3259){const _0x9e5173=_0x13895c(0x16b,0x178,0x1b2,0x14e)+_0x37d60a+'}}',_0x58e22d=variables[_0x37d60a]||'';_0x3fa0a4=_0x2b574a[_0x13895c(0xf6,0xa7,0xed,0x105)](replacePlaceholder,_0x3fa0a4,_0x9e5173,_0x58e22d,_0x4644d4);}}else{const _0x39cec8=_0x1815c0['trim']();return _0x4242f4[_0x21ef46(0x2f9,0x317,0x2f6,0x2f2)+'ta'][_0x13895c(0x15b,0x128,0x16e,0x119)][_0x39cec8]=_0x4534e0,_0x400031&&_0x1a2842['add'](_0x21ef46(0x2c1,0x2f8,0x287,0x2ab)+_0x39cec8+'@}'),'';}}_0x3fa0a4=_0x2b574a[_0x13895c(0x178,0x17d,0x157,0x1b6)](processVariablePlaceholdersInMessages,_0x3fa0a4,_0x4644d4);function _0x13895c(_0x2e99ff,_0x6169f0,_0x1bbda6,_0x3606f4){return _0x3e85(_0x2e99ff- -0xa9,_0x1bbda6);}const _0x2dc917={};return _0x2dc917[_0x13895c(0x12c,0xdd,0x16e,0x137)]=_0x3fa0a4,_0x2dc917[_0x13895c(0xf0,0xfb,0xc7,0xb6)+_0x13895c(0x163,0x14c,0x165,0x12d)]=_0x4644d4,_0x2dc917;}function processVariablePlaceholdersInMessages(_0x17a16b,_0x2a5e63){const _0x3a3386={'zVuSY':function(_0x576e37,_0x5a10dc){return _0x576e37===_0x5a10dc;},'MfUar':_0x30157b(-0x19,-0x6,-0x2f,-0x34),'pWnDc':function(_0xebc796,_0x438c5a,_0x365b91,_0x3d4f5b){return _0xebc796(_0x438c5a,_0x365b91,_0x3d4f5b);}};if(!_0x17a16b||_0x17a16b[_0x30157b(-0x7,0x4,-0x38,-0x1d)]===-0x39*0x4c+0x13*0x16d+0x1*-0xa2b)return _0x17a16b;const _0x3bbc36=getContext();!_0x3bbc36[_0x30157b(0x58,0xe,0x33,0x18)+'ta']&&(_0x3bbc36['chatMetada'+'ta']={});!_0x3bbc36[_0x3ec902(0x2b3,0x2aa,0x281,0x2d2)+'ta'][_0x3ec902(0x2a3,0x294,0x2ac,0x2ba)]&&(_0x3bbc36[_0x30157b(0xf,-0x10,0x33,0x18)+'ta'][_0x30157b(-0x32,0x42,0x1b,0x15)]={});function _0x30157b(_0x1d4c55,_0x445bb6,_0x331d17,_0x521c09){return _0x3e85(_0x331d17- -0x1e9,_0x1d4c55);}function _0x3ec902(_0x2c2931,_0x4943e1,_0x3c2f0a,_0x605659){return _0x3e85(_0x605659-0xb6,_0x2c2931);}return _0x17a16b['map'](_0x2643a7=>{function _0x25b8ad(_0x3124a1,_0x2dfda5,_0x4e0ab7,_0xd05515){return _0x3ec902(_0x3124a1,_0x2dfda5-0x146,_0x4e0ab7-0x14,_0xd05515- -0x39d);}function _0x52bb0e(_0x1aa0eb,_0x4c96c5,_0x287c61,_0x29e9cf){return _0x30157b(_0x1aa0eb,_0x4c96c5-0xf5,_0x287c61-0x391,_0x29e9cf-0xc9);}if(_0x3a3386[_0x25b8ad(-0xa2,-0x102,-0xbe,-0xf3)](_0x3a3386[_0x52bb0e(0x3ce,0x36e,0x396,0x3a9)],_0x3a3386[_0x25b8ad(-0xc2,-0xef,-0x115,-0xf9)])){if(!_0x2643a7||!_0x2643a7[_0x25b8ad(-0x118,-0xf0,-0x106,-0x119)])return _0x2643a7;return{..._0x2643a7,'content':_0x3a3386['pWnDc'](processContentVariables,_0x2643a7[_0x52bb0e(0x38c,0x38e,0x376,0x34b)],_0x3bbc36,_0x2a5e63)};}else return[];});}function processContentVariables(_0x10d5b1,_0x22c510,_0x1f33a6){function _0x2f4d7b(_0x37daf6,_0x5d8175,_0x206cc3,_0x1fc8a3){return _0x3e85(_0x1fc8a3- -0x2cc,_0x5d8175);}function _0xefba9(_0x1ce839,_0x5beacc,_0x1ade05,_0x4a7bbf){return _0x3e85(_0x4a7bbf-0x398,_0x5beacc);}const _0x3f8118={'wVaKm':_0xefba9(0x59d,0x5ce,0x5e5,0x5c8),'QRCzv':'(((.+)+)+)'+'+$','hmNoe':_0xefba9(0x541,0x514,0x564,0x54d),'gvQzc':_0xefba9(0x567,0x514,0x585,0x553),'saYAY':function(_0x4b72c2,_0x505be4){return _0x4b72c2===_0x505be4;},'MvtgN':_0xefba9(0x560,0x55a,0x5a6,0x58a),'wDNoS':_0x2f4d7b(-0x10d,-0x123,-0xc4,-0x108),'rTzMu':function(_0x384db0,_0x4a456e,_0x5e5534,_0x29dcc4){return _0x384db0(_0x4a456e,_0x5e5534,_0x29dcc4);},'hLmdS':function(_0x27ab4b,_0x3c4934){return _0x27ab4b===_0x3c4934;},'QTWAV':function(_0x1bb8bf,_0x28c1aa){return _0x1bb8bf+_0x28c1aa;},'KQZZD':function(_0x12b645,_0x3254f5){return _0x12b645!==_0x3254f5;},'GcKLJ':_0x2f4d7b(-0xd2,-0xe5,-0xdf,-0xaf),'iUELn':function(_0x5f5ce9,_0x26ddde){return _0x5f5ce9!==_0x26ddde;}};if(typeof _0x10d5b1===_0x2f4d7b(-0xe0,-0xfe,-0xe6,-0xda)){if(_0x3f8118['KQZZD'](_0x2f4d7b(-0x65,-0x101,-0x75,-0xaf),_0x3f8118['GcKLJ'])){const _0xba960c={};_0xba960c[_0xefba9(0x550,0x529,0x54d,0x570)]=_0x3f8118[_0x2f4d7b(-0xb5,-0xbc,-0x9a,-0xa4)],_0xba960c['content']=_0x54092c[_0x2f4d7b(-0x57,-0x8b,-0x4c,-0x9c)],_0x47c324[_0xefba9(0x612,0x5ca,0x616,0x5c9)](_0xba960c);}else return processStringVariables(_0x10d5b1,_0x22c510,_0x1f33a6);}if(Array[_0xefba9(0x5cb,0x5b2,0x593,0x590)](_0x10d5b1)){if(_0x3f8118['iUELn'](_0x2f4d7b(-0x11e,-0x103,-0xb4,-0x101),_0x2f4d7b(-0x112,-0xdc,-0xfd,-0xfa)))return _0x10d5b1['map'](_0x1c638e=>{function _0x37dcbd(_0xe94806,_0x12b92c,_0x283eff,_0x5e2714){return _0x2f4d7b(_0xe94806-0x58,_0x12b92c,_0x283eff-0x162,_0x283eff-0x1da);}function _0x2cc9e7(_0x71590,_0x4ff386,_0x172cb6,_0x3713c4){return _0xefba9(_0x71590-0x2b,_0x4ff386,_0x172cb6-0x14a,_0x172cb6- -0x5f6);}if(_0x3f8118['hmNoe']!==_0x3f8118[_0x37dcbd(0x89,0x7b,0xbe,0x9d)])_0x5f29ca[_0x2cc9e7(-0x97,-0xb4,-0x90,-0xc5)]=_0x268fd8(_0x1b6a4b[_0x2cc9e7(-0x84,-0xd6,-0x90,-0x82)],_0x2bf381['content']);else{if(_0x1c638e&&_0x1c638e[_0x37dcbd(0x12d,0x143,0xf6,0xbe)]===_0x3f8118[_0x37dcbd(0xd9,0xf8,0xb2,0x9f)]&&_0x3f8118['saYAY'](typeof _0x1c638e[_0x37dcbd(0xba,0xef,0xc9,0xf1)],_0x3f8118[_0x2cc9e7(-0x7a,-0x7b,-0xbc,-0x7e)]))return _0x3f8118[_0x2cc9e7(-0x59,-0x6b,-0x44,-0x8c)]!=='BjCJQ'?_0x4fb690['toString']()['search'](cBAzsy['QRCzv'])['toString']()[_0x37dcbd(0xc2,0x7d,0xc0,0x7b)+'r'](_0x4ff401)[_0x2cc9e7(-0x8b,-0xbd,-0xc4,-0x110)](cBAzsy[_0x2cc9e7(-0x93,-0xfe,-0xb2,-0xd4)]):{..._0x1c638e,'text':_0x3f8118[_0x2cc9e7(-0x79,-0x14,-0x5f,-0x97)](processStringVariables,_0x1c638e['text'],_0x22c510,_0x1f33a6)};return _0x1c638e;}});else{if(_0x3f8118['saYAY'](typeof _0x330e33,_0x3f8118[_0x2f4d7b(-0x14d,-0x15c,-0x100,-0x12a)])&&_0x3f8118[_0x2f4d7b(-0xf2,-0x73,-0x52,-0xa2)](typeof _0x3c4d0e,_0x3f8118['MvtgN']))return _0x3f8118[_0x2f4d7b(-0x12f,-0x104,-0x15e,-0x121)](_0x3f8118[_0xefba9(0x51a,0x550,0x511,0x543)](_0x4a093a,'\x0a'),_0x2e06d3);const _0x10e3eb=_0x1a546d(_0x259957),_0x44ad8a=_0x139bfa(_0xcbc27a),_0x18c948={};return _0x18c948[_0x2f4d7b(-0xec,-0xe4,-0xbb,-0xe4)]=_0x3f8118[_0xefba9(0x583,0x51b,0x4fb,0x53c)],_0x18c948[_0x2f4d7b(-0x150,-0xc0,-0x120,-0x111)]='\x0a',[..._0x10e3eb,_0x18c948,..._0x44ad8a];}}return _0x10d5b1;}function processStringVariables(_0x30d71a,_0xf0c4e4,_0x1edcd0){const _0x46d7e4={'JYKyx':function(_0x400087,_0x20368e){return _0x400087===_0x20368e;},'arLJw':_0x37827c(0x3d1,0x396,0x39f,0x368),'dxCzN':function(_0x26bfda,_0x180387,_0x5be28e){return _0x26bfda(_0x180387,_0x5be28e);},'CzAGx':function(_0xfc3eef,_0x2591db){return _0xfc3eef(_0x2591db);},'mBgoS':_0x37827c(0x352,0x370,0x33f,0x372)};function _0x37827c(_0x125abd,_0x3cff83,_0x4c1d8f,_0x1423c4){return _0x3e85(_0x3cff83-0x1d3,_0x125abd);}if(!_0x30d71a)return _0x30d71a;let _0x164b03=_0x30d71a;_0x164b03=_0x164b03[_0x37827c(0x3f9,0x3e3,0x3f2,0x3fa)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x138ec2,_0x50a41e,_0x3de1fb)=>{function _0x43340d(_0x2b8523,_0x440e21,_0x35a238,_0x14a90e){return _0x37827c(_0x440e21,_0x2b8523- -0x167,_0x35a238-0x97,_0x14a90e-0x1ed);}const _0x24eb09=_0x50a41e[_0x43340d(0x259,0x226,0x283,0x240)]();function _0x504848(_0x54b03b,_0x31d78f,_0x5ad775,_0x1c510d){return _0x3fd798(_0x54b03b-0x157,_0x31d78f-0x1e7,_0x31d78f- -0x282,_0x1c510d);}_0xf0c4e4[_0x43340d(0x288,0x26f,0x260,0x250)+'ta'][_0x43340d(0x270,0x282,0x24f,0x250)][_0x24eb09]=_0x3de1fb;if(_0x1edcd0){if(_0x46d7e4[_0x43340d(0x267,0x298,0x2a7,0x29d)](_0x46d7e4[_0x504848(0x287,0x2a2,0x286,0x2e9)],_0x46d7e4[_0x43340d(0x24a,0x219,0x26d,0x22c)]))_0x1edcd0['add'](_0x43340d(0x250,0x29f,0x2a1,0x294)+_0x24eb09+'@}');else{const _0x187c99=_0x43340d(0x280,0x2b2,0x2ba,0x2a6)+_0x14a6c6+'}}',_0x384c46=_0x2eb252[_0x29b382]||'';_0x27df32=_0x3a034e(_0xc66b69,_0x187c99,_0x384c46,_0x4a7df2);}}return'';}),_0x164b03=_0x164b03['replace'](/\{@getvar::([^@]+)@\}/g,(_0x1649dd,_0x5bc7a8)=>{const _0x1ed944=_0x5bc7a8['trim'](),_0x550dae=_0xf0c4e4['chatMetada'+'ta'][_0x60387(0x458,0x426,0x47b,0x44a)][_0x1ed944]||'';function _0x60387(_0x35a217,_0x3686d1,_0x131f3f,_0x3e1fdd){return _0x37827c(_0x3e1fdd,_0x35a217-0x81,_0x131f3f-0x1f0,_0x3e1fdd-0x1f3);}_0x1edcd0&&_0x1edcd0[_0x361dd5(-0x2f,0x28,0x27,-0x2)](_0x361dd5(0x16,-0x2b,-0x2b,0x3)+_0x1ed944+'@}');function _0x361dd5(_0x13b0db,_0x57b8bb,_0x3596cf,_0xc973a6){return _0x3fd798(_0x13b0db-0x1ac,_0x57b8bb-0x8,_0xc973a6- -0x522,_0x13b0db);}return _0x550dae;}),_0x164b03=_0x164b03[_0x37827c(0x409,0x3e3,0x3a5,0x3d0)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2109f4,_0x37e18e,_0x4b0507)=>{const _0x44d586=_0x37e18e[_0x2829b2(0x48d,0x4c9,0x47b,0x4ad)]();function _0x4f70b1(_0x546afa,_0x84d39c,_0x179c7b,_0x33bc11){return _0x3fd798(_0x546afa-0x13f,_0x84d39c-0xa1,_0x84d39c- -0x416,_0x546afa);}function _0x2829b2(_0x4f62a5,_0x93454d,_0x2add6c,_0x3a0bc5){return _0x3fd798(_0x4f62a5-0x102,_0x93454d-0x1d7,_0x3a0bc5- -0x86,_0x2add6c);}return _0x46d7e4[_0x2829b2(0x45f,0x423,0x451,0x469)](setglobalvar,_0x44d586,_0x4b0507),_0x1edcd0&&_0x1edcd0[_0x4f70b1(0x15c,0x10a,0x132,0x110)](_0x2829b2(0x41e,0x457,0x457,0x452)+_0x4f70b1(0xf1,0xcc,0x8e,0xc3)+_0x44d586+'@}'),'';}),_0x164b03=_0x164b03[_0x3fd798(0x564,0x593,0x556,0x54f)](/\{@getglobalvar::([^@]+)@\}/g,(_0x43405e,_0xd0a4fd)=>{function _0x2b067f(_0x4bb9a5,_0x564b2f,_0x29fa24,_0x4d3684){return _0x37827c(_0x29fa24,_0x4d3684- -0x4d0,_0x29fa24-0x48,_0x4d3684-0x176);}const _0x60a4cb=_0xd0a4fd[_0x2b067f(-0x13f,-0xd4,-0x150,-0x110)](),_0x6dec88=_0x46d7e4['CzAGx'](getglobalvar,_0x60a4cb)||'';function _0x91e87d(_0x1b64f8,_0x1d930e,_0x14b92a,_0x5c647b){return _0x3fd798(_0x1b64f8-0x1c2,_0x1d930e-0x1c4,_0x1d930e- -0x69d,_0x14b92a);}if(_0x1edcd0){if(_0x46d7e4[_0x2b067f(-0x12b,-0xb2,-0xb7,-0x102)](_0x46d7e4[_0x91e87d(-0x140,-0x150,-0x19a,-0x176)],_0x91e87d(-0x18b,-0x139,-0xe7,-0x155))){const _0xce3f13={};return _0xce3f13[_0x91e87d(-0x1ec,-0x1a8,-0x1ed,-0x185)+'e']=_0x5f04af,_0xce3f13['contextDat'+'a']=_0x5a3b68,_0x46d7e4[_0x91e87d(-0x15c,-0x144,-0xfc,-0x182)](_0xd29063,_0xce3f13);}else _0x1edcd0[_0x91e87d(-0x140,-0x17d,-0x1b1,-0x1bf)](_0x2b067f(-0xa4,-0xb1,-0x102,-0xf4)+_0x91e87d(-0x209,-0x1bb,-0x179,-0x1c2)+_0x60a4cb+'@}');}return _0x6dec88;});function _0x3fd798(_0x151117,_0x98c843,_0x14ff90,_0x16756d){return _0x3e85(_0x14ff90-0x346,_0x16756d);}return _0x164b03=_0x164b03['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x347d7a,_0x9c2246)=>{function _0x37b9c0(_0x6a8a85,_0x2d6893,_0x5e8ee7,_0x2850c6){return _0x37827c(_0x2850c6,_0x5e8ee7- -0x74,_0x5e8ee7-0x147,_0x2850c6-0x1b0);}const _0x1bedf2=_0x9c2246['trim'](),_0x2d1db8=_0x46d7e4['CzAGx'](getworldvar,_0x1bedf2)||'';return _0x1edcd0&&_0x1edcd0['add']('{@getworld'+_0x37b9c0(0x3b7,0x377,0x38c,0x3db)+_0x1bedf2+'@}'),_0x2d1db8;}),_0x164b03;}export function buildPromptWithTrigger(_0x51185a){const _0x294318={'DeomT':function(_0x4141e7,_0x5c5aad){return _0x4141e7!==_0x5c5aad;},'UtkCH':_0x197df1(0x4e9,0x52a,0x4d4,0x4f0),'xRuxm':_0x58aad8(0x330,0x31c,0x359,0x2cb),'cCMOi':function(_0x364bd1,_0xab5efc,_0x44ebc7,_0xca4f4c,_0x1f87fc){return _0x364bd1(_0xab5efc,_0x44ebc7,_0xca4f4c,_0x1f87fc);},'qblCP':function(_0x21ce9c,_0x3f3680){return _0x21ce9c!==_0x3f3680;},'iWoRb':_0x197df1(0x554,0x521,0x562,0x5a0),'aQhLW':function(_0x520dcd,_0x32b919,_0x56a864){return _0x520dcd(_0x32b919,_0x56a864);},'cFHqa':_0x197df1(0x50e,0x52a,0x541,0x534)},{requestType:_0x14f32c,contextData:_0x4be8db}=_0x51185a,_0x582ed2=extension_settings[extensionName]?.[_0x58aad8(0x28c,0x2c9,0x2a7,0x2bb)+_0x197df1(0x539,0x4f9,0x4f5,0x555)+_0x197df1(0x531,0x4fb,0x4fb,0x52f)]||{},_0x7eef22={};_0x7eef22[_0x58aad8(0x2f5,0x2b6,0x2f0,0x27c)+_0x197df1(0x534,0x524,0x55d,0x53f)]='默认';const _0x2e5402=_0x582ed2[_0x14f32c]||_0x7eef22,_0x83ae4f=_0x2e5402[_0x197df1(0x505,0x4c8,0x4c7,0x4e5)+_0x58aad8(0x2eb,0x2e5,0x30b,0x331)]||'默认';function _0x58aad8(_0x427794,_0x4d1c42,_0x1696d2,_0x2e524f){return _0x3e85(_0x4d1c42-0xec,_0x2e524f);}const _0x275697=extension_settings[extensionName]?.[_0x58aad8(0x25d,0x2a8,0x2da,0x281)+_0x58aad8(0x27c,0x283,0x267,0x2b7)+'s']||{},_0x3dc57f=_0x275697[_0x83ae4f]||_0x275697[Object[_0x197df1(0x4d1,0x4e1,0x48b,0x4e7)](_0x275697)[0x223a*-0x1+0xa0f+0x182b]]||{};function _0x197df1(_0x516c09,_0x40026d,_0x43bd4e,_0x28578c){return _0x3e85(_0x516c09-0x33b,_0x43bd4e);}const {context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x4be8db,_0x3e4eb7=[userDemand,context,body,worldBookContent][_0x197df1(0x53c,0x509,0x573,0x531)](Boolean)['join']('\x0a'),_0x45c238=[];if(_0x3dc57f['entries']&&Array[_0x197df1(0x533,0x517,0x56e,0x522)](_0x3dc57f['entries']))for(const _0x48b546 of _0x3dc57f[_0x58aad8(0x2ab,0x2db,0x2ed,0x2ef)]){if(!_0x48b546[_0x197df1(0x567,0x55d,0x57e,0x5a7)])continue;if(!_0x48b546[_0x197df1(0x509,0x518,0x543,0x4c4)]||_0x48b546[_0x197df1(0x509,0x51a,0x4e1,0x4b7)][_0x58aad8(0x2d5,0x2d9,0x29e,0x30d)]()==='')continue;if(_0x48b546[_0x197df1(0x525,0x4eb,0x520,0x566)+'e']===_0x58aad8(0x2f6,0x2f9,0x2fe,0x2ac)){if(_0x294318[_0x197df1(0x4ca,0x501,0x490,0x50e)](_0x294318[_0x197df1(0x51c,0x535,0x518,0x520)],_0x197df1(0x554,0x514,0x58d,0x53e))){if(_0x23d0bb['user']&&_0x294318[_0x197df1(0x4ee,0x53f,0x4b9,0x4b0)](_0x4c0bae[_0x197df1(0x4e9,0x518,0x4a7,0x4dd)][_0x58aad8(0x2b4,0x2d9,0x2bc,0x309)](),'')){const _0x4f57b0={};_0x4f57b0[_0x58aad8(0x2ad,0x2c4,0x2fd,0x2bc)]=_0x294318['UtkCH'],_0x4f57b0['content']=_0x18478a[_0x197df1(0x4e9,0x536,0x49a,0x4db)],_0x30e7b0[_0x58aad8(0x369,0x31d,0x2df,0x351)](_0x4f57b0);}if(_0x541416[_0x197df1(0x56b,0x56b,0x52e,0x559)]&&_0x294318[_0x197df1(0x4ee,0x4af,0x4ff,0x49d)](_0x486d29['assistant'][_0x58aad8(0x29f,0x2d9,0x2a5,0x2eb)](),'')){const _0x12c6bf={};_0x12c6bf['role']=_0x294318[_0x197df1(0x503,0x4fb,0x50c,0x4fb)],_0x12c6bf[_0x197df1(0x509,0x535,0x552,0x4be)]=_0x202f6b[_0x197df1(0x56b,0x5a8,0x589,0x53d)],_0x43d1b3['push'](_0x12c6bf);}}else{if(!_0x294318[_0x58aad8(0x2a8,0x2bd,0x288,0x270)](checkTriggerWords,_0x48b546['triggerWor'+'ds'],_0x3e4eb7))continue;}}const _0x3cee1b={};_0x3cee1b['role']=_0x48b546['role']||_0x294318[_0x197df1(0x55d,0x544,0x562,0x537)],_0x3cee1b[_0x197df1(0x509,0x53c,0x4ef,0x530)]=_0x48b546[_0x197df1(0x509,0x553,0x531,0x4f0)],_0x45c238[_0x58aad8(0x323,0x31d,0x32c,0x2fc)](_0x3cee1b);}else{if(_0x3dc57f[_0x197df1(0x55a,0x564,0x548,0x5a6)]&&Array['isArray'](_0x3dc57f['history']))for(const _0x3dd12b of _0x3dc57f['history']){if(_0x3dd12b['user']&&_0x294318[_0x58aad8(0x2bc,0x27b,0x276,0x254)](_0x3dd12b[_0x197df1(0x4e9,0x52e,0x4c0,0x4ec)][_0x58aad8(0x28f,0x2d9,0x2ef,0x290)](),'')){if(_0x294318[_0x58aad8(0x2e5,0x29f,0x2ba,0x254)](_0x197df1(0x50e,0x544,0x4fe,0x544),_0x294318[_0x197df1(0x52c,0x518,0x4f1,0x557)])){const _0x5cd653=/\{\{getvar::([^}]+)\}\}/g,_0x12ee71=_0x5edeb2[_0x58aad8(0x2cd,0x2ef,0x31e,0x319)](_0x52d009),_0x4c9fc=[..._0x12ee71[_0x197df1(0x512,0x4ce,0x514,0x4f2)](_0x5cd653)],_0x459ed7=new _0x27a900();for(const _0x4882b5 of _0x4c9fc){_0x459ed7[_0x58aad8(0x2c0,0x2c6,0x2d4,0x301)](_0x4882b5[-0x167e+-0x244*-0x10+-0xdc1]);}for(const _0xd3cfd0 of _0x459ed7){const _0x177309=_0x197df1(0x54f,0x599,0x52f,0x533)+_0xd3cfd0+'}}',_0x2a6aeb=_0x4b256e[_0xd3cfd0]||'';_0x39f5d9=_0x294318[_0x197df1(0x4e8,0x534,0x49c,0x4c8)](_0x1c94fb,_0x4a2e10,_0x177309,_0x2a6aeb,_0x496d17);}}else{const _0x26f667={};_0x26f667['role']=_0x294318[_0x58aad8(0x311,0x30e,0x2c6,0x318)],_0x26f667['content']=_0x3dd12b[_0x58aad8(0x2cc,0x29a,0x28c,0x298)],_0x45c238[_0x58aad8(0x337,0x31d,0x305,0x2e3)](_0x26f667);}}if(_0x3dd12b[_0x197df1(0x56b,0x5ac,0x599,0x5b5)]&&_0x294318[_0x197df1(0x4ee,0x4e2,0x508,0x4b3)](_0x3dd12b[_0x197df1(0x56b,0x5a7,0x524,0x5b2)]['trim'](),'')){const _0x54b86b={};_0x54b86b[_0x58aad8(0x295,0x2c4,0x309,0x2fa)]=_0x294318[_0x58aad8(0x291,0x2b4,0x287,0x26f)],_0x54b86b[_0x197df1(0x509,0x535,0x552,0x4f6)]=_0x3dd12b[_0x58aad8(0x2e6,0x31c,0x349,0x346)],_0x45c238['push'](_0x54b86b);}}}const _0x1c56af=mergeAdjacentMessages(_0x45c238),{messages:_0x14ff67,replacedVariables:_0x5e9bbe}=_0x294318[_0x58aad8(0x2e5,0x2bd,0x2eb,0x298)](replaceAllPlaceholders,_0x1c56af,_0x4be8db);return _0x14ff67;}export function getProcessedPrompt(_0x3672d9,_0x28945e){const _0x2a3472={'XuBCK':function(_0x189ae4,_0x138e52){return _0x189ae4(_0x138e52);}},_0xd74e9={};_0xd74e9[_0x29b0ff(0x27a,0x2aa,0x2a0,0x2ed)+'e']=_0x3672d9;function _0x29b0ff(_0x1b52e3,_0x2f153d,_0x350c83,_0x4ee53b){return _0x3e85(_0x350c83-0xf1,_0x2f153d);}function _0x1055df(_0xdd033c,_0x433219,_0x375e77,_0x5f1744){return _0x3e85(_0x5f1744-0x375,_0x375e77);}return _0xd74e9[_0x29b0ff(0x2fb,0x2c8,0x2dc,0x2c1)+'a']=_0x28945e,_0x2a3472[_0x1055df(0x56e,0x562,0x550,0x58d)](buildPromptWithTrigger,_0xd74e9);}