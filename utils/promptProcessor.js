(function(_0x53ba44,_0x8b9283){function _0x5e2982(_0x3ce2af,_0x2e84cd,_0x134fa7,_0x5a01b3){return _0x3adb(_0x2e84cd-0x307,_0x3ce2af);}const _0x4af694=_0x53ba44();function _0xdeacb0(_0x717a2a,_0x4bc577,_0x55a0b1,_0x5739af){return _0x3adb(_0x4bc577-0x253,_0x5739af);}while(!![]){try{const _0x4302b9=-parseInt(_0xdeacb0(0x3e0,0x3ff,0x421,0x417))/(0x2*-0xc0c+-0x1e*-0x55+-0x149*-0xb)*(-parseInt(_0xdeacb0(0x433,0x3f8,0x3c2,0x3f9))/(-0x18d1*-0x1+0x23c7+-0x3c96))+parseInt(_0xdeacb0(0x3e9,0x3a4,0x3ee,0x3d0))/(0x1ed1+-0xe43*0x1+-0x108b)+parseInt(_0x5e2982(0x49b,0x46a,0x48a,0x452))/(0xbd7*0x1+-0x1*-0xb7b+0x26*-0x9d)*(-parseInt(_0xdeacb0(0x3cc,0x3f4,0x434,0x3b2))/(-0x1d8f+0x1*-0x6a0+0x2434))+-parseInt(_0x5e2982(0x4dd,0x4af,0x4ae,0x466))/(-0x20a4+-0x22a5+-0x434f*-0x1)*(parseInt(_0xdeacb0(0x37e,0x3c9,0x3e6,0x3dc))/(0x77f*0x1+0x1bbb*-0x1+0x1443))+-parseInt(_0xdeacb0(0x40f,0x3f6,0x3d3,0x43d))/(0x181*0x3+0x229e+-0x2719)*(parseInt(_0xdeacb0(0x37d,0x39d,0x3c2,0x367))/(-0x2*-0xc41+0x3*0xbc0+-0x3bb9))+-parseInt(_0x5e2982(0x4a0,0x461,0x462,0x4a4))/(0x22e+-0x1ecc+0x1ca8)*(parseInt(_0x5e2982(0x4db,0x4c3,0x47e,0x4a6))/(-0x1*-0x2bd+0x2338+-0x1a6*0x17))+parseInt(_0x5e2982(0x427,0x468,0x4ac,0x472))/(0xe95+0x98d+-0x1816);if(_0x4302b9===_0x8b9283)break;else _0x4af694['push'](_0x4af694['shift']());}catch(_0x5ea10a){_0x4af694['push'](_0x4af694['shift']());}}}(_0x4d14,0x1c8ce9*-0x1+-0xb4229*-0x1+0x6a3*0x4d6));const _0x25c8b8=(function(){let _0x43ade8=!![];return function(_0x3eeb37,_0x2fb197){const _0x5cfebc=_0x43ade8?function(){function _0x5d4d33(_0x59e3bd,_0x5cd492,_0x32a2de,_0x38db0c){return _0x3adb(_0x5cd492- -0x3e2,_0x59e3bd);}if(_0x2fb197){const _0xc80f5b=_0x2fb197[_0x5d4d33(-0x268,-0x25d,-0x2a7,-0x231)](_0x3eeb37,arguments);return _0x2fb197=null,_0xc80f5b;}}:function(){};return _0x43ade8=![],_0x5cfebc;};}()),_0x25f28f=_0x25c8b8(this,function(){const _0x42143b={};function _0x908f61(_0x5897ae,_0x141c18,_0x2f0ddc,_0x1c6963){return _0x3adb(_0x1c6963- -0x3c0,_0x2f0ddc);}function _0x5a9c11(_0x1807a9,_0x4b6dc8,_0x4fd026,_0x46ff59){return _0x3adb(_0x46ff59- -0x171,_0x4fd026);}_0x42143b[_0x908f61(-0x204,-0x215,-0x1c9,-0x1e6)]=_0x5a9c11(0x33,0x9b,0x87,0x51)+'+$';const _0x5909c5=_0x42143b;return _0x25f28f[_0x908f61(-0x243,-0x25b,-0x22a,-0x26e)]()[_0x908f61(-0x229,-0x224,-0x1e2,-0x225)](_0x5a9c11(0x4f,0x6d,0x44,0x51)+'+$')[_0x5a9c11(0x0,-0x25,0x6,-0x1f)]()[_0x908f61(-0x21f,-0x24c,-0x240,-0x260)+'r'](_0x25f28f)[_0x908f61(-0x209,-0x1f2,-0x26a,-0x225)](_0x5909c5[_0x908f61(-0x232,-0x199,-0x21e,-0x1e6)]);});_0x25f28f();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';function _0x3adb(_0x54a6e5,_0x7a8fed){_0x54a6e5=_0x54a6e5-(-0x1fe2+-0x233e+0x4464);const _0x28a866=_0x4d14();let _0x1b7952=_0x28a866[_0x54a6e5];if(_0x3adb['CyuCiy']===undefined){var _0x4766f7=function(_0x1b3412){const _0x3407f1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c553f='',_0x1d1f99='',_0x5c7789=_0x1c553f+_0x4766f7;for(let _0x53679d=0x1815+-0x240f+0x15*0x92,_0x125a69,_0x2c674e,_0x2fd7e7=0x7*0x3a+0x215f+-0xba7*0x3;_0x2c674e=_0x1b3412['charAt'](_0x2fd7e7++);~_0x2c674e&&(_0x125a69=_0x53679d%(-0xdfa+0xfd4*-0x2+0x2da6)?_0x125a69*(0x142*0x10+-0x6b*-0x1+-0x144b)+_0x2c674e:_0x2c674e,_0x53679d++%(-0x1e21+-0xa70+-0xd87*-0x3))?_0x1c553f+=_0x5c7789['charCodeAt'](_0x2fd7e7+(0x17a3+-0x19ff+-0x2*-0x133))-(-0x7*0x28+0x8d*-0x2b+0x18d1)!==0x1a56*-0x1+0x1ce1+-0x5d*0x7?String['fromCharCode'](0x1966*0x1+0x1c*0x1a+-0x3*0x915&_0x125a69>>(-(0x61*-0x13+0x1a0c+-0x12d7*0x1)*_0x53679d&0x1d45*-0x1+0x974+0x13d7)):_0x53679d:-0x16a2+0x2111+-0xa6f){_0x2c674e=_0x3407f1['indexOf'](_0x2c674e);}for(let _0x2fdd48=-0x375+0x1*0x128+0x24d,_0x117906=_0x1c553f['length'];_0x2fdd48<_0x117906;_0x2fdd48++){_0x1d1f99+='%'+('00'+_0x1c553f['charCodeAt'](_0x2fdd48)['toString'](-0x1c21+0x5*0x4b5+0x4a8))['slice'](-(-0x1*0xa5b+0x1360+-0x903));}return decodeURIComponent(_0x1d1f99);};_0x3adb['MRDSvF']=_0x4766f7,_0x3adb['OYZJCU']={},_0x3adb['CyuCiy']=!![];}const _0x308b8e=_0x28a866[-0x15bd+0x1*0x20a5+0x2ba*-0x4],_0xcdb445=_0x54a6e5+_0x308b8e,_0x22702d=_0x3adb['OYZJCU'][_0xcdb445];if(!_0x22702d){const _0x120292=function(_0x25be84){this['WLxGRr']=_0x25be84,this['ePVpVw']=[-0x1b8d+0x1bea+-0x2e*0x2,0x1309+-0x1*-0x829+-0x1b32*0x1,-0x2531+0x26eb+-0x1ba],this['UFroFi']=function(){return'newState';},this['EOdlWJ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['OnXadr']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x120292['prototype']['uwMZSW']=function(){const _0x669a6b=new RegExp(this['EOdlWJ']+this['OnXadr']),_0x252a21=_0x669a6b['test'](this['UFroFi']['toString']())?--this['ePVpVw'][0x3*0x31a+0x1465+0x3*-0x9e6]:--this['ePVpVw'][-0x1f15+-0x1b9d+0x3ab2*0x1];return this['LjfAAk'](_0x252a21);},_0x120292['prototype']['LjfAAk']=function(_0x3ffb6f){if(!Boolean(~_0x3ffb6f))return _0x3ffb6f;return this['OZVvdg'](this['WLxGRr']);},_0x120292['prototype']['OZVvdg']=function(_0x5234f3){for(let _0x2431a0=0x129d+-0x11ed+-0xb0,_0x1a1ca=this['ePVpVw']['length'];_0x2431a0<_0x1a1ca;_0x2431a0++){this['ePVpVw']['push'](Math['round'](Math['random']())),_0x1a1ca=this['ePVpVw']['length'];}return _0x5234f3(this['ePVpVw'][-0xfe0+0xe0f+-0x1f*-0xf]);},new _0x120292(_0x3adb)['uwMZSW'](),_0x1b7952=_0x3adb['MRDSvF'](_0x1b7952),_0x3adb['OYZJCU'][_0xcdb445]=_0x1b7952;}else _0x1b7952=_0x22702d;return _0x1b7952;}function _0x4d14(){const _0x2bf1ca=['yMD1quW','DxnLCG','Df90ExbLx2nVBG','CMvXDwvZDfr5Ca','s2jzwLK','yxPnEgu','mte4nty1nfvxqurMsW','Dg9tDhjPBMC','E0bNzxr3B3jSza','CMvWBgfJzq','CMLHyMXLCW','q2P6reO','zMH3v3q','phvZzxi+','DMfYAwfIBgvZ','mJa2mgHLCu1lua','E0bNzxr2yxi6oG','CM9Szq','Dgv4Da','vxHVv1e','t25JrxG','y29UC3rYDwn0BW','nteWnZq2mtzty0nuwuK','y29UDgvUDa','mZyXmZaYogDrq1jXvG','ALjTA0u','zfDdze8','C3bSAxq','CNLYq0S','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','B2vorwO','ugvqrgy','ChvZAa','r2jRuLa','rMnAwLu','zgfjs1K','sxnUsKG','DMfOAKG','CMvWBgfJzufSBa','wvvjALC','qNrMt0O','B2jQzwn0','DMfYoJO','mtC1AKDKsfP4','zw50CMLLCW','B2zPBgu','r3PIrKW','BgXTx3jLCxvLCW','BhzHCJO6','A0vKBK8','uNrlCKC','zLfmt0e','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','uhPZDeC','ywnVvhy','DhLWzq','Bwf0y2HbBgW','ENreC1y','yxbWBhK','AxDPCge','DgvZDf9JB250zq','z3HbB0m','s1bOuvO','E0bZzxrNBg9Iyq','vhHTBfi','BgvUz3rO','zMLSDgvY','y2HHDe1LDgfKyq','E0bNzxrNBg9Iyq','B1v3A0e','zfHxCNO','E3TNzxr2yxi6oG','ug1KCe8','uMzjtxC','DhjPz2DLCK1Vza','t1PPtNy','DhjPBq','ALfdDwq','C3rYAw5N','B1DyEey','C2vHCMnO','BMfTzte','Ew9XAu4','AfznrMO','AgLZDg9YEq','t0rjr1m','nwHpugHpAG','DerXuwW','og1ktvbgrG','Dg1frwW','nJu0r1LmB1zv','u2PMBNe','wxLPzuW','ody3mZbOv0Ltt3u','Aw5JBhvKzxm','ugX6D2O','BwfW','otuZtvj4u0vp','E3T1C2vYFx0','CK1mA1m','ywrK','Dhr5qwi','vwD6qMG','AhzYDhm','q3DkDNq','rw53qwW','s0vYBhK','yuTzuvy','s1rbAxC','BfnXAfu','uNf6u0S','rgPXsKi','sez6A1C','otaYotLIserZy0m','u3jvqMS','q0vVDhe','y29UDgv4Df9WCG','q1fYDgq','EhrFChjVzMLSzq','kcGOlISPkYKRkq','DhLrzLC','reDuzNK','E0bZzxr2yxi6oG','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','CeLpqwO','zKPvv04','v3r5uK8','EKvvBhq','AuzPrgy','v0XfwLe','E3VKUjBNLyZKUABOP6BLJ5f9Fq','ufv2Egq','zKHJt0S','AxnbCNjHEq','D0HICgS','zhvZCMS','AM9PBG','DgXswMu','yxnZAxn0yw50','uff1EMy','B0TyBwy','q0jlChq','rw5eywC','r2rlA2G','DhjPz2DLCLDVCG','Bg5swMK','wfneyKy','r0fzsva','wffnvK8','q25jz2O','sxrbD0i','yK9vDvC','otmZntqWm1vHv3bbua'];_0x4d14=function(){return _0x2bf1ca;};return _0x4d14();}import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x2adcef,_0x1b0297){const _0x29b975={};_0x29b975[_0x2d7094(0x122,0xf9,0x15c,0xe1)]=function(_0x64f78b,_0x4754af){return _0x64f78b===_0x4754af;};const _0x109571=_0x29b975;if(!_0x2adcef||!_0x1b0297)return![];function _0x2d7094(_0x5d7c9,_0x46d41b,_0x383461,_0x476d79){return _0x3adb(_0x5d7c9- -0x50,_0x476d79);}const _0x9c171e=_0x2adcef[_0x386eb7(0x36a,0x3d8,0x38b,0x3a9)](',')[_0x2d7094(0x15b,0x16f,0x143,0x166)](_0x5e7865=>_0x5e7865[_0x386eb7(0x3d8,0x3bd,0x40e,0x3da)]())['filter'](_0x43df4f=>_0x43df4f);if(_0x109571[_0x2d7094(0x122,0x145,0x121,0x13b)](_0x9c171e[_0x2d7094(0x13c,0x172,0x130,0x14b)],0x1*-0xd86+0x46*-0x5+-0x772*-0x2))return![];for(const _0x45843c of _0x9c171e){if(_0x1b0297[_0x386eb7(0x408,0x3e3,0x3a6,0x3ec)](_0x45843c))return!![];}function _0x386eb7(_0xa0b506,_0x58831f,_0x5cc055,_0x4bdcba){return _0x3adb(_0x4bdcba-0x243,_0x58831f);}return![];}export function mergeAdjacentMessages(_0x3474eb){const _0x4ec2e7={'yoqiN':function(_0x712dd0,_0x5e7c1c,_0xbbe32a,_0x2e8b1c,_0xa4125c){return _0x712dd0(_0x5e7c1c,_0xbbe32a,_0x2e8b1c,_0xa4125c);},'vqanR':function(_0x17fba5,_0x312c11,_0x64831a,_0x1ac8df){return _0x17fba5(_0x312c11,_0x64831a,_0x1ac8df);},'tmEEl':function(_0x3602b8,_0x3180d7){return _0x3602b8===_0x3180d7;},'RqzSK':function(_0x4a844c,_0x8c906){return _0x4a844c!==_0x8c906;},'EnDag':_0x33d0ec(0x2c8,0x2b4,0x2bd,0x2fc),'lSqhU':function(_0x24ddc5,_0x2f8b3e){return _0x24ddc5===_0x2f8b3e;},'Lxfhl':function(_0x2d273e,_0x4c30bf){return _0x2d273e!==_0x4c30bf;},'Plzwj':_0x33d0ec(0x2b4,0x2d0,0x2d6,0x2a0),'pkbvQ':'suHxo'};function _0x42cba4(_0x2e2f17,_0x59fe35,_0x58d500,_0x14911f){return _0x3adb(_0x2e2f17- -0x1c0,_0x14911f);}if(!_0x3474eb||_0x4ec2e7[_0x42cba4(-0x1c,0xb,0x3,-0x57)](_0x3474eb[_0x42cba4(-0x34,0xb,-0x1e,0xb)],-0x1889+0x1e7f*-0x1+-0x4*-0xdc2))return[];const _0x31f9b7=[];let _0x1818c4=null;for(const _0x1cb09a of _0x3474eb){if(_0x4ec2e7[_0x42cba4(-0x7,-0x4f,-0x2c,-0x1)](_0x4ec2e7[_0x33d0ec(0x331,0x309,0x2f4,0x343)],_0x4ec2e7[_0x42cba4(0x19,0x10,0x52,0x48)]))_0x201b25[_0x4b6d8b]=_0x4ec2e7[_0x42cba4(-0x23,0x12,-0x5c,-0x3f)](_0x5a6d6d,_0x396347[_0x23399c],_0x2ffe73,_0x207440,_0x46e0f6);else{if(!_0x1818c4){const _0x47543f={..._0x1cb09a};_0x1818c4=_0x47543f;}else{if(_0x4ec2e7[_0x42cba4(-0x8,-0x54,0x3d,-0x6)](_0x1818c4[_0x42cba4(-0x64,-0x18,-0xae,-0x93)],_0x1cb09a[_0x42cba4(-0x64,-0x6f,-0x24,-0x21)])){if(_0x4ec2e7['Lxfhl'](_0x4ec2e7[_0x33d0ec(0x31b,0x2da,0x2a8,0x2a5)],_0x4ec2e7[_0x42cba4(-0x16,-0x21,-0x59,-0x48)]))return{..._0x3908ef,'text':_0x4ec2e7['vqanR'](_0x184130,_0x26fc9f[_0x42cba4(-0x63,-0x40,-0x2d,-0xae)],_0x32b709,_0x4b049d)};else _0x1818c4[_0x42cba4(-0x5e,-0x29,-0xa4,-0x51)]=mergeContent(_0x1818c4[_0x42cba4(-0x5e,-0x89,-0x31,-0x8c)],_0x1cb09a[_0x42cba4(-0x5e,-0x55,-0x97,-0x72)]);}else{_0x31f9b7[_0x42cba4(-0x55,-0x79,-0x91,-0x20)](_0x1818c4);const _0x1ba9e4={..._0x1cb09a};_0x1818c4=_0x1ba9e4;}}}}function _0x33d0ec(_0xad1a2a,_0x29e88e,_0x37cde0,_0x1b2bc1){return _0x3adb(_0x29e88e-0x130,_0x1b2bc1);}if(_0x1818c4){if(_0x4ec2e7['pkbvQ']===_0x4ec2e7['pkbvQ'])_0x31f9b7[_0x42cba4(-0x55,-0x54,-0x6e,-0x44)](_0x1818c4);else{const _0x3dff53={};for(const _0x3f9fda in _0xf6a2b6){_0x3dff53[_0x3f9fda]=_0x4ec2e7['yoqiN'](_0x4d2e4e,_0x2c8049[_0x3f9fda],_0x146109,_0x257c7d,_0x48ceaa);}return _0x3dff53;}}return _0x31f9b7;}function mergeContent(_0xc362e6,_0x54bed8){const _0x50dfa6={'iFiDf':function(_0x459099,_0x3475ad){return _0x459099===_0x3475ad;},'TddQj':_0x4bc463(0x18c,0x1c1,0x1a4,0x1c6),'qGOvf':function(_0x4711f3,_0x40ef86){return _0x4711f3+_0x40ef86;},'EnwAl':function(_0x44861f,_0x3ff29c){return _0x44861f+_0x3ff29c;},'HuoQS':function(_0x2b3f2b,_0x25ffc0){return _0x2b3f2b(_0x25ffc0);},'obIGe':_0x40aeb1(0x387,0x418,0x3d0,0x3d2)};if(_0x50dfa6[_0x40aeb1(0x43e,0x42f,0x45e,0x440)](typeof _0xc362e6,_0x50dfa6['TddQj'])&&_0x50dfa6[_0x4bc463(0x1d6,0x1f3,0x219,0x22c)](typeof _0x54bed8,'string'))return _0x50dfa6['qGOvf'](_0x50dfa6[_0x40aeb1(0x457,0x43c,0x472,0x429)](_0xc362e6,'\x0a'),_0x54bed8);const _0x4279bc=normalizeToArray(_0xc362e6);function _0x4bc463(_0x40ad82,_0x6464d2,_0x277321,_0x449120){return _0x3adb(_0x6464d2-0x28,_0x40ad82);}const _0x2d1049=_0x50dfa6['HuoQS'](normalizeToArray,_0x54bed8),_0x278d59={};_0x278d59['type']=_0x50dfa6['obIGe'],_0x278d59[_0x40aeb1(0x3cb,0x3a4,0x40c,0x3d2)]='\x0a';function _0x40aeb1(_0x32494e,_0x27dc2d,_0x3b7ac,_0x38c889){return _0x3adb(_0x38c889-0x275,_0x32494e);}return[..._0x4279bc,_0x278d59,..._0x2d1049];}function normalizeToArray(_0x2388f7){const _0x133d72={};_0x133d72[_0x9181fb(0x1aa,0x1a6,0x1ce,0x1d9)]=function(_0x1fd1c9,_0x40feac){return _0x1fd1c9!==_0x40feac;};function _0x9181fb(_0x37e62f,_0x3373bd,_0x4cb45f,_0x43e68f){return _0x3adb(_0x3373bd-0x4,_0x37e62f);}_0x133d72['CwJvt']='zeMyJ',_0x133d72['ryrCK']=_0x138406(0x143,0xde,0x136,0xf7),_0x133d72[_0x138406(0x16f,0xe2,0x117,0x12a)]=function(_0x5bca5a,_0x491a48){return _0x5bca5a||_0x491a48;};const _0x1308cf=_0x133d72;function _0x138406(_0xe95fa5,_0x283f04,_0x147ee3,_0x38985b){return _0x3adb(_0x38985b- -0x66,_0x147ee3);}if(Array[_0x138406(0x14e,0x14c,0x128,0x16a)](_0x2388f7))return _0x1308cf['tDqQl'](_0x1308cf[_0x9181fb(0x1ab,0x1b7,0x188,0x1c7)],_0x1308cf[_0x138406(0x156,0x15f,0x168,0x14d)])?![]:_0x2388f7;return[{'type':_0x1308cf[_0x9181fb(0x18c,0x16b,0x132,0x134)],'text':_0x1308cf[_0x9181fb(0x1d3,0x194,0x19f,0x1c6)](_0x2388f7,'')}];}export function replacePlaceholder(_0x68ce6,_0x58dee7,_0x506199,_0x56911f){const _0x94fa21={};_0x94fa21['fHcOK']=function(_0x72b4b7,_0x2e2d8c){return _0x72b4b7===_0x2e2d8c;},_0x94fa21[_0xdce06(0x3ba,0x3d3,0x3de,0x3ba)]='string',_0x94fa21[_0x14cea9(0xee,0x10a,0x12d,0x126)]='qmCHQ',_0x94fa21['NllEx']=_0xdce06(0x38a,0x3ab,0x3e7,0x3c3),_0x94fa21[_0xdce06(0x3f7,0x3dd,0x420,0x3cb)]=function(_0xcc4e16,_0x5ce5db){return _0xcc4e16||_0x5ce5db;},_0x94fa21[_0xdce06(0x431,0x3fa,0x3e5,0x3f4)]=function(_0x1d74a1,_0x5593a7){return _0x1d74a1===_0x5593a7;},_0x94fa21[_0x14cea9(0xd8,0xc5,0x108,0x146)]=_0xdce06(0x41e,0x3d4,0x3ba,0x3c4),_0x94fa21[_0xdce06(0x3b3,0x3f3,0x3c9,0x3f9)]=function(_0x9e736b,_0x1a880c){return _0x9e736b!==_0x1a880c;},_0x94fa21[_0x14cea9(0xe5,0x123,0xf9,0x12b)]=_0x14cea9(0x117,0x167,0x127,0x13a);const _0x4dfb13=_0x94fa21;if(_0x4dfb13[_0x14cea9(0x112,0x187,0x15e,0x1a9)](typeof _0x68ce6,_0x4dfb13[_0xdce06(0x395,0x3d3,0x3d8,0x38c)])){if(_0x4dfb13['fHcOK'](_0x4dfb13[_0xdce06(0x444,0x3fe,0x3b4,0x3fc)],_0x4dfb13['NllEx']))_0x1a5501[_0x14cea9(0x10f,0x142,0x11d,0x127)+'ta']['variables']={};else return _0x506199&&_0x68ce6[_0xdce06(0x442,0x409,0x435,0x3d5)](_0x58dee7)&&(_0x56911f&&_0x56911f[_0x14cea9(0x119,0x11c,0x13e,0x105)](_0x58dee7)),_0x68ce6[_0x14cea9(0xb6,0x14a,0x100,0xc8)](_0x58dee7,_0x4dfb13[_0xdce06(0x3dd,0x3dd,0x3b7,0x3b6)](_0x506199,''));}if(Array[_0xdce06(0x3f8,0x430,0x417,0x403)](_0x68ce6))return _0x68ce6[_0x14cea9(0x137,0x12f,0x13a,0x134)](_0x4a06f5=>replacePlaceholder(_0x4a06f5,_0x58dee7,_0x506199,_0x56911f));function _0x14cea9(_0x31f160,_0x823c17,_0x2dcd8c,_0xc6cc6e){return _0x3adb(_0x2dcd8c- -0x71,_0xc6cc6e);}function _0xdce06(_0x5e7183,_0x5548ff,_0x2353d5,_0x4e45ca){return _0x3adb(_0x5548ff-0x260,_0x2353d5);}if(_0x68ce6&&_0x4dfb13[_0xdce06(0x3de,0x3fa,0x3f9,0x404)](typeof _0x68ce6,_0x4dfb13['GzbFL'])){const _0x159984={};for(const _0x5e104f in _0x68ce6){_0x4dfb13['PmdpO'](_0x4dfb13[_0xdce06(0x3c3,0x3ca,0x383,0x3ac)],_0x4dfb13[_0x14cea9(0xc7,0x10c,0xf9,0x102)])?_0x326874[_0x14cea9(0x114,0x105,0xf1,0xf9)]=_0x465f01(_0x50c390[_0xdce06(0x386,0x3c2,0x408,0x3c7)],_0xe104ea[_0xdce06(0x3b1,0x3c2,0x3f8,0x3c4)]):_0x159984[_0x5e104f]=replacePlaceholder(_0x68ce6[_0x5e104f],_0x58dee7,_0x506199,_0x56911f);}return _0x159984;}return _0x68ce6;}export function replaceAllPlaceholders(_0x5ea5e9,_0xcb7c4){function _0x11a327(_0x334d85,_0xe6bf4c,_0x210e66,_0x4dd707){return _0x3adb(_0x4dd707- -0x60,_0x334d85);}const _0x4e0523={'CQrtd':function(_0x5b507d,_0xb41f1c){return _0x5b507d!==_0xb41f1c;},'RfIMw':_0x11a327(0xf8,0xf2,0xfd,0xec),'zEUlt':_0x2b7696(0x35,0x65,0x2e,0x60),'CEotq':function(_0x393737,_0x579963){return _0x393737===_0x579963;},'fhwWt':'text','KErly':_0x2b7696(0x4b,0x29,-0xe,-0x18),'lnRZi':function(_0x300fdf,_0x126ec6,_0x53a860,_0x4796aa){return _0x300fdf(_0x126ec6,_0x53a860,_0x4796aa);},'ItAwB':function(_0x53df5f){return _0x53df5f();},'PSWNv':function(_0x5042d2,_0x1c5b5d){return _0x5042d2!==_0x1c5b5d;},'PzstG':_0x11a327(0xb2,0xd1,0xce,0xe7),'XQMVO':_0x11a327(0x157,0x135,0x142,0x14d),'SnUuK':_0x2b7696(-0x29,-0x18,-0x18,-0x57),'OncEx':function(_0xb0a97f,_0x4abab0,_0x3f9580,_0x23b9ad,_0x281088){return _0xb0a97f(_0x4abab0,_0x3f9580,_0x23b9ad,_0x281088);},'VYjdq':'{{上下文}}','SrUBk':_0x11a327(0x15b,0x18f,0x19b,0x16d),'iwipa':'{{正文}}','fUvEH':_0x11a327(0x141,0xe3,0x145,0x108),'sCUgD':_0x11a327(0x1ac,0x12f,0x120,0x166)+'}}','UgzBh':function(_0x20c5a6,_0x59467b,_0x565c4d,_0x1acff9,_0x4194bc){return _0x20c5a6(_0x59467b,_0x565c4d,_0x1acff9,_0x4194bc);},'ttyAb':_0x11a327(0xd6,0xf6,0xf3,0x11f)+'}}','PQuzf':'{{用户需求}}','LFhSN':function(_0x5ebca0,_0x542ec5){return _0x5ebca0===_0x542ec5;},'Sjfnq':'KtePH','JJDYt':function(_0x51cb46,_0x4b84ab,_0x3786a1){return _0x51cb46(_0x4b84ab,_0x3786a1);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0xcb7c4,_0x4961fe=new Set();let _0x1807e9=_0x5ea5e9;const _0x19db54=_0x4e0523[_0x2b7696(-0x42,-0x28,-0xf,-0x2b)](getContext),_0x23f79e=_0x19db54?.[_0x2b7696(0x3f,0x2c,-0x1d,0x1e)]||'';let _0x2d496c=worldBookContent;function _0x2b7696(_0x3f063d,_0x4ef490,_0x5c27a6,_0x466c67){return _0x3adb(_0x4ef490- -0x170,_0x3f063d);}if(_0x2d496c){if(_0x4e0523['PSWNv'](_0x11a327(0x108,0x112,0xef,0xe7),_0x4e0523[_0x11a327(0x128,0x13e,0x160,0x120)])){if(_0x166c33[_0x2b7696(-0x34,-0x24,-0x3f,0x7)]&&_0x4e0523[_0x2b7696(0x2c,0x50,0x4b,0x52)](_0x27689a[_0x2b7696(0xa,-0x24,-0x56,0x1a)][_0x11a327(0x140,0x179,0xf9,0x137)](),'')){const _0x23ae56={};_0x23ae56[_0x11a327(0xd5,0xf9,0xc4,0xfc)]=_0x4e0523[_0x11a327(0x17a,0x142,0xec,0x134)],_0x23ae56[_0x2b7696(-0x29,-0xe,-0x58,0x17)]=_0x569684[_0x11a327(0x123,0xd7,0xc7,0xec)],_0x1ad457[_0x2b7696(0x3a,-0x5,-0x6,-0x33)](_0x23ae56);}if(_0x32e707['assistant']&&_0xe6375c[_0x2b7696(0x9a,0x65,0x94,0x4c)]['trim']()!==''){const _0x3728dc={};_0x3728dc[_0x2b7696(0x9,-0x14,-0x24,-0x11)]=_0x4e0523[_0x2b7696(0x26,0x5a,0x28,0x1b)],_0x3728dc['content']=_0x77a4ed[_0x11a327(0x17f,0x1b0,0x162,0x175)],_0x210c36[_0x11a327(0x102,0x140,0x112,0x10b)](_0x3728dc);}}else _0x2d496c=_0x2d496c[_0x11a327(0x137,0xf6,0xe2,0x111)](_0x4e0523[_0x11a327(0x111,0xee,0x126,0xe6)],_0x23f79e),_0x2d496c=_0x2d496c['replaceAll'](_0x4e0523['SnUuK'],_0x23f79e);}_0x1807e9=_0x4e0523[_0x2b7696(-0x24,-0x11,-0x33,-0x30)](replacePlaceholder,_0x1807e9,_0x4e0523['VYjdq'],context,_0x4961fe),_0x1807e9=_0x4e0523[_0x11a327(0xcd,0x133,0xc1,0xff)](replacePlaceholder,_0x1807e9,_0x4e0523[_0x11a327(0x13d,0x136,0x14a,0x15d)],_0x2d496c,_0x4961fe),_0x1807e9=_0x4e0523[_0x11a327(0x12c,0x12e,0xd3,0xff)](replacePlaceholder,_0x1807e9,_0x4e0523[_0x11a327(0x141,0x14d,0x12a,0x126)],body,_0x4961fe),_0x1807e9=_0x4e0523[_0x11a327(0x131,0x133,0xde,0xff)](replacePlaceholder,_0x1807e9,_0x4e0523['fUvEH'],characterListText,_0x4961fe),_0x1807e9=_0x4e0523[_0x2b7696(-0x18,-0x11,-0x4f,0x1b)](replacePlaceholder,_0x1807e9,_0x4e0523['sCUgD'],outfitEnableListText,_0x4961fe),_0x1807e9=_0x4e0523[_0x2b7696(0x8e,0x41,0x8e,0x1f)](replacePlaceholder,_0x1807e9,_0x4e0523[_0x11a327(0x18a,0x10e,0x157,0x150)],commonCharacterListText,_0x4961fe),_0x1807e9=_0x4e0523[_0x11a327(0x14f,0x121,0x142,0x151)](replacePlaceholder,_0x1807e9,_0x4e0523[_0x2b7696(0x2b,0x66,0x69,0x4c)],userDemand,_0x4961fe);if(variables&&Object['keys'](variables)[_0x2b7696(0x53,0x1c,0x2b,0x53)]>-0x297+0x425*-0x1+-0x1*-0x6bc){const _0x43805f=/\{\{getvar::([^}]+)\}\}/g,_0x4b0c0b=JSON['stringify'](_0x1807e9),_0x294be4=[..._0x4b0c0b[_0x2b7696(0x37,0x13,0x27,0x1f)](_0x43805f)],_0x158595=new Set();for(const _0x327e2d of _0x294be4){_0x158595['add'](_0x327e2d[0x837+0x94f*-0x4+0x1d06]);}for(const _0x2a9e0b of _0x158595){if(_0x4e0523['LFhSN'](_0x2b7696(-0x17,-0xc,-0x20,-0x7),_0x4e0523[_0x11a327(0x142,0x148,0x147,0x146)])){if(_0x5d8636&&_0x4e0523[_0x2b7696(0x94,0x4e,0x44,0x5a)](_0x588ff1[_0x2b7696(0x2f,0x12,-0x9,-0x25)],_0x4e0523[_0x2b7696(-0x3c,-0x19,-0x53,-0x17)])&&_0x4e0523[_0x2b7696(0x76,0x4e,0x43,0x4b)](typeof _0x538a7a[_0x2b7696(0x16,-0x13,-0x4c,0x1b)],_0x4e0523[_0x11a327(0x175,0x158,0x12f,0x155)]))return{..._0x4dfb59,'text':_0x4e0523[_0x11a327(0x138,0x152,0x151,0x17c)](_0x2e2424,_0x548f1c[_0x11a327(0xb1,0xca,0xe1,0xfd)],_0x509081,_0x4d5619)};return _0x5654fa;}else{const _0x1682e0=_0x11a327(0x107,0xec,0x167,0x132)+_0x2a9e0b+'}}',_0xa6b94a=variables[_0x2a9e0b]||'';_0x1807e9=replacePlaceholder(_0x1807e9,_0x1682e0,_0xa6b94a,_0x4961fe);}}}_0x1807e9=_0x4e0523['JJDYt'](processVariablePlaceholdersInMessages,_0x1807e9,_0x4961fe);const _0x3cd9ba={};return _0x3cd9ba['messages']=_0x1807e9,_0x3cd9ba['replacedVa'+_0x2b7696(-0x3f,-0x1b,-0x32,-0x17)]=_0x4961fe,_0x3cd9ba;}function processVariablePlaceholdersInMessages(_0x4f0e0e,_0x380d5f){const _0x5a9bab={'OZiNv':function(_0x1bd1a7,_0x536ec2,_0x33bd1b,_0x59902c){return _0x1bd1a7(_0x536ec2,_0x33bd1b,_0x59902c);},'IsnJH':function(_0x23219a,_0x457826){return _0x23219a===_0x457826;},'dWCdO':function(_0x347f0f){return _0x347f0f();}};function _0xf13d68(_0x201e92,_0x1ff861,_0x184a56,_0x3fec3c){return _0x3adb(_0x201e92- -0xb7,_0x1ff861);}if(!_0x4f0e0e||_0x5a9bab[_0x39b128(0x3e4,0x3d2,0x401,0x3a2)](_0x4f0e0e[_0xf13d68(0xd5,0xe4,0xb8,0x100)],-0x2210+-0x3*0x3df+0x2dad))return _0x4f0e0e;const _0x21dd2b=_0x5a9bab[_0x39b128(0x3da,0x406,0x401,0x3ca)](getContext);!_0x21dd2b[_0x39b128(0x403,0x42a,0x41c,0x419)+'ta']&&(_0x21dd2b[_0xf13d68(0xd7,0x94,0x9e,0xf9)+'ta']={});!_0x21dd2b[_0x39b128(0x403,0x42b,0x3bc,0x406)+'ta'][_0xf13d68(0xa2,0x5e,0x64,0xab)]&&(_0x21dd2b[_0xf13d68(0xd7,0x9b,0xc5,0x104)+'ta'][_0x39b128(0x3ce,0x3b4,0x39d,0x3f4)]={});function _0x39b128(_0x3af073,_0x2aad51,_0xc7adef,_0x110bb6){return _0x3adb(_0x3af073-0x275,_0x2aad51);}return _0x4f0e0e[_0x39b128(0x420,0x42e,0x3ea,0x3f3)](_0x2cd9a3=>{function _0x50a9dc(_0x20ec89,_0x30aa20,_0x5b942c,_0x7ee8dd){return _0x39b128(_0x7ee8dd- -0x48c,_0x5b942c,_0x5b942c-0x1d5,_0x7ee8dd-0x56);}if(!_0x2cd9a3||!_0x2cd9a3[_0x11e279(0x14b,0x168,0x141,0x153)])return _0x2cd9a3;function _0x11e279(_0x172bfb,_0x301b82,_0x2ba054,_0x50d48e){return _0xf13d68(_0x172bfb-0xa0,_0x2ba054,_0x2ba054-0xc6,_0x50d48e-0xcf);}return{..._0x2cd9a3,'content':_0x5a9bab[_0x11e279(0x17f,0x15a,0x1a4,0x19b)](processContentVariables,_0x2cd9a3[_0x11e279(0x14b,0x13d,0x11d,0x10a)],_0x21dd2b,_0x380d5f)};});}function processContentVariables(_0x52b257,_0x5bd8d8,_0x17eb44){const _0x1e089c={'DjqJB':_0x11a8a4(0x1ea,0x1ba,0x18a,0x1c5),'rMLkS':_0x11a8a4(0x255,0x232,0x218,0x207),'KbYZY':function(_0x40fabf,_0x4ce266){return _0x40fabf===_0x4ce266;},'bOUuW':_0x4f9932(0x34b,0x382,0x343,0x345),'WtyRO':function(_0x1e077d,_0x147b9e){return _0x1e077d!==_0x147b9e;},'gxAoC':_0x4f9932(0x38b,0x37d,0x389,0x378),'HvAFv':function(_0x5c95d5,_0x4e472e,_0x4644fc,_0x37952a){return _0x5c95d5(_0x4e472e,_0x4644fc,_0x37952a);}};function _0x11a8a4(_0x264d1b,_0x2998ad,_0x336981,_0x2eab4f){return _0x3adb(_0x2998ad-0x64,_0x2eab4f);}if(_0x1e089c[_0x11a8a4(0x181,0x1b3,0x1e9,0x176)](typeof _0x52b257,_0x1e089c[_0x4f9932(0x31f,0x336,0x325,0x2f5)])){if(_0x1e089c[_0x4f9932(0x3b0,0x37c,0x350,0x375)](_0x1e089c[_0x4f9932(0x379,0x309,0x2f8,0x334)],_0x11a8a4(0x244,0x230,0x27a,0x21f)))_0x1f1f40[_0x11a8a4(0x1f4,0x213,0x1c7,0x237)](_0x4f9932(0x2ee,0x34b,0x2fe,0x307)+_0x53ea2d+'@}');else return _0x1e089c['HvAFv'](processStringVariables,_0x52b257,_0x5bd8d8,_0x17eb44);}function _0x4f9932(_0x1511c0,_0x5c5d4c,_0x32ebcb,_0x4306e2){return _0x3adb(_0x4306e2-0x1ac,_0x1511c0);}if(Array[_0x11a8a4(0x200,0x234,0x23f,0x27f)](_0x52b257))return _0x52b257[_0x4f9932(0x347,0x362,0x334,0x357)](_0x4809d3=>{function _0x7fc73a(_0x1b1e09,_0x5b7a3c,_0x35b8ad,_0x1b6d73){return _0x4f9932(_0x1b1e09,_0x5b7a3c-0x113,_0x35b8ad-0xc6,_0x35b8ad-0x206);}function _0x71516(_0x266e19,_0x55f924,_0x41ef77,_0x1d190d){return _0x4f9932(_0x55f924,_0x55f924-0x1bf,_0x41ef77-0x17a,_0x41ef77- -0x2c9);}if(_0x1e089c[_0x71516(0xb5,0x52,0x9d,0x53)]!==_0x1e089c[_0x7fc73a(0x53c,0x52d,0x560,0x5a6)]){if(_0x4809d3&&_0x4809d3['type']===_0x71516(0x6c,0x17,0x40,0x43)&&_0x1e089c['KbYZY'](typeof _0x4809d3['text'],_0x1e089c[_0x71516(-0x10,-0xf,0x2c,0x4c)]))return{..._0x4809d3,'text':processStringVariables(_0x4809d3[_0x7fc73a(0x4d8,0x540,0x50f,0x4d3)],_0x5bd8d8,_0x17eb44)};return _0x4809d3;}else{_0xf91aaa['push'](_0x46ebf1);const _0x2e8d76={..._0x27d2b0};_0x39a656=_0x2e8d76;}});return _0x52b257;}function processStringVariables(_0x4444b0,_0x15bdf2,_0x52d9c6){const _0x31247c={'CBKpt':function(_0x2f4586,_0x101776){return _0x2f4586===_0x101776;},'GbkRP':_0x3b89ee(0x279,0x28e,0x270,0x285),'kxpzK':function(_0x5c2a13,_0x5ab0c0){return _0x5c2a13!==_0x5ab0c0;},'KPhQZ':function(_0x30947a,_0x320982){return _0x30947a(_0x320982);},'hvrts':function(_0x5c5315,_0x15feb0){return _0x5c5315===_0x15feb0;},'vahjH':_0x413d6b(-0x202,-0x1dc,-0x1e9,-0x1c6),'obRqI':'XrNUS'};function _0x413d6b(_0x2fc56a,_0x1926d1,_0x5edef5,_0x3da1fa){return _0x3adb(_0x5edef5- -0x3b0,_0x3da1fa);}if(!_0x4444b0)return _0x4444b0;let _0x1a109e=_0x4444b0;_0x1a109e=_0x1a109e['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2a6a37,_0x4baf1c,_0x388dca)=>{function _0x4da322(_0x190ce7,_0x2242b4,_0x330d35,_0x1683fc){return _0x3b89ee(_0x190ce7-0x9c,_0x2242b4-0x1ec,_0x190ce7- -0x1c4,_0x330d35);}const _0x973632=_0x4baf1c[_0x2d7489(0x513,0x4d6,0x521,0x4ea)]();_0x15bdf2[_0x2d7489(0x50a,0x518,0x4d2,0x556)+'ta'][_0x4da322(0xc0,0xb9,0xd0,0x85)][_0x973632]=_0x388dca;_0x52d9c6&&_0x52d9c6[_0x2d7489(0x52b,0x52f,0x523,0x570)]('{@setvar::'+_0x973632+'@}');function _0x2d7489(_0x52632f,_0x45df6f,_0x55814f,_0x3a8a07){return _0x3b89ee(_0x52632f-0x7,_0x45df6f-0x187,_0x52632f-0x251,_0x55814f);}return'';}),_0x1a109e=_0x1a109e['replace'](/\{@getvar::([^@]+)@\}/g,(_0x502f76,_0x2bda51)=>{const _0x413e66=_0x2bda51[_0xc476ec(0xc,-0x6,0x1a,0xa)]();function _0xc476ec(_0x36643a,_0xd7b497,_0x39978f,_0x41dbed){return _0x413d6b(_0x36643a-0x73,_0xd7b497-0x52,_0x39978f-0x233,_0x36643a);}const _0xab223c=_0x15bdf2[_0x4fda46(-0x6b,-0x62,-0x4f,-0x60)+'ta']['variables'][_0x413e66]||'';_0x52d9c6&&_0x52d9c6[_0xc476ec(0x20,0x60,0x32,0x4e)](_0x4fda46(-0x64,-0x76,-0x82,-0xbd)+_0x413e66+'@}');function _0x4fda46(_0x5ce6cb,_0x57d18e,_0x57fad8,_0x1596ce){return _0x3b89ee(_0x5ce6cb-0x15d,_0x57d18e-0x137,_0x57fad8- -0x308,_0x1596ce);}return _0xab223c;}),_0x1a109e=_0x1a109e[_0x3b89ee(0x248,0x26b,0x27f,0x235)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x1452c9,_0x352d6d,_0x555c7b)=>{function _0x153230(_0x56cf26,_0x3ff971,_0x58cb8e,_0xee6af9){return _0x413d6b(_0x56cf26-0xc7,_0x3ff971-0x87,_0xee6af9-0x263,_0x3ff971);}const _0xc71115=_0x352d6d['trim']();setglobalvar(_0xc71115,_0x555c7b);function _0x75fb30(_0x372513,_0x2838a9,_0x5d02c1,_0x2e7962){return _0x3b89ee(_0x372513-0x72,_0x2838a9-0x5b,_0x372513- -0x473,_0x5d02c1);}return _0x52d9c6&&_0x52d9c6[_0x153230(0x9f,0x8b,0x76,0x62)](_0x153230(0x46,0x7e,0x5d,0x3d)+_0x153230(0x14,0x4e,0x75,0x2e)+_0xc71115+'@}'),'';}),_0x1a109e=_0x1a109e['replace'](/\{@getglobalvar::([^@]+)@\}/g,(_0x3cc2f3,_0x45f67e)=>{const _0x420bdf=_0x45f67e['trim']();function _0x3458e9(_0x26c625,_0x10cbff,_0x2f57f3,_0x92b48d){return _0x3b89ee(_0x26c625-0x12f,_0x10cbff-0x9e,_0x10cbff-0x188,_0x92b48d);}const _0x31f132=getglobalvar(_0x420bdf)||'';if(_0x52d9c6){if(_0x31247c[_0x20638b(0x21d,0x1ef,0x1ee,0x1dc)]===_0x3458e9(0x3d8,0x3f8,0x3d2,0x3b0))_0x52d9c6['add'](_0x3458e9(0x476,0x442,0x48e,0x46e)+_0x20638b(0x1fa,0x1ca,0x1dc,0x1eb)+_0x420bdf+'@}');else{if(!_0x30dc8d||_0x31247c[_0x3458e9(0x477,0x48b,0x499,0x45a)](_0x5dba37['length'],-0x1ee8+0x25e3*-0x1+0xb*0x641))return _0x140248;const _0x53896f=_0x47b3ae();return!_0x53896f[_0x20638b(0x1cd,0x23f,0x202,0x1fe)+'ta']&&(_0x53896f['chatMetada'+'ta']={}),!_0x53896f[_0x3458e9(0x401,0x441,0x455,0x466)+'ta']['variables']&&(_0x53896f['chatMetada'+'ta']['variables']={}),_0x3596a8['map'](_0x2b591c=>{if(!_0x2b591c||!_0x2b591c['content'])return _0x2b591c;function _0x3e3079(_0x1f376c,_0x233099,_0x12fba5,_0x5016b7){return _0x3458e9(_0x1f376c-0x54,_0x5016b7- -0x15f,_0x12fba5-0x15a,_0x1f376c);}return{..._0x2b591c,'content':_0x57b897(_0x2b591c[_0x3e3079(0x2e7,0x2fe,0x2ed,0x2b6)],_0x53896f,_0xf87d21)};});}}function _0x20638b(_0x5d7e7e,_0x5008e1,_0x44b9ce,_0x14f5d0){return _0x3b89ee(_0x5d7e7e-0x13,_0x5008e1-0x120,_0x14f5d0- -0xbb,_0x5d7e7e);}return _0x31f132;}),_0x1a109e=_0x1a109e[_0x413d6b(-0x29b,-0x220,-0x25c,-0x22b)](/\{@getworldvar::([^@]+)@\}/g,(_0x189729,_0x395684)=>{function _0x5eaf00(_0x6ed678,_0x2ad962,_0x355f6f,_0x1b2d0b){return _0x3b89ee(_0x6ed678-0xf7,_0x2ad962-0x1ad,_0x2ad962-0x165,_0x1b2d0b);}function _0xe8c2b8(_0xbd31ed,_0x5c3177,_0x1f126a,_0x8970b){return _0x413d6b(_0xbd31ed-0x6e,_0x5c3177-0x157,_0x1f126a-0x73e,_0x5c3177);}if(_0x31247c['kxpzK'](_0x5eaf00(0x41f,0x3e0,0x3ab,0x3ac),_0x5eaf00(0x3ed,0x3fe,0x40b,0x3cb))){const _0x14b56c=_0x395684[_0x5eaf00(0x3f5,0x427,0x3e7,0x410)](),_0x143c6e=_0x31247c[_0xe8c2b8(0x4e6,0x556,0x517,0x52b)](getworldvar,_0x14b56c)||'';return _0x52d9c6&&(_0x31247c[_0x5eaf00(0x431,0x442,0x431,0x473)](_0x31247c[_0xe8c2b8(0x52b,0x4d1,0x4fe,0x513)],_0x31247c['obRqI'])?_0xb4350a[_0x5eaf00(0x41e,0x43f,0x47f,0x418)](_0xe8c2b8(0x51f,0x523,0x518,0x4ff)+_0xe8c2b8(0x4ea,0x508,0x509,0x545)+_0x32026f+'@}'):_0x52d9c6[_0x5eaf00(0x484,0x43f,0x430,0x45f)](_0xe8c2b8(0x4c1,0x4d6,0x4e1,0x4c6)+_0x5eaf00(0x3ef,0x405,0x3f4,0x3dd)+_0x14b56c+'@}')),_0x143c6e;}else _0x1296c7[_0xe8c2b8(0x574,0x576,0x53d,0x55e)](_0xe8c2b8(0x508,0x57e,0x553,0x519)+_0x8d241c+'@}');});function _0x3b89ee(_0x521a7d,_0x201ca8,_0x1f74da,_0x5e0662){return _0x3adb(_0x1f74da-0x12b,_0x5e0662);}return _0x1a109e;}export function buildPromptWithTrigger(_0x5b8388){const _0x59ed4f={'aKYQV':function(_0x295f0a,_0x189743){return _0x295f0a+_0x189743;},'TxmlR':function(_0x2cb25c,_0x2af363,_0x2dcd4d){return _0x2cb25c(_0x2af363,_0x2dcd4d);},'oeNEj':function(_0x1edd42,_0xb881ae){return _0x1edd42(_0xb881ae);},'kEdnO':function(_0x1cee2f,_0xc849af){return _0x1cee2f===_0xc849af;},'fJUWN':_0x433b11(0x283,0x2e8,0x2c3,0x2be),'tyQfW':_0x433b11(0x31a,0x2d1,0x2dc,0x2ce),'YyieL':_0x433b11(0x314,0x308,0x303,0x30f),'XSDbF':function(_0x1f8433,_0x21263a){return _0x1f8433===_0x21263a;},'oKXmf':'trigger','FcZZU':'SoCqn','DGTfy':_0x433b11(0x2a2,0x2a1,0x2e6,0x29b),'sTePS':function(_0x3aced9,_0x599cae){return _0x3aced9!==_0x599cae;},'wHbpk':_0x433b11(0x306,0x2d0,0x2d0,0x311),'AvHGr':_0x4cd23d(0x3c,0x69,0x60,0x84),'fQLOA':function(_0xaf1a6a,_0x7182b7){return _0xaf1a6a!==_0x7182b7;},'zwfCS':_0x433b11(0x2cd,0x32e,0x31b,0x2f8),'KTAiw':function(_0x326828,_0x37d5f1){return _0x326828(_0x37d5f1);}},{requestType:_0x56de55,contextData:_0xc8b29a}=_0x5b8388,_0x554167=extension_settings[extensionName]?.[_0x433b11(0x290,0x2fe,0x2f5,0x2b7)+_0x4cd23d(0xaf,0x73,0x43,0x85)+'figs']||{},_0x15f42c={};function _0x4cd23d(_0x4b00c0,_0x1cfaa2,_0x399c61,_0x4c59e2){return _0x3adb(_0x4c59e2- -0xc8,_0x1cfaa2);}_0x15f42c[_0x4cd23d(0x11f,0xfd,0xdf,0xf7)+_0x433b11(0x26a,0x278,0x2da,0x2b5)]='默认';const _0x261c76=_0x554167[_0x56de55]||_0x15f42c,_0x4b26ba=_0x261c76['context_pr'+_0x4cd23d(0x8f,0xcc,0xf2,0xb0)]||'默认',_0x35f319=extension_settings[extensionName]?.[_0x433b11(0x289,0x2a2,0x309,0x2c4)+_0x4cd23d(0xec,0xce,0xc2,0xf9)+'s']||{},_0x2aeebb=_0x35f319[_0x4b26ba]||_0x35f319[Object['keys'](_0x35f319)[0x2*0xf9+-0x23e1+0x21ef]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0xc8b29a,_0x53a14e=[userDemand,context,body,worldBookContent][_0x433b11(0x2ee,0x298,0x2ac,0x2ca)](Boolean)[_0x4cd23d(0x129,0x154,0x137,0x10b)]('\x0a'),_0x424bb3=[];if(_0x2aeebb['entries']&&Array[_0x433b11(0x31e,0x304,0x305,0x30d)](_0x2aeebb['entries'])){if(_0x59ed4f[_0x433b11(0x279,0x300,0x27a,0x2b9)](_0x59ed4f['fJUWN'],_0x59ed4f[_0x433b11(0x2c6,0x2cf,0x324,0x305)]))for(const _0x523169 of _0x2aeebb[_0x4cd23d(0xb5,0x82,0xa9,0xaf)]){if(_0x59ed4f[_0x4cd23d(0x134,0x104,0x133,0xfb)]===_0x59ed4f[_0x4cd23d(0xc9,0xb0,0xbb,0xdf)])return _0x43e700[_0x4cd23d(0xbb,0x105,0x10e,0xe3)](_0x46d440=>_0x1a00bc(_0x46d440,_0x59b4de,_0x16395f,_0x290437));else{if(!_0x523169['enabled'])continue;if(!_0x523169[_0x433b11(0x274,0x270,0x2ba,0x29f)]||_0x59ed4f[_0x4cd23d(0x51,0x5e,0x42,0x7c)](_0x523169[_0x433b11(0x2b6,0x2e9,0x2e1,0x29f)][_0x433b11(0x2bb,0x2b3,0x2d6,0x2d4)](),''))continue;if(_0x59ed4f[_0x4cd23d(0x56,0x65,0x78,0x7c)](_0x523169[_0x433b11(0x2c0,0x28f,0x2a2,0x2d2)+'e'],_0x59ed4f[_0x4cd23d(0x13a,0x11c,0x156,0x10f)])){if(_0x59ed4f[_0x4cd23d(0xdf,0xac,0xd9,0xa5)]===_0x59ed4f[_0x4cd23d(0xe3,0xf0,0xbf,0xfc)])return _0x59ed4f[_0x433b11(0x31d,0x2ef,0x2b2,0x2f3)](_0x59ed4f[_0x4cd23d(0xfd,0x122,0x115,0xee)](_0x2bf572,'\x0a'),_0x1c501a);else{if(!_0x59ed4f[_0x433b11(0x301,0x27f,0x302,0x2c8)](checkTriggerWords,_0x523169[_0x433b11(0x2cb,0x2e0,0x2ce,0x318)+'ds'],_0x53a14e))continue;}}const _0x1c7b73={};_0x1c7b73['role']=_0x523169[_0x433b11(0x2aa,0x293,0x2b7,0x299)]||_0x433b11(0x27d,0x275,0x283,0x289),_0x1c7b73[_0x4cd23d(0x86,0x71,0xd7,0x9a)]=_0x523169['content'],_0x424bb3[_0x433b11(0x27f,0x2a1,0x27a,0x2a8)](_0x1c7b73);}}else{const _0x573337=_0x4c09be[_0x433b11(0x310,0x2a8,0x2b7,0x2d4)]();return _0x59ed4f[_0x4cd23d(0xfe,0x7c,0xc9,0xc3)](_0x3e923c,_0x573337,_0x5e2b70),_0x19fb80&&_0x5088c7['add'](_0x4cd23d(0xc9,0x9f,0xe3,0xc2)+_0x4cd23d(0xf1,0xa7,0xd2,0xb3)+_0x573337+'@}'),'';}}else{if(_0x2aeebb[_0x433b11(0x312,0x2c4,0x2d1,0x2dc)]&&Array[_0x4cd23d(0xe5,0xe5,0xc2,0x108)](_0x2aeebb[_0x433b11(0x2f1,0x315,0x315,0x2dc)]))for(const _0x4af404 of _0x2aeebb[_0x4cd23d(0xd0,0x8f,0xb2,0xd7)]){if(_0x4af404[_0x4cd23d(0xc5,0x55,0xae,0x84)]&&_0x4af404[_0x4cd23d(0x63,0x79,0xc7,0x84)][_0x4cd23d(0x8a,0xd1,0x118,0xcf)]()!==''){if(_0x59ed4f['sTePS'](_0x59ed4f[_0x4cd23d(0xdc,0x12d,0x146,0x109)],_0x59ed4f[_0x433b11(0x2f5,0x32f,0x2e9,0x30e)]))_0x300493&&_0x2a56[_0x433b11(0x2bf,0x2b3,0x2ae,0x2ec)](_0x46b6af);else{const _0x30393f={};_0x30393f[_0x433b11(0x2da,0x269,0x2cc,0x299)]=_0x59ed4f['AvHGr'],_0x30393f[_0x4cd23d(0x8b,0xde,0x98,0x9a)]=_0x4af404['user'],_0x424bb3[_0x4cd23d(0x67,0x6c,0x6e,0xa3)](_0x30393f);}}if(_0x4af404[_0x433b11(0x35d,0x308,0x2d9,0x312)]&&_0x59ed4f[_0x4cd23d(0x8e,0x92,0xaf,0xb6)](_0x4af404['assistant'][_0x433b11(0x2e8,0x304,0x28e,0x2d4)](),'')){if(_0x59ed4f[_0x433b11(0x273,0x277,0x280,0x2b9)](_0x59ed4f['zwfCS'],_0x59ed4f['zwfCS'])){const _0x9704da={};_0x9704da['role']=_0x4cd23d(0x118,0xc9,0xf8,0x10d),_0x9704da['content']=_0x4af404[_0x4cd23d(0xd4,0xec,0xe4,0x10d)],_0x424bb3['push'](_0x9704da);}else{const _0x914413={};return _0x914413[_0x433b11(0x26a,0x2a7,0x25e,0x28b)+'e']=_0x13f318,_0x914413['contextDat'+'a']=_0x3b1675,_0x59ed4f[_0x4cd23d(0x62,0xa7,0xaf,0xa1)](_0x2a12f7,_0x914413);}}}}const _0x1a0388=_0x59ed4f[_0x433b11(0x2ba,0x334,0x2cf,0x2f4)](mergeAdjacentMessages,_0x424bb3),{messages:_0x47dacc,replacedVariables:_0x1e6671}=replaceAllPlaceholders(_0x1a0388,_0xc8b29a);function _0x433b11(_0x2f79e2,_0x2fabf9,_0x371618,_0xce9b84){return _0x3adb(_0xce9b84-0x13d,_0x371618);}return _0x47dacc;}export function getProcessedPrompt(_0x1db9ff,_0x5ba385){const _0x353326={};return _0x353326['requestTyp'+'e']=_0x1db9ff,_0x353326['contextDat'+'a']=_0x5ba385,buildPromptWithTrigger(_0x353326);}