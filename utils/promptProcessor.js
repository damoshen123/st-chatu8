(function(_0x7b77fa,_0x27587b){function _0x37b8d8(_0x2e728a,_0x3c7c77,_0x568625,_0x272de9){return _0x5523(_0x3c7c77-0x37a,_0x2e728a);}function _0x2909f1(_0x10da48,_0x593a46,_0x11d783,_0x121649){return _0x5523(_0x593a46- -0x323,_0x121649);}const _0x32fc95=_0x7b77fa();while(!![]){try{const _0x170da5=-parseInt(_0x2909f1(-0x1f1,-0x229,-0x217,-0x205))/(0x2*-0x636+0x19a9*0x1+0xb*-0x134)*(-parseInt(_0x37b8d8(0x50e,0x4d6,0x4e3,0x4d1))/(0x2d7*0x8+-0x1c9+-0x14ed))+-parseInt(_0x2909f1(-0x1a2,-0x1cc,-0x206,-0x1ab))/(-0x22ed+-0x881+0x2b71)+-parseInt(_0x37b8d8(0x480,0x46a,0x429,0x44b))/(0xd7d+0xc92+-0x1a0b)+parseInt(_0x37b8d8(0x4dd,0x493,0x44e,0x4bc))/(0xfb1*-0x2+0x2305+-0x2*0x1cf)+-parseInt(_0x2909f1(-0x1a3,-0x1b2,-0x196,-0x1e3))/(-0x12f9+0xdd7+0x528)*(parseInt(_0x2909f1(-0x1e4,-0x1fc,-0x1d4,-0x225))/(0x3*-0xab+-0x1*-0x1636+-0x11f*0x12))+parseInt(_0x37b8d8(0x49d,0x489,0x465,0x4ab))/(0x29*0x27+0x193f*0x1+-0x1f76)*(-parseInt(_0x37b8d8(0x437,0x46d,0x44c,0x433))/(0x118d*0x1+0x13*0x127+-0x2769))+parseInt(_0x37b8d8(0x45f,0x4ab,0x4c0,0x4de))/(0x1543+0x1*-0x359+-0x11e0);if(_0x170da5===_0x27587b)break;else _0x32fc95['push'](_0x32fc95['shift']());}catch(_0x9ba720){_0x32fc95['push'](_0x32fc95['shift']());}}}(_0x3242,-0x43063+-0x7d873+0x11dff4));function _0x3242(){const _0x2ccec7=['ANvNA1i','z0rZEwi','D3LoCKy','A2v5CW','BgPLu3u','CMLHyMXLCW','DhjPBq','kcGOlISPkYKRkq','BgXTx3jLCxvLCW','AxnbCNjHEq','Df90ExbLx2nVBG','qM1RqMm','D3nRzNu','BgvUz3rO','ywrK','zvPMsNu','u0Dvug8','y29UDgvUDa','ogXyANzfEG','CMvWBgfJzq','CMvWBgfJzwrwyq','t2jxswm','E3VNLkJMIlFPNidMSyj9Fq','E0bZzxr2yxi6oG','BhzHCJO6','CM5Xt0W','ywTbquq','BwTIqKm','mZe5mta1nuz3CgvWqW','D2ftqxa','zxDxr0e','q0rztuC','DwLUrvG','s3jyD3e','A01SCwi','AfDdDNa','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','wKjNDwS','yvrKwK0','B2XWq0G','Dgv4Da','Dg9tDhjPBMC','mtC5oxrLAuThqq','CM9Szq','zxzMCwu','zw50CMLLCW','y2HHDe1LDgfKyq','DhLWzq','z1nLy1u','Bgrwufm','y29UDgv4Df9WCG','CwXgALi','ntuXmZKYmgPLt1Pkwa','D2zfug8','CujdDfu','ugHir2q','E0bZzxrNBg9Iyq','rvntCgm','DxLOywK','ENfuD0i','BwfW','vfPIEu4','ELrhqNC','DhjPz2DLCG','t0fuyKq','wK1dv24','te1XEw0','B2Ptzuu','DxnLCG','sK54Bg0','r2X3Dey','CfjcqwC','r01Jzgm','E3T1C2vYFx0','A3bWyKm','AgLZDg9YEq','D1zstMS','E0bNzxr3B3jSza','s010sMO','uhLQAMS','tLH5ENG','CMvXDwvZDfr5Ca','t0zzwKe','C2LLAxC','s1Lrr04','E3VKUiRKUiVMLOD9Fq','txb0C0u','rNvhsxi','txfKBKe','yvbAEwC','mta3ntmWmLrdsvHqwa','vNPNEvy','zfnqz1i','CMjPCeu','BMfTzte','mta3mM1drKLZtG','t3zKt2G','E3TNzxr2yxi6oG','B0Xut2G','q25Zwfm','CMvWBgfJzufSBa','zfrZwgq','s3LWyu8','E3VMRApMLOD9Fq','EhrPwMC','qxnbwfa','sKvVDxq','ChvZAa','uvPLvg0','DMfYoJO','tuvlDgu','ELbLtfG','C3rYAw5NAwz5','D3zYCue','zMLSDgvY','qvreDhm','ndiZnLrZq0zVAW','EhrFChjVzMLSzq','AMfeBui','CfLzANy','q05gC3K','E0bNzxr2yxi6oG','y2vpuwG','DMXMu1O','ALbKwNm','B2zPBgu','teniC2m','DKzNsvi','yxbWBhK','E0bNzxrNBg9Iyq','C2vHCMnO','C3rYAw5N','yxnZAxn0yw50','E3VKUjBNLyZKUABOP6BLJ5f9Fq','t0jlBxq','DeH3rgG','tNjyBLO','vufirgq','DMfYAwfIBgvZ','CvP1zLq','ote2nJG4qLPsENbV','DfLAzhm','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','mtiXmZm4ow1pDxPhrq','qMnkDhm','ufHozM0','Aw5JBhvKzxm','CgXHrxe','AMzoruG','C3bSAxq','mtGXwxrxs1jV','tujoqMW','phvZzxi+'];_0x3242=function(){return _0x2ccec7;};return _0x3242();}const _0x36f002=(function(){const _0x4e74ab={'akAAD':function(_0x4829a7,_0x48e26e){return _0x4829a7!==_0x48e26e;},'olpCH':_0x466818(0x3fd,0x42a,0x3db,0x430),'GHacb':function(_0x3c9f46,_0x2318ba){return _0x3c9f46!==_0x2318ba;},'JNxlm':_0x326b14(-0x11e,-0x152,-0x13f,-0x11a),'MptsE':function(_0x28a78f,_0x417828){return _0x28a78f(_0x417828);},'oLTOh':function(_0x4b6a07,_0x54012c){return _0x4b6a07===_0x54012c;},'GlwtF':'FrrRz','OVySY':_0x466818(0x431,0x450,0x43d,0x453)};function _0x326b14(_0x5eaae1,_0x10f78b,_0x2fd332,_0x3eab9e){return _0x5523(_0x5eaae1- -0x27b,_0x10f78b);}function _0x466818(_0x353b02,_0x351142,_0x41d8d9,_0x354764){return _0x5523(_0x353b02-0x2c6,_0x354764);}let _0x2de10a=!![];return function(_0x56a4fa,_0xadc8a6){function _0x513625(_0x46bd61,_0x3661ee,_0x3a0eb8,_0x2a1562){return _0x466818(_0x3a0eb8- -0x386,_0x3661ee-0xac,_0x3a0eb8-0x181,_0x46bd61);}function _0x10c028(_0x133761,_0x26091d,_0x430fa4,_0x2a22fb){return _0x326b14(_0x430fa4- -0x9b,_0x2a22fb,_0x430fa4-0x27,_0x2a22fb-0x81);}const _0x28438a={'AHred':function(_0x3e3576,_0x4bf9b0){function _0x45c363(_0x18acd2,_0xf256f9,_0x1c8330,_0x3a1a29){return _0x5523(_0x1c8330-0x123,_0x3a1a29);}return _0x4e74ab[_0x45c363(0x2bc,0x24c,0x276,0x27b)](_0x3e3576,_0x4bf9b0);}};if(_0x4e74ab[_0x10c028(-0x1ea,-0x1fd,-0x1b7,-0x1a0)](_0x4e74ab[_0x10c028(-0x1c4,-0x1a6,-0x1d3,-0x18a)],_0x4e74ab['OVySY']))return _0x384640;else{const _0x485bf6=_0x2de10a?function(){function _0x16f13b(_0x56d230,_0x456207,_0x37c588,_0x21136a){return _0x513625(_0x37c588,_0x456207-0x11a,_0x56d230- -0x165,_0x21136a-0x19c);}function _0x1fd4e5(_0x3b18e4,_0x409092,_0xb2fe58,_0x7dc31a){return _0x10c028(_0x3b18e4-0x16f,_0x409092-0x186,_0x3b18e4- -0x63,_0x7dc31a);}if(_0x4e74ab[_0x1fd4e5(-0x262,-0x243,-0x270,-0x25f)](_0x4e74ab[_0x16f13b(-0x101,-0x148,-0xd9,-0xe6)],_0x16f13b(-0xb2,-0xd4,-0xc0,-0xbe))){if(_0xadc8a6){if(_0x4e74ab['GHacb'](_0x4e74ab[_0x1fd4e5(-0x237,-0x25e,-0x212,-0x249)],_0x16f13b(-0xd5,-0xba,-0xe3,-0xaf))){const _0x132792=_0xadc8a6[_0x16f13b(-0x141,-0x171,-0x11b,-0x12d)](_0x56a4fa,arguments);return _0xadc8a6=null,_0x132792;}else{const _0x3b7f2b=_0x17618d['trim'](),_0xf4039e=_0x28438a['AHred'](_0x576e95,_0x3b7f2b)||'';return _0x5fe5d9&&_0x311918['add'](_0x16f13b(-0x140,-0x130,-0x17a,-0x157)+_0x1fd4e5(-0x264,-0x227,-0x284,-0x240)+_0x3b7f2b+'@}'),_0xf4039e;}}}else{const _0x466c7c=_0x4ea400[_0x1fd4e5(-0x276,-0x27f,-0x272,-0x23a)]();return _0xb45442(_0x466c7c,_0x155a10),_0x6524cc&&_0x5cf508[_0x1fd4e5(-0x26e,-0x22b,-0x270,-0x29d)](_0x16f13b(-0xf0,-0x135,-0xd2,-0xd0)+_0x16f13b(-0x110,-0xd4,-0xc6,-0xf5)+_0x466c7c+'@}'),'';}}:function(){};return _0x2de10a=![],_0x485bf6;}};}()),_0x80eb69=_0x36f002(this,function(){const _0xb65ae0={};function _0x52e84f(_0x294432,_0x2bbf51,_0x291c22,_0x2525fc){return _0x5523(_0x2bbf51- -0x361,_0x294432);}function _0x40e30e(_0x505e11,_0x27188c,_0x79fda4,_0xf26f7a){return _0x5523(_0x79fda4-0x8b,_0x505e11);}_0xb65ae0['gkOrZ']=_0x52e84f(-0x2a6,-0x25d,-0x24f,-0x2a1)+'+$';const _0x4cfe36=_0xb65ae0;return _0x80eb69[_0x52e84f(-0x225,-0x23b,-0x247,-0x1f0)]()[_0x52e84f(-0x29a,-0x27b,-0x234,-0x26c)](_0x4cfe36['gkOrZ'])[_0x40e30e(0x1b8,0x16a,0x1b1,0x16f)]()['constructo'+'r'](_0x80eb69)[_0x40e30e(0x174,0x1b6,0x171,0x16b)](_0x40e30e(0x1ba,0x1be,0x18f,0x1c4)+'+$');});_0x80eb69();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';function _0x5523(_0x5bbc88,_0x2d9ffe){_0x5bbc88=_0x5bbc88-(-0x9a6+0x216e+0x1*-0x16e9);const _0x376997=_0x3242();let _0x57449f=_0x376997[_0x5bbc88];if(_0x5523['qBTUAQ']===undefined){var _0x6c1354=function(_0x119c40){const _0x19839a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x533de4='',_0x574b8a='',_0x26b3c4=_0x533de4+_0x6c1354;for(let _0x10b111=0x1eaf+0x2042+0x14fb*-0x3,_0x274807,_0x31fed2,_0x4a1750=0x2a9*-0xa+0xb5*0x10+-0xce*-0x13;_0x31fed2=_0x119c40['charAt'](_0x4a1750++);~_0x31fed2&&(_0x274807=_0x10b111%(0xfcf+0x1b6e*-0x1+0xba3)?_0x274807*(-0x249d*0x1+0x65*0x2+-0x737*-0x5)+_0x31fed2:_0x31fed2,_0x10b111++%(-0x4cf*-0x3+0x23f7+0x1f0*-0x1a))?_0x533de4+=_0x26b3c4['charCodeAt'](_0x4a1750+(-0x24cb*0x1+-0x118c+-0x1*-0x3661))-(-0x1fed+-0x6c4+-0xce9*-0x3)!==-0x128e*-0x2+-0xfcf+-0x154d?String['fromCharCode'](0xe81+-0x233*0xb+0x1*0xaaf&_0x274807>>(-(-0x1b3+0xd0b+-0xb56)*_0x10b111&-0x26a5+0x1a30+0xc7b)):_0x10b111:-0x1e22+0x2370+-0xe*0x61){_0x31fed2=_0x19839a['indexOf'](_0x31fed2);}for(let _0x24e2a7=-0x1a92+-0x14ad*-0x1+-0x5e5*-0x1,_0x2e9b7e=_0x533de4['length'];_0x24e2a7<_0x2e9b7e;_0x24e2a7++){_0x574b8a+='%'+('00'+_0x533de4['charCodeAt'](_0x24e2a7)['toString'](0xdf0+0xdf*0x24+-0x2d3c))['slice'](-(-0x20bb+0x59*0x19+-0xab*-0x24));}return decodeURIComponent(_0x574b8a);};_0x5523['ypyxEr']=_0x6c1354,_0x5523['DjeHsY']={},_0x5523['qBTUAQ']=!![];}const _0x1e2feb=_0x376997[-0x40*0x2+0x21*-0x104+0x1102*0x2],_0x59b578=_0x5bbc88+_0x1e2feb,_0x5d7fbd=_0x5523['DjeHsY'][_0x59b578];if(!_0x5d7fbd){const _0x106ccc=function(_0x550ab4){this['bayPXJ']=_0x550ab4,this['MWQNbz']=[0x14ef*0x1+0x1*0x23c9+0x1*-0x38b7,0x1498+-0xf0d+0x1d9*-0x3,-0x260+-0xd78+0x548*0x3],this['RlADQO']=function(){return'newState';},this['WjTPUj']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ipACML']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x106ccc['prototype']['seteCl']=function(){const _0x143b78=new RegExp(this['WjTPUj']+this['ipACML']),_0x4db91e=_0x143b78['test'](this['RlADQO']['toString']())?--this['MWQNbz'][0x3*0xbf+-0xb0d+0x8d1]:--this['MWQNbz'][-0xb3f+-0xeda*-0x1+0xd*-0x47];return this['WcZwZj'](_0x4db91e);},_0x106ccc['prototype']['WcZwZj']=function(_0x273b71){if(!Boolean(~_0x273b71))return _0x273b71;return this['LXPqxx'](this['bayPXJ']);},_0x106ccc['prototype']['LXPqxx']=function(_0xdfc02f){for(let _0x12bfac=-0x1f32+-0x194+0x5*0x68e,_0x18b7a=this['MWQNbz']['length'];_0x12bfac<_0x18b7a;_0x12bfac++){this['MWQNbz']['push'](Math['round'](Math['random']())),_0x18b7a=this['MWQNbz']['length'];}return _0xdfc02f(this['MWQNbz'][0x19*-0x107+0x1*-0x1af9+-0x695*-0x8]);},new _0x106ccc(_0x5523)['seteCl'](),_0x57449f=_0x5523['ypyxEr'](_0x57449f),_0x5523['DjeHsY'][_0x59b578]=_0x57449f;}else _0x57449f=_0x5d7fbd;return _0x57449f;}export function checkTriggerWords(_0x173f8f,_0x575f91){const _0x27ee99={'zGCXa':function(_0xb91b60,_0x4a1b62,_0x20f8f9,_0x227074,_0xf3393a){return _0xb91b60(_0x4a1b62,_0x20f8f9,_0x227074,_0xf3393a);},'JEout':function(_0x1b25fd,_0x44199c){return _0x1b25fd||_0x44199c;},'zPeLX':function(_0x4653ef,_0x3273ef){return _0x4653ef===_0x3273ef;},'MqdnA':function(_0x144a64,_0x1712db){return _0x144a64!==_0x1712db;},'vFgIR':_0x14a44f(0x6f,0x21,0xb4,0x67)};if(_0x27ee99[_0x14a44f(0x81,0x75,0xd5,0xb6)](!_0x173f8f,!_0x575f91))return![];const _0x3d05cd=_0x173f8f[_0x14a44f(0x35,0x1e,0x1b,0x48)](',')[_0x14a44f(0x78,0x64,0xbd,0x88)](_0x13891f=>_0x13891f[_0x28926b(0x2e9,0x2bd,0x2e7,0x2ab)]())[_0x28926b(0x355,0x330,0x350,0x377)](_0x3208cc=>_0x3208cc);function _0x28926b(_0x2cd14b,_0x367778,_0x4af862,_0x5c5a2c){return _0x5523(_0x2cd14b-0x1e6,_0x367778);}function _0x14a44f(_0x9dabbe,_0x248f2a,_0x4b064b,_0xe9e953){return _0x5523(_0xe9e953- -0xb1,_0x248f2a);}if(_0x27ee99[_0x28926b(0x352,0x37b,0x328,0x34c)](_0x3d05cd['length'],0x123a+0x154c+-0x2786)){if(_0x27ee99[_0x14a44f(0x5e,0xd9,0x6e,0xa4)](_0x27ee99[_0x14a44f(0x49,0x6e,0x55,0x32)],_0x14a44f(0xad,0xa1,0x24,0x67))){const _0x46c7f6={};for(const _0x5da58c in _0x42f53a){_0x46c7f6[_0x5da58c]=_0x27ee99['zGCXa'](_0x3038cf,_0x280e21[_0x5da58c],_0x4b568b,_0x53704f,_0x26760e);}return _0x46c7f6;}else return![];}for(const _0x3d6805 of _0x3d05cd){if(_0x575f91[_0x14a44f(0x55,-0x6,0x70,0x45)](_0x3d6805))return!![];}return![];}export function mergeAdjacentMessages(_0x15e282){const _0x3b43e1={};function _0x1a0874(_0x2e0e22,_0x114431,_0x27affe,_0x3b8cf1){return _0x5523(_0x114431- -0x1c4,_0x27affe);}function _0x4f94e4(_0x3848b1,_0x216334,_0x4064df,_0x24d3ca){return _0x5523(_0x216334- -0x1f7,_0x3848b1);}_0x3b43e1[_0x4f94e4(-0xde,-0x10d,-0x107,-0x118)]=function(_0x110d72,_0x1ddf66){return _0x110d72===_0x1ddf66;},_0x3b43e1[_0x4f94e4(-0xb2,-0x83,-0x76,-0x37)]=_0x1a0874(-0xd3,-0xaa,-0xd9,-0xd7),_0x3b43e1['cSZPW']='RNPgO';const _0x290af3=_0x3b43e1;if(!_0x15e282||_0x290af3[_0x1a0874(-0xc2,-0xda,-0xa1,-0xd5)](_0x15e282[_0x4f94e4(-0xd8,-0xed,-0xb1,-0xa8)],0x1da*-0x2+-0x207c+0x486*0x8))return[];const _0x56216b=[];let _0x5e0910=null;for(const _0x139679 of _0x15e282){if(!_0x5e0910){const _0x2ebcb4={..._0x139679};_0x5e0910=_0x2ebcb4;}else{if(_0x290af3['OBKmt'](_0x5e0910[_0x1a0874(-0x8b,-0x9c,-0x6d,-0x9b)],_0x139679[_0x4f94e4(-0x9b,-0xcf,-0xe1,-0x87)])){if(_0x290af3[_0x1a0874(-0x11,-0x50,-0x62,-0x8a)]===_0x290af3['cSZPW']){const _0x30e1f4={..._0x47a135};_0x55fe66=_0x30e1f4;}else _0x5e0910[_0x4f94e4(-0x127,-0xe9,-0x11d,-0x121)]=mergeContent(_0x5e0910['content'],_0x139679[_0x4f94e4(-0x120,-0xe9,-0x10c,-0xe7)]);}else{_0x56216b['push'](_0x5e0910);const _0x44b604={..._0x139679};_0x5e0910=_0x44b604;}}}return _0x5e0910&&_0x56216b[_0x4f94e4(-0x8b,-0x8f,-0x65,-0x8e)](_0x5e0910),_0x56216b;}function mergeContent(_0x4e8075,_0x28f488){const _0x23441d={'ONbiC':function(_0x2d9f71,_0x18f2ba){return _0x2d9f71===_0x18f2ba;},'ldVPS':_0x3efdaf(-0x18b,-0x122,-0x148,-0x174),'KrXwq':function(_0x1bccb4,_0x46e82e){return _0x1bccb4!==_0x46e82e;},'umYpf':'osADW','SGUPo':_0x3efdaf(-0x117,-0x13b,-0x144,-0x143),'ewWGA':function(_0xf1118e,_0x1d7d17){return _0xf1118e+_0x1d7d17;},'evfqe':function(_0x432e46,_0x4f92fb){return _0x432e46(_0x4f92fb);},'uDRdy':function(_0x205fbc,_0x28ed61){return _0x205fbc(_0x28ed61);}};if(typeof _0x4e8075===_0x3efdaf(-0x168,-0x190,-0x148,-0xfc)&&_0x23441d['ONbiC'](typeof _0x28f488,_0x23441d[_0x3efdaf(-0x127,-0xe1,-0x101,-0xdf)])){if(_0x23441d[_0x3bb1ca(0x259,0x299,0x2a0,0x26e)](_0x23441d['umYpf'],_0x23441d[_0x3efdaf(-0xfc,-0xf9,-0x122,-0x160)]))return _0x23441d['ewWGA'](_0x23441d[_0x3bb1ca(0x256,0x26d,0x280,0x216)](_0x4e8075,'\x0a'),_0x28f488);else _0x2f06ec[_0x3bb1ca(0x266,0x257,0x26d,0x263)+'ta'][_0x3bb1ca(0x229,0x1f6,0x22c,0x265)]={};}function _0x3bb1ca(_0x4ca2e7,_0x581147,_0x497156,_0x1a4031){return _0x5523(_0x4ca2e7-0x13b,_0x1a4031);}const _0x446674=_0x23441d[_0x3efdaf(-0xc4,-0x12d,-0x106,-0xc4)](normalizeToArray,_0x4e8075);function _0x3efdaf(_0x467609,_0x2edd9b,_0x4e7e91,_0x2d88bb){return _0x5523(_0x4e7e91- -0x22f,_0x467609);}const _0xa752e6=_0x23441d['uDRdy'](normalizeToArray,_0x28f488),_0x3be685={};return _0x3be685['type']=_0x3efdaf(-0xe3,-0xef,-0x10a,-0x129),_0x3be685[_0x3efdaf(-0x12b,-0x116,-0x10a,-0xcc)]='\x0a',[..._0x446674,_0x3be685,..._0xa752e6];}function normalizeToArray(_0x2f7fab){const _0x2ea074={};_0x2ea074['qZufT']=function(_0x314a89,_0x4510ef){return _0x314a89!==_0x4510ef;},_0x2ea074[_0x541323(-0x21f,-0x260,-0x224,-0x23c)]=_0x37ed6e(-0x2e4,-0x2fa,-0x2aa,-0x2c1),_0x2ea074[_0x541323(-0x297,-0x277,-0x2a1,-0x22d)]=_0x37ed6e(-0x2ab,-0x292,-0x293,-0x2d1),_0x2ea074[_0x541323(-0x20f,-0x212,-0x24d,-0x250)]=function(_0x5c7148,_0x5a55a1){return _0x5c7148||_0x5a55a1;};function _0x37ed6e(_0x5148a7,_0x46a424,_0x2b6d03,_0x271732){return _0x5523(_0x5148a7- -0x3d0,_0x271732);}const _0xc00d62=_0x2ea074;function _0x541323(_0x2b8963,_0xc7a221,_0x290ade,_0x4b6e24){return _0x5523(_0xc7a221- -0x357,_0x2b8963);}if(Array['isArray'](_0x2f7fab)){if(_0xc00d62[_0x541323(-0x269,-0x268,-0x23c,-0x28c)](_0xc00d62['plaEq'],_0xc00d62[_0x541323(-0x217,-0x260,-0x295,-0x281)])){const _0x5ac0df=_0x2d2f89[_0x541323(-0x22c,-0x254,-0x217,-0x232)](),_0x34af6c=_0xf662b7['chatMetada'+'ta'][_0x541323(-0x249,-0x269,-0x2a7,-0x230)][_0x5ac0df]||'';return _0x208daf&&_0x4825f3[_0x541323(-0x241,-0x24c,-0x283,-0x294)](_0x541323(-0x226,-0x1e1,-0x1fe,-0x1a8)+_0x5ac0df+'@}'),_0x34af6c;}else return _0x2f7fab;}return[{'type':_0xc00d62[_0x541323(-0x2ac,-0x277,-0x253,-0x254)],'text':_0xc00d62[_0x541323(-0x244,-0x212,-0x228,-0x221)](_0x2f7fab,'')}];}export function replacePlaceholder(_0x3f7260,_0x3ca1e8,_0xed4640,_0x2c04a4){function _0x3e77b0(_0x555e83,_0x2f6ed4,_0x59fad0,_0xe60c47){return _0x5523(_0x59fad0-0x1b6,_0xe60c47);}const _0x46f6ee={'gDsyb':function(_0x557003,_0x44383b){return _0x557003===_0x44383b;},'AsAXP':function(_0x581b89,_0x46dc61){return _0x581b89===_0x46dc61;},'lPfwP':_0x3e77b0(0x32f,0x335,0x30c,0x357),'ESSpc':_0x3e2e28(0x484,0x48e,0x489,0x475),'vlfSZ':function(_0x3d605c,_0x3229ca){return _0x3d605c||_0x3229ca;},'PQORF':function(_0xeb65d2,_0x320fc8){return _0xeb65d2===_0x320fc8;},'OFYZA':'object','Fkdil':function(_0x343347,_0x53fca9,_0x23f399,_0x322281,_0x29dec1){return _0x343347(_0x53fca9,_0x23f399,_0x322281,_0x29dec1);}};function _0x3e2e28(_0x3b6018,_0x1103d1,_0x202255,_0x39faf2){return _0x5523(_0x3b6018-0x30d,_0x1103d1);}if(_0x46f6ee[_0x3e77b0(0x2cc,0x275,0x2b4,0x2df)](typeof _0x3f7260,_0x3e77b0(0x2e1,0x2a8,0x29d,0x252))){if(_0x46f6ee[_0x3e77b0(0x2ee,0x322,0x31c,0x35e)](_0x46f6ee['lPfwP'],_0x46f6ee[_0x3e2e28(0x443,0x459,0x437,0x464)])){if(_0x212ed5){const _0x34265e=_0x1a4566[_0x3e77b0(0x2b4,0x2dd,0x29a,0x2b9)](_0x4a6563,arguments);return _0xc6f924=null,_0x34265e;}}else return _0xed4640&&_0x3f7260[_0x3e77b0(0x2f0,0x271,0x2ac,0x265)](_0x3ca1e8)&&(_0x2c04a4&&_0x2c04a4['add'](_0x3ca1e8)),_0x3f7260['replaceAll'](_0x3ca1e8,_0x46f6ee[_0x3e77b0(0x2bb,0x277,0x295,0x275)](_0xed4640,''));}if(Array['isArray'](_0x3f7260))return _0x3f7260['map'](_0x1a2a4e=>replacePlaceholder(_0x1a2a4e,_0x3ca1e8,_0xed4640,_0x2c04a4));if(_0x3f7260&&_0x46f6ee['PQORF'](typeof _0x3f7260,_0x46f6ee[_0x3e77b0(0x337,0x306,0x305,0x2ff)])){const _0x3c5009={};for(const _0x4c037d in _0x3f7260){_0x3c5009[_0x4c037d]=_0x46f6ee['Fkdil'](replacePlaceholder,_0x3f7260[_0x4c037d],_0x3ca1e8,_0xed4640,_0x2c04a4);}return _0x3c5009;}return _0x3f7260;}export function replaceAllPlaceholders(_0x5e37a4,_0x54f722){const _0x1e6d42={'QZeTm':function(_0x5f49f6){return _0x5f49f6();},'gSecU':_0x5427de(0x47e,0x433,0x3fb,0x478),'UAHDd':function(_0x3d4c2b,_0x1a0099,_0xf29298,_0x44a1bc,_0x13dfcf){return _0x3d4c2b(_0x1a0099,_0xf29298,_0x44a1bc,_0x13dfcf);},'zTGBw':_0x23e4b0(0x535,0x55b,0x503,0x541),'hWCvp':_0x5427de(0x3d8,0x3d6,0x413,0x408),'pRBAg':_0x5427de(0x40a,0x3df,0x40e,0x429),'hjBxN':'{{通用服装启用列表'+'}}','NXyzx':function(_0x4a7445,_0x7a6a3,_0xbca87d,_0x25701d,_0x312891){return _0x4a7445(_0x7a6a3,_0xbca87d,_0x25701d,_0x312891);},'rnqOL':_0x5427de(0x457,0x40e,0x3d8,0x436)+'}}','CwvSs':_0x5427de(0x420,0x400,0x40a,0x3d5),'eZfJu':function(_0x4244f2,_0x438358,_0x3a52c1){return _0x4244f2(_0x438358,_0x3a52c1);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x54f722,_0x4b4efd=new Set();let _0x5e517f=_0x5e37a4;const _0x5bb70a=_0x1e6d42[_0x5427de(0x48c,0x456,0x46e,0x469)](getContext),_0x506f71=_0x5bb70a?.[_0x23e4b0(0x53e,0x516,0x50b,0x543)]||'';let _0x5f31a1=worldBookContent;function _0x23e4b0(_0x5e0fc5,_0x2c885e,_0x664a30,_0x4c2293){return _0x5523(_0x5e0fc5-0x3e3,_0x2c885e);}_0x5f31a1&&(_0x5f31a1=_0x5f31a1[_0x23e4b0(0x544,0x541,0x4f9,0x535)](_0x1e6d42[_0x5427de(0x413,0x41a,0x441,0x3cd)],_0x506f71),_0x5f31a1=_0x5f31a1['replaceAll'](_0x5427de(0x3f2,0x3e9,0x428,0x3de),_0x506f71));_0x5e517f=_0x1e6d42[_0x5427de(0x3c7,0x3da,0x413,0x418)](replacePlaceholder,_0x5e517f,_0x1e6d42[_0x23e4b0(0x51e,0x549,0x4ee,0x502)],context,_0x4b4efd),_0x5e517f=_0x1e6d42['UAHDd'](replacePlaceholder,_0x5e517f,_0x1e6d42[_0x23e4b0(0x503,0x4c7,0x521,0x536)],_0x5f31a1,_0x4b4efd),_0x5e517f=_0x1e6d42['UAHDd'](replacePlaceholder,_0x5e517f,_0x5427de(0x42c,0x451,0x42f,0x428),body,_0x4b4efd),_0x5e517f=_0x1e6d42[_0x5427de(0x3d4,0x3da,0x3d5,0x3dd)](replacePlaceholder,_0x5e517f,_0x1e6d42[_0x23e4b0(0x527,0x4e6,0x4f9,0x531)],characterListText,_0x4b4efd);function _0x5427de(_0x38e7da,_0x19d02b,_0x3907ff,_0x20d614){return _0x5523(_0x19d02b-0x2ed,_0x3907ff);}_0x5e517f=replacePlaceholder(_0x5e517f,_0x1e6d42['hjBxN'],outfitEnableListText,_0x4b4efd),_0x5e517f=_0x1e6d42['NXyzx'](replacePlaceholder,_0x5e517f,_0x1e6d42[_0x5427de(0x43f,0x403,0x3cc,0x421)],commonCharacterListText,_0x4b4efd),_0x5e517f=_0x1e6d42[_0x23e4b0(0x530,0x55a,0x56b,0x4fe)](replacePlaceholder,_0x5e517f,_0x1e6d42['CwvSs'],userDemand,_0x4b4efd);if(variables&&Object[_0x5427de(0x3c0,0x3ed,0x41e,0x3f8)](variables)['length']>-0x1*-0x155f+0x29*-0x6d+-0x3ea){const _0x537ff4=/\{\{getvar::([^}]+)\}\}/g,_0x318b12=JSON[_0x5427de(0x465,0x45a,0x48e,0x430)](_0x5e517f),_0x3b078c=[..._0x318b12['matchAll'](_0x537ff4)],_0x545eac=new Set();for(const _0x15eb65 of _0x3b078c){_0x545eac[_0x23e4b0(0x4ee,0x4e8,0x524,0x4dc)](_0x15eb65[0xad0+0x1381*0x2+-0x31d1]);}for(const _0x58b2e3 of _0x545eac){const _0x68ced1=_0x5427de(0x423,0x44b,0x474,0x459)+_0x58b2e3+'}}',_0x4e0c82=variables[_0x58b2e3]||'';_0x5e517f=_0x1e6d42[_0x23e4b0(0x530,0x549,0x4e5,0x544)](replacePlaceholder,_0x5e517f,_0x68ced1,_0x4e0c82,_0x4b4efd);}}_0x5e517f=_0x1e6d42[_0x5427de(0x408,0x3f9,0x3c5,0x429)](processVariablePlaceholdersInMessages,_0x5e517f,_0x4b4efd);const _0x36eadc={};return _0x36eadc['messages']=_0x5e517f,_0x36eadc[_0x23e4b0(0x4f4,0x4bd,0x52a,0x53c)+_0x23e4b0(0x4e5,0x4e3,0x4ad,0x4bf)]=_0x4b4efd,_0x36eadc;}function processVariablePlaceholdersInMessages(_0x4a507c,_0x3f0f20){function _0x1a6365(_0x5d0488,_0x1629c2,_0x2594ea,_0x5394cf){return _0x5523(_0x5d0488-0x338,_0x1629c2);}const _0x3b6ed5={'VzgyV':function(_0x28dc27,_0x4342db,_0xf0595c,_0xc33185){return _0x28dc27(_0x4342db,_0xf0595c,_0xc33185);},'CDYMG':function(_0x594fec,_0x479a07){return _0x594fec===_0x479a07;}};function _0x5a552b(_0x1689d0,_0x3a5c40,_0x1c9cac,_0x36a5bb){return _0x5523(_0x3a5c40- -0x181,_0x1c9cac);}if(!_0x4a507c||_0x3b6ed5[_0x1a6365(0x454,0x42f,0x49b,0x429)](_0x4a507c[_0x1a6365(0x442,0x45d,0x483,0x425)],0x1*-0x1219+-0x166d*0x1+0x2886))return _0x4a507c;const _0x30b540=getContext();return!_0x30b540['chatMetada'+'ta']&&(_0x30b540[_0x1a6365(0x463,0x425,0x425,0x47c)+'ta']={}),!_0x30b540['chatMetada'+'ta'][_0x5a552b(-0x93,-0x93,-0x60,-0xaf)]&&(_0x30b540['chatMetada'+'ta'][_0x5a552b(-0xb5,-0x93,-0xd7,-0x72)]={}),_0x4a507c[_0x5a552b(-0x85,-0x48,-0x4b,-0x38)](_0x1d58ba=>{if(!_0x1d58ba||!_0x1d58ba[_0x39ed48(0x29f,0x26d,0x2c6,0x2e9)])return _0x1d58ba;function _0x27a330(_0x2ea791,_0x4b778b,_0x3c2d31,_0x4834a7){return _0x1a6365(_0x2ea791- -0x462,_0x4834a7,_0x3c2d31-0x9f,_0x4834a7-0x8c);}function _0x39ed48(_0x2ae993,_0x48ef12,_0x5c1a5f,_0x325b1a){return _0x1a6365(_0x2ae993- -0x1a7,_0x325b1a,_0x5c1a5f-0x16d,_0x325b1a-0x66);}return{..._0x1d58ba,'content':_0x3b6ed5[_0x39ed48(0x2e9,0x2c1,0x315,0x30d)](processContentVariables,_0x1d58ba[_0x27a330(-0x1c,-0x5,-0x62,0xe)],_0x30b540,_0x3f0f20)};});}function processContentVariables(_0xaa9384,_0x3c3e78,_0x1831c2){function _0x53dfa1(_0x53cde3,_0x12de33,_0x54dcbf,_0x164d96){return _0x5523(_0x12de33- -0x3b,_0x164d96);}const _0x218725={'BcJts':function(_0x6b34ec,_0x1351f2){return _0x6b34ec||_0x1351f2;},'OATbD':function(_0x344d34,_0x1a2660){return _0x344d34===_0x1a2660;},'jugkR':'text','FuGIr':function(_0x53cb68,_0x252ee8){return _0x53cb68===_0x252ee8;},'ObWIc':_0x53dfa1(0xd4,0xac,0xec,0x71),'tYZds':function(_0x5b5456,_0x25e91c){return _0x5b5456!==_0x25e91c;},'WYlDY':_0x575a0a(0x2ef,0x30d,0x32a,0x30a),'ljeSu':_0x53dfa1(0xe6,0xfd,0x108,0x129),'plhyV':function(_0xc8af21,_0x3ebf38,_0x4c9ca1,_0x4ab249){return _0xc8af21(_0x3ebf38,_0x4c9ca1,_0x4ab249);}};if(typeof _0xaa9384===_0x218725[_0x575a0a(0x2b9,0x32e,0x2ed,0x2ec)])return _0x218725['plhyV'](processStringVariables,_0xaa9384,_0x3c3e78,_0x1831c2);function _0x575a0a(_0x59beb3,_0x208462,_0x541d75,_0xb10eb8){return _0x5523(_0xb10eb8-0x1da,_0x59beb3);}if(Array['isArray'](_0xaa9384))return _0xaa9384[_0x53dfa1(0x139,0xfe,0xcc,0x132)](_0x1b43b8=>{function _0x5912ac(_0x5286e8,_0x1b1105,_0x1a2e09,_0x3ac097){return _0x53dfa1(_0x5286e8-0x43,_0x1b1105- -0x2cb,_0x1a2e09-0xc1,_0x1a2e09);}if(_0x1b43b8&&_0x218725[_0x3ef3fa(0x2eb,0x2e5,0x300,0x324)](_0x1b43b8['type'],_0x218725[_0x5912ac(-0x238,-0x209,-0x241,-0x1ce)])&&_0x218725[_0x3ef3fa(0x2c8,0x2fc,0x2d6,0x2c9)](typeof _0x1b43b8[_0x5912ac(-0x1dd,-0x1e1,-0x206,-0x205)],_0x218725['ObWIc'])){if(_0x218725[_0x3ef3fa(0x260,0x299,0x2bf,0x2d1)](_0x218725['WYlDY'],_0x218725[_0x5912ac(-0x21e,-0x205,-0x20c,-0x1dd)]))return{..._0x1b43b8,'text':_0x218725['plhyV'](processStringVariables,_0x1b43b8[_0x5912ac(-0x225,-0x1e1,-0x1df,-0x1b9)],_0x3c3e78,_0x1831c2)};else{if(_0x3ec54f[_0x5912ac(-0x229,-0x200,-0x1d7,-0x23b)](_0x1056fc))return _0x46e3c9;return[{'type':_0x3ef3fa(0x2dc,0x2cd,0x2a4,0x2aa),'text':_0x218725[_0x3ef3fa(0x287,0x29c,0x2b0,0x2bd)](_0x4aa283,'')}];}}function _0x3ef3fa(_0x5c4b4b,_0x2c65de,_0x48a126,_0x4c2bd9){return _0x53dfa1(_0x5c4b4b-0x2d,_0x2c65de-0x1e3,_0x48a126-0x76,_0x4c2bd9);}return _0x1b43b8;});return _0xaa9384;}function processStringVariables(_0xecde69,_0x3e8f0a,_0x13f426){const _0x2d622c={'nxfKs':_0xc1c960(0x507,0x507,0x503,0x4c8),'ZMCWn':function(_0x325c17,_0x4b8afe){return _0x325c17===_0x4b8afe;},'Pyjjk':_0x1d045c(0x380,0x3d2,0x39d,0x3a2),'KMtJj':function(_0x56145a,_0x1aedda,_0x42bf3d){return _0x56145a(_0x1aedda,_0x42bf3d);},'KypaO':function(_0x3f5ce4,_0x10089){return _0x3f5ce4(_0x10089);},'CvAxZ':_0xc1c960(0x539,0x4c6,0x4c4,0x503),'uinEX':function(_0x38722d,_0x393ca9){return _0x38722d(_0x393ca9);},'LMqym':_0xc1c960(0x4df,0x4ca,0x495,0x4b2)};if(!_0xecde69)return _0xecde69;let _0x137325=_0xecde69;_0x137325=_0x137325['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2bdf36,_0x5401a6,_0x4dc2ed)=>{function _0x5d3378(_0x53545b,_0x467a4a,_0x291876,_0x51e546){return _0x1d045c(_0x53545b-0x65,_0x467a4a-0xd1,_0x291876-0x100,_0x53545b);}function _0x52754f(_0x22cf31,_0x3368e1,_0x24aa42,_0x15088d){return _0xc1c960(_0x15088d,_0x3368e1-0x2,_0x24aa42-0x10d,_0x22cf31- -0xad);}if(_0x2d622c['nxfKs']===_0x2d622c['nxfKs']){const _0x42a152=_0x5401a6[_0x52754f(0x426,0x3f0,0x41d,0x3fe)]();_0x3e8f0a['chatMetada'+'ta'][_0x5d3378(0x48d,0x42b,0x469,0x438)][_0x42a152]=_0x4dc2ed;if(_0x13f426){if(_0x2d622c[_0x52754f(0x461,0x459,0x49c,0x4a7)](_0x2d622c[_0x52754f(0x46f,0x429,0x48d,0x486)],_0x2d622c[_0x52754f(0x46f,0x446,0x435,0x435)]))_0x13f426[_0x52754f(0x42e,0x426,0x439,0x413)](_0x5d3378(0x457,0x490,0x48f,0x446)+_0x42a152+'@}');else{if(_0x1cf3f8['includes'](_0x416378))return!![];}}return'';}else{const _0x4064a1=_0x11709a[_0x5d3378(0x4b5,0x4a6,0x47e,0x44f)]();return _0xd2ed5c['chatMetada'+'ta'][_0x5d3378(0x456,0x443,0x469,0x43b)][_0x4064a1]=_0x56ccde,_0x49f895&&_0x19b91b[_0x5d3378(0x4b7,0x4a4,0x486,0x4ba)](_0x52754f(0x437,0x454,0x47f,0x40a)+_0x4064a1+'@}'),'';}}),_0x137325=_0x137325[_0x1d045c(0x388,0x389,0x38b,0x3c3)](/\{@getvar::([^@]+)@\}/g,(_0x2acbf3,_0x1a6e5c)=>{function _0x1c938c(_0x1259c3,_0x12e900,_0xf405d9,_0x4c4164){return _0x1d045c(_0x1259c3-0xed,_0x12e900-0x3d,_0x1259c3- -0x46e,_0xf405d9);}const _0x37348c=_0x1a6e5c[_0x1c938c(-0xf0,-0xbc,-0xb8,-0xe7)]();function _0x1151ec(_0x277767,_0x5ea4ff,_0x18d44e,_0x195303){return _0x1d045c(_0x277767-0x145,_0x5ea4ff-0x158,_0x18d44e- -0x1e0,_0x195303);}const _0x4a2494=_0x3e8f0a['chatMetada'+'ta'][_0x1c938c(-0x105,-0xcb,-0xd0,-0x13b)][_0x37348c]||'';return _0x13f426&&_0x13f426['add'](_0x1151ec(0x219,0x22a,0x211,0x231)+_0x37348c+'@}'),_0x4a2494;});function _0x1d045c(_0x1a0af2,_0x173428,_0x22830e,_0xc4d0a7){return _0x5523(_0x22830e-0x27b,_0xc4d0a7);}function _0xc1c960(_0x151758,_0x2e4899,_0x5b0bc0,_0x7df96e){return _0x5523(_0x7df96e-0x3d0,_0x151758);}return _0x137325=_0x137325[_0xc1c960(0x524,0x4a0,0x4db,0x4e0)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x179783,_0xfac19d,_0x37210c)=>{const _0x277346=_0xfac19d[_0x1dd54d(0x31c,0x317,0x2e8,0x332)]();_0x2d622c[_0x4a79(0x3c9,0x3e9,0x3fd,0x429)](setglobalvar,_0x277346,_0x37210c);function _0x4a79(_0x597200,_0xd731ad,_0x4ebfa4,_0x1acce4){return _0x1d045c(_0x597200-0x1c1,_0xd731ad-0x7e,_0xd731ad-0x23,_0x597200);}function _0x1dd54d(_0x138955,_0x4c4fa9,_0x23d0d4,_0x57472d){return _0x1d045c(_0x138955-0xb0,_0x4c4fa9-0xed,_0x57472d- -0x4c,_0x138955);}return _0x13f426&&_0x13f426[_0x1dd54d(0x354,0x386,0x367,0x33a)](_0x4a79(0x41e,0x3d3,0x3e8,0x3b9)+'lvar::'+_0x277346+'@}'),'';}),_0x137325=_0x137325[_0x1d045c(0x384,0x3c2,0x38b,0x356)](/\{@getglobalvar::([^@]+)@\}/g,(_0x4d5eff,_0x269971)=>{const _0x277a87={};function _0x47a494(_0x22e33a,_0x36ecaa,_0x2a6794,_0xcd9820){return _0xc1c960(_0x36ecaa,_0x36ecaa-0x5a,_0x2a6794-0x1e6,_0xcd9820- -0x6ae);}_0x277a87['wskfu']=_0x47a494(-0x1d9,-0x17d,-0x15a,-0x19d);function _0x274266(_0xf7e8a1,_0x3cfb05,_0x5cff37,_0x15d1f4){return _0xc1c960(_0xf7e8a1,_0x3cfb05-0x1e,_0x5cff37-0x159,_0x15d1f4- -0x67e);}const _0x49fbc2=_0x277a87,_0x44355c=_0x269971['trim'](),_0x5b15d8=_0x2d622c[_0x274266(-0x13b,-0x12c,-0x196,-0x14b)](getglobalvar,_0x44355c)||'';if(_0x13f426){if(_0x2d622c['CvAxZ']===_0x2d622c['CvAxZ'])_0x13f426[_0x47a494(-0x212,-0x20d,-0x1f5,-0x1d3)](_0x47a494(-0x212,-0x204,-0x1f3,-0x1f9)+_0x274266(-0x19c,-0x178,-0x1bf,-0x199)+_0x44355c+'@}');else{const _0x4c87e6={};_0x4c87e6['role']=_0x49fbc2[_0x47a494(-0x19a,-0x1a3,-0x1a5,-0x1d5)],_0x4c87e6[_0x274266(-0x18b,-0x185,-0x170,-0x1a0)]=_0x53759c['user'],_0x4c3d8c[_0x47a494(-0x189,-0x1ad,-0x138,-0x176)](_0x4c87e6);}}return _0x5b15d8;}),_0x137325=_0x137325['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x17ebb0,_0x4d8456)=>{function _0x3da210(_0x28c315,_0x9e065d,_0x3b21b4,_0x378269){return _0xc1c960(_0x9e065d,_0x9e065d-0x12,_0x3b21b4-0x4a,_0x3b21b4- -0x228);}const _0x2af661={'jhKNR':function(_0x55c87d,_0x4217ca,_0xa97d42,_0x55594a){return _0x55c87d(_0x4217ca,_0xa97d42,_0x55594a);}},_0x256312=_0x4d8456['trim'](),_0x44e514=_0x2d622c[_0x3da210(0x2c5,0x298,0x2c5,0x283)](getworldvar,_0x256312)||'';function _0x1f83ed(_0xe8dd71,_0x5e903e,_0xe86f5b,_0x2904f2){return _0x1d045c(_0xe8dd71-0xc0,_0x5e903e-0x135,_0x5e903e- -0xaa,_0xe86f5b);}if(_0x13f426){if(_0x2d622c[_0x1f83ed(0x2e5,0x30f,0x303,0x351)](_0x2d622c[_0x1f83ed(0x30b,0x310,0x30d,0x2cf)],_0x2d622c[_0x1f83ed(0x316,0x310,0x341,0x349)]))_0x13f426[_0x3da210(0x27f,0x2f8,0x2b3,0x293)](_0x3da210(0x2ed,0x324,0x2f2,0x328)+_0x3da210(0x32e,0x32e,0x312,0x2e9)+_0x256312+'@}');else{if(!_0xd6c6aa||!_0x5d216c[_0x1f83ed(0x2f5,0x2df,0x30b,0x2d7)])return _0x41605d;return{..._0x4c0887,'content':_0x2af661['jhKNR'](_0x3346f7,_0x473aa8[_0x3da210(0x2ce,0x29b,0x2b6,0x2e0)],_0x4b77bc,_0x356c90)};}}return _0x44e514;}),_0x137325;}export function buildPromptWithTrigger(_0x5d65a1){const _0x3c822d={'PXNfm':function(_0x492c6d,_0x11a798){return _0x492c6d===_0x11a798;},'CNFsy':_0x1b6b0b(-0x18a,-0x141,-0xfa,-0x105),'TDJjs':function(_0x18fa7a,_0x3beea6){return _0x18fa7a+_0x3beea6;},'dSPgR':function(_0x47b24e,_0x3edcad){return _0x47b24e+_0x3edcad;},'yMdat':function(_0x2e60e0,_0x1cef6d){return _0x2e60e0(_0x1cef6d);},'eIZWa':_0x1b6b0b(-0xee,-0x103,-0x144,-0xd8),'aTdZM':function(_0x111808,_0x89d35a){return _0x111808!==_0x89d35a;},'wfEPo':'user','ATDts':_0x455e11(0x5d,0x50,0x42,0x81),'rbipE':function(_0x48a0ec,_0x10d333,_0x18aad2){return _0x48a0ec(_0x10d333,_0x18aad2);},'YrWMF':function(_0x4402b3,_0x55b10a){return _0x4402b3||_0x55b10a;},'TZbyN':function(_0x23d555,_0x3455bd,_0x386fa3,_0xb27c75,_0x5235f){return _0x23d555(_0x3455bd,_0x386fa3,_0xb27c75,_0x5235f);},'CnsXS':_0x455e11(0x5c,0x93,0x9a,0xdd),'kppbC':'Mwknw','PhHGd':'CPeqM','wVRNk':function(_0x1ade08,_0x135407){return _0x1ade08===_0x135407;},'MBNBl':_0x1b6b0b(-0xe0,-0xec,-0x12d,-0x12f),'KpPjZ':_0x1b6b0b(-0x124,-0x120,-0x12c,-0xeb),'LBgZL':'hMnBW','xtiZg':function(_0x4e456c,_0x126fa8,_0x189233){return _0x4e456c(_0x126fa8,_0x189233);},'iyund':_0x455e11(0x34,0x62,0x59,0x94),'YtxCp':'WhZgW','rQJIg':function(_0x55fa8a,_0x47b5c4){return _0x55fa8a===_0x47b5c4;},'kMlqb':'xTxpM','wvrqA':_0x1b6b0b(-0xfd,-0xd7,-0x113,-0x100)},{requestType:_0x2b375e,contextData:_0x1eb0e8}=_0x5d65a1;function _0x455e11(_0x2cbd4a,_0x4b1d52,_0x382376,_0x4a25e5){return _0x5523(_0x382376- -0xa6,_0x4b1d52);}const _0x12b6f7=extension_settings[extensionName]?.[_0x455e11(0x49,0x41,0x5f,0x6e)+_0x455e11(0x87,0x9a,0x61,0xad)+'figs']||{},_0x25f704={};_0x25f704[_0x455e11(0x94,0x5a,0x89,0x6a)+'ofile']='默认';const _0x57d4b2=_0x12b6f7[_0x2b375e]||_0x25f704,_0x485279=_0x57d4b2[_0x1b6b0b(-0x122,-0xf9,-0xc1,-0x107)+_0x1b6b0b(-0x177,-0x147,-0x17a,-0x191)]||'默认',_0x16a54b=extension_settings[extensionName]?.['test_conte'+_0x455e11(0x95,0x118,0xcc,0xe0)+'s']||{},_0x496c0e=_0x16a54b[_0x485279]||_0x16a54b[Object[_0x455e11(0x5f,0x69,0x5a,0x98)](_0x16a54b)[0x1054+-0x2044+0xff0]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x1eb0e8,_0x25b550=[userDemand,context,body,worldBookContent][_0x1b6b0b(-0x7a,-0xb9,-0xe8,-0xd5)](Boolean)['join']('\x0a'),_0xe54907=[];if(_0x496c0e[_0x455e11(0x73,0x5d,0x84,0x95)]&&Array[_0x455e11(0x28,0x29,0x60,0x5a)](_0x496c0e[_0x1b6b0b(-0xdc,-0xfe,-0xd1,-0xf5)])){if(_0x3c822d[_0x455e11(0xa8,0x104,0xba,0xda)]===_0x3c822d[_0x1b6b0b(-0xe6,-0xe1,-0x10f,-0xa6)])return![];else for(const _0x48f650 of _0x496c0e[_0x455e11(0x51,0xa3,0x84,0xb3)]){if(_0x3c822d[_0x455e11(0x8e,0x7f,0x8e,0x4d)]!==_0x3c822d[_0x455e11(0xa9,0xc8,0x8e,0x6b)]){if(_0x3c822d[_0x1b6b0b(-0x169,-0x133,-0xfb,-0x124)](typeof _0x3d2690,_0x455e11(0x88,0xb,0x41,0x53))&&_0x3c822d['PXNfm'](typeof _0x5a4903,_0x3c822d[_0x455e11(0xa2,0xb8,0xcf,0x117)]))return _0x3c822d['TDJjs'](_0x3c822d[_0x455e11(0xa9,0xb5,0xb3,0xd3)](_0x21f6c4,'\x0a'),_0x41d10a);const _0x3c3dde=_0x3c822d['yMdat'](_0x4d4061,_0x458e5c),_0xf680da=_0x17b987(_0x73b945),_0x35a7c6={};return _0x35a7c6[_0x455e11(0xbf,0x39,0x86,0x5f)]=_0x3c822d['eIZWa'],_0x35a7c6[_0x455e11(0xc0,0xb9,0x7f,0xa5)]='\x0a',[..._0x3c3dde,_0x35a7c6,..._0xf680da];}else{if(!_0x48f650['enabled'])continue;if(!_0x48f650['content']||_0x3c822d[_0x1b6b0b(-0xa3,-0xdf,-0x114,-0x117)](_0x48f650[_0x455e11(0x83,0x96,0x68,0xa9)][_0x455e11(0x48,0x3b,0x5d,0x1c)](),''))continue;if(_0x48f650['triggerMod'+'e']===_0x3c822d[_0x1b6b0b(-0x150,-0x12d,-0x172,-0x139)]){if(_0x3c822d['KpPjZ']!==_0x3c822d['LBgZL']){if(!_0x3c822d[_0x1b6b0b(-0xd0,-0xc3,-0xda,-0xeb)](checkTriggerWords,_0x48f650['triggerWor'+'ds'],_0x25b550))continue;}else{if(_0x10a383['user']&&_0x3c822d['aTdZM'](_0x5aa80d['user'][_0x1b6b0b(-0x13b,-0x125,-0x15c,-0x131)](),'')){const _0x35d7f0={};_0x35d7f0[_0x455e11(0xa1,0x8e,0x82,0x48)]=_0x3c822d['wfEPo'],_0x35d7f0[_0x455e11(0x28,0x68,0x68,0x53)]=_0x5e15c2[_0x1b6b0b(-0x9a,-0xe7,-0xb7,-0xae)],_0x2e648c[_0x1b6b0b(-0xcd,-0xc0,-0xb4,-0xcc)](_0x35d7f0);}if(_0x42c85e[_0x455e11(0x33,-0x2,0x42,0x3a)]&&_0x1a697a[_0x455e11(0x44,0x77,0x42,0x12)][_0x1b6b0b(-0xfb,-0x125,-0x161,-0x14d)]()!==''){const _0x3effed={};_0x3effed[_0x455e11(0x5d,0xb6,0x82,0xc6)]=_0x3c822d[_0x1b6b0b(-0x83,-0xb8,-0x101,-0x73)],_0x3effed[_0x455e11(0xa2,0x34,0x68,0x6d)]=_0x3663cc[_0x455e11(0xd,0x48,0x42,0x65)],_0x2eae84[_0x455e11(0xf5,0x81,0xc2,0xad)](_0x3effed);}}}const _0x1c2860={};_0x1c2860[_0x1b6b0b(-0x132,-0x100,-0x13d,-0xdc)]=_0x48f650[_0x1b6b0b(-0x124,-0x100,-0xb5,-0xd2)]||_0x455e11(0x7a,0xe5,0x9b,0x5f),_0x1c2860[_0x455e11(0x3e,0x5e,0x68,0x61)]=_0x48f650[_0x455e11(0x49,0x4b,0x68,0x3e)],_0xe54907[_0x455e11(0x98,0xaf,0xc2,0xf5)](_0x1c2860);}}}else{if(_0x496c0e['history']&&Array['isArray'](_0x496c0e['history'])){if(_0x3c822d[_0x1b6b0b(-0x100,-0xdf,-0x9f,-0xec)](_0x3c822d['iyund'],_0x3c822d['YtxCp']))_0x5debdd[_0x1b6b0b(-0x102,-0x11a,-0xfe,-0xf9)]=_0x3c822d[_0x455e11(0x94,0xb3,0xb4,0x99)](_0x6c1cfc,_0x358a4c['content'],_0x3f4b87['content']);else for(const _0x1b8f2e of _0x496c0e[_0x1b6b0b(-0x115,-0xe0,-0x9d,-0xb5)]){if(_0x1b8f2e[_0x1b6b0b(-0x112,-0xe7,-0xf0,-0xc8)]&&_0x3c822d['aTdZM'](_0x1b8f2e[_0x455e11(0x94,0x69,0x9b,0x6a)][_0x455e11(0x90,0x74,0x5d,0x4e)](),'')){if(_0x3c822d['rQJIg'](_0x3c822d['kMlqb'],_0x3c822d[_0x455e11(0x42,0xc2,0x79,0x7c)])){const _0xe8c92b={};_0xe8c92b['role']=_0x3c822d[_0x455e11(0x8f,0x4e,0x8c,0xc1)],_0xe8c92b['content']=_0x1b8f2e[_0x455e11(0x5a,0xc1,0x9b,0x82)],_0xe54907['push'](_0xe8c92b);}else return _0x5d7fbd&&_0x119c40['includes'](_0x19839a)&&(_0x4a1750&&_0x106ccc['add'](_0x550ab4)),_0x10b111[_0x455e11(0x7a,0xff,0xbb,0x8f)](_0x274807,_0x3c822d['YrWMF'](_0x31fed2,''));}if(_0x1b8f2e[_0x455e11(0x68,0x8a,0x42,0x29)]&&_0x3c822d[_0x455e11(0x91,0xb7,0x7d,0x35)](_0x1b8f2e[_0x1b6b0b(-0x124,-0x140,-0x13a,-0xfc)][_0x1b6b0b(-0x145,-0x125,-0x141,-0x165)](),'')){if(_0x3c822d[_0x1b6b0b(-0x128,-0x133,-0xf7,-0x149)](_0x3c822d[_0x1b6b0b(-0xab,-0xba,-0x83,-0xcf)],_0x3c822d[_0x455e11(0x88,0xa4,0xc8,0xce)])){const _0x4d0abe={};_0x4d0abe[_0x455e11(0x58,0x4a,0x82,0x5b)]=_0x3c822d['ATDts'],_0x4d0abe[_0x455e11(0x23,0x79,0x68,0x32)]=_0x1b8f2e[_0x1b6b0b(-0x13d,-0x140,-0x126,-0x165)],_0xe54907[_0x1b6b0b(-0x97,-0xc0,-0x9a,-0xc9)](_0x4d0abe);}else{const _0x110b73='{{getvar::'+_0x396b6e+'}}',_0x18b36b=_0x4437b0[_0x1fa741]||'';_0x155e51=_0x3c822d[_0x455e11(0xd2,0xbb,0x94,0x50)](_0x3ba816,_0x1270c4,_0x110b73,_0x18b36b,_0x2f7e28);}}}}}function _0x1b6b0b(_0x137493,_0x5eb07a,_0x310d64,_0x240d5b){return _0x5523(_0x5eb07a- -0x228,_0x137493);}const _0x4b636b=mergeAdjacentMessages(_0xe54907),{messages:_0x4da3c1,replacedVariables:_0x148d62}=_0x3c822d[_0x455e11(0xf5,0xb5,0xb4,0x97)](replaceAllPlaceholders,_0x4b636b,_0x1eb0e8);return _0x4da3c1;}export function getProcessedPrompt(_0x3ced32,_0x35a55d){function _0x16ebef(_0x3150be,_0x39fb60,_0x214c6d,_0x94fda3){return _0x5523(_0x3150be-0x110,_0x214c6d);}function _0x744992(_0x422564,_0x2865b7,_0x2d3c9e,_0x51d9bb){return _0x5523(_0x2865b7- -0x30e,_0x51d9bb);}const _0x4e442d={'dTsXd':function(_0xd84743,_0x46e36c){return _0xd84743(_0x46e36c);}},_0x192c6f={};return _0x192c6f[_0x16ebef(0x25e,0x287,0x295,0x22b)+'e']=_0x3ced32,_0x192c6f['contextDat'+'a']=_0x35a55d,_0x4e442d[_0x744992(-0x1d4,-0x1ac,-0x18f,-0x179)](buildPromptWithTrigger,_0x192c6f);}