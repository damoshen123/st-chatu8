(function(_0x440695,_0x23ae6a){const _0x1e552a=_0x440695();function _0x1f818b(_0x46e58a,_0x36fd42,_0x2c9040,_0x97671a){return _0x3323(_0x36fd42- -0x1c0,_0x46e58a);}function _0x23e5ab(_0x237b71,_0x5a7b5e,_0x5d4e0a,_0x4fb03e){return _0x3323(_0x237b71-0x60,_0x4fb03e);}while(!![]){try{const _0x42f690=-parseInt(_0x23e5ab(0x117,0xc2,0x120,0xd1))/(-0x1cbf+0x4b6+0x180a)+-parseInt(_0x23e5ab(0x166,0x17a,0x196,0x119))/(0x1299+0x3*-0x2b2+-0xa81)+-parseInt(_0x23e5ab(0x184,0x174,0x1da,0x14f))/(-0x1394+-0x1fc9+0x66c*0x8)*(-parseInt(_0x1f818b(-0x107,-0xe2,-0x135,-0xaf))/(0x332*-0xa+0x4a*-0x1+-0x2*-0x1021))+parseInt(_0x1f818b(-0x10c,-0x13e,-0xf7,-0x151))/(0x68*-0x27+0x17*-0x163+0x2*0x17e1)*(parseInt(_0x1f818b(-0x15f,-0x12f,-0x14a,-0x168))/(0x1*0x1821+0x1cfd+-0x3518))+parseInt(_0x1f818b(-0x13d,-0x121,-0x11c,-0x101))/(0x59f*0x6+-0xee9*0x1+-0x1a*0xb9)*(-parseInt(_0x23e5ab(0x12a,0x11d,0x108,0xdf))/(0xb*-0x5f+-0xa*-0x3b9+-0x211d))+-parseInt(_0x1f818b(-0xac,-0xb8,-0x63,-0xde))/(-0x2*-0xf2c+-0x2497+0x648)+-parseInt(_0x23e5ab(0xde,0x12c,0x116,0xd6))/(0x1e33+0x111f+0x44*-0xb2)*(-parseInt(_0x23e5ab(0x165,0x119,0x187,0x148))/(-0x52c+-0x103d+0x1574));if(_0x42f690===_0x23ae6a)break;else _0x1e552a['push'](_0x1e552a['shift']());}catch(_0x1b9979){_0x1e552a['push'](_0x1e552a['shift']());}}}(_0x3ba0,-0x5f5db+-0x9*-0x6421+-0xffd*-0x63));const _0x7dfca3=(function(){const _0x5d4307={};_0x5d4307[_0x20b1e4(-0x1a0,-0x175,-0x17b,-0x17e)]=function(_0x4060a5,_0x115ee2){return _0x4060a5!==_0x115ee2;};function _0x66eea3(_0x2cd31e,_0x30363e,_0x47742e,_0x1cfb1f){return _0x3323(_0x2cd31e-0x88,_0x1cfb1f);}_0x5d4307[_0x66eea3(0x118,0xf7,0x14d,0xf0)]=_0x20b1e4(-0x176,-0x1b0,-0x1ed,-0x1b3);const _0x3b9a66=_0x5d4307;function _0x20b1e4(_0x18e315,_0x16b8c1,_0x360623,_0x114211){return _0x3323(_0x114211- -0x269,_0x16b8c1);}let _0x2e506b=!![];return function(_0x35e686,_0x1f3f6b){function _0x3ec3ef(_0x5850aa,_0x184947,_0x3ce044,_0x73cbe){return _0x20b1e4(_0x5850aa-0x17b,_0x184947,_0x3ce044-0x114,_0x73cbe-0x13f);}function _0x283198(_0x13d91a,_0x1c3770,_0x83cf08,_0x18fe20){return _0x20b1e4(_0x13d91a-0x186,_0x83cf08,_0x83cf08-0x168,_0x13d91a-0x57c);}if(_0x3b9a66[_0x3ec3ef(-0x1e,-0x55,-0x58,-0x3f)](_0x3b9a66[_0x283198(0x3a3,0x363,0x3f6,0x3f2)],_0x3b9a66[_0x3ec3ef(-0x9c,-0xe2,-0x48,-0x9a)])){if(_0x184dbe){const _0x53fa7c=_0x4627ff[_0x3ec3ef(-0xe4,-0x40,-0x98,-0x92)](_0x58c468,arguments);return _0x58286c=null,_0x53fa7c;}}else{const _0x226b71=_0x2e506b?function(){if(_0x1f3f6b){const _0x374fee=_0x1f3f6b['apply'](_0x35e686,arguments);return _0x1f3f6b=null,_0x374fee;}}:function(){};return _0x2e506b=![],_0x226b71;}};}()),_0xbef7f0=_0x7dfca3(this,function(){const _0x398c80={};_0x398c80['EBKoG']=_0x345653(-0x279,-0x2a6,-0x298,-0x2ee)+'+$';const _0xa27d0f=_0x398c80;function _0x2a2fad(_0x16ac92,_0x5c4726,_0x3114c5,_0x45635d){return _0x3323(_0x45635d-0x2e7,_0x16ac92);}function _0x345653(_0x3eb40c,_0x491c57,_0x5cdad4,_0x1e757b){return _0x3323(_0x491c57- -0x392,_0x3eb40c);}return _0xbef7f0[_0x2a2fad(0x38f,0x386,0x3a9,0x391)]()[_0x2a2fad(0x408,0x3c1,0x451,0x40d)](_0x345653(-0x2c1,-0x2a6,-0x261,-0x275)+'+$')['toString']()[_0x2a2fad(0x427,0x3dd,0x3e6,0x3e9)+'r'](_0xbef7f0)[_0x345653(-0x282,-0x26c,-0x273,-0x268)](_0xa27d0f[_0x345653(-0x26c,-0x2b6,-0x265,-0x2ee)]);});_0xbef7f0();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x353d8d,_0x2bc75b){function _0x4d9716(_0x1b2689,_0x4575ff,_0x399a8c,_0x518c76){return _0x3323(_0x4575ff-0x2ef,_0x1b2689);}const _0x1dde14={};function _0x2f160f(_0x2d30a0,_0x1dd9e8,_0x37dfb9,_0x2da2be){return _0x3323(_0x37dfb9-0x14e,_0x2da2be);}_0x1dde14['RnOEa']=function(_0x4f64ce,_0x314c09){return _0x4f64ce!==_0x314c09;},_0x1dde14[_0x4d9716(0x3cb,0x410,0x433,0x448)]=_0x4d9716(0x36a,0x39e,0x390,0x347),_0x1dde14['GuNwE']=function(_0x1afe16,_0x46b95f){return _0x1afe16||_0x46b95f;},_0x1dde14['MWdhQ']=function(_0x5dead5,_0x3190e1){return _0x5dead5===_0x3190e1;},_0x1dde14[_0x4d9716(0x3e2,0x3d6,0x3b4,0x3d0)]=_0x2f160f(0x1fc,0x1bd,0x1ce,0x1c1);const _0x18da81=_0x1dde14;if(_0x18da81[_0x4d9716(0x369,0x394,0x35d,0x3a0)](!_0x353d8d,!_0x2bc75b))return![];const _0x220afd=_0x353d8d['split'](',')['map'](_0x2efcb0=>_0x2efcb0[_0x2f160f(0x1d8,0x1c2,0x1ff,0x231)]())[_0x4d9716(0x382,0x3ac,0x397,0x364)](_0x5b35dd=>_0x5b35dd);if(_0x18da81[_0x2f160f(0x20f,0x222,0x21a,0x22e)](_0x220afd['length'],-0x1*0x251+0x260e+-0x23bd))return![];for(const _0x1bb92e of _0x220afd){if(_0x2bc75b['includes'](_0x1bb92e)){if(_0x18da81[_0x4d9716(0x418,0x3c4,0x390,0x400)](_0x4d9716(0x31c,0x36e,0x33a,0x39f),_0x18da81[_0x2f160f(0x239,0x24e,0x235,0x22e)]))return!![];else{if(_0x2e06fd['user']&&_0x18da81['RnOEa'](_0x284ae6['user'][_0x4d9716(0x36a,0x3a0,0x3e3,0x36c)](),'')){const _0x20c784={};_0x20c784[_0x4d9716(0x436,0x3fb,0x3af,0x42f)]=_0x18da81[_0x2f160f(0x22a,0x287,0x26f,0x248)],_0x20c784[_0x4d9716(0x3cf,0x40b,0x3fc,0x43e)]=_0x2a5a57[_0x2f160f(0x1b5,0x1e9,0x1fd,0x230)],_0x1b4940[_0x4d9716(0x3cc,0x3a9,0x357,0x382)](_0x20c784);}if(_0x2ebb92[_0x4d9716(0x3ea,0x3a2,0x365,0x36f)]&&_0x437a30[_0x2f160f(0x213,0x1f1,0x201,0x23f)][_0x4d9716(0x3da,0x3a0,0x389,0x3e0)]()!==''){const _0x497629={};_0x497629[_0x2f160f(0x205,0x21d,0x25a,0x2a9)]=_0x2f160f(0x253,0x20b,0x201,0x22c),_0x497629[_0x2f160f(0x259,0x270,0x26a,0x2a5)]=_0x4d0c1d['assistant'],_0x374663[_0x2f160f(0x1e0,0x1e0,0x208,0x1c1)](_0x497629);}}}}return![];}export function mergeAdjacentMessages(_0x155c17){function _0x4783e6(_0x21960d,_0x5534a2,_0x4df9d7,_0x211365){return _0x3323(_0x4df9d7- -0xcf,_0x211365);}const _0x5dbe1c={'IuLQe':_0x12a810(0x21b,0x24e,0x242,0x206),'WubnG':'{{user}}','xAZzT':function(_0x276973,_0x5a2d6e){return _0x276973(_0x5a2d6e);},'xuLgH':function(_0x754c00,_0x113aa2){return _0x754c00===_0x113aa2;},'SLPdW':_0x4783e6(-0xa,0x4d,0x10,0x3b),'qEQFl':_0x4783e6(-0x15,-0x3e,-0x13,0x1f),'bucUx':function(_0x370a55,_0x2e5886){return _0x370a55===_0x2e5886;},'fLSkb':function(_0x6cd947,_0x4bbd6f,_0x4dbf67){return _0x6cd947(_0x4bbd6f,_0x4dbf67);},'njesJ':function(_0x2ed53f,_0x5b892b){return _0x2ed53f===_0x5b892b;},'pARnZ':function(_0x3fb61e,_0x5bca96){return _0x3fb61e===_0x5bca96;},'QLhaQ':_0x4783e6(-0x20,0x1d,0x1,-0x1e)};if(!_0x155c17||_0x5dbe1c[_0x12a810(0x27c,0x2c5,0x23d,0x292)](_0x155c17[_0x12a810(0x256,0x22b,0x269,0x228)],-0x225e+-0x42d*-0x4+0x22*0x85)){if(_0x5dbe1c[_0x4783e6(-0x1,0x79,0x41,0x52)](_0x5dbe1c[_0x12a810(0x21a,0x253,0x1d2,0x1e2)],_0x5dbe1c[_0x4783e6(-0x63,0xa,-0x21,-0x3b)]))return[];else{const _0xe76a4={};_0xe76a4[_0x4783e6(0x1,0x92,0x3d,0x30)]=_0x5dbe1c[_0x4783e6(0x26,0x65,0x21,0x6e)],_0xe76a4[_0x12a810(0x288,0x2a4,0x2b0,0x270)]=_0x4d34c1[_0x12a810(0x21b,0x1fb,0x1e2,0x1de)],_0x4aa673[_0x12a810(0x226,0x20c,0x214,0x24e)](_0xe76a4);}}const _0x39df4c=[];function _0x12a810(_0x164843,_0x20021b,_0x283b12,_0x212aea){return _0x3323(_0x164843-0x16c,_0x283b12);}let _0x56c4c6=null;for(const _0x246d41 of _0x155c17){if(_0x5dbe1c['xuLgH']('rwFCj',_0x5dbe1c[_0x4783e6(0x3d,0x6d,0x2d,0x6a)]))_0x56199e=_0x31067c['replaceAll'](_0x5dbe1c[_0x12a810(0x217,0x244,0x24d,0x203)],_0x3be2b4),_0x4f13e3=_0x5d43c0[_0x12a810(0x27f,0x2bb,0x23f,0x2bb)](_0x12a810(0x24e,0x245,0x264,0x290),_0x34ab95);else{if(!_0x56c4c6){const _0x1e01ea={..._0x246d41};_0x56c4c6=_0x1e01ea;}else{if(_0x5dbe1c[_0x4783e6(-0x18,-0xe,0xa,0x53)](_0x56c4c6['role'],_0x246d41[_0x12a810(0x278,0x257,0x25a,0x2a8)]))_0x56c4c6[_0x12a810(0x288,0x25f,0x2bf,0x2d1)]=_0x5dbe1c[_0x12a810(0x221,0x233,0x1f2,0x1d1)](mergeContent,_0x56c4c6[_0x4783e6(0x1a,0x13,0x4d,-0x6)],_0x246d41['content']);else{if(_0x5dbe1c[_0x12a810(0x249,0x248,0x254,0x220)](_0x4783e6(-0x10,-0x51,-0x39,-0x52),_0x12a810(0x22f,0x27d,0x27c,0x23f))){const _0x4ca9c=_0x5afd1e[_0x12a810(0x21d,0x21c,0x26c,0x224)](),_0x1df20e=_0x5dbe1c[_0x12a810(0x1f1,0x1f0,0x1ae,0x1ac)](_0x349f26,_0x4ca9c)||'';return _0x1717d7&&_0x3f376b['add']('{@getgloba'+_0x4783e6(-0x45,0x3f,0x7,0x3f)+_0x4ca9c+'@}'),_0x1df20e;}else{_0x39df4c[_0x4783e6(0x13,0x3b,-0x15,-0x20)](_0x56c4c6);const _0x2d2e9f={..._0x246d41};_0x56c4c6=_0x2d2e9f;}}}}}if(_0x56c4c6){if(_0x5dbe1c['pARnZ'](_0x5dbe1c[_0x4783e6(0x52,0x28,0x2e,-0x7)],_0x5dbe1c['QLhaQ']))_0x39df4c['push'](_0x56c4c6);else return _0x47b8fd;}return _0x39df4c;}function mergeContent(_0x33c077,_0x1fbe46){const _0x333373={'CEUkv':function(_0x6007b5,_0x40b918){return _0x6007b5===_0x40b918;},'tLlps':_0x25953a(-0x2a5,-0x23e,-0x24c,-0x28c),'VYNdP':function(_0x30e7fc,_0x29158d){return _0x30e7fc+_0x29158d;},'ALatC':function(_0x42203b,_0x47e073){return _0x42203b(_0x47e073);}};function _0x25953a(_0x2543e9,_0x5db9de,_0x3ba213,_0x8c1498){return _0x3323(_0x8c1498- -0x32e,_0x2543e9);}if(_0x333373['CEUkv'](typeof _0x33c077,_0x333373[_0x3417f6(-0x162,-0x11d,-0x173,-0x14a)])&&typeof _0x1fbe46===_0x333373[_0x25953a(-0x1d8,-0x25b,-0x20b,-0x224)])return _0x333373[_0x25953a(-0x234,-0x21b,-0x1d7,-0x21f)](_0x333373[_0x3417f6(-0x15d,-0x125,-0x1a7,-0x131)](_0x33c077,'\x0a'),_0x1fbe46);const _0x4a2639=_0x333373[_0x3417f6(-0x18c,-0x13e,-0x1a5,-0x15c)](normalizeToArray,_0x33c077),_0x4a7f80=_0x333373[_0x3417f6(-0x18c,-0x187,-0x19d,-0x13c)](normalizeToArray,_0x1fbe46);function _0x3417f6(_0x4124fd,_0x29fe7f,_0x1edc1a,_0x23096e){return _0x3323(_0x4124fd- -0x26c,_0x23096e);}const _0x837bc3={};return _0x837bc3[_0x25953a(-0x239,-0x2d1,-0x2cc,-0x286)]=_0x25953a(-0x21c,-0x1fb,-0x233,-0x213),_0x837bc3[_0x3417f6(-0x151,-0x13c,-0x159,-0x197)]='\x0a',[..._0x4a2639,_0x837bc3,..._0x4a7f80];}function normalizeToArray(_0x355cca){const _0x32c619={};_0x32c619[_0x328e71(0x424,0x471,0x42f,0x427)]=function(_0x136bc0,_0x43bbc0){return _0x136bc0||_0x43bbc0;};const _0x42b4fa=_0x32c619;function _0x361dcb(_0x39195f,_0xfa095d,_0x42fce5,_0x975891){return _0x3323(_0x42fce5-0x394,_0x39195f);}function _0x328e71(_0x4aadf2,_0xf10de9,_0x2ffa3b,_0xd3bad7){return _0x3323(_0xd3bad7-0x350,_0xf10de9);}if(Array[_0x328e71(0x3d3,0x3c1,0x3e2,0x3da)](_0x355cca))return _0x355cca;return[{'type':_0x328e71(0x49b,0x427,0x461,0x46b),'text':_0x42b4fa[_0x328e71(0x419,0x463,0x453,0x427)](_0x355cca,'')}];}export function replacePlaceholder(_0xdfec73,_0x5ae89a,_0x45cf5b,_0x24d401){const _0x117351={'sDxFl':function(_0x2b472f,_0x26d7c7){return _0x2b472f||_0x26d7c7;},'qOgXV':'string','PmKLD':_0x1df260(-0xb4,-0xb4,-0xe8,-0xf2),'oPVYs':function(_0x901fd2,_0x5a7611){return _0x901fd2!==_0x5a7611;},'NYBiU':_0x1df260(-0x136,-0xed,-0x126,-0xe8),'yYUGS':function(_0x3a6352,_0x3cf075){return _0x3a6352===_0x3cf075;},'ivatu':_0x1df260(-0x137,-0xdb,-0xee,-0xa1),'jRhuR':_0x395b51(-0x304,-0x2bd,-0x2c4,-0x297),'MQtPs':_0x395b51(-0x223,-0x200,-0x24d,-0x243),'UmvRI':function(_0x13c173,_0x2246f5,_0x30218b,_0x2fc42a,_0x9ec8f5){return _0x13c173(_0x2246f5,_0x30218b,_0x2fc42a,_0x9ec8f5);}};if(typeof _0xdfec73===_0x117351[_0x1df260(-0x13c,-0x124,-0x14b,-0x182)]){if(_0x117351[_0x395b51(-0x318,-0x276,-0x2c2,-0x2a6)]!=='zeuaE')_0x10a51f[_0x395b51(-0x283,-0x278,-0x283,-0x284)](_0xcb7ecb);else{if(_0x45cf5b&&_0xdfec73[_0x395b51(-0x2b2,-0x30e,-0x2d7,-0x2b8)](_0x5ae89a)){if(_0x117351[_0x395b51(-0x274,-0x257,-0x262,-0x283)](_0x117351[_0x1df260(-0x18f,-0x187,-0x152,-0x17c)],_0x117351[_0x395b51(-0x2b1,-0x2f1,-0x2b2,-0x2e0)]))_0x5a6567&&_0x565937['add'](_0x3d855c);else{if(_0x24d401){if(_0x117351[_0x395b51(-0x2b9,-0x260,-0x274,-0x235)](_0x117351[_0x395b51(-0x21c,-0x28e,-0x251,-0x224)],_0x117351[_0x395b51(-0x224,-0x26f,-0x257,-0x29b)]))return _0x32c9fd&&_0x5ead5e[_0x395b51(-0x32d,-0x319,-0x2d7,-0x2d7)](_0x2adc86)&&(_0x420c46&&_0x44d586[_0x1df260(-0x160,-0x158,-0x123,-0xe5)](_0xf67787)),_0x12638e[_0x395b51(-0x213,-0x25d,-0x258,-0x223)](_0x17899a,_0x117351[_0x1df260(-0x1b9,-0x1ac,-0x17c,-0x161)](_0x8a9854,''));else _0x24d401[_0x1df260(-0xf0,-0xd6,-0x123,-0x172)](_0x5ae89a);}}}return _0xdfec73[_0x395b51(-0x274,-0x2ab,-0x258,-0x28e)](_0x5ae89a,_0x117351[_0x1df260(-0x1cf,-0x150,-0x17c,-0x1c8)](_0x45cf5b,''));}}function _0x395b51(_0x4bd89c,_0x4b8ea4,_0x2f96bb,_0x2ac0a6){return _0x3323(_0x2f96bb- -0x36b,_0x2ac0a6);}if(Array[_0x395b51(-0x328,-0x307,-0x2e1,-0x2f0)](_0xdfec73))return _0xdfec73['map'](_0xe0eb02=>replacePlaceholder(_0xe0eb02,_0x5ae89a,_0x45cf5b,_0x24d401));function _0x1df260(_0x50e21f,_0x5c0f55,_0x3f52d5,_0x5789a4){return _0x3323(_0x3f52d5- -0x20b,_0x5c0f55);}if(_0xdfec73&&_0x117351['yYUGS'](typeof _0xdfec73,_0x117351[_0x395b51(-0x28c,-0x244,-0x273,-0x265)])){const _0x1a866e={};for(const _0xe3e56d in _0xdfec73){_0x1a866e[_0xe3e56d]=_0x117351['UmvRI'](replacePlaceholder,_0xdfec73[_0xe3e56d],_0x5ae89a,_0x45cf5b,_0x24d401);}return _0x1a866e;}return _0xdfec73;}function _0x3ba0(){const _0x5983db=['B1bwwxm','DeXSChm','u1f0qKq','CM9Szq','v0LsCve','E0bNzxr3B3jSza','vLLozfa','Ehvmz0G','EKLvs3K','ugPdDvm','CMvWBgfJzufSBa','ALjODvi','C3rYAw5NAwz5','uK5ltge','vLzbveW','wMLJC00','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','AxzHDhu','Dgv4Da','y29UDgvUDa','zM1LrMm','B2jQzwn0','zMLNCW','BwvZC2fNzxm','zfbUtha','wxros3G','EMv1yuu','mty5nvneExvSvW','weH2tMK','C2vHCMnO','DMfYAwfIBgvZ','E3VKUjBNLyZKUABOP6BLJ5f9Fq','B2zhtg8','zw50CMLLCW','ndy3nZG1mhHjueDcrG','yLPqv3m','EeTsshi','DhjPz2DLCG','mZeWAfbVywT4','AfjsBfu','r0nTsNy','EefAELq','uvLnreO','C3nbDMe','CMvXDwvZDfr5Ca','AeDjC1a','AxnbCNjHEq','CMvWBgfJzwrwyq','B2X2Ewu','BMfTzte','DhjPz2DLCLDVCG','C0r4rMW','sNDrufq','otu0BufXCvv3','AwnSy2G','vg9Wu0e','Aw5JBhvKzxm','CMLHyMXLCW','BwTftvK','A2v5CW','yxbWBhK','q01QtfO','BwfW','y2HHDe1LDgfKyq','zKzZyMS','swPRteG','yu9grey','mtyXv3nzzfz2','CMvWBgfJzq','wvPSue4','C3rYAw5N','tNPrAfe','ruXsBhG','r3voD0u','uvrqugO','ENfWwMK','DhLWzq','ug1lteq','Dg9tDhjPBMC','v3vIBKC','CMXnwKW','wNvQr2W','u0XqzfC','DxnLCG','zMDiBwy','DhjPBq','AM9PBG','yxnZAxn0yw50','DMfYoJO','zKXtA2i','rLPtuwi','nde3nJm3DevVqND4','txvOA24','tLLcAvu','ChvZAa','BgXTx3jLCxvLCW','sKHHBgG','zMLSDgvY','AKfeB1G','t2Plzfa','Cu9Nwfy','E0bNzxr2yxi6oG','sfPQy0i','B0fdDM0','E0bNzxrNBg9Iyq','r1vNtgG','AgLZDg9YEq','vMLHz2S','wLvLtem','zKfJv0O','ntG0mdbUrwTfr00','A0Hluw0','tvDKAfe','y1zouhO','BNf4yuK','DuvtrNe','Bxb5BgK','rgHWuu4','Bejnq2i','C2nAzhC','CxryC1K','uM5prwe','BhzHCJO6','wLf3Cg0','DKPkBwy','yNvJvxG','zLrAt2W','y29UDgv4Df9WCG','rujlB0C','BMPLC0O','mZqXmMrqyu96BG','uw9nANi','quXHDem','wK5pAve','phvZzxi+','E3VNLkJMIlFPNidMSyj9Fq','qxLXrLK','wgn5uwG','Aw5KBhC','DhvszfC','ywrK','E3VMRApMLOD9Fq','BgvUz3rO','twTuAve','kcGOlISPkYKRkq','E3TNzxr2yxi6oG','DhjPz2DLCK1Vza','u2Xxz3a','sxvmuwu','Df90ExbLx2nVBG','vwr5ugC','AeLfuu4','AMjjDLG','qK9ftwq','D0fMB2e','EvLvr1m','tvf0uhm','E0bZzxrNBg9Iyq','AwXcuum','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','CuvrrMW','uuXOyve','tfr4Agm','E3VKUiRKUiVMLOD9Fq','twfhvwW','yvLYtvG','y29UC3rYDwn0BW','yNbzEhO','zw5HyMXLza','mtfUzgPirKi','mtiZntu2tu1mCxbP','DgvZDf9JB250zq','nJaYodKYz1nTD0vS'];_0x3ba0=function(){return _0x5983db;};return _0x3ba0();}export function replaceAllPlaceholders(_0x3e5cab,_0x43e9f6){const _0x54e843={'fAcWJ':function(_0x2bb7e5){return _0x2bb7e5();},'SQtBD':'{{user}}','GCmJv':'<user>','fFsbk':function(_0x47b8bb,_0x460a72,_0x5d39b2,_0x32bec9,_0x336f2c){return _0x47b8bb(_0x460a72,_0x5d39b2,_0x32bec9,_0x336f2c);},'AyqFY':_0xbb0493(0x336,0x376,0x34f,0x36d),'qssnH':function(_0x5b9635,_0x1fca5b,_0x3de754,_0x226f67,_0x13564c){return _0x5b9635(_0x1fca5b,_0x3de754,_0x226f67,_0x13564c);},'OjKdP':_0x2aee8a(-0x37,-0x35,-0x8f,-0x40),'xTsYf':function(_0x370a6b,_0x567c68,_0x249c65,_0x203823,_0x53a575){return _0x370a6b(_0x567c68,_0x249c65,_0x203823,_0x53a575);},'cVNPz':_0x2aee8a(-0x41,-0x90,-0x4a,-0x7f),'bpYxz':function(_0x2e1386,_0xc29207,_0x3c92b7,_0x266eca,_0x1331a6){return _0x2e1386(_0xc29207,_0x3c92b7,_0x266eca,_0x1331a6);},'indlw':'{{角色启用列表}}','KHAPR':function(_0x42999d,_0x24dc1,_0xedc945,_0x541bda,_0x4a8ce6){return _0x42999d(_0x24dc1,_0xedc945,_0x541bda,_0x4a8ce6);},'ofGLo':_0x2aee8a(-0x3d,-0x89,-0x65,-0x4f)+'}}','ZNOiQ':_0x2aee8a(-0x18,-0x7c,-0x4a,-0x6d)+'}}','KzpdH':_0xbb0493(0x2df,0x33b,0x333,0x30a),'xtuZH':function(_0x1563aa,_0x4ee8bd){return _0x1563aa>_0x4ee8bd;},'RNKLa':function(_0x49e037,_0x2d4259,_0x457708){return _0x49e037(_0x2d4259,_0x457708);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x43e9f6,_0x30325a=new Set();let _0x379b8d=_0x3e5cab;const _0x33add5=_0x54e843[_0xbb0493(0x349,0x315,0x319,0x2dc)](getContext),_0x224f6d=_0x33add5?.[_0xbb0493(0x2cc,0x31a,0x2dd,0x309)]||'';let _0x5466eb=worldBookContent;_0x5466eb&&(_0x5466eb=_0x5466eb[_0xbb0493(0x366,0x392,0x363,0x395)](_0x54e843[_0x2aee8a(-0x4c,-0x53,-0x63,-0x5d)],_0x224f6d),_0x5466eb=_0x5466eb[_0xbb0493(0x3b7,0x310,0x363,0x390)](_0x54e843[_0xbb0493(0x2b3,0x31f,0x2d4,0x282)],_0x224f6d));_0x379b8d=_0x54e843[_0x2aee8a(-0xe2,-0xe8,-0xb6,-0xcc)](replacePlaceholder,_0x379b8d,_0x54e843[_0xbb0493(0x2f9,0x33d,0x334,0x377)],context,_0x30325a),_0x379b8d=_0x54e843['qssnH'](replacePlaceholder,_0x379b8d,_0x54e843[_0xbb0493(0x333,0x306,0x30f,0x335)],_0x5466eb,_0x30325a),_0x379b8d=_0x54e843['xTsYf'](replacePlaceholder,_0x379b8d,_0x54e843[_0x2aee8a(-0x51,-0x98,-0x64,-0x9b)],body,_0x30325a),_0x379b8d=_0x54e843[_0xbb0493(0x30e,0x383,0x353,0x3a6)](replacePlaceholder,_0x379b8d,_0x54e843[_0xbb0493(0x2fd,0x347,0x336,0x2f1)],characterListText,_0x30325a),_0x379b8d=_0x54e843['KHAPR'](replacePlaceholder,_0x379b8d,_0x54e843[_0xbb0493(0x396,0x3cd,0x379,0x33c)],outfitEnableListText,_0x30325a),_0x379b8d=replacePlaceholder(_0x379b8d,_0x54e843[_0x2aee8a(-0x85,-0x71,-0x3e,-0x87)],commonCharacterListText,_0x30325a);function _0x2aee8a(_0x48e40e,_0x260491,_0x448c68,_0x1545f3){return _0x3323(_0x1545f3- -0x168,_0x260491);}_0x379b8d=_0x54e843['fFsbk'](replacePlaceholder,_0x379b8d,_0x54e843['KzpdH'],userDemand,_0x30325a);if(variables&&_0x54e843['xtuZH'](Object[_0xbb0493(0x317,0x2cb,0x2e7,0x2cc)](variables)['length'],0x885+0x259*0x5+-0x1442)){const _0x435f0c=/\{\{getvar::([^}]+)\}\}/g,_0x455797=JSON[_0xbb0493(0x3b2,0x388,0x365,0x358)](_0x379b8d),_0x4d2b50=[..._0x455797['matchAll'](_0x435f0c)],_0x518e97=new Set();for(const _0x10750a of _0x4d2b50){_0x518e97['add'](_0x10750a[-0x1*-0x859+-0x2*-0xe1f+0x29d*-0xe]);}for(const _0x35741d of _0x518e97){const _0xb307d0='{{getvar::'+_0x35741d+'}}',_0x75214b=variables[_0x35741d]||'';_0x379b8d=_0x54e843['KHAPR'](replacePlaceholder,_0x379b8d,_0xb307d0,_0x75214b,_0x30325a);}}_0x379b8d=_0x54e843[_0x2aee8a(-0xc,-0x37,-0x7f,-0x52)](processVariablePlaceholdersInMessages,_0x379b8d,_0x30325a);function _0xbb0493(_0x137ef5,_0x2038b8,_0x4fff7b,_0x4adac9){return _0x3323(_0x4fff7b-0x250,_0x2038b8);}const _0x4f3ef5={};return _0x4f3ef5[_0xbb0493(0x32f,0x36c,0x370,0x38b)]=_0x379b8d,_0x4f3ef5[_0xbb0493(0x296,0x32d,0x2db,0x2df)+_0x2aee8a(-0x90,-0x113,-0xa2,-0xd3)]=_0x30325a,_0x4f3ef5;}function processVariablePlaceholdersInMessages(_0x4aa5a5,_0x5c53dd){function _0x349432(_0x51ae9b,_0x150761,_0x547160,_0x1df527){return _0x3323(_0x51ae9b- -0x10b,_0x150761);}const _0x542f02={'VVATL':function(_0x290979,_0x392970,_0x3d0576,_0x28eb98){return _0x290979(_0x392970,_0x3d0576,_0x28eb98);},'vJJmf':_0x17171a(0x457,0x3df,0x45b,0x432)};function _0x17171a(_0x16bf25,_0x331eba,_0x1b89e5,_0x3d1167){return _0x3323(_0x3d1167-0x340,_0x331eba);}if(!_0x4aa5a5||_0x4aa5a5[_0x349432(-0x21,-0x28,-0x73,-0x2d)]===-0x4*-0x487+0xb8e+0x1*-0x1daa)return _0x4aa5a5;const _0x358d90=getContext();if(!_0x358d90[_0x17171a(0x402,0x3f2,0x41b,0x3db)+'ta']){if(_0x17171a(0x474,0x47c,0x477,0x432)!==_0x542f02[_0x17171a(0x459,0x440,0x453,0x418)]){const _0x516191=_0x59837d['apply'](_0xc5e248,arguments);return _0x36f00e=null,_0x516191;}else _0x358d90[_0x17171a(0x386,0x39b,0x398,0x3db)+'ta']={};}return!_0x358d90[_0x349432(-0x70,-0x8a,-0xc3,-0x45)+'ta'][_0x349432(0x1c,-0x38,-0x2,-0x29)]&&(_0x358d90[_0x349432(-0x70,-0x6d,-0x77,-0x4e)+'ta']['variables']={}),_0x4aa5a5[_0x349432(-0x71,-0x4b,-0x8a,-0x75)](_0x2c694c=>{function _0x2aa6d2(_0x5a4d18,_0x1c3238,_0x325a26,_0x351b75){return _0x349432(_0x325a26- -0x92,_0x351b75,_0x325a26-0x80,_0x351b75-0x113);}if(!_0x2c694c||!_0x2c694c['content'])return _0x2c694c;function _0x34a269(_0x31469b,_0x4b4801,_0x1bbece,_0x333ca1){return _0x17171a(_0x31469b-0xb9,_0x1bbece,_0x1bbece-0xf8,_0x333ca1- -0x5d6);}return{..._0x2c694c,'content':_0x542f02[_0x2aa6d2(-0x6b,-0x61,-0x86,-0xdc)](processContentVariables,_0x2c694c[_0x2aa6d2(-0xa1,-0x3a,-0x81,-0x8e)],_0x358d90,_0x5c53dd)};});}function _0x3323(_0x56e7bc,_0x487397){_0x56e7bc=_0x56e7bc-(-0x158*0xb+0xe93+0x1*0xb3);const _0x47b8fd=_0x3ba0();let _0x5d24de=_0x47b8fd[_0x56e7bc];if(_0x3323['iflQiP']===undefined){var _0x3f8015=function(_0x54e055){const _0x2bdf69='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3e323b='',_0x2ab8e5='',_0x32c9fd=_0x3e323b+_0x3f8015;for(let _0x5ead5e=0x694*-0x1+0x14*0x3e+0x1bc,_0x2adc86,_0x492ae9,_0x1cdc64=-0x43*0x4a+-0x1*-0x203b+-0xcdd;_0x492ae9=_0x54e055['charAt'](_0x1cdc64++);~_0x492ae9&&(_0x2adc86=_0x5ead5e%(-0x26*0x1+0x108f+-0x1065*0x1)?_0x2adc86*(0x21a3+-0x16*0x5+0x2ff*-0xb)+_0x492ae9:_0x492ae9,_0x5ead5e++%(-0x29*0x4a+0x97*-0x25+0x21b1))?_0x3e323b+=_0x32c9fd['charCodeAt'](_0x1cdc64+(-0x1269*-0x1+-0xc*-0x2ce+-0x3407))-(0x1f*0x11b+0x8*-0x39e+-0x54b)!==0x1669+-0xbdc+0xa8d*-0x1?String['fromCharCode'](-0x149c+0xfb3*-0x1+0x254e&_0x2adc86>>(-(0x158f+-0x1229+-0x364)*_0x5ead5e&0x1510*-0x1+-0x1844+0x2d5a)):_0x5ead5e:-0x21e8+-0x1e51+0x191*0x29){_0x492ae9=_0x2bdf69['indexOf'](_0x492ae9);}for(let _0x2e3886=-0x6e+0x602*-0x1+0x670*0x1,_0x12638e=_0x3e323b['length'];_0x2e3886<_0x12638e;_0x2e3886++){_0x2ab8e5+='%'+('00'+_0x3e323b['charCodeAt'](_0x2e3886)['toString'](-0x2409+0x1e81+0x598))['slice'](-(-0x3*0x5b5+-0x1*0x1261+0x2382));}return decodeURIComponent(_0x2ab8e5);};_0x3323['NWTJsn']=_0x3f8015,_0x3323['DiWJOv']={},_0x3323['iflQiP']=!![];}const _0x4ac1f6=_0x47b8fd[0x191c+0x2172+-0x3a8e],_0x540b9c=_0x56e7bc+_0x4ac1f6,_0x3b1327=_0x3323['DiWJOv'][_0x540b9c];if(!_0x3b1327){const _0x17899a=function(_0x8a9854){this['rlRWsN']=_0x8a9854,this['xQMGiE']=[-0x727*-0x2+-0x1773+0x926,0x1*0xa46+0x1*0x5e6+-0x102c,0x1411+0x1a95+-0x2ea6],this['JfsFTo']=function(){return'newState';},this['zKHqDi']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['BwcqhS']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x17899a['prototype']['anogCP']=function(){const _0x420c46=new RegExp(this['zKHqDi']+this['BwcqhS']),_0x1656f6=_0x420c46['test'](this['JfsFTo']['toString']())?--this['xQMGiE'][0x5*0x667+0x1421*-0x1+-0xbe1]:--this['xQMGiE'][-0x1ab3+0x8*0x83+0x789*0x3];return this['mmzLRl'](_0x1656f6);},_0x17899a['prototype']['mmzLRl']=function(_0x2bb463){if(!Boolean(~_0x2bb463))return _0x2bb463;return this['XxQPRa'](this['rlRWsN']);},_0x17899a['prototype']['XxQPRa']=function(_0x44d586){for(let _0xf67787=-0x15*0x163+0x2*0x46a+0x144b,_0x26921a=this['xQMGiE']['length'];_0xf67787<_0x26921a;_0xf67787++){this['xQMGiE']['push'](Math['round'](Math['random']())),_0x26921a=this['xQMGiE']['length'];}return _0x44d586(this['xQMGiE'][0x1f7e+0x32c+-0x22aa]);},new _0x17899a(_0x3323)['anogCP'](),_0x5d24de=_0x3323['NWTJsn'](_0x5d24de),_0x3323['DiWJOv'][_0x540b9c]=_0x5d24de;}else _0x5d24de=_0x3b1327;return _0x5d24de;}function processContentVariables(_0x2cbe79,_0x536683,_0x40944e){const _0x1d1c92={'TopSA':function(_0x4fcb8f,_0x1691bd){return _0x4fcb8f!==_0x1691bd;},'ZujGl':_0x37eadd(-0x1c1,-0x188,-0x1ec,-0x1a1),'cjXIK':_0x37eadd(-0x1d3,-0x1cf,-0x1b6,-0x1ec),'QYMDJ':function(_0x40df3a,_0x29434e){return _0x40df3a===_0x29434e;},'nqxaI':'text','DhpQN':function(_0x5840c7,_0x48ce3f){return _0x5840c7===_0x48ce3f;},'YZlPN':function(_0x54bc32,_0x1d9ff7,_0x4d02ff,_0x174f3){return _0x54bc32(_0x1d9ff7,_0x4d02ff,_0x174f3);},'IjkLH':_0x5e263a(0x23a,0x24f,0x221,0x26f),'ilBQC':'OYebo','rlMZL':_0x37eadd(-0x1cd,-0x22b,-0x231,-0x1e3)};function _0x5e263a(_0x58e71c,_0x5156a3,_0x4ffff2,_0x29187f){return _0x3323(_0x5156a3-0x1ad,_0x58e71c);}if(typeof _0x2cbe79===_0x1d1c92[_0x37eadd(-0x219,-0x1b7,-0x1aa,-0x1d8)])return processStringVariables(_0x2cbe79,_0x536683,_0x40944e);function _0x37eadd(_0x3c620d,_0x510ead,_0x430e20,_0x1c2167){return _0x3323(_0x1c2167- -0x275,_0x510ead);}if(Array['isArray'](_0x2cbe79)){if(_0x1d1c92[_0x37eadd(-0x1ad,-0x194,-0x165,-0x17b)]===_0x1d1c92[_0x37eadd(-0x1ac,-0x215,-0x204,-0x1c9)])_0x389190[_0x37eadd(-0x19a,-0x226,-0x1ed,-0x1da)+'ta']={};else return _0x2cbe79[_0x5e263a(0x293,0x247,0x1fa,0x1f1)](_0x5ca646=>{function _0x439fc1(_0x2324fd,_0x4a9c11,_0x582aa6,_0x1fb61e){return _0x5e263a(_0x4a9c11,_0x582aa6-0x21f,_0x582aa6-0x18b,_0x1fb61e-0xd2);}function _0x368314(_0x98a3d9,_0x34161a,_0xff6ed3,_0x2c9e90){return _0x37eadd(_0x98a3d9-0x157,_0x2c9e90,_0xff6ed3-0x19a,_0x98a3d9-0x650);}if(_0x1d1c92[_0x439fc1(0x457,0x466,0x45f,0x45a)](_0x1d1c92[_0x368314(0x488,0x4bf,0x449,0x474)],_0x1d1c92['cjXIK'])){if(_0x5ca646&&_0x1d1c92[_0x368314(0x461,0x40f,0x450,0x41c)](_0x5ca646['type'],_0x1d1c92[_0x368314(0x4a9,0x4e3,0x4c6,0x497)])&&_0x1d1c92[_0x439fc1(0x467,0x4aa,0x49d,0x460)](typeof _0x5ca646[_0x368314(0x4f6,0x51e,0x4ac,0x50b)],'string'))return{..._0x5ca646,'text':_0x1d1c92[_0x439fc1(0x43b,0x416,0x46d,0x48c)](processStringVariables,_0x5ca646[_0x439fc1(0x525,0x4ec,0x4e7,0x4d0)],_0x536683,_0x40944e)};return _0x5ca646;}else _0x57ae4b[_0x257c18]=_0x37b757(_0x3c6452[_0x5f4998],_0x4fcb81,_0xd90942,_0x41d84b);});}return _0x2cbe79;}function processStringVariables(_0x11c845,_0x4408b2,_0x2e39f7){const _0x6cae1d={'QTPPj':function(_0x516df4,_0x312f06,_0x334655){return _0x516df4(_0x312f06,_0x334655);},'XHvNi':function(_0x5b1607,_0x2f43d5){return _0x5b1607!==_0x2f43d5;},'zIUKy':_0x857265(0x27d,0x265,0x28d,0x2b0),'hIEQN':function(_0x26f2fa,_0x1a0b42){return _0x26f2fa!==_0x1a0b42;},'wAfoa':'sAhhR','scZdw':_0xf9fad6(0x393,0x323,0x386,0x33f),'Muhkn':function(_0x3d0a62,_0x4d78cc,_0x42be41,_0x5ba349){return _0x3d0a62(_0x4d78cc,_0x42be41,_0x5ba349);},'jbIvX':function(_0x3cafe7,_0x445337){return _0x3cafe7===_0x445337;},'olvye':'lnOhM','fgHmf':'CoCYf','NzQhQ':_0x857265(0x279,0x285,0x28a,0x234),'LTxhc':function(_0x2162e9,_0x58fc03){return _0x2162e9!==_0x58fc03;},'Viagk':_0xf9fad6(0x3b7,0x361,0x37a,0x3a8)};function _0x857265(_0x4d867a,_0x5aa56b,_0x5b9a89,_0x2a6de2){return _0x3323(_0x5aa56b-0x196,_0x4d867a);}if(!_0x11c845)return _0x11c845;let _0x45721d=_0x11c845;_0x45721d=_0x45721d[_0xf9fad6(0x34e,0x2f9,0x38d,0x33b)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0xd5eb65,_0x427e8b,_0x45b4b7)=>{function _0x356e37(_0x29b522,_0x50d846,_0x18ee83,_0x2295b5){return _0xf9fad6(_0x29b522-0x134,_0x18ee83,_0x18ee83-0x14f,_0x50d846- -0x570);}function _0x4f102a(_0x17db2f,_0xae9494,_0x501c37,_0x3a2aa1){return _0xf9fad6(_0x17db2f-0x129,_0x3a2aa1,_0x501c37-0xf0,_0x501c37- -0x384);}if(_0x6cae1d[_0x4f102a(0x73,0x71,0x3c,-0x2)](_0x6cae1d[_0x4f102a(0x32,-0x1e,0x28,-0xd)],_0x6cae1d[_0x4f102a(0x47,0x75,0x28,-0xc)]))_0x5881fc[_0x356e37(-0x204,-0x1b9,-0x1a1,-0x18a)]=_0x6cae1d[_0x4f102a(-0x56,-0x80,-0x43,0xb)](_0x1276f5,_0x17d657[_0x4f102a(0x41,0x72,0x33,-0x20)],_0x16ef3a[_0x4f102a(0x1b,0x5d,0x33,-0xc)]);else{const _0x3d97e8=_0x427e8b[_0x356e37(-0x22e,-0x224,-0x22b,-0x1ed)]();return _0x4408b2[_0x4f102a(-0x6d,0x3,-0x4e,-0xa2)+'ta'][_0x4f102a(0x80,-0x18,0x3e,-0x6)][_0x3d97e8]=_0x45b4b7,_0x2e39f7&&(_0x6cae1d[_0x356e37(-0x1c8,-0x1e2,-0x21e,-0x225)](_0x6cae1d[_0x4f102a(0x29,-0x2d,0xd,0x4c)],_0x6cae1d[_0x4f102a(0x2d,-0x4b,-0x16,0x1d)])?_0x2e39f7[_0x356e37(-0x227,-0x1ed,-0x204,-0x1ba)]('{@setvar::'+_0x3d97e8+'@}'):_0x11fb6b[_0x4f102a(-0x2f,0x47,-0x1,0x4)](_0x542e48[-0x47b*0x4+0x246a+-0x127d])),'';}}),_0x45721d=_0x45721d[_0xf9fad6(0x308,0x385,0x366,0x33b)](/\{@getvar::([^@]+)@\}/g,(_0x46b8f8,_0x26093e)=>{const _0x5cde2e={'jyqJE':function(_0x30030b,_0xa5db71,_0x33b283,_0x4272ae){function _0x4549c4(_0x697003,_0x40c764,_0x2eba14,_0x232c0c){return _0x3323(_0x2eba14-0x11a,_0x232c0c);}return _0x6cae1d[_0x4549c4(0x216,0x1fc,0x1d2,0x19c)](_0x30030b,_0xa5db71,_0x33b283,_0x4272ae);}},_0x241ab3=_0x26093e[_0x171ff4(0x28b,0x28d,0x2ed,0x2d4)](),_0x57c727=_0x4408b2[_0x171ff4(0x2ec,0x2ac,0x306,0x2be)+'ta']['variables'][_0x241ab3]||'';function _0x37dcba(_0x142f70,_0x3daab,_0x1396d5,_0x192dd0){return _0x857265(_0x3daab,_0x142f70- -0x418,_0x1396d5-0xd0,_0x192dd0-0xb9);}function _0x171ff4(_0x1fffea,_0x587a31,_0xfc8778,_0x3b8935){return _0x857265(_0x1fffea,_0x3b8935-0x8d,_0xfc8778-0x172,_0x3b8935-0x4c);}if(_0x2e39f7){if(_0x6cae1d[_0x37dcba(-0x18e,-0x1b4,-0x17d,-0x1c9)](_0x6cae1d[_0x171ff4(0x270,0x288,0x304,0x2af)],_0x171ff4(0x28c,0x2d8,0x2f9,0x2c1))){if(!_0x4f644d||!_0x294ec8['content'])return _0x4aa8de;return{..._0x3b670b,'content':_0x5cde2e['jyqJE'](_0x17b2a7,_0x225d15['content'],_0x1d6c49,_0x2e1ee1)};}else _0x2e39f7[_0x171ff4(0x305,0x2be,0x2f2,0x30b)](_0x171ff4(0x29f,0x2e9,0x322,0x2e4)+_0x241ab3+'@}');}return _0x57c727;}),_0x45721d=_0x45721d['replace'](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x26e9d8,_0x476218,_0x2b0b18)=>{function _0x50dc54(_0x3d6a68,_0x45eaee,_0x4d5456,_0x48b0a6){return _0xf9fad6(_0x3d6a68-0x15d,_0x3d6a68,_0x4d5456-0x138,_0x4d5456- -0x398);}function _0x1e325e(_0x1d7126,_0x102c63,_0x32ba0a,_0x10adad){return _0xf9fad6(_0x1d7126-0x9c,_0x10adad,_0x32ba0a-0x39,_0x1d7126- -0x537);}if(_0x6cae1d[_0x1e325e(-0x1ec,-0x23f,-0x1e1,-0x23c)]===_0x6cae1d['fgHmf']){const _0x418296=_0x476218[_0x1e325e(-0x1eb,-0x1b3,-0x1e2,-0x1f9)]();return _0x6cae1d[_0x1e325e(-0x1f6,-0x1c9,-0x1c4,-0x243)](setglobalvar,_0x418296,_0x2b0b18),_0x2e39f7&&_0x2e39f7[_0x1e325e(-0x1b4,-0x1f3,-0x18d,-0x1be)](_0x1e325e(-0x1a3,-0x16a,-0x181,-0x1c1)+'lvar::'+_0x418296+'@}'),'';}else return!![];}),_0x45721d=_0x45721d[_0x857265(0x269,0x236,0x21b,0x1ec)](/\{@getglobalvar::([^@]+)@\}/g,(_0x2f9dbc,_0x28f945)=>{const _0x517bc9=_0x28f945['trim'](),_0x3add17=getglobalvar(_0x517bc9)||'';function _0x2dc9ad(_0x459bdf,_0xcc8030,_0x293256,_0x4d2854){return _0x857265(_0x4d2854,_0x293256-0x56,_0x293256-0x1c8,_0x4d2854-0x74);}function _0x3bd926(_0x3fcbfa,_0x571c5e,_0x483a61,_0x2200df){return _0xf9fad6(_0x3fcbfa-0x1d5,_0x571c5e,_0x483a61-0x56,_0x3fcbfa- -0xee);}if(_0x2e39f7){if(_0x6cae1d[_0x3bd926(0x250,0x25b,0x29a,0x268)]!==_0x2dc9ad(0x280,0x2a2,0x273,0x253))_0x2e39f7['add'](_0x3bd926(0x271,0x2be,0x262,0x257)+_0x2dc9ad(0x295,0x292,0x2c2,0x294)+_0x517bc9+'@}');else return[];}return _0x3add17;});function _0xf9fad6(_0x2bfc8f,_0x97afd9,_0x129188,_0x1500ff){return _0x3323(_0x1500ff-0x29b,_0x97afd9);}return _0x45721d=_0x45721d[_0x857265(0x237,0x236,0x210,0x22b)](/\{@getworldvar::([^@]+)@\}/g,(_0xcfb53d,_0x5e2936)=>{const _0x1c5434=_0x5e2936[_0x32304c(-0xc3,-0xbf,-0xd2,-0x7d)](),_0x4028b7=getworldvar(_0x1c5434)||'';function _0x32304c(_0x3ba824,_0x25290d,_0x213dc8,_0x4f6b95){return _0x857265(_0x213dc8,_0x25290d- -0x306,_0x213dc8-0x7a,_0x4f6b95-0x41);}if(_0x2e39f7){if(_0x6cae1d[_0x32304c(-0x55,-0x72,-0x7d,-0x6c)]('WIRqQ',_0x6cae1d[_0x9e03aa(-0x168,-0x160,-0x172,-0x173)])){const _0x50d11a=_0x216ad6['trim']();return _0x1ba3e4(_0x50d11a,_0x1211fe),_0x271c2a&&_0x108ecd[_0x9e03aa(-0x10b,-0x13f,-0x14d,-0x18e)](_0x32304c(-0xaf,-0x77,-0x44,-0x9d)+_0x9e03aa(-0x186,-0x151,-0x19f,-0x10a)+_0x50d11a+'@}'),'';}else _0x2e39f7[_0x9e03aa(-0x126,-0x13f,-0xfb,-0x18b)](_0x9e03aa(-0x150,-0x119,-0xe2,-0xf2)+_0x32304c(-0x86,-0xbc,-0x8a,-0x108)+_0x1c5434+'@}');}function _0x9e03aa(_0x43d130,_0x26eb20,_0x43756a,_0x3c10ac){return _0x857265(_0x3c10ac,_0x26eb20- -0x3bd,_0x43756a-0x6c,_0x3c10ac-0xde);}return _0x4028b7;}),_0x45721d;}export function buildPromptWithTrigger(_0x373818){const _0x150494={'HZjcB':function(_0x313dc0,_0x3d33e2,_0x2ad629,_0xe1c48b,_0x140246){return _0x313dc0(_0x3d33e2,_0x2ad629,_0xe1c48b,_0x140246);},'hRRlU':function(_0x298dde,_0x460a28){return _0x298dde+_0x460a28;},'lBMCb':function(_0x444f50,_0x5a1e89){return _0x444f50+_0x5a1e89;},'ZicsM':function(_0x35d60d,_0x591550){return _0x35d60d===_0x591550;},'aZEav':_0x3b4f97(0x9a,0xba,0xe5,0xb8),'AgYwx':_0x4face4(0x34,0x57,0x62,0x7d),'HelWg':function(_0x8295af,_0x32fedb,_0x275d99){return _0x8295af(_0x32fedb,_0x275d99);},'kHKQm':_0x4face4(0x41,0x2e,0x27,0x61),'YtNKx':function(_0x1c29e5,_0x5a299b){return _0x1c29e5!==_0x5a299b;},'jADoX':_0x4face4(0x3f,0x5c,0x11,0x22),'ZUeLC':function(_0x10dc6d,_0x3ed059){return _0x10dc6d===_0x3ed059;},'aYrMX':'mSrLl','CMjLZ':_0x3b4f97(0x88,0x78,0x32,0x9e),'fTZOl':function(_0x58c642,_0x5ed1e2){return _0x58c642(_0x5ed1e2);}},{requestType:_0x1f4fc5,contextData:_0x29625f}=_0x373818,_0x3cddca=extension_settings[extensionName]?.[_0x4face4(0x3c,0x3,0x1d,-0x24)+_0x3b4f97(0x86,0xb6,0xbf,0xd3)+_0x3b4f97(0x9f,0xe4,0xc5,0xae)]||{},_0x195e01={};_0x195e01['context_pr'+'ofile']='默认';function _0x3b4f97(_0xf0890c,_0x4597e6,_0x1879a6,_0x43b68e){return _0x3323(_0x4597e6- -0x3b,_0x1879a6);}const _0x5ce35d=_0x3cddca[_0x1f4fc5]||_0x195e01,_0x4bdbff=_0x5ce35d[_0x3b4f97(0xaf,0xa0,0xe0,0xcc)+'ofile']||'默认',_0x552962=extension_settings[extensionName]?.[_0x4face4(0x2f,0xbd,0x69,0x73)+'xt_profile'+'s']||{},_0x57b082=_0x552962[_0x4bdbff]||_0x552962[Object[_0x3b4f97(0xb3,0x5c,0xab,0x45)](_0x552962)[0x2515+0x2644+-0x4b59]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x29625f;function _0x4face4(_0x1fcf30,_0x1a8c21,_0x2eec7a,_0x4f75aa){return _0x3323(_0x2eec7a- -0x9e,_0x4f75aa);}const _0x47faaa=[userDemand,context,body,worldBookContent][_0x3b4f97(0x59,0x82,0x30,0xa2)](Boolean)[_0x4face4(0x20,0x21,0x14,0x35)]('\x0a'),_0x407b7c=[];if(_0x57b082[_0x4face4(0xd6,0x39,0x8c,0x48)]&&Array['isArray'](_0x57b082[_0x3b4f97(0xc6,0xef,0x13d,0x12f)]))for(const _0x5ccd00 of _0x57b082[_0x4face4(0xdf,0xa9,0x8c,0x54)]){if(!_0x5ccd00[_0x4face4(0xa7,0xb5,0x66,0xa2)])continue;if(!_0x5ccd00[_0x3b4f97(0xc6,0xe1,0x92,0xf3)]||_0x5ccd00['content'][_0x4face4(-0x3f,0x5b,0x13,-0x1a)]()==='')continue;if(_0x150494[_0x4face4(0x75,0x39,0x7a,0x55)](_0x5ccd00[_0x3b4f97(0x88,0xb3,0xc8,0xb4)+'e'],_0x3b4f97(0x48,0x46,0x3a,0x97))){if(_0x150494['aZEav']===_0x150494['AgYwx']){const _0x2a4f86=_0x3b4f97(0x5f,0xb2,0x7d,0xc9)+_0x273847+'}}',_0x4e644a=_0x3ee18c[_0x82581]||'';_0x4c194d=_0x150494[_0x4face4(-0x10,0x40,0x24,-0x5)](_0x361145,_0x180fb0,_0x2a4f86,_0x4e644a,_0x253042);}else{if(!_0x150494['HelWg'](checkTriggerWords,_0x5ccd00[_0x3b4f97(0x25,0x53,0x87,0x14)+'ds'],_0x47faaa))continue;}}const _0x5094c5={};_0x5094c5[_0x4face4(0x45,0x29,0x6e,0xbf)]=_0x5ccd00[_0x3b4f97(0xd1,0xd1,0xcf,0xc6)]||_0x4face4(0x4b,0xb,0x11,0x27),_0x5094c5[_0x4face4(0xa4,0x56,0x7e,0x8a)]=_0x5ccd00[_0x3b4f97(0xfb,0xe1,0xe9,0x12b)],_0x407b7c[_0x4face4(0x14,0x7,0x1c,0x27)](_0x5094c5);}else{if(_0x57b082[_0x4face4(-0x1d,-0x21,0x28,-0x2a)]&&Array['isArray'](_0x57b082[_0x3b4f97(0xad,0x8b,0x55,0x97)]))for(const _0x51120a of _0x57b082['history']){if(_0x150494[_0x3b4f97(0xa7,0xdd,0xe4,0xca)](_0x150494[_0x3b4f97(0x8a,0x90,0x4e,0x9c)],_0x3b4f97(0x35,0x8a,0x47,0xd7))){if(_0x51120a[_0x4face4(0x57,0x46,0x11,-0x1c)]&&_0x150494[_0x3b4f97(0x114,0xe7,0x10c,0xe5)](_0x51120a[_0x4face4(0x3d,-0x7,0x11,-0x32)][_0x4face4(-0x29,0x1e,0x13,-0x1e)](),'')){const _0x280966={};_0x280966[_0x4face4(0x86,0xb9,0x6e,0x40)]=_0x150494[_0x3b4f97(0x58,0x83,0x44,0x3f)],_0x280966[_0x3b4f97(0xdd,0xe1,0xd9,0xbd)]=_0x51120a[_0x4face4(0x21,-0x12,0x11,-0x40)],_0x407b7c[_0x4face4(0x26,-0x12,0x1c,0x60)](_0x280966);}if(_0x51120a[_0x4face4(-0xc,0x25,0x15,0x67)]&&_0x150494[_0x3b4f97(0x9f,0xe7,0x10b,0xd8)](_0x51120a['assistant'][_0x3b4f97(0x83,0x76,0x4f,0x9d)](),'')){if(_0x150494[_0x3b4f97(0x38,0x8d,0x64,0x8f)](_0x150494['aYrMX'],_0x150494[_0x3b4f97(0xad,0xc6,0x7a,0x94)])){const _0x5aca81={};_0x5aca81[_0x4face4(0x27,0xb4,0x6e,0x55)]=_0x150494[_0x4face4(0x5,0x45,-0x5,0x31)],_0x5aca81[_0x3b4f97(0xb3,0xe1,0x129,0xee)]=_0x51120a['assistant'],_0x407b7c['push'](_0x5aca81);}else return _0x150494[_0x3b4f97(0x53,0x48,0x4b,0x61)](_0x150494[_0x3b4f97(0x70,0x97,0xb8,0x52)](_0x4a21a7,'\x0a'),_0x1eeba8);}}else{const _0x39c488={};for(const _0x4ef361 in _0x20e457){_0x39c488[_0x4ef361]=_0x19f561(_0x36cf39[_0x4ef361],_0x3a9c77,_0x13306b,_0x159147);}return _0x39c488;}}}const _0x3ab65d=_0x150494[_0x4face4(0x87,0x5a,0x3c,0x81)](mergeAdjacentMessages,_0x407b7c),{messages:_0x3f691b,replacedVariables:_0x58cd85}=replaceAllPlaceholders(_0x3ab65d,_0x29625f);return _0x3f691b;}export function getProcessedPrompt(_0xfc08c3,_0x462c3b){function _0x16b14d(_0x5793dd,_0x46daa6,_0x2ef296,_0x24d53d){return _0x3323(_0x46daa6-0x13d,_0x24d53d);}const _0x4bba70={'PjCuS':function(_0x5997ad,_0x3e041b){return _0x5997ad(_0x3e041b);}},_0x4577c8={};_0x4577c8[_0x16b14d(0x17a,0x1c5,0x1a2,0x1b1)+'e']=_0xfc08c3;function _0xd5cc20(_0x5a189e,_0x5f5edc,_0x463e72,_0x1acdd1){return _0x3323(_0x5a189e- -0x278,_0x463e72);}return _0x4577c8['contextDat'+'a']=_0x462c3b,_0x4bba70[_0xd5cc20(-0x166,-0x12f,-0x1a7,-0x131)](buildPromptWithTrigger,_0x4577c8);}