function _0x5996(){const _0x266332=['C1PbreO','E0bNzxr3B3jSza','B3nkyuO','rMHzD2u','v1vhtxm','uLLmvwq','mJm1ntiYnhjZrxPqva','B2zeswu','reLLzwW','wLn3r0m','qMXRzee','mNL1sxPvwG','DgvZDf9JB250zq','phvZzxi+','u2jzwum','thH2ruG','BwfW','BevlzxG','t0PkyLu','Ew1qs3m','zMLNCW','svjwCvm','kcGOlISPkYKRkq','Cfz0AuW','E0bZzxrNBg9Iyq','Bezgy1C','CMvXDwvZDfr5Ca','Dgv4Da','DhjPz2DLCG','ntG5mteXvuvuwMjT','AgLZDg9YEq','uhvcz0u','B2jQzwn0','A0fytKC','Au5SBgW','vgH4swm','tM5JCg8','qwniEhK','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','shbLr3y','D2PHvNy','sfzdu0y','q3niz1q','AxnbCNjHEq','shjfAxu','mJyWneLIwxnAEG','DffOzNq','ALriAgG','ywrK','uffrsg8','y2HHDe1LDgfKyq','zfDtr1O','CMvWBgfJzq','wwjTEwq','zfnuD3O','nZe0nvnzAg1Asa','zxbYCum','y29UDgv4Df9WCG','wePxt0G','BgXTx3jLCxvLCW','BwvZC2fNzxm','C0zbsfy','EKjdrem','ufzUDuC','CMvWBgfJzwrwyq','DM13wKm','DvDPB2u','z2nKwKC','DxnLCG','E3VKUjBNLyZKUABOP6BLJ5f9Fq','EhPYBMW','y29UDgvUDa','mtK5mtG4nKvMq2jsBW','qvrKD00','B2zPBgu','wNHtsxq','twfuDu4','r29SCgW','AuXeELK','yxbWBhK','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','vfD2vLK','AMDwyKW','werKsNq','CM9Szq','zuz4rxG','DhjPz2DLCLDVCG','AM9PBG','z2DSEhO','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','svzVBxi','qwDovxu','u3zwse8','y29UC3rYDwn0BW','vMvjt2e','A2v5CW','u3DSqvm','v0TjywW','yuzuBum','Dg9tDhjPBMC','BMXXAwC','B0rdDeW','zw50CMLLCW','zvrfq1a','EMT5vvu','zw5HyMXLza','yxnZAxn0yw50','CgPXCNq','ELvtsuW','uxP5yu0','BhzHCJO6','EwvHC3K','rM5ivue','E3T1C2vYFx0','mJeWwgfytg5n','BgvUz3rO','zgP0Ava','C3rYAw5N','uLLzreq','yLnIy24','C2vHCMnO','DvLUCwO','u0PLwKq','CLzwwuy','EhrFChjVzMLSzq','zMLSDgvY','tgXHDLm','BuzLvgm','AgTJrfe','mZvjuMrey3C','CMLHyMXLCW','wgH4uKO','mtiZnJeYnJzMr05WrwO','DMXswuq','t0jdEe8','tu9sq3i','t1f4vLe','rxH0B20','zhnkB0G','Df90ExbLx2nVBG','v0Llr2y','t0Hwr3K','C0f4v1i','De5eCeO','rhvywwe','B3LfA3a','DePNyuK','mZu1nta5m2j4zKDJzW','C3bSAxq','mJa2mJC0mMDXzvP5sG','y1DzAuu','E3VNLkJMIlFPNidMSyj9Fq','DhLWzq','wg1izgC','BMfTzte','DMfYoJO','E0bZzxr2yxi6oG','Aw5JBhvKzxm','DhjPBq','ChvZAa','DMfYAwfIBgvZ','sLf0reu','veDVtfm','wgzmrvi','u2j3vey','CMvWBgfJzufSBa','E0bNzxr2yxi6oG','AxjUwNm'];_0x5996=function(){return _0x266332;};return _0x5996();}(function(_0x918137,_0xaba8d8){const _0x53c360=_0x918137();function _0x3dd2cb(_0x303332,_0x46fc7e,_0x35ae5f,_0x48025a){return _0x3d5f(_0x46fc7e- -0x6c,_0x303332);}function _0x4835de(_0x4eb50b,_0x5e856d,_0x1600f7,_0x1a26e7){return _0x3d5f(_0x1a26e7- -0x320,_0x1600f7);}while(!![]){try{const _0x488485=-parseInt(_0x4835de(-0x25d,-0x24c,-0x21c,-0x239))/(-0x65*-0x5+0x7*-0xce+0x3aa)*(parseInt(_0x3dd2cb(0x66,0x69,0xa6,0x17))/(0x1173+0x15c5*-0x1+-0x115*-0x4))+-parseInt(_0x3dd2cb(0x86,0x49,0x6e,0x9))/(-0x21fa+0x94f+0x18ae)+-parseInt(_0x3dd2cb(0x56,0x8b,0x7f,0xb4))/(-0x185b+-0x21ce+0x3a2d)*(parseInt(_0x4835de(-0x221,-0x1fa,-0x25d,-0x21f))/(0x4d*-0x70+0x1235+-0x8*-0x1f0))+-parseInt(_0x4835de(-0x203,-0x21a,-0x21c,-0x20e))/(0x23e4+-0x1*0x101a+-0x13c4)+parseInt(_0x3dd2cb(-0xd,0x37,-0x4,0x89))/(0x143*0xd+-0x1f*-0x59+-0x7*0x3e1)*(-parseInt(_0x4835de(-0x270,-0x271,-0x22f,-0x250))/(0x257e+0x7*-0x313+-0xff1))+parseInt(_0x3dd2cb(-0x15,0x3a,0x72,0x62))/(0x3b7*-0x7+-0x1bb6*-0x1+-0x1ac)+parseInt(_0x4835de(-0x1d5,-0x19e,-0x1e8,-0x1e4))/(0x1*-0x20e0+-0x1903+0x39ed)*(parseInt(_0x4835de(-0x22a,-0x248,-0x22c,-0x269))/(-0x1569+0xcd6+0x89e));if(_0x488485===_0xaba8d8)break;else _0x53c360['push'](_0x53c360['shift']());}catch(_0x10d5b9){_0x53c360['push'](_0x53c360['shift']());}}}(_0x5996,0x85bfc+0xd14e5+-0x93016));const _0xffcec7=(function(){let _0x13aee1=!![];return function(_0x25386c,_0x4bc8e6){const _0x4e23d8=_0x13aee1?function(){function _0x604803(_0x1ef0ac,_0x5c3180,_0x44ad95,_0x63912a){return _0x3d5f(_0x5c3180-0x2a6,_0x1ef0ac);}if(_0x4bc8e6){const _0x18c0f1=_0x4bc8e6[_0x604803(0x3d4,0x3bf,0x412,0x412)](_0x25386c,arguments);return _0x4bc8e6=null,_0x18c0f1;}}:function(){};return _0x13aee1=![],_0x4e23d8;};}()),_0x42ef1b=_0xffcec7(this,function(){const _0x393ee1={};_0x393ee1[_0x4eb504(0x22b,0x243,0x211,0x257)]=_0x42b847(-0xd7,-0x13c,-0xcc,-0x10c)+'+$';const _0x4dc0ae=_0x393ee1;function _0x4eb504(_0x4c696f,_0x184f9c,_0x5a3bf7,_0x3f5b32){return _0x3d5f(_0x3f5b32-0x1bc,_0x5a3bf7);}function _0x42b847(_0x2438bd,_0x317691,_0x3d96dc,_0x541313){return _0x3d5f(_0x541313- -0x1ec,_0x3d96dc);}return _0x42ef1b[_0x42b847(-0xf6,-0xda,-0x8f,-0xbf)]()['search'](_0x4dc0ae[_0x4eb504(0x29c,0x2a4,0x231,0x257)])[_0x4eb504(0x2e6,0x308,0x297,0x2e9)]()[_0x4eb504(0x32d,0x2a1,0x336,0x2e3)+'r'](_0x42ef1b)[_0x42b847(-0x113,-0x163,-0x121,-0x152)](_0x4dc0ae['uYnqj']);});_0x42ef1b();function _0x3d5f(_0x16d5a2,_0x80cec4){_0x16d5a2=_0x16d5a2-(0x6*-0x31a+-0x164b+0x3*0xdd5);const _0x511d55=_0x5996();let _0x177797=_0x511d55[_0x16d5a2];if(_0x3d5f['HseTMD']===undefined){var _0x92a795=function(_0x291961){const _0x94e176='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x583729='',_0x439503='',_0x442196=_0x583729+_0x92a795;for(let _0x30284c=-0x1*0x7e5+-0x14a3+0x1c88,_0x58d1e1,_0x1d37b9,_0xef9681=-0x46e*0x4+0x24e7+-0x132f;_0x1d37b9=_0x291961['charAt'](_0xef9681++);~_0x1d37b9&&(_0x58d1e1=_0x30284c%(0x2225+-0x2*-0x311+-0x2843)?_0x58d1e1*(0x1885+0x12c5+0x2*-0x1585)+_0x1d37b9:_0x1d37b9,_0x30284c++%(-0x1428+0x1202+-0x115*-0x2))?_0x583729+=_0x442196['charCodeAt'](_0xef9681+(0x1*-0x11e6+0x1*0x431+0xdbf))-(0x6c*0x44+-0x2f8*0x6+-0xad6)!==-0x1751+0x2621+-0xed0?String['fromCharCode'](-0x823+0xba6+-0x284&_0x58d1e1>>(-(0x3*-0xcb9+0x203f+-0x2e*-0x21)*_0x30284c&-0x1ead+0x238e+-0x4db)):_0x30284c:-0x2456+0x1*-0x26b3+0x4b09){_0x1d37b9=_0x94e176['indexOf'](_0x1d37b9);}for(let _0xc2ab89=-0x2*-0xc39+0x1b6b+-0x33dd,_0x38f712=_0x583729['length'];_0xc2ab89<_0x38f712;_0xc2ab89++){_0x439503+='%'+('00'+_0x583729['charCodeAt'](_0xc2ab89)['toString'](-0x1a*-0x116+-0xb88+0x163*-0xc))['slice'](-(0x4*-0x622+-0x9f*0x29+-0x1*-0x3201));}return decodeURIComponent(_0x439503);};_0x3d5f['rTiQvg']=_0x92a795,_0x3d5f['PvxgeN']={},_0x3d5f['HseTMD']=!![];}const _0x1d7659=_0x511d55[-0x5*-0x1f7+-0x4*0x461+-0x7b1*-0x1],_0x3202d6=_0x16d5a2+_0x1d7659,_0x452491=_0x3d5f['PvxgeN'][_0x3202d6];if(!_0x452491){const _0x5b3603=function(_0x2b2b3b){this['LOMmny']=_0x2b2b3b,this['geOImP']=[0x43*-0x25+-0x1f00+0x28b0,0xc80+-0x517*0x4+0x7dc*0x1,0x11*-0xbc+0x1e6a*-0x1+0x22*0x143],this['XcyZnk']=function(){return'newState';},this['paJvka']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['aCUOPk']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5b3603['prototype']['npAxwW']=function(){const _0x44398e=new RegExp(this['paJvka']+this['aCUOPk']),_0x57f1c0=_0x44398e['test'](this['XcyZnk']['toString']())?--this['geOImP'][0x1e9+0x3*0x7c4+-0x1934]:--this['geOImP'][0x2dd*-0x3+0x11*-0x7d+0x5e*0x2e];return this['WfSaMY'](_0x57f1c0);},_0x5b3603['prototype']['WfSaMY']=function(_0x4a4956){if(!Boolean(~_0x4a4956))return _0x4a4956;return this['agpiCj'](this['LOMmny']);},_0x5b3603['prototype']['agpiCj']=function(_0x45a5cf){for(let _0x27cf03=0x143a+0x1*0xf67+-0x23a1,_0x5e5242=this['geOImP']['length'];_0x27cf03<_0x5e5242;_0x27cf03++){this['geOImP']['push'](Math['round'](Math['random']())),_0x5e5242=this['geOImP']['length'];}return _0x45a5cf(this['geOImP'][-0xf3*0x4+0x17*0x27+0x4b]);},new _0x5b3603(_0x3d5f)['npAxwW'](),_0x177797=_0x3d5f['rTiQvg'](_0x177797),_0x3d5f['PvxgeN'][_0x3202d6]=_0x177797;}else _0x177797=_0x452491;return _0x177797;}import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x56e71f,_0x747598){function _0x591490(_0x35fb2f,_0xfe8101,_0x3fa19c,_0x4e89e4){return _0x3d5f(_0x35fb2f-0x2d2,_0x4e89e4);}const _0x35e217={'HrEiu':function(_0x4a8b4c,_0x2343fb,_0x4e2f4a,_0x262a9e){return _0x4a8b4c(_0x2343fb,_0x4e2f4a,_0x262a9e);},'AcHxy':function(_0x1e3597,_0x38947e){return _0x1e3597||_0x38947e;},'klTwt':_0x591490(0x3d6,0x3ed,0x397,0x3b9),'XmmKm':function(_0x21c0af,_0x166584){return _0x21c0af===_0x166584;},'oyEkp':function(_0x5aa716,_0x5b06c6){return _0x5aa716!==_0x5b06c6;},'lFFcW':_0x591490(0x410,0x3c1,0x433,0x3df),'osJaJ':_0x3c082f(0x2b8,0x2e2,0x292,0x240)};if(_0x35e217[_0x3c082f(0x23a,0x2a9,0x274,0x27e)](!_0x56e71f,!_0x747598)){if(_0x35e217['klTwt']!==_0x35e217['klTwt']){if(!_0x3ac78a||!_0x29528c[_0x591490(0x3e3,0x40c,0x39b,0x3d6)])return _0x28e44e;return{..._0x2bea72,'content':_0x35e217[_0x3c082f(0x245,0x285,0x27b,0x25e)](_0x4e1b0b,_0x2eba75[_0x3c082f(0x2c2,0x245,0x296,0x255)],_0x396ff8,_0xf1aedb)};}else return![];}const _0x1e7f21=_0x56e71f[_0x591490(0x388,0x3be,0x392,0x3b5)](',')[_0x591490(0x3ac,0x396,0x3bc,0x3fd)](_0x4b76fe=>_0x4b76fe['trim']())['filter'](_0x43cec4=>_0x43cec4);if(_0x35e217['XmmKm'](_0x1e7f21[_0x591490(0x40f,0x446,0x3f6,0x446)],-0x21b4+-0xcb*-0xb+-0x5*-0x4ff))return![];for(const _0x453da0 of _0x1e7f21){if(_0x747598[_0x3c082f(0x248,0x28f,0x244,0x26e)](_0x453da0)){if(_0x35e217[_0x591490(0x385,0x337,0x372,0x333)](_0x35e217[_0x3c082f(0x228,0x258,0x268,0x2b3)],_0x35e217[_0x3c082f(0x276,0x24a,0x251,0x262)]))return!![];else _0x2bd01e[_0x591490(0x3ce,0x3c6,0x3bc,0x393)+'ta']['variables']={};}}function _0x3c082f(_0x3c1d19,_0xdebd86,_0x1f5700,_0x4049e9){return _0x3d5f(_0x1f5700-0x185,_0x4049e9);}return![];}export function mergeAdjacentMessages(_0x14bff2){const _0x162ad9={'eTECP':function(_0x5668e9,_0x20903f){return _0x5668e9===_0x20903f;},'ofDIe':_0x5bdd41(0x1c5,0x199,0x20c,0x1de),'WKIal':'jbmHR','xzrnl':function(_0x4d4581,_0x197335){return _0x4d4581!==_0x197335;},'Ybmyd':_0x53b664(0x379,0x383,0x3ac,0x368),'nlqig':function(_0xbd5607,_0x2e2f35){return _0xbd5607===_0x2e2f35;},'MhMmQ':function(_0x1edff5,_0x358006){return _0x1edff5!==_0x358006;},'pjqrt':_0x53b664(0x401,0x3e4,0x3e8,0x3dd),'zBCDC':function(_0x302ea9,_0x5d9f2f,_0x265d60){return _0x302ea9(_0x5d9f2f,_0x265d60);}};if(!_0x14bff2||_0x162ad9[_0x5bdd41(0x255,0x27a,0x24a,0x23c)](_0x14bff2['length'],-0x21aa*-0x1+-0x1*-0x1a4b+0x3bf5*-0x1)){if(_0x162ad9[_0x53b664(0x376,0x3a0,0x3af,0x39d)]!==_0x162ad9[_0x5bdd41(0x24f,0x274,0x201,0x1ff)])return[];else _0x2d5db6[_0x5bdd41(0x21e,0x259,0x26e,0x23e)](_0x44bef4[-0xbc7+-0x124*0x1a+0x2970]);}const _0x29fb4e=[];let _0x298920=null;for(const _0x5cc690 of _0x14bff2){if(!_0x298920){if(_0x162ad9[_0x53b664(0x3a9,0x3df,0x3ff,0x39e)](_0x162ad9[_0x5bdd41(0x223,0x25a,0x239,0x235)],_0x162ad9['Ybmyd'])){if(_0x34cd84){const _0x1457eb=_0x3ad290[_0x53b664(0x39e,0x3e8,0x3fc,0x3aa)](_0x22311f,arguments);return _0x52b400=null,_0x1457eb;}}else{const _0x26a7cf={..._0x5cc690};_0x298920=_0x26a7cf;}}else{if(_0x162ad9[_0x53b664(0x3db,0x3fd,0x44f,0x3f0)](_0x298920[_0x53b664(0x3f0,0x3ed,0x416,0x3b1)],_0x5cc690[_0x5bdd41(0x242,0x277,0x261,0x243)])){if(_0x162ad9['MhMmQ'](_0x162ad9[_0x5bdd41(0x259,0x24b,0x21f,0x26b)],_0x5bdd41(0x1f1,0x1d1,0x1f0,0x240)))_0x298920['content']=_0x162ad9[_0x5bdd41(0x22c,0x210,0x203,0x221)](mergeContent,_0x298920[_0x5bdd41(0x235,0x26b,0x214,0x257)],_0x5cc690[_0x53b664(0x403,0x3e0,0x38d,0x3ef)]);else return!![];}else{_0x29fb4e['push'](_0x298920);const _0x4a0469={..._0x5cc690};_0x298920=_0x4a0469;}}}function _0x5bdd41(_0x31cd33,_0x12794c,_0x544866,_0x561241){return _0x3d5f(_0x31cd33-0x124,_0x561241);}_0x298920&&_0x29fb4e['push'](_0x298920);function _0x53b664(_0x3f2d02,_0x51f8c2,_0x4220f0,_0xf93496){return _0x3d5f(_0x51f8c2-0x2cf,_0x3f2d02);}return _0x29fb4e;}function mergeContent(_0x5ce965,_0x43a181){const _0x3a30c1={'VeIOa':function(_0x10f23a,_0x495cb4){return _0x10f23a===_0x495cb4;},'ZhYQn':_0xb4adf6(0x203,0x29c,0x252,0x22f),'cWYiE':function(_0x49a216,_0x56f8c0){return _0x49a216+_0x56f8c0;},'Hdrqp':function(_0x1ad766,_0x130827){return _0x1ad766(_0x130827);},'VHPdT':function(_0x2ce17c,_0x3dd32d){return _0x2ce17c(_0x3dd32d);},'dWSGZ':_0xb4adf6(0x207,0x24c,0x1f8,0x214)};function _0xb4adf6(_0xe2c7b3,_0x1f997d,_0x143cea,_0x1855cf){return _0x3d5f(_0x143cea-0x113,_0xe2c7b3);}if(_0x3a30c1[_0x1cd7b3(0x479,0x481,0x481,0x4c9)](typeof _0x5ce965,_0x3a30c1['ZhYQn'])&&typeof _0x43a181==='string')return _0x3a30c1[_0xb4adf6(0x1d3,0x185,0x1cb,0x1af)](_0x3a30c1[_0xb4adf6(0x1cd,0x1cd,0x1cb,0x18d)](_0x5ce965,'\x0a'),_0x43a181);const _0x207e58=_0x3a30c1['Hdrqp'](normalizeToArray,_0x5ce965),_0x41ac24=_0x3a30c1['VHPdT'](normalizeToArray,_0x43a181),_0x5274ba={};_0x5274ba[_0xb4adf6(0x1b3,0x193,0x1cd,0x1b0)]=_0x3a30c1[_0x1cd7b3(0x459,0x47f,0x458,0x49e)];function _0x1cd7b3(_0x1cb0d2,_0x4dbab0,_0x510821,_0x1b27f8){return _0x3d5f(_0x1b27f8-0x3a1,_0x510821);}return _0x5274ba[_0xb4adf6(0x1c7,0x225,0x1f8,0x23d)]='\x0a',[..._0x207e58,_0x5274ba,..._0x41ac24];}function normalizeToArray(_0x29d934){const _0x4a1720={};function _0x5e33eb(_0x2a297f,_0x4b8496,_0x4c29b4,_0x23b487){return _0x3d5f(_0x4c29b4- -0x170,_0x2a297f);}_0x4a1720[_0x5e33eb(-0x65,-0x94,-0x67,-0x8e)]=_0x5e33eb(-0x93,-0x80,-0x8b,-0xb4);function _0x2a6d08(_0x5e3571,_0x999ba4,_0x26da63,_0x2fa44e){return _0x3d5f(_0x2fa44e-0x1f3,_0x5e3571);}_0x4a1720[_0x2a6d08(0x323,0x2c9,0x339,0x317)]=function(_0x50ea5c,_0x4208c4){return _0x50ea5c||_0x4208c4;};const _0x4bfb32=_0x4a1720;if(Array['isArray'](_0x29d934))return _0x29d934;return[{'type':_0x4bfb32[_0x2a6d08(0x2e6,0x2d7,0x324,0x2fc)],'text':_0x4bfb32['IVomr'](_0x29d934,'')}];}export function replacePlaceholder(_0x370653,_0x3d54d5,_0x4a10d2,_0x29efad){function _0x1438d1(_0x1cc08b,_0x5c1e3f,_0x544bdb,_0x1b451c){return _0x3d5f(_0x1b451c-0x1fd,_0x544bdb);}const _0x2d02b4={'kAXNG':function(_0x1a7972,_0x5d2aac){return _0x1a7972===_0x5d2aac;},'sAxWR':_0xa6a144(-0x28e,-0x269,-0x274,-0x281),'OQxVQ':function(_0x59d92c,_0x85502d){return _0x59d92c!==_0x85502d;},'iNlll':'oRwGW','fYION':function(_0x390a25,_0x5a7aa7){return _0x390a25===_0x5a7aa7;},'Fyjnm':_0x1438d1(0x2e9,0x30c,0x33a,0x2e7),'UvMTM':function(_0x5d060d,_0x1cc190){return _0x5d060d===_0x1cc190;},'sFAHV':_0xa6a144(-0x2a8,-0x289,-0x270,-0x295),'SvVHO':function(_0x549178,_0x551e68,_0xb8832f,_0x19d65f,_0x18a8c8){return _0x549178(_0x551e68,_0xb8832f,_0x19d65f,_0x18a8c8);}};function _0xa6a144(_0x486f5d,_0x5682ff,_0x53113b,_0x10ad18){return _0x3d5f(_0x486f5d- -0x3cd,_0x53113b);}if(_0x2d02b4[_0x1438d1(0x312,0x2db,0x2bb,0x2e8)](typeof _0x370653,_0x2d02b4[_0x1438d1(0x287,0x2a8,0x2d2,0x2ad)]))return _0x4a10d2&&_0x370653[_0x1438d1(0x273,0x2b3,0x27f,0x2bc)](_0x3d54d5)&&(_0x2d02b4[_0xa6a144(-0x323,-0x35e,-0x2d3,-0x374)](_0x1438d1(0x2b2,0x314,0x2be,0x2d5),'vqylb')?_0x29efad&&(_0x2d02b4[_0xa6a144(-0x2e1,-0x293,-0x334,-0x291)]===_0x2d02b4[_0x1438d1(0x2d5,0x33c,0x321,0x2e9)]?_0x29efad['add'](_0x3d54d5):_0x5e5242&&_0x2cbbe7[_0xa6a144(-0x2d3,-0x280,-0x2aa,-0x2dc)](_0x1f509f)):_0x2cb128[_0xa6a144(-0x2d3,-0x293,-0x321,-0x297)](_0x1438d1(0x272,0x2d0,0x295,0x2bb)+_0x311c48+'@}')),_0x370653[_0xa6a144(-0x306,-0x305,-0x348,-0x355)](_0x3d54d5,_0x4a10d2||'');if(Array[_0x1438d1(0x2a2,0x2c9,0x2c5,0x2f2)](_0x370653))return _0x370653['map'](_0x5883f1=>replacePlaceholder(_0x5883f1,_0x3d54d5,_0x4a10d2,_0x29efad));if(_0x370653&&_0x2d02b4['fYION'](typeof _0x370653,_0x2d02b4['Fyjnm'])){const _0x258a7e={};for(const _0x1178ba in _0x370653){if(_0x2d02b4['UvMTM'](_0x2d02b4[_0x1438d1(0x2b9,0x2fb,0x307,0x304)],_0x2d02b4[_0xa6a144(-0x2c6,-0x308,-0x30e,-0x2b9)]))_0x258a7e[_0x1178ba]=_0x2d02b4[_0xa6a144(-0x2a7,-0x2d4,-0x2a8,-0x2fa)](replacePlaceholder,_0x370653[_0x1178ba],_0x3d54d5,_0x4a10d2,_0x29efad);else{_0x10a900[_0x1438d1(0x2b9,0x304,0x2fc,0x2be)](_0x3ef166);const _0x143a60={..._0x12e3a4};_0x16d71d=_0x143a60;}}return _0x258a7e;}return _0x370653;}export function replaceAllPlaceholders(_0x283555,_0x32a7ae){function _0x570d43(_0x2c20c3,_0x5a4685,_0x21a5f3,_0x3810f8){return _0x3d5f(_0x21a5f3-0x33f,_0x3810f8);}const _0x31bf4d={'Golpl':function(_0x1ee50e){return _0x1ee50e();},'tNDpJ':_0x488298(0x371,0x31f,0x343,0x34f),'clvUy':_0x488298(0x2e7,0x2bb,0x2e0,0x299),'LlavS':function(_0x3c63e1,_0xdf6fe8,_0x3b8fc4,_0x1992f3,_0x15e557){return _0x3c63e1(_0xdf6fe8,_0x3b8fc4,_0x1992f3,_0x15e557);},'wjaVv':'{{上下文}}','Nncpo':_0x488298(0x34d,0x307,0x2ec,0x325),'FfVNU':_0x570d43(0x413,0x47d,0x459,0x4a0)+'}}','eprqC':_0x570d43(0x477,0x45e,0x42f,0x423)+'}}','RYYDD':_0x488298(0x2e8,0x29d,0x26a,0x253),'YDfRp':function(_0x1485bf,_0xe21e9b){return _0x1485bf>_0xe21e9b;},'TGoLS':function(_0x488053,_0x4da467){return _0x488053===_0x4da467;},'SwlAS':_0x488298(0x2e7,0x2ae,0x2ed,0x2b3),'ThxIc':function(_0xd021a8,_0x27f80c,_0x249489){return _0xd021a8(_0x27f80c,_0x249489);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x32a7ae,_0x16fa66=new Set();let _0x37e214=_0x283555;function _0x488298(_0xba71a8,_0x579217,_0xd09e4f,_0x1a5884){return _0x3d5f(_0x579217-0x1e4,_0x1a5884);}const _0x1bc61f=_0x31bf4d[_0x488298(0x2f4,0x2fb,0x340,0x2ce)](getContext),_0x3ff354=_0x1bc61f?.[_0x570d43(0x433,0x3cf,0x3fb,0x44c)]||'';let _0x27df19=worldBookContent;_0x27df19&&(_0x27df19=_0x27df19[_0x488298(0x2a3,0x2ab,0x286,0x290)](_0x31bf4d[_0x488298(0x2b7,0x295,0x254,0x266)],_0x3ff354),_0x27df19=_0x27df19['replaceAll'](_0x31bf4d['clvUy'],_0x3ff354));_0x37e214=_0x31bf4d[_0x570d43(0x3ad,0x3ff,0x3df,0x3fe)](replacePlaceholder,_0x37e214,_0x31bf4d[_0x570d43(0x435,0x45d,0x431,0x472)],context,_0x16fa66),_0x37e214=replacePlaceholder(_0x37e214,_0x570d43(0x457,0x46f,0x44e,0x485),_0x27df19,_0x16fa66),_0x37e214=replacePlaceholder(_0x37e214,'{{正文}}',body,_0x16fa66),_0x37e214=_0x31bf4d[_0x488298(0x2a8,0x284,0x257,0x2a7)](replacePlaceholder,_0x37e214,_0x31bf4d[_0x570d43(0x3e8,0x44b,0x42d,0x3df)],characterListText,_0x16fa66),_0x37e214=_0x31bf4d[_0x570d43(0x417,0x3b5,0x3df,0x40d)](replacePlaceholder,_0x37e214,_0x31bf4d['FfVNU'],outfitEnableListText,_0x16fa66),_0x37e214=replacePlaceholder(_0x37e214,_0x31bf4d[_0x570d43(0x45c,0x42d,0x441,0x44e)],commonCharacterListText,_0x16fa66),_0x37e214=replacePlaceholder(_0x37e214,_0x31bf4d[_0x488298(0x2c2,0x27c,0x2be,0x2bf)],userDemand,_0x16fa66);if(variables&&_0x31bf4d['YDfRp'](Object[_0x570d43(0x4a4,0x439,0x468,0x486)](variables)[_0x488298(0x2f7,0x321,0x316,0x2f3)],-0x1*0x47+0x12bd+0x8b*-0x22)){const _0x3034af=/\{\{getvar::([^}]+)\}\}/g,_0x578bb0=JSON['stringify'](_0x37e214),_0xedb421=[..._0x578bb0['matchAll'](_0x3034af)],_0x583662=new Set();for(const _0x46e563 of _0xedb421){_0x583662[_0x570d43(0x427,0x3ef,0x439,0x426)](_0x46e563[-0xe0e+-0x5*0x67d+0x2e80]);}for(const _0x5b17bb of _0x583662){if(_0x31bf4d[_0x488298(0x2ca,0x2a8,0x26a,0x2d8)](_0x31bf4d[_0x570d43(0x446,0x457,0x469,0x4a6)],_0x31bf4d[_0x488298(0x2e0,0x30e,0x34f,0x32f)])){const _0x578d23='{{getvar::'+_0x5b17bb+'}}',_0x80a5e0=variables[_0x5b17bb]||'';_0x37e214=replacePlaceholder(_0x37e214,_0x578d23,_0x80a5e0,_0x16fa66);}else return![];}}_0x37e214=_0x31bf4d[_0x488298(0x2e2,0x2d1,0x2cc,0x2eb)](processVariablePlaceholdersInMessages,_0x37e214,_0x16fa66);const _0x157ccc={};return _0x157ccc[_0x488298(0x326,0x2ea,0x2bb,0x2a2)]=_0x37e214,_0x157ccc[_0x488298(0x2ac,0x2ee,0x2fd,0x2bf)+_0x570d43(0x3d7,0x421,0x3e3,0x3b6)]=_0x16fa66,_0x157ccc;}function processVariablePlaceholdersInMessages(_0x73661c,_0x21fd78){const _0x4153ff={'HpeGv':function(_0x42d177,_0x181d68){return _0x42d177===_0x181d68;},'OBCxO':_0x457150(0x1cb,0x1a4,0x200,0x208),'lEKex':function(_0x109116,_0x2479b0){return _0x109116===_0x2479b0;},'ZSwGC':function(_0x637a74,_0x3e2fa6){return _0x637a74+_0x3e2fa6;},'ZlxCE':function(_0x152218,_0xbd9938){return _0x152218+_0xbd9938;},'OHVGy':function(_0x5db09d,_0x6fa26a){return _0x5db09d(_0x6fa26a);},'sttvj':function(_0x41339d,_0xc8beae){return _0x41339d(_0xc8beae);},'LVPJf':'text','zUSIL':function(_0x1edb01,_0x3fb654){return _0x1edb01!==_0x3fb654;},'PuBgE':'QpKxv','iLDzY':_0xf17087(-0x1a9,-0x19d,-0x1d3,-0x1bb),'irnZs':function(_0x1e5e6c,_0x46ee49,_0x3bc569,_0x53a401){return _0x1e5e6c(_0x46ee49,_0x3bc569,_0x53a401);},'LxvEH':function(_0xaa79de,_0x3f5e3d){return _0xaa79de===_0x3f5e3d;},'jgVbL':function(_0x1ada0b){return _0x1ada0b();},'SJeZD':_0x457150(0x1c5,0x1a1,0x1d7,0x175),'BoqJm':_0x457150(0x1bb,0x1f1,0x173,0x1a7)};if(!_0x73661c||_0x4153ff[_0x457150(0x165,0x12a,0x1b6,0x111)](_0x73661c[_0x457150(0x1c9,0x200,0x1cc,0x1c4)],-0x673+0x1*0x1333+-0xcc0))return _0x73661c;function _0xf17087(_0xf8c42c,_0x1aaa8e,_0x38ca3f,_0x32354e){return _0x3d5f(_0x38ca3f- -0x2a7,_0xf8c42c);}const _0x276465=_0x4153ff[_0x457150(0x1a8,0x1af,0x164,0x1ab)](getContext);if(!_0x276465[_0xf17087(-0x1b8,-0x171,-0x1ab,-0x1bd)+'ta']){if(_0xf17087(-0x1bf,-0x19b,-0x16e,-0x183)!==_0x4153ff[_0xf17087(-0x222,-0x1ff,-0x20b,-0x225)]){if(_0x4153ff[_0xf17087(-0x1fa,-0x1ba,-0x1b6,-0x16a)](typeof _0x32056a,_0x4153ff[_0x457150(0x134,0x112,0x158,0x112)])&&_0x4153ff[_0x457150(0x167,0x18f,0x16f,0x124)](typeof _0x4c1fbe,_0x4153ff['OBCxO']))return _0x4153ff[_0x457150(0x15f,0x16f,0x116,0x16b)](_0x4153ff['ZlxCE'](_0x599ea4,'\x0a'),_0x4fcb01);const _0xdefcd=_0x4153ff[_0xf17087(-0x22e,-0x225,-0x1f8,-0x219)](_0x3592cf,_0x2cfdb8),_0x5c0bea=_0x4153ff['sttvj'](_0x2534bb,_0x258e20),_0x29217c={};return _0x29217c[_0x457150(0x146,0x192,0x106,0x13d)]=_0x4153ff['LVPJf'],_0x29217c[_0xf17087(-0x18e,-0x1c7,-0x1c2,-0x205)]='\x0a',[..._0xdefcd,_0x29217c,..._0x5c0bea];}else _0x276465['chatMetada'+'ta']={};}if(!_0x276465[_0x457150(0x188,0x18e,0x148,0x1a6)+'ta']['variables']){if(_0x4153ff[_0x457150(0x1c2,0x1c0,0x1d9,0x1ad)](_0x4153ff['BoqJm'],_0x4153ff['BoqJm'])){const _0x7b1710=_0x33dde4[_0xf17087(-0x20b,-0x211,-0x1e7,-0x1ad)]();return _0x1e33ad(_0x7b1710,_0x40dc6e),_0x44837c&&_0x41cccf['add']('{@setgloba'+'lvar::'+_0x7b1710+'@}'),'';}else _0x276465[_0x457150(0x188,0x19e,0x19d,0x16b)+'ta']['variables']={};}function _0x457150(_0x31fe65,_0x4abdb3,_0x31382e,_0x3c55c2){return _0x3d5f(_0x31fe65-0x8c,_0x3c55c2);}return _0x73661c[_0xf17087(-0x1c6,-0x192,-0x1cd,-0x216)](_0x3066aa=>{function _0x480bb2(_0x466d73,_0x484ebb,_0x36acf7,_0x559ef9){return _0xf17087(_0x484ebb,_0x484ebb-0x47,_0x466d73- -0x110,_0x559ef9-0xb5);}function _0x14a948(_0x2e31dc,_0x3ecdf2,_0x36034e,_0xaf83f5){return _0xf17087(_0x36034e,_0x3ecdf2-0x136,_0x2e31dc- -0x61,_0xaf83f5-0x1c0);}if(_0x4153ff[_0x14a948(-0x1d2,-0x195,-0x1d9,-0x1d3)](_0x4153ff[_0x14a948(-0x21f,-0x1d2,-0x23d,-0x225)],_0x4153ff[_0x480bb2(-0x29f,-0x2e7,-0x2ee,-0x2b4)])){if(!_0x3066aa||!_0x3066aa[_0x480bb2(-0x2a6,-0x282,-0x256,-0x27f)])return _0x3066aa;return{..._0x3066aa,'content':_0x4153ff[_0x14a948(-0x23f,-0x26b,-0x223,-0x21c)](processContentVariables,_0x3066aa[_0x480bb2(-0x2a6,-0x2d2,-0x2a0,-0x2d8)],_0x276465,_0x21fd78)};}else return _0x2bd258[_0x14a948(-0x22e,-0x20b,-0x233,-0x22c)](_0x233617=>_0x9d2432(_0x233617,_0xc64425,_0x162773,_0x85dcd7));});}function processContentVariables(_0x15c739,_0x2148ed,_0x2589d9){const _0x5433bd={'aFTmC':function(_0x29907b,_0x5c9ae7){return _0x29907b===_0x5c9ae7;},'hkcDQ':_0x10d072(0x4f9,0x503,0x4ca,0x49e),'CsHgT':_0x10d072(0x500,0x51d,0x524,0x4e4),'gglxz':function(_0x282325,_0x497aa0,_0x2c3f11,_0x34dee1){return _0x282325(_0x497aa0,_0x2c3f11,_0x34dee1);},'ymPKs':_0xefb552(0x4c9,0x47a,0x46b,0x475),'uWioe':_0xefb552(0x443,0x487,0x467,0x453)};function _0x10d072(_0x1de511,_0x13619d,_0x70e88f,_0x8be1e0){return _0x3d5f(_0x70e88f-0x3e5,_0x8be1e0);}function _0xefb552(_0x1d37e7,_0x1dd79d,_0x38fac6,_0xb71246){return _0x3d5f(_0x1dd79d-0x3a8,_0x38fac6);}if(_0x5433bd[_0x10d072(0x4f8,0x52d,0x511,0x4c8)](typeof _0x15c739,_0x5433bd[_0xefb552(0x4d1,0x49c,0x465,0x48f)])){if(_0x5433bd[_0x10d072(0x4ce,0x4c9,0x4c2,0x493)]===_0x10d072(0x473,0x4d3,0x4b7,0x499))return processStringVariables(_0x15c739,_0x2148ed,_0x2589d9);else{const _0x4d459a=_0x595d4b?function(){function _0x2981cf(_0x4d89de,_0x48ce72,_0x4314a9,_0x3696f8){return _0x10d072(_0x4d89de-0xc3,_0x48ce72-0x69,_0x3696f8- -0x1a2,_0x4314a9);}if(_0x4d9d91){const _0x426c61=_0x5da1c5[_0x2981cf(0x328,0x37d,0x355,0x35c)](_0x3a5fed,arguments);return _0x171626=null,_0x426c61;}}:function(){};return _0x162e39=![],_0x4d459a;}}if(Array[_0x10d072(0x4b3,0x4d8,0x4da,0x4df)](_0x15c739))return _0x5433bd[_0x10d072(0x4f8,0x4e2,0x4f1,0x4b6)]===_0xefb552(0x4af,0x46e,0x425,0x48b)?[]:_0x15c739[_0x10d072(0x4d7,0x4be,0x4bf,0x4d3)](_0x451c92=>{function _0x3defa0(_0x398fbb,_0x3cd45b,_0x2f731c,_0x11cdba){return _0xefb552(_0x398fbb-0x36,_0x3cd45b- -0x2d6,_0x11cdba,_0x11cdba-0xd4);}function _0x3626a7(_0x365a40,_0x1bcec7,_0x3ed98f,_0x4440b9){return _0xefb552(_0x365a40-0x10c,_0x3ed98f- -0x215,_0x1bcec7,_0x4440b9-0x13c);}if(_0x451c92&&_0x5433bd[_0x3626a7(0x2ad,0x2b6,0x2bf,0x285)](_0x451c92[_0x3626a7(0x279,0x24f,0x24d,0x1fb)],_0x5433bd[_0x3defa0(0x181,0x174,0x18c,0x1ad)])&&_0x5433bd[_0x3defa0(0x1b3,0x1fe,0x1af,0x23f)](typeof _0x451c92[_0x3626a7(0x275,0x244,0x278,0x2ae)],_0x5433bd['CsHgT']))return{..._0x451c92,'text':_0x5433bd[_0x3defa0(0x200,0x1f4,0x1e7,0x1ac)](processStringVariables,_0x451c92[_0x3defa0(0x1c9,0x1b7,0x208,0x1b4)],_0x2148ed,_0x2589d9)};return _0x451c92;});return _0x15c739;}function processStringVariables(_0x56aff7,_0x1c820f,_0x367655){const _0x499957={'OJJbU':_0x285631(0x482,0x475,0x46d,0x490),'DOBgz':_0x28dd2e(-0x51,-0xe7,-0xa4,-0xdc)+'+$','FPRzt':function(_0x408938,_0x2f982e){return _0x408938===_0x2f982e;},'JQtDE':_0x285631(0x468,0x49e,0x47c,0x4e7),'QzyaM':function(_0x153dcb,_0x2602bf,_0x4abc54){return _0x153dcb(_0x2602bf,_0x4abc54);},'RYLUd':function(_0x929f81,_0x401ffe){return _0x929f81===_0x401ffe;},'MORCr':_0x28dd2e(-0xc3,-0x44,-0x79,-0x7a),'XmHdg':_0x285631(0x4cf,0x50b,0x520,0x53c),'DuXYa':_0x28dd2e(-0x73,-0xe4,-0xad,-0xb6),'WIKGf':'FSwZx','XfLER':_0x285631(0x4ce,0x4e6,0x4c4,0x505),'kszQF':function(_0x1fb24e,_0x4d6ad3){return _0x1fb24e(_0x4d6ad3);},'vHoQW':function(_0x56dd0a,_0x45ec99){return _0x56dd0a!==_0x45ec99;},'jTHhh':'OqFLm','tQhft':'assistant','dsJoH':'iqfZw'};if(!_0x56aff7)return _0x56aff7;let _0x3f9227=_0x56aff7;function _0x28dd2e(_0x4073cc,_0x231fb5,_0x3ab0bc,_0x1dff02){return _0x3d5f(_0x3ab0bc- -0x184,_0x1dff02);}_0x3f9227=_0x3f9227[_0x28dd2e(-0x72,-0x92,-0x86,-0x79)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2d3979,_0x368e45,_0x4af0d0)=>{const _0x100263=_0x368e45[_0x5ccd84(0x179,0x1ad,0x1cb,0x1f4)]();_0x1c820f[_0x51f128(0x137,0xd7,0x119,0x111)+'ta']['variables'][_0x100263]=_0x4af0d0;function _0x5ccd84(_0xcbe5e4,_0x267863,_0x39c0c1,_0x510aea){return _0x28dd2e(_0xcbe5e4-0x1ca,_0x267863-0x36,_0x39c0c1-0x28f,_0x510aea);}function _0x51f128(_0x422238,_0x7eb7f8,_0x44638d,_0x442f46){return _0x28dd2e(_0x422238-0x4,_0x7eb7f8-0x15,_0x44638d-0x1a1,_0x442f46);}if(_0x367655){if(_0x499957[_0x51f128(0x11e,0xe3,0xf9,0xd0)]!==_0x499957[_0x51f128(0xda,0x10e,0xf9,0x122)])return _0x2bdfad;else _0x367655[_0x5ccd84(0x21c,0x1d7,0x205,0x1ef)](_0x5ccd84(0x1f6,0x1e1,0x1c9,0x209)+_0x100263+'@}');}return'';}),_0x3f9227=_0x3f9227['replace'](/\{@getvar::([^@]+)@\}/g,(_0x160aed,_0x32d5d3)=>{const _0x580633={};_0x580633[_0x17041f(0x23f,0x1f3,0x21a,0x21b)]=_0x499957['DOBgz'];function _0x3ab70b(_0x548b29,_0x192ba9,_0x54e9d9,_0x43c256){return _0x285631(_0x548b29-0x13e,_0x43c256- -0x3d0,_0x54e9d9-0x1d5,_0x54e9d9);}function _0x17041f(_0x1d0826,_0x3547e1,_0x3c9e0b,_0x213399){return _0x28dd2e(_0x1d0826-0x51,_0x3547e1-0x14a,_0x3c9e0b-0x283,_0x213399);}const _0x258a4c=_0x580633;if(_0x499957['FPRzt'](_0x499957[_0x3ab70b(0xe4,0xbb,0xc8,0xc3)],_0x499957[_0x17041f(0x1bc,0x1d8,0x1c2,0x1f4)])){const _0x3c110f=_0x32d5d3[_0x17041f(0x1ef,0x1ee,0x1bf,0x1b6)](),_0x36c94a=_0x1c820f[_0x17041f(0x21a,0x1e5,0x1fb,0x231)+'ta'][_0x3ab70b(0xcc,0xf8,0x71,0xc2)][_0x3c110f]||'';return _0x367655&&_0x367655['add'](_0x17041f(0x183,0x17a,0x1c7,0x216)+_0x3c110f+'@}'),_0x36c94a;}else return _0x155841[_0x3ab70b(0x11f,0x148,0x157,0x12d)]()[_0x17041f(0x17b,0x197,0x199,0x1e8)](OXmwKo[_0x17041f(0x1e6,0x200,0x21a,0x1fc)])[_0x17041f(0x20d,0x215,0x22c,0x24c)]()[_0x3ab70b(0x171,0xe4,0x131,0x127)+'r'](_0x25c253)[_0x3ab70b(0xa3,0x59,0xa0,0x9a)](OXmwKo['TWvVY']);}),_0x3f9227=_0x3f9227[_0x285631(0x489,0x4ce,0x4c2,0x4a3)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x14dc81,_0x18fa92,_0xf15a25)=>{function _0x382efa(_0x375958,_0x49c842,_0x562a56,_0x12a6dd){return _0x28dd2e(_0x375958-0x156,_0x49c842-0x8f,_0x12a6dd- -0x260,_0x49c842);}const _0x28f6ec={'KWlWX':function(_0x1e50e7,_0xcc950,_0x46a86b,_0x364931){return _0x1e50e7(_0xcc950,_0x46a86b,_0x364931);}},_0x471f37=_0x18fa92[_0x30c6b6(-0x174,-0x19d,-0x1aa,-0x1c0)]();_0x499957[_0x382efa(-0x2ec,-0x2a5,-0x2dc,-0x2ad)](setglobalvar,_0x471f37,_0xf15a25);if(_0x367655){if(_0x499957[_0x30c6b6(-0x15a,-0x161,-0x19b,-0x1a5)](_0x499957[_0x382efa(-0x2e8,-0x354,-0x359,-0x33b)],_0x499957[_0x382efa(-0x318,-0x377,-0x2e7,-0x33b)]))_0x367655[_0x382efa(-0x2fb,-0x331,-0x2d8,-0x2ea)](_0x30c6b6(-0x189,-0x177,-0x188,-0x16d)+_0x30c6b6(-0xf2,-0x185,-0x132,-0x14e)+_0x471f37+'@}');else return{..._0x2785c1,'text':_0x28f6ec['KWlWX'](_0x4ff2dc,_0x56fd45[_0x30c6b6(-0x172,-0x19b,-0x185,-0x175)],_0x232e7a,_0x5c6b33)};}function _0x30c6b6(_0x593fe4,_0xadbfbd,_0x3728bc,_0x3f11ad){return _0x28dd2e(_0x593fe4-0x18a,_0xadbfbd-0x9c,_0x3728bc- -0xe6,_0x593fe4);}return'';}),_0x3f9227=_0x3f9227[_0x285631(0x4a3,0x4ce,0x4ff,0x48a)](/\{@getglobalvar::([^@]+)@\}/g,(_0x37dfb4,_0x2fed0f)=>{function _0x13f1ef(_0x277535,_0x171f08,_0x4ec637,_0x290aa0){return _0x28dd2e(_0x277535-0x15e,_0x171f08-0x1e,_0x4ec637-0x178,_0x290aa0);}function _0x2f351c(_0x6cfcc9,_0x160bf8,_0x320de2,_0x7ce36){return _0x285631(_0x6cfcc9-0xce,_0x7ce36- -0x455,_0x320de2-0x4c,_0x160bf8);}if(_0x499957[_0x2f351c(-0x9,-0x1a,0x76,0x29)]!==_0x499957[_0x13f1ef(0xcf,0xf9,0xb9,0x69)]){const _0x398baf=_0x2fed0f[_0x13f1ef(0x8c,0x6b,0xb4,0x64)](),_0x226160=_0x499957['kszQF'](getglobalvar,_0x398baf)||'';return _0x367655&&(_0x499957['vHoQW']('OqFLm',_0x499957[_0x2f351c(0x58,0x27,0x50,0x74)])?(_0x1e18bc=_0x201816[_0x13f1ef(0xf9,0xe9,0xbb,0xf1)](_0x499957[_0x2f351c(0x62,0x1d,0x52,0x36)],_0x3c2f34),_0x8d373b=_0x3b3b7f[_0x13f1ef(0xd8,0xb7,0xbb,0x7e)](_0x499957[_0x13f1ef(0xa3,0xd6,0xa6,0xd5)],_0x25c01f)):_0x367655[_0x13f1ef(0xd7,0xa4,0xee,0x12f)]('{@getgloba'+_0x13f1ef(0xe4,0x166,0x12c,0x141)+_0x398baf+'@}')),_0x226160;}else _0x2426b1[_0x2f351c(0x4d,0x40,0x8d,0x77)+'ta']={};});function _0x285631(_0x5eef5c,_0x3d9eda,_0x51d0f5,_0x5a7e63){return _0x3d5f(_0x3d9eda-0x3d0,_0x5a7e63);}return _0x3f9227=_0x3f9227['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x5c6d8b,_0xdff05a)=>{const _0x1f4ac2={};_0x1f4ac2[_0x3804ec(0x29a,0x24c,0x25a,0x262)]=_0x499957[_0x57c956(0x352,0x322,0x355,0x34b)];function _0x3804ec(_0x3ea254,_0x54dd04,_0x215544,_0x56bacd){return _0x28dd2e(_0x3ea254-0x5a,_0x54dd04-0x16e,_0x56bacd-0x2eb,_0x215544);}const _0x1d8575=_0x1f4ac2;function _0x57c956(_0x2d8e89,_0x7b468e,_0x2ca6a3,_0x170326){return _0x285631(_0x2d8e89-0x1e8,_0x2ca6a3- -0x173,_0x2ca6a3-0x34,_0x7b468e);}if(_0x499957[_0x57c956(0x2e1,0x2e1,0x32c,0x35c)](_0x499957[_0x57c956(0x2ee,0x2b7,0x309,0x2b8)],_0x499957[_0x3804ec(0x234,0x1e6,0x200,0x213)])){const _0x5964a5=_0xdff05a[_0x3804ec(0x277,0x1dd,0x207,0x227)](),_0x335ad3=getworldvar(_0x5964a5)||'';return _0x367655&&_0x367655[_0x57c956(0x349,0x3a8,0x357,0x389)](_0x57c956(0x30c,0x31e,0x328,0x343)+_0x3804ec(0x1ee,0x23b,0x25f,0x224)+_0x5964a5+'@}'),_0x335ad3;}else{const _0x45cc3c={};_0x45cc3c['role']=_0x1d8575[_0x3804ec(0x24b,0x29f,0x293,0x262)],_0x45cc3c[_0x3804ec(0x24c,0x236,0x246,0x278)]=_0x1d8189[_0x57c956(0x3c2,0x3e0,0x391,0x379)],_0x1b2702['push'](_0x45cc3c);}}),_0x3f9227;}export function buildPromptWithTrigger(_0x16b630){const _0x3e244d={'NQxkL':function(_0x4e83cf,_0x1a6a02){return _0x4e83cf(_0x1a6a02);},'eFxEx':_0x14642d(-0x294,-0x208,-0x24a,-0x240),'rVVYF':function(_0xdd641c,_0x408e48){return _0xdd641c===_0x408e48;},'FnHUA':_0x551648(0x4cc,0x4b2,0x4c6,0x4de),'zkyUU':_0x551648(0x4d9,0x4a9,0x4de,0x4d8),'ATdwM':function(_0x5beca5,_0x533b2d,_0x45e1f0){return _0x5beca5(_0x533b2d,_0x45e1f0);},'pVtiL':function(_0x2a52ff,_0x3f478b){return _0x2a52ff!==_0x3f478b;},'bSbcn':_0x551648(0x4f4,0x532,0x4ef,0x4a7),'dSTwz':function(_0x1b7c40,_0x318b5c){return _0x1b7c40!==_0x318b5c;},'Extom':_0x551648(0x51a,0x532,0x512,0x4ec),'vlRYD':function(_0x4632a4,_0x240523,_0x19a677){return _0x4632a4(_0x240523,_0x19a677);}},{requestType:_0x221c3f,contextData:_0x597260}=_0x16b630,_0x2dc9f5=extension_settings[extensionName]?.[_0x551648(0x4eb,0x49e,0x4ab,0x4b3)+_0x551648(0x493,0x4a0,0x4cf,0x48e)+_0x551648(0x4c4,0x4af,0x4b4,0x474)]||{},_0x46a78e={};_0x46a78e[_0x551648(0x4e9,0x4d3,0x495,0x4f3)+_0x551648(0x4fa,0x534,0x538,0x4a6)]='默认';const _0x131baa=_0x2dc9f5[_0x221c3f]||_0x46a78e,_0x489d80=_0x131baa[_0x14642d(-0x2a6,-0x2a9,-0x26c,-0x25a)+_0x14642d(-0x250,-0x265,-0x27a,-0x249)]||'默认',_0x38aa98=extension_settings[extensionName]?.[_0x14642d(-0x2b4,-0x2d6,-0x2ac,-0x287)+_0x551648(0x484,0x463,0x452,0x4ad)+'s']||{},_0x266fef=_0x38aa98[_0x489d80]||_0x38aa98[Object[_0x14642d(-0x270,-0x1ef,-0x259,-0x234)](_0x38aa98)[-0x19f+-0x20f9+-0x148*-0x1b]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x597260,_0x537670=[userDemand,context,body,worldBookContent][_0x551648(0x485,0x440,0x493,0x4d8)](Boolean)[_0x14642d(-0x225,-0x20f,-0x278,-0x23c)]('\x0a'),_0x526794=[];if(_0x266fef[_0x551648(0x516,0x522,0x4eb,0x546)]&&Array['isArray'](_0x266fef[_0x14642d(-0x1e5,-0x276,-0x20f,-0x22d)]))for(const _0x19bc6e of _0x266fef[_0x14642d(-0x221,-0x266,-0x24d,-0x22d)]){if(_0x551648(0x503,0x4cb,0x4d0,0x51a)!==_0x3e244d[_0x551648(0x505,0x4fb,0x4d0,0x4d5)]){const _0xde233e=_0x42ee6b[_0x551648(0x4a6,0x4cb,0x4e8,0x463)](),_0x435574=_0x3e244d['NQxkL'](_0x4e73e0,_0xde233e)||'';return _0x28d058&&_0x49f25e[_0x14642d(-0x24c,-0x226,-0x252,-0x263)](_0x551648(0x4b1,0x4d2,0x501,0x4ff)+_0x551648(0x4a3,0x4d9,0x4a6,0x4ee)+_0xde233e+'@}'),_0x435574;}else{if(!_0x19bc6e[_0x551648(0x519,0x513,0x4eb,0x555)])continue;if(!_0x19bc6e[_0x14642d(-0x29d,-0x256,-0x1fa,-0x24c)]||_0x3e244d[_0x14642d(-0x2fe,-0x2be,-0x311,-0x2c0)](_0x19bc6e[_0x551648(0x4f7,0x4ca,0x4b5,0x51d)][_0x551648(0x4a6,0x48c,0x46e,0x48b)](),''))continue;if(_0x3e244d[_0x14642d(-0x306,-0x2be,-0x2d8,-0x2c0)](_0x19bc6e['triggerMod'+'e'],_0x3e244d[_0x14642d(-0x1ef,-0x233,-0x204,-0x223)])){if(_0x3e244d[_0x551648(0x518,0x4f5,0x53b,0x528)]!==_0x3e244d[_0x551648(0x518,0x52b,0x4e8,0x4dc)])_0xb24fc4[_0x551648(0x4e0,0x4d8,0x49c,0x4ce)](_0xbe45e2);else{if(!_0x3e244d[_0x14642d(-0x240,-0x280,-0x238,-0x24a)](checkTriggerWords,_0x19bc6e[_0x14642d(-0x22e,-0x25a,-0x22e,-0x23d)+'ds'],_0x537670))continue;}}const _0x4ef46e={};_0x4ef46e[_0x14642d(-0x24b,-0x218,-0x275,-0x23f)]=_0x19bc6e[_0x14642d(-0x244,-0x214,-0x20f,-0x23f)]||_0x14642d(-0x216,-0x261,-0x225,-0x24f),_0x4ef46e[_0x551648(0x4f7,0x4cf,0x4aa,0x4b9)]=_0x19bc6e[_0x551648(0x4f7,0x52e,0x4ca,0x53d)],_0x526794[_0x551648(0x4a7,0x4bc,0x462,0x4ab)](_0x4ef46e);}}else{if(_0x266fef['history']&&Array[_0x551648(0x4db,0x51f,0x520,0x498)](_0x266fef[_0x14642d(-0x238,-0x27a,-0x25a,-0x275)]))for(const _0x88bf50 of _0x266fef[_0x551648(0x4ce,0x4db,0x4ef,0x4c3)]){if(_0x88bf50[_0x551648(0x4f4,0x53f,0x540,0x4f6)]&&_0x3e244d[_0x14642d(-0x2a5,-0x27c,-0x2a1,-0x27c)](_0x88bf50[_0x551648(0x4f4,0x53e,0x52e,0x538)][_0x551648(0x4a6,0x4c3,0x463,0x4b9)](),'')){const _0x117305={};_0x117305[_0x551648(0x504,0x4d2,0x4bd,0x4b3)]=_0x3e244d[_0x551648(0x47f,0x472,0x4ce,0x4c1)],_0x117305[_0x14642d(-0x257,-0x234,-0x295,-0x24c)]=_0x88bf50[_0x14642d(-0x299,-0x262,-0x26e,-0x24f)],_0x526794['push'](_0x117305);}if(_0x88bf50[_0x551648(0x51a,0x527,0x52f,0x56c)]&&_0x3e244d[_0x551648(0x4e6,0x52f,0x4e0,0x4de)](_0x88bf50[_0x14642d(-0x27d,-0x1e7,-0x209,-0x229)][_0x14642d(-0x2b3,-0x2b6,-0x2a5,-0x29d)](),'')){const _0x1dd952={};_0x1dd952['role']=_0x3e244d[_0x551648(0x491,0x4d8,0x44e,0x4da)],_0x1dd952[_0x551648(0x4f7,0x4a4,0x4f3,0x523)]=_0x88bf50[_0x14642d(-0x207,-0x1e8,-0x203,-0x229)],_0x526794[_0x551648(0x4a7,0x4c1,0x463,0x4d8)](_0x1dd952);}}}const _0x331eb3=mergeAdjacentMessages(_0x526794);function _0x14642d(_0xe17d43,_0x1f99c1,_0x5acca7,_0x4e2fa2){return _0x3d5f(_0x4e2fa2- -0x35d,_0x1f99c1);}const {messages:_0x3d3842,replacedVariables:_0x253c49}=_0x3e244d[_0x14642d(-0x26e,-0x29f,-0x2e0,-0x2b6)](replaceAllPlaceholders,_0x331eb3,_0x597260);function _0x551648(_0x4ae8d5,_0x1c809d,_0x2fa7a5,_0x1a6f6e){return _0x3d5f(_0x4ae8d5-0x3e6,_0x1c809d);}return _0x3d3842;}export function getProcessedPrompt(_0x63548c,_0x3704cb){const _0x2fb503={'nQHNV':function(_0x5d678b,_0xcade34){return _0x5d678b(_0xcade34);}},_0x1b4fe3={};function _0x13e504(_0x584ef5,_0x166d4e,_0x427d43,_0x3dc219){return _0x3d5f(_0x427d43- -0x2a3,_0x3dc219);}return _0x1b4fe3[_0x13e504(-0x200,-0x1f4,-0x1bf,-0x18d)+'e']=_0x63548c,_0x1b4fe3['contextDat'+'a']=_0x3704cb,_0x2fb503['nQHNV'](buildPromptWithTrigger,_0x1b4fe3);}