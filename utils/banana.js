(function(_0x1b6df4,_0x5cfdda){function _0x186be0(_0xf9a721,_0x20580b,_0x396127,_0x12332e){return _0x4029(_0xf9a721-0x136,_0x20580b);}function _0x62ba6f(_0x375fa8,_0x3e3a1b,_0x1d6602,_0x15a21f){return _0x4029(_0x15a21f- -0x2,_0x1d6602);}const _0x4ea9f1=_0x1b6df4();while(!![]){try{const _0x12c24b=-parseInt(_0x186be0(0x427,0x38e,0x494,0x3a9))/(0x2*-0x233+-0x1de7+0x224e)*(-parseInt(_0x186be0(0x3a8,0x417,0x3b1,0x417))/(0x243+-0x9f5+0x3da*0x2))+parseInt(_0x186be0(0x320,0x35e,0x373,0x34f))/(-0x1b03*-0x1+0x9d9*0x1+-0x24d9*0x1)+parseInt(_0x62ba6f(0x255,0x101,0x13e,0x1b3))/(0x1e*-0x30+-0x21dc+0x2780)*(parseInt(_0x62ba6f(0x258,0x352,0x229,0x2de))/(-0x13f*0x7+-0xb66+0x1424))+-parseInt(_0x62ba6f(0x1ca,0x22e,0x223,0x228))/(0x10a7+-0x94b+0x139*-0x6)*(-parseInt(_0x62ba6f(0x22d,0x1f0,0x230,0x2a5))/(0xa63+0x213+-0xc6f))+-parseInt(_0x62ba6f(0x3a0,0x23f,0x318,0x2e4))/(0x5ea*0x4+0x357+-0x1af7)+-parseInt(_0x62ba6f(0x264,0x1b5,0x256,0x1e4))/(-0x2*0xfdd+-0x9*0xef+-0x6a*-0x61)*(-parseInt(_0x186be0(0x403,0x3a7,0x4ab,0x489))/(-0x99d+0x1be+0xe1*0x9))+parseInt(_0x62ba6f(0x25c,0x2a5,0x2b0,0x279))/(0x20a5+-0x5*0x761+0x44b)*(-parseInt(_0x186be0(0x2e8,0x241,0x32a,0x233))/(-0x13a8+-0x16d9*-0x1+-0xa1*0x5));if(_0x12c24b===_0x5cfdda)break;else _0x4ea9f1['push'](_0x4ea9f1['shift']());}catch(_0xc260af){_0x4ea9f1['push'](_0x4ea9f1['shift']());}}}(_0x501b,-0x7*0x320d+-0x1558+-0x3a5f9*-0x1));const _0x2f03d8=(function(){function _0x55f11a(_0x3c29c7,_0x560063,_0x8fcce5,_0x1f863f){return _0x4029(_0x1f863f- -0x335,_0x8fcce5);}const _0x7e4ee7={'fFdMW':function(_0x108594){return _0x108594();},'nwbIA':function(_0x4410d6,_0x34c2d6){return _0x4410d6===_0x34c2d6;},'oxISN':_0x55f11a(-0xdd,-0x15b,-0x11e,-0x161),'lIifo':function(_0x3e5095,_0x17d2ec){return _0x3e5095!==_0x17d2ec;},'eimJy':_0x4c858e(0xc4,0x6,0xd6,0x49),'zmGWx':_0x4c858e(-0x8c,-0x32,0xc6,0xb)};let _0x1912ac=!![];function _0x4c858e(_0x4ecc67,_0x6a1327,_0x22e3f6,_0x3ab671){return _0x4029(_0x3ab671- -0x2c5,_0x6a1327);}return function(_0x1f2972,_0x129611){const _0x53ee92={'BebTV':function(_0x3cf1a9){return _0x7e4ee7['fFdMW'](_0x3cf1a9);},'iSpCY':function(_0x499b21,_0x2c657a){return _0x7e4ee7['nwbIA'](_0x499b21,_0x2c657a);},'FHwfX':_0x7e4ee7[_0x3a6a5b(0x1f9,0x11f,0x158,0x1d1)]};function _0xa66dd1(_0x520eab,_0x56126c,_0x297a10,_0x4097e1){return _0x4c858e(_0x520eab-0x0,_0x4097e1,_0x297a10-0xcc,_0x297a10-0x37a);}function _0x3a6a5b(_0xd8e5b6,_0x2a428e,_0x3b8ed,_0x5d882c){return _0x55f11a(_0xd8e5b6-0x126,_0x2a428e-0x185,_0x2a428e,_0x3b8ed-0x1ae);}if(_0x7e4ee7[_0xa66dd1(0x394,0x254,0x311,0x24e)](_0x7e4ee7[_0x3a6a5b(0xd4,0x136,0x10d,0x19b)],_0x7e4ee7[_0xa66dd1(0x238,0x1c5,0x27a,0x203)])){const _0x14e713=_0x1912ac?function(){function _0x586221(_0x479a6e,_0x445943,_0x4787f6,_0x14aa08){return _0xa66dd1(_0x479a6e-0x1cb,_0x445943-0x36,_0x14aa08- -0x207,_0x445943);}const _0x58a3f7={'KAIOe':function(_0x46bbd2){function _0x50cc1d(_0x3a83e4,_0x3b7361,_0x376503,_0x7971d2){return _0x4029(_0x376503- -0x252,_0x3a83e4);}return _0x53ee92[_0x50cc1d(-0x71,0x40,0x52,0x31)](_0x46bbd2);}};function _0x1bcb28(_0x213022,_0x551d36,_0x1661be,_0x41a471){return _0xa66dd1(_0x213022-0x18d,_0x551d36-0x161,_0x213022- -0x184,_0x41a471);}if(_0x129611){if(_0x53ee92[_0x1bcb28(0x232,0x2f3,0x25f,0x2a2)](_0x1bcb28(0x105,0xb6,0x137,0x17c),_0x53ee92[_0x586221(0x1b2,0x15e,0x17e,0x165)])){const _0x4edea0=_0x129611[_0x1bcb28(0x243,0x1aa,0x1fe,0x1a9)](_0x1f2972,arguments);return _0x129611=null,_0x4edea0;}else!_0x29f0c2[_0x1bcb28(0x1af,0x12d,0x231,0x137)+_0x1bcb28(0x163,0x1c7,0xbc,0x15f)+_0x1bcb28(0x17c,0x119,0x220,0x17b)]&&(_0x4f0705['initialize'+'BananaList'+_0x586221(0x16d,0x89,0xcc,0xf9)]=!![],_0x58a3f7[_0x586221(0x173,0x121,0xab,0x12e)](_0x1367d1)),_0x58a3f7[_0x1bcb28(0x1b1,0x261,0x1ca,0x20d)](_0x4999a8);}}:function(){};return _0x1912ac=![],_0x14e713;}else{const _0x5421ec=_0xa66dd1(0x308,0x3af,0x363,0x336)+'eneration\x20'+_0x3a6a5b(0x71,0xbe,0x7f,-0x1)+'\x20ID\x20'+_0x5d6592+':\x20'+_0x260508[_0x3a6a5b(0x68,0x6,0xa9,0x75)];_0x186f21(_0x5421ec),_0x840ff3[_0xa66dd1(0x371,0x2ac,0x302,0x351)](_0x5421ec);const _0x117423={};_0x117423['id']=_0x433656,_0x117423[_0x3a6a5b(0x179,0x153,0x16c,0x13e)]=![],_0x117423[_0x3a6a5b(0x1e,0x3,0xc6,0x53)]=_0x352371[_0xa66dd1(0x34c,0x308,0x2e5,0x300)],_0x117423['prompt']=_0x4f4be8,_0xafc543[_0x3a6a5b(0x2c,0x79,0x99,-0x8)](_0x5f5c94['GENERATE_I'+_0xa66dd1(0x325,0x387,0x2de,0x241)+'NSE'],_0x117423),_0x37bdc4(_0xa66dd1(0x2b4,0x32f,0x2e3,0x357)+_0xa66dd1(0x36a,0x264,0x312,0x397)+'lure\x20respo'+_0x3a6a5b(0x108,0x12b,0xc9,0x1f)+':\x20'+_0x3709ac);}};}()),_0x5760a7=_0x2f03d8(this,function(){const _0x4ee8a6={};function _0x4548fc(_0x2e3bfb,_0x506450,_0x101699,_0x5e3be6){return _0x4029(_0x5e3be6- -0x182,_0x2e3bfb);}_0x4ee8a6['bmfQE']=_0x4548fc(0xea,0x23c,0x217,0x185)+'+$';const _0x11a7d2=_0x4ee8a6;function _0x2f5443(_0x21f600,_0xb53e19,_0x271447,_0x117749){return _0x4029(_0x271447-0x309,_0x21f600);}return _0x5760a7['toString']()[_0x2f5443(0x534,0x4b5,0x4ed,0x498)](_0x11a7d2['bmfQE'])['toString']()['constructo'+'r'](_0x5760a7)[_0x4548fc(0x61,0xe2,0xfb,0x62)](_0x11a7d2['bmfQE']);});_0x5760a7();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';function _0x501b(){const _0x44fb86=['yxnWzwn0uMf0Aq','zwnLAxzLzcbPBq','sMHpCgC','vg12se8','BwL0DgvKihn1yW','CMvTB3zLtgLZDa','sNfgvhi','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','nM10uvPJBq','5zco572U5zco','rMfPBgvKihrVia','sxjethq','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','EezzBNe','A1zLzwW','zw5LCMf0Aw9Uia','tvziu0S','otyWm0vIAuvNwa','shLWEgW','y2LZAhu','Aw5PDgLHBgL6zq','rNrODeW','s0fjt2u','z1Lbv3y','DxbKyxrLu3rHDa','C2v0ici','w0jHBMfUyv0GqG','wxfNy0W','veniqLa','shvksva','zgf0ytPPBwfNzq','wNjHqKi','wKTvteu','5yMn572U5yMn','zMLcvKG','Aw1Hz2vjza','AML1z3vHBG','txfqB0W','t2n5yMK','rvPSve8','yKvdse8','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','zwLTsNK','55sO6yws6AAg5lUJ55cg5QIH5BYp','Aw1Hz2vdB25MAq','ChLbAgK','CvnOCxe','igv4DhjHy3rPBG','Bhr1txC','CLzwEui','qwfZsey','sufVDvq','y2zNAw1NxW','CMTKB3DUigLTyq','svnuDfK','B1rHEvy','vvjm','rKfZr04','qMvIvfy','ue9tva','y3DXwhm','mZvTwxPuCvi','tufhrv9srvfvrq','CePTC24','C3nMDwXSEs4','ANHNzLe','Aw9UoIaIqMvHCG','ywn0zxjqCMvZzq','w0jHBMfUyv0GrW','55sO55U05O6L6k+35Rgc5QIH5BYp','Aw1Hz2vU','zxrJAcbnyxjRza','D1HOzwW','zYbvuKWUlI4','zxrPB25FC291CG','y3rNsfm','w0jHBMfUyv0G5zcV','rKH3zLG','CeTyBwW','uwLRzfi','Aw1Hz2u','q29UDgvUDc1uEq','qMvHCMvYia','tLzYs1G','sxbQy0e','yMXVyG','C2fTCgXLq291BG','vvPoCLa','Cef5Duy','AxbpvNi','qvbjihjLCxvLCW','tMDTr3i','mNWWFdn8nhWX','sNjOEeS','B3DUigLTywDLoG','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','B2Hiv2C','Bw9Kzq','CuPgtui','mZbbsgXrvMe','Cg9ZDgzPEfbYBW','ugLTwK8','CeLgDxK','qvftuMe','ENPxy1O','yMfUyw5HioEuN+wBVUs6IW','y2XPzw50','55Qe5zU+54Mh','ywXSyMfJAY4','CfjIuLu','u21QwfG','DwLSDcbjBwfNzq','B25SB2fKzw5K','C3rHCNrZv2L0Aa','BgvZktOG','lcdPQ5JLUQyGlsa','zM9YrwfJAa','B3Hju04','nZbXAuPxv0W','kerPDMLKzv9YBW','BhvYzsbYzxnWBW','wMXvt2W','q2HHCMfJDgvYia','B1P4qLO','mtGXody0vujnshn5','BvfQvgG','zw5KC1DPDgG','y2HHBMDL','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','y29UDMvYC2f0Aq','CIaI','w0jHBMfUyv0Gtq','rxHZDMi','rLnLCxK','ieLeia','nZm2mdLOB2fcuue','rvfLAw8','C3vJy2vZCW','y3vZDg9Tx3vYBa','w0jHBMfUyv0G5l2/','BMrZl2nOyxqTyW','thLczw8','Bw9KzwW','tLnf','CfrgCNe','w0jHBMfUyv0GuW','55sO5l+U5zU+6Ake6k6+oIaI','DdOG','Aw5JBhvKzxm','C2LUzYbKAxjLyW','tw5iDgC','AvnWq1K','ig1LC3nHz2vZlG','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','Bw9KywWGCgf5Ba','BufPELK','l3yXl2nOyxqVyW','kcGOlISPkYKRkq','qLDktLe','yMfUyw5H','BwD3yxe','A0DgA0K','y29TCgXLDgvuyq','CM9Szq','C0zkvem','C1zlr2W','yxrLzcbZDwnJzq','ywDLigDLBMvYyq','yxbWBhK','sMjyD2W','Dgv4Da','yxjRzg93BIbPBq','ywDLifvstdOG','5yMn572U5zco','BMHiBMG','Bg5NBeu','rxfkAhu','ztOG','wNbOChu','ywLSzwqGDg8GzG','vu5ZD0G','DcbVBMX5lcbUBW','EgjhAgq','s3Drswm','55sO5lQo55sF5OIq55QevgfNoIa','zML4zwrqCM9TCa','A25bv1G','yxnZAxn0yw50','wvnfCxO','5zon5BQuicHjrdOG','yKnprM0','v2DfzLC','C3qGkeLeoIa','vu5ryKK','CMvWBgfJzufSBa','u2DgB1u','AfPuDKW','whnrwKW','whPguKq','CNvUBMLUzW','B3vUzcbTyxrJAa','vNfjs0S','v1LtvMC','qMPoB2K','B3nPDgLVBG','5Q2J6z2I5O+q56s66k+noIa','otuXnMjOuK9yyG','C3bSAxq','u2nLBMuGq29TCa','ndmYndrAuhf0wvG','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','wefsz2i','C3rFy2HHDhu4xW','u2nrzMe','B2jNwMK','z3rpruK','w0jHBMfUyv0GuG','Agz0wLq','w0jHBMfUyv0G5Ps2','EsbJB252zxj0zq','y2HVAwnLCW','txPOyNq','r0vorvjbvevFsq','r29yrKe','u3z0vuK','EM1hv3G','s3ntCKi','Aw1Hz2vFDxjS','DwnJzxnZzNvSBa','rejIEgq','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','Bw9KzwW6ia','sNHYrwy','DgLVBIbYzxf1zq','w0jHBMfUyv0G5y+w','B0TbC2G','v05uBeC','w0jHBMfUyv0G5l+U','B3iGChjVBxb0oG','zgvSCY8','yLLPBvC','qKrHt1q','zxnWB25ZzsbJBW','ChjVBxb0','zw5KAw5NihjLCq','DgfYDgLUzYbPBq','s1LMv0e','CwntrLK','CxvTuxq','DwvZDcb0BZOG','mNWZFdb8mxW0','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','uMr3Afa','Exvtz0S','ywrKvgfZAW','CgfYyw1LDgvYCW','C2vHCMnO','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','mJu4mJq2BvjesMzs','wg9ewuS','uuz5s1q','weDXyxq','nJCYmJu4Du9JAhfK','5BYa5AEliejHBMfUyEEuNW','DcbvuKWGyxmGzG','5lU75yQH5BEY5y+w5RAi','BwfNzsbPBIbpCa','BwfW','BgvUz3rO','5l+U5zU+5OYh5lUKoIa','w0jHBMfUyv0Gua','yNLMyLC','s0ruu0G','Dg9mB3DLCKnHCW','qvbjihjLC3bVBG','wfvlAwS','y2vZCYbYzxnWBW','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Cg9XzNC','zezZsve','rMXtqwe','C3rYAw5NAwz5','C2XnCfO','yMfUyw5Hq2HHCG','ihWG','y29UDgvUDa','q1DtuKK','y2HHDf9JB21WBa','y2fUy2vSx2jHBG','Aw9U','zMfPBgvKigzVCG','AM9PBG','Bxb0','DxjS','D2TTs0O','BLD1yNO','w0jHBMfUyv0GrG','Aw5ZDgfUy2vZ','Aw5NihrYAwDNzq','uvbutLe','yxbWBgLJyxrPBW','DuLnC1e','D2L0AcbWCM9TCa','yKDyBNG','CMvWBgfJzq','BwvZC2fNzxm','B25LCNjVCG','5zco572U5yMn','w0jHBMfUyv0G55sF','svPvy1a','y3vZDg9T','B3znAe0','C3vIC3rYAw5N','BIbWyxLSB2fKia','uvz1vKq','BwfNzw4G5QIH5z6l5lIn5PsV','zw1PDa','AMDIshu','E+s/RUwBVN0','Bwf0y2G','C3rYzwfT','A1PwCum','D1PXug4','qxv0Ag9YAxPHDa','vwHOtfK','tufhrv9srvnqtW','mJeXotm4shrrv0fL','ifbYB21WDa','5lIT55QeihbYB21WDooaGG','yw5Hx3rHC2S','w0jHBMfUyv0Grq','C0Xjy3q','BwvZC2fNzq','zxrLy3rLzcbnyq','qMfUyw5HtgLZDa','BLLeCxm','A21Utui','DxnLCG','s1nAseS','BhvKzv9OzwfKzq','AvDwCxi','u2req3q','DhLWzq','zxiG','y3vZDg9Tx2LUyW','EwvWrhi','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','q2zlBfa','vgfXrgS','5PYa5zco572U','zMLSDgvY','sxr2Dfm','igLTywDLlG','wMHZC2W','yxnRsuq6ia','C3rHDhvZ','iIbMCM9TihbYzq','mxWWFdj8m3W0','y2fJAgu','zw5LCG','5zU+5QIH5BYp77YA5OYh5lUKid0G','zxjYB3i','BwfNzsbNzw5LCG','BI9QC29U','BNnLigzVCIbjra','CIbWCM9TChq6ia','vwXjB2y','AwPOtKq','l3yX','CeLXu0S','w0jHBMfUyv0Gvq','Ee5AvfO','AxnbCNjHEq','l3yXyMv0ys9TBW','Au1tC3i','v1LqB1i','BeLPzM8','BwL0DgvKigzHAq','ChvZAa','t2D1D28','BNrHAw5ZihrLEa','ExbQtwe','B21WBgv0Aw9UCW','tuzrqLq','D2TUrgC','s3fSB3O','DLrxq3e','CK5Awxi','zxrJAcbLCNjVCG','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5'];_0x501b=function(){return _0x44fb86;};return _0x501b();}import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;function _0x4029(_0x18d055,_0x97211b){_0x18d055=_0x18d055-(0x5b7+-0x1*-0x23f2+0x4*-0x9fe);const _0x5834b9=_0x501b();let _0x2a6c6c=_0x5834b9[_0x18d055];if(_0x4029['dtBhYw']===undefined){var _0x41b3f3=function(_0x10e2d1){const _0x4faa5f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x47e5e2='',_0x24b860='',_0x3a8840=_0x47e5e2+_0x41b3f3;for(let _0x14f15a=-0x1455+0x1679+-0x224,_0x3eaddb,_0x325e90,_0x394a45=0xbaa*-0x2+0xf94+0x7c0;_0x325e90=_0x10e2d1['charAt'](_0x394a45++);~_0x325e90&&(_0x3eaddb=_0x14f15a%(0x3*-0x817+0x17d7+-0x13*-0x6)?_0x3eaddb*(0x214b+-0x786*-0x1+0x5*-0x81d)+_0x325e90:_0x325e90,_0x14f15a++%(0x15e*-0x1b+-0x1c9*-0x2+0x215c))?_0x47e5e2+=_0x3a8840['charCodeAt'](_0x394a45+(-0x1*-0x33b+0x256*-0x8+0xf7f))-(-0x45a*0x1+0x80e+-0xe*0x43)!==-0x1*-0x61a+0x1d*0x10d+-0x2493*0x1?String['fromCharCode'](0x5b6*-0x5+-0x1bde+0x396b&_0x3eaddb>>(-(0xa*0x1b1+-0x1b+-0x17*0xbb)*_0x14f15a&-0x122f+0x256*-0x2+0x16e1)):_0x14f15a:-0x2*-0xd+-0x21b0+0x2196){_0x325e90=_0x4faa5f['indexOf'](_0x325e90);}for(let _0x34a6bf=0x1+0x123*0x21+-0x2584,_0x1cc500=_0x47e5e2['length'];_0x34a6bf<_0x1cc500;_0x34a6bf++){_0x24b860+='%'+('00'+_0x47e5e2['charCodeAt'](_0x34a6bf)['toString'](-0x1*-0x112+0x1500+-0x1602))['slice'](-(0x42+0x26a5+0x26e5*-0x1));}return decodeURIComponent(_0x24b860);};_0x4029['rucFWR']=_0x41b3f3,_0x4029['aPDnuq']={},_0x4029['dtBhYw']=!![];}const _0x4320a9=_0x5834b9[0x1*0x228d+0x1*0x139f+-0x4*0xd8b],_0x21c5b9=_0x18d055+_0x4320a9,_0x586c33=_0x4029['aPDnuq'][_0x21c5b9];if(!_0x586c33){const _0x386718=function(_0x4adf19){this['jkrVab']=_0x4adf19,this['mvHovi']=[-0xeac+0x194+0xd19,0x5d*0x2f+-0xa18+-0x6fb*0x1,0x11*-0x15b+-0x2493*0x1+0x3b9e],this['ehbWch']=function(){return'newState';},this['LOlvLR']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['PCmMVo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x386718['prototype']['ktCwwt']=function(){const _0x4f1f88=new RegExp(this['LOlvLR']+this['PCmMVo']),_0x37f840=_0x4f1f88['test'](this['ehbWch']['toString']())?--this['mvHovi'][0x2*-0x3bf+-0x7ce+0xf4d]:--this['mvHovi'][0x3*0x8ce+-0x2575*-0x1+-0x3fdf];return this['ArQAhk'](_0x37f840);},_0x386718['prototype']['ArQAhk']=function(_0x3d28e1){if(!Boolean(~_0x3d28e1))return _0x3d28e1;return this['XJJCQR'](this['jkrVab']);},_0x386718['prototype']['XJJCQR']=function(_0x2f568b){for(let _0x3e489f=0xa1f*-0x1+0x1636+-0xc17,_0x5ea54e=this['mvHovi']['length'];_0x3e489f<_0x5ea54e;_0x3e489f++){this['mvHovi']['push'](Math['round'](Math['random']())),_0x5ea54e=this['mvHovi']['length'];}return _0x2f568b(this['mvHovi'][0x18b3+-0x1*0x19c5+-0x1*-0x112]);},new _0x386718(_0x4029)['ktCwwt'](),_0x2a6c6c=_0x4029['rucFWR'](_0x2a6c6c),_0x4029['aPDnuq'][_0x21c5b9]=_0x2a6c6c;}else _0x2a6c6c=_0x586c33;return _0x2a6c6c;}async function getImageFromTurnData(_0x4283cf){const _0x317818={'hftZT':function(_0x41f052,_0x93f571){return _0x41f052(_0x93f571);},'oTayV':function(_0x25d176,_0xaf3f00){return _0x25d176||_0xaf3f00;},'NVrKX':_0xc0fce8(0x211,0x2c9,0x2c8,0x335)};if(!_0x4283cf)return'';if(_0x4283cf[_0x4f1e85(0x185,0xb9,0xd5,0xbd)]&&_0x4283cf[_0xc0fce8(0x377,0x2c4,0x2cd,0x38a)][_0xc0fce8(0x295,0x3a0,0x31b,0x350)](_0x4f1e85(0x187,0x12b,0xe6,0x150))){const _0x5349ba=await _0x317818[_0x4f1e85(0x2f,0x89,0x5,0x92)](getConfigImage,_0x4283cf[_0xc0fce8(0x23f,0x27a,0x2cd,0x344)]);return _0x317818[_0x4f1e85(0x131,0x57,0xe9,0x146)](_0x5349ba,'');}if(_0x4283cf['image']&&_0x4283cf['image'][_0x4f1e85(0x161,0x151,0x123,0x167)](_0x317818[_0x4f1e85(0xc8,0x177,0x105,0x1ac)]))return _0x4283cf[_0xc0fce8(0x2c8,0x288,0x2fa,0x2ec)];function _0xc0fce8(_0x22a649,_0x11672c,_0x272832,_0x232877){return _0x4029(_0x272832-0x40,_0x11672c);}function _0x4f1e85(_0xc19946,_0x3c5e89,_0x264d67,_0x7d4969){return _0x4029(_0x264d67- -0x1b8,_0xc19946);}return'';}async function generateBananaImage({prompt:_0x254f4a,width:_0x3609ab,height:_0x81df9a,change:_0x176195,retouchPrompt:_0x247b82,retouchImage:_0x39bd39}){const _0xc6d959={'ZlUOl':function(_0x263831,_0x3294d0){return _0x263831(_0x3294d0);},'HFSHA':'banana\x20生图事'+_0x15c23(0xd1,-0x31,0x9d,0x38),'ISTtY':function(_0x1e416d,_0x533701){return _0x1e416d+_0x533701;},'Vteub':function(_0x38e88a,_0xefb123){return _0x38e88a+_0xefb123;},'qShqq':function(_0x50de9b,_0x270ade){return _0x50de9b===_0x270ade;},'BWIBD':'0|1|4|3|2','ipOVr':'任务已取消','zzWcZ':function(_0x57c6f5,_0x1c18e4){return _0x57c6f5||_0x1c18e4;},'KYfWA':_0x586d50(0x27b,0x1ea,0x2bc,0x28c),'MnHtg':_0x586d50(0x20d,0x1ef,0x1e5,0x24f)+_0x15c23(0x129,0x30,0x20,0xbb)+':','LyBeo':function(_0x516a18,_0x383477){return _0x516a18===_0x383477;},'oKAsh':_0x15c23(-0x8f,0x1c,0x4d,0x1a),'ESoYU':function(_0x1fd6c0,_0x50cd31){return _0x1fd6c0+_0x50cd31;},'SdDCt':function(_0x1a70e3,_0x552e5e){return _0x1a70e3(_0x552e5e);},'xbGhd':_0x15c23(0x31,-0xa8,0x50,0x7)+_0x586d50(0x432,0x37f,0x317,0x379),'WYSVg':_0x15c23(-0x1c,0xf,0x10c,0x88),'Oguwo':'标准模式:\x20使用请求'+_0x586d50(0x30e,0x1ad,0x29d,0x26f),'EZlTO':function(_0x2f062f,_0x29fff7){return _0x2f062f(_0x29fff7);},'kVeel':function(_0x238a14,_0x3d2852){return _0x238a14(_0x3d2852);},'ItvtS':_0x15c23(0x4e,-0x10,0xd4,0xa9)+_0x15c23(0x133,0x182,0x1bb,0x152)+_0x586d50(0x2c8,0x1fc,0x20c,0x22f)+_0x586d50(0x2fc,0x383,0x352,0x319),'obgZi':_0x15c23(0x170,0x33,0x127,0xde),'cwqXs':_0x586d50(0x2f3,0x377,0x34a,0x35a),'KsSrB':_0x15c23(0x77,0x26,0x60,0x6a),'IpjcA':_0x15c23(0x90,0xd9,0x175,0xc6),'ScQfa':'最后置','WKSFK':function(_0xb67032,_0x3f7442){return _0xb67032(_0x3f7442);},'VveuJ':function(_0x28b042,_0x4004ef){return _0x28b042||_0x4004ef;},'GPevw':function(_0x5ef181,_0x1d2fd9){return _0x5ef181+_0x1d2fd9;},'NgmGr':function(_0x908018,_0xeb9a4f){return _0x908018||_0xeb9a4f;},'EQeio':function(_0x233699,_0x3f97c1){return _0x233699>_0x3f97c1;},'ZnkdP':'...','QVuVD':function(_0x7c79a3,_0xc2d777){return _0x7c79a3(_0xc2d777);},'lnglE':function(_0x5dc1e6,_0x20957e){return _0x5dc1e6(_0x20957e);},'CfKlP':function(_0x1c1d57,_0x269f92){return _0x1c1d57(_0x269f92);},'JhOpg':function(_0x3fab28,_0x229f5e){return _0x3fab28(_0x229f5e);},'HuJIP':function(_0x3f9128,_0xf8f37f){return _0x3f9128!==_0xf8f37f;},'xNZTZ':function(_0x5a6d64,_0x27ba03){return _0x5a6d64(_0x27ba03);},'EqJhu':function(_0x68ab67,_0x3cf1cd){return _0x68ab67===_0x3cf1cd;},'SmjXX':_0x15c23(0x236,0x158,0x1a5,0x17b),'SgFoU':_0x586d50(0x362,0x32b,0x294,0x2d6)+_0x586d50(0x20a,0x369,0x33b,0x2b4),'xFYnq':function(_0x561809,_0x284403){return _0x561809<=_0x284403;},'ZKULE':function(_0x167505,_0x2a7287){return _0x167505===_0x2a7287;},'jxgfQ':'pyAhi','mgwaq':function(_0x5bf149,_0x289878){return _0x5bf149+_0x289878;},'pAyuF':function(_0x537ffa,_0x5ef1f5){return _0x537ffa+_0x5ef1f5;},'IAouT':function(_0xe388b9,_0x3f749b){return _0xe388b9(_0x3f749b);},'ypjMa':function(_0x298c44,_0x3a8bf7,_0x19b59a){return _0x298c44(_0x3a8bf7,_0x19b59a);},'pTFrq':function(_0x2b7f4f,_0x55e61e){return _0x2b7f4f+_0x55e61e;},'KwQIc':'DQgbk','BDaOT':function(_0x58946b,_0x5075b7){return _0x58946b(_0x5075b7);},'FSeqy':function(_0x50b373,_0x19e78c){return _0x50b373(_0x19e78c);},'pKXml':_0x586d50(0x32d,0x2cc,0x34a,0x349)+_0x15c23(0x88,0xf3,0x110,0xb5),'XuLrj':'{修图}','wZqPn':'migeP','FAsGN':_0x15c23(0xb0,0x43,0xef,0xe5),'MVHSK':_0x15c23(0x1bc,0x146,0x88,0x141),'pJmsn':_0x586d50(0x1a3,0x2e5,0x24b,0x241),'FlSAa':function(_0x200398,_0x2608fa){return _0x200398(_0x2608fa);},'QikdR':function(_0x40f3b8,_0xec4550){return _0x40f3b8(_0xec4550);},'iWVqr':function(_0x2ae89a,_0x1a85a4){return _0x2ae89a!==_0x1a85a4;},'ohHWg':_0x15c23(0x93,0x12d,0x5f,0x7b),'UlIof':function(_0x2d9e38,_0x2dba20){return _0x2d9e38!==_0x2dba20;},'XsQZL':_0x586d50(0x193,0x295,0x284,0x23d),'ijhND':_0x15c23(0x14e,0x16e,0xd3,0x17e),'KSZHK':function(_0x58b4fe,_0x6f52d8){return _0x58b4fe!==_0x6f52d8;},'HTdTM':_0x586d50(0x1b7,0x190,0x2e6,0x236),'tDXVW':_0x586d50(0x280,0x367,0x322,0x30a),'kGFkI':'IhBYq','JxrEf':_0x15c23(0xe4,0xea,0xfe,0x167),'gtOEI':function(_0x3d7479,_0x23b624){return _0x3d7479(_0x23b624);},'WNTlG':_0x15c23(0xdc,-0x6a,-0x27,0x3a),'JqFTr':_0x586d50(0x21b,0x275,0x26d,0x24e),'knAWX':_0x586d50(0x201,0x1fb,0x2e0,0x256),'ZraBB':'/v1/','xMdhD':function(_0x4059d5,_0xa7c582){return _0x4059d5+_0xa7c582;},'WgEfW':function(_0x476ec4,_0x7df14b){return _0x476ec4+_0x7df14b;},'SvtUI':function(_0x4ce936,_0x138a30){return _0x4ce936+_0x138a30;},'sLIct':_0x586d50(0x27b,0x1e8,0x259,0x297),'wXhel':_0x586d50(0x380,0x259,0x27d,0x2d1),'DBbxd':function(_0xdd4513,_0x58ccbb){return _0xdd4513+_0x58ccbb;},'Zhssl':'/api/backe'+_0x586d50(0x3f5,0x29a,0x2fe,0x339)+'ompletions'+'/generate','ovMhM':function(_0x269813,_0x26e2d2){return _0x269813(_0x26e2d2);},'FthtL':_0x586d50(0x1bf,0x1cf,0x224,0x25d),'QFyKT':_0x15c23(0x131,0xbe,0x87,0x103),'SJShK':function(_0x16b86a,_0x2f394f){return _0x16b86a(_0x2f394f);},'Kqloz':'applicatio'+_0x15c23(0x156,0x16,0x78,0xa2),'XUKik':function(_0x117ca9,_0x16ada6){return _0x117ca9(_0x16ada6);},'rVVyB':_0x586d50(0x2dc,0x3e7,0x419,0x369),'AQSRa':_0x586d50(0x27e,0x25a,0x1f4,0x29d),'XzFRD':function(_0x36934b,_0x211909){return _0x36934b(_0x211909);},'qumQt':_0x15c23(-0x4b,-0x76,0xee,0x34),'nhHnh':_0x15c23(-0x4f,0xf5,0x109,0x6c),'GoXFA':_0x586d50(0x3b1,0x32c,0x37f,0x374),'MqPoL':function(_0x163d0e,_0x72819b,_0x12a21a){return _0x163d0e(_0x72819b,_0x12a21a);},'mQjTh':_0x15c23(0xf5,0xd4,0xda,0xf8),'XARgb':'string','YqgcL':_0x15c23(0x2e,0x2a,-0x3d,0x62),'Zphpu':function(_0x2c8f15,_0x1e6be4){return _0x2c8f15(_0x1e6be4);},'uGCIB':'[Banana]\x20D'+_0x15c23(0x46,0xb,-0x2e,0x84)+_0x15c23(0x130,0x84,0x197,0xf2)+'ge\x20format,'+_0x586d50(0x2c6,0x2e2,0x38b,0x2dc)+_0x15c23(0x82,0x1a6,0x11c,0x106),'Mzhbt':_0x15c23(0x14c,0x145,0x181,0x14e)+_0x15c23(-0x11,0xd2,0xcc,0x1b)+_0x586d50(0x244,0x157,0x26f,0x202)+'d\x20Markdown'+'\x20image\x20to\x20'+'base64.','ctgHS':function(_0x4570a6,_0x43d5e3){return _0x4570a6!==_0x43d5e3;},'WYPoR':_0x15c23(0xae,0x45,0x12e,0x78),'BjNoi':_0x586d50(0x258,0x255,0x21a,0x1ff)+_0x586d50(0x222,0x1e5,0x199,0x219)+_0x586d50(0x282,0x229,0x34c,0x2a3)+_0x586d50(0x2b9,0x36b,0x2f1,0x362)+_0x586d50(0x347,0x1e2,0x2f4,0x287),'fiBVH':_0x15c23(0xde,0x1,-0x2f,0x49)+'se\x20did\x20not'+'\x20contain\x20i'+_0x15c23(0x65,0xac,0x93,0x41)+'enAI\x20forma'+'t','wknDg':function(_0x119a75,_0x3160c7){return _0x119a75(_0x3160c7);},'JbXwl':function(_0x4f4a39,_0x6e66c1){return _0x4f4a39||_0x6e66c1;},'XGqat':_0x586d50(0x2f6,0x386,0x37d,0x348)};clearLog();const _0x31a1b6=taskQueue[_0x15c23(-0x3a,0xb5,0xbb,0x35)]({'name':_0xc6d959['GPevw'](_0xc6d959[_0x586d50(0x3b7,0x276,0x299,0x308)](_0x254f4a,'')[_0x15c23(-0x3f,0x18,-0x8,0x6f)](0x1d7*-0xf+-0x6d*-0x3d+0x1a0,0x1c1a+-0xf4b+-0xcb1),_0x254f4a&&_0xc6d959[_0x586d50(0x3b7,0x278,0x2d2,0x335)](_0x254f4a['length'],-0x24dc+-0x1b*-0x169+-0x1*0x119)?_0xc6d959['ZnkdP']:''),'type':TaskType['BANANA'],'prompt':_0x254f4a});currentTaskId=_0x31a1b6,_0x254f4a=_0xc6d959[_0x15c23(0x7b,0x117,-0x30,0x71)](processCharacterPrompt,_0x254f4a),_0x254f4a=await _0xc6d959[_0x15c23(0xf1,0x13e,0x1be,0x16c)](stripChineseAnnotations,_0x254f4a);let _0x118138=_0x176195;_0x176195=processCharacterPrompt(_0x176195),_0x176195=await _0xc6d959[_0x15c23(0x65,0x12d,0x142,0x92)](stripChineseAnnotations,_0x176195),addLog(_0x15c23(0x6c,0x22,0x89,0x3e)+'图流程。客户端为'+extension_settings[extensionName][_0x15c23(0x17a,0x1ad,0x1d4,0x127)]),_0xc6d959[_0x586d50(0x27b,0x35f,0x1fa,0x2af)](addLog,_0x15c23(0x7f,-0x87,0xb6,0x32)+'\x20'+(_0x3609ab||'默认')+_0x586d50(0x29d,0x395,0x33f,0x320)+(_0x81df9a||'默认')),_0x254f4a=_0x176195&&_0xc6d959['HuJIP'](_0x176195['trim'](),'')?_0x176195:_0x254f4a,_0xc6d959[_0x586d50(0x279,0x27f,0x320,0x29a)](addLog,_0x586d50(0x300,0x33e,0x419,0x365)+_0x254f4a);let _0x20c279=![];_0x254f4a['includes'](_0xc6d959[_0x586d50(0x3c6,0x371,0x3ba,0x363)])&&(_0xc6d959[_0x586d50(0x3c6,0x334,0x3da,0x35d)](_0x586d50(0x308,0x25b,0x2b3,0x277),'SZVwu')?(_0x1e7f30['on'](_0x47a151[_0x15c23(0x71,0x8b,0x22,0x15)+_0x586d50(0x259,0x242,0x254,0x2eb)+'ST'],_0x1aa58c),_0xe9a521['on']('st_chatu8_'+_0x586d50(0x1f9,0x1ee,0x1bc,0x247)+_0x15c23(0x6f,0xe0,0xeb,0x80),_0x17119e),_0xc6d959['ZlUOl'](_0x58c75d,_0xc6d959['HFSHA'])):_0x20c279=!![]);addLog(_0x15c23(-0x24,0xca,0x83,0x4c)+_0x586d50(0x301,0x37e,0x2bf,0x324)+_0x15c23(0xe6,0x1b8,0x95,0x12f)+_0x20c279);let _0x4074cd={},_0xc6b712='',_0x2bd5da='';if(_0x20c279){if(_0xc6d959[_0x586d50(0x336,0x312,0x3b1,0x33a)](_0xc6d959[_0x15c23(0x74,0x80,0x11f,0x12b)],_0x15c23(0xed,0x10c,-0x13,0xa8)))_0x5edb76['Character\x20'+_0x46bffc+'\x20Prompt']&&(_0x47a317=_0xc6d959[_0x586d50(0x2d2,0x23b,0x2dc,0x2e3)](_0xc6d959['Vteub'](_0x47bc31,',\x20'),_0x31b2c7[_0x15c23(0xf1,0x14a,0x1b0,0x137)+_0x5c0410+_0x15c23(-0x41,-0x1b,0x99,0x7e)]));else{_0xc6d959[_0x586d50(0x299,0x22a,0x1fa,0x29a)](addLog,_0xc6d959[_0x586d50(0x30e,0x347,0x40e,0x370)]),_0x4074cd=parsePromptStringWithCoordinates(_0x254f4a),_0xc6b712=_0x4074cd[_0x586d50(0x24e,0x174,0x250,0x1f7)+_0x15c23(0x22b,0x110,0x167,0x189)];for(let _0xae7d4f=0xce0+0x1ca4+0x1*-0x2983;_0xc6d959['xFYnq'](_0xae7d4f,-0x14*-0x1a+0x1*0x25b5+0x27b9*-0x1);_0xae7d4f++){if(_0x4074cd['Character\x20'+_0xae7d4f+'\x20Prompt']){if(_0xc6d959[_0x586d50(0x21c,0x330,0x279,0x2cd)](_0x586d50(0x358,0x24a,0x376,0x2da),_0xc6d959[_0x586d50(0x2f1,0x284,0x26e,0x2ee)]))_0x2bd5da=_0xc6d959[_0x15c23(0x16e,0x1fe,0xe7,0x15d)](_0xc6d959['pAyuF'](_0x2bd5da,',\x20'),_0x4074cd[_0x15c23(0xea,0x84,0x1c3,0x137)+_0xae7d4f+'\x20Prompt']);else{const {taskId:_0x2037cb}=_0x4fbc0e;_0xc6d959[_0x586d50(0x307,0x3d1,0x27b,0x326)](_0x4ec13a,'[Banana]\x20收'+_0x15c23(0x132,0x149,0x183,0x11c)+_0x15c23(0x156,0x28,0x159,0x99)+_0x2037cb+')');if(_0xc6d959[_0x15c23(0x7e,0x43,0x166,0xeb)](_0x59319c,_0x2037cb)&&_0x3b8b73){const _0x48cbdc=_0xc6d959['BWIBD'][_0x586d50(0x23a,0x2ae,0x225,0x1f6)]('|');let _0x436cb0=0x2*0xcc2+0x26f8+-0x407c;while(!![]){switch(_0x48cbdc[_0x436cb0++]){case'0':_0x177f18(_0x586d50(0x1fa,0x1e4,0x1ae,0x211)+_0x15c23(0xd2,0x2d,-0x3b,0x1d)+'响应\x20(ID:\x20'+_0x3a6c6b+')');continue;case'1':_0xe8e95['emit'](_0x41f9a0[_0x586d50(0x2b2,0x1a1,0x204,0x205)+_0x15c23(0x13f,0x2a,0xf7,0x7c)+'NSE'],{'id':_0x2064d8,'success':![],'error':_0xc6d959['ipOVr'],'prompt':_0xc6d959[_0x15c23(0x158,0x19a,0x65,0x125)](_0x517c35,'')});continue;case'2':_0x2cc4ba=null;continue;case'3':_0x160d32=null;continue;case'4':_0x3bd792=null;continue;}break;}}}}}}}else _0xc6d959[_0x15c23(0x121,0xa5,0xb5,0xf0)](addLog,_0xc6d959['Oguwo']),_0xc6b712=_0x254f4a;let {modifiedPrompt:_0x5bca31,insertions:_0x84c649}=await _0xc6d959[_0x15c23(0x6f,0xae,-0xf,0xb4)](prompt_replace,_0xc6b712,_0x2bd5da);if(_0x20c279)for(let _0x1c7b68=-0xda7+-0x1*0x26ff+-0x1*-0x34a7;_0xc6d959[_0x15c23(0x53,0xe5,0x180,0xca)](_0x1c7b68,0x1*-0x178+-0x18e4+0xd30*0x2);_0x1c7b68++){_0x4074cd['Character\x20'+_0x1c7b68+_0x15c23(0xa2,0x118,-0x8,0x7e)]&&(_0x5bca31=_0xc6d959[_0x15c23(0x57,0x7f,0x186,0x115)](_0xc6d959[_0x586d50(0x2ca,0x2cb,0x311,0x33d)](_0x5bca31,_0x15c23(0xa2,0x8b,0x76,0x53)),prompt_replace_for_character(_0x4074cd['Character\x20'+_0x1c7b68+_0x586d50(0x2f2,0x1f1,0x2b8,0x26e)])));}const _0x29ec68=extension_settings[extensionName][_0x15c23(0xef,0xd8,0xe6,0x15c)];function _0x586d50(_0x2d9671,_0x49afa6,_0x1c7523,_0x4dae56){return _0x4029(_0x4dae56-0x43,_0x2d9671);}function _0x15c23(_0x4849ad,_0x2312fb,_0x59ec92,_0x48e1ed){return _0x4029(_0x48e1ed- -0x1ad,_0x2312fb);}const {model:_0x1256bd,apiUrl:_0x4086d,apiKey:_0x3e3741,conversationPresets:_0x450e5c,conversationPresetId:_0x255a16,editPresetId:_0x171901,aspectRatio:_0x1a744a}=_0x29ec68;_0xc6d959[_0x586d50(0x3de,0x339,0x286,0x326)](addLog,_0x15c23(0x201,0x1a8,0x13d,0x14e)+_0x15c23(0x38,-0x19,-0x8c,0x2c)+_0x586d50(0x2b9,0x2a8,0x3e7,0x354)+'tion\x20with\x20'+_0x15c23(-0x1d,0x55,-0x52,0x1e)+_0x1256bd);let _0x47eba8,_0x37036e;if(_0x1256bd[_0x15c23(0x18a,0x13c,0x190,0x12e)](_0x15c23(0x11d,0xb4,0x16e,0x103))){if(_0xc6d959[_0x586d50(0x327,0x329,0x407,0x364)]===_0xc6d959[_0x15c23(0x20b,0x135,0x121,0x174)]){_0x47eba8=_0x15c23(0x130,-0x13,0x10d,0xac)+_0x586d50(0x21b,0x160,0x186,0x216)+_0x1256bd;const _0x4fb3cb={};_0x4fb3cb['fixedPromp'+'t']='';const _0x1ab864=_0x450e5c[_0x255a16]||_0x4fb3cb,_0x3431a0=[_0x1ab864[_0x15c23(0x1e4,0x178,0x157,0x176)+'t'],_0x84c649[_0xc6d959[_0x15c23(-0x84,0x5e,0x94,0xd)]],_0x84c649[_0xc6d959[_0x15c23(0x177,0x39,0xd4,0xf9)]],_0x5bca31,_0x84c649[_0xc6d959[_0x15c23(0x7e,0xa9,-0x9c,0x19)]],_0x84c649[_0xc6d959[_0x586d50(0x2bb,0x3b3,0x349,0x301)]],_0x1ab864[_0x15c23(0xf1,0x11a,0x69,0x121)+_0x15c23(-0x33,-0x3b,0x54,0x5b)],_0x84c649[_0xc6d959['ScQfa']]][_0x15c23(0xe3,0x77,0xff,0x95)](Boolean)[_0x586d50(0x18e,0x288,0x220,0x24a)](',\x20');_0xc6d959[_0x15c23(-0x4d,0x94,0xa4,0x28)](addLog,_0x586d50(0x14b,0x1fd,0x2ae,0x1f4)+_0x3431a0);const _0x459389={};_0x459389['prompt']=_0x3431a0;const _0x5b29bb={};_0x5b29bb[_0x586d50(0x268,0x3b1,0x387,0x303)+'t']=0x1,_0x5b29bb[_0x15c23(0xde,0x15b,0x7a,0xbd)+'o']=_0x1a744a;const _0x3381db={};_0x3381db['instances']=[_0x459389],_0x3381db[_0x15c23(-0x15,0xf,0x82,0x36)]=_0x5b29bb,_0x37036e=_0x3381db,_0xc6d959[_0x15c23(0xf5,0x82,0x10b,0x142)](addLog,'[Banana]\x20B'+'uilt\x20Image'+_0x15c23(0x5b,0x33,0xc1,0x70)+_0x586d50(0x277,0x304,0x2b6,0x255)+_0x586d50(0x34d,0x392,0x2d2,0x340)+_0x3431a0);}else return _0x43d98f[_0x586d50(0x2c2,0x2ff,0x2bf,0x2fd)];}else{_0x47eba8=_0xc6d959[_0x15c23(0xbf,0x154,0x134,0x10b)];let _0x376f9d;if(_0x176195[_0x586d50(0x30d,0x39c,0x2bc,0x341)](_0xc6d959['XuLrj'])){if(_0xc6d959['HuJIP'](_0xc6d959[_0x15c23(0x78,0x127,0x121,0x79)],_0xc6d959[_0x15c23(0xf4,0x142,0xa6,0xf6)])){addLog(_0x15c23(0x1ae,0x101,0x46,0x109)+'用了\x20{修图}\x20标识'+'。');const _0x578e02=_0xc6d959[_0x586d50(0x3b3,0x332,0x2a9,0x308)](_0x171901,'默认'),_0x3ff2fe={};_0x3ff2fe[_0x15c23(0x103,0x112,0x161,0x13e)+'on']=[],_0x3ff2fe[_0x586d50(0x2d6,0x423,0x3dc,0x366)+'t']='',_0x376f9d=_0x450e5c[_0x578e02]||_0x3ff2fe,_0xc6d959[_0x586d50(0x190,0x220,0x27f,0x218)](addLog,_0x15c23(0x12a,0x13c,0x14e,0x148)+'用修图预设:\x20\x22'+_0x578e02+'\x22');}else{const _0x2cf6d7=_0xc6d959[_0x586d50(0x20e,0x1d2,0x1d8,0x21d)][_0x586d50(0x2aa,0x1cf,0x28b,0x1f6)]('|');let _0x501da3=0x24bd+0x465*-0x1+-0x168*0x17;while(!![]){switch(_0x2cf6d7[_0x501da3++]){case'0':_0xc49eab[_0x586d50(0x23c,0x335,0x255,0x290)](_0xc6d959['MnHtg'],_0x2a3820);continue;case'1':_0xc6d959['ZlUOl'](_0x153f7f,_0x15c23(0x86,-0x4e,-0x1e,0x5f)+_0x15c23(0x16c,0x40,0xa0,0xbb)+':\x20'+_0x4e59ae[_0x15c23(0x0,0xc,0x84,0x83)]);continue;case'2':if(_0xc6d959[_0x15c23(0xed,0x1a1,0x100,0x14a)](_0x1161dc['message'],_0xc6d959['ipOVr'])){}else _0x7d9e2b['completeTa'+'sk'](_0x3af06f,![]);continue;case'3':_0x1fa8b2=null;continue;case'4':throw _0x4621a6;continue;}break;}}}else{if(_0xc6d959[_0x586d50(0x36d,0x2ff,0x2e8,0x2ca)](_0xc6d959[_0x15c23(0x189,0x83,0x111,0xcd)],_0xc6d959[_0x15c23(0x11e,0x15c,0x14f,0xfc)])){const _0x38fde9={};_0x38fde9['conversati'+'on']=[],_0x38fde9[_0x586d50(0x2cd,0x321,0x2d8,0x366)+'t']='',_0x376f9d=_0x450e5c[_0x255a16]||_0x38fde9;}else{const _0x157400={};_0x157400['url']=_0x28d1fa;const _0x54ad38={};_0x54ad38[_0x586d50(0x327,0x259,0x335,0x27d)]=_0xc6d959[_0x586d50(0x227,0x2ca,0x259,0x212)],_0x54ad38[_0x586d50(0x247,0x1ff,0x18a,0x20a)]=_0x157400,_0x2ed854['push'](_0x54ad38),_0xc6d959['ZlUOl'](_0x3cc45f,_0x15c23(0x8c,0x4b,0x36,0x24)+_0x15c23(0x177,0xad,0xb9,0xbc)+_0x15c23(0x1a4,0x185,0x1ab,0x128));}}const _0x4818ba=[_0x376f9d[_0x15c23(0x128,0x22d,0x20a,0x176)+'t'],_0x84c649[_0xc6d959[_0x586d50(0x295,0x209,0x29c,0x1fd)]],_0x84c649[_0x586d50(0x2f4,0x388,0x399,0x35a)],_0x5bca31,_0x84c649[_0xc6d959['KsSrB']],_0x84c649[_0x586d50(0x29a,0x2eb,0x295,0x2b6)],_0x376f9d[_0x15c23(0x166,0x142,0x1d8,0x121)+_0x586d50(0x1a8,0x20c,0x2bc,0x24b)],_0x84c649[_0x586d50(0x313,0x1ff,0x345,0x284)]][_0x586d50(0x26e,0x2f7,0x27c,0x285)](Boolean)[_0x15c23(0xb6,0xeb,-0x69,0x5a)](',\x20');_0xc6d959[_0x15c23(0x5f,-0x36,0xe2,0x4f)](addLog,_0x15c23(-0x30,0x8c,-0x9c,0x4)+_0x4818ba);const _0x2b6247={};_0x2b6247[_0x15c23(0xce,0x167,0x221,0x160)]=_0x586d50(0x31b,0x23c,0x2b0,0x278),_0x2b6247[_0x586d50(0x1dc,0x2e7,0x26f,0x244)]=[];const _0x37f2f1={};_0x37f2f1[_0x15c23(0xf5,0xd1,0x129,0x160)]=_0x586d50(0x389,0x3d5,0x316,0x368),_0x37f2f1['content']=[];const _0x36702a=_0x376f9d['conversati'+'on'][_0x586d50(0x1f5,0x23b,0x2a4,0x232)](_0x27659b=>[_0x2b6247,_0x37f2f1])['flat']();let _0x3e8ec7=0x2*-0x5d5+-0x1966+0x2510;for(const _0x599591 of _0x376f9d[_0x15c23(0x11f,0x1c9,0xf5,0x13e)+'on']){if(_0x599591[_0x15c23(0x30,-0x28,0x11a,0x88)]?.['text'])_0x36702a[_0x3e8ec7][_0x586d50(0x207,0x2df,0x2a8,0x244)][_0x15c23(0x5c,0x12a,0xb7,0xb1)]({'type':_0x15c23(0x1a2,0x122,0x1d8,0x167),'text':_0x599591[_0x586d50(0x285,0x245,0x303,0x278)][_0x15c23(0x1c4,0x132,0x1b3,0x167)]});const _0xfe8397=await _0xc6d959[_0x586d50(0x24d,0x223,0x380,0x2d4)](getImageFromTurnData,_0x599591[_0x586d50(0x2e2,0x201,0x33a,0x278)]);if(_0xfe8397)_0x36702a[_0x3e8ec7][_0x15c23(0x85,-0x64,0x3,0x54)][_0x586d50(0x34d,0x290,0x214,0x2a1)]({'type':_0xc6d959['oKAsh'],'image_url':{'url':_0xfe8397}});_0x3e8ec7++;if(_0x599591['model']?.[_0x586d50(0x3c6,0x3c3,0x3b2,0x357)])_0x36702a[_0x3e8ec7][_0x15c23(-0x24,-0x12,0x1c,0x54)][_0x15c23(0x15a,0x171,0x9e,0xb1)]({'type':_0x15c23(0xca,0xc1,0x221,0x167),'text':_0x599591[_0x15c23(0x16d,0x14c,0x1b2,0x14b)][_0x15c23(0x1ee,0x173,0x1af,0x167)]});const _0x20ccd7=await _0xc6d959[_0x586d50(0x26d,0x2e6,0x38b,0x2fc)](getImageFromTurnData,_0x599591[_0x586d50(0x2ab,0x318,0x3da,0x33b)]);if(_0x20ccd7)_0x36702a[_0x3e8ec7][_0x15c23(0x1e,0xcf,0xdf,0x54)]['push']({'type':_0xc6d959[_0x15c23(0xa3,0x6f,0xcc,0x22)],'image_url':{'url':_0x20ccd7}});_0x3e8ec7++;}if(!_0x176195[_0x15c23(0xea,0xd7,0x1bd,0x151)](_0x15c23(0x129,0x9a,0xed,0x75))){if(_0xc6d959[_0x586d50(0x1e5,0x1bc,0x23f,0x27b)](_0xc6d959[_0x586d50(0x30c,0x253,0x2a8,0x30d)],_0xc6d959[_0x15c23(0x1a3,0xdb,0x10a,0x11d)])){_0x466e5f(_0x15c23(0x184,0xf0,0x1bc,0x109)+'用了\x20{修图}\x20标识'+'。');const _0x38a4e2=_0xc6d959[_0x586d50(0x2e0,0x2ab,0x392,0x315)](_0x9e6bec,'默认'),_0x5720d9={};_0x5720d9['conversati'+'on']=[],_0x5720d9[_0x15c23(0xc4,0x1b8,0x1af,0x176)+'t']='',_0x93e614=_0x165138[_0x38a4e2]||_0x5720d9,_0xc6d959['ZlUOl'](_0x5cee05,'[Banana]\x20使'+_0x586d50(0x322,0x3e5,0x3df,0x33f)+_0x38a4e2+'\x22');}else{const _0x8e027c=extension_settings[extensionName][_0x15c23(0x66,-0x6,0x59,0x52)+_0x15c23(0xdc,0xdd,0x12d,0x100)+'ts']||{};for(const _0x3e933b in _0x8e027c){const _0x3ab718=_0x8e027c[_0x3e933b],_0x2f2053=(_0x3ab718['triggers']||'')[_0x15c23(-0xb,0xb4,0x1f,0x6)]('|')['filter'](_0x1ecff6=>_0x1ecff6['trim']()!=='');for(const _0x2f190c of _0x2f2053){if(_0xc6d959[_0x586d50(0x284,0x31e,0x350,0x295)](_0xc6d959[_0x15c23(0x1d0,0x197,0x16d,0x182)],_0xc6d959[_0x586d50(0x2d5,0x2f9,0x2ca,0x296)])){if(_0x4818ba['toLowerCas'+'e']()[_0x15c23(0x186,0x13c,0x113,0x151)](_0x2f190c[_0x15c23(-0x57,0x4,0xee,0x48)+'e']())){addLog(_0x15c23(0x98,0x30,-0x5c,0x5f)+_0x586d50(0x36b,0x314,0x3f0,0x375)+_0x15c23(0x113,-0x35,0x2b,0x61)+_0x586d50(0x36d,0x393,0x3ac,0x32f)+_0x2f190c+(_0x15c23(0xae,0x6b,0x82,0x9b)+_0x586d50(0x30f,0x24d,0x281,0x2c6))+_0x3e933b+'\x22.');const _0x5297e8=_0x3ab718['conversati'+'on'];if(_0x5297e8){if(_0xc6d959[_0x15c23(0x8d,0x134,-0xb,0x89)](_0x15c23(-0xe,-0x48,0x76,0x46),_0xc6d959['HTdTM']))_0xafe409('[Banana]\x20R'+_0x586d50(0x22d,0x25f,0x1f4,0x219)+_0x15c23(0xa,0x11b,0x60,0xb3)+_0x586d50(0x424,0x309,0x402,0x362)+_0x15c23(0x96,-0x25,0x90,0x97));else{const _0x398430=[];if(_0x5297e8[_0x15c23(-0x5,0xfb,-0x2c,0x88)]&&_0x5297e8[_0x15c23(0x100,-0x24,0xb1,0x88)][_0x586d50(0x2ef,0x39a,0x3f3,0x357)])_0x398430[_0x15c23(0xa2,0xcd,0x15e,0xb1)]({'type':_0x15c23(0x110,0xbf,0x205,0x167),'text':_0x5297e8[_0x15c23(0x7,0x75,0xb2,0x88)][_0x586d50(0x3f9,0x3eb,0x36c,0x357)]});const _0x5ec556=await getImageFromTurnData(_0x5297e8[_0x586d50(0x2c2,0x1c4,0x2d3,0x278)]);if(_0x5ec556)_0x398430[_0x15c23(0x109,0x80,0x144,0xb1)]({'type':_0xc6d959[_0x586d50(0x1ed,0x243,0x28e,0x212)],'image_url':{'url':_0x5ec556}});if(_0xc6d959[_0x586d50(0x2d9,0x3e4,0x33f,0x335)](_0x398430[_0x586d50(0x28b,0x1a4,0x2f1,0x233)],0x6*0x30a+-0x1777+-0x1*-0x53b)){if(_0xc6d959['tDXVW']===_0xc6d959[_0x15c23(0x1ea,0xa0,0x1e8,0x15e)])_0x38a861[_0x586d50(0x2ef,0x3b3,0x295,0x327)+_0x2b6d02+_0x15c23(-0x7,0x110,-0x5,0x7e)]&&(_0x4320a9=_0xc6d959['ESoYU'](_0x21c5b9,_0x15c23(0x2a,0x5f,0x71,0x53))+_0xc6d959[_0x586d50(0x273,0x3e7,0x310,0x326)](_0x586c33,_0x10e2d1['Character\x20'+_0x4faa5f+_0x15c23(0x130,0x0,0xd0,0x7e)]));else{const _0x1e8a17={};_0x1e8a17['role']=_0xc6d959[_0x586d50(0x3ad,0x363,0x343,0x377)],_0x1e8a17['content']=_0x398430,_0x36702a[_0x586d50(0x250,0x225,0x2d3,0x2a1)](_0x1e8a17);}}const _0x4aae2a=[];if(_0x5297e8[_0x15c23(0x161,0x1a7,0x9d,0x14b)]&&_0x5297e8[_0x15c23(0x1ca,0x163,0x1d0,0x14b)]['text'])_0x4aae2a['push']({'type':_0xc6d959[_0x586d50(0x2b3,0x28d,0x21d,0x20f)],'text':_0x5297e8[_0x15c23(0x103,0x10c,0x193,0x14b)]['text']});const _0x552962=await _0xc6d959[_0x586d50(0x190,0x28a,0x172,0x1fe)](getImageFromTurnData,_0x5297e8[_0x15c23(0x202,0x143,0x156,0x14b)]);if(_0x552962)_0x4aae2a['push']({'type':_0xc6d959['oKAsh'],'image_url':{'url':_0x552962}});if(_0xc6d959[_0x15c23(0x19f,0xf8,0x100,0x145)](_0x4aae2a['length'],-0x1a03*0x1+-0x12a8+0x8ef*0x5)){const _0x5b4c42={};_0x5b4c42[_0x15c23(0x14d,0x133,0xbc,0x160)]=_0x15c23(0xbb,0x233,0x158,0x178),_0x5b4c42['content']=_0x4aae2a,_0x36702a[_0x15c23(0x164,0xb,0xf0,0xb1)](_0x5b4c42);}}}break;}}else _0x41812f[_0x586d50(0x318,0x346,0x205,0x2b2)+_0x586d50(0x1d1,0x295,0x228,0x28e)](_0x169acb,_0x2169ea);}}}}if(!_0x176195[_0x586d50(0x368,0x2ab,0x31e,0x341)](_0xc6d959['XuLrj'])){if(_0xc6d959[_0x15c23(0x17f,0x1a8,0xe6,0x14a)](_0xc6d959[_0x15c23(-0x55,-0x2a,-0x73,0x23)],_0xc6d959[_0x15c23(0x11b,0x138,0x9f,0xc3)])){_0x27dd43(_0x15c23(0xdd,0xce,0xed,0xe6)+_0x15c23(0x16f,0x14e,0x182,0xc4)),_0x5a478a=_0xc6d959[_0x15c23(0xd4,0xfb,0x76,0x8c)](_0x185586,_0x197efd),_0x29fcb9=_0x270904[_0xc6d959['xbGhd']];for(let _0x37e5a2=-0x22+0x1f7*-0x3+-0x2*-0x304;_0x37e5a2<=0x15d*0xb+0x2548*0x1+-0x3443;_0x37e5a2++){_0xfc8a66[_0x586d50(0x2e5,0x3cf,0x37b,0x327)+_0x37e5a2+_0x586d50(0x1d8,0x1d6,0x284,0x26e)]&&(_0x568094=_0xc6d959[_0x15c23(0x73,0x12c,0xd8,0xf3)](_0x4e5b02+',\x20',_0x2d9bb7[_0x586d50(0x290,0x3cd,0x30a,0x327)+_0x37e5a2+_0x586d50(0x326,0x29c,0x2ba,0x26e)]));}}else{const _0xc07a38={};_0xc07a38['role']=_0xc6d959[_0x15c23(0x1de,0x1f5,0x15b,0x187)],_0xc07a38[_0x15c23(-0x4,0xc6,-0x22,0x54)]=[{'type':_0xc6d959[_0x586d50(0x1df,0x18e,0x266,0x20f)],'text':_0x4818ba}],_0x36702a[_0x586d50(0x1f9,0x214,0x327,0x2a1)](_0xc07a38);}}else{const _0x1c448e=[],_0x28eccd=_0xc6d959['NgmGr'](_0x247b82,_0x4818ba),_0x47f2fe=[_0x376f9d[_0x586d50(0x40e,0x3de,0x3d1,0x366)+'t'],_0x28eccd,_0x376f9d['postfixPro'+'mpt']][_0x15c23(0xac,-0x1,0x85,0x95)](Boolean)[_0x586d50(0x1bb,0x297,0x2e6,0x24a)](',\x20'),_0xc9acb1={};_0xc9acb1['type']=_0xc6d959[_0x15c23(-0x59,0x5e,-0x49,0x1f)],_0xc9acb1[_0x15c23(0x224,0x16a,0x167,0x167)]=_0x47f2fe,_0x1c448e['push'](_0xc9acb1);if(_0x39bd39){if(_0xc6d959['ZKULE'](_0xc6d959[_0x586d50(0x3fb,0x2a6,0x33a,0x367)],_0xc6d959['knAWX'])){const _0x3a8c8b={};_0x3a8c8b['url']=_0x39bd39;const _0x5b3146={};_0x5b3146[_0x586d50(0x2fc,0x260,0x2c8,0x27d)]=_0xc6d959[_0x15c23(0x1d,0x98,0x93,0x22)],_0x5b3146[_0x586d50(0x1a8,0x192,0x1a0,0x20a)]=_0x3a8c8b,_0x1c448e[_0x15c23(0x53,0xa9,0x70,0xb1)](_0x5b3146),addLog(_0x15c23(-0x75,-0x11,-0x36,0x24)+'图模式：已添加待修改'+_0x15c23(0xe5,0x19f,0xea,0x128));}else{const _0x3ee973={};_0x3ee973[_0x15c23(0x14b,0x219,0x1ec,0x160)]=_0xc6d959['WYSVg'],_0x3ee973[_0x586d50(0x1e7,0x1e5,0x1d0,0x244)]=_0x438df6,_0x57a399['push'](_0x3ee973);}}const _0x2bdc66={};_0x2bdc66[_0x586d50(0x316,0x320,0x3c1,0x350)]=_0xc6d959['WYSVg'],_0x2bdc66[_0x586d50(0x25d,0x194,0x2fa,0x244)]=_0x1c448e,_0x36702a[_0x586d50(0x2d1,0x318,0x22e,0x2a1)](_0x2bdc66),_0xc6d959[_0x586d50(0x248,0x16f,0x21e,0x1fe)](addLog,_0x586d50(0x2a3,0x2c9,0x2d1,0x214)+_0x15c23(0x13b,0xd0,0xba,0x9f)+_0x47f2fe);}const _0x34e532={};_0x34e532[_0x586d50(0x31a,0x31e,0x2af,0x2ad)+'o']=_0x1a744a;const _0x5ce66c={};_0x5ce66c[_0x586d50(0x248,0x21f,0x21a,0x2d9)+'g']=_0x34e532,_0x37036e={'model':_0x1256bd,'messages':_0x36702a[_0x15c23(0x70,-0xd,0x131,0x95)](_0xa475fb=>_0xa475fb[_0x15c23(0x9c,0x107,0x10,0x54)][_0x15c23(0xb5,0x77,0x54,0x43)]>0x7*-0x448+0x1*-0xf23+0x2d1b),'config':_0x5ce66c},_0xc6d959['IAouT'](addLog,_0x586d50(0x266,0x277,0x25d,0x2c7)+'uilt\x20multi'+_0x586d50(0x351,0x295,0x2fa,0x347)+'oad\x20with\x20'+_0x37036e[_0x15c23(0x85,-0x5a,-0x4c,0x68)][_0x586d50(0x203,0x230,0x25f,0x233)]+_0x586d50(0x3e9,0x33d,0x2fb,0x345));}let _0x3027ba=_0x4086d['replace'](/\/$/,''),_0x45150f;_0x3027ba[_0x15c23(0x1eb,0xdf,0x12d,0x13b)]('/v1')||_0x3027ba[_0x15c23(0x16d,0x1c6,0x110,0x151)](_0xc6d959['ZraBB'])?_0x45150f=_0xc6d959['xMdhD'](_0x3027ba,_0x47eba8):_0x45150f=_0xc6d959[_0x586d50(0x405,0x426,0x37a,0x36c)](_0xc6d959[_0x15c23(0x9d,-0x9e,-0x76,0x17)](_0x3027ba,_0xc6d959['sLIct']),_0x47eba8);_0x45150f=_0x45150f[_0x15c23(0x5b,0x55,0x5,0x67)](/\/v1\/v1\//g,'/v1/');const _0x59e7cd=extension_settings[extensionName][_0x586d50(0x25d,0x350,0x377,0x317)];let _0x3790bf,_0x1624dd,_0xe62515;if(_0xc6d959[_0x586d50(0x244,0x343,0x2bf,0x2cd)](_0x59e7cd,_0xc6d959[_0x586d50(0x2ac,0x325,0x371,0x2f5)])){let _0x36f6fc=_0x3027ba;!_0x36f6fc[_0x15c23(0x1de,0xb4,0x13c,0x13b)](_0xc6d959[_0x15c23(0xa9,0x50,-0x3a,0x82)])&&!_0x36f6fc[_0x586d50(0x3e0,0x32a,0x316,0x341)](_0xc6d959[_0x586d50(0x27b,0x2d8,0x361,0x2cc)])&&(_0x36f6fc=_0xc6d959[_0x15c23(-0xa3,0x14,0x20,0x1c)](_0x36f6fc,_0xc6d959[_0x586d50(0x284,0x2ce,0x21e,0x272)]));_0x36f6fc=_0x36f6fc[_0x586d50(0x1c7,0x26e,0x2f9,0x257)](/\/v1\/$/,'/v1'),_0x3790bf=_0xc6d959[_0x586d50(0x268,0x1d6,0x28d,0x288)],_0x1624dd=_0xc6d959[_0x15c23(0x125,0x31,-0x1e,0x6e)](getRequestHeaders,window['token']);const _0x49a975={};_0x49a975[_0x586d50(0x230,0x201,0x18e,0x246)+_0x15c23(0xe0,0xce,0xc3,0x107)+'ce']=_0xc6d959[_0x586d50(0x2a3,0x220,0x26a,0x2c2)],_0x49a975[_0x15c23(0x143,0x1f7,0x138,0x147)]=_0x36f6fc,_0x49a975[_0x586d50(0x298,0x271,0x2bc,0x27f)+_0x15c23(0x3e,0xda,0xe2,0x8a)+'rs']=_0x586d50(0x28a,0x262,0x223,0x26a)+_0x15c23(0x82,0x84,0x56,0xff)+_0x586d50(0x2b9,0x1ff,0x267,0x27e)+_0x3e3741+'\x22',_0x49a975['model']=_0x1256bd,_0x49a975[_0x15c23(0xb1,-0x43,0x5b,0x68)]=_0x37036e[_0x15c23(0x87,0xdd,0x3e,0x68)],_0x49a975[_0x586d50(0x1f2,0x285,0x253,0x267)]=![],_0xe62515=_0x49a975;if(_0x1256bd[_0x15c23(0x148,0x10c,0x194,0x12e)](_0xc6d959[_0x15c23(0xad,0xe1,-0x70,0x3b)])){_0xc6d959['SJShK'](addLog,'[Banana]\x20I'+_0x15c23(0xc7,0x135,0x9e,0x72)+_0x586d50(0x21b,0x2bb,0x337,0x2b9)+'接请求'),_0x3790bf=_0x45150f;const _0xc8a87b={};_0xc8a87b[_0x586d50(0x3bd,0x380,0x35a,0x2fe)+'pe']=_0xc6d959[_0x15c23(0x8b,0x17b,0x21,0xb8)],_0xc8a87b[_0x586d50(0x252,0x25b,0x2f7,0x26a)+_0x586d50(0x273,0x257,0x189,0x248)]=_0x586d50(0x264,0x2cc,0x2d6,0x2ff)+_0x3e3741,_0x1624dd=_0xc8a87b,_0xe62515=_0x37036e;}_0xc6d959[_0x15c23(-0x61,-0x29,0x78,0x4a)](addLog,_0x15c23(0x10b,0xd8,0xe3,0x148)+_0x586d50(0x33a,0x296,0x289,0x2d8));}else{if(_0xc6d959[_0x586d50(0x251,0x254,0x1c0,0x279)](_0xc6d959[_0x586d50(0x2d7,0x2b8,0x225,0x2de)],_0xc6d959[_0x15c23(0xb0,0x75,0x1e6,0x124)])){_0x3790bf=_0x45150f;const _0x682f13={};_0x682f13[_0x586d50(0x33b,0x366,0x386,0x2fe)+'pe']=_0x15c23(-0x5e,0x98,0x118,0x63)+_0x15c23(0xb4,0xba,0x13d,0xa2),_0x682f13[_0x586d50(0x2dc,0x229,0x254,0x26a)+_0x15c23(0xe2,0x5,0x30,0x58)]='Bearer\x20'+_0x3e3741,_0x1624dd=_0x682f13,_0xe62515=_0x37036e,addLog(_0x15c23(0x120,0x1cd,0xca,0x148)+_0x15c23(0x65,0x1be,0x182,0x102));}else{const _0x3899a8={};_0x3899a8[_0x15c23(0x1c9,0x198,0x196,0x13e)+'on']=[],_0x3899a8[_0x586d50(0x3f2,0x2d7,0x419,0x366)+'t']='',_0x457f88=_0x90579e[_0x44d24e]||_0x3899a8;}}_0xc6d959[_0x15c23(0x1d6,0x16f,0x239,0x183)](addLog,_0x586d50(0x366,0x329,0x388,0x33e)+_0x15c23(-0x5d,0xda,-0x19,0x2b)+_0x15c23(0x14,-0xb,0x4d,0x30)+_0x3790bf),_0xc6d959[_0x15c23(-0x78,0xc9,-0x64,0x4a)](addLog,_0x15c23(-0x53,-0x2c,-0x15,0x45)+'ayload:\x20'+JSON['stringify'](_0xe62515,null,-0xd*-0x13f+-0xa16*0x1+-0x61b*0x1));try{if(_0xc6d959['HuJIP'](_0xc6d959[_0x586d50(0x27d,0x179,0x1f6,0x21f)],_0xc6d959[_0x586d50(0x29b,0x2cd,0x2cd,0x35b)])){taskQueue[_0x586d50(0x33b,0x2bc,0x25a,0x2c5)+'us'](_0x31a1b6,_0xc6d959[_0x15c23(0x88,-0x3a,0xd0,0x16)]);const _0x1758a7=await _0xc6d959[_0x15c23(0x108,0x157,0x148,0xe2)](fetch,_0x3790bf,{'method':_0xc6d959[_0x15c23(0x192,0x1aa,0x1c0,0x13a)],'headers':_0x1624dd,'body':JSON[_0x15c23(0x30,-0xb,0x6e,0x50)](_0xe62515)});if(!_0x1758a7['ok']){const _0x203d4b=await _0x1758a7['text']();throw new Error(_0x15c23(0xfb,0x173,0x72,0x117)+'t\x20failed\x20w'+'ith\x20status'+'\x20'+_0x1758a7['status']+':\x20'+_0x203d4b);}const _0x56b795=await _0x1758a7['json']();let _0x1bb4ab='';const _0xb6e546=_0x56b795[_0x586d50(0x238,0x27a,0x19a,0x203)];if(_0xb6e546&&_0xc6d959[_0x586d50(0x363,0x31b,0x2cf,0x335)](_0xb6e546[_0x15c23(0xec,0xe7,0x85,0x43)],0x103b+0x1adc+-0xe5d*0x3)){const _0x329bd9=_0xb6e546[-0x1*-0x6ad+-0x2264+0x5*0x58b][_0x15c23(0x90,0x35,0x5a,0x83)]?.[_0x586d50(0x1cc,0x24c,0x29d,0x244)];if(Array[_0x15c23(0x8d,0x8b,0xd7,0xab)](_0x329bd9))for(const _0x10b07d of _0x329bd9){if(_0xc6d959[_0x586d50(0x261,0x2bf,0x2c1,0x2cd)](_0x10b07d['type'],'image_url')&&_0x10b07d[_0x15c23(-0xd,0x24,0x2e,0x1a)]?.[_0x586d50(0x1e9,0x2c5,0x23a,0x24c)]){_0x1bb4ab=_0x10b07d[_0x15c23(0x64,-0x70,0x18,0x1a)]['url'];break;}}else{if(_0xc6d959[_0x15c23(0xfe,0x1b9,0x11b,0x16d)](typeof _0x329bd9,_0xc6d959[_0x586d50(0x274,0x1e6,0x258,0x1fa)])){if(_0x15c23(0x6e,0xba,0xa2,0x62)===_0xc6d959[_0x15c23(0x44,0x17a,0x5e,0xd8)]){const _0x436fc7=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x180787=_0x329bd9[_0x586d50(0x2c3,0x312,0x2c8,0x266)](_0x436fc7);if(_0x180787&&_0x180787[0x2*-0x779+-0x219e+0x3091]){_0xc6d959[_0x15c23(0x11b,0xb8,0x1ec,0x16f)](addLog,_0xc6d959['uGCIB']);const _0x1e1777=_0x180787[0x2385+0x23af+-0x4733];_0xc6d959['JhOpg'](addLog,_0x586d50(0x2ae,0x332,0x2a8,0x330)+_0x15c23(0x1a2,0xb3,0xdf,0x168)+_0x15c23(0x1d5,0x226,0x1d9,0x169)+_0x1e1777);try{const _0x714d77=await _0xc6d959['lnglE'](fetch,_0x1e1777);if(!_0x714d77['ok'])throw new Error(_0x15c23(0xf3,0x1a,0x10d,0xc7)+'fetch\x20imag'+_0x15c23(0xb2,0xed,0xf5,0x16e)+_0x714d77[_0x15c23(0x56,0x1a,0x121,0x9a)]);const _0x2b5c48=await _0x714d77[_0x586d50(0x2d0,0x2c0,0x2b8,0x302)](),_0x368f08=await new Promise((_0x1672f0,_0x5c4981)=>{const _0x57a14b=new FileReader();_0x57a14b[_0x30d4a0(0x35c,0x29c,0x2f0,0x329)]=()=>_0x1672f0(_0x57a14b['result']);function _0x30d4a0(_0x5c8349,_0x479b1a,_0x5f3191,_0x3b5caf){return _0x586d50(_0x3b5caf,_0x479b1a-0x1ac,_0x5f3191-0x12f,_0x5f3191- -0x2d);}function _0x2b5a49(_0x4f16de,_0x33ce0d,_0x39053d,_0x78f29b){return _0x586d50(_0x33ce0d,_0x33ce0d-0x65,_0x39053d-0x4d,_0x78f29b- -0x3c0);}_0x57a14b[_0x2b5a49(-0x1c9,-0xc7,-0x1c6,-0x167)]=_0x5c4981,_0x57a14b['readAsData'+_0x2b5a49(-0x1e,-0x118,-0x8e,-0xdb)](_0x2b5c48);});_0x1bb4ab=_0x368f08,addLog(_0xc6d959[_0x15c23(-0x50,0xd1,-0x4c,0x14)]);}catch(_0x1fa8e1){addLog('[Banana]\x20F'+_0x586d50(0x3ca,0x37d,0x38d,0x360)+_0x586d50(0x376,0x340,0x2e9,0x2f4)+_0x586d50(0x3cd,0x2e2,0x354,0x30b)+'\x20'+_0x1fa8e1[_0x586d50(0x1d8,0x2e9,0x29e,0x273)]),_0x1bb4ab=_0x1e1777,_0xc6d959['QikdR'](addLog,_0xc6d959[_0x15c23(0x11e,0xca,0x120,0x96)]);}}else _0xc6d959[_0x15c23(0x91,0x5c,0x1c0,0x108)](_0xc6d959[_0x586d50(0x317,0x255,0x33e,0x29e)],_0xc6d959[_0x15c23(0x3d,-0x1,0x121,0xae)])?(_0x493f96(_0xc6d959[_0x15c23(0x100,0x2d,0x19,0xb2)]),_0x36b99e=_0x5c89c8):_0xc6d959[_0x586d50(0x2a0,0x2e6,0x291,0x282)](addLog,_0xc6d959[_0x15c23(0x23d,0x1a5,0x23a,0x188)]);}else _0xc6d959[_0x586d50(0x393,0x2cf,0x349,0x2d4)](_0x50c999,'[Banana]\x20F'+'ailed\x20to\x20f'+_0x15c23(0xba,0x111,0x174,0x104)+'own\x20image:'+'\x20'+_0x37019f[_0x15c23(0xa9,0x16,0xd3,0x83)]),_0xbe4606=_0x3fb6e1,_0xc6d959[_0x586d50(0x32d,0x2d2,0x280,0x2bb)](_0x5a8927,_0xc6d959['ItvtS']);}}}if(!_0x1bb4ab)throw new Error(_0xc6d959[_0x15c23(0x168,0xfd,0x17c,0xdf)]);return _0xc6d959[_0x15c23(0x29,0x12c,0xa4,0xb7)](addLog,'[Banana]\x20I'+_0x15c23(0x8f,0x2a,0x1a,0xa1)+_0x15c23(0x186,0x152,0x133,0x163)+_0x15c23(0x6f,0x12d,0x9c,0xfd)),taskQueue[_0x15c23(0xf2,0x100,0x21d,0x15f)+'sk'](_0x31a1b6,!![]),currentTaskId=null,{'image':_0x1bb4ab,'change':_0xc6d959[_0x15c23(0x14a,0xde,0x16f,0x166)](_0x118138,'')};}else{_0x23f08e=_0x586d50(0x23f,0x34c,0x2a9,0x29c)+_0x15c23(0xad,0x14,-0x41,0x26)+_0x2584b2;const _0x4b24de={};_0x4b24de[_0x586d50(0x2cf,0x3f7,0x307,0x366)+'t']='';const _0x3f9864=_0xf5daad[_0x4fa44f]||_0x4b24de,_0x487ea8=[_0x3f9864[_0x15c23(0x138,0x138,0x13f,0x176)+'t'],_0x16b729[_0xc6d959['obgZi']],_0x590a39[_0xc6d959[_0x15c23(0x160,0x181,0xb7,0xf9)]],_0x39408e,_0x2bad64[_0xc6d959[_0x586d50(0x1ea,0x1d8,0x17d,0x209)]],_0x327351[_0xc6d959[_0x586d50(0x346,0x384,0x31f,0x301)]],_0x3f9864[_0x586d50(0x2d1,0x2a2,0x266,0x311)+_0x15c23(0xcd,0x17,-0x60,0x5b)],_0x3bd7c6[_0xc6d959[_0x586d50(0x217,0x192,0x1f8,0x1fc)]]][_0x586d50(0x266,0x293,0x32c,0x285)](_0x3f0a26)[_0x586d50(0x24c,0x2fb,0x28a,0x24a)](',\x20');_0xc6d959['WKSFK'](_0x29624f,_0x15c23(0xf,-0x7b,-0x4,0x4)+_0x487ea8);const _0x36c49e={};_0x36c49e['prompt']=_0x487ea8;const _0x231d97={};_0x231d97[_0x586d50(0x385,0x327,0x3b6,0x303)+'t']=0x1,_0x231d97[_0x15c23(0xf5,0x106,0x6c,0xbd)+'o']=_0x3f4759;const _0x4dd77f={};_0x4dd77f[_0x586d50(0x1e0,0x1e2,0x288,0x250)]=[_0x36c49e],_0x4dd77f[_0x15c23(0x8e,0x20,0x6e,0x36)]=_0x231d97,_0x3bcf91=_0x4dd77f,_0xc6d959[_0x586d50(0x381,0x305,0x2db,0x326)](_0x3278c6,_0x586d50(0x280,0x27a,0x2d1,0x2c7)+_0x15c23(0x1a1,0x8d,0x10f,0x12c)+_0x586d50(0x266,0x1a7,0x1e1,0x260)+_0x15c23(0x1,-0x2a,0x52,0x65)+_0x586d50(0x34a,0x3a9,0x2c8,0x340)+_0x487ea8);}}catch(_0x3a3166){if(_0x586d50(0x3c8,0x2be,0x3ed,0x348)===_0xc6d959[_0x15c23(0x62,0x84,0x75,0x3c)]){const _0x2d60fd='1|2|0|4|3'['split']('|');let _0x1933cd=0x3*0x983+-0x8*-0x10c+-0x24e9;while(!![]){switch(_0x2d60fd[_0x1933cd++]){case'0':if(_0xc6d959[_0x586d50(0x359,0x2c0,0x2d8,0x35d)](_0x3a3166[_0x586d50(0x317,0x1bf,0x263,0x273)],_0xc6d959[_0x586d50(0x2d2,0x3a1,0x347,0x306)])){}else taskQueue[_0x586d50(0x3b7,0x2e0,0x2b4,0x34f)+'sk'](_0x31a1b6,![]);continue;case'1':addLog('[Banana]\x20F'+_0x15c23(0xe2,0x13,0x97,0xbb)+':\x20'+_0x3a3166[_0x586d50(0x305,0x230,0x290,0x273)]);continue;case'2':console[_0x15c23(0x33,0xa1,0x46,0xa0)](_0xc6d959[_0x15c23(0x200,0x194,0xa2,0x153)],_0x3a3166);continue;case'3':throw _0x3a3166;continue;case'4':currentTaskId=null;continue;}break;}}else{const _0x5ec4df=_0x15c23(0x13a,0xb8,0x99,0x119)[_0x15c23(0x3d,0x47,-0xa5,0x6)]('|');let _0x3545d6=-0x2382+0x121+0x2a5*0xd;while(!![]){switch(_0x5ec4df[_0x3545d6++]){case'0':_0x503c62[_0x15c23(0xea,0x90,-0x38,0x73)](_0x3841c0[_0x586d50(0x178,0x1aa,0x2b7,0x205)+_0x586d50(0x2d2,0x2a8,0x26b,0x26c)+_0x15c23(0x1ff,0x1e1,0x1e2,0x14c)],{'id':_0x4c239f,'success':![],'error':_0xc6d959[_0x15c23(0x174,0xb2,0x78,0x116)],'prompt':_0xc6d959['VveuJ'](_0xacca3e,'')});continue;case'1':_0x5d5646=null;continue;case'2':_0xc6d959[_0x586d50(0x2c3,0x33c,0x25a,0x2bb)](_0x106ebb,'[Banana]\x20取'+_0x15c23(0xb1,-0x7d,-0x96,0x1d)+_0x15c23(0x1e1,0x221,0x21a,0x17a)+_0x2a0ec8+')');continue;case'3':_0x1b93ee=null;continue;case'4':_0x505fac=null;continue;}break;}}}}export async function bananaGenerate(_0x120d2b){const _0x3b358c={'BPfVF':_0x54a7d4(0x2ac,0x2a3,0x288,0x32c)+'cancel_ban'+_0x54a7d4(0x321,0x3cb,0x2b5,0x29e),'IqpRp':'[Banana]\x20生'+_0x54a7d4(0x3de,0x388,0x3d1,0x37c),'gYAWv':function(_0x302168,_0x2e6960){return _0x302168+_0x2e6960;},'uzlxg':_0x54a7d4(0x2f4,0x286,0x252,0x235),'CWSRI':function(_0x3bf231,_0x55d714){return _0x3bf231(_0x55d714);},'qcSFY':_0xadd1cb(0x2bf,0x2db,0x21e,0x2bd),'duVgW':function(_0x5d5f79){return _0x5d5f79();},'wkmKJ':'{修图}','tduos':function(_0x235e98,_0x3cfd3e){return _0x235e98===_0x3cfd3e;},'ltuMw':'yepDr','MFQBT':function(_0x523a6a,_0x2ba9db){return _0x523a6a!=_0x2ba9db;},'zWrEl':function(_0x491f68,_0x42acaf){return _0x491f68===_0x42acaf;},'mFETM':_0xadd1cb(0x334,0x29b,0x210,0x1f9),'UNswH':function(_0x51a2b2,_0x45533d,_0x56e70f,_0x8069e1){return _0x51a2b2(_0x45533d,_0x56e70f,_0x8069e1);},'TmvHO':function(_0x33fbf6,_0x490f40){return _0x33fbf6(_0x490f40);},'Hypxl':function(_0xc626b7,_0x9f1e77){return _0xc626b7(_0x9f1e77);},'sVKGl':'mGSiZ','UZNrP':_0xadd1cb(0x192,0x1c7,0x174,0x12d),'TCHBP':function(_0x116cc3,_0x47cef3){return _0x116cc3(_0x47cef3);}};clearLog();function _0x54a7d4(_0xea3fc,_0x27b779,_0x541ca5,_0x4d870e){return _0x4029(_0xea3fc-0xf4,_0x541ca5);}let {id:_0x3f8f5c,prompt:_0x485f86,width:_0x3f7958,height:_0x534ea0,change:_0x1ffdc6,retouchPrompt:_0x264539,retouchImage:_0x273b1f}=_0x120d2b;function _0xadd1cb(_0x30881a,_0x3c0e9a,_0x5e1a94,_0x3abb3b){return _0x4029(_0x3c0e9a- -0x4a,_0x30881a);}currentRequestId=_0x3f8f5c,currentPrompt=_0x485f86,addLog(_0x54a7d4(0x2b0,0x29e,0x2f5,0x21b)+_0x54a7d4(0x35f,0x410,0x2e5,0x370)+_0x54a7d4(0x405,0x3dc,0x44d,0x3db)+_0xadd1cb(0x1c6,0x183,0x1dd,0x120)+_0x54a7d4(0x41e,0x385,0x4b3,0x3be)+_0x3f8f5c+')');let _0x375cc7='';_0x1ffdc6?_0x375cc7=_0x1ffdc6[_0x54a7d4(0x420,0x3b7,0x450,0x416)](_0x3b358c[_0xadd1cb(0x172,0x1c0,0x1fc,0x1b0)],''):_0x375cc7=_0x485f86;if(_0x1ffdc6&&_0x1ffdc6[_0x54a7d4(0x3f2,0x389,0x3da,0x48a)](_0x3b358c[_0xadd1cb(0x1fa,0x1c0,0x1bc,0x1b5)])){_0x3b358c['CWSRI'](addLog,'Banana修图模式'+'启动');if(_0x264539)_0x3b358c[_0xadd1cb(0x1fd,0x1b8,0x208,0x11e)](addLog,_0xadd1cb(0x146,0x1a7,0x261,0x10a)+_0x264539);if(_0x273b1f)addLog(_0x54a7d4(0x3f7,0x448,0x397,0x392)+']');}try{if(_0x3b358c['tduos'](_0xadd1cb(0x16c,0x1f3,0x2b0,0x154),_0x3b358c[_0xadd1cb(0x1a3,0x250,0x1e4,0x287)])){const {image:_0x4f37c2,change:_0x378aa0}=await _0x3b358c[_0xadd1cb(0x249,0x1b8,0x163,0x233)](generateBananaImage,{'prompt':_0x485f86,'width':_0x3f7958,'height':_0x534ea0,'change':_0x1ffdc6,'retouchPrompt':_0x264539,'retouchImage':_0x273b1f});if(_0x3b358c[_0x54a7d4(0x357,0x400,0x352,0x3f7)](extension_settings[extensionName][_0xadd1cb(0x198,0x200,0x15f,0x278)],'0')){if(_0x3b358c['zWrEl'](_0xadd1cb(0x2ef,0x29b,0x21d,0x303),_0x3b358c['mFETM'])){const _0x5afbd8={};_0x5afbd8[_0x54a7d4(0x3dd,0x335,0x36a,0x472)]=_0x375cc7,await _0x3b358c[_0x54a7d4(0x412,0x3df,0x4ac,0x35b)](setItemImg,_0x485f86,_0x4f37c2,_0x5afbd8),_0x3b358c['TmvHO'](addLog,'图像已存入数据库\x20f'+_0xadd1cb(0x21d,0x188,0x1e2,0x1f5)+'\x20'+_0x485f86);if(extension_settings[extensionName][_0x54a7d4(0x3fd,0x3fa,0x451,0x356)][_0xadd1cb(0x226,0x233,0x1cb,0x2cb)])extension_settings[extensionName][_0x54a7d4(0x3fd,0x407,0x36b,0x44c)][_0xadd1cb(0x1af,0x233,0x228,0x1c8)]=_0x3b358c['gYAWv'](extension_settings[extensionName][_0x54a7d4(0x3fd,0x45b,0x46c,0x44b)][_0x54a7d4(0x371,0x33a,0x322,0x357)],0x2047+-0xd86+-0x12c0),_0x3b358c[_0xadd1cb(0x228,0x232,0x196,0x1d8)](addLog,_0x54a7d4(0x2aa,0x27d,0x2de,0x300)+_0x54a7d4(0x345,0x2c6,0x3aa,0x3c4)+extension_settings[extensionName][_0x54a7d4(0x3fd,0x455,0x474,0x4b0)][_0x54a7d4(0x371,0x354,0x311,0x2e7)]);else{if(_0x3b358c[_0xadd1cb(0x269,0x2c5,0x220,0x2fd)]===_0x3b358c['sVKGl'])extension_settings[extensionName][_0xadd1cb(0x21b,0x2bf,0x20c,0x25c)][_0xadd1cb(0x294,0x233,0x172,0x2c2)]=0x113f*-0x1+-0x1*-0x1390+-0x4*0x94,addLog(_0x54a7d4(0x2aa,0x216,0x26a,0x204)+_0xadd1cb(0x1e7,0x207,0x1fd,0x187)+extension_settings[extensionName]['banana'][_0x54a7d4(0x371,0x3f9,0x345,0x31c)]);else{if(_0x48d8b4[_0x54a7d4(0x372,0x39f,0x2ba,0x3ec)+_0x54a7d4(0x326,0x37b,0x2c6,0x32a)+_0xadd1cb(0x1ca,0x201,0x22d,0x1f0)]){const _0x2c2f1a=_0xadd1cb(0x107,0x194,0x1cd,0x200)[_0xadd1cb(0xb0,0x169,0x1c6,0x222)]('|');let _0x26fca4=0x1*-0x1e0+-0x1ae9+0x1cc9;while(!![]){switch(_0x2c2f1a[_0x26fca4++]){case'0':_0x2bf9ae[_0xadd1cb(0x2c1,0x294,0x289,0x249)](_0x283788=>{function _0x378e29(_0x5c33a9,_0xd6ebfc,_0x7a67e2,_0x329efe){return _0xadd1cb(_0x7a67e2,_0x5c33a9- -0x39c,_0x7a67e2-0x52,_0x329efe-0x1bd);}function _0xfa5be1(_0x3c6da2,_0x22ca2e,_0x214d0b,_0x519559){return _0x54a7d4(_0x519559- -0x192,_0x22ca2e-0xdc,_0x22ca2e,_0x519559-0x40);}_0xad36b7[_0xfa5be1(0x1ff,0x1cb,0x246,0x1d1)+_0x378e29(-0x19b,-0x17f,-0x217,-0x105)](_0x283788,_0xcaa42f);});continue;case'1':_0x4cb5e2[_0xadd1cb(0x1da,0x234,0x1d8,0x2d5)+_0xadd1cb(0x294,0x1e8,0x197,0x1d7)+_0x54a7d4(0x33f,0x3e1,0x32d,0x352)]=![];continue;case'2':_0x4706bf[_0xadd1cb(0x2d9,0x225,0x1b9,0x249)+_0x54a7d4(0x33f,0x3e3,0x3e0,0x33e)](_0x1094c3['GENERATE_I'+'MAGE_REQUE'+'ST'],_0xb24e4);continue;case'3':_0x2210fd[_0xadd1cb(0x205,0x225,0x246,0x17b)+'ener'](_0x3b358c['BPfVF'],_0x33d1a8);continue;case'4':_0x5322a4(_0x3b358c['IqpRp']);continue;}break;}}}}}else for(let _0x521a73=0x886*-0x3+0xe03*-0x2+0x3599;_0x521a73<=-0x679+0x7*0x422+-0x1671*0x1;_0x521a73++){_0x5d684b['Character\x20'+_0x521a73+'\x20Prompt']&&(_0x17ca63=_0x3b358c[_0x54a7d4(0x375,0x37f,0x2f0,0x334)](_0x235653+_0x3b358c['uzlxg'],_0x3b358c['CWSRI'](_0x4acbb8,_0x50bac1[_0xadd1cb(0x2db,0x29a,0x1da,0x2ed)+_0x521a73+_0x54a7d4(0x31f,0x33b,0x2fe,0x385)])));}}else _0x3b358c[_0x54a7d4(0x361,0x322,0x2f8,0x2fc)](addLog,_0xadd1cb(0x1d7,0x1f4,0x184,0x240)+'库');const _0x1f149b={};_0x1f149b['id']=_0x3f8f5c,_0x1f149b[_0xadd1cb(0x237,0x2a9,0x2c6,0x32a)]=!![],_0x1f149b['imageData']=_0x4f37c2,_0x1f149b[_0x54a7d4(0x2cb,0x27b,0x36f,0x2ba)]=_0x485f86,_0x1f149b[_0xadd1cb(0x1e2,0x29f,0x1ea,0x2e6)]=_0x375cc7,eventSource[_0x54a7d4(0x314,0x2ee,0x305,0x2ee)](EventType[_0x54a7d4(0x2b6,0x326,0x2bf,0x21e)+'MAGE_RESPO'+_0x54a7d4(0x3ed,0x421,0x352,0x3b9)],_0x1f149b),_0x3b358c[_0x54a7d4(0x370,0x421,0x428,0x3e0)](addLog,_0x54a7d4(0x322,0x366,0x33a,0x38c)+_0x54a7d4(0x362,0x355,0x321,0x369)+_0xadd1cb(0x179,0x1ae,0x256,0x1bd)+_0xadd1cb(0x15a,0x206,0x2b5,0x1a0)+':\x20'+_0x3f8f5c);}else{const _0x3eaa4a={};_0x3eaa4a['role']=_0x3b358c[_0x54a7d4(0x2cf,0x2a2,0x265,0x2a7)],_0x3eaa4a['content']=_0x5bdbe9,_0x13bd5f['push'](_0x3eaa4a);}}catch(_0x5c2923){if(_0x3b358c[_0x54a7d4(0x3b5,0x37d,0x3dd,0x464)]===_0x54a7d4(0x305,0x38c,0x276,0x26d)){const _0x4a9f40=_0x54a7d4(0x3a2,0x2f5,0x3b9,0x3ed)+_0xadd1cb(0x234,0x22f,0x2c3,0x16e)+'failed\x20for'+_0xadd1cb(0x32a,0x2a6,0x30e,0x362)+_0x3f8f5c+':\x20'+_0x5c2923['message'];_0x3b358c[_0x54a7d4(0x37a,0x40e,0x333,0x438)](addLog,_0x4a9f40),console['error'](_0x4a9f40);const _0x12c2a2={};_0x12c2a2['id']=_0x3f8f5c,_0x12c2a2[_0xadd1cb(0x276,0x2a9,0x245,0x223)]=![],_0x12c2a2[_0x54a7d4(0x341,0x2c4,0x2d9,0x303)]=_0x5c2923['message'],_0x12c2a2['prompt']=_0x485f86,eventSource[_0x54a7d4(0x314,0x384,0x301,0x2d4)](EventType['GENERATE_I'+_0xadd1cb(0x269,0x1df,0x148,0x1ac)+_0xadd1cb(0x24c,0x2af,0x28f,0x337)],_0x12c2a2),_0x3b358c[_0xadd1cb(0x260,0x232,0x2e3,0x1c1)](addLog,_0x54a7d4(0x322,0x282,0x350,0x368)+'mitted\x20fai'+_0xadd1cb(0x330,0x298,0x23c,0x212)+'nse\x20for\x20ID'+':\x20'+_0x3f8f5c);}else _0x116f4a[_0x54a7d4(0x372,0x3d1,0x431,0x430)+'BananaList'+'ener']=!![],_0x3b358c['duVgW'](_0x287ac3);}}function handleCancelBananaTask(_0x33183f){const _0x1567bf={};_0x1567bf[_0x5c714d(0x8b,0x8c,0x1a1,0x132)]=function(_0x2f8977,_0x3cf86d){return _0x2f8977||_0x3cf86d;};const _0x2446bd=_0x1567bf,{taskId:_0x38d05e}=_0x33183f;function _0x57d642(_0xfb0bef,_0x14167d,_0x3d8959,_0x5f343c){return _0x4029(_0x3d8959- -0x34,_0x14167d);}function _0x5c714d(_0x2a4ac4,_0x3db64e,_0x5c779b,_0x4bf84c){return _0x4029(_0x4bf84c- -0x1fc,_0x5c779b);}addLog(_0x5c714d(-0xe3,-0x6b,0x60,-0x3e)+_0x5c714d(0xc,0x150,0xc0,0xcd)+_0x5c714d(0x9f,0xbe,-0x4c,0x4a)+_0x38d05e+')'),currentTaskId===_0x38d05e&&currentRequestId&&(addLog(_0x5c714d(0x29,-0x51,-0x9e,-0x2e)+_0x57d642(0x1be,0x205,0x196,0x14d)+_0x57d642(0x355,0x275,0x2f3,0x27a)+currentRequestId+')'),eventSource[_0x5c714d(0x5c,-0x55,0x7b,0x24)](EventType[_0x5c714d(0x84,0x58,0xb,-0x3a)+_0x5c714d(-0x4b,0xda,-0x5e,0x2d)+'NSE'],{'id':currentRequestId,'success':![],'error':_0x57d642(0x223,0x20c,0x1b9,0x20b),'prompt':_0x2446bd['hZTvL'](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function initializeBananaListener(){function _0x427d6b(_0x1cb689,_0x161727,_0x2f9000,_0x5364ab){return _0x4029(_0x1cb689- -0x4,_0x161727);}function _0x87fb5b(_0x336e9d,_0x4b759a,_0x17c9f4,_0xa8290f){return _0x4029(_0x4b759a- -0xec,_0x17c9f4);}const _0x3f3145={'PimZO':_0x87fb5b(0x1d,0xcc,0x11f,0x18d)+_0x87fb5b(0xdf,0x118,0xe0,0x19e)+_0x87fb5b(0x144,0x141,0xf5,0x1fd),'dFsIQ':function(_0x65ca3a,_0x4e3535){return _0x65ca3a(_0x4e3535);},'pRbRU':_0x427d6b(0x2cf,0x253,0x276,0x292)+_0x427d6b(0x1e1,0x1d6,0x1ae,0x148)};eventSource['on'](EventType[_0x87fb5b(0x23,0xd6,0x4b,0x95)+_0x87fb5b(0x23b,0x1bc,0x1e5,0x246)+'ST'],bananaGenerate),eventSource['on'](_0x3f3145[_0x87fb5b(0x170,0x1e3,0x183,0x17f)],handleCancelBananaTask),_0x3f3145[_0x427d6b(0x1f7,0x1e4,0x217,0x259)](addLog,_0x3f3145[_0x427d6b(0x2d3,0x2c9,0x307,0x385)]);}export async function replaceWithBanana(){const _0x341c18={'VqIKK':function(_0x4694a9,_0x2ca3d3){return _0x4694a9+_0x2ca3d3;},'RdwhP':_0x361154(0x437,0x38a,0x43a,0x311),'HjHvb':function(_0x5902ab,_0x30084e){return _0x5902ab===_0x30084e;},'rNZYr':'IhUuu','IrDLt':function(_0x5e3c3e,_0x1ad91c){return _0x5e3c3e(_0x1ad91c);},'KDTSH':function(_0x53d71f,_0xffd14){return _0x53d71f==_0xffd14;},'TaqDk':_0x1cd7fc(-0x109,-0xcd,-0xc4,-0x128),'nCEoR':function(_0x37632e,_0x1e281b){return _0x37632e===_0x1e281b;},'jgbHu':_0x1cd7fc(-0x1b9,-0x126,-0x13d,-0xbd),'VqnnQ':function(_0x898dd2){return _0x898dd2();},'BWJNQ':_0x361154(0x338,0x39c,0x2eb,0x3f8),'nYDqs':_0x1cd7fc(-0x173,-0x1f5,-0x215,-0x26f)+'cancel_ban'+_0x361154(0x305,0x363,0x373,0x382),'NArpa':function(_0x5d2f71,_0x24ec7c){return _0x5d2f71(_0x24ec7c);},'AasHF':_0x1cd7fc(-0x211,-0x23b,-0x1b5,-0x268)+_0x1cd7fc(-0x15a,-0x129,-0xe3,-0xe5)};function _0x361154(_0x4b0741,_0x40c93d,_0x897162,_0x302b24){return _0x4029(_0x40c93d-0x136,_0x302b24);}function _0x1cd7fc(_0xd26599,_0x1390b9,_0x10461d,_0x3f1468){return _0x4029(_0x10461d- -0x3cd,_0x1390b9);}if(_0x341c18[_0x361154(0x2ee,0x32a,0x3b9,0x267)](extension_settings[extensionName][_0x1cd7fc(-0x67,-0xe7,-0x102,-0x11b)],_0x341c18[_0x1cd7fc(-0xd9,-0x11d,-0x18d,-0x14b)])){if(_0x341c18['nCEoR'](_0x341c18[_0x1cd7fc(-0x1cd,-0xf2,-0x1ac,-0x16b)],_0x1cd7fc(-0x1e6,-0x1d7,-0x13d,-0x131)))!window[_0x1cd7fc(-0xc0,-0x168,-0x14f,-0x14f)+'BananaList'+_0x361154(0x38a,0x381,0x377,0x345)]&&(window['initialize'+_0x1cd7fc(-0x201,-0x221,-0x19b,-0xf6)+'ener']=!![],initializeBananaListener()),_0x341c18['VqnnQ'](initializeImageProcessing);else{if(_0x12cd51){const _0x27d289=_0x21ae65[_0x1cd7fc(-0x16a,-0xa5,-0xbb,-0xb7)](_0x3e7b1b,arguments);return _0x5760cc=null,_0x27d289;}}}else _0x341c18['HjHvb'](_0x341c18[_0x1cd7fc(-0x6f,-0x73,-0xc5,-0xc7)],_0x361154(0x376,0x39c,0x444,0x37d))?window[_0x361154(0x31d,0x3b4,0x46c,0x33d)+_0x1cd7fc(-0x258,-0x228,-0x19b,-0x1d6)+_0x361154(0x2fd,0x381,0x345,0x3e9)]&&(eventSource['removeList'+_0x1cd7fc(-0xdc,-0x19f,-0x182,-0x1c5)](EventType[_0x1cd7fc(-0x1fc,-0x194,-0x20b,-0x22a)+_0x1cd7fc(-0x12c,-0x1a3,-0x125,-0x8b)+'ST'],bananaGenerate),eventSource['removeList'+_0x1cd7fc(-0x19f,-0x23d,-0x182,-0x148)](_0x341c18[_0x361154(0x3e3,0x369,0x3e4,0x3c6)],handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x361154(0x457,0x414,0x4b1,0x48b)](_0x23f030=>{function _0x4b8f11(_0x17c1fd,_0x49ef8f,_0x218932,_0x1c0bd8){return _0x361154(_0x17c1fd-0x14d,_0x218932- -0x226,_0x218932-0x133,_0x49ef8f);}function _0xe11180(_0x54d021,_0x4a8169,_0x1e4aa5,_0x219347){return _0x1cd7fc(_0x54d021-0x11b,_0x54d021,_0x219347-0x703,_0x219347-0x133);}_0x341c18['HjHvb'](_0x341c18[_0xe11180(0x585,0x5f6,0x5d5,0x59d)],_0x4b8f11(0x1a0,0x1c9,0x1dc,0x1cd))?_0x4ea24a=_0x341c18[_0x4b8f11(0x2b9,0x19a,0x243,0x239)](_0x350ad2+_0x341c18[_0x4b8f11(0xcc,0x50,0xf0,0x91)],_0x703568):eventSource['removeList'+'ener'](_0x23f030,bananaGenerate);}),window['initialize'+'BananaList'+'ener']=![],_0x341c18['NArpa'](addLog,_0x341c18[_0x1cd7fc(-0x1db,-0x82,-0x131,-0xe9)])):_0x341c18[_0x361154(0x337,0x3ab,0x326,0x396)](_0x402fa5,_0x1cd7fc(-0x213,-0x1e8,-0x18f,-0x129)+'库');}