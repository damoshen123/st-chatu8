(function(_0x5e396f,_0x1cb35a){const _0x2aae22=_0x5e396f();function _0x4b7e75(_0x4c5cf7,_0x5138fa,_0x29101f,_0x3259de){return _0x7807(_0x29101f-0x27e,_0x5138fa);}function _0x12ab56(_0xc01948,_0x32d3fd,_0x556c09,_0x21eb93){return _0x7807(_0x21eb93-0x95,_0xc01948);}while(!![]){try{const _0x71238d=-parseInt(_0x12ab56(0x1bb,0x264,0x2b9,0x23f))/(0x1*0xf69+0xb29+0x1a91*-0x1)*(-parseInt(_0x12ab56(0x228,0x25f,0x29d,0x2ab))/(0x155*-0x10+-0x484+0x2*0xceb))+parseInt(_0x12ab56(0x252,0x1d7,0x2de,0x269))/(0x131*-0x5+-0x2*0x211+0x50d*0x2)*(-parseInt(_0x4b7e75(0x4c0,0x515,0x470,0x421))/(0xd81+0x9*-0x1cd+0x57*0x8))+parseInt(_0x4b7e75(0x4a8,0x385,0x41d,0x3ee))/(-0x1bb*-0x10+-0x9*0xb9+0x1*-0x152a)*(-parseInt(_0x4b7e75(0x45d,0x521,0x513,0x544))/(-0x194*-0xd+0xc*-0x1c1+0x8e))+parseInt(_0x12ab56(0x206,0x2a1,0x2da,0x228))/(0x19a0+0x3*0x351+-0x238c)+parseInt(_0x12ab56(0x1d9,0x214,0x1a5,0x25b))/(-0xfe*-0x19+-0x1c1*-0xf+-0x3315)*(-parseInt(_0x4b7e75(0x48d,0x46b,0x4d2,0x455))/(0x19*0xe5+-0x9d0+0x6*-0x216))+-parseInt(_0x12ab56(0x306,0x2b8,0x275,0x267))/(0x802+-0x1*-0x257f+-0x2d77)+parseInt(_0x12ab56(0x298,0x2f8,0x304,0x2df))/(0x2353*-0x1+-0x1*-0xf69+0x13f5);if(_0x71238d===_0x1cb35a)break;else _0x2aae22['push'](_0x2aae22['shift']());}catch(_0xe1c1fd){_0x2aae22['push'](_0x2aae22['shift']());}}}(_0x11ce,-0x746ad+-0x53*-0x935+0xac30a));const _0x2c5967=(function(){const _0x411a97={};_0x411a97['CVvDo']=_0x1a2f27(0x2b9,0x2f4,0x24b,0x299),_0x411a97[_0x1784b6(-0xa2,-0xed,-0x116,-0x61)]='(((.+)+)+)'+'+$',_0x411a97[_0x1a2f27(0x169,0x172,0x1a9,0xd9)]=function(_0x31bd44,_0x14aae9){return _0x31bd44!==_0x14aae9;},_0x411a97[_0x1784b6(0x3f,-0x38,-0x54,-0x25)]=_0x1784b6(-0x21,-0x56,-0xa5,-0xad);function _0x1a2f27(_0x48c379,_0xbce1f1,_0x1f6596,_0x1cd232){return _0x7807(_0x48c379- -0x38,_0x1cd232);}_0x411a97[_0x1784b6(-0x64,-0x164,-0xc1,-0x1b)]=_0x1784b6(-0x16b,-0x96,-0x118,-0x7f);const _0x1651fb=_0x411a97;let _0x1a345b=!![];function _0x1784b6(_0x5a9511,_0x360945,_0x2f59b4,_0x384b45){return _0x7807(_0x2f59b4- -0x34c,_0x5a9511);}return function(_0x553be3,_0xd700d7){function _0x2850ac(_0x2cec78,_0x3b3557,_0x2cdf84,_0x16d11c){return _0x1784b6(_0x2cdf84,_0x3b3557-0x1c,_0x16d11c-0x4be,_0x16d11c-0x10f);}const _0x45c106={'cUCkA':_0x1651fb['CVvDo'],'dNXed':function(_0x1a5876,_0x5ab5f3){return _0x1a5876(_0x5ab5f3);},'OiQoT':function(_0x119d7b,_0x5e7b15){return _0x119d7b===_0x5e7b15;},'Zemqz':_0x1651fb[_0x2850ac(0x2ff,0x326,0x308,0x3a8)]};function _0x23878d(_0x1f8db7,_0x54a596,_0x539d87,_0x3bd031){return _0x1a2f27(_0x54a596-0x356,_0x54a596-0x1bd,_0x539d87-0x30,_0x1f8db7);}if(_0x1651fb[_0x23878d(0x4ea,0x4bf,0x4e5,0x4ef)](_0x1651fb[_0x2850ac(0x3c0,0x3d6,0x4d3,0x46a)],_0x1651fb['TXRsK'])){const _0x48724e=_0x1a345b?function(){function _0x11429c(_0xf3b3f4,_0xd1371,_0x3eb4a1,_0x48e222){return _0x2850ac(_0xf3b3f4-0x15b,_0xd1371-0x1e,_0xd1371,_0x48e222- -0x2bc);}function _0xda7f39(_0x57b722,_0x53cc5f,_0x5c74c7,_0x24f940){return _0x2850ac(_0x57b722-0xe7,_0x53cc5f-0x11e,_0x5c74c7,_0x24f940- -0x3b8);}if(_0x45c106[_0xda7f39(0x2d,-0x25,0xf,0x64)](_0xda7f39(-0x41,0xab,0x5a,0x5f),_0xda7f39(-0x138,-0x2a,-0x157,-0xab))){const _0x58bcd9=_0x45c106[_0x11429c(0x15e,0x68,0x68,0xda)]['split']('|');let _0x1a6ae8=0x1*-0x8d5+0x9f2+-0x11d;while(!![]){switch(_0x58bcd9[_0x1a6ae8++]){case'0':_0x45c106[_0xda7f39(0x17,-0x3d,0x43,0x3f)](_0x1eca18,_0x11429c(0x80,0xe8,0xd2,0xb7)+_0xda7f39(0x1c,-0x6b,-0xdd,-0x26));continue;case'1':_0x11c17d[_0xda7f39(-0x24,-0x5c,-0x91,0x27)+'ener'](_0xda7f39(0xce,-0xb,0x30,0x7f)+_0xda7f39(0xa,-0xc6,-0x34,-0x9e)+_0x11429c(0xb8,0x169,0x1ba,0x172),_0x39768e);continue;case'2':_0x59aec4[_0x11429c(0x86,0x9b,0x97,0x9f)](_0x2b984d=>{function _0x5cc4e2(_0x2062b6,_0x503fda,_0xe6b5c4,_0x5b4b87){return _0xda7f39(_0x2062b6-0x1f,_0x503fda-0x6,_0x5b4b87,_0x503fda-0x2a5);}function _0x4973cb(_0x2d0804,_0x5a8f48,_0x21b713,_0x3fbd11){return _0xda7f39(_0x2d0804-0x1da,_0x5a8f48-0x97,_0x3fbd11,_0x2d0804-0x219);}_0x5077a8[_0x5cc4e2(0x319,0x2cc,0x2c8,0x210)+_0x5cc4e2(0x2b5,0x2fd,0x2f0,0x2b7)](_0x2b984d,_0x3ad375);});continue;case'3':_0x336921[_0xda7f39(0x27,0x7e,0x72,0x27)+'ener'](_0x129571[_0xda7f39(-0x117,-0x6,-0xbe,-0x7f)+_0xda7f39(0xc8,0x6c,0x14,0x6e)+'ST'],_0x3375a0);continue;case'4':_0x3e4ab5[_0xda7f39(-0x121,-0xbb,-0x7a,-0x73)+_0x11429c(0x10a,0x183,0x4d,0xe8)+_0xda7f39(0x17,0x87,0x6c,0x58)]=![];continue;}break;}}else{if(_0xd700d7){const _0x2618cc=_0xd700d7[_0xda7f39(-0x3b,0x10,0xf4,0x74)](_0x553be3,arguments);return _0xd700d7=null,_0x2618cc;}}}:function(){};return _0x1a345b=![],_0x48724e;}else return _0x5d5ea1[_0x23878d(0x580,0x59c,0x5db,0x57a)]()[_0x23878d(0x57a,0x4c7,0x4b4,0x51c)]('(((.+)+)+)'+'+$')['toString']()['constructo'+'r'](_0x1da663)[_0x2850ac(0x297,0x276,0x351,0x31b)](_0x45c106[_0x2850ac(0x2fa,0x27c,0x2b0,0x304)]);};}()),_0x49f14f=_0x2c5967(this,function(){const _0x19e8b9={};function _0x9fef97(_0x386330,_0x5817c6,_0x5f3404,_0x2dbe21){return _0x7807(_0x5f3404-0x2b4,_0x386330);}function _0xa2427(_0x2564b9,_0x8e9a0,_0x20239c,_0x1ede42){return _0x7807(_0x20239c-0x20a,_0x1ede42);}_0x19e8b9[_0xa2427(0x461,0x3ec,0x3c4,0x425)]='(((.+)+)+)'+'+$';const _0x1204d0=_0x19e8b9;return _0x49f14f[_0xa2427(0x4fb,0x3fb,0x488,0x4c0)]()[_0x9fef97(0x3b9,0x41c,0x45d,0x4e6)](_0x1204d0[_0xa2427(0x42d,0x463,0x3c4,0x42d)])[_0xa2427(0x3d0,0x48c,0x488,0x3ea)]()[_0x9fef97(0x531,0x430,0x4c5,0x500)+'r'](_0x49f14f)[_0xa2427(0x351,0x40a,0x3b3,0x3c1)](_0x1204d0[_0x9fef97(0x462,0x3f0,0x46e,0x441)]);});_0x49f14f();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';function _0x7807(_0x4bff69,_0x3b63a3){_0x4bff69=_0x4bff69-(-0x1124+-0x1*0x7dc+0x1a83);const _0x5b3580=_0x11ce();let _0x46abf1=_0x5b3580[_0x4bff69];if(_0x7807['GeLUha']===undefined){var _0xf15832=function(_0x398bde){const _0x25ff07='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x13a7d6='',_0x1e6a8a='',_0x1b6e2b=_0x13a7d6+_0xf15832;for(let _0x44b5f6=-0x20ed+0xee3+0x120a,_0x26d6ff,_0x4ee915,_0x5d3ef8=0x92*0x10+0x16ba+-0x6*0x54f;_0x4ee915=_0x398bde['charAt'](_0x5d3ef8++);~_0x4ee915&&(_0x26d6ff=_0x44b5f6%(0x239+-0x27f*-0x2+-0x1*0x733)?_0x26d6ff*(0xd*0xc9+-0x1a*-0x77+-0x160b)+_0x4ee915:_0x4ee915,_0x44b5f6++%(-0x106+0x870+-0x766))?_0x13a7d6+=_0x1b6e2b['charCodeAt'](_0x5d3ef8+(0x1*-0x1dba+0x2234+0x10*-0x47))-(0x9a4+0x3*-0xea+-0x6dc)!==0x1e8d+-0xc34+0x1259*-0x1?String['fromCharCode'](-0xec8+0x20*-0xa3+0x1*0x2427&_0x26d6ff>>(-(-0x2439+-0x10f+0x254a)*_0x44b5f6&0xf59+-0x1*0xfd3+-0x40*-0x2)):_0x44b5f6:0x9b2*-0x3+0x263*-0x6+0x2b68){_0x4ee915=_0x25ff07['indexOf'](_0x4ee915);}for(let _0x734876=0xd9c+0xf*0x139+-0x1ff3*0x1,_0x24b8f9=_0x13a7d6['length'];_0x734876<_0x24b8f9;_0x734876++){_0x1e6a8a+='%'+('00'+_0x13a7d6['charCodeAt'](_0x734876)['toString'](-0x949*-0x1+-0x3bf*0x1+-0x57a))['slice'](-(-0xb0*-0x9+-0x21c9*-0x1+0x1*-0x27f7));}return decodeURIComponent(_0x1e6a8a);};_0x7807['chFyks']=_0xf15832,_0x7807['fbKNBK']={},_0x7807['GeLUha']=!![];}const _0x12b155=_0x5b3580[0x81d*0x4+-0xd30+-0x1344],_0xbd999d=_0x4bff69+_0x12b155,_0x1fb883=_0x7807['fbKNBK'][_0xbd999d];if(!_0x1fb883){const _0x2c467c=function(_0x508b05){this['oeCObM']=_0x508b05,this['fXbgnQ']=[0x2*0x8bd+-0x211b+0xfa2,-0xe*0x23+-0x1eb8+0x20a2,-0x23c6+-0x1051*-0x1+0x1375],this['XTzBBY']=function(){return'newState';},this['OBoBZV']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['LVMYSo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2c467c['prototype']['tjihXH']=function(){const _0x39a4cb=new RegExp(this['OBoBZV']+this['LVMYSo']),_0x13803a=_0x39a4cb['test'](this['XTzBBY']['toString']())?--this['fXbgnQ'][-0x1097*-0x2+-0x2f*-0x1f+0x5*-0x7c6]:--this['fXbgnQ'][0x3d7*-0x3+-0x107f+-0x4*-0x701];return this['qIkCpv'](_0x13803a);},_0x2c467c['prototype']['qIkCpv']=function(_0x49adcc){if(!Boolean(~_0x49adcc))return _0x49adcc;return this['COzfbt'](this['oeCObM']);},_0x2c467c['prototype']['COzfbt']=function(_0x3f4641){for(let _0x378434=-0x199d+0x811+-0x8c6*-0x2,_0x4b850b=this['fXbgnQ']['length'];_0x378434<_0x4b850b;_0x378434++){this['fXbgnQ']['push'](Math['round'](Math['random']())),_0x4b850b=this['fXbgnQ']['length'];}return _0x3f4641(this['fXbgnQ'][0xb8c+-0x23ec+0x1860]);},new _0x2c467c(_0x7807)['tjihXH'](),_0x46abf1=_0x7807['chFyks'](_0x46abf1),_0x7807['fbKNBK'][_0xbd999d]=_0x46abf1;}else _0x46abf1=_0x1fb883;return _0x46abf1;}import{initializeImageProcessing}from'./iframe.js';function _0x11ce(){const _0x1af25c=['zxiG','nhWXFdn8mhWY','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','CNfUqKq','qKL4A1y','yxnZAxn0yw50','sKz0AuS','txb1ueO','B3vUzcbTyxrJAa','mtm1mZq4mtHwsw5Lvw8','qKfoqu5b','Aw5ZDgfUy2vZ','DwvZDcb0BZOG','rKnQExi','CNzyAxy','C3rHDhvZ','BgvUz3rO','yxnRsuq6ia','qwrSswi','mteXodDWBLLIvey','w0jHBMfUyv0GuG','sMrqwu4','sMDuq3u','sg51swK','yxjRzg93BIbPBq','yuPouNi','BvPqu2W','w0jHBMfUyv0GrG','55sO6yws6AAg5lUJ55cg5QIH5BYp','CvnSuwK','w0jHBMfUyv0Gra','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','C2LUzYbKAxjLyW','y1rqA3i','wer0rxy','DLbSuMK','C3vIC3rYAw5N','C3rHCNrZv2L0Aa','C3rYAw5N','5zco572U5yMn','y2fJAgu','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','w0jHBMfUyv0GuW','5lIT55QeihbYB21WDooaGG','CMvTB3zLtgLZDa','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','Der3wKu','Cg9ZDgzPEfbYBW','Aw5JBhvKzxm','sLfuB3K','5zco572U5zco','iIbMCM9TihbYzq','zxrJAcbLCNjVCG','rvHrrMi','C2uGzgLKig5VDa','CgLZr0O','mhW0Fdf8mNWZ','AK1nDKK','wMjks0i','ANnVBG','u3b5Bee','Dg9tDhjPBMC','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','CNvUBMLUzW','zeXqyKu','vwXntNa','Dw5RtuG','55sO5l+U5zU+6Ake6k6+oIaI','ze5yzwq','DcbMywLSzwqGDW','q2HHCMfJDgvYia','w0jHBMfUyv0Grq','CurisfG','rfniDe4','vfHsC0S','vLDJEuu','yMXVyG','5PYa5zco572U','BMPtv1q','Aw5NihrYAwDNzq','Bw9KzwW6ia','AxrOihn0yxr1CW','s215uu4','y3vZDg9Tx2LUyW','nMXxBK95Aq','zxjYB3i','y2zNAw1NxW','BIbWyxLSB2fKia','shbACeu','BwvZC2fNzq','w0jHBMfUyv0GrW','55sO5lQgihVKV67LM759ioAGH+IVHG','rwfHugS','zw5LCG','Aw1Hz2vU','y29UDgvUDa','AM9PBG','qwPoqMq','ALrosLe','wgHXtuG','t2LguhK','ANLiu24','t1LKv3e','rurrCKm','A2TLzMq','t2LrB1q','ywDLigDLBMvYyq','Cuf6Afq','CgPhu1q','55Qe5zU+54Mh','zgf0ytPPBwfNzq','rhfOAe8','mxWWFdn8mNW0','5Q2J6z2I5O+q56s66k+noIa','Dgv4Da','tufhrv9srvfvrq','zw5LCMf0Aw9Uia','Bwf0y2G','BwvZC2fNzxm','C2fTCgXLq291BG','rMzsz2S','yxbWBhK','yKHlzg4','yw5Hx3rHC2S','DxjS','vMHpwNC','zMXHDa','ztOG','tfnns0u','w0jHBMfUyv0G5Ps2','yxrLzcbZDwnJzq','qMTgy1u','C3rFy2HHDhu4xW','w0jHBMfUyv0Gtq','y1j4s1e','qxv0Ag9YAxPHDa','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','t2PnwMu','zK9yzey','u2nLBMuGq29TCa','tgjxqMG','Cwvfyva','5zon5BQuicHjrdOG','D3rcwvi','DcbvuKWGyxmGzG','zfPfwLe','BwfNzsbPBIbpCa','CwLVCNa','BffYuKe','zMv0y2GGAw1HzW','zMLSDgvY','ue9tva','w0jHBMfUyv0G5l+U','AwXrBfe','refOCxm','EM9sCKO','rgfOs1i','CLPxvgC','zwnLAxzLzcbPBq','zw5KAw5NihjLCq','5BYa5AEliejHBMfUyEEuNW','AgLSEwG','DhjPBq','DxbKyxrLu3rHDa','r0rPr2O','tufhrv9srvnqtW','C2P5s0e','BvbkuLu','uMz5C1K','DNPIwK0','zxrPB25FC291CG','ChjVBxb0','Aw9U','uwrpz08','CIbWCM9TChq6ia','tuTQugC','m3WXFdj8nhWW','kerPDMLKzv9YBW','lI4U','uxHxyu0','B3nPDgLVBG','ig1LC3nHz2vZlG','EuXAr08','B2zrA2i','BMHjwLC','l3yXyMv0ys9TBW','zxnWB25ZzsbJBW','CM9Szq','uMTrs1K','rMfPBgvKihrVia','DwLSDcbjBwfNzq','w0jHBMfUyv0G5zcV','vKPvCvq','igLTywDLlG','BhvKzv9OzwfKzq','55sO5lQo55sF5OIq55QevgfNoIa','vvjm','DhDnAwm','l2fWAs9IywnRzq','5l+U5zU+5OYh5lUKoIa','wMvTCxO','mZi0nZKYm0P5thL6tq','u2vTBNe','yvfrzMe','zw1PDa','rLLVz3O','ihWG','s0rbu3K','zxrLy3rLzcbnyq','tNr4seC','Bw9KzwW','ChvZAa','C3qGkeLeoIa','mtiYnJeWnuzjA1vnza','Dg9mB3DLCKnHCW','uLHuD2C','tM95yNK','BwL0DgvKihn1yW','DxnLCG','yMfUyw5H','yMrMug0','5O6L6k+35Rgc','y2fUy2vSx2jHBG','C2vHCMnO','nte5nLvqrKLivG','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','swv1CLi','l3yXlW','CM5dzum','Bxb0','uLfArvq','zeDMvu8','D2L0AcbWCM9TCa','uKX6uLe','AxnbCNjHEq','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','ignVBNrHAw4GAq','CgfYyw1LDgvYCW','tLrerLO','yMfUyw5Hq2HHCG','ANjUtgW','qMvHCMvYia','wKfPueS','y29UDMvYC2f0Aq','t2vbBM0','qNryBKe','l2DLBMvYyxrL','sgLuy2e','E+s/RUwBVN0','zND1uge','rhf5r2G','DxzLtuK','mJC2ogjiAvH4vG','r0vorvjbvevFsq','zgvSCY8','DfzOBMO','EKjOB0S','Bw9Kzq','yu9wC2G','DxjJBhO','B25SB2fKzw5K','BNnLigzVCIbjra','C3rYzwfT','zML4zwrqCM9TCa','mZyWmJGZmenWtw5tzW','Aw5PDgLHBgL6zq','m1nIrMPmCa','BgvZktOG','DwnJzxnZzNvSBa','txzkDKK','BI9QC29U','5lU75yQH5BEY5y+w5RAi','tLnf','mNW0Fdb8m3WX','y1b3yMm','CvHPwKG','ExPHsMy','C2v0ici','zLDywhi','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','w0jHBMfUyv0Gsq','wu9yzvq','q0TytgW','w0jHBMfUyv0G5l2/','BMrZl2nOyxqTyW','yw9My08','zM9YrwfJAa','u0vHqxC','BwfW','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','ieLeia','C3vJy2vZCW','Aw1Hz2vdB25MAq','CMvHzefZrgf0yq','w0jHBMfUyv0Gua','mJq3nZa5mKDIvNrjuW','CMvWBgfJzufSBa','DgLVBIbYzxf1zq','EM56yxO','zg5ODvy','shbbv24','yMfUyw5HioEuN+wBVUs6IW','tMHZq3i','rLDjyNa','mNW0Fdn8mxWW','yxbWBgLJyxrPBW','Awjfsem','CMvWBgfJzq','BxrUueW','seDNyve','w0jHBMfUyv0G55sF','wvLMq3e','y29TCgXLDgvuyq','Bg5evu4','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','ywDLifvstdOG','w0jHBMfUyv0G5y+w','ExfTq1u','AxLnuLK','uMXuy3q','tev6BNC','Aw1Hz2u','CxvRCw0','z2uGzM9YBwf0la','DeHYrgG','y2XPzw50','y29UC3rYDwn0BW','y2HHBMDL','v3jAEgG','ywLSzwqGDg8GzG','yNzkvMy','mtq4vhzltMrc','AML1z3vHBG','txLvsfa','v3PfquS','qvbjihjLC3bVBG','w0jHBMfUyv0GqG','zK1HwNm','BwL0DgvKigzHAq','y2HVAwnLCW','B1HdrMW','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','BhvYzsbYzxnWBW','ver3r2G','EsbJB252zxj0zq','y1vdA0e','Aw1Hz2vFDxjS','C3DvswC','y2LZAhu','zMzNz0q','yxnWzwn0uMf0Aq','C3rYAw5NAwz5','zhbsCxC','zw5bssbMB3jTyq','v0LiweS','5yMn572U5zco','yxLSB2fKoIa','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','Aw1Hz2veyxrH','qMfUyw5HtgLZDa','Aw1Hz2vjza','ELzKtwi','DhLWzq','te9Vzu4','wfrxqwm','y3vZDg9T','sLjHu2W','Cu9LyKi','zMfPBgvKigzVCG','zw5KC1DPDgG','CxHtEKm','y1verMq','C3bSAxq','ifbYB21WDa'];_0x11ce=function(){return _0x1af25c;};return _0x11ce();}import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0xcedc53){const _0x45d6ac={'JqNBl':_0x55c22b(0x3be,0x492,0x407,0x361),'jTNJQ':_0x2c3fca(0xd0,0xb4,0xd9,0x106),'hqTdV':function(_0x374861,_0x54dca2){return _0x374861(_0x54dca2);},'VhOZw':function(_0x285740,_0x184af6){return _0x285740||_0x184af6;},'JgTCu':_0x2c3fca(0x154,0x1c2,0x1af,0x171)};function _0x55c22b(_0x9fc873,_0x1a3a08,_0x2cbafe,_0x4a6299){return _0x7807(_0x2cbafe-0x170,_0x4a6299);}if(!_0xcedc53)return'';function _0x2c3fca(_0x3ff273,_0x399d98,_0x1af4a3,_0x1d2574){return _0x7807(_0x1d2574- -0x13e,_0x1af4a3);}if(_0xcedc53['imageId']&&_0xcedc53['imageId'][_0x55c22b(0x44b,0x446,0x3d6,0x40a)](_0x45d6ac['JqNBl'])){if(_0x45d6ac[_0x55c22b(0x45c,0x360,0x413,0x4b4)]!==_0x2c3fca(0x16d,0x92,0x6a,0x106))throw new _0x4ede08(_0x2c3fca(-0x72,-0x11,0xdd,0x49)+'fetch\x20imag'+_0x2c3fca(0x23e,0x23c,0xeb,0x182)+_0x5f3de3[_0x2c3fca(0x136,0xa2,0x60,0x112)]);else{const _0x57755e=await _0x45d6ac['hqTdV'](getConfigImage,_0xcedc53[_0x55c22b(0x446,0x30e,0x3a3,0x437)]);return _0x45d6ac[_0x55c22b(0x40a,0x46c,0x42e,0x473)](_0x57755e,'');}}if(_0xcedc53[_0x55c22b(0x3df,0x38a,0x37c,0x350)]&&_0xcedc53[_0x2c3fca(0x127,0xfa,0xe4,0xce)][_0x2c3fca(0x12c,0xb8,0x99,0x128)](_0x45d6ac[_0x55c22b(0x355,0x476,0x3c7,0x376)]))return _0xcedc53['image'];return'';}async function generateBananaImage({prompt:_0x4ce7e7,width:_0x25c197,height:_0x1bb0b3,change:_0x158909,retouchPrompt:_0x22228d,retouchImage:_0x397b51}){const _0x314c4d={'YYfCq':_0x3730d3(0x265,0x2fa,0x24d,0x2b1),'tDwZE':function(_0xb3a6f0){return _0xb3a6f0();},'jyHSn':function(_0x4e44dc,_0x4dc852){return _0x4e44dc(_0x4dc852);},'UWkMA':_0x3730d3(0x2e7,0x271,0x290,0x339)+_0x3730d3(0x2bb,0x2b6,0x2f7,0x257),'AdlIb':function(_0x5cab62,_0x336bb7){return _0x5cab62+_0x336bb7;},'twMic':'/v1','iyMRY':function(_0x4c6832,_0x8de23f){return _0x4c6832(_0x8de23f);},'ooOmV':_0x3730d3(0x249,0x26a,0x266,0x22b),'uveMI':function(_0x1f7b4f,_0x143ccc){return _0x1f7b4f(_0x143ccc);},'urclz':_0x1f161b(-0x1bb,-0x101,-0x13c,-0xde)+'图事件监听器已关闭。','aofcO':_0x3730d3(0x3a4,0x32f,0x350,0x2d3)+_0x3730d3(0x286,0x1a6,0x233,0x2d1)+'ana_task','fMaZs':_0x1f161b(-0x27,-0xdd,-0x34,-0x94),'yqmCU':function(_0x4e58c9,_0x3a4cc5){return _0x4e58c9(_0x3a4cc5);},'qAzhT':_0x3730d3(0x237,0x1e4,0x214,0x1ba)+_0x1f161b(-0x58,-0x66,-0x9f,0x24)+'。','EDYyn':'[Banana]\x20F'+_0x3730d3(0x27f,0x326,0x300,0x3ba)+':','mZPSl':function(_0x3531ee,_0x8c6ff3){return _0x3531ee===_0x8c6ff3;},'HpZpE':_0x1f161b(-0x1c5,-0x129,-0xd8,-0x165),'bdfPm':function(_0x1436c6,_0x190f4b){return _0x1436c6(_0x190f4b);},'BtXnA':_0x1f161b(-0x141,-0xbf,-0x8,-0x47)+_0x1f161b(-0x141,-0x14d,-0x197,-0x1cc),'OxgHj':'Scene\x20Comp'+_0x1f161b(0x6e,-0xd,0x25,-0x7b),'ilQlQ':function(_0x738e1e,_0x316520){return _0x738e1e<=_0x316520;},'jMMvI':function(_0x8c39d8,_0x3a3a9c){return _0x8c39d8||_0x3a3a9c;},'nWHlj':_0x3730d3(0x356,0x3fc,0x37e,0x35d),'DAhqs':function(_0x83f9b7,_0x5b22d0){return _0x83f9b7(_0x5b22d0);},'qSlQi':function(_0x1f74c7,_0x4f0da3){return _0x1f74c7(_0x4f0da3);},'MKjPg':function(_0xc8bc49,_0x476849){return _0xc8bc49(_0x476849);},'LSMKE':function(_0x57c41f,_0x167660){return _0x57c41f(_0x167660);},'HpAWn':_0x3730d3(0x2cc,0x21c,0x285,0x213),'OeAnm':function(_0x29bd55,_0x2cb637){return _0x29bd55!==_0x2cb637;},'RkQKY':_0x1f161b(-0xff,-0xc8,-0x141,-0xd5),'BkFcU':function(_0x3f396a,_0x5eb7fc,_0x3e5a7b){return _0x3f396a(_0x5eb7fc,_0x3e5a7b);},'XhqMH':function(_0x4e2b38,_0x32f050){return _0x4e2b38+_0x32f050;},'EMaae':_0x3730d3(0x182,0x230,0x223,0x1a7),'dGfUO':function(_0x392fb1,_0x469a45){return _0x392fb1(_0x469a45);},'pjuBH':function(_0x475dd3,_0x103dcb){return _0x475dd3(_0x103dcb);},'hilyh':function(_0x53b661,_0x35b825){return _0x53b661===_0x35b825;},'dpRqw':_0x1f161b(0x61,-0x38,-0xa1,-0xdf),'znzaz':'前置前','DSHtN':_0x3730d3(0x2a7,0x242,0x2b9,0x32e),'mPJRU':_0x3730d3(0x282,0x389,0x2f3,0x340),'dnhuV':_0x1f161b(-0xa6,-0x8f,-0xd3,-0xbb),'lnDUN':'/v1/chat/c'+'ompletions','ZbJKB':function(_0x225694,_0x337598){return _0x225694||_0x337598;},'SPvoW':function(_0x25546e,_0x3193f6){return _0x25546e(_0x3193f6);},'HnuIi':'最后置','pisGJ':_0x1f161b(-0x52,-0x103,-0x11c,-0x88),'njSWT':'ZKknY','CKXLl':_0x3730d3(0x31c,0x3cd,0x33e,0x2c0),'QiqNq':function(_0x2e42f6,_0x11e628){return _0x2e42f6(_0x11e628);},'VWcyE':function(_0x4942f9,_0x3c814d){return _0x4942f9(_0x3c814d);},'ffggD':function(_0x93f6be,_0x5bdd6e){return _0x93f6be===_0x5bdd6e;},'qeEaP':_0x3730d3(0x340,0x362,0x35d,0x3a9),'XTWAc':_0x3730d3(0x298,0x369,0x2fd,0x241),'sjyKA':_0x3730d3(0x335,0x2af,0x2da,0x22b),'GDiGj':_0x1f161b(0x7b,-0xe,-0x5f,-0xc6),'EXQFb':function(_0x3f7cef,_0x4d9a00){return _0x3f7cef>_0x4d9a00;},'qXiZH':function(_0x415558,_0x5838b1){return _0x415558(_0x5838b1);},'JdPYN':_0x3730d3(0x37c,0x317,0x333,0x37c),'aQQfa':_0x1f161b(-0xe1,-0xbc,-0x156,-0xd9),'WrZxh':'user','kkefd':_0x1f161b(-0x99,-0xdc,-0x107,-0x134),'cUDFd':_0x1f161b(-0x12b,-0xf5,-0x1a5,-0x6f),'sBIbt':'uWGYy','XDtEv':function(_0x570cda,_0x2ab4ca){return _0x570cda(_0x2ab4ca);},'RLzRQ':_0x3730d3(0x1de,0x278,0x238,0x1dd),'PSqGv':function(_0x1eaf87,_0x588d0c){return _0x1eaf87+_0x588d0c;},'aJNRr':function(_0x1dc14e,_0x3f36c7){return _0x1dc14e===_0x3f36c7;},'QJLBZ':_0x1f161b(-0xcb,-0x172,-0x1f6,-0x202)+_0x3730d3(0x302,0x23d,0x272,0x20b)+'ompletions'+_0x3730d3(0x1ea,0x246,0x24b,0x2e6),'fWXXr':_0x3730d3(0x255,0x2d3,0x2c3,0x319),'AjNBd':'imagen','LbWBh':_0x1f161b(-0x148,-0x106,-0x4c,-0xcc)+_0x1f161b(-0x199,-0x12a,-0x1b9,-0x1e5),'dLPbE':'vhMzT','tVhnj':function(_0x20af3c,_0x4265fc){return _0x20af3c(_0x4265fc);},'sZrAW':function(_0x288515,_0x1da21a){return _0x288515(_0x1da21a);},'NTDFZ':_0x1f161b(-0xe8,-0x82,-0x20,-0x103),'tHrDh':function(_0x35ac63,_0x526cd6,_0x188106){return _0x35ac63(_0x526cd6,_0x188106);},'yLZGO':function(_0xf07e95,_0x32def6){return _0xf07e95===_0x32def6;},'zBhoK':function(_0x4f1b2b,_0x75b950){return _0x4f1b2b!==_0x75b950;},'SEaAw':_0x3730d3(0x2be,0x20e,0x262,0x2ac),'EaaPk':_0x3730d3(0x2a8,0x35f,0x2ea,0x2c7)+_0x3730d3(0x2ad,0x2cf,0x225,0x2a0)+'rkdown\x20ima'+_0x3730d3(0x316,0x2cb,0x299,0x343)+'\x20extractin'+'g\x20URL...','JFtiK':function(_0x5114e6,_0x52af82){return _0x5114e6(_0x52af82);},'MyUHP':_0x1f161b(-0x11a,-0x13e,-0x1b7,-0x12e),'BKrcc':function(_0x25323a,_0x12e759){return _0x25323a(_0x12e759);},'FfRgk':'[Banana]\x20U'+_0x3730d3(0x335,0x324,0x2ec,0x371)+_0x1f161b(-0x54,-0x31,-0x8f,-0x69)+'allback.','Semnq':_0x1f161b(-0x7f,-0xad,-0xe5,-0x12a)+_0x1f161b(-0x1a9,-0x17e,-0x151,-0x180)+'ntains\x20tex'+'t\x20only,\x20no'+_0x1f161b(-0x181,-0x177,-0x216,-0xf5),'BIxkV':function(_0x517ef1,_0x484411){return _0x517ef1===_0x484411;},'qiorp':_0x1f161b(-0xf1,-0xf7,-0x1a6,-0x147),'DqhhO':'[Banana]\x20I'+'mage\x20gener'+_0x1f161b(-0xb6,-0x3f,-0xb4,-0x7b)+'ssfully.','RlTct':function(_0x160cf8,_0x3045c6){return _0x160cf8||_0x3045c6;}};_0x314c4d['tDwZE'](clearLog);const _0x46d3ca=taskQueue['addTask']({'name':_0x314c4d['AdlIb'](_0x314c4d[_0x3730d3(0x25b,0x3b1,0x305,0x2b5)](_0x4ce7e7,'')[_0x1f161b(-0xdd,-0x9d,-0xf6,-0xa5)](-0x1740+-0x70c+-0x2*-0xf26,-0x3*0xbdb+-0x1*0x11a5+0x3554),_0x4ce7e7&&_0x4ce7e7[_0x1f161b(-0x6c,-0xb1,-0x139,-0x11d)]>-0x2*0x6f7+0x262+0x2*0x5d5?_0x314c4d['nWHlj']:''),'type':TaskType[_0x3730d3(0x2b3,0x2bf,0x2d6,0x21f)],'prompt':_0x4ce7e7});currentTaskId=_0x46d3ca,_0x4ce7e7=processCharacterPrompt(_0x4ce7e7),_0x4ce7e7=await _0x314c4d[_0x3730d3(0x3da,0x32b,0x366,0x32d)](stripChineseAnnotations,_0x4ce7e7);let _0x4ff322=_0x158909;_0x158909=_0x314c4d[_0x1f161b(-0x85,-0xa4,-0x97,-0xc0)](processCharacterPrompt,_0x158909),_0x158909=await _0x314c4d[_0x1f161b(-0x1a3,-0xf9,-0x108,-0x114)](stripChineseAnnotations,_0x158909),addLog(_0x3730d3(0x2e0,0x385,0x36c,0x309)+_0x1f161b(-0xc0,-0x120,-0x1a4,-0x14a)+extension_settings[extensionName][_0x1f161b(-0xbd,-0xf2,-0x14b,-0xe4)]);function _0x3730d3(_0x59bd31,_0x4f2ef6,_0x4d2794,_0x3aba5c){return _0x7807(_0x4d2794-0x8b,_0x59bd31);}_0x314c4d[_0x1f161b(-0x9,-0x12,-0x4f,-0x89)](addLog,_0x1f161b(-0xcb,-0xa2,-0x146,-0xa)+'\x20'+_0x314c4d[_0x1f161b(0x33,-0x88,-0xa9,-0x29)](_0x25c197,'默认')+',\x20高度\x20-\x20'+(_0x1bb0b3||'默认'));function _0x1f161b(_0x24cf73,_0x384f77,_0x1a4306,_0x5689dc){return _0x7807(_0x384f77- -0x302,_0x24cf73);}_0x4ce7e7=_0x158909&&_0x158909[_0x1f161b(-0x32,-0x1f,0x25,0x9)]()!==''?_0x158909:_0x4ce7e7,_0x314c4d[_0x1f161b(-0x1,-0x41,0x2c,0x45)](addLog,_0x3730d3(0x1df,0x178,0x218,0x216)+_0x4ce7e7);let _0x1341df=![];_0x4ce7e7[_0x3730d3(0x2ad,0x332,0x2fc,0x340)](_0x3730d3(0x36b,0x2c2,0x357,0x3f2)+_0x3730d3(0x368,0x404,0x380,0x358))&&(_0x1341df=!![]);_0x314c4d['bdfPm'](addLog,_0x3730d3(0x1ee,0x192,0x236,0x218)+_0x3730d3(0x2db,0x428,0x37d,0x350)+_0x3730d3(0x298,0x2db,0x260,0x2e8)+_0x1341df);let _0x5886d5={},_0xf98b0e='',_0x58f6a0='';if(_0x1341df){addLog(_0x314c4d[_0x1f161b(-0x15d,-0x143,-0x1ea,-0x153)]),_0x5886d5=_0x314c4d[_0x3730d3(0x281,0x3b7,0x331,0x32f)](parsePromptStringWithCoordinates,_0x4ce7e7),_0xf98b0e=_0x5886d5[_0x1f161b(-0x56,-0x36,-0x89,-0xd0)+_0x3730d3(0x31a,0x2fe,0x380,0x3a5)];for(let _0x30924e=0xc0b+-0xf9f+0x395;_0x30924e<=-0x1f*-0xdf+-0xfc9+-0x2*0x59a;_0x30924e++){_0x314c4d[_0x3730d3(0x292,0x2af,0x282,0x33c)]==='UDZEH'?_0x2ba1d5=_0x41e9fc[_0x1f161b(-0x96,-0x10f,-0xf6,-0x1a6)](_0x314c4d[_0x3730d3(0x2dc,0x30f,0x28d,0x27f)],''):_0x5886d5[_0x1f161b(-0xde,-0x7b,-0xc,-0x68)+_0x30924e+'\x20Prompt']&&(_0x314c4d[_0x3730d3(0x1fa,0x1ce,0x249,0x247)](_0x3730d3(0x25c,0x318,0x2a4,0x262),_0x314c4d[_0x3730d3(0x1bb,0x185,0x211,0x231)])?_0x58f6a0=_0x314c4d['AdlIb'](_0x314c4d[_0x1f161b(-0x3,-0xaf,-0x12b,-0xd8)](_0x58f6a0,',\x20'),_0x5886d5[_0x1f161b(-0x74,-0x7b,-0xc4,-0x5b)+_0x30924e+_0x3730d3(0x224,0x313,0x2cb,0x2c2)]):(!_0x4c97f3[_0x3730d3(0x1d7,0x301,0x25e,0x1b2)+_0x3730d3(0x2bf,0x204,0x2bd,0x2bc)+'ener']&&(_0x29bbdc['initialize'+_0x3730d3(0x2e6,0x360,0x2bd,0x277)+_0x3730d3(0x3a5,0x2c5,0x329,0x2ca)]=!![],_0x314c4d[_0x3730d3(0x290,0x25b,0x2fa,0x2f1)](_0x27f1dd)),_0x314c4d[_0x3730d3(0x2dd,0x293,0x2fa,0x288)](_0x186081)));}}else _0x314c4d['uveMI'](addLog,_0x314c4d['UWkMA']),_0xf98b0e=_0x4ce7e7;let {modifiedPrompt:_0x5e5896,insertions:_0x10e22d}=await _0x314c4d[_0x1f161b(-0xb4,-0x3e,-0xa4,0x55)](prompt_replace,_0xf98b0e,_0x58f6a0);if(_0x1341df)for(let _0xc0103e=0x22a8+0x1ce8+-0x3f8f;_0x314c4d[_0x3730d3(0x34f,0x39a,0x365,0x2ef)](_0xc0103e,-0x2518+-0x2082+0x3aa*0x13);_0xc0103e++){_0x5886d5[_0x3730d3(0x369,0x2aa,0x312,0x2ea)+_0xc0103e+_0x3730d3(0x327,0x244,0x2cb,0x361)]&&(_0x5e5896=_0x314c4d[_0x3730d3(0x333,0x3c7,0x32f,0x2b9)](_0x314c4d[_0x1f161b(-0x100,-0x5e,-0xd5,0x12)](_0x5e5896,_0x314c4d['EMaae']),_0x314c4d['dGfUO'](prompt_replace_for_character,_0x5886d5[_0x3730d3(0x3bd,0x31c,0x312,0x3cd)+_0xc0103e+_0x1f161b(-0x43,-0xc2,-0x7c,-0x67)])));}const _0x5bcf3a=extension_settings[extensionName][_0x1f161b(-0x1fe,-0x15d,-0x105,-0x13a)],{model:_0x55da85,apiUrl:_0x23066e,apiKey:_0x42adde,conversationPresets:_0x27f72c,conversationPresetId:_0x13597b,editPresetId:_0x29a089,aspectRatio:_0x175e20}=_0x5bcf3a;_0x314c4d['pjuBH'](addLog,_0x1f161b(0x1,-0x97,-0x93,-0xfa)+'tarting\x20im'+_0x3730d3(0x295,0x2cf,0x336,0x349)+'tion\x20with\x20'+_0x1f161b(-0x2a,-0x71,0x13,0x29)+_0x55da85);let _0x3c357f,_0x313f53;if(_0x55da85[_0x1f161b(-0x22,-0x9c,-0x23,-0x12f)](_0x3730d3(0x32b,0x3b4,0x32a,0x281))){if(_0x314c4d[_0x3730d3(0x34f,0x3bc,0x36d,0x390)](_0x314c4d[_0x1f161b(-0x127,-0xd7,-0x34,-0x40)],_0x314c4d[_0x3730d3(0x277,0x21d,0x2b6,0x32e)])){_0x3c357f=_0x3730d3(0x29f,0x1ea,0x20e,0x2a8)+_0x3730d3(0x28c,0x250,0x253,0x2ba)+_0x55da85;const _0x187308={};_0x187308[_0x1f161b(-0x10d,-0x131,-0xfa,-0x1b3)+'t']='';const _0x15c64b=_0x27f72c[_0x13597b]||_0x187308,_0x8fd70a=[_0x15c64b[_0x3730d3(0x2f5,0x256,0x25c,0x26c)+'t'],_0x10e22d[_0x314c4d[_0x3730d3(0x1e3,0x31f,0x280,0x326)]],_0x10e22d[_0x314c4d[_0x3730d3(0x3ad,0x2bc,0x315,0x34f)]],_0x5e5896,_0x10e22d[_0x314c4d[_0x3730d3(0x3ef,0x2ea,0x373,0x357)]],_0x10e22d[_0x314c4d[_0x1f161b(-0x73,-0x10c,-0x94,-0xe7)]],_0x15c64b[_0x3730d3(0x316,0x2e8,0x2fb,0x29d)+_0x3730d3(0x1e1,0x23d,0x23a,0x212)],_0x10e22d[_0x3730d3(0x2e0,0x2ea,0x319,0x364)]]['filter'](Boolean)[_0x1f161b(-0x10a,-0x61,-0x79,-0x7f)](',\x20');_0x314c4d[_0x1f161b(-0x12c,-0xf9,-0x5c,-0xa7)](addLog,_0x1f161b(-0xbd,-0x50,-0x105,-0x98)+_0x8fd70a);const _0x351597={};_0x351597[_0x3730d3(0x2ce,0x418,0x377,0x2d7)]=_0x8fd70a;const _0x1baf71={};_0x1baf71[_0x3730d3(0x3a2,0x320,0x343,0x2bb)+'t']=0x1,_0x1baf71[_0x1f161b(-0x85,-0xd9,-0x149,-0x6e)+'o']=_0x175e20;const _0x305611={};_0x305611[_0x3730d3(0x350,0x34c,0x2d7,0x344)]=[_0x351597],_0x305611[_0x3730d3(0x2ae,0x1bc,0x242,0x1ee)]=_0x1baf71,_0x313f53=_0x305611,_0x314c4d[_0x3730d3(0x1c4,0x27b,0x23c,0x1f1)](addLog,_0x3730d3(0x2ae,0x24c,0x2a6,0x312)+_0x3730d3(0x17d,0x291,0x213,0x205)+_0x1f161b(-0xc4,-0x6a,-0xed,-0xfc)+_0x1f161b(-0xbf,-0x150,-0x1a8,-0xa2)+'t:\x20'+_0x8fd70a);}else _0x314c4d[_0x1f161b(-0xd3,-0x5c,0x55,-0x110)](_0x24ce3f,_0x314c4d['UWkMA']),_0x1ca86e=_0x406d01;}else{_0x3c357f=_0x314c4d[_0x3730d3(0x28d,0x211,0x28f,0x286)];let _0x3c0960;if(_0x158909['includes'](_0x314c4d['YYfCq'])){addLog(_0x3730d3(0x2a2,0x1e0,0x214,0x207)+'用了\x20{修图}\x20标识'+'。');const _0x23efe2=_0x314c4d[_0x1f161b(-0xb6,-0x87,-0xe4,-0x81)](_0x29a089,'默认'),_0x56d9bf={};_0x56d9bf[_0x3730d3(0x244,0x256,0x248,0x1fa)+'on']=[],_0x56d9bf[_0x1f161b(-0x117,-0x131,-0xea,-0x122)+'t']='',_0x3c0960=_0x27f72c[_0x23efe2]||_0x56d9bf,_0x314c4d['SPvoW'](addLog,_0x3730d3(0x2e2,0x2f0,0x271,0x1f1)+'用修图预设:\x20\x22'+_0x23efe2+'\x22');}else{const _0x69f88d={};_0x69f88d[_0x3730d3(0x2e5,0x29f,0x248,0x292)+'on']=[],_0x69f88d[_0x1f161b(-0xe1,-0x131,-0x1e9,-0xd7)+'t']='',_0x3c0960=_0x27f72c[_0x13597b]||_0x69f88d;}const _0x51830f=[_0x3c0960[_0x3730d3(0x2a7,0x1af,0x25c,0x1e8)+'t'],_0x10e22d[_0x314c4d[_0x1f161b(-0x153,-0x10d,-0x18c,-0x6f)]],_0x10e22d[_0x314c4d[_0x3730d3(0x3a9,0x2b8,0x315,0x2c3)]],_0x5e5896,_0x10e22d[_0x314c4d[_0x1f161b(-0x8b,-0x1a,0x66,-0x53)]],_0x10e22d[_0x314c4d[_0x1f161b(-0x81,-0x10c,-0x126,-0x111)]],_0x3c0960['postfixPro'+_0x1f161b(-0x1b8,-0x153,-0xf2,-0x196)],_0x10e22d[_0x314c4d[_0x3730d3(0x326,0x35f,0x2e3,0x399)]]][_0x1f161b(-0x25,-0x2b,-0xa0,0x71)](Boolean)[_0x1f161b(-0x55,-0x61,-0x28,-0x90)](',\x20');_0x314c4d[_0x1f161b(-0xdb,-0xfa,-0x197,-0xb3)](addLog,'正面提示词:\x20'+_0x51830f);const _0xfbbfd0={};_0xfbbfd0[_0x1f161b(-0x100,-0x17d,-0x202,-0x1a4)]=_0x3730d3(0x228,0x23d,0x22f,0x2ca),_0xfbbfd0[_0x3730d3(0x2cd,0x36a,0x32b,0x3b3)]=[];const _0x6fb28d={};_0x6fb28d['role']=_0x3730d3(0x284,0x35b,0x2d1,0x2b9),_0x6fb28d[_0x3730d3(0x3de,0x311,0x32b,0x2f5)]=[];const _0x4a321f=_0x3c0960[_0x3730d3(0x1a6,0x1e3,0x248,0x25e)+'on'][_0x3730d3(0x2d9,0x259,0x276,0x293)](_0x51587a=>[_0xfbbfd0,_0x6fb28d])[_0x1f161b(0x44,-0x43,-0x29,-0x13)]();let _0x9ab755=-0x166e+-0x30c+0x87e*0x3;for(const _0x2bfad1 of _0x3c0960['conversati'+'on']){if(_0x314c4d[_0x1f161b(-0xc3,-0x144,-0x172,-0xbd)](_0x314c4d[_0x1f161b(-0x8a,-0x8a,0xd,-0x24)],_0x314c4d[_0x3730d3(0x33f,0x321,0x31a,0x2de)])){if(_0x2bfad1['user']?.[_0x1f161b(-0x5b,-0x4f,-0x3e,-0xb7)])_0x4a321f[_0x9ab755][_0x1f161b(-0xfd,-0x62,-0x97,0xc)][_0x1f161b(-0xcb,-0x165,-0x139,-0x1c2)]({'type':_0x314c4d['CKXLl'],'text':_0x2bfad1[_0x1f161b(-0x103,-0x15e,-0xf1,-0xfc)][_0x1f161b(-0x8e,-0x4f,-0xad,-0xbf)]});const _0x23752a=await _0x314c4d['QiqNq'](getImageFromTurnData,_0x2bfad1[_0x3730d3(0x2dc,0x29c,0x22f,0x28f)]);if(_0x23752a)_0x4a321f[_0x9ab755]['content']['push']({'type':_0x314c4d[_0x3730d3(0x27f,0x212,0x2a7,0x236)],'image_url':{'url':_0x23752a}});_0x9ab755++;if(_0x2bfad1['model']?.[_0x3730d3(0x307,0x3b2,0x33e,0x34f)])_0x4a321f[_0x9ab755]['content']['push']({'type':_0x314c4d[_0x1f161b(-0x102,-0x11d,-0xcc,-0x95)],'text':_0x2bfad1['model']['text']});const _0x1a15bc=await _0x314c4d['VWcyE'](getImageFromTurnData,_0x2bfad1[_0x1f161b(-0x16c,-0x166,-0x1cf,-0x202)]);if(_0x1a15bc)_0x4a321f[_0x9ab755][_0x1f161b(0x3c,-0x62,-0xc0,-0xf3)]['push']({'type':_0x314c4d['fMaZs'],'image_url':{'url':_0x1a15bc}});_0x9ab755++;}else _0x235014=_0x314c4d[_0x3730d3(0x266,0x38e,0x2de,0x2fa)](_0x134d7a,_0x314c4d[_0x1f161b(-0xe5,-0x173,-0xc7,-0x218)]);}if(!_0x158909[_0x3730d3(0x259,0x3a9,0x2fc,0x30a)](_0x314c4d[_0x3730d3(0x26b,0x2df,0x28d,0x202)])){const _0x459301=extension_settings[extensionName][_0x1f161b(-0x1f6,-0x149,-0xc7,-0x1e4)+'acterPrese'+'ts']||{};for(const _0x80341e in _0x459301){const _0x2d76b5=_0x459301[_0x80341e],_0x156afa=(_0x2d76b5['triggers']||'')['split']('|')[_0x3730d3(0x345,0x3ca,0x362,0x414)](_0x5e239b=>_0x5e239b[_0x1f161b(-0x84,-0x1f,0x56,0x7c)]()!=='');for(const _0x576674 of _0x156afa){if(_0x314c4d[_0x3730d3(0x366,0x36e,0x2b3,0x356)](_0x314c4d[_0x3730d3(0x332,0x379,0x359,0x3e9)],_0x314c4d['qeEaP'])){if(_0x51830f['toLowerCas'+'e']()[_0x3730d3(0x31c,0x322,0x2fc,0x2a5)](_0x576674[_0x1f161b(-0xa9,-0x162,-0x1f1,-0x127)+'e']())){if(_0x314c4d[_0x3730d3(0x3a9,0x401,0x36d,0x300)](_0x1f161b(-0x73,-0x90,-0xe4,-0x1c),_0x314c4d[_0x3730d3(0x244,0x24f,0x2c2,0x26b)])){_0x314c4d['dGfUO'](addLog,'[Banana]\x20F'+_0x3730d3(0x33e,0x2c5,0x2d4,0x251)+_0x3730d3(0x2e1,0x2c9,0x31b,0x2c7)+'r\x20\x22'+_0x576674+(_0x3730d3(0x301,0x3ad,0x2ff,0x312)+_0x3730d3(0x1c6,0x2e4,0x26a,0x2ab))+_0x80341e+'\x22.');const _0xd30e4e=_0x2d76b5[_0x1f161b(-0x115,-0x145,-0x124,-0x1d4)+'on'];if(_0xd30e4e){if(_0x314c4d[_0x1f161b(-0x98,-0x1b,-0x28,-0xc0)]===_0x314c4d[_0x3730d3(0x350,0x30b,0x370,0x2e3)])_0x5dbf7e=_0x1bd0ef;else{const _0x9c0a25=[];if(_0xd30e4e[_0x1f161b(-0xe8,-0x15e,-0x119,-0x133)]&&_0xd30e4e['user']['text'])_0x9c0a25[_0x3730d3(0x2bc,0x1d1,0x228,0x1c4)]({'type':_0x314c4d[_0x1f161b(-0xf3,-0x11d,-0x179,-0xe1)],'text':_0xd30e4e[_0x1f161b(-0x214,-0x15e,-0x1c9,-0x1b5)][_0x3730d3(0x30f,0x2b3,0x33e,0x30e)]});const _0x2466f4=await getImageFromTurnData(_0xd30e4e[_0x1f161b(-0x1ce,-0x15e,-0x19c,-0x119)]);if(_0x2466f4)_0x9c0a25[_0x3730d3(0x28a,0x20b,0x228,0x246)]({'type':_0x314c4d[_0x3730d3(0x323,0x257,0x2a7,0x2f9)],'image_url':{'url':_0x2466f4}});if(_0x314c4d[_0x3730d3(0x2f6,0x332,0x301,0x259)](_0x9c0a25[_0x1f161b(-0x158,-0xb1,-0x6c,-0xce)],0x95*0x3+-0x34b*0x9+0x1be4)){const _0x330fe4={};_0x330fe4[_0x1f161b(-0x17e,-0x17d,-0x225,-0x101)]=_0x3730d3(0x1ff,0x1c4,0x22f,0x2a2),_0x330fe4[_0x3730d3(0x28f,0x299,0x32b,0x35d)]=_0x9c0a25,_0x4a321f['push'](_0x330fe4);}const _0x710d2b=[];if(_0xd30e4e['model']&&_0xd30e4e[_0x1f161b(-0xd5,-0x166,-0x140,-0xef)][_0x1f161b(-0x109,-0x4f,-0x73,-0xc1)])_0x710d2b[_0x3730d3(0x2ac,0x192,0x228,0x189)]({'type':_0x3730d3(0x310,0x28e,0x33e,0x30e),'text':_0xd30e4e[_0x3730d3(0x1df,0x214,0x227,0x278)]['text']});const _0x5b970b=await _0x314c4d['qXiZH'](getImageFromTurnData,_0xd30e4e[_0x1f161b(-0x16f,-0x166,-0x1c6,-0x153)]);if(_0x5b970b)_0x710d2b[_0x1f161b(-0x159,-0x165,-0x18a,-0x20c)]({'type':_0x314c4d[_0x1f161b(-0x10b,-0xe6,-0x30,-0xd5)],'image_url':{'url':_0x5b970b}});if(_0x314c4d[_0x1f161b(-0x41,-0x8c,-0xcc,0x5)](_0x710d2b[_0x3730d3(0x2f9,0x28d,0x2dc,0x346)],0x869*-0x1+0x103c+-0x7d3)){if(_0x314c4d[_0x1f161b(-0x142,-0xa7,-0x158,-0x85)](_0x314c4d[_0x3730d3(0x31e,0x245,0x2e1,0x265)],'CmOon'))_0x18f3c1[_0x1f161b(-0x90,-0x12f,-0x129,-0xce)+_0x3730d3(0x24c,0x205,0x2bd,0x2c7)+_0x1f161b(-0xd4,-0x64,-0x6f,-0x4)]=!![],_0x314c4d[_0x3730d3(0x284,0x354,0x2fa,0x30a)](_0x283cee);else{const _0xaf71d9={};_0xaf71d9[_0x3730d3(0x2ca,0x220,0x210,0x199)]=_0x314c4d[_0x1f161b(-0x169,-0x16d,-0x21c,-0x198)],_0xaf71d9[_0x3730d3(0x3a3,0x2f0,0x32b,0x34c)]=_0x710d2b,_0x4a321f['push'](_0xaf71d9);}}}}break;}else _0x443dcf[_0x441945]['banana']['cishu']=0x69d*-0x1+0x13f2+-0xd54*0x1,_0x314c4d[_0x3730d3(0x34d,0x203,0x294,0x305)](_0x4ccc8a,_0x3730d3(0x346,0x379,0x354,0x40e)+_0x1f161b(0x2b,-0x13,-0xc5,-0x94)+_0x36e8e2[_0x20fa88][_0x3730d3(0x1c6,0x265,0x230,0x190)]['cishu']);}}else{if(_0x39c1ef[_0x3730d3(0x2b1,0x2bc,0x25e,0x2e4)+_0x3730d3(0x2fa,0x2b4,0x2bd,0x2ad)+_0x1f161b(-0x8b,-0x64,-0x81,-0xad)]){const _0x46f47c=_0x314c4d['ooOmV'][_0x1f161b(-0x16d,-0xc3,-0x104,-0x72)]('|');let _0x5618ab=0x1ca8+-0x6dd*0x3+-0x811*0x1;while(!![]){switch(_0x46f47c[_0x5618ab++]){case'0':_0xcb6fba[_0x1f161b(-0xcd,-0x119,-0x142,-0x128)](_0x2aa1bc=>{function _0x25d7e9(_0x2bce34,_0x54eb54,_0x38252f,_0x3421ff){return _0x3730d3(_0x3421ff,_0x54eb54-0x11,_0x54eb54-0x120,_0x3421ff-0xaf);}_0x590a05[_0x25d7e9(0x3cc,0x418,0x3ec,0x361)+'ener'](_0x2aa1bc,_0x521680);});continue;case'1':_0x314c4d[_0x3730d3(0x226,0x2d3,0x250,0x2d3)](_0x87911c,_0x314c4d[_0x3730d3(0x27a,0x2f0,0x258,0x1ae)]);continue;case'2':_0x2f420e['removeList'+_0x3730d3(0x2bf,0x3e2,0x329,0x2b0)](_0x9d237d[_0x1f161b(-0xa0,-0x13b,-0x16e,-0x1b9)+_0x1f161b(-0x24,-0x4e,-0xf,-0x67)+'ST'],_0x4965b8);continue;case'3':_0x2ea843[_0x3730d3(0x1f1,0x1fb,0x25e,0x27d)+_0x1f161b(-0xa0,-0xd0,-0x84,-0xfd)+_0x1f161b(-0xb,-0x64,-0x55,-0x10f)]=![];continue;case'4':_0x4a40e7[_0x3730d3(0x34a,0x395,0x2f8,0x37b)+_0x1f161b(-0x4e,-0x64,-0xee,-0x2a)](_0x314c4d[_0x1f161b(-0x143,-0x11a,-0xf3,-0x80)],_0x13acc0);continue;}break;}}}}}}if(!_0x158909[_0x3730d3(0x242,0x291,0x2fc,0x271)](_0x314c4d[_0x3730d3(0x1fa,0x1eb,0x28d,0x1dd)])){const _0x2ee0da={};_0x2ee0da[_0x1f161b(-0x157,-0xcd,-0x173,-0x14e)]=_0x3730d3(0x2e6,0x3cd,0x33e,0x3b4),_0x2ee0da[_0x3730d3(0x3bd,0x343,0x33e,0x356)]=_0x51830f;const _0x2bc302={};_0x2bc302[_0x1f161b(-0x18c,-0x17d,-0x1c8,-0xec)]=_0x314c4d[_0x3730d3(0x278,0x347,0x29e,0x292)],_0x2bc302[_0x1f161b(0x42,-0x62,-0x7e,-0xb3)]=[_0x2ee0da],_0x4a321f[_0x1f161b(-0xd3,-0x165,-0x1d4,-0x1ab)](_0x2bc302);}else{if(_0x314c4d[_0x3730d3(0x2f4,0x2a6,0x334,0x355)]===_0x314c4d[_0x1f161b(-0x3d,-0x59,-0x33,0x34)]){const _0x4054f9=[],_0x2ac5df=_0x314c4d['jMMvI'](_0x22228d,_0x51830f),_0x3391ce=[_0x3c0960[_0x3730d3(0x26e,0x1ce,0x25c,0x2ab)+'t'],_0x2ac5df,_0x3c0960[_0x3730d3(0x2d7,0x26f,0x2fb,0x37c)+_0x3730d3(0x1ca,0x2bf,0x23a,0x29b)]][_0x3730d3(0x39e,0x343,0x362,0x302)](Boolean)[_0x1f161b(-0xc1,-0x61,-0x10c,-0x4e)](',\x20'),_0x238d0e={};_0x238d0e[_0x3730d3(0x263,0x237,0x2c0,0x282)]=_0x314c4d[_0x3730d3(0x26c,0x267,0x270,0x1b5)],_0x238d0e[_0x1f161b(0x6a,-0x4f,-0x9c,-0x32)]=_0x3391ce,_0x4054f9[_0x3730d3(0x2c5,0x2a2,0x228,0x238)](_0x238d0e);if(_0x397b51){if(_0x314c4d[_0x1f161b(-0x34,-0x20,-0x7d,0x14)](_0x314c4d[_0x1f161b(-0x162,-0xc4,-0x47,-0x167)],_0x314c4d['sBIbt'])){const _0x1274da={};_0x1274da[_0x1f161b(-0xe4,-0x45,-0x10,-0x2a)]=_0x112343;const _0x34a482={};_0x34a482['type']=_0x314c4d[_0x3730d3(0x344,0x225,0x2a7,0x360)],_0x34a482[_0x1f161b(-0xeb,-0xdd,-0x6a,-0xfd)]=_0x1274da,_0x2789fb['push'](_0x34a482),_0x197fa3('[Banana]\x20修'+_0x3730d3(0x315,0x250,0x277,0x300)+_0x1f161b(0x49,-0x54,0x32,-0x107));}else{const _0x16fcfb={};_0x16fcfb[_0x3730d3(0x2f6,0x329,0x348,0x315)]=_0x397b51;const _0x581e71={};_0x581e71[_0x3730d3(0x28c,0x308,0x2c0,0x310)]=_0x314c4d[_0x1f161b(-0x102,-0xe6,-0x132,-0x147)],_0x581e71[_0x1f161b(-0x39,-0xdd,-0x92,-0x104)]=_0x16fcfb,_0x4054f9[_0x1f161b(-0x125,-0x165,-0x109,-0x1d8)](_0x581e71),addLog(_0x1f161b(0x4c,-0x29,-0x2c,-0x7e)+_0x3730d3(0x287,0x22f,0x277,0x248)+_0x1f161b(-0x89,-0x54,-0x4c,-0x27));}}const _0x1e49a0={};_0x1e49a0[_0x3730d3(0x274,0x1ea,0x210,0x1c1)]=_0x314c4d['WrZxh'],_0x1e49a0['content']=_0x4054f9,_0x4a321f[_0x3730d3(0x279,0x1cc,0x228,0x236)](_0x1e49a0),addLog(_0x3730d3(0x380,0x3bc,0x364,0x2e5)+'图模式：指令\x20=\x20'+_0x3391ce);}else _0x59fcb0[_0x1f161b(-0xfa,-0xff,-0x1b9,-0xe5)+'sk'](_0x32c09b,![]);}const _0x40871d={};_0x40871d[_0x1f161b(-0x37,-0xd9,-0x56,-0x120)+'o']=_0x175e20;const _0x157f5b={};_0x157f5b[_0x1f161b(-0x121,-0x113,-0x13e,-0xea)+'g']=_0x40871d,_0x313f53={'model':_0x55da85,'messages':_0x4a321f['filter'](_0x1a8875=>_0x1a8875[_0x1f161b(0xa,-0x62,0x33,-0x26)][_0x3730d3(0x2a6,0x29e,0x2dc,0x294)]>-0x4c1*0x3+0x16e3*0x1+-0x2e*0x30),'config':_0x157f5b},_0x314c4d[_0x3730d3(0x30c,0x2ba,0x2ee,0x2d7)](addLog,_0x1f161b(-0x11d,-0xe7,-0xf6,-0x5a)+'uilt\x20multi'+'modal\x20payl'+'oad\x20with\x20'+_0x313f53[_0x3730d3(0x39a,0x3c0,0x342,0x2e4)]['length']+_0x1f161b(0xa2,-0xc,0xa7,-0x90));}let _0x55c982=_0x23066e['replace'](/\/$/,''),_0x40887a;_0x55c982[_0x1f161b(-0xad,-0xc6,-0x1f,-0xaa)](_0x314c4d['twMic'])||_0x55c982[_0x3730d3(0x2dc,0x301,0x2fc,0x365)](_0x314c4d[_0x1f161b(-0x124,-0x14f,-0x1fc,-0x1ba)])?_0x40887a=_0x314c4d[_0x1f161b(0x15,-0x5e,-0xd1,-0xe9)](_0x55c982,_0x3c357f):_0x40887a=_0x314c4d['PSqGv'](_0x314c4d['PSqGv'](_0x55c982,_0x314c4d[_0x1f161b(-0x111,-0x173,-0x195,-0x1df)]),_0x3c357f);_0x40887a=_0x40887a[_0x3730d3(0x1d6,0x2ff,0x289,0x25e)](/\/v1\/v1\//g,_0x314c4d[_0x3730d3(0x2f8,0x285,0x23e,0x2db)]);const _0x4f751e=extension_settings[extensionName][_0x3730d3(0x268,0x2a4,0x29b,0x2a4)];let _0x14d4e6,_0x2e2e9b,_0x5c0a5e;if(_0x314c4d[_0x1f161b(-0x1d,-0xa8,-0x2,-0x59)](_0x4f751e,_0x3730d3(0x26e,0x2b8,0x2a2,0x310))){let _0x125282=_0x55c982;!_0x125282['endsWith'](_0x314c4d['twMic'])&&!_0x125282['includes'](_0x314c4d[_0x1f161b(-0xda,-0x14f,-0x1fd,-0x1e7)])&&(_0x125282=_0x125282+_0x314c4d[_0x1f161b(-0xd5,-0x173,-0x11e,-0x18b)]);_0x125282=_0x125282[_0x3730d3(0x253,0x208,0x289,0x1f4)](/\/v1\/$/,_0x314c4d[_0x3730d3(0x24a,0x2bf,0x21a,0x298)]),_0x14d4e6=_0x314c4d['QJLBZ'],_0x2e2e9b=_0x314c4d[_0x1f161b(0x8e,-0x12,-0x7,-0x55)](getRequestHeaders,window['token']);const _0xbfedf2={};_0xbfedf2['chat_compl'+_0x3730d3(0x2f6,0x3e6,0x376,0x3c2)+'ce']=_0x314c4d[_0x3730d3(0x2c2,0x2b6,0x26b,0x277)],_0xbfedf2['custom_url']=_0x125282,_0xbfedf2[_0x1f161b(-0x2,-0x6e,-0xe9,-0x10a)+_0x3730d3(0x1c5,0x293,0x217,0x1a1)+'rs']=_0x3730d3(0x2f9,0x379,0x353,0x399)+'ion:\x20\x22Bear'+_0x1f161b(-0x15b,-0xc1,-0x97,-0x3f)+_0x42adde+'\x22',_0xbfedf2[_0x3730d3(0x17f,0x201,0x227,0x19f)]=_0x55da85,_0xbfedf2['messages']=_0x313f53[_0x3730d3(0x3d6,0x3b8,0x342,0x2e5)],_0xbfedf2[_0x1f161b(-0xd4,-0x132,-0x174,-0x165)]=![],_0x5c0a5e=_0xbfedf2;if(_0x55da85[_0x1f161b(-0x5,-0x9c,-0x34,-0x75)](_0x314c4d[_0x3730d3(0x2b1,0x2f9,0x32d,0x2f3)])){_0x314c4d[_0x3730d3(0x3e4,0x2d2,0x366,0x31e)](addLog,_0x1f161b(-0x1aa,-0x11f,-0x6d,-0x8a)+'magen\x20模型不支'+_0x1f161b(-0x12a,-0x94,-0xf8,-0x9)+_0x1f161b(-0xb5,-0x15b,-0xc6,-0x183)),_0x14d4e6=_0x40887a;const _0x1cef28={};_0x1cef28['Content-Ty'+'pe']=_0x314c4d[_0x3730d3(0x400,0x31d,0x358,0x2f2)],_0x1cef28[_0x3730d3(0x2ed,0x29d,0x353,0x2e3)+_0x3730d3(0x2cc,0x320,0x378,0x3b4)]=_0x1f161b(-0x1c5,-0x147,-0x183,-0x1d0)+_0x42adde,_0x2e2e9b=_0x1cef28,_0x5c0a5e=_0x313f53;}_0x314c4d[_0x1f161b(-0x8,-0x41,-0x2,-0x65)](addLog,_0x1f161b(-0x1a7,-0x11c,-0x1a0,-0x198)+_0x1f161b(-0x155,-0xa5,-0x12e,-0x22));}else{if(_0x314c4d['OeAnm'](_0x314c4d[_0x3730d3(0x3bc,0x294,0x30c,0x344)],_0x3730d3(0x27c,0x353,0x31e,0x39f))){_0x14d4e6=_0x40887a;const _0x83f73d={};_0x83f73d['Content-Ty'+'pe']=_0x1f161b(-0x125,-0x106,-0xa6,-0xe2)+'n/json',_0x83f73d[_0x3730d3(0x36c,0x30a,0x353,0x2a6)+'ion']=_0x3730d3(0x1df,0x2d1,0x246,0x1f1)+_0x42adde,_0x2e2e9b=_0x83f73d,_0x5c0a5e=_0x313f53,_0x314c4d[_0x1f161b(-0xe,-0x76,-0x131,-0x10b)](addLog,_0x3730d3(0x1c8,0x217,0x271,0x1bf)+'用直接请求模式');}else _0x536b5f[_0x3730d3(0x382,0x325,0x2f8,0x290)+_0x3730d3(0x38a,0x36f,0x329,0x34a)](_0x43299a,_0x3902d3);}_0x314c4d[_0x3730d3(0x19d,0x2dc,0x254,0x256)](addLog,_0x3730d3(0x2e4,0x312,0x2f6,0x35a)+_0x3730d3(0x417,0x2d6,0x36b,0x35b)+_0x1f161b(-0x8d,-0xb5,-0x7,-0x41)+_0x14d4e6),_0x314c4d['sZrAW'](addLog,_0x3730d3(0x32f,0x2c5,0x27c,0x2c8)+_0x1f161b(-0x11a,-0xd3,-0xd6,-0x2a)+JSON['stringify'](_0x5c0a5e,null,0x1*-0x1e2e+-0x2*-0x8c3+0xcaa));try{taskQueue[_0x1f161b(0x1b,-0x1e,0x39,0x67)+'us'](_0x46d3ca,_0x314c4d[_0x1f161b(-0x1a1,-0x14a,-0x202,-0xfe)]);const _0xaa97f5=await _0x314c4d[_0x3730d3(0x21a,0x27f,0x29a,0x258)](fetch,_0x14d4e6,{'method':_0x1f161b(0x92,-0x2a,-0x43,-0x8f),'headers':_0x2e2e9b,'body':JSON[_0x3730d3(0x2cb,0x2a4,0x2b5,0x2df)](_0x5c0a5e)});if(!_0xaa97f5['ok']){const _0x19904e=await _0xaa97f5['text']();throw new Error('API\x20reques'+_0x3730d3(0x37b,0x2d1,0x311,0x389)+_0x1f161b(-0x33,-0x70,-0x100,0x20)+'\x20'+_0xaa97f5[_0x1f161b(-0x2d,-0xb2,-0xa7,-0x118)]+':\x20'+_0x19904e);}const _0xa86bb7=await _0xaa97f5[_0x1f161b(-0x2a,-0x86,-0x41,-0x46)]();let _0x5a361d='';const _0x103bb2=_0xa86bb7[_0x3730d3(0x2b4,0x2fa,0x2a9,0x207)];if(_0x103bb2&&_0x314c4d[_0x1f161b(-0xe0,-0x8c,-0x131,-0x13a)](_0x103bb2[_0x3730d3(0x393,0x2f8,0x2dc,0x25e)],0x60*0x68+0x2565+0x9*-0x87d)){const _0x5aed29=_0x103bb2[-0x2352+0x1507*-0x1+0x241*0x19]['message']?.[_0x3730d3(0x2b3,0x381,0x32b,0x302)];if(Array[_0x1f161b(-0x17c,-0x14e,-0x106,-0xc6)](_0x5aed29))for(const _0x2b7e93 of _0x5aed29){if(_0x314c4d[_0x3730d3(0x3f7,0x38d,0x382,0x319)](_0x2b7e93[_0x3730d3(0x2dc,0x21a,0x2c0,0x2a5)],'image_url')&&_0x2b7e93[_0x3730d3(0x1fa,0x206,0x2b0,0x35e)]?.[_0x3730d3(0x292,0x3ff,0x348,0x2ab)]){_0x5a361d=_0x2b7e93[_0x1f161b(-0x61,-0xdd,-0xd6,-0x7d)][_0x3730d3(0x304,0x354,0x348,0x3f7)];break;}}else{if(_0x314c4d[_0x3730d3(0x2a1,0x2bf,0x2b3,0x331)](typeof _0x5aed29,_0x1f161b(-0xbe,-0x9b,-0xf2,-0xb3))){if(_0x314c4d[_0x3730d3(0x2b4,0x2f1,0x255,0x283)](_0x3730d3(0x1c9,0x1d9,0x262,0x1f5),_0x314c4d[_0x1f161b(-0x1b3,-0x118,-0xdc,-0x157)])){_0x314c4d[_0x3730d3(0x1e7,0x1de,0x293,0x24b)](_0x178287,_0x314c4d[_0x1f161b(0x54,-0x56,0x40,-0xc6)]);const _0x40c585=_0x35f193||'默认',_0x19f5b7={};_0x19f5b7['conversati'+'on']=[],_0x19f5b7[_0x1f161b(-0x9c,-0x131,-0xdb,-0xa2)+'t']='',_0x9a516b=_0x5ad572[_0x40c585]||_0x19f5b7,_0x50d1a0(_0x3730d3(0x20c,0x1f5,0x271,0x1c0)+_0x3730d3(0x399,0x30c,0x30f,0x2a4)+_0x40c585+'\x22');}else{const _0x1c9204=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x40df4a=_0x5aed29[_0x1f161b(0x35,-0x4c,0x61,0x51)](_0x1c9204);if(_0x40df4a&&_0x40df4a[0x184+-0x13cb+0x1248]){_0x314c4d[_0x1f161b(-0xd0,-0x125,-0xdf,-0x1a6)](addLog,_0x314c4d[_0x3730d3(0x374,0x371,0x328,0x283)]);const _0x31d6c8=_0x40df4a[-0x1*-0x1532+-0x218c+0xc5b];addLog(_0x3730d3(0x3c8,0x359,0x351,0x315)+_0x1f161b(-0x15c,-0xa9,-0x6c,-0x5c)+_0x1f161b(-0x104,-0xfc,-0xd9,-0xa8)+_0x31d6c8);try{const _0x45d311=await _0x314c4d[_0x1f161b(-0x8b,-0xbb,-0x5b,-0x16c)](fetch,_0x31d6c8);if(!_0x45d311['ok']){if(_0x3730d3(0x20d,0x2e8,0x24f,0x289)===_0x314c4d[_0x3730d3(0x301,0x1e8,0x2a3,0x233)])throw new Error(_0x3730d3(0x238,0x188,0x212,0x169)+_0x3730d3(0x389,0x2b7,0x361,0x384)+'e:\x20'+_0x45d311['status']);else _0x10560f[_0x40f541][_0x3730d3(0x1d2,0x255,0x230,0x1e0)][_0x1f161b(-0x139,-0xdb,-0x3f,-0x145)]=_0x314c4d[_0x3730d3(0x24b,0x31f,0x2de,0x30a)](_0x42e322[_0x2d71d6][_0x3730d3(0x24b,0x26c,0x230,0x230)]['cishu'],0x599*0x6+-0xce*0x2d+0x2a1),_0x314c4d[_0x1f161b(-0xcf,-0xfa,-0x1af,-0x163)](_0x2b7e59,_0x3730d3(0x37c,0x3e7,0x354,0x360)+_0x1f161b(0x71,-0x13,-0xc7,-0xc6)+_0x4585c8[_0x5aa909]['banana']['cishu']);}const _0x33fe7e=await _0x45d311[_0x3730d3(0x273,0x3bb,0x318,0x3b7)](),_0x31fb63=await new Promise((_0x18a96b,_0x24d766)=>{function _0x5ec82f(_0xca14b,_0x1ce583,_0x377a2b,_0x561219){return _0x1f161b(_0xca14b,_0x1ce583-0x4ea,_0x377a2b-0xf3,_0x561219-0x1d2);}const _0x30ea80=new FileReader();_0x30ea80[_0x4cf61a(-0x1a1,-0xe8,-0x182,-0xcd)]=()=>_0x18a96b(_0x30ea80['result']),_0x30ea80['onerror']=_0x24d766;function _0x4cf61a(_0x43e11c,_0x1fa487,_0x455883,_0x185751){return _0x3730d3(_0x185751,_0x1fa487-0x7d,_0x1fa487- -0x341,_0x185751-0xa3);}_0x30ea80[_0x5ec82f(0x39e,0x3d8,0x481,0x325)+_0x4cf61a(-0x12b,-0x128,-0x8b,-0x150)](_0x33fe7e);});_0x5a361d=_0x31fb63,_0x314c4d['BKrcc'](addLog,'[Banana]\x20S'+_0x3730d3(0x236,0x2af,0x261,0x300)+_0x3730d3(0x2cd,0x362,0x2ae,0x318)+'d\x20Markdown'+'\x20image\x20to\x20'+'base64.');}catch(_0x188c45){_0x314c4d['sZrAW'](addLog,_0x3730d3(0x265,0x26e,0x2e7,0x2cf)+_0x3730d3(0x20f,0x21d,0x29f,0x2ea)+'etch\x20Markd'+'own\x20image:'+'\x20'+_0x188c45[_0x1f161b(-0x113,-0x68,-0x18,-0x1b)]),_0x5a361d=_0x31d6c8,addLog(_0x314c4d[_0x1f161b(-0x5d,-0x49,0x2b,-0x4f)]);}}else _0x314c4d[_0x3730d3(0x3ed,0x3e5,0x34c,0x3bd)](addLog,_0x314c4d[_0x3730d3(0x24d,0x185,0x21f,0x258)]);}}}}if(!_0x5a361d){if(_0x314c4d[_0x1f161b(-0xc,-0xbd,-0x2,-0x6d)](_0x314c4d[_0x1f161b(-0xe5,-0x2e,0x38,-0xe9)],_0x314c4d[_0x3730d3(0x2bb,0x416,0x35f,0x3e9)]))throw new Error(_0x3730d3(0x33d,0x35f,0x2a5,0x2cc)+_0x1f161b(-0x112,-0x8b,0x24,-0x5a)+_0x1f161b(-0x1c5,-0x14c,-0x9c,-0xe1)+_0x3730d3(0x2f2,0x3d6,0x35e,0x3bc)+_0x1f161b(-0x65,-0xd6,-0x14c,-0x22)+'t');else{const _0x7cde55=_0x3730d3(0x2eb,0x2b4,0x33c,0x370)[_0x3730d3(0x2a7,0x2b5,0x2ca,0x2d1)]('|');let _0x54a654=0x73+-0x17d2+0x175f;while(!![]){switch(_0x7cde55[_0x54a654++]){case'0':_0x54ac94[_0x3730d3(0x2b9,0x2d3,0x321,0x2e1)](_0x314c4d['EDYyn'],_0x57b5ff);continue;case'1':_0x314c4d[_0x3730d3(0x204,0x257,0x294,0x2d5)](_0x5e3dac,_0x3730d3(0x32e,0x2e8,0x2e7,0x39b)+_0x3730d3(0x24d,0x32e,0x300,0x328)+':\x20'+_0xac1f5c[_0x1f161b(-0x12,-0x68,-0xaa,-0xc4)]);continue;case'2':_0x32894a=null;continue;case'3':if(_0x314c4d[_0x3730d3(0x38d,0x2cc,0x2e6,0x22e)](_0x33722c[_0x3730d3(0x27a,0x295,0x325,0x3e0)],_0x314c4d[_0x3730d3(0x315,0x3c0,0x324,0x274)])){}else _0x47580b[_0x1f161b(-0xed,-0xff,-0x155,-0x66)+'sk'](_0x4aa93a,![]);continue;case'4':throw _0x547aec;continue;}break;}}}return addLog(_0x314c4d[_0x3730d3(0x2ec,0x3c9,0x33b,0x341)]),taskQueue[_0x3730d3(0x279,0x228,0x28e,0x337)+'sk'](_0x46d3ca,!![]),currentTaskId=null,{'image':_0x5a361d,'change':_0x314c4d[_0x1f161b(-0xc8,-0xf8,-0x18b,-0xf5)](_0x4ff322,'')};}catch(_0xe266b4){if(_0x1f161b(0x52,-0x19,-0x1f,0x25)===_0x3730d3(0x2ef,0x210,0x2c8,0x327)){_0x314c4d[_0x3730d3(0x248,0x18b,0x231,0x20b)](_0x4f5720,_0x314c4d['BtXnA']),_0x2e87b5=_0x314c4d['iyMRY'](_0x3bc8b2,_0x8ae44c),_0xc2ff7c=_0x1e3607[_0x314c4d['OxgHj']];for(let _0x201c01=0x1*0x1471+-0x1*-0x4f2+-0x1962;_0x314c4d['ilQlQ'](_0x201c01,-0x19fa+-0x1581+0x2f7f);_0x201c01++){_0x5855c1[_0x1f161b(0x2,-0x7b,-0x2,-0xb9)+_0x201c01+'\x20Prompt']&&(_0x3b056b=_0x314c4d['AdlIb'](_0x2b1e62+',\x20',_0x491afb[_0x3730d3(0x36c,0x383,0x312,0x30d)+_0x201c01+_0x3730d3(0x327,0x282,0x2cb,0x2c2)]));}}else{const _0x3453e2=_0x1f161b(-0x98,-0x107,-0x119,-0xa5)[_0x3730d3(0x213,0x25e,0x2ca,0x2a9)]('|');let _0x14cb07=-0xd*0x72+-0x7ef+0xdb9;while(!![]){switch(_0x3453e2[_0x14cb07++]){case'0':throw _0xe266b4;continue;case'1':currentTaskId=null;continue;case'2':_0x314c4d['LSMKE'](addLog,_0x3730d3(0x2a7,0x37a,0x2e7,0x250)+_0x1f161b(-0x1d,-0x8d,0x1b,0x3)+':\x20'+_0xe266b4['message']);continue;case'3':if(_0xe266b4[_0x3730d3(0x29e,0x378,0x325,0x352)]===_0x314c4d[_0x1f161b(-0xc9,-0x69,-0xb9,-0xb3)]){}else taskQueue['completeTa'+'sk'](_0x46d3ca,![]);continue;case'4':console['error'](_0x1f161b(-0xb3,-0xa6,-0xd1,-0x144)+_0x1f161b(-0x6d,-0x8d,-0xd7,-0x7a)+':',_0xe266b4);continue;}break;}}}}export async function bananaGenerate(_0x41b740){const _0x516a00={'FCjyr':_0x2a8a57(0x19a,0x194,0xf7,0x99)+_0x2a8a57(0x88,-0x3,-0x26,-0x71)+'ana_task','unkMH':function(_0x48de3b,_0x14d704){return _0x48de3b(_0x14d704);},'FYogz':'banana\x20生图事'+_0x2a8a57(-0x8,0x82,0x13,0x7a),'VJUqT':function(_0x1e1782,_0x53445d){return _0x1e1782+_0x53445d;},'IeurR':'\x20|\x20','TDwGh':_0x3f5a7c(0x4fc,0x4b0,0x4be,0x479),'cPIir':'text','ibEHC':function(_0x395585,_0x5f26e9){return _0x395585(_0x5f26e9);},'cPwbc':function(_0x8220e0){return _0x8220e0();},'cTPkr':_0x3f5a7c(0x51a,0x46a,0x596,0x514),'rZWTg':function(_0x55369c,_0x2aa234){return _0x55369c===_0x2aa234;},'KEqRO':_0x2a8a57(0x60,0xcd,0xfd,0x1b7),'RQZET':'apHLI','vzbZM':function(_0x2e8679,_0x1cde8f){return _0x2e8679(_0x1cde8f);},'yzaJf':function(_0x1a8a26,_0x467250){return _0x1a8a26(_0x467250);},'lQrRA':function(_0x181176,_0x5dd38b){return _0x181176(_0x5dd38b);},'SpylA':function(_0x4e56ba,_0x4b4ebf){return _0x4e56ba!=_0x4b4ebf;},'pjGST':function(_0x10436a,_0x18c6a3){return _0x10436a===_0x18c6a3;},'bHKdn':_0x3f5a7c(0x577,0x547,0x51d,0x5a4),'bvJVf':function(_0x23a43f,_0x3ac781,_0x41e861,_0x219485){return _0x23a43f(_0x3ac781,_0x41e861,_0x219485);},'vPlRi':'SyGZi','NhsCr':_0x3f5a7c(0x5e1,0x600,0x5ba,0x5a8),'Noyby':function(_0x1a7c18,_0x280d2e){return _0x1a7c18(_0x280d2e);},'HGgaQ':function(_0x5af47b,_0x4b41ab){return _0x5af47b(_0x4b41ab);},'rnCeC':function(_0x5d95fb,_0x389441){return _0x5d95fb===_0x389441;},'WIHXK':'VFthe','pcVpI':function(_0x106a7f,_0x131c05){return _0x106a7f(_0x131c05);},'luoaz':function(_0x2686c7,_0x173c5f){return _0x2686c7(_0x173c5f);}};_0x516a00[_0x2a8a57(-0x50,0x9d,0xe,0xba)](clearLog);let {id:_0x580059,prompt:_0x368ce7,width:_0x4e86d6,height:_0x48767d,change:_0x215bca,retouchPrompt:_0x1625db,retouchImage:_0x1e3ab5}=_0x41b740;currentRequestId=_0x580059,currentPrompt=_0x368ce7,addLog(_0x3f5a7c(0x5ad,0x5a5,0x55d,0x57f)+_0x3f5a7c(0x637,0x619,0x5b8,0x61a)+_0x2a8a57(0x9e,0x71,0xdd,0xc3)+_0x2a8a57(0x8e,0x50,0x26,0x97)+_0x3f5a7c(0x4f6,0x54d,0x49e,0x4d3)+_0x580059+')');let _0x267fb2='';_0x215bca?_0x267fb2=_0x215bca[_0x2a8a57(0x0,0x63,0x25,-0x60)](_0x516a00[_0x2a8a57(0xdb,0x78,0x94,0x111)],''):_0x516a00[_0x3f5a7c(0x636,0x650,0x5cd,0x599)](_0x516a00['KEqRO'],_0x516a00[_0x2a8a57(0x7d,-0x76,-0x1e,-0x6)])?(_0xee3167['on'](_0x540436[_0x3f5a7c(0x51f,0x53f,0x5c0,0x50a)+_0x2a8a57(0x30,0x90,0xe6,0xa7)+'ST'],_0x4491c2),_0x8fa6f5['on'](_0x516a00[_0x2a8a57(0x11a,0x7,0x80,0x13b)],_0x2917d5),_0x516a00[_0x3f5a7c(0x5db,0x683,0x64a,0x565)](_0xa5a8f6,_0x516a00[_0x3f5a7c(0x4ef,0x562,0x52d,0x486)])):_0x267fb2=_0x368ce7;if(_0x215bca&&_0x215bca[_0x3f5a7c(0x5c9,0x593,0x55f,0x54c)](_0x2a8a57(-0x8d,0x89,-0xc,0x7f))){_0x516a00[_0x2a8a57(0xc4,0x17b,0x11c,0x150)](addLog,'Banana修图模式'+'启动');if(_0x1625db)_0x516a00[_0x3f5a7c(0x536,0x514,0x599,0x5c4)](addLog,_0x3f5a7c(0x4e9,0x54c,0x4a2,0x43f)+_0x1625db);if(_0x1e3ab5)_0x516a00[_0x2a8a57(0x14e,0x8e,0x107,0xdb)](addLog,'修图图片:\x20[已提供'+']');}function _0x3f5a7c(_0x2141fe,_0x2f2bb9,_0x3491d1,_0x5922b9){return _0x7807(_0x2141fe-0x358,_0x3491d1);}function _0x2a8a57(_0x1e32ae,_0x3c8140,_0x2b2bcc,_0x12cefe){return _0x7807(_0x2b2bcc- -0x1ce,_0x1e32ae);}try{const {image:_0x151846,change:_0x19893d}=await _0x516a00[_0x2a8a57(0xb2,0x9a,0x11c,0x124)](generateBananaImage,{'prompt':_0x368ce7,'width':_0x4e86d6,'height':_0x48767d,'change':_0x215bca,'retouchPrompt':_0x1625db,'retouchImage':_0x1e3ab5});if(_0x516a00[_0x3f5a7c(0x5d5,0x65b,0x584,0x67b)](extension_settings[extensionName][_0x2a8a57(0x3e,0xfa,0x9b,0x77)],'0')){if(_0x516a00[_0x3f5a7c(0x605,0x5f8,0x591,0x5da)](_0x516a00[_0x3f5a7c(0x613,0x6af,0x57c,0x5cb)],_0x3f5a7c(0x577,0x55a,0x57d,0x5b7))){const _0x379155={};_0x379155['change']=_0x267fb2,await _0x516a00[_0x3f5a7c(0x56d,0x5e1,0x4bb,0x58f)](setItemImg,_0x368ce7,_0x151846,_0x379155),addLog(_0x3f5a7c(0x5d7,0x593,0x5af,0x52c)+'or\x20prompt:'+'\x20'+_0x368ce7),extension_settings[extensionName][_0x2a8a57(0x5a,-0xa7,-0x29,-0x31)][_0x2a8a57(0x7,0xf7,0x59,0x5a)]?_0x516a00[_0x3f5a7c(0x5bc,0x606,0x50a,0x5ad)]!==_0x516a00[_0x3f5a7c(0x551,0x58e,0x597,0x5e3)]?(extension_settings[extensionName][_0x3f5a7c(0x4fd,0x51a,0x52a,0x564)][_0x2a8a57(0x90,0xb3,0x59,0x4)]=_0x516a00[_0x3f5a7c(0x4e2,0x47b,0x518,0x45d)](extension_settings[extensionName]['banana']['cishu'],0x1ee6+-0x25b6+0x15d*0x5),_0x516a00[_0x2a8a57(-0x14,-0x12,-0x2c,-0x25)](addLog,_0x2a8a57(0x15d,0x181,0xfb,0xce)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x3f5a7c(0x4fd,0x496,0x4db,0x54c)][_0x2a8a57(0x7a,0xe7,0x59,-0x2a)])):_0x24b8f9=_0x516a00['VJUqT'](_0x516a00[_0x3f5a7c(0x4e2,0x42e,0x475,0x58e)](_0x2c467c,_0x516a00[_0x3f5a7c(0x504,0x4cc,0x486,0x4b7)]),_0x516a00[_0x2a8a57(-0x5,0x119,0xb5,0x1b)](_0x508b05,_0x39a4cb[_0x2a8a57(0xf1,0x32,0xb9,0x2a)+_0x13803a+_0x3f5a7c(0x598,0x61a,0x4e1,0x512)])):(extension_settings[extensionName][_0x3f5a7c(0x4fd,0x44f,0x52d,0x470)][_0x2a8a57(-0x17,0x9f,0x59,-0x58)]=0xffa+-0x1978+0x1*0x97f,_0x516a00[_0x2a8a57(0x9d,0xc1,0x32,-0x69)](addLog,_0x2a8a57(0x13f,0x54,0xfb,0x146)+_0x2a8a57(0x7c,0x6e,0x121,0x16a)+extension_settings[extensionName]['banana']['cishu']));}else{const _0x2bfd52={};_0x2bfd52[_0x3f5a7c(0x4dd,0x4db,0x583,0x4a2)]=_0x516a00[_0x3f5a7c(0x57a,0x5a8,0x514,0x592)],_0x2bfd52[_0x2a8a57(0x140,0xae,0xd2,0x38)]=[{'type':_0x516a00['cPIir'],'text':_0x23ae85}],_0x50a001[_0x3f5a7c(0x4f5,0x456,0x516,0x518)](_0x2bfd52);}}else _0x516a00[_0x3f5a7c(0x506,0x467,0x510,0x535)]('VFthe',_0x516a00[_0x3f5a7c(0x585,0x506,0x4f0,0x54a)])?addLog('缓存设置为不存入数据'+'库'):_0x3b63a3[_0x2a8a57(0x14a,0x20,0xb9,0xd5)+_0x5b3580+_0x2a8a57(-0x10,0x18,0x72,-0x32)]&&(_0x398bde=_0x516a00[_0x3f5a7c(0x4e2,0x4a8,0x4ee,0x512)](_0x25ff07+_0x516a00[_0x2a8a57(-0x6d,-0x54,-0x22,0x47)],_0x516a00[_0x3f5a7c(0x555,0x4b9,0x5f5,0x598)](_0x13a7d6,_0x1e6a8a[_0x2a8a57(0xab,0x5f,0xb9,0xd3)+_0x1b6e2b+_0x2a8a57(0x46,-0x15,0x72,-0x35)])));const _0x26b43f={};_0x26b43f['id']=_0x580059,_0x26b43f[_0x2a8a57(0x80,0x6b,0x20,-0x11)]=!![],_0x26b43f[_0x3f5a7c(0x589,0x629,0x5eb,0x579)]=_0x151846,_0x26b43f[_0x2a8a57(0x1bb,0xc5,0x11e,0xfa)]=_0x368ce7,_0x26b43f[_0x3f5a7c(0x56a,0x4e3,0x515,0x5b0)]=_0x267fb2,eventSource['emit'](EventType['GENERATE_I'+_0x2a8a57(0x13d,0x16c,0x118,0xbe)+_0x3f5a7c(0x532,0x47e,0x55c,0x56c)],_0x26b43f),_0x516a00['pcVpI'](addLog,_0x3f5a7c(0x5e0,0x666,0x653,0x5db)+_0x3f5a7c(0x4fb,0x566,0x47a,0x46f)+'cess\x20respo'+_0x2a8a57(-0x16,-0x53,0x1,0x6b)+':\x20'+_0x580059);}catch(_0x191df2){const _0x127dd1=_0x3f5a7c(0x5f3,0x5a3,0x560,0x5b4)+_0x3f5a7c(0x60d,0x599,0x663,0x64b)+_0x2a8a57(0x6d,0x1,0x6d,0x50)+_0x2a8a57(0x0,0x86,0x1f,0xa0)+_0x580059+':\x20'+_0x191df2[_0x2a8a57(0x15a,0xeb,0xcc,0x4d)];_0x516a00['luoaz'](addLog,_0x127dd1),console[_0x2a8a57(0x157,0xae,0xc8,0x62)](_0x127dd1);const _0x42dff7={};_0x42dff7['id']=_0x580059,_0x42dff7[_0x3f5a7c(0x546,0x4fb,0x5ca,0x5aa)]=![],_0x42dff7[_0x3f5a7c(0x5ee,0x5b9,0x69a,0x5de)]=_0x191df2[_0x3f5a7c(0x5f2,0x55a,0x63b,0x56b)],_0x42dff7[_0x3f5a7c(0x644,0x5b0,0x5fd,0x6dc)]=_0x368ce7,eventSource[_0x2a8a57(-0x98,0x2c,-0x38,-0x75)](EventType[_0x2a8a57(0x3f,-0x6b,-0x7,-0x30)+_0x3f5a7c(0x63e,0x6e1,0x5e7,0x673)+_0x3f5a7c(0x532,0x575,0x56c,0x5bd)],_0x42dff7),_0x516a00[_0x3f5a7c(0x5db,0x533,0x5ae,0x625)](addLog,'[Banana]\x20E'+_0x3f5a7c(0x575,0x5fb,0x5d1,0x4bb)+_0x2a8a57(0x95,-0xa,0x53,-0x5e)+_0x3f5a7c(0x527,0x520,0x4d2,0x585)+':\x20'+_0x580059);}}function handleCancelBananaTask(_0x456ec7){const _0x54687a={'YOXeT':function(_0x502824,_0x2dd258){return _0x502824(_0x2dd258);},'gydLk':function(_0x2e27da,_0x3ffa32){return _0x2e27da===_0x3ffa32;},'bvWPR':function(_0x309d6a,_0xbd7c27){return _0x309d6a===_0xbd7c27;},'aOVsh':_0x4e3ebe(0x3c9,0x355,0x29a,0x401),'UlMNp':_0x4e3ebe(0x312,0x36b,0x2dd,0x391),'wtBYR':_0x12b976(-0xd3,-0x74,-0xbc,-0x5c),'fwuPa':function(_0x42fc4c,_0x18bddc){return _0x42fc4c||_0x18bddc;}};function _0x12b976(_0x5146a0,_0x5a9189,_0x26f84b,_0x24fe08){return _0x7807(_0x5146a0- -0x315,_0x5a9189);}const {taskId:_0x4826f3}=_0x456ec7;addLog(_0x12b976(-0x53,-0x7,-0xe5,0x5f)+_0x4e3ebe(0x36f,0x2f8,0x31c,0x352)+_0x4e3ebe(0x334,0x2e0,0x274,0x294)+_0x4826f3+')');function _0x4e3ebe(_0x4711f3,_0x6b6241,_0x2792cd,_0x56a535){return _0x7807(_0x6b6241-0x8e,_0x4711f3);}if(_0x54687a['gydLk'](currentTaskId,_0x4826f3)&&currentRequestId){if(_0x54687a['bvWPR'](_0x54687a[_0x4e3ebe(0x211,0x25a,0x257,0x1dc)],_0x54687a[_0x4e3ebe(0x279,0x310,0x257,0x3c7)])){const _0x15018f=_0x12b976(-0x7a,-0xb7,0x2c,-0x7)+_0x12b976(-0x60,0x17,-0x1,-0x36)+'failed\x20for'+_0x12b976(-0x128,-0xe2,-0xc9,-0x1dd)+_0x8b8d45+':\x20'+_0x6d1772['message'];_0x54687a[_0x4e3ebe(0x2f8,0x272,0x2c9,0x2b6)](_0x232646,_0x15018f),_0x88585[_0x4e3ebe(0x370,0x324,0x3a6,0x3d6)](_0x15018f);const _0x40f86a={};_0x40f86a['id']=_0x5a4528,_0x40f86a[_0x12b976(-0x127,-0x174,-0x128,-0xeb)]=![],_0x40f86a['error']=_0x119704[_0x12b976(-0x7b,-0x78,-0x33,-0x73)],_0x40f86a['prompt']=_0x5d8ac0,_0x3b21b8[_0x12b976(-0x17f,-0x197,-0x21b,-0x144)](_0x3e920e[_0x4e3ebe(0x1d9,0x255,0x2ff,0x1e1)+_0x4e3ebe(0x338,0x374,0x2e9,0x39e)+_0x12b976(-0x13b,-0x1b0,-0xa0,-0x125)],_0x40f86a),_0x3d8fcb('[Banana]\x20E'+'mitted\x20fai'+_0x12b976(-0xf4,-0x115,-0xdc,-0x9d)+_0x4e3ebe(0x2a7,0x25d,0x1fe,0x26f)+':\x20'+_0x1cd731);}else{const _0x2a6f3f=_0x54687a[_0x12b976(-0x45,0x35,-0x10,-0xb0)][_0x12b976(-0xd6,-0x22,-0x71,-0x11b)]('|');let _0x407143=-0x4be*0x1+0x13e0+-0xf22;while(!![]){switch(_0x2a6f3f[_0x407143++]){case'0':currentRequestId=null;continue;case'1':eventSource[_0x4e3ebe(0x259,0x224,0x193,0x1b5)](EventType[_0x12b976(-0x14e,-0xa5,-0x1ce,-0xb8)+_0x12b976(-0x2f,0x72,0x1f,0x84)+_0x4e3ebe(0x249,0x268,0x28b,0x2b5)],{'id':currentRequestId,'success':![],'error':_0x12b976(-0x13c,-0x1a5,-0xb2,-0xd9),'prompt':_0x54687a[_0x12b976(-0x152,-0x195,-0x125,-0x1ac)](currentPrompt,'')});continue;case'2':currentPrompt=null;continue;case'3':currentTaskId=null;continue;case'4':addLog(_0x4e3ebe(0x2c1,0x295,0x24f,0x350)+_0x4e3ebe(0x247,0x2be,0x31d,0x360)+_0x12b976(-0x46,-0xe5,-0x100,0x41)+currentRequestId+')');continue;}break;}}}}function initializeBananaListener(){const _0x2b6f3b={};_0x2b6f3b[_0x515214(0x33f,0x3e0,0x3b4,0x470)]=_0x4a4e5a(0xf,-0x2a,0x8d,-0x20)+_0x515214(0x2a8,0x28f,0x2b6,0x338)+_0x4a4e5a(0xef,0xac,0x84,0x5);function _0x4a4e5a(_0x499ccb,_0x25c1fb,_0x50918f,_0x23cb4c){return _0x7807(_0x50918f- -0x238,_0x23cb4c);}function _0x515214(_0x39869d,_0x17654d,_0x55cc53,_0x1e68ad){return _0x7807(_0x17654d-0xe7,_0x39869d);}_0x2b6f3b[_0x4a4e5a(-0x2f,0x1,0x1,-0x12)]=_0x515214(0x2e2,0x2df,0x236,0x318)+_0x4a4e5a(-0x18,-0x64,-0x57,-0x7c);const _0x53b601=_0x2b6f3b;eventSource['on'](EventType[_0x4a4e5a(0x16,-0x21,-0x71,-0x39)+_0x515214(0x456,0x39b,0x356,0x330)+'ST'],bananaGenerate),eventSource['on'](_0x53b601[_0x4a4e5a(0x62,0xe1,0xc1,0x4e)],handleCancelBananaTask),addLog(_0x53b601[_0x515214(0x328,0x320,0x35d,0x27c)]);}export async function replaceWithBanana(){function _0x248771(_0x5d4a05,_0x38b410,_0xd16ef8,_0x283b1b){return _0x7807(_0xd16ef8- -0x338,_0x5d4a05);}const _0x184d1e={'WJaGS':function(_0x50535f,_0x11a5e0){return _0x50535f==_0x11a5e0;},'lBhiM':function(_0x422c21,_0x537e75){return _0x422c21===_0x537e75;},'ZAiPK':_0x248771(-0x9,-0x16,-0x5c,-0xa4),'ousvX':'hnZYv','QdOgO':function(_0x2b6c16){return _0x2b6c16();},'MpuPJ':_0x474f10(0x626,0x67f,0x6a3,0x634),'LDRai':function(_0x252a1b,_0x11a9eb){return _0x252a1b(_0x11a9eb);},'HiTca':_0x248771(-0xa9,-0x1c8,-0x137,-0x1e4)+_0x474f10(0x67f,0x595,0x59c,0x5db),'KDASy':_0x474f10(0x690,0x616,0x635,0x680)+_0x248771(-0x122,-0x1bd,-0x190,-0x12e)+'ana_task'};function _0x474f10(_0x5d59e5,_0x1091ab,_0x14121,_0x1c2967){return _0x7807(_0x1c2967-0x3bb,_0x1091ab);}if(_0x184d1e['WJaGS'](extension_settings[extensionName][_0x474f10(0x550,0x4d5,0x636,0x586)],_0x248771(-0x17e,-0xf5,-0x193,-0x1bb))){if(_0x184d1e['lBhiM'](_0x184d1e[_0x248771(-0x215,-0x1d5,-0x17c,-0x135)],_0x184d1e['ousvX'])){const _0x1dadab={};_0x1dadab[_0x474f10(0x5fd,0x536,0x5fd,0x578)+'on']=[],_0x1dadab['fixedPromp'+'t']='',_0xd23bd6=_0x394c37[_0x5b83a5]||_0x1dadab;}else!window[_0x248771(-0x105,-0xce,-0x165,-0x1c4)+_0x474f10(0x56b,0x628,0x595,0x5ed)+_0x474f10(0x6fd,0x5be,0x61c,0x659)]&&(window[_0x248771(-0x15d,-0x155,-0x165,-0x1b2)+_0x248771(-0x91,-0x6b,-0x106,-0x101)+_0x248771(-0x4f,-0x13c,-0x9a,0x19)]=!![],_0x184d1e[_0x474f10(0x719,0x6bc,0x61e,0x6a9)](initializeBananaListener)),_0x184d1e[_0x248771(0x5f,0x33,-0x4a,-0xb7)](initializeImageProcessing);}else{if(window[_0x248771(-0x1e6,-0x1e3,-0x165,-0x158)+'BananaList'+_0x474f10(0x6eb,0x66f,0x5b7,0x659)]){const _0x28d83c=_0x184d1e[_0x248771(-0x168,-0xf7,-0xf0,-0x179)][_0x248771(-0x123,-0x14e,-0xf9,-0x113)]('|');let _0x57b4a1=-0x115d+0x164a*-0x1+-0x27a7*-0x1;while(!![]){switch(_0x28d83c[_0x57b4a1++]){case'0':eventSource[_0x474f10(0x620,0x5f1,0x5dc,0x628)+_0x248771(-0xc0,-0x149,-0x9a,-0xb8)](EventType[_0x248771(-0x11b,-0x157,-0x171,-0x127)+_0x474f10(0x5f4,0x691,0x685,0x66f)+'ST'],bananaGenerate);continue;case'1':LEGACY_EVENT_NAMES['forEach'](_0x4703c9=>{eventSource['removeList'+'ener'](_0x4703c9,bananaGenerate);});continue;case'2':window[_0x474f10(0x525,0x517,0x5d8,0x58e)+_0x474f10(0x620,0x607,0x62b,0x5ed)+_0x248771(0x5,-0x126,-0x9a,-0x113)]=![];continue;case'3':_0x184d1e['LDRai'](addLog,_0x184d1e[_0x248771(-0x156,-0x211,-0x177,-0x19b)]);continue;case'4':eventSource[_0x248771(-0x95,-0xb0,-0xcb,-0x179)+_0x474f10(0x5f8,0x6f4,0x63d,0x659)](_0x184d1e[_0x248771(-0x203,-0x15f,-0x19f,-0x1a3)],handleCancelBananaTask);continue;}break;}}}}