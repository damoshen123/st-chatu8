(function(_0x27046c,_0xceb696){function _0x5347c3(_0x2f1f08,_0x816cb9,_0x3b9b04,_0xdae6fd){return _0x2ea0(_0x816cb9- -0x134,_0x2f1f08);}const _0x44a42a=_0x27046c();function _0x3b729b(_0x3f0748,_0xfc1ef2,_0x257b70,_0x21ab03){return _0x2ea0(_0x21ab03-0xc6,_0x257b70);}while(!![]){try{const _0xbe2ec6=-parseInt(_0x5347c3(0x14d,0x13a,0x165,0x1c9))/(0xa49+-0xca3*0x2+-0x1*-0xefe)+parseInt(_0x3b729b(0x390,0x2f4,0x2f4,0x365))/(0x1*0x71e+0x1f43*-0x1+0x1827)*(parseInt(_0x3b729b(0x37e,0x261,0x261,0x306))/(0x1*0x24b5+0x144f+-0x3901*0x1))+-parseInt(_0x3b729b(0x326,0x44e,0x312,0x38d))/(0x1*0x1253+0x959+0xa*-0x2c4)*(parseInt(_0x3b729b(0x2c5,0x250,0x232,0x211))/(0xa5+0x159d+-0x163d*0x1))+-parseInt(_0x3b729b(0x303,0x2bc,0x2e2,0x375))/(0xdbd+0x1*-0x412+0x1*-0x9a5)+parseInt(_0x5347c3(0x101,0x108,0xd5,0x1be))/(-0xd0a+0x274*-0x4+0x16e1)*(parseInt(_0x3b729b(0x271,0x38f,0x31d,0x30d))/(-0x74d+0x1a4+0x5b1))+-parseInt(_0x5347c3(0x1d0,0x158,0x18b,0x197))/(0x1889+-0x11ec+-0x4*0x1a5)+-parseInt(_0x5347c3(0x34,0x7e,0x23,0x94))/(0x26*-0xce+-0x98*0x1c+-0x1*-0x2f3e)*(-parseInt(_0x5347c3(0xa0,0xe,-0x51,0x4f))/(-0xb75+0x1be*0x13+-0x159a));if(_0xbe2ec6===_0xceb696)break;else _0x44a42a['push'](_0x44a42a['shift']());}catch(_0x31879a){_0x44a42a['push'](_0x44a42a['shift']());}}}(_0x5d61,0x120f*0x2c+-0x1*0x43231+0x42d15));const _0x212c39=(function(){const _0x96aa38={'IUDzn':function(_0xcf6f4e,_0x5ad6d2){return _0xcf6f4e===_0x5ad6d2;},'weDCP':_0x1d11ca(0xcb,0x7,0x8c,0x51),'FHfRe':function(_0x41ed96,_0x4abc48){return _0x41ed96!==_0x4abc48;},'KIRFV':'vwNgx','BqkLR':_0xeebceb(0x10a,0x1ff,0x134,0x154),'oKAFG':function(_0x1b434c,_0x17c177){return _0x1b434c(_0x17c177);},'MsrUX':_0x1d11ca(0xba,-0x30,-0x31,0x56)};function _0xeebceb(_0x4e1f2b,_0x47dd75,_0x5e0280,_0x40c5f0){return _0x2ea0(_0x40c5f0- -0x123,_0x5e0280);}let _0x3729f6=!![];function _0x1d11ca(_0x519d0d,_0x412c11,_0x27d496,_0x2e6b1f){return _0x2ea0(_0x2e6b1f- -0x22b,_0x519d0d);}return function(_0x522c6e,_0x5bead7){const _0x14c1c9={'UWMBg':_0x96aa38[_0x5c1924(0x2cc,0x302,0x339,0x386)],'pDclQ':function(_0x4bf58c,_0x48bb37){return _0x96aa38['oKAFG'](_0x4bf58c,_0x48bb37);},'yfwNT':_0x96aa38[_0x11768e(0x48b,0x3e9,0x468,0x463)],'gNOAN':function(_0x3f55fb,_0x3140b4){return _0x3f55fb||_0x3140b4;}},_0x46a61b=_0x3729f6?function(){function _0x512692(_0x47dc6b,_0x3ae136,_0x47cb7d,_0x40a33f){return _0x11768e(_0x47dc6b-0x110,_0x47dc6b-0x21,_0x3ae136,_0x40a33f-0x11d);}function _0x1e10eb(_0x18ddd0,_0x2c06d9,_0x53972d,_0x354e3f){return _0x5c1924(_0x18ddd0-0x1f4,_0x18ddd0- -0x13b,_0x53972d,_0x354e3f-0x80);}if(_0x96aa38['IUDzn'](_0x96aa38[_0x512692(0x372,0x2b1,0x2df,0x3c4)],_0x96aa38[_0x512692(0x372,0x326,0x35f,0x2f9)])){if(_0x5bead7){if(_0x96aa38['FHfRe'](_0x96aa38[_0x512692(0x42f,0x4ea,0x4c5,0x3e8)],_0x512692(0x345,0x35b,0x282,0x2f4))){const _0x1fc581=_0x14c1c9[_0x1e10eb(0x20b,0x1c7,0x168,0x2b3)][_0x512692(0x366,0x2e8,0x2c5,0x406)]('|');let _0x5a8d91=0x2*0xa42+-0x23a9+-0xf25*-0x1;while(!![]){switch(_0x1fc581[_0x5a8d91++]){case'0':_0x324757=null;continue;case'1':_0x14c1c9[_0x1e10eb(0x26d,0x1e0,0x20e,0x2f1)](_0x17b81b,_0x512692(0x31e,0x38e,0x33b,0x3e1)+_0x1e10eb(0x203,0x147,0x147,0x1b5)+_0x512692(0x2c5,0x23f,0x334,0x357)+_0x108c53+')');continue;case'2':_0x284034=null;continue;case'3':_0x5d66e8['emit'](_0x131e1f['GENERATE_I'+'MAGE_RESPO'+_0x512692(0x308,0x374,0x24e,0x26e)],{'id':_0x4a22c4,'success':![],'error':_0x14c1c9[_0x512692(0x3b5,0x2fc,0x3bf,0x40b)],'prompt':_0x14c1c9[_0x512692(0x340,0x2f9,0x2d3,0x298)](_0x400375,'')});continue;case'4':_0x3c3eb5=null;continue;}break;}}else{const _0x452745=_0x5bead7[_0x1e10eb(0x1e8,0x1c9,0x14e,0x257)](_0x522c6e,arguments);return _0x5bead7=null,_0x452745;}}}else{const _0x329823=new _0x27d7e8();_0x329823['onloadend']=()=>_0x1e7ea9(_0x329823[_0x512692(0x350,0x406,0x33d,0x291)]),_0x329823[_0x1e10eb(0x232,0x192,0x24a,0x192)]=_0x570de3,_0x329823[_0x512692(0x444,0x44b,0x458,0x384)+_0x512692(0x360,0x415,0x3ec,0x310)](_0x490357);}}:function(){};function _0x11768e(_0x4a7c65,_0xad6a7c,_0x3ba4b6,_0x32483a){return _0x1d11ca(_0x3ba4b6,_0xad6a7c-0xd3,_0x3ba4b6-0x19,_0xad6a7c-0x38f);}_0x3729f6=![];function _0x5c1924(_0x53c262,_0x27cb1e,_0x269f43,_0x2415ae){return _0xeebceb(_0x53c262-0xb2,_0x27cb1e-0x12c,_0x269f43,_0x27cb1e-0x21b);}return _0x46a61b;};}()),_0x3aa75c=_0x212c39(this,function(){const _0x22e42f={};function _0xe49d1d(_0x262689,_0x77ac61,_0x57edef,_0x2cd5dd){return _0x2ea0(_0x2cd5dd-0x16c,_0x77ac61);}function _0xc93112(_0x2b90df,_0x2d0cde,_0x26c2b3,_0x7afad){return _0x2ea0(_0x26c2b3-0x2f3,_0x2d0cde);}_0x22e42f[_0xc93112(0x564,0x427,0x4de,0x50e)]=_0xc93112(0x505,0x575,0x515,0x495)+'+$';const _0x5bc6ee=_0x22e42f;return _0x3aa75c[_0xe49d1d(0x364,0x2e8,0x2bf,0x2cf)]()[_0xe49d1d(0x357,0x391,0x2bd,0x2de)]('(((.+)+)+)'+'+$')['toString']()['constructo'+'r'](_0x3aa75c)[_0xe49d1d(0x256,0x22b,0x2b1,0x2de)](_0x5bc6ee[_0xe49d1d(0x363,0x3ad,0x39e,0x357)]);});_0x3aa75c();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';function _0x2ea0(_0x54c9ca,_0x413178){_0x54c9ca=_0x54c9ca-(0x7dd+-0x11*-0x146+-0x1c48);const _0xc6eb1c=_0x5d61();let _0x408b57=_0xc6eb1c[_0x54c9ca];if(_0x2ea0['cNxJAf']===undefined){var _0x5118ce=function(_0x1ac417){const _0x11db18='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1e6169='',_0x20c239='',_0x13e1a8=_0x1e6169+_0x5118ce;for(let _0x540ace=-0xdf+-0x1527+0x1606,_0x4f59c6,_0x54e9d3,_0x114d64=0x7cd*-0x5+0xbd9*-0x2+0x3eb3;_0x54e9d3=_0x1ac417['charAt'](_0x114d64++);~_0x54e9d3&&(_0x4f59c6=_0x540ace%(-0x1*-0x14a9+-0x3*-0x597+0x2*-0x12b5)?_0x4f59c6*(-0x19a1+0x222c+-0x84b)+_0x54e9d3:_0x54e9d3,_0x540ace++%(0x114b*-0x1+0x13*-0x1cd+-0x3386*-0x1))?_0x1e6169+=_0x13e1a8['charCodeAt'](_0x114d64+(0x9b8+-0x167*0x10+0xcc2))-(-0x6f9+0x1*0x72d+0xe*-0x3)!==0x13*-0x1c1+-0x1185+0x32d8?String['fromCharCode'](0x121d+-0x12d5*-0x1+-0x23f3&_0x4f59c6>>(-(-0x79f+-0x3cc+0xb6d)*_0x540ace&-0xb2*0x1b+0x1*0xe6b+0x461)):_0x540ace:0x15d1*-0x1+-0x4ad+0x1*0x1a7e){_0x54e9d3=_0x11db18['indexOf'](_0x54e9d3);}for(let _0x2beb6f=-0x56*0xc+0xa*0x255+0x9a5*-0x2,_0x498cd0=_0x1e6169['length'];_0x2beb6f<_0x498cd0;_0x2beb6f++){_0x20c239+='%'+('00'+_0x1e6169['charCodeAt'](_0x2beb6f)['toString'](-0x1bd3+0x1130+0xab3))['slice'](-(0x14d2+0x1f0d+-0x33dd));}return decodeURIComponent(_0x20c239);};_0x2ea0['NejOaM']=_0x5118ce,_0x2ea0['VRjFfB']={},_0x2ea0['cNxJAf']=!![];}const _0x20aad3=_0xc6eb1c[0x2096+-0x15d5+-0xac1],_0x2eef47=_0x54c9ca+_0x20aad3,_0x4f0f20=_0x2ea0['VRjFfB'][_0x2eef47];if(!_0x4f0f20){const _0x4b78b5=function(_0x3cb908){this['zquADd']=_0x3cb908,this['HfTgEe']=[0x2539+-0x341+-0x5*0x6cb,-0xb*0xb2+0x207d+-0x18d7*0x1,-0x4*0x526+-0x26e+0xe*0x1a5],this['TQadvm']=function(){return'newState';},this['aoaDfO']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['JmUdxJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4b78b5['prototype']['HKprjF']=function(){const _0x56a550=new RegExp(this['aoaDfO']+this['JmUdxJ']),_0x41d179=_0x56a550['test'](this['TQadvm']['toString']())?--this['HfTgEe'][-0x35*-0x67+-0x4*0x6f2+-0x33b*-0x2]:--this['HfTgEe'][-0x370+-0x2634+0x29a4];return this['QvhpWf'](_0x41d179);},_0x4b78b5['prototype']['QvhpWf']=function(_0x1bc979){if(!Boolean(~_0x1bc979))return _0x1bc979;return this['tBDjVO'](this['zquADd']);},_0x4b78b5['prototype']['tBDjVO']=function(_0x40c50){for(let _0x32ca18=-0x23e2+0x1d*-0xbf+-0x307*-0x13,_0x1aac26=this['HfTgEe']['length'];_0x32ca18<_0x1aac26;_0x32ca18++){this['HfTgEe']['push'](Math['round'](Math['random']())),_0x1aac26=this['HfTgEe']['length'];}return _0x40c50(this['HfTgEe'][0xbb1+0x25c6+-0x107d*0x3]);},new _0x4b78b5(_0x2ea0)['HKprjF'](),_0x408b57=_0x2ea0['NejOaM'](_0x408b57),_0x2ea0['VRjFfB'][_0x2eef47]=_0x408b57;}else _0x408b57=_0x4f0f20;return _0x408b57;}import{setItemImg}from'./database.js';function _0x5d61(){const _0x24184f=['Ewz3tLq','DhLorgG','Bw9KzwW','D2L0AcbWCM9TCa','zcbnyxjRzg93BG','BNrHAw5ZihrLEa','y29UDgvUDa','BwvZC2fNzq','wKDpDvK','C2uGzgLKig5VDa','CIbWCM9TChq6ia','AuPrsMW','ndy5DuPlrhv1','BIbWyxLSB2fKia','w0jHBMfUyv0G55sF','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','nZa2nurOCfveAW','5O6L6k+35Rgc','5l+U5zU+5OYh5lUKoIa','C2fTCgXLq291BG','ALn0qxq','5yMn572U5zco','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','mZi1nZzjEMnWAeq','zw5LCG','qxbRz3u','zMretLK','DgfYDgLUzYbPBq','EsbLEhrYywn0zq','vMDtB2e','vvDnqMC','z2vIt0y','DvjwqK0','ExnAteW','w0jHBMfUyv0GuW','ue9tva','5zco572U5zco','vgDkvw8','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','BwvZC2fNzxm','AvrZB2S','r1DgAwO','C2v0ici','DxjS','AxrjwKe','yxbWBgLJyxrPBW','zLrpq0W','ig1LC3nHz2vZlG','CgfYyw1LDgvYCW','C2rnqNq','tufhrv9srvfvrq','yMfZzty0lG','BgvUz3rO','AuHWEuC','C1PxDwS','q29UDgvUDc1uEq','ywLSzwqGDg8GzG','y2HHBMDL','y2zNAw1NxW','D0DiAum','CMvTB3zLtgLZDa','zxrPB25FC291CG','mZe4otbuBxPXwvC','DwnJzxnZzNvSBa','BI9QC29U','Euv4DKK','AxrnueK','CujfAum','w0jHBMfUyv0Gua','B25LCNjVCG','D2fSrvK','mxWZFdb8mNW0','DfnhAfi','ENLxDKG','ihWG','AML1z3vHBG','Bvn5EKC','qMfUyw5HtgLZDa','yKvrBve','zML4zwrqCM9TCa','u2nLBMuGq29TCa','5lU75yQH5BEY5y+w5RAi','ww91vMe','ztOG','y2nJr0m','txnYvvG','DdOG','ifbYB21WDa','t1L4yKm','D2nJqLK','C3nMDwXSEs4','y1vZCMu','mZqYodq3oeTYAgTLDa','w0jHBMfUyv0G5l2/','sgLSzuW','EwfTA0y','BwfNzsbMCM9Tia','quDbCfG','yxL6CNK','Agzhrva','ChjVBxb0','BwfNzw4G5QIH5z6l5lIn5PsV','vLHoAKS','y2LZAhu','CMvWBgfJzq','sxzID0G','Dg9Rzw4','qMvHCMvYia','C3rFy2HHDhu4xW','Bw9Kzq','qvvwvLm','mtaWsfjfBgvQ','5yMn572U5yMn','rfr3wxa','w0jHBMfUyv0GrG','zMv0y2GGAw1HzW','s2rUwwu','C3rYzwfT','mxW0Fdb8m3WY','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','CKXzA0O','y1Dsu2K','s0LsrLy','Aw9U','DhjPBq','C1HbuKO','Aw5NihrYAwDNzq','nte5odC2r1zKrhDm','CerJBfe','Aw1Hz2vdB25MAq','yxnWzwn0uMf0Aq','DxnLCG','Auzqru4','DwLSDcbjBwfNzq','AKn3t1e','BNHWC3y','zw5LCMf0Aw9Uia','ANnVBG','zxiG','tufhrv9srvnqtW','t05mDuW','y29UC3rYDwn0BW','Aw1Hz2u','CMvHzefZrgf0yq','sLDPwNm','zKTht2S','y2HVAwnLCW','C3rHDhvZ','q0H2DhK','qujtwe8','zgvSCY8','mtjeDeDhrKy','l2DLBMvYyxrL','zxrJAcbLCNjVCG','vwDMDMG','Ee5hr3a','yMfUyw5H','5zon5BQuicHjrdOG','zxnWB25ZzsbJBW','nZDbz3PwEvi','C3qGkeLeoIa','B1HZt0K','ywDLifvstdOG','CIaI','vxLqAg0','zxLcy2O','yxnZAxn0yw50','Evn0B3y','mZiYmdG1rxbJsKfl','zMLSDgvY','v3nwy3q','qKfoqu5b','C3rYAw5N','qxv0Ag9YAxPHDa','BwPuA2K','55sO5lQgihVKV67LM759ioAGH+IVHG','y2XPzw50','q2HHCMfJDgvYia','Aw1Hz2vjza','r0f5txO','vhfMsxm','E+s/RUwBVN0','C3vIC3rYAw5N','B3nPDgLVBG','y2fUy2vSx2jHBG','zvzTyM4','BgvZktOG','5Q2J6z2I5O+q56s66k+noIa','w0jHBMfUyv0GqG','CeruuuW','B3vUzcbTyxrJAa','ve9AANe','Dg9tDhjPBMC','qvbjihjLCxvLCW','A25Sug4','EKLyreC','BvHethm','shjTsvG','wxv1qMq','zM9YrwfJAa','rfPlwwq','DMzuthy','zcbIyxnLnJqGAq','AxnbCNjHEq','yMXVyG','B1v4EuW','DM5rDve','C2vHCMnO','wLPhsKG','twfYA2rVD24U','s2XQuMu','sgLws0e','AfP6A0q','teHzD3q','tu53seG','v0fhCNO','shPtwNq','r3DksuK','serUsvm','uKjcCwm','te1xz1O','r3vswgO','Bwr4Afe','A3j3t1u','tLnf','r0vorvjbvevFsq','sMvzsvq','qxnAq20','BLbQzfi','r2ndEeG','l3yXyMv0ys9TBW','tvDdrLy','DgLVBIb3AxrOia','w0jHBMfUyv0GrW','Aw5JBhvKzxm','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','ywDLigDLBMvYyq','zff2Dg4','y29TCgXLDgvuyq','y2HHDf9JB21WBa','rgzoz1q','zxrJAcbnyxjRza','zvnUu1K','v2rtu3a','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','CeHVB3K','w0jHBMfUyv0G5y+w','Aw1Hz2veyxrH','l2fWAs9IywnRzq','zxjYB3i','EsbJB252zxj0zq','EfPRr04','55Qe5zU+54Mh','C3rYAw5NAwz5','rfPYwge','qK9muMq','AhvVruy','Aw1Hz2vFDxjS','B1zTteq','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','qMLzvKS','vvD5CLK','C25xyvi','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','DNnrs2q','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','vLPbEha','qMfUyw5H5l+U5zU+5QIH5BYp','CNvUBMLUzW','C3vJy2vZCW','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','nZiWmZCWwuTzBMH4','wwnHBfq','Aw1Hz2vU','sezZqNm','CMjeu2K','C3rHCNrZv2L0Aa','igLTywDLlG','l3yXlW','zw1PDa','z05pqu4','ywrKvgfZAW','ywXSyMfJAY4','rLDWvhG','t0rzENK','DNDoz3G','DxbTDM4','C2LUzYbKAxjLyW','rwzKvhq','BhvYzsbYzxnWBW','zwrKzwqGyMfZzq','EwrOuNm','uuXvrfG','CM9Szq','ignVBNrHAw4GAq','zeX0swG','CMvZDwX0','BNnLigzVCIbjra','DhLWzq','tffoqvC','BKrAs20','CurLqxe','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Aw5PDgLHBgL6zq','B25SB2fKzw5K','y3vZDg9Tx2LUyW','Aw5ZDgfUy2vZ','w0jHBMfUyv0Grq','z3nVDu8','yMfUyw5Hq2HHCG','A1zmBhy','5zU+5QIH5BYp77YA5OYh5lUKid0G','vvjm','Aw5jAwq','ChvZAa','w0jHBMfUyv0G5zcV','y2vZCYbYzxnWBW','yxrLzcbZDwnJzq','C3bSAxq','BNnWqNm','CezvEuC','wxf5Bgu','r2LRBwO','qMjwvwm','qKLPEhC','DxbKyxrLu3rHDa','zfPWv3G','AMPxv24','qLfPDe4','Bwf0y2G','D2veq1a','vhHsAfm','tePTEfa','CNP4veG','zxrPyLC','5zco572U5yMn','B3iGChjVBxb0oG','w0jHBMfUyv0G5Ps2','t2HoCei','BND2yLm','5lIT55QeihbYB21WDooaGG','s2nUz0S','kerPDMLKzv9YBW','qLfOvui','B3DUigLTywDLoG','zxrLy3rLzcbnyq','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','yuT1B1i','vw5rBKG','AxDvC3i','DwvZDcb0BZOG','yxnRsuq6ia','w0jHBMfUyv0G5l+U','Dw1UB0e','Bxb0','BwfW','yxjRzg93BIbPBq','y2fJAgu','mxWYFdn8mhW0','qNfRtfi','Dgv4Da','rKXpB2u','B21WBgv0Aw9UCW','igLTywDLihrVia','y29UDMvYC2f0Aq','AM9PBG','l3yX','tuT5BKy','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','zgr0A0y','v2PeuvO','ieLeia','rgDisum','nJqGAw1Hz2uU','rvnezM8','B0TezMS','rMfPBgvKihrVia','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','Cg9ZDgzPEfbYBW','w0jHBMfUyv0GuG','w0jHBMfUyv0Gsq','v0T1Dfm','kcGOlISPkYKRkq','qvbjihjLC3bVBG','Bw9KzwW6ia','5PYa5zco572U','zxbuvfa','y1vVBeO','v1jsB3O','zw5KC1DPDgG','lI4U','yxbWBhK','zgf0ytPPBwfNzq','DcbVBMX5lcbUBW','swXpwe8','tMnpuKK'];_0x5d61=function(){return _0x24184f;};return _0x5d61();}import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x38af89){const _0x3f75ba={'yamkF':function(_0x59eed4,_0x273f98){return _0x59eed4+_0x273f98;},'dLtIh':_0x4a98bc(0x266,0x31e,0x252,0x329),'oUxyL':function(_0x4d9165,_0x19878d){return _0x4d9165!==_0x19878d;},'GjAAk':_0x4a98bc(0x214,0x1ac,0x26a,0x1e7),'rzxTH':_0x320349(0x2e1,0x23c,0x1b9,0x274),'zIXDG':function(_0x10d5eb,_0x20852d){return _0x10d5eb(_0x20852d);},'inIid':function(_0x3d6b15,_0x22b414){return _0x3d6b15||_0x22b414;},'KdnYe':_0x4a98bc(0x228,0x2c7,0x2c5,0x175)};if(!_0x38af89)return'';if(_0x38af89[_0x320349(0x21c,0x17b,0x20b,0x109)]&&_0x38af89[_0x4a98bc(0x151,0x10e,0x17d,0x100)][_0x320349(0x23c,0x1dd,0x22a,0x237)](_0x3f75ba[_0x320349(0x135,0x1f0,0x2b1,0x13d)])){if(_0x3f75ba[_0x320349(0x1a7,0x196,0x174,0x221)](_0x3f75ba['GjAAk'],_0x3f75ba[_0x320349(0x1c0,0x216,0x221,0x2d5)])){const _0xa15af1=await _0x3f75ba[_0x320349(0x145,0x18c,0x16e,0x1c6)](getConfigImage,_0x38af89[_0x4a98bc(0x151,0x179,0xb0,0xe5)]);return _0x3f75ba[_0x4a98bc(0x1d8,0x11a,0x276,0x217)](_0xa15af1,'');}else _0x16c016[_0x320349(0x200,0x17a,0xe2,0x20b)+_0x2f8d20+'\x20Prompt']&&(_0x11f137=_0x3f75ba['yamkF'](_0x3f75ba[_0x320349(0x256,0x2b5,0x209,0x288)](_0x5d1e1d,',\x20'),_0x2bb78e['Character\x20'+_0xa0cc9c+_0x4a98bc(0x283,0x1c9,0x20b,0x2b3)]));}function _0x4a98bc(_0x4d9041,_0x3777e8,_0x361be3,_0xc69763){return _0x2ea0(_0x4d9041- -0x4,_0x361be3);}function _0x320349(_0x14d26c,_0x58edbb,_0x247f04,_0x221ac3){return _0x2ea0(_0x58edbb-0x26,_0x247f04);}if(_0x38af89['image']&&_0x38af89['image']['startsWith'](_0x3f75ba[_0x4a98bc(0x2a0,0x279,0x1fe,0x336)]))return _0x38af89[_0x4a98bc(0x2ba,0x2ab,0x333,0x295)];return'';}async function generateBananaImage({prompt:_0x6ece98,width:_0x2f7dc9,height:_0x55a7c2,change:_0x2139f2,retouchPrompt:_0x3a0b27,retouchImage:_0x44d56f}){const _0x2e69e7={'itMPI':function(_0x378896,_0x21705d){return _0x378896(_0x21705d);},'BIixw':_0x5f1367(-0x9e,0x82,0x64,-0x8),'pHooy':function(_0x1ef0b0,_0x30dc01){return _0x1ef0b0+_0x30dc01;},'RBBqc':function(_0x3ad667,_0x380379){return _0x3ad667(_0x380379);},'huoEF':function(_0x5e9da4,_0x1e9409){return _0x5e9da4(_0x1e9409);},'epTTP':_0x5f1367(0x14e,0xbb,0x104,0x130),'GAyMz':function(_0x130e66,_0x30e3fc){return _0x130e66||_0x30e3fc;},'EfdTt':_0x73005d(0x4bd,0x46d,0x517,0x534),'RbMXc':_0x73005d(0x428,0x4a4,0x3eb,0x42b)+'坐标的提示词字符串。','vfTLv':_0x73005d(0x595,0x57e,0x453,0x501)+_0x73005d(0x411,0x39f,0x351,0x3db),'snWaR':function(_0x1adb41,_0xae79b4){return _0x1adb41<=_0xae79b4;},'LJmxP':'[Banana]\x20U'+_0x5f1367(-0x53,0x127,0xb1,0x71)+'t\x20URL\x20as\x20f'+_0x73005d(0x3e5,0x492,0x3a1,0x43e),'Apkgu':_0x5f1367(0x170,0x59,0xf1,0xd2)+_0x5f1367(0x11d,0x70,0x1a9,0xe8)+_0x5f1367(0x1d,0x22,0x36,0x78)+'mage\x20in\x20Op'+'enAI\x20forma'+'t','FLOoe':'[Banana]\x20F'+_0x5f1367(0xb0,0x55,-0xa6,-0x15)+':','iHpyG':function(_0x25cb33){return _0x25cb33();},'JWiZs':function(_0x48a290,_0x302383){return _0x48a290>_0x302383;},'pDTQL':_0x5f1367(0x1c,0x153,0x105,0xd9),'QLUDX':function(_0x195357,_0x141750){return _0x195357(_0x141750);},'TgJUo':function(_0x586b8f,_0x6247c9){return _0x586b8f||_0x6247c9;},'cccGC':function(_0x3ce513,_0x29aa87){return _0x3ce513!==_0x29aa87;},'HFsBs':_0x5f1367(0x5f,-0x4c,0xa0,0x6d),'ApDlp':function(_0x564a5b,_0x11abc0){return _0x564a5b(_0x11abc0);},'HzSZt':_0x5f1367(0x4c,0xe5,0xe8,0x62),'iJQJl':function(_0x376771,_0x115e22){return _0x376771+_0x115e22;},'oXsOI':_0x5f1367(-0x2,0x45,-0x62,0x31),'oVmLD':function(_0x203b95,_0x1fa5c0){return _0x203b95(_0x1fa5c0);},'rLYkJ':_0x5f1367(0x102,0x1e9,0x1be,0x156)+_0x73005d(0x501,0x53e,0x48f,0x478),'DTwYp':function(_0x353ccc,_0x19d971){return _0x353ccc<=_0x19d971;},'yYizu':function(_0x3f1aa0,_0x3f8055){return _0x3f1aa0+_0x3f8055;},'iFPEN':_0x73005d(0x49f,0x572,0x4b0,0x4fb),'ABSXO':function(_0x118403,_0x9ea3e){return _0x118403(_0x9ea3e);},'UWyrY':_0x73005d(0x444,0x3d6,0x462,0x435),'WsVct':'前置前','KUYuL':_0x73005d(0x442,0x515,0x41f,0x4c6),'mdxhQ':_0x73005d(0x537,0x484,0x444,0x4a6),'eyBcj':function(_0x50b034,_0x14f319){return _0x50b034(_0x14f319);},'jStAt':'{修图}','GWFij':_0x5f1367(0xa6,0x5,0x5a,0x86),'BdZBz':_0x73005d(0x4a0,0x4f5,0x3b3,0x451),'ayzry':function(_0x3c48eb,_0x1d4491){return _0x3c48eb(_0x1d4491);},'bgZXe':_0x5f1367(0x45,0x37,0x11d,0x8d)+_0x5f1367(0xe,-0xaa,-0x6f,0x1)+'。','dZpWx':_0x5f1367(-0x1d,0x4f,0xa1,0xa1),'nmukh':_0x5f1367(0x156,0x50,0x4b,0x103),'HiVKA':_0x5f1367(0x161,0x107,0x5c,0x120),'WAGrz':_0x73005d(0x3ea,0x539,0x514,0x48c),'xNGGp':function(_0x26943a,_0x33a014){return _0x26943a(_0x33a014);},'WKutS':_0x73005d(0x474,0x482,0x37a,0x425),'cWRSi':function(_0x52f77c,_0x125fe3){return _0x52f77c(_0x125fe3);},'DZrXa':function(_0x482d6d,_0x54ce20){return _0x482d6d===_0x54ce20;},'bEQmQ':_0x5f1367(0xfc,0x86,0x12c,0x91),'Gikmj':_0x73005d(0x4b8,0x4d8,0x434,0x416),'sXARJ':_0x5f1367(-0x2a,0x32,0x134,0x7e),'upmvn':function(_0x286916,_0x53444f){return _0x286916===_0x53444f;},'VAmAQ':_0x73005d(0x402,0x47e,0x39a,0x42e),'ZZGJH':function(_0x5bc9d1,_0x29473d){return _0x5bc9d1(_0x29473d);},'TxRhS':function(_0x2cf974,_0x262d2c){return _0x2cf974!==_0x262d2c;},'WdSSp':_0x73005d(0x542,0x49e,0x45c,0x4cb),'BbVUc':function(_0x7d77c4,_0x554957){return _0x7d77c4||_0x554957;},'Ycimb':function(_0x27eb90,_0x48463f){return _0x27eb90(_0x48463f);},'cUolJ':function(_0x4d3d93,_0x23f18c){return _0x4d3d93(_0x23f18c);},'YuuBd':_0x73005d(0x4a3,0x3e7,0x446,0x43a),'jjWWn':function(_0x28afff,_0x5bd77c){return _0x28afff+_0x5bd77c;},'LQNAW':_0x5f1367(0x2d,0xe3,0x154,0xc0),'DfNgT':_0x73005d(0x4da,0x5a6,0x48e,0x4fc),'AUVVS':function(_0x178ecc,_0x4c1eb5){return _0x178ecc+_0x4c1eb5;},'ddtkF':_0x5f1367(-0x71,-0x10,0xff,0x4a)+'nds/chat-c'+_0x5f1367(0x7,0x2,0x74,0xbc)+_0x5f1367(-0x40,-0xd6,-0x4e,-0x16),'BOLRd':'custom','NcORI':function(_0x3a0ef9,_0x38374c){return _0x3a0ef9(_0x38374c);},'BaOwz':'applicatio'+_0x73005d(0x593,0x55d,0x51d,0x4f1),'GwJII':function(_0x5da06f,_0x5ade0f){return _0x5da06f(_0x5ade0f);},'mjTki':function(_0x43607c,_0x34a18a){return _0x43607c(_0x34a18a);},'Ugfvh':_0x73005d(0x47d,0x454,0x38b,0x430),'cUsre':function(_0x40d255,_0x21120e,_0x336bfd){return _0x40d255(_0x21120e,_0x336bfd);},'yStov':_0x73005d(0x438,0x4c6,0x4a2,0x4d4),'TOZjq':function(_0x48d2f9,_0x46529f){return _0x48d2f9>_0x46529f;},'VgSoa':_0x73005d(0x52e,0x458,0x522,0x4d2),'vnQuQ':_0x73005d(0x3f7,0x42b,0x3e3,0x3fe),'LMWgZ':_0x73005d(0x415,0x58b,0x4f7,0x4d9),'bNAKY':_0x73005d(0x403,0x569,0x45f,0x4ad)+'/','OYxbC':'[Banana]\x20D'+'etected\x20Ma'+'rkdown\x20emb'+_0x5f1367(0xbe,0x43,0x87,0x74)+_0x5f1367(0xcf,0xc1,0x171,0xc8),'BiYVK':'[Banana]\x20S'+'uccessfull'+_0x5f1367(0xc8,0x7d,0xb5,0xfb)+_0x5f1367(0xa8,0x46,0xbd,0x1c)+_0x5f1367(0x205,0x200,0x83,0x13f)+_0x73005d(0x3eb,0x34b,0x397,0x3f5),'tSGhR':'pqKpx','LHYwt':_0x73005d(0x3e4,0x48d,0x519,0x47f),'WRRoz':_0x5f1367(0x12e,0xba,0xbd,0xce)+_0x5f1367(-0xcd,-0xc0,0x1b,-0x10)+'ntains\x20tex'+_0x5f1367(0xf9,0x14c,0x186,0xdc)+'\x20image.','TqfIs':function(_0x1cac65,_0x1e23d1){return _0x1cac65(_0x1e23d1);},'gebOF':function(_0x52ba81,_0x44b492){return _0x52ba81||_0x44b492;},'wccBY':_0x73005d(0x3db,0x430,0x3fc,0x48a),'IlOXO':function(_0x4a5d1d,_0x22ee51){return _0x4a5d1d(_0x22ee51);}};_0x2e69e7[_0x73005d(0x501,0x429,0x4eb,0x4e6)](clearLog);const _0x1ff768=taskQueue[_0x73005d(0x4a5,0x495,0x4fa,0x43d)]({'name':_0x2e69e7[_0x5f1367(0x76,0x2,-0x7f,0x47)]((_0x6ece98||'')[_0x5f1367(-0x38,-0x6e,-0x1b,0x8)](-0xaa5+0xec9*0x1+-0x424,0x611*-0x5+0x1*-0x2383+0x41f6),_0x6ece98&&_0x2e69e7['JWiZs'](_0x6ece98[_0x5f1367(0x14d,0x62,0x12f,0x113)],0x1f30+0x106*-0x4+-0x1afa)?_0x2e69e7[_0x5f1367(0x34,0x6c,-0xb4,0xf)]:''),'type':TaskType[_0x73005d(0x3fd,0x460,0x30d,0x3cf)],'prompt':_0x6ece98});currentTaskId=_0x1ff768,_0x6ece98=_0x2e69e7[_0x5f1367(-0x12,0x127,0x36,0x76)](processCharacterPrompt,_0x6ece98),_0x6ece98=await stripChineseAnnotations(_0x6ece98);let _0x4e272c=_0x2139f2;_0x2139f2=processCharacterPrompt(_0x2139f2),_0x2139f2=await stripChineseAnnotations(_0x2139f2),addLog('开始\x20Banana生'+_0x5f1367(0xa6,0x82,0x7f,0x46)+extension_settings[extensionName][_0x73005d(0x370,0x461,0x3df,0x3d4)]),_0x2e69e7[_0x5f1367(0x12a,0x13,0x108,0x76)](addLog,_0x5f1367(0x47,0x72,0xda,0x3d)+'\x20'+(_0x2f7dc9||'默认')+',\x20高度\x20-\x20'+_0x2e69e7[_0x5f1367(0xd5,0xcc,0x73,0x104)](_0x55a7c2,'默认')),_0x6ece98=_0x2139f2&&_0x2139f2[_0x5f1367(0x20e,0x1b7,0x172,0x15b)]()!==''?_0x2139f2:_0x6ece98,addLog('用于生成的Tag:\x20'+_0x6ece98);let _0x11a1fe=![];_0x6ece98[_0x5f1367(0xe2,-0x47,0xbc,0x3c)](_0x2e69e7[_0x73005d(0x36a,0x419,0x457,0x3ed)])&&(_0x2e69e7[_0x73005d(0x5ab,0x4e8,0x5ab,0x505)](_0x2e69e7[_0x5f1367(0x70,0x1a,0x90,0x64)],'FWpTx')?_0x2e69e7[_0x5f1367(0xe5,0x14d,0x1c9,0x121)](_0x4624fc,_0x5f1367(0xec,0xb5,0x5f,0xce)+_0x73005d(0x347,0x389,0x45b,0x3c2)+_0x73005d(0x54d,0x4bc,0x4a5,0x4b6)+_0x5f1367(0x17c,0xb1,0x144,0xdc)+_0x5f1367(-0x23,-0x52,0x36,0x67)):_0x11a1fe=!![]);_0x2e69e7[_0x5f1367(-0x88,0x5f,0x8b,0x2d)](addLog,_0x5f1367(0x13b,0x84,0x9b,0x80)+_0x73005d(0x485,0x4ae,0x446,0x47a)+_0x73005d(0x392,0x33a,0x48b,0x3de)+_0x11a1fe);let _0x95248a={},_0x3b54cb='',_0x35a9a6='';if(_0x11a1fe){_0x2e69e7['ApDlp'](addLog,_0x2e69e7['RbMXc']),_0x95248a=_0x2e69e7[_0x73005d(0x402,0x432,0x3b4,0x448)](parsePromptStringWithCoordinates,_0x6ece98),_0x3b54cb=_0x95248a[_0x2e69e7['vfTLv']];for(let _0x482a1a=0x69+0x1cce+-0x1d36;_0x2e69e7[_0x73005d(0x3fc,0x496,0x468,0x42a)](_0x482a1a,-0x2534+-0x6bf*-0x4+0xa3c);_0x482a1a++){if(_0x95248a[_0x5f1367(0xaf,0x55,-0x46,0x3)+_0x482a1a+_0x5f1367(0x1e7,0xca,0xf0,0x136)]){if(_0x5f1367(0xa,-0x5e,0x8c,0x26)===_0x2e69e7[_0x73005d(0x37f,0x359,0x41a,0x3fc)]){const _0x3b5fad={};_0x3b5fad[_0x5f1367(0x97,0xe,0x1e,0x77)]=_0x2e69e7[_0x73005d(0x3ad,0x475,0x4c4,0x468)],_0x3b5fad['content']=_0x143484,_0x2cd8a8[_0x5f1367(0xcd,-0x23,0x7a,0x8c)](_0x3b5fad);}else _0x35a9a6=_0x2e69e7[_0x5f1367(0x1ab,0x176,0x1b0,0xea)](_0x2e69e7[_0x5f1367(0x14e,0x10d,0x3c,0xea)](_0x35a9a6,',\x20'),_0x95248a[_0x73005d(0x413,0x41f,0x422,0x3d5)+_0x482a1a+_0x73005d(0x50d,0x4b7,0x469,0x508)]);}}}else _0x5f1367(0xa7,0x7d,0xb7,0x10d)===_0x2e69e7[_0x73005d(0x3a2,0x3c0,0x322,0x3c5)]?(_0x3c8048[_0x393149]['banana'][_0x5f1367(0x13f,0x170,0xde,0x146)]=_0x2e69e7['pHooy'](_0x3d9578[_0x9a1dc7]['banana']['cishu'],-0x744+-0x336+0xa7b),_0x2e69e7[_0x73005d(0x474,0x497,0x3db,0x3ff)](_0x210624,_0x73005d(0x4b3,0x4a4,0x388,0x427)+_0x73005d(0x462,0x444,0x4fc,0x4bb)+_0x5e3d0c[_0x14e6d1][_0x5f1367(0x80,-0x9f,-0x9,-0x12)][_0x5f1367(0x140,0xcc,0x9a,0x146)])):(_0x2e69e7[_0x73005d(0x451,0x40b,0x45f,0x426)](addLog,_0x2e69e7[_0x73005d(0x558,0x5e3,0x4a3,0x529)]),_0x3b54cb=_0x6ece98);let {modifiedPrompt:_0x612698,insertions:_0x135d8e}=await prompt_replace(_0x3b54cb,_0x35a9a6);if(_0x11a1fe)for(let _0x1d9de8=-0xc9*0x2a+-0x1*0x638+0x2733;_0x2e69e7[_0x73005d(0x4a0,0x4c1,0x504,0x522)](_0x1d9de8,0x1*0xf67+-0x258+0x15*-0x9f);_0x1d9de8++){_0x95248a[_0x73005d(0x35b,0x40e,0x42a,0x3d5)+_0x1d9de8+_0x73005d(0x45a,0x44f,0x536,0x508)]&&(_0x612698=_0x2e69e7[_0x73005d(0x553,0x40a,0x575,0x4bc)](_0x2e69e7['yYizu'](_0x612698,_0x2e69e7[_0x73005d(0x4e3,0x52f,0x585,0x535)]),prompt_replace_for_character(_0x95248a[_0x5f1367(0x7a,0x14,-0x2c,0x3)+_0x1d9de8+_0x73005d(0x499,0x452,0x4f7,0x508)])));}const _0x344431=extension_settings[extensionName][_0x73005d(0x3a4,0x47f,0x372,0x3c0)],{model:_0x184399,apiUrl:_0x957826,apiKey:_0x1a08a7,conversationPresets:_0x2cafce,conversationPresetId:_0x31a08a,editPresetId:_0x34030a,aspectRatio:_0x39aca9}=_0x344431;_0x2e69e7[_0x5f1367(0x176,0xfe,0x211,0x174)](addLog,'[Banana]\x20S'+_0x73005d(0x4dd,0x4c6,0x490,0x4cc)+'age\x20genera'+_0x5f1367(0xad,-0x51,0x59,0x3a)+_0x73005d(0x457,0x417,0x405,0x4a5)+_0x184399);let _0x3af184,_0x3c2b2c;if(_0x184399[_0x73005d(0x3bd,0x4cc,0x39e,0x438)](_0x2e69e7[_0x73005d(0x403,0x3f9,0x3cb,0x429)])){_0x3af184=_0x5f1367(0x1c,0xf4,-0x5,0x38)+'dels/'+_0x184399;const _0x1df6b5={};_0x1df6b5['fixedPromp'+'t']='';const _0x20592e=_0x2cafce[_0x31a08a]||_0x1df6b5,_0x1109cf=[_0x20592e[_0x5f1367(0x10f,0x131,0x18f,0x12e)+'t'],_0x135d8e[_0x2e69e7[_0x5f1367(0x63,0x21,-0x69,-0x4)]],_0x135d8e[_0x2e69e7['KUYuL']],_0x612698,_0x135d8e[_0x73005d(0x426,0x419,0x4ca,0x473)],_0x135d8e[_0x73005d(0x564,0x53e,0x532,0x4d5)],_0x20592e[_0x5f1367(0x42,0xee,0x186,0xcd)+_0x5f1367(0x25,0xa8,0x174,0xb4)],_0x135d8e[_0x2e69e7[_0x5f1367(-0x5,0xe4,-0x3c,0x30)]]][_0x5f1367(-0x74,-0x39,-0x33,-0x5)](Boolean)['join'](',\x20');_0x2e69e7[_0x5f1367(0xb2,-0x70,0x1,-0x9)](addLog,_0x5f1367(-0x1e,0x70,-0x38,0xd)+_0x1109cf);const _0x447960={};_0x447960[_0x5f1367(0x1fc,0xf0,0x147,0x143)]=_0x1109cf;const _0x1e0388={};_0x1e0388['sampleCoun'+'t']=0x1,_0x1e0388[_0x5f1367(0xc8,0xa8,0x16a,0x161)+'o']=_0x39aca9;const _0x515c61={};_0x515c61['instances']=[_0x447960],_0x515c61[_0x73005d(0x4b0,0x52c,0x449,0x4e1)]=_0x1e0388,_0x3c2b2c=_0x515c61,_0x2e69e7[_0x73005d(0x512,0x469,0x5b8,0x4f3)](addLog,'[Banana]\x20B'+'uilt\x20Image'+'n\x20payload\x20'+_0x5f1367(0x183,0xd0,0xbd,0xe2)+'t:\x20'+_0x1109cf);}else{_0x3af184='/v1/chat/c'+_0x73005d(0x415,0x54d,0x50b,0x48e);let _0x5355bb;if(_0x2139f2[_0x5f1367(0xb6,-0x88,-0x79,0x3c)](_0x2e69e7[_0x5f1367(0x16c,0x46,0x82,0xf3)])){if(_0x2e69e7[_0x73005d(0x4a5,0x4da,0x4b4,0x505)](_0x2e69e7[_0x73005d(0x513,0x4ee,0x4a5,0x4da)],_0x2e69e7['BdZBz'])){_0x2e69e7[_0x73005d(0x4c1,0x58b,0x572,0x513)](addLog,_0x2e69e7['bgZXe']);const _0x3dd02f=_0x2e69e7[_0x5f1367(0x12c,0xd3,0x1a9,0x104)](_0x34030a,'默认'),_0x24d84a={};_0x24d84a[_0x5f1367(0x38,0x1e,0xbc,0xbe)+'on']=[],_0x24d84a[_0x5f1367(0x189,0xbd,0xa1,0x12e)+'t']='',_0x5355bb=_0x2cafce[_0x3dd02f]||_0x24d84a,addLog(_0x73005d(0x585,0x48e,0x54c,0x50e)+'用修图预设:\x20\x22'+_0x3dd02f+'\x22');}else _0x3c53bf[_0x5f1367(0x75,0x51,0x85,0x81)+_0x73005d(0x462,0x47d,0x577,0x4fe)+'ener']=!![],_0x20122e();}else{const _0xdc1250={};_0xdc1250[_0x5f1367(-0x1,0x10e,0x121,0xbe)+'on']=[],_0xdc1250[_0x73005d(0x491,0x4d5,0x580,0x500)+'t']='',_0x5355bb=_0x2cafce[_0x31a08a]||_0xdc1250;}const _0x12ae04=[_0x5355bb[_0x5f1367(0x99,0x131,0x16d,0x12e)+'t'],_0x135d8e[_0x2e69e7[_0x5f1367(0x0,-0x64,-0xa3,-0x4)]],_0x135d8e[_0x73005d(0x577,0x42d,0x498,0x4c6)],_0x612698,_0x135d8e[_0x2e69e7[_0x5f1367(0x2e,0x157,0x109,0x98)]],_0x135d8e[_0x2e69e7['nmukh']],_0x5355bb[_0x5f1367(0x116,0x185,0xca,0xcd)+_0x73005d(0x429,0x46d,0x3d9,0x486)],_0x135d8e['最后置']][_0x5f1367(-0x62,-0x7,0x6d,-0x5)](Boolean)[_0x73005d(0x49c,0x4f5,0x51a,0x491)](',\x20');_0x2e69e7[_0x5f1367(0x7,0xdd,0x64,0x76)](addLog,_0x5f1367(0x18,0xc6,-0xf,0xd)+_0x12ae04);const _0xb6ce45={};_0xb6ce45[_0x73005d(0x4e8,0x44d,0x438,0x449)]=_0x5f1367(0x21e,0xb7,0x1e6,0x162),_0xb6ce45[_0x73005d(0x473,0x44b,0x530,0x4b7)]=[];const _0xb7dda2={};_0xb7dda2[_0x73005d(0x3fe,0x472,0x3be,0x449)]=_0x5f1367(-0xac,0xd,0x77,-0x8),_0xb7dda2[_0x73005d(0x50a,0x4ca,0x4f1,0x4b7)]=[];const _0x2ff193=_0x5355bb[_0x73005d(0x424,0x412,0x4f7,0x490)+'on'][_0x5f1367(0xc0,0xec,0xc9,0xb5)](_0x3133bf=>[_0xb6ce45,_0xb7dda2])['flat']();let _0x9a20cc=0x15*-0x16f+-0xd42+-0x1*-0x2b5d;for(const _0x1429e3 of _0x5355bb[_0x5f1367(0xa0,0x50,0xe0,0xbe)+'on']){if(_0x2e69e7[_0x73005d(0x517,0x476,0x480,0x505)](_0x2e69e7[_0x73005d(0x46d,0x49a,0x394,0x3f7)],_0x5f1367(0xd6,0xd5,0x1a1,0x120)))_0x4abe2f=_0xa15696+_0x193d65;else{if(_0x1429e3[_0x5f1367(0x123,0x14c,0x1a2,0x162)]?.[_0x73005d(0x538,0x530,0x448,0x48c)])_0x2ff193[_0x9a20cc]['content'][_0x5f1367(0x60,0xd8,0x13,0x8c)]({'type':_0x2e69e7[_0x73005d(0x382,0x445,0x49a,0x3fb)],'text':_0x1429e3[_0x73005d(0x5bc,0x489,0x478,0x534)][_0x73005d(0x4d6,0x551,0x3c7,0x48c)]});const _0x2f12de=await _0x2e69e7['xNGGp'](getImageFromTurnData,_0x1429e3[_0x73005d(0x4d9,0x546,0x4e4,0x534)]);if(_0x2f12de)_0x2ff193[_0x9a20cc]['content'][_0x73005d(0x46c,0x413,0x4a6,0x45e)]({'type':_0x2e69e7[_0x5f1367(0x5f,0x55,0x163,0xd0)],'image_url':{'url':_0x2f12de}});_0x9a20cc++;if(_0x1429e3['model']?.['text'])_0x2ff193[_0x9a20cc]['content'][_0x5f1367(0x107,0x113,0x2b,0x8c)]({'type':_0x2e69e7[_0x5f1367(0x4c,-0x4d,0x2c,0x29)],'text':_0x1429e3[_0x73005d(0x42f,0x48b,0x53d,0x4b3)]['text']});const _0x55de52=await _0x2e69e7['cWRSi'](getImageFromTurnData,_0x1429e3[_0x5f1367(0x10c,0x10c,0xaf,0xe1)]);if(_0x55de52)_0x2ff193[_0x9a20cc][_0x73005d(0x4b2,0x421,0x484,0x4b7)][_0x73005d(0x3bf,0x40c,0x454,0x45e)]({'type':_0x2e69e7[_0x73005d(0x473,0x4d7,0x50f,0x4a2)],'image_url':{'url':_0x55de52}});_0x9a20cc++;}}if(!_0x2139f2['includes'](_0x2e69e7[_0x5f1367(0x1a3,0x11a,0x64,0xf3)])){const _0x4d7834=extension_settings[extensionName][_0x5f1367(0x26,-0x12,0x14a,0x87)+'acterPrese'+'ts']||{};for(const _0x193f47 in _0x4d7834){if(_0x2e69e7[_0x5f1367(0x54,0x89,0x95,0x50)](_0x2e69e7[_0x73005d(0x45a,0x465,0x4f0,0x4ff)],_0x2e69e7['bEQmQ'])){const _0x386237=_0x4d7834[_0x193f47],_0x4f5972=(_0x386237['triggers']||'')[_0x5f1367(0xec,0xee,0x10e,0x90)]('|')['filter'](_0x13bdb0=>_0x13bdb0[_0x5f1367(0xde,0x153,0x1b3,0x15b)]()!=='');for(const _0x563f5c of _0x4f5972){if(_0x2e69e7[_0x5f1367(0x79,0x0,0xf5,0x94)]!==_0x2e69e7[_0x73005d(0x4dd,0x598,0x5a1,0x52e)]){if(_0x12ae04['toLowerCas'+'e']()[_0x73005d(0x3ee,0x36b,0x36a,0x40e)](_0x563f5c['toLowerCas'+'e']())){addLog(_0x5f1367(0xc2,0x1a1,0x172,0x151)+_0x5f1367(-0x3f,0xb,-0x9b,0x10)+_0x5f1367(0xa9,0x21a,0xdd,0x15d)+_0x73005d(0x456,0x3cb,0x429,0x3c7)+_0x563f5c+('\x22\x20from\x20pre'+_0x73005d(0x4d8,0x440,0x44a,0x4db))+_0x193f47+'\x22.');const _0x3375d7=_0x386237[_0x73005d(0x542,0x3d5,0x409,0x490)+'on'];if(_0x3375d7){const _0x4ea369=[];if(_0x3375d7[_0x73005d(0x5a8,0x5c1,0x5b3,0x534)]&&_0x3375d7[_0x73005d(0x4c7,0x4b4,0x48a,0x534)][_0x5f1367(0x12c,0x31,0x31,0xba)])_0x4ea369[_0x5f1367(-0x16,0x69,0xe3,0x8c)]({'type':_0x2e69e7[_0x5f1367(0x62,0x67,0xde,0x29)],'text':_0x3375d7[_0x73005d(0x4e1,0x52f,0x49a,0x534)]['text']});const _0x13a97c=await _0x2e69e7[_0x73005d(0x3ed,0x325,0x456,0x3bf)](getImageFromTurnData,_0x3375d7[_0x5f1367(0x1de,0x118,0xa4,0x162)]);if(_0x13a97c)_0x4ea369[_0x5f1367(0xec,0x2f,0x3d,0x8c)]({'type':_0x73005d(0x37c,0x480,0x3ab,0x425),'image_url':{'url':_0x13a97c}});if(_0x2e69e7[_0x73005d(0x5af,0x5d9,0x54f,0x541)](_0x4ea369['length'],-0xa3f*0x3+0x236*0xb+0x66b)){if(_0x2e69e7[_0x73005d(0x392,0x38f,0x46a,0x442)](_0x73005d(0x36a,0x3a0,0x44f,0x42e),_0x2e69e7['VAmAQ'])){const _0x3744d0={};_0x3744d0[_0x5f1367(0x50,0x75,0x17,0x77)]=_0x2e69e7[_0x73005d(0x3cb,0x478,0x4da,0x444)],_0x3744d0[_0x5f1367(0xfd,0x133,0xfd,0xe5)]=_0x4ea369,_0x2ff193['push'](_0x3744d0);}else{const {taskId:_0xe1a8dc}=_0x5e048e;_0x2e69e7['huoEF'](_0x5862f9,_0x73005d(0x3e6,0x4a6,0x500,0x475)+_0x5f1367(0x16b,0x7b,0x158,0x105)+_0x5f1367(0xf5,0x141,0x16d,0xb1)+_0xe1a8dc+')'),_0xc02cfb===_0xe1a8dc&&_0x1a30cb&&(_0x2e69e7['RBBqc'](_0x56a359,_0x73005d(0x4d3,0x3ce,0x478,0x41a)+_0x73005d(0x41b,0x58b,0x490,0x4c7)+_0x5f1367(-0xe,0x10,0x7d,-0x11)+_0x4d6234+')'),_0x2829ba[_0x5f1367(-0x29,0x10d,-0x5c,0x69)](_0x4db908[_0x73005d(0x48d,0x377,0x39a,0x405)+_0x73005d(0x5e6,0x5a7,0x4cc,0x53c)+_0x73005d(0x3e3,0x3c6,0x34b,0x404)],{'id':_0x4aa813,'success':![],'error':_0x2e69e7[_0x73005d(0x4c1,0x452,0x529,0x4a7)],'prompt':_0x2e69e7[_0x73005d(0x396,0x396,0x436,0x3d7)](_0x44c027,'')}),_0x22cb45=null,_0x50f10a=null,_0x22ddfa=null);}}const _0x5d64de=[];if(_0x3375d7[_0x5f1367(0x1a8,0x107,0x4a,0xe1)]&&_0x3375d7[_0x5f1367(0x18b,0x35,0x88,0xe1)][_0x5f1367(0xd9,0x17,0x172,0xba)])_0x5d64de[_0x73005d(0x453,0x3be,0x3fe,0x45e)]({'type':_0x2e69e7[_0x73005d(0x33b,0x396,0x346,0x3fb)],'text':_0x3375d7[_0x73005d(0x458,0x48f,0x50c,0x4b3)][_0x5f1367(0x172,0xca,0xfb,0xba)]});const _0x1fae08=await _0x2e69e7[_0x5f1367(0xc5,-0x2e,0x1b,0x22)](getImageFromTurnData,_0x3375d7['model']);if(_0x1fae08)_0x5d64de['push']({'type':_0x73005d(0x3a3,0x469,0x4b9,0x425),'image_url':{'url':_0x1fae08}});if(_0x5d64de[_0x5f1367(0x1c5,0x1d8,0xcb,0x113)]>-0x1e8*-0x8+0x24cb+-0x340b){const _0x332b5e={};_0x332b5e[_0x73005d(0x40a,0x397,0x468,0x449)]=_0x2e69e7[_0x73005d(0x464,0x482,0x3da,0x468)],_0x332b5e['content']=_0x5d64de,_0x2ff193[_0x73005d(0x3c0,0x445,0x471,0x45e)](_0x332b5e);}}break;}}else{const _0xa6fc0d={};_0xa6fc0d['role']=_0x2e69e7[_0x5f1367(0xe8,0xad,0xa0,0x72)],_0xa6fc0d['content']=_0x53e619,_0x206507[_0x73005d(0x4f0,0x4a5,0x44d,0x45e)](_0xa6fc0d);}}}else{_0x335543(_0x2e69e7['RbMXc']),_0x139109=_0x2e69e7[_0x73005d(0x433,0x3b4,0x463,0x424)](_0x3ecfb3,_0x41d89a),_0x211e7a=_0x150fdd[_0x2e69e7['vfTLv']];for(let _0x3f8e41=0x1*0xaa9+-0x3*-0x2dc+-0x133c;_0x2e69e7[_0x73005d(0x42b,0x3ed,0x4d0,0x42a)](_0x3f8e41,0x6fe+-0x698+-0x1*0x62);_0x3f8e41++){_0x359d23[_0x73005d(0x360,0x3a8,0x463,0x3d5)+_0x3f8e41+_0x73005d(0x4a4,0x520,0x59e,0x508)]&&(_0x4d4fb1=_0x2e69e7[_0x5f1367(-0x7f,-0x74,0x105,0x47)](_0x2e69e7[_0x73005d(0x468,0x3ba,0x39a,0x419)](_0x570ef2,',\x20'),_0xdbb14a['Character\x20'+_0x3f8e41+_0x73005d(0x4b2,0x4f7,0x48e,0x508)]));}}}}if(!_0x2139f2[_0x73005d(0x478,0x459,0x384,0x40e)](_0x2e69e7[_0x73005d(0x578,0x436,0x514,0x4c5)])){const _0x44b27e={};_0x44b27e['role']=_0x2e69e7['EfdTt'],_0x44b27e[_0x73005d(0x471,0x45a,0x49d,0x4b7)]=[{'type':_0x2e69e7['WAGrz'],'text':_0x12ae04}],_0x2ff193['push'](_0x44b27e);}else{if(_0x2e69e7[_0x73005d(0x404,0x528,0x523,0x46f)](_0x2e69e7[_0x73005d(0x3bd,0x392,0x3b4,0x417)],_0x2e69e7[_0x73005d(0x4d7,0x450,0x381,0x417)]))_0x2e69e7[_0x73005d(0x41f,0x3d1,0x49f,0x3ff)](_0x22b1b2,_0x73005d(0x477,0x539,0x4bf,0x523)+'ailed\x20to\x20f'+_0x73005d(0x3d5,0x3c2,0x499,0x415)+_0x5f1367(0x12e,0xc,0x7f,0xaa)+'\x20'+_0x22b2b7[_0x73005d(0x4f2,0x46e,0x4fa,0x4b8)]),_0xfc17fa=_0x1d789a,_0x2e69e7['RBBqc'](_0xa1bd3b,_0x2e69e7['LJmxP']);else{const _0x466280=[],_0x5643e5=_0x2e69e7[_0x5f1367(0x80,0x127,0x8d,0x95)](_0x3a0b27,_0x12ae04),_0x213e47=[_0x5355bb[_0x73005d(0x442,0x4fe,0x551,0x500)+'t'],_0x5643e5,_0x5355bb[_0x73005d(0x54d,0x524,0x50e,0x49f)+'mpt']]['filter'](Boolean)[_0x5f1367(0x181,0x3a,0x139,0xbf)](',\x20'),_0x220b84={};_0x220b84[_0x5f1367(0x13e,0xac,-0x3,0x7c)]=_0x2e69e7[_0x73005d(0x405,0x348,0x411,0x3fb)],_0x220b84[_0x5f1367(0x57,0x165,0xfb,0xba)]=_0x213e47,_0x466280[_0x5f1367(0x7b,0xa5,0x8d,0x8c)](_0x220b84);if(_0x44d56f){const _0x999805={};_0x999805[_0x73005d(0x501,0x485,0x50a,0x4dc)]=_0x44d56f;const _0x230b07={};_0x230b07[_0x5f1367(-0x29,-0xd,0x68,0x7c)]=_0x2e69e7[_0x73005d(0x40b,0x405,0x49e,0x4a2)],_0x230b07[_0x5f1367(0x104,0xf9,0x50,0x53)]=_0x999805,_0x466280[_0x5f1367(-0x4,0x79,0x125,0x8c)](_0x230b07),addLog(_0x73005d(0x533,0x423,0x4b0,0x484)+_0x73005d(0x3c5,0x44a,0x4cc,0x432)+_0x5f1367(-0x3e,0xcf,0x3e,0x4e));}const _0x242e4b={};_0x242e4b['role']=_0x5f1367(0x11c,0x205,0x1ab,0x162),_0x242e4b['content']=_0x466280,_0x2ff193[_0x73005d(0x435,0x4f2,0x46c,0x45e)](_0x242e4b),_0x2e69e7['Ycimb'](addLog,_0x73005d(0x404,0x3f4,0x3ef,0x484)+_0x5f1367(0xe5,0x58,0x122,0x89)+_0x213e47);}}const _0x3692f7={};_0x3692f7[_0x73005d(0x4ef,0x49a,0x5e8,0x533)+'o']=_0x39aca9;const _0x5c49ea={};_0x5c49ea[_0x5f1367(0x1e5,0x131,0x1de,0x160)+'g']=_0x3692f7,_0x3c2b2c={'model':_0x184399,'messages':_0x2ff193[_0x73005d(0x35a,0x3de,0x42b,0x3cd)](_0x5f6384=>_0x5f6384['content'][_0x5f1367(0xf2,0x168,0x96,0x113)]>-0xba2+0xc0f+-0x6d*0x1),'config':_0x5c49ea},_0x2e69e7[_0x73005d(0x478,0x3f1,0x522,0x4a8)](addLog,_0x73005d(0x40f,0x41f,0x43e,0x3e0)+'uilt\x20multi'+'modal\x20payl'+'oad\x20with\x20'+_0x3c2b2c[_0x5f1367(0x127,0xc7,0x168,0x106)][_0x5f1367(0x1c4,0x1c7,0x1cd,0x113)]+_0x73005d(0x556,0x4be,0x467,0x4e0));}function _0x73005d(_0x19826f,_0x6eb6a1,_0x2d0bd9,_0x3703b1){return _0x2ea0(_0x3703b1-0x281,_0x19826f);}let _0x4b4aeb=_0x957826[_0x5f1367(0x201,0x80,0x1b0,0x147)](/\/$/,''),_0x4dc5a5;_0x4b4aeb[_0x5f1367(0x61,0x55,0xe6,0xd8)](_0x5f1367(0xb6,0xa6,0x9b,0xc0))||_0x4b4aeb[_0x5f1367(0xd1,-0x70,0x95,0x3c)](_0x2e69e7[_0x73005d(0x373,0x49c,0x4a5,0x3ea)])?_0x4dc5a5=_0x2e69e7['pHooy'](_0x4b4aeb,_0x3af184):_0x4dc5a5=_0x2e69e7[_0x73005d(0x3ca,0x467,0x480,0x46b)](_0x2e69e7[_0x5f1367(0x155,0x129,0xab,0x99)](_0x4b4aeb,_0x2e69e7[_0x5f1367(0x2,0xe9,-0x26,0x7d)]),_0x3af184);_0x4dc5a5=_0x4dc5a5[_0x5f1367(0x99,0x1c3,0xf6,0x147)](/\/v1\/v1\//g,_0x2e69e7[_0x5f1367(-0x63,0x2f,0x50,0x18)]);const _0x2e13ec=extension_settings[extensionName][_0x5f1367(0xb8,0x52,-0xa3,0x2)];let _0x5d6ca8,_0x14ef81,_0x9f3474;if(_0x2e13ec===_0x2e69e7[_0x5f1367(-0x13,0xb4,0x54,0x42)]){let _0x4c0c90=_0x4b4aeb;!_0x4c0c90['endsWith'](_0x2e69e7[_0x5f1367(-0x6,-0x35,0xf4,0x7d)])&&!_0x4c0c90[_0x73005d(0x4a1,0x35c,0x398,0x40e)](_0x2e69e7[_0x73005d(0x35c,0x341,0x3aa,0x3ea)])&&(_0x4c0c90=_0x2e69e7[_0x73005d(0x5cd,0x5be,0x462,0x51f)](_0x4c0c90,'/v1'));_0x4c0c90=_0x4c0c90['replace'](/\/v1\/$/,_0x2e69e7[_0x73005d(0x3e5,0x43d,0x3a0,0x44f)]),_0x5d6ca8=_0x2e69e7[_0x5f1367(0x5d,0x17,0x12a,0xc4)],_0x14ef81=_0x2e69e7[_0x5f1367(-0x37,-0x44,0xc,0x76)](getRequestHeaders,window[_0x73005d(0x467,0x56a,0x4ef,0x51b)]);const _0x4143bf={};_0x4143bf[_0x5f1367(0x50,-0x6e,-0x20,0x41)+_0x73005d(0x4b4,0x55d,0x4fa,0x4ee)+'ce']=_0x2e69e7[_0x5f1367(0xb3,-0x45,0xa4,0x51)],_0x4143bf['custom_url']=_0x4c0c90,_0x4143bf[_0x73005d(0x3d5,0x4a1,0x46a,0x455)+'lude_heade'+'rs']=_0x5f1367(-0x16,-0x8f,0x5f,-0x1)+'ion:\x20\x22Bear'+_0x5f1367(0x163,0xb7,0xde,0x169)+_0x1a08a7+'\x22',_0x4143bf[_0x5f1367(0xa1,0xa5,0x72,0xe1)]=_0x184399,_0x4143bf['messages']=_0x3c2b2c[_0x5f1367(0x16e,0x4e,0xdc,0x106)],_0x4143bf[_0x73005d(0x54c,0x4da,0x55b,0x526)]=![],_0x9f3474=_0x4143bf;if(_0x184399[_0x73005d(0x4c8,0x3f7,0x4b2,0x438)](_0x2e69e7[_0x5f1367(0x1d,-0x39,0x2d,0x57)])){addLog(_0x5f1367(0x9a,0x2e,0xa8,0xcf)+_0x73005d(0x4b7,0x527,0x511,0x516)+_0x73005d(0x4cf,0x4b8,0x453,0x47e)+_0x5f1367(0x8b,0x14f,0x14c,0xf0)),_0x5d6ca8=_0x4dc5a5;const _0x5b4f36={};_0x5b4f36[_0x5f1367(0x131,0x181,0x6e,0x116)+'pe']=_0x5f1367(0xb7,0x1a1,0xfc,0x10c)+_0x5f1367(0x104,0x1aa,0x19d,0x11f),_0x5b4f36[_0x73005d(0x430,0x3e0,0x44c,0x3d1)+_0x5f1367(0x1f4,0x9d,0x180,0x15a)]=_0x73005d(0x57e,0x53b,0x5cd,0x51c)+_0x1a08a7,_0x14ef81=_0x5b4f36,_0x9f3474=_0x3c2b2c;}_0x2e69e7[_0x73005d(0x4e0,0x55e,0x419,0x4b0)](addLog,'[Banana]\x20使'+'用酒馆代理模式');}else{_0x5d6ca8=_0x4dc5a5;const _0x1f93ac={};_0x1f93ac['Content-Ty'+'pe']=_0x2e69e7['BaOwz'],_0x1f93ac[_0x73005d(0x354,0x40f,0x372,0x3d1)+'ion']=_0x73005d(0x4bf,0x5a5,0x4e4,0x51c)+_0x1a08a7,_0x14ef81=_0x1f93ac,_0x9f3474=_0x3c2b2c,_0x2e69e7['Ycimb'](addLog,'[Banana]\x20使'+'用直接请求模式');}_0x2e69e7[_0x5f1367(0xa3,0xaf,0xf1,0x2b)](addLog,_0x5f1367(0xe0,0x82,0xc1,0x101)+'ending\x20req'+_0x5f1367(0x17,0x167,0xb1,0xb0)+_0x5d6ca8),_0x2e69e7['mjTki'](addLog,_0x5f1367(0x143,0x148,0xfa,0x123)+'ayload:\x20'+JSON[_0x73005d(0x4e1,0x4ca,0x418,0x421)](_0x9f3474,null,-0x18d5+0x1d14*-0x1+0x11f9*0x3));function _0x5f1367(_0x51afd9,_0x55ff90,_0x30d3bb,_0x4da2c5){return _0x2ea0(_0x4da2c5- -0x151,_0x55ff90);}try{taskQueue[_0x73005d(0x3e7,0x3da,0x4aa,0x469)+'us'](_0x1ff768,_0x2e69e7[_0x73005d(0x42a,0x33b,0x3f2,0x3be)]);const _0xc947e6=await _0x2e69e7[_0x5f1367(0x1e8,0xaa,0x1dd,0x13a)](fetch,_0x5d6ca8,{'method':_0x2e69e7[_0x73005d(0x3be,0x3cb,0x3b5,0x3cb)],'headers':_0x14ef81,'body':JSON[_0x5f1367(0xc5,0x33,0x92,0x4f)](_0x9f3474)});if(!_0xc947e6['ok']){const _0x2c26b4=await _0xc947e6[_0x5f1367(0x14f,0x85,0x11,0xba)]();throw new Error(_0x73005d(0x34b,0x456,0x3a5,0x3e5)+'t\x20failed\x20w'+'ith\x20status'+'\x20'+_0xc947e6[_0x5f1367(0x10e,0x211,0x14c,0x172)]+':\x20'+_0x2c26b4);}const _0x3b4a96=await _0xc947e6[_0x5f1367(0x1f8,0xdb,0x16b,0x168)]();let _0x2068ac='';const _0x2d420d=_0x3b4a96[_0x5f1367(0x171,0xc5,0x170,0x171)];if(_0x2d420d&&_0x2e69e7[_0x73005d(0x39f,0x3c6,0x34d,0x3e3)](_0x2d420d[_0x73005d(0x464,0x439,0x5a1,0x4e5)],0x838*-0x1+0x29d*0x5+0x1*-0x4d9)){const _0x3875c9=_0x2d420d[0xb*0xb3+-0x7d8*-0x1+-0xf89][_0x73005d(0x554,0x43f,0x40d,0x4b8)]?.[_0x5f1367(0x123,0x129,0xb3,0xe5)];if(Array[_0x73005d(0x37a,0x44b,0x478,0x3ef)](_0x3875c9)){if(_0x2e69e7[_0x73005d(0x435,0x3a7,0x3cf,0x442)](_0x2e69e7[_0x5f1367(0xb8,0x17f,0x18e,0xfc)],_0x2e69e7[_0x5f1367(-0x7f,-0x40,0x6b,0x20)])){_0x2e69e7[_0x5f1367(0x44,-0x89,-0x22,0x2d)](_0x61fee5,_0x73005d(0x521,0x507,0x491,0x4a1)+_0x5f1367(0x147,0x84,0x14f,0x144)+'持酒馆代理，切换为直'+_0x73005d(0x449,0x566,0x42c,0x4c2)),_0x2b6b85=_0x3fcac8;const _0x2a7806={};_0x2a7806[_0x5f1367(0x57,0x9a,0x84,0x116)+'pe']=_0x73005d(0x48c,0x585,0x510,0x4de)+_0x5f1367(0xd5,0x9a,0x91,0x11f),_0x2a7806['Authorizat'+_0x5f1367(0x1bf,0x1d5,0xeb,0x15a)]='Bearer\x20'+_0x980c12,_0x44ef01=_0x2a7806,_0x407df7=_0x25be63;}else for(const _0x1b3a85 of _0x3875c9){if(_0x2e69e7[_0x5f1367(0xbb,0x45,0xbc,0x2e)]===_0x73005d(0x3ca,0x4b5,0x356,0x406))throw new _0x16adaa(_0x2e69e7[_0x73005d(0x58e,0x4b4,0x4a8,0x4ca)]);else{if(_0x1b3a85[_0x73005d(0x457,0x44e,0x484,0x44e)]===_0x2e69e7[_0x5f1367(0x10f,0x82,0x104,0xd0)]&&_0x1b3a85[_0x73005d(0x457,0x38f,0x489,0x425)]?.[_0x5f1367(0x16a,0x128,0xe2,0x10a)]){_0x2068ac=_0x1b3a85[_0x5f1367(0x70,0x5,-0x1b,0x53)]['url'];break;}}}}else{if(_0x2e69e7[_0x73005d(0x3fa,0x3cd,0x4d0,0x422)](typeof _0x3875c9,_0x73005d(0x34a,0x46f,0x341,0x3d0))){const _0x2ba3b0=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x399c44=_0x3875c9[_0x5f1367(0xf7,0x52,0x11,0x9b)](_0x2ba3b0);if(_0x399c44&&_0x399c44[-0x227b+0x775*-0x2+0x3166]){const _0x24f951=_0x399c44[0x11a*0x9+0x1d40+0x5*-0x7d5];if(_0x24f951[_0x73005d(0x3e3,0x4d8,0x37b,0x438)](_0x2e69e7['bNAKY']))addLog(_0x2e69e7[_0x5f1367(0x17e,0xd5,0x18d,0x137)]),_0x2068ac=_0x24f951,_0x2e69e7[_0x5f1367(0xb3,0xb4,0x138,0x141)](addLog,_0x2e69e7[_0x5f1367(0x119,0x53,0x95,0x56)]);else{_0x2e69e7[_0x5f1367(-0x1c,-0x62,-0x41,0x0)](addLog,'[Banana]\x20D'+_0x5f1367(0x10c,-0xd,0x100,0xab)+'rkdown\x20ima'+'ge\x20URL,\x20ex'+'tracting..'+'.'),addLog('[Banana]\x20M'+_0x5f1367(0x162,0x57,-0x2,0xb6)+_0x73005d(0x354,0x375,0x3ff,0x3c6)+_0x24f951);try{const _0x1cc28f=await fetch(_0x24f951);if(!_0x1cc28f['ok'])throw new Error(_0x5f1367(0xb8,0x86,0x16b,0xcb)+_0x73005d(0x4b3,0x4b4,0x4ac,0x524)+_0x5f1367(0x136,0x185,0x9f,0x132)+_0x1cc28f['status']);const _0x488f53=await _0x1cc28f[_0x5f1367(0x68,0xc6,0xc0,0x1e)](),_0x14e2bf=await new Promise((_0x191b93,_0x5d9dfc)=>{function _0x4ba893(_0x3de5ab,_0x5af915,_0x1e1ad4,_0xb89e3){return _0x5f1367(_0x3de5ab-0x193,_0x3de5ab,_0x1e1ad4-0x1f1,_0x5af915- -0x280);}const _0x14ac23=new FileReader();_0x14ac23[_0x1af89c(0x48f,0x511,0x4f7,0x405)]=()=>_0x191b93(_0x14ac23[_0x4ba893(-0x271,-0x206,-0x1de,-0x274)]);function _0x1af89c(_0x50758d,_0x15c8fe,_0x222266,_0x5dc303){return _0x5f1367(_0x50758d-0xa6,_0x222266,_0x222266-0x16c,_0x50758d-0x40d);}_0x14ac23['onerror']=_0x5d9dfc,_0x14ac23['readAsData'+_0x1af89c(0x497,0x4e1,0x4ec,0x480)](_0x488f53);});_0x2068ac=_0x14e2bf,_0x2e69e7[_0x5f1367(0x6,0x49,-0x49,0x2d)](addLog,'[Banana]\x20S'+_0x73005d(0x4a0,0x4ae,0x42c,0x4f0)+_0x73005d(0x3e7,0x3f0,0x463,0x41e)+_0x73005d(0x429,0x4a6,0x45e,0x4b5)+_0x73005d(0x47c,0x3fe,0x401,0x48f)+_0x73005d(0x4a3,0x548,0x57c,0x4e4));}catch(_0x22dda8){if(_0x2e69e7[_0x5f1367(0xcf,0x1d7,0x135,0x127)]===_0x2e69e7[_0x73005d(0x4b9,0x4a8,0x3e0,0x3f9)]){const _0x3fe80c=_0x5f1367(0xfc,0x190,0xfa,0x155)[_0x73005d(0x4e2,0x4bc,0x48d,0x462)]('|');let _0x41cd86=0x3c4+0x14ea+0x1a*-0xf3;while(!![]){switch(_0x3fe80c[_0x41cd86++]){case'0':if(_0x5422a6[_0x73005d(0x526,0x54b,0x52b,0x4b8)]===_0x2e69e7[_0x5f1367(0xce,0x40,0xde,0xd5)]){}else _0x4e3b11[_0x5f1367(-0x5e,0xb5,0x36,0x40)+'sk'](_0x4f373e,![]);continue;case'1':_0x5adb26(_0x73005d(0x525,0x5c0,0x488,0x523)+_0x5f1367(-0xcc,0x21,0x7b,-0x15)+':\x20'+_0x55f767['message']);continue;case'2':throw _0x2ecbb1;continue;case'3':_0x4ca001=null;continue;case'4':_0x17ec2e[_0x5f1367(0xe9,0x1f,0x3d,0x4b)](_0x2e69e7[_0x5f1367(0x11e,0x17c,0x15d,0xbb)],_0x924645);continue;}break;}}else addLog(_0x73005d(0x55c,0x585,0x50b,0x523)+_0x5f1367(0x1da,0x63,0x181,0x117)+_0x5f1367(-0x66,0x59,0xf6,0x43)+_0x73005d(0x41e,0x473,0x4c5,0x47c)+'\x20'+_0x22dda8[_0x73005d(0x494,0x50b,0x43d,0x4b8)]),_0x2068ac=_0x24f951,_0x2e69e7[_0x73005d(0x555,0x5db,0x56d,0x52a)](addLog,_0x2e69e7[_0x73005d(0x44f,0x522,0x43b,0x470)]);}}}else addLog(_0x2e69e7[_0x5f1367(0xf2,0x12e,0x93,0xd7)]);}}}if(!_0x2068ac)throw new Error(_0x2e69e7['Apkgu']);return _0x2e69e7[_0x5f1367(0x98,0x50,-0x34,0x6)](addLog,_0x5f1367(0x13b,0x118,0x74,0xcf)+'mage\x20gener'+_0x73005d(0x47b,0x3f7,0x4fe,0x461)+_0x5f1367(0x1eb,0x94,0x179,0x139)),taskQueue[_0x73005d(0x366,0x4cb,0x3a1,0x412)+'sk'](_0x1ff768,!![]),currentTaskId=null,{'image':_0x2068ac,'change':_0x2e69e7[_0x73005d(0x40b,0x4aa,0x560,0x4d0)](_0x4e272c,'')};}catch(_0x591fc1){const _0x257781=_0x2e69e7[_0x73005d(0x481,0x51b,0x525,0x50a)]['split']('|');let _0x32d338=0x1659+0x1830+-0x1*0x2e89;while(!![]){switch(_0x257781[_0x32d338++]){case'0':currentTaskId=null;continue;case'1':_0x2e69e7[_0x73005d(0x459,0x422,0x46c,0x4af)](addLog,'[Banana]\x20F'+_0x5f1367(-0xd4,0x44,0xf,-0x15)+':\x20'+_0x591fc1[_0x5f1367(0x14f,0x14a,0x131,0xe6)]);continue;case'2':console['error'](_0x5f1367(0xa7,0xcf,0x10c,0x151)+_0x5f1367(-0x1d,0x8f,0x23,-0x15)+':',_0x591fc1);continue;case'3':if(_0x2e69e7[_0x73005d(0x3fd,0x497,0x3ca,0x442)](_0x591fc1[_0x73005d(0x55a,0x576,0x3f9,0x4b8)],_0x2e69e7[_0x5f1367(0x133,0xda,0x191,0xd5)])){}else taskQueue[_0x5f1367(-0x6e,0x4a,0x19,0x40)+'sk'](_0x1ff768,![]);continue;case'4':throw _0x591fc1;continue;}break;}}}export async function bananaGenerate(_0x1b7a5f){const _0x6da43c={'YouVa':function(_0x20b43e,_0x205bca){return _0x20b43e+_0x205bca;},'AsZCm':function(_0x4111fc,_0x188720){return _0x4111fc+_0x188720;},'walEY':function(_0x578330,_0x521a23){return _0x578330(_0x521a23);},'rbDSi':function(_0x8ef62f){return _0x8ef62f();},'ODYzy':_0x3d3068(0x172,0x1f8,0x171,0x26a),'VXNjK':function(_0x153d68,_0x517cc5){return _0x153d68(_0x517cc5);},'GuRXj':function(_0x5c2639,_0x4cb4e8){return _0x5c2639!==_0x4cb4e8;},'etibW':_0x54297b(0x354,0x34c,0x3a6,0x31f),'dQvtn':_0x54297b(0x349,0x3c8,0x316,0x30f),'wGHiC':function(_0x58a8cf,_0x2c4e86){return _0x58a8cf(_0x2c4e86);},'MKynF':function(_0x1273f1,_0x17c1c7){return _0x1273f1!=_0x17c1c7;},'xvFBS':_0x3d3068(0x24a,0x296,0x353,0x2ef),'GnFKE':_0x54297b(0x2e9,0x38c,0x2c4,0x290),'CHvty':function(_0x418d74,_0x4e42e4){return _0x418d74(_0x4e42e4);},'eVmbn':function(_0x5f32b5,_0x3532d6){return _0x5f32b5+_0x3532d6;},'HrmIX':function(_0x1f0c19,_0x466972){return _0x1f0c19(_0x466972);},'tyNDh':_0x54297b(0x30e,0x3b0,0x2ea,0x396),'iwUsr':function(_0x431a00,_0x77a29e){return _0x431a00(_0x77a29e);}};_0x6da43c[_0x54297b(0x326,0x269,0x3e5,0x3a4)](clearLog);let {id:_0x3c3181,prompt:_0x3a0171,width:_0x4cf4d7,height:_0x59c23f,change:_0x2b8b94,retouchPrompt:_0x55adba,retouchImage:_0x286be8}=_0x1b7a5f;currentRequestId=_0x3c3181,currentPrompt=_0x3a0171,addLog(_0x3d3068(0x264,0x2bf,0x21a,0x2ff)+'eceived\x20im'+_0x54297b(0x2ff,0x38d,0x270,0x23c)+'tion\x20reque'+_0x54297b(0x2b3,0x254,0x280,0x35e)+_0x3c3181+')');function _0x3d3068(_0x528013,_0x2ec5b5,_0x35d1a7,_0x29342a){return _0x2ea0(_0x2ec5b5-0xa0,_0x528013);}let _0x23152d='';_0x2b8b94?_0x23152d=_0x2b8b94['replaceAll'](_0x54297b(0x2c8,0x356,0x314,0x20d),''):_0x23152d=_0x3a0171;if(_0x2b8b94&&_0x2b8b94[_0x54297b(0x2fd,0x36a,0x24d,0x34f)](_0x6da43c[_0x54297b(0x32f,0x3cb,0x391,0x2ad)])){_0x6da43c[_0x54297b(0x3e6,0x43a,0x329,0x412)](addLog,_0x3d3068(0x22b,0x24e,0x1ac,0x2cf)+'启动');if(_0x55adba)_0x6da43c[_0x3d3068(0x319,0x336,0x329,0x3ad)](addLog,_0x3d3068(0x332,0x2e2,0x296,0x318)+_0x55adba);if(_0x286be8)addLog(_0x3d3068(0x215,0x24c,0x1f7,0x1c1)+']');}function _0x54297b(_0xb126da,_0x53dcd1,_0x169b5b,_0x7f94e7){return _0x2ea0(_0xb126da-0x170,_0x53dcd1);}try{if(_0x6da43c[_0x54297b(0x2f0,0x3a2,0x24a,0x26e)](_0x6da43c[_0x3d3068(0x227,0x291,0x2c7,0x34a)],_0x6da43c[_0x3d3068(0x16b,0x230,0x232,0x296)])){const {image:_0x45d0e4,change:_0x34fd7c}=await _0x6da43c[_0x3d3068(0x27c,0x30b,0x247,0x277)](generateBananaImage,{'prompt':_0x3a0171,'width':_0x4cf4d7,'height':_0x59c23f,'change':_0x2b8b94,'retouchPrompt':_0x55adba,'retouchImage':_0x286be8});if(_0x6da43c[_0x3d3068(0x2fe,0x2b2,0x2fe,0x239)](extension_settings[extensionName][_0x54297b(0x378,0x2ef,0x412,0x3ec)],'0')){if(_0x6da43c['xvFBS']===_0x6da43c['GnFKE']){const _0x4c752e=_0x44285b?function(){function _0x4272f4(_0x40c4a2,_0x31b693,_0x496919,_0x4d4661){return _0x3d3068(_0x31b693,_0x40c4a2-0x24c,_0x496919-0x19d,_0x4d4661-0xd0);}if(_0x3c02a1){const _0x3ba436=_0xba580a[_0x4272f4(0x517,0x506,0x4c3,0x456)](_0x1eef68,arguments);return _0x1a951d=null,_0x3ba436;}}:function(){};return _0x54256d=![],_0x4c752e;}else{const _0x5ce627={};_0x5ce627[_0x3d3068(0x289,0x309,0x2ba,0x36a)]=_0x23152d,await setItemImg(_0x3a0171,_0x45d0e4,_0x5ce627),_0x6da43c[_0x3d3068(0x3dd,0x364,0x329,0x313)](addLog,_0x54297b(0x38d,0x34e,0x39f,0x388)+_0x54297b(0x363,0x2b3,0x385,0x303)+'\x20'+_0x3a0171),extension_settings[extensionName][_0x54297b(0x2af,0x326,0x2ae,0x1e9)][_0x54297b(0x407,0x3f6,0x390,0x394)]?(extension_settings[extensionName][_0x54297b(0x2af,0x2cc,0x23b,0x1f5)][_0x54297b(0x407,0x48e,0x49e,0x36c)]=_0x6da43c[_0x54297b(0x2cc,0x2fd,0x35b,0x232)](extension_settings[extensionName][_0x3d3068(0x20b,0x1df,0x163,0x241)]['cishu'],-0xc3*-0x31+0x1c*0x16+0x71*-0x5a),_0x6da43c[_0x54297b(0x2d8,0x243,0x352,0x2aa)](addLog,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+extension_settings[extensionName][_0x3d3068(0x165,0x1df,0x18d,0x246)]['cishu'])):_0x6da43c[_0x54297b(0x3a1,0x38e,0x385,0x3b7)]!==_0x54297b(0x353,0x340,0x2a1,0x3bd)?(extension_settings[extensionName][_0x54297b(0x2af,0x36c,0x21a,0x33e)][_0x54297b(0x407,0x429,0x466,0x4a8)]=-0xa*0x125+-0x4aa+0x101d,_0x6da43c[_0x54297b(0x3e6,0x48c,0x46c,0x3a0)](addLog,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+extension_settings[extensionName][_0x54297b(0x2af,0x2f7,0x223,0x1ee)]['cishu'])):_0x408b57[_0x54297b(0x2c4,0x23e,0x228,0x28b)+_0x5118ce+_0x54297b(0x3f7,0x387,0x39c,0x4b1)]&&(_0x1e6169=_0x6da43c[_0x54297b(0x3f2,0x42d,0x3ce,0x40d)](_0x6da43c[_0x54297b(0x2f6,0x256,0x24f,0x2e1)](_0x20c239,_0x3d3068(0x362,0x31a,0x328,0x37e)),_0x6da43c[_0x3d3068(0x2d3,0x316,0x346,0x31a)](_0x13e1a8,_0x540ace[_0x3d3068(0x249,0x1f4,0x274,0x17c)+_0x4f59c6+_0x3d3068(0x3b6,0x327,0x368,0x306)])));}}else _0x6da43c[_0x54297b(0x3e6,0x425,0x36e,0x345)](addLog,_0x54297b(0x384,0x34c,0x339,0x3b6)+'库');const _0x1d9e64={};_0x1d9e64['id']=_0x3c3181,_0x1d9e64['success']=!![],_0x1d9e64[_0x3d3068(0x22c,0x23a,0x1e8,0x1bf)]=_0x45d0e4,_0x1d9e64[_0x54297b(0x404,0x4a1,0x413,0x422)]=_0x3a0171,_0x1d9e64['change']=_0x23152d,eventSource[_0x54297b(0x32a,0x3e0,0x32e,0x30f)](EventType['GENERATE_I'+_0x54297b(0x42b,0x463,0x3ac,0x3c2)+'NSE'],_0x1d9e64),_0x6da43c[_0x3d3068(0x312,0x364,0x2ed,0x3dc)](addLog,'[Banana]\x20E'+'mitted\x20suc'+_0x54297b(0x34f,0x2d8,0x2c8,0x29b)+'nse\x20for\x20ID'+':\x20'+_0x3c3181);}else _0x6da43c[_0x54297b(0x3e6,0x479,0x42b,0x43c)](_0x77fb42,_0x3d3068(0x237,0x2b4,0x20f,0x2b5)+'库');}catch(_0x17496a){const _0x1a17b9=_0x54297b(0x2fc,0x2bc,0x2b4,0x338)+_0x3d3068(0x379,0x358,0x32c,0x3df)+'failed\x20for'+_0x3d3068(0x2f4,0x2b7,0x351,0x32d)+_0x3c3181+':\x20'+_0x17496a[_0x3d3068(0x293,0x2d7,0x244,0x374)];_0x6da43c[_0x54297b(0x370,0x399,0x2df,0x345)](addLog,_0x1a17b9),console['error'](_0x1a17b9);const _0x42ebaa={};_0x42ebaa['id']=_0x3c3181,_0x42ebaa[_0x54297b(0x320,0x377,0x2e2,0x25c)]=![],_0x42ebaa['error']=_0x17496a['message'],_0x42ebaa[_0x54297b(0x404,0x3b1,0x39c,0x35b)]=_0x3a0171,eventSource[_0x3d3068(0x28f,0x25a,0x26f,0x1c7)](EventType[_0x3d3068(0x18c,0x224,0x232,0x166)+'MAGE_RESPO'+_0x3d3068(0x17a,0x223,0x2c0,0x18c)],_0x42ebaa),_0x6da43c['CHvty'](addLog,_0x3d3068(0x1f6,0x276,0x32f,0x1f8)+'mitted\x20fai'+_0x54297b(0x334,0x39c,0x3b2,0x2a6)+_0x54297b(0x33c,0x34f,0x384,0x281)+':\x20'+_0x3c3181);}}function handleCancelBananaTask(_0x17056c){const _0x35b579={'knlPn':function(_0x4aab60,_0x53396c){return _0x4aab60(_0x53396c);},'OhNpB':function(_0x4cf6d9,_0x2647b8){return _0x4cf6d9===_0x2647b8;},'vsQKd':function(_0xf01f43,_0x210a63){return _0xf01f43(_0x210a63);},'IvbwH':_0x9e815(-0x77,-0x10,0x47,-0x58),'qBEiC':function(_0x24425a,_0x179268){return _0x24425a||_0x179268;}},{taskId:_0x50e59f}=_0x17056c;function _0x53b87c(_0x3d8aa6,_0x451398,_0x14072a,_0x402845){return _0x2ea0(_0x3d8aa6-0x157,_0x451398);}_0x35b579[_0x53b87c(0x2bc,0x261,0x275,0x20c)](addLog,_0x9e815(-0xe9,-0xbd,-0xcd,-0xe5)+_0x53b87c(0x3ad,0x2f2,0x2f1,0x387)+_0x53b87c(0x359,0x31d,0x2d9,0x33e)+_0x50e59f+')');function _0x9e815(_0x43b31a,_0x371e5e,_0x5d8e9e,_0x2acc83){return _0x2ea0(_0x2acc83- -0x2d9,_0x5d8e9e);}_0x35b579[_0x53b87c(0x34c,0x307,0x2b2,0x367)](currentTaskId,_0x50e59f)&&currentRequestId&&(_0x35b579[_0x9e815(-0x1bf,-0x137,-0x155,-0x12e)](addLog,_0x9e815(-0xd3,-0x166,-0x1d8,-0x140)+_0x53b87c(0x39d,0x356,0x43b,0x352)+_0x9e815(-0x20a,-0x23b,-0x1ef,-0x199)+currentRequestId+')'),eventSource['emit'](EventType[_0x53b87c(0x2db,0x28b,0x284,0x2f9)+_0x9e815(-0xb1,-0x1b,0x4e,-0x1e)+_0x9e815(-0x147,-0x1f8,-0x1a4,-0x156)],{'id':currentRequestId,'success':![],'error':_0x35b579[_0x9e815(-0x20,0x33,-0x78,-0x40)],'prompt':_0x35b579[_0x53b87c(0x3ca,0x37f,0x370,0x480)](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function initializeBananaListener(){function _0xf99ac4(_0x2a9167,_0x3ff962,_0x3ab149,_0x4c748e){return _0x2ea0(_0x2a9167-0x1dc,_0x4c748e);}const _0x405800={'nPjdR':_0xf99ac4(0x478,0x43b,0x424,0x469)+_0xf99ac4(0x337,0x2c7,0x32a,0x27c)+'ana_task','ONLuL':function(_0x3734b0,_0xd27319){return _0x3734b0(_0xd27319);},'oKDfk':'banana\x20生图事'+_0x5aab3c(-0x19d,-0x105,-0xf7,-0x155)};function _0x5aab3c(_0x32e761,_0x149da6,_0x23c770,_0x3ce42a){return _0x2ea0(_0x3ce42a- -0x394,_0x149da6);}eventSource['on'](EventType[_0xf99ac4(0x360,0x422,0x3d5,0x350)+_0xf99ac4(0x43e,0x4f8,0x417,0x386)+'ST'],bananaGenerate),eventSource['on'](_0x405800[_0xf99ac4(0x363,0x34d,0x3f5,0x405)],handleCancelBananaTask),_0x405800[_0x5aab3c(-0x18f,-0x4a,-0xef,-0xd8)](addLog,_0x405800[_0xf99ac4(0x3f7,0x408,0x3c2,0x4ae)]);}export async function replaceWithBanana(){function _0x41f7b5(_0x2e7ab1,_0x375f03,_0x36d967,_0x4a9713){return _0x2ea0(_0x4a9713-0x27e,_0x375f03);}const _0x64682e={'azDBq':_0x48754c(0x3f1,0x436,0x413,0x377),'UyPhm':_0x48754c(0x3f1,0x3db,0x47f,0x3ef),'umnoA':_0x41f7b5(0x445,0x44e,0x4d7,0x470),'fKGOk':_0x48754c(0x451,0x3bb,0x394,0x479),'KcngK':function(_0x2bfe5e,_0x41519b){return _0x2bfe5e(_0x41519b);},'mXDLs':function(_0x2e5b0c,_0x538432){return _0x2e5b0c(_0x538432);},'itIZA':_0x41f7b5(0x4ae,0x4a5,0x5ab,0x531),'HileL':function(_0x58f502,_0x5af593){return _0x58f502===_0x5af593;},'sdMBt':'jCwOQ','uRVBM':'image_url','UnQnH':'(((.+)+)+)'+'+$','DZKYd':function(_0x2ef321,_0x4aad17){return _0x2ef321==_0x4aad17;},'zyWvH':_0x48754c(0x280,0x2d5,0x393,0x331),'MWCFV':function(_0x1a0968){return _0x1a0968();},'sZWuk':_0x48754c(0x34c,0x3b0,0x371,0x459),'AGApX':_0x41f7b5(0x3ce,0x4e3,0x4ab,0x444),'KljRe':'st_chatu8_'+_0x48754c(0x301,0x2f1,0x27d,0x313)+'ana_task','nxpsv':function(_0x5bde37,_0x47af8c){return _0x5bde37(_0x47af8c);},'hfGEP':_0x48754c(0x3db,0x3d4,0x3d3,0x313)+_0x41f7b5(0x4e3,0x3dd,0x3ec,0x491)};function _0x48754c(_0x54f8c3,_0x3cab36,_0x5ebb22,_0x11b1fa){return _0x2ea0(_0x3cab36-0x196,_0x11b1fa);}if(_0x64682e[_0x48754c(0x355,0x301,0x2f2,0x267)](extension_settings[extensionName][_0x48754c(0x419,0x433,0x4f5,0x416)],_0x64682e[_0x41f7b5(0x4f0,0x59e,0x596,0x4f7)])){if(!window['initialize'+'BananaList'+_0x48754c(0x384,0x3de,0x498,0x3cc)]){if(_0x64682e[_0x41f7b5(0x55b,0x546,0x564,0x50c)]('gvtFS','gvtFS'))window['initialize'+_0x41f7b5(0x449,0x4a2,0x561,0x4fb)+'ener']=!![],_0x64682e[_0x48754c(0x315,0x320,0x3bf,0x306)](initializeBananaListener);else{_0x5e2cbb=_0x48754c(0x290,0x31f,0x258,0x3db)+_0x41f7b5(0x5e5,0x4b4,0x47d,0x544)+_0x3ab68f;const _0x4c0107={};_0x4c0107[_0x41f7b5(0x53f,0x4af,0x5af,0x4fd)+'t']='';const _0x3384b2=_0x9bd55[_0x2b34e3]||_0x4c0107,_0x3a1886=[_0x3384b2[_0x48754c(0x396,0x415,0x465,0x4dc)+'t'],_0x295505[_0x64682e['azDBq']],_0x1aba19[_0x64682e[_0x41f7b5(0x462,0x330,0x486,0x3c5)]],_0x9bf28f,_0x4c5f26[_0x64682e[_0x48754c(0x303,0x39a,0x3af,0x3fc)]],_0x260d02['后置后'],_0x3384b2['postfixPro'+_0x48754c(0x447,0x39b,0x3ca,0x449)],_0x2321d3[_0x64682e[_0x48754c(0x494,0x457,0x3e5,0x442)]]][_0x41f7b5(0x362,0x479,0x32e,0x3ca)](_0x5d9c4c)['join'](',\x20');_0x64682e['KcngK'](_0x41118f,'正面提示词:\x20'+_0x3a1886);const _0x36b4c6={};_0x36b4c6[_0x41f7b5(0x5c8,0x54c,0x550,0x512)]=_0x3a1886;const _0x8a2d87={};_0x8a2d87[_0x48754c(0x3fe,0x3d9,0x3a2,0x3b0)+'t']=0x1,_0x8a2d87[_0x41f7b5(0x52e,0x5a1,0x517,0x530)+'o']=_0x182f7f;const _0x27b6a6={};_0x27b6a6[_0x48754c(0x3b6,0x36b,0x318,0x2e7)]=[_0x36b4c6],_0x27b6a6[_0x48754c(0x428,0x3f6,0x3e6,0x370)]=_0x8a2d87,_0x5e4586=_0x27b6a6,_0x37b725('[Banana]\x20B'+_0x48754c(0x502,0x44b,0x4b1,0x4c1)+_0x48754c(0x421,0x3d3,0x47c,0x432)+'with\x20promp'+_0x48754c(0x38b,0x41c,0x4bf,0x40d)+_0x3a1886);}}_0x64682e[_0x48754c(0x37b,0x320,0x39d,0x338)](initializeImageProcessing);}else{if(_0x64682e[_0x41f7b5(0x4fc,0x592,0x597,0x50c)](_0x41f7b5(0x4e3,0x538,0x44c,0x498),_0x64682e[_0x48754c(0x482,0x3fc,0x41b,0x390)])){if(window[_0x48754c(0x2de,0x368,0x3b3,0x2dc)+_0x41f7b5(0x48b,0x4fe,0x538,0x4fb)+_0x48754c(0x442,0x3de,0x442,0x437)]){if(_0x64682e[_0x41f7b5(0x519,0x51c,0x5af,0x50c)](_0x48754c(0x362,0x35c,0x3a5,0x401),_0x64682e[_0x48754c(0x46e,0x427,0x4b4,0x4b5)]))eventSource[_0x48754c(0x3e0,0x402,0x3a7,0x369)+_0x48754c(0x31f,0x3de,0x3a5,0x3b6)](EventType[_0x48754c(0x2f5,0x31a,0x326,0x36b)+_0x48754c(0x3d3,0x3f8,0x38b,0x3ce)+'ST'],bananaGenerate),eventSource[_0x48754c(0x4af,0x402,0x3c7,0x48e)+'ener'](_0x64682e[_0x48754c(0x335,0x30b,0x3ae,0x337)],handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x41f7b5(0x36a,0x364,0x36a,0x3e8)](_0xb58baf=>{function _0x58ffae(_0x183aeb,_0x520d79,_0x3c3b66,_0x468c2c){return _0x48754c(_0x183aeb-0xa1,_0x468c2c-0x13,_0x3c3b66-0xec,_0x520d79);}const _0x1ac050={'YINJZ':function(_0x10a55a,_0x24c267){return _0x10a55a||_0x24c267;},'BQhUB':_0x58ffae(0x3fe,0x424,0x345,0x3b4),'ZGOuY':function(_0x6077b0,_0x5176b3){function _0x19468a(_0x5b7949,_0x35262f,_0x30c45a,_0x33f542){return _0x58ffae(_0x5b7949-0x1ca,_0x33f542,_0x30c45a-0x1c,_0x35262f-0x20f);}return _0x64682e[_0x19468a(0x489,0x51f,0x599,0x486)](_0x6077b0,_0x5176b3);},'wrzDj':_0x64682e[_0x20295c(0x172,0xe1,0x128,0xf3)],'GcCxH':function(_0x24534d,_0x37b2ef){return _0x64682e['mXDLs'](_0x24534d,_0x37b2ef);}};function _0x20295c(_0x135964,_0x100798,_0x56f265,_0x1ae554){return _0x48754c(_0x135964-0x136,_0x100798- -0x311,_0x56f265-0xa8,_0x135964);}if(_0x64682e[_0x20295c(0x8a,0x113,0x54,0x193)](_0x20295c(0x98,0x13b,0x200,0x162),_0x64682e[_0x20295c(0x20,0xe6,0xac,0x63)]))eventSource[_0x20295c(0x99,0xf1,0xba,0x167)+_0x58ffae(0x466,0x363,0x44b,0x3f1)](_0xb58baf,bananaGenerate);else{const _0x5683bc=[],_0x173d61=_0x1ac050['YINJZ'](_0x4374b1,_0x45080c),_0x4e1f55=[_0x2f4fb5['fixedPromp'+'t'],_0x173d61,_0x192031[_0x58ffae(0x400,0x340,0x3a0,0x3c7)+_0x20295c(0x123,0x8a,0xd6,0x80)]][_0x58ffae(0x395,0x298,0x385,0x2f5)](_0x53538b)[_0x20295c(-0x1e,0x95,0xdc,0x31)](',\x20'),_0xc7c763={};_0xc7c763[_0x58ffae(0x2cb,0x35f,0x3c6,0x376)]=_0x1ac050[_0x58ffae(0x3df,0x3da,0x336,0x3a3)],_0xc7c763['text']=_0x4e1f55,_0x5683bc[_0x58ffae(0x3fa,0x3a0,0x391,0x386)](_0xc7c763);if(_0x3b6cd8){const _0x576a7e={};_0x576a7e[_0x20295c(0x1a7,0xe0,0x8e,0xe5)]=_0x3d24f3;const _0x250fb5={};_0x250fb5[_0x20295c(0x10d,0x52,-0x58,-0x9)]=_0x20295c(0x83,0x29,0x68,0x31),_0x250fb5['image_url']=_0x576a7e,_0x5683bc[_0x20295c(0xb6,0x62,-0x21,-0x36)](_0x250fb5),_0x1ac050[_0x58ffae(0x498,0x375,0x400,0x3e1)](_0x56beb4,_0x20295c(0x50,0x88,0x7e,-0x32)+_0x58ffae(0x38e,0x33a,0x319,0x35a)+_0x58ffae(0x2f4,0x3a8,0x3d8,0x348));}const _0x57f878={};_0x57f878['role']=_0x1ac050['wrzDj'],_0x57f878[_0x58ffae(0x429,0x47b,0x333,0x3df)]=_0x5683bc,_0x54c3e5[_0x20295c(-0xd,0x62,0xb2,0xf1)](_0x57f878),_0x1ac050[_0x20295c(-0x55,0xd,-0x7b,0x46)](_0x775583,_0x20295c(0x142,0x88,-0xb,0x12c)+'图模式：指令\x20=\x20'+_0x4e1f55);}}),window[_0x41f7b5(0x4e6,0x506,0x45d,0x450)+'BananaList'+_0x48754c(0x450,0x3de,0x3dc,0x495)]=![],_0x64682e[_0x48754c(0x410,0x44d,0x4e3,0x4fa)](addLog,_0x64682e[_0x48754c(0x4bb,0x429,0x3d7,0x43b)]);else{const _0x439230={};_0x439230[_0x41f7b5(0x556,0x46f,0x440,0x4d9)]=_0xdc6942;const _0x2ca6b2={};_0x2ca6b2[_0x41f7b5(0x3e9,0x484,0x3d5,0x44b)]=_0x64682e[_0x48754c(0x434,0x3e6,0x44e,0x3ee)],_0x2ca6b2[_0x48754c(0x2d4,0x33a,0x2fe,0x2d2)]=_0x439230,_0x4a8de0[_0x41f7b5(0x42a,0x449,0x4be,0x45b)](_0x2ca6b2),_0x64682e[_0x41f7b5(0x3e3,0x422,0x44f,0x476)](_0xe71863,_0x41f7b5(0x42a,0x50a,0x47b,0x481)+_0x48754c(0x2ed,0x347,0x301,0x3c8)+_0x48754c(0x39c,0x335,0x312,0x37d));}}}else return _0x459726[_0x41f7b5(0x323,0x474,0x3cc,0x3e1)]()[_0x41f7b5(0x388,0x38d,0x38f,0x3f0)]('(((.+)+)+)'+'+$')['toString']()[_0x41f7b5(0x5f4,0x52d,0x58a,0x53b)+'r'](_0x2dede7)[_0x48754c(0x3c7,0x308,0x2e6,0x2a3)](sMphvj[_0x48754c(0x392,0x395,0x42a,0x449)]);}}