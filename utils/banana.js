(function(_0x4790d9,_0xe0cd76){const _0x2ff9f8=_0x4790d9();function _0x146a3d(_0x8d09ee,_0x1105bc,_0x7f431b,_0x444846){return _0x2797(_0x444846-0xe4,_0x1105bc);}function _0x3483d2(_0x47464b,_0x4c67c5,_0x2475b6,_0x9b5801){return _0x2797(_0x9b5801- -0x29c,_0x47464b);}while(!![]){try{const _0x4c47b8=-parseInt(_0x3483d2(-0x62,-0xc7,-0x8e,-0xdd))/(-0x1021+-0x1a28+0x1525*0x2)+-parseInt(_0x146a3d(0x223,0x212,0x288,0x25d))/(-0xa2b+-0x1*0x437+0x133*0xc)*(-parseInt(_0x3483d2(-0x10e,-0x11d,-0x177,-0x19c))/(0x1695+-0x24d4+-0x2da*-0x5))+parseInt(_0x3483d2(-0x1db,-0x22c,-0x139,-0x1bf))/(0x1146+0xc2c+0x2*-0xeb7)+-parseInt(_0x146a3d(0x278,0x332,0x2fa,0x2d0))/(0x2113*-0x1+-0xd60+0x2e78)*(-parseInt(_0x146a3d(0x228,0x257,0x158,0x1cf))/(0x1490*-0x1+0xbf*-0x1c+0x297a))+-parseInt(_0x3483d2(-0x99,-0xb1,-0x103,-0xf6))/(0x787+0x1*-0x1d55+-0x15d5*-0x1)*(parseInt(_0x146a3d(0x247,0x236,0x1a0,0x20e))/(-0x92*-0xe+-0xa61*-0x1+-0x1*0x1255))+-parseInt(_0x3483d2(-0xfc,-0x16f,-0x1ff,-0x181))/(0x25ce+0x2239*-0x1+-0x38c)+parseInt(_0x146a3d(0x2f3,0x32f,0x353,0x2d3))/(0x2*0x556+0x2689*0x1+-0x312b);if(_0x4c47b8===_0xe0cd76)break;else _0x2ff9f8['push'](_0x2ff9f8['shift']());}catch(_0x15de50){_0x2ff9f8['push'](_0x2ff9f8['shift']());}}}(_0x5076,0xfc932+0xd9ac1+0xb*-0x1bef3));const _0x484ecf=(function(){const _0x506fc7={};_0x506fc7[_0x4e7a24(0x28e,0x278,0x30e,0x260)]=_0x354ddc(0x4c6,0x4ca,0x52d,0x57d)+'图事件监听器已关闭。',_0x506fc7[_0x354ddc(0x3ef,0x47e,0x453,0x42d)]=function(_0x2894b1,_0x42f038){return _0x2894b1!==_0x42f038;},_0x506fc7[_0x4e7a24(0x260,0x236,0x2f1,0x1e1)]=_0x4e7a24(0x351,0x3dc,0x2fb,0x3e8),_0x506fc7[_0x354ddc(0x4d5,0x4a2,0x4f5,0x526)]=function(_0x106b86,_0x5cfe8f){return _0x106b86!==_0x5cfe8f;};function _0x354ddc(_0x309f12,_0x265681,_0x29b03d,_0x2ef632){return _0x2797(_0x29b03d-0x34d,_0x2ef632);}_0x506fc7[_0x354ddc(0x400,0x528,0x495,0x437)]=_0x354ddc(0x4d9,0x47b,0x4fd,0x593);function _0x4e7a24(_0x11025c,_0x2e3f90,_0x2151c6,_0x5159fb){return _0x2797(_0x11025c-0x132,_0x5159fb);}const _0x2288c5=_0x506fc7;let _0x404ff9=!![];return function(_0x5ce44a,_0x3725cf){const _0x9a62c8={'FhlUN':function(_0x4e936e,_0x2e44c5){return _0x4e936e+_0x2e44c5;},'GOTgV':function(_0x4e6082,_0x1e61dc){return _0x4e6082(_0x1e61dc);},'qwheZ':_0x2288c5[_0x4a82a5(0x30b,0x369,0x2f2,0x3be)],'pqYna':function(_0x58d999,_0x13e36e){function _0x211bb4(_0x5eef05,_0x4881a4,_0x2f8ec9,_0x5c9776){return _0x4a82a5(_0x5eef05-0x36,_0x2f8ec9- -0x11e,_0x4881a4,_0x5c9776-0x11c);}return _0x2288c5[_0x211bb4(0x29b,0x222,0x1f5,0x199)](_0x58d999,_0x13e36e);},'yLOCj':_0x2288c5['lPcAd']};function _0x4a82a5(_0x2d73d1,_0x18f74e,_0x48b2ca,_0x4545e6){return _0x354ddc(_0x2d73d1-0x1c9,_0x18f74e-0xdf,_0x18f74e- -0x140,_0x48b2ca);}function _0x542c3f(_0x477717,_0x1773d8,_0x288ea5,_0xf60a6c){return _0x4e7a24(_0x1773d8- -0x21f,_0x1773d8-0x149,_0x288ea5-0x98,_0xf60a6c);}if(_0x2288c5[_0x542c3f(0x4c,0xbb,0x117,0xa2)](_0x2288c5[_0x4a82a5(0x3d9,0x355,0x337,0x3fb)],_0x2288c5[_0x542c3f(0x56,0x5b,-0x19,0x5f)]))_0x118152[_0x542c3f(0xaa,0xa4,0x146,0x108)+_0x5c2cbc+'\x20Prompt']&&(_0xc51d50=_0x9a62c8[_0x542c3f(-0x9c,-0x17,0x29,-0x1)](_0x51faf2,',\x20')+_0x7fa2[_0x4a82a5(0x355,0x39e,0x42a,0x3f9)+_0x1305c2+_0x4a82a5(0x496,0x423,0x4bb,0x386)]);else{const _0x9ce456=_0x404ff9?function(){function _0x4c6747(_0x391c05,_0x52b212,_0x9f497c,_0x4efccb){return _0x542c3f(_0x391c05-0xea,_0x4efccb-0x10,_0x9f497c-0x55,_0x391c05);}function _0x3c4e98(_0x16d3f3,_0xe7702b,_0x2035c8,_0x2ee2f1){return _0x542c3f(_0x16d3f3-0x1c8,_0x2035c8- -0x17f,_0x2035c8-0x43,_0x2ee2f1);}const _0x51ba45={'wwkFP':function(_0x5a5c45,_0x22266f){return _0x9a62c8['GOTgV'](_0x5a5c45,_0x22266f);},'MJEcc':_0x9a62c8[_0x4c6747(0x61,0x66,0xa9,0x70)]};if(_0x9a62c8[_0x4c6747(0x15c,0x88,0x182,0xe7)](_0x9a62c8['yLOCj'],_0x4c6747(0xf0,0xbc,0x118,0xfe))){if(_0x3725cf){const _0x18e2c2=_0x3725cf[_0x4c6747(0xea,0x17d,0x1d2,0x13e)](_0x5ce44a,arguments);return _0x3725cf=null,_0x18e2c2;}}else _0x3f8e0e[_0x4c6747(0x16c,0x8d,0x165,0x128)+_0x4c6747(0xfd,0x3c,0xce,0xa6)](_0x2eed66[_0x4c6747(0x14b,0xeb,0x137,0xad)+_0x3c4e98(-0xdd,-0x161,-0x105,-0xeb)+'ST'],_0x1438e5),_0x3a10f2[_0x3c4e98(-0xa5,-0x11,-0x64,-0x7c)](_0x48ba33=>{function _0x97aaeb(_0x394e4e,_0x5a9de5,_0x43f685,_0x568758){return _0x4c6747(_0x43f685,_0x5a9de5-0xa9,_0x43f685-0xb9,_0x568758-0x190);}function _0x24ff79(_0x23dc47,_0x20b967,_0x2350f4,_0x17a1f0){return _0x4c6747(_0x17a1f0,_0x20b967-0x123,_0x2350f4-0x1c0,_0x20b967-0x96);}_0x482832[_0x97aaeb(0x325,0x31c,0x32c,0x2b8)+_0x97aaeb(0x2a6,0x1a0,0x205,0x236)](_0x48ba33,_0x53f386);}),_0x3f2911[_0x3c4e98(-0xa0,-0x78,-0x5c,-0xd8)+'BananaList'+_0x4c6747(0x11,0x13e,0xe,0xa6)]=![],_0x51ba45[_0x3c4e98(-0x13e,-0x97,-0x117,-0xbc)](_0x47d666,_0x51ba45[_0x4c6747(0x47,-0x6c,-0x6a,-0x4)]);}:function(){};return _0x404ff9=![],_0x9ce456;}};}()),_0x3dd36a=_0x484ecf(this,function(){function _0x54bec7(_0x371d84,_0x157ae7,_0x23ec1d,_0x15d479){return _0x2797(_0x157ae7-0x224,_0x15d479);}const _0x240908={};_0x240908[_0x24a7e7(0x47c,0x485,0x428,0x44a)]=_0x54bec7(0x34a,0x37f,0x3dc,0x3d6)+'+$';const _0x4f819f=_0x240908;function _0x24a7e7(_0x2ad839,_0x4b8eaa,_0x304356,_0x282c97){return _0x2797(_0x304356-0x323,_0x2ad839);}return _0x3dd36a[_0x24a7e7(0x4f0,0x49d,0x51c,0x5ac)]()['search'](_0x4f819f['nrklp'])[_0x54bec7(0x4a6,0x41d,0x388,0x41b)]()[_0x24a7e7(0x490,0x448,0x468,0x40b)+'r'](_0x3dd36a)[_0x24a7e7(0x5bc,0x584,0x540,0x4a1)](_0x4f819f[_0x24a7e7(0x41b,0x3f5,0x428,0x3af)]);});_0x3dd36a();function _0x5076(){const _0x4b375c=['tg1Mqvu','BIbWyxLSB2fKia','CfnZtg0','u2nLBMuGq29TCa','EfrPv08','qwjUs0y','r0DjqNO','teXwBeq','zgf0ytPPBwfNzq','w0jHBMfUyv0G5l+U','y2HHBMDL','yxLSB2fKoIa','tMfvt0K','mty0odjLz0nPDhe','tNvcqKe','w0jHBMfUyv0G5l2/','DMLLuha','zLfKuNK','wKT1vuq','ueXAqLe','ieLeia','w0jHBMfUyv0Gvq','zvbVveG','uhnfEeO','EvPhyLK','DwPls1a','w0jHBMfUyv0GuG','C3ndy2i','BwfW','rMfPBgvKihrVia','BNrHAw5ZihrLEa','y29UDMvYC2f0Aq','zMfPBgvKigzVCG','qufHzuW','mZK4mZGYovbtEevjEG','Axj3Cxa','DhLWzq','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','r2P3uwO','BNjRBha','t0zgv0C','Aw1Hz2veyxrH','seflvNu','AMvet1q','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','w0jHBMfUyv0GrW','s0nAy3a','Bw9KywWGCgf5Ba','ihWG','rvrytLy','CeP0Dgu','y29UDgvUDa','DhjPz2DLCNm','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','su5lzwK','qwfIwLm','yxnZAxn0yw50','yuHRD0S','y2fJAgu','EMnnEe8','Bw9KzwW','ntGWotyYnM9zDg9WBW','55sO5l+U5zU+6Ake6k6+oIaI','DcbvuKWGyxmGzG','CNfvv1i','AxnvzNG','ignVBNrHAw4GAq','CMTKB3DUigLTyq','z2uGzM9YBwf0la','ChjVBxb0','igLTywDLlG','rvrusum','s2fHCgy','BNH6sg8','iIbMCM9TihbYzq','wgrbsNe','ndq4u1Phu1fJ','B25SB2fKzw5K','v2TlrK0','Bw9Kzq','BfbJqwq','CIbWCM9TChq6ia','Aw5ZDgfUy2vZ','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','ywL0z2S','Aw1Hz2vjza','A3DyA1O','seLOzuq','rK1QrMe','C0ryq1e','zxnWB25ZzsbJBW','BNL6ueW','s1rAtKq','vuvvDfa','ztOG','vhLksuS','r3HeBK0','C3rYAw5N','qvbjihjLC3bVBG','Bxb0','BgvUz3rO','B3DUigLTywDLoG','ChveC0W','y29UC3rYDwn0BW','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','5BYa5AEliejHBMfUyEEuNW','EuTntg8','5yMn572U5yMn','w0jHBMfUyv0Gra','ywDLifvstdOG','CLz0y1q','CxDOzvO','v2TxDK0','BNnLigzVCIbjra','tufhrv9srvnqtW','DwvZDcb0BZOG','DK5Qr0q','y3r1zKO','qMvHCMvYia','D3DRrLa','CMvWBgfJzq','vfLMDwu','igv4DhjHy3rPBG','BvrPt3e','yxrLzcbZDwnJzq','kcGOlISPkYKRkq','CxHgy08','BwvZC2fNzq','B2TKsKu','veX0C0S','tePhtNG','u2Pxr2q','vvjm','yMfZzty0lG','CMvZDwX0','lcdPQ5JLUQyGlsa','qMfUyw5H5l+U5zU+5QIH5BYp','tufhrv9srvfvrq','rxPvEui','C3vJy2vZCW','Bwf0y2G','vhnHtg8','C2PkD0u','sgrpzKu','D2L0AcbWCM9TCa','Aw1Hz2vdB25MAq','55sO5lQgihVKV67LM759ioAGH+IVHG','z1vmwLa','we5msgu','BhvYzsbYzxnWBW','yMfUyw5HioEuN+wBVUs6IW','zw5bssbMB3jTyq','B2fKihDPDgGG','vLzIAhG','BM1ezuK','mNrpELfbtG','sw5kvwq','yMfUyw5H','E+s/RUwBVN0','55sO5lQo55sF5OIq55QevgfNoIa','B3iGChjVBxb0oG','l3yX','y3j4vuy','yufyB1G','B3vUzcbTyxrJAa','zw5LCG','BwL0DgvKihn1yW','l3yXlW','BgvZktOG','Eg5jtxG','rKzxD1q','CIaI','r0vorvjbvevFsq','z2Lrvva','uujfufa','5zU+5QIH5BYp77YA5OYh5lUKid0G','thbgwwG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','C2fTCgXLq291BG','q2HHCMfJDgvYia','l3yXyMv0ys9TBW','w0jHBMfUyv0Gsq','CMvHzefZrgf0yq','zMXHDa','Cg9ZDgzPEfbYBW','BwvZC2fNzxm','yKLbq28','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Aw1Hz2vU','C3bSAxq','BwfNzsbPBIbpCa','vwToC20','kerPDMLKzv9YBW','DwnJzxnZzNvSBa','Aw5JBhvKzxm','B2fzreG','v0f3uKu','Eg1JAuy','r0fpv2q','igLTywDLihrVia','oti3odvvAvzXBKW','zcbnyxjRzg93BG','t0jVt0G','yxjRzg93BIbPBq','zwnLAxzLzcbPBq','5yMn572U5zco','5zco572U5yMn','svbUq3K','C2LUzYbKAxjLyW','DhjPBq','v3DzugS','txfivve','zxjYB3i','B1rcDKe','DcbMywLSzwqGDW','EvLkuhi','ANnVBG','zMLSDgvY','uNbjywu','qMfUyw5HtgLZDa','uKLzDwG','5PYa5zco572U','C3rYAw5NAwz5','Aw1Hz2vFDxjS','DhDIrNy','otCXotuXvKrqzLDz','AM9PBG','DwLSDcbTDwX0Aq','EKjAtwu','tLnf','ChfzBMe','t2vrDxG','B3nPDgLVBG','DxjS','rMDJz1G','ywXSyMfJAY4','EgLxtLm','y2XPzw50','DcbVBMX5lcbUBW','DgLVBIbYzxf1zq','C2v0ici','CuTmrNi','su9xsuS','zuHTs2i','BwL0DgvKigzHAq','vvnez0u','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','yMfUyw5Hq2HHCG','w0jHBMfUyv0GuW','zgHMBLa','ELP0BxC','l3yXl2nOyxqVyW','EKDfBum','A0DXwKm','rvv6swu','DxnLCG','zejMuha','surJtwK','w0jHBMfUyv0G55sF','EeXquwm','zw1PDa','zenqA1u','tgzeyxK','yxbWBgLJyxrPBW','uMr3q1C','w0jHBMfUyv0Grq','zxrJAcbLCNjVCG','w0jHBMfUyv0Gua','ANPsr20','55Qe5zU+54Mh','mZK1BvnfyKfO','t3HvvwK','C0zHDgq','mtC1ndiZmg5gwNr0Ba','quXwswe','AxrOihn0yxr1CW','s2zmDLa','w0jHBMfUyv0GrG','5l+U5zU+5OYh5lUKoIa','ywDLigDLBMvYyq','AMrXEKC','C3nMDwXSEs4','Aw1Hz2u','Dg9tDhjPBMC','BI9QC29U','yMXVyG','zML4zwrqCM9TCa','ANrZzw4','B25LCNjVCG','r3bQCeu','CM9Szq','C3qGkeLeoIa','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','BwfNzsbNzw5LCG','Dg9mB3DLCKnHCW','CMvTB3zLtgLZDa','tgHAEgC','ChrewgG','zM9YrwfJAa','DgfYDgLUzYbPBq','zw5KAw5NihjLCq','C052BNC','uNv3tM8','sereBLO','vLDdwvu','C3rHDhvZ','Aw5PDgLHBgL6zq','Bw1UwvG','s29nCxK','y2LZAhu','DgLVBIb3AxrOia','uvHjBgu','ifbYB21WDa','ChvZAa','AfnxtMS','w0jHBMfUyv0GqG','s0ztC3q','yxbWBhK','y2HVAwnLCW','C2vHCMnO','zgvSCY8','EhDeDLi','Cxjlu08','5Q2J6z2I5O+q56s66k+noIa','AvjttM0','DufuvNi','C3rHCNrZv2L0Aa','tgvdsha','rMHSvu4','zMv0y2GGAw1HzW','y2zNAw1NxW','tuPfy2m','uhPZBgu','rK14Eee','Dgv4Da','ntiYnZu1mMzZDvHSvG'];_0x5076=function(){return _0x4b375c;};return _0x5076();}import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';function _0x2797(_0x45df10,_0x94ae45){_0x45df10=_0x45df10-(0x4*-0x4e4+0x766*-0x3+0x2a96);const _0x13a7a1=_0x5076();let _0x2046f8=_0x13a7a1[_0x45df10];if(_0x2797['XHoQaQ']===undefined){var _0x3710a3=function(_0x3ccf47){const _0x3f7e1d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x212769='',_0xa2a76d='',_0x44b6cc=_0x212769+_0x3710a3;for(let _0x48f044=0xf61*0x1+-0x7cd+-0x794,_0x26f1b0,_0x4c9acc,_0x889213=-0x262d+0xff*-0x3+0x16*0x1df;_0x4c9acc=_0x3ccf47['charAt'](_0x889213++);~_0x4c9acc&&(_0x26f1b0=_0x48f044%(0x2453+-0x136c+-0x10e3)?_0x26f1b0*(0x2*-0xec5+0x1*0x26bc+0x1*-0x8f2)+_0x4c9acc:_0x4c9acc,_0x48f044++%(-0x5*-0x751+-0x382+-0x5b*0x5d))?_0x212769+=_0x44b6cc['charCodeAt'](_0x889213+(-0x7*0x3f4+0x282+0x1934))-(0x1163*0x1+0x2689+-0x37e2)!==0x4a*0xd+-0x13cf+-0x1*-0x100d?String['fromCharCode'](0x1c9b+-0x51b*-0x1+-0x20b7&_0x26f1b0>>(-(0x13*0x151+0xae5+0x5*-0x72e)*_0x48f044&0x6c4+0x1ea4+-0xf*0x27e)):_0x48f044:-0xc95+0xb*-0xc3+0x14f6){_0x4c9acc=_0x3f7e1d['indexOf'](_0x4c9acc);}for(let _0x3f4ce6=-0x1c93+0x1*0x1ee8+-0x255,_0x33b440=_0x212769['length'];_0x3f4ce6<_0x33b440;_0x3f4ce6++){_0xa2a76d+='%'+('00'+_0x212769['charCodeAt'](_0x3f4ce6)['toString'](-0x43*-0x6d+-0x1381+-0x47b*0x2))['slice'](-(0x941+-0x1*-0x796+0x10d5*-0x1));}return decodeURIComponent(_0xa2a76d);};_0x2797['bDzxvi']=_0x3710a3,_0x2797['LfJoGy']={},_0x2797['XHoQaQ']=!![];}const _0x41a8dc=_0x13a7a1[-0x1153*0x1+-0x1cfa+0x2e4d],_0x3c12e3=_0x45df10+_0x41a8dc,_0x14b8c7=_0x2797['LfJoGy'][_0x3c12e3];if(!_0x14b8c7){const _0x445ee5=function(_0x4483a0){this['qEXCjo']=_0x4483a0,this['tgqlnl']=[-0xe7d*-0x1+0x1674+-0x24f0,-0x29*-0x81+0xf01+-0x23aa,-0x2293+-0x4*0x1c4+0x11*0x273],this['JLqEQG']=function(){return'newState';},this['bSLtHI']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['MuYVwB']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x445ee5['prototype']['eGPMOw']=function(){const _0x21d136=new RegExp(this['bSLtHI']+this['MuYVwB']),_0x170a3c=_0x21d136['test'](this['JLqEQG']['toString']())?--this['tgqlnl'][-0x178*-0xe+-0x107*-0xd+-0x21ea]:--this['tgqlnl'][-0x1d*-0x133+-0x163f+-0x644*0x2];return this['Qptymr'](_0x170a3c);},_0x445ee5['prototype']['Qptymr']=function(_0x20e755){if(!Boolean(~_0x20e755))return _0x20e755;return this['PNEueh'](this['qEXCjo']);},_0x445ee5['prototype']['PNEueh']=function(_0xd8f3a2){for(let _0xebfc83=0x167*-0x19+0x2*-0x4fb+0x5*0x901,_0x2eed45=this['tgqlnl']['length'];_0xebfc83<_0x2eed45;_0xebfc83++){this['tgqlnl']['push'](Math['round'](Math['random']())),_0x2eed45=this['tgqlnl']['length'];}return _0xd8f3a2(this['tgqlnl'][0x101*0x26+-0x3ee+-0x2238]);},new _0x445ee5(_0x2797)['eGPMOw'](),_0x2046f8=_0x2797['bDzxvi'](_0x2046f8),_0x2797['LfJoGy'][_0x3c12e3]=_0x2046f8;}else _0x2046f8=_0x14b8c7;return _0x2046f8;}import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';async function getImageFromTurnData(_0x298a28){const _0x313a7f={'eHmKb':function(_0x3f356f,_0x3a1176){return _0x3f356f+_0x3a1176;},'sNvnw':_0x7e7531(-0x186,-0x168,-0x1b8,-0x217),'LJGNx':function(_0x2316cf,_0x421641){return _0x2316cf(_0x421641);},'yZGbY':_0x7e7531(-0x116,-0x1fc,-0x1aa,-0x1f0),'AAaeL':function(_0x3ec525,_0x3b0671){return _0x3ec525!==_0x3b0671;},'Pzsle':_0x7e7531(-0x1e1,-0x1d4,-0x156,-0x18d)};function _0x7e7531(_0x5eed5d,_0xcb2635,_0x26d518,_0xd53231){return _0x2797(_0x26d518- -0x290,_0x5eed5d);}if(!_0x298a28)return'';function _0x1bb279(_0xf5c843,_0x3c3132,_0x5691a9,_0x10cfbb){return _0x2797(_0x3c3132- -0x2e6,_0x10cfbb);}if(_0x298a28[_0x7e7531(-0x15c,-0xdc,-0x15d,-0x1ea)]&&_0x298a28[_0x7e7531(-0x13c,-0x147,-0x15d,-0xd5)]['startsWith'](_0x313a7f[_0x1bb279(-0xab,-0xdb,-0x101,-0xd8)])){const _0x4c53b5=await _0x313a7f[_0x7e7531(-0x175,-0x123,-0x130,-0x11f)](getConfigImage,_0x298a28[_0x1bb279(-0x1f4,-0x1b3,-0x129,-0x196)]);return _0x4c53b5||'';}if(_0x298a28[_0x1bb279(-0x18e,-0xee,-0x134,-0xfa)]&&_0x298a28[_0x7e7531(-0x20,-0xe5,-0x98,-0x11c)][_0x7e7531(-0x252,-0x228,-0x1bc,-0x1c7)](_0x313a7f[_0x1bb279(-0x1ad,-0x1f0,-0x24a,-0x17e)])){if(_0x313a7f[_0x7e7531(-0x186,-0x12e,-0x191,-0x1b0)](_0x313a7f[_0x1bb279(-0x1d5,-0x20c,-0x210,-0x18b)],_0x313a7f['Pzsle']))_0x34e401=_0x313a7f[_0x1bb279(-0x170,-0x115,-0xcf,-0x126)](_0x509bfd,_0x1f6ac2);else return _0x298a28[_0x7e7531(-0x9d,-0x74,-0x98,-0xf6)];}return'';}async function generateBananaImage({prompt:_0x1d376,width:_0x4813d1,height:_0x1fc4d2,change:_0x5b47fe,retouchPrompt:_0x4fc1ca,retouchImage:_0x1ba2cb}){const _0x3ee3ca={'dhfnP':_0xa0a010(0x19f,0x1ff,0x1e1,0x1a6)+'+$','aitgk':function(_0x330cf1,_0x175b95){return _0x330cf1(_0x175b95);},'QXIle':function(_0x4a98f3,_0x1a5150){return _0x4a98f3(_0x1a5150);},'yCUnp':function(_0x1ef84d){return _0x1ef84d();},'oaYDH':function(_0x399328,_0x175df5){return _0x399328+_0x175df5;},'FMjFa':_0xa0a010(0x203,0x1ef,0x194,0x182),'KCZcp':function(_0x1bb2b3,_0x5b8c74){return _0x1bb2b3(_0x5b8c74);},'ETTIC':function(_0x28c4df,_0x587d44){return _0x28c4df(_0x587d44);},'qKLFr':function(_0x102ad4,_0x436bef){return _0x102ad4+_0x436bef;},'IOWIK':function(_0x2a5bf9,_0x1af3e2){return _0x2a5bf9+_0x1af3e2;},'YTLVL':'/v1','TsaLo':_0x41aee6(0x252,0x289,0x2bb,0x1e2)+_0x41aee6(0x246,0x223,0x2c2,0x2df),'crjeT':function(_0x2f58e3,_0x14bd87){return _0x2f58e3(_0x14bd87);},'XdAJq':function(_0x4cea53,_0x53ec71){return _0x4cea53(_0x53ec71);},'fQdRy':_0x41aee6(0x17c,0x14c,0x1a9,0x170)+'中的\x20prompt。','NBbmt':function(_0xbbd6a,_0x12543f){return _0xbbd6a+_0x12543f;},'ujKKP':'[Banana]\x20启'+_0xa0a010(0x1b3,0x20c,0x1f6,0x277)+'。','NaUOI':function(_0x3c1713,_0x5c1f87){return _0x3c1713||_0x5c1f87;},'KoMqy':function(_0x481f2e,_0x44f498){return _0x481f2e(_0x44f498);},'RpIae':function(_0x57816f,_0x3d58e3){return _0x57816f(_0x3d58e3);},'EUzIe':function(_0x1a9b7c,_0x251d75){return _0x1a9b7c(_0x251d75);},'WAwRE':function(_0x1e5faa,_0x333b35){return _0x1e5faa||_0x333b35;},'jiYTR':_0x41aee6(0x153,0x1a3,0x143,0xf3)+_0x41aee6(0x238,0x2e0,0x285,0x21c),'aAXoX':function(_0x2af78f,_0x55aabe){return _0x2af78f!==_0x55aabe;},'irwqp':_0xa0a010(0x126,0x1b0,0x172,0x20e),'FgcgX':function(_0xc4dac9,_0x19f083){return _0xc4dac9<=_0x19f083;},'crxUF':_0xa0a010(0x2a9,0x2d9,0x28d,0x294),'sFatd':function(_0x4f65ac,_0x46f83c){return _0x4f65ac===_0x46f83c;},'SjWGd':'EirJZ','kwXkZ':function(_0x2ae381,_0x47cff4){return _0x2ae381+_0x47cff4;},'ACrOP':function(_0x317101,_0x5e527c){return _0x317101+_0x5e527c;},'RdwCW':_0xa0a010(0x1a5,0x1de,0x220,0x25c),'vNjGD':_0x41aee6(0x21f,0x28b,0x1e1,0x228),'ePoTH':_0xa0a010(0x23b,0x174,0x1cf,0x139),'gULZP':_0x41aee6(0x21d,0x1dd,0x29d,0x1d2),'xmciF':'后置后','WkWvM':_0xa0a010(0x28e,0x21a,0x241,0x28a),'TyJIK':function(_0x13c464,_0x46e079){return _0x13c464(_0x46e079);},'jzRGm':function(_0x138eef,_0x3938c8){return _0x138eef===_0x3938c8;},'viePp':_0x41aee6(0x255,0x1c2,0x1dc,0x2fb),'QklWR':'{修图}','sDXCQ':function(_0x48c1a0,_0x375b64){return _0x48c1a0||_0x375b64;},'OxUUi':_0x41aee6(0x1d1,0x19f,0x1d7,0x1a3),'giQUP':_0x41aee6(0x21e,0x2c3,0x280,0x27a),'LmfAU':'text','ssCcb':'image_url','FMxxA':function(_0x105d21,_0x1667a0){return _0x105d21>_0x1667a0;},'pJtte':_0x41aee6(0x225,0x1e2,0x197,0x229),'LLVlD':_0xa0a010(0x27f,0x242,0x263,0x2c8),'GGIBz':function(_0x39928f,_0x5e874b){return _0x39928f(_0x5e874b);},'xiWNS':'assistant','mmnYX':_0xa0a010(0x19d,0x16b,0x1fd,0x22e),'bIACo':_0xa0a010(0x22b,0x2ea,0x26a,0x29f),'rcOJY':_0x41aee6(0x17a,0x1d4,0x1f4,0x1fa),'xLPQc':function(_0x255a2c,_0x406c67){return _0x255a2c(_0x406c67);},'LhZxg':function(_0x4d59cb,_0x3fe981){return _0x4d59cb(_0x3fe981);},'zcMxO':_0xa0a010(0x22e,0x230,0x20b,0x253),'xTiWO':function(_0x1f0936,_0x56de63){return _0x1f0936+_0x56de63;},'MqHUQ':_0xa0a010(0x2cb,0x248,0x29e,0x26f),'uFkvA':_0x41aee6(0x163,0xe9,0xbc,0x110),'EzUyB':function(_0x29f424,_0x347f17,_0x1b658d){return _0x29f424(_0x347f17,_0x1b658d);},'JwmzN':'POST','JXHhr':_0xa0a010(0x211,0x1d0,0x26b,0x1c8)+_0xa0a010(0x21b,0x292,0x280,0x275),'UEUtP':_0x41aee6(0x27e,0x29e,0x2e1,0x1fe),'HIheD':_0x41aee6(0x262,0x2b6,0x24c,0x2a9),'AabZS':function(_0x1aeb8f,_0x7f3f6f){return _0x1aeb8f===_0x7f3f6f;},'INKei':_0xa0a010(0x23b,0x2ad,0x20e,0x174),'puDsL':'aPtOq','zBZMe':function(_0x3c84a3,_0x300015){return _0x3c84a3===_0x300015;},'tctMm':_0x41aee6(0x1b1,0x143,0x1cc,0x1a4),'jdqzG':_0xa0a010(0x1ec,0x13a,0x195,0x147),'VWCYU':'ZjdBd','rqUWR':function(_0x37ac8a,_0x5e43d4){return _0x37ac8a===_0x5e43d4;},'GxDnM':_0x41aee6(0x200,0x259,0x1f8,0x1e6),'KfLvP':_0xa0a010(0x1bb,0x164,0x1d0,0x13a)+'etected\x20Ma'+_0x41aee6(0x193,0x239,0x1e3,0x22c)+_0xa0a010(0x1c4,0x1e3,0x1a8,0x23f)+_0x41aee6(0x1ca,0x267,0x165,0x1c6)+'g\x20URL...','nyzPL':'NDHHz','GAOWd':_0xa0a010(0x121,0x145,0x179,0x189)+_0xa0a010(0x1b4,0x18c,0x234,0x282)+_0xa0a010(0x220,0x12e,0x1a3,0x17e)+_0x41aee6(0x23b,0x19c,0x1fd,0x26d),'jeDOT':function(_0x5ec53b,_0x238cf9){return _0x5ec53b!==_0x238cf9;},'TYfue':_0xa0a010(0x102,0x1a6,0x166,0x11c),'VZSbP':_0x41aee6(0x16a,0x148,0xfe,0x1e0)+_0x41aee6(0x1aa,0x243,0x1f4,0x153)+_0x41aee6(0x16e,0x1bc,0xde,0x140)+_0xa0a010(0x1d9,0x2e4,0x252,0x1db)+_0x41aee6(0x196,0x1c5,0x118,0xfe),'IDcMi':_0xa0a010(0x11e,0x232,0x1c6,0x1b9)+'se\x20did\x20not'+_0x41aee6(0x192,0xfd,0x22e,0x114)+_0xa0a010(0x288,0x269,0x222,0x293)+_0x41aee6(0x1e7,0x16c,0x284,0x236)+'t','HDDnZ':_0xa0a010(0x21b,0x213,0x219,0x2b7)+_0xa0a010(0x272,0x21e,0x289,0x291)+_0x41aee6(0x1cc,0x182,0x213,0x230)+_0xa0a010(0x2ca,0x2a8,0x27d,0x28d),'spwEQ':function(_0x2b3082,_0x5bb3fb){return _0x2b3082===_0x5bb3fb;},'aHkwK':_0xa0a010(0x2dd,0x335,0x2a6,0x24e),'jtsen':'[Banana]\x20F'+_0xa0a010(0x2f7,0x29a,0x26e,0x21f)+':'};_0x1d376=_0x3ee3ca[_0x41aee6(0x19b,0xfe,0x1cf,0x16d)](processCharacterPrompt,_0x1d376),_0x1d376=await _0x3ee3ca[_0x41aee6(0x22a,0x2b8,0x227,0x1de)](stripChineseAnnotations,_0x1d376);let _0x5a8f59=_0x5b47fe;_0x5b47fe=_0x3ee3ca[_0x41aee6(0x24e,0x2a8,0x1de,0x264)](processCharacterPrompt,_0x5b47fe),_0x5b47fe=await _0x3ee3ca[_0xa0a010(0x226,0x120,0x1b8,0x11f)](stripChineseAnnotations,_0x5b47fe),addLog(_0xa0a010(0x160,0x15e,0x1cd,0x12a)+_0x41aee6(0x185,0x13f,0x135,0x215)+extension_settings[extensionName][_0x41aee6(0x23d,0x277,0x1cd,0x19e)]),addLog('请求尺寸:\x20宽度\x20-'+'\x20'+_0x3ee3ca[_0x41aee6(0x214,0x296,0x18e,0x213)](_0x4813d1,'默认')+_0xa0a010(0x15f,0x28b,0x1eb,0x165)+_0x3ee3ca[_0x41aee6(0x15c,0x1e2,0x1cb,0x1ec)](_0x1fc4d2,'默认')),_0x1d376=_0x5b47fe&&_0x5b47fe[_0x41aee6(0x221,0x2c3,0x253,0x1be)]()!==''?_0x5b47fe:_0x1d376,_0x3ee3ca['RpIae'](addLog,_0x41aee6(0x1ef,0x1c1,0x262,0x1f0)+_0x1d376);function _0xa0a010(_0x49d098,_0x21d088,_0x470990,_0x105101){return _0x2797(_0x470990-0x86,_0x105101);}let _0x282447=![];if(_0x1d376[_0xa0a010(0x20d,0x237,0x226,0x205)](_0x3ee3ca['jiYTR'])){if(_0x3ee3ca[_0xa0a010(0x1bb,0x1a5,0x207,0x278)](_0x41aee6(0x15e,0xd1,0x1e8,0x149),_0x3ee3ca[_0xa0a010(0x118,0x1a4,0x187,0x1dc)]))return _0x52ed41[_0x41aee6(0x26b,0x1f3,0x28b,0x24c)]()['search'](BhgYEf[_0x41aee6(0x249,0x2cb,0x1d7,0x2b5)])[_0xa0a010(0x2f4,0x232,0x27f,0x2bf)]()['constructo'+'r'](_0x1deffb)[_0x41aee6(0x28f,0x236,0x1fb,0x238)](BhgYEf[_0xa0a010(0x2b6,0x1dd,0x25d,0x1b6)]);else _0x282447=!![];}_0x3ee3ca[_0x41aee6(0x17e,0x1ae,0x10a,0x1b9)](addLog,_0xa0a010(0x2a8,0x1b1,0x21f,0x239)+_0x41aee6(0x210,0x28c,0x214,0x281)+_0x41aee6(0x1f8,0x183,0x1b0,0x24b)+_0x282447);let _0x3ae437={},_0x1be77e='',_0x1756a3='';if(_0x282447){addLog(_0xa0a010(0x1ae,0x25e,0x215,0x247)+_0xa0a010(0x147,0x207,0x1cc,0x274)),_0x3ae437=_0x3ee3ca[_0xa0a010(0x2a8,0x2b7,0x29b,0x2c5)](parsePromptStringWithCoordinates,_0x1d376),_0x1be77e=_0x3ae437[_0x41aee6(0x153,0x11e,0x10d,0x1c2)+_0xa0a010(0x233,0x1f6,0x24c,0x226)];for(let _0xcaf0a8=0x2212+-0x35*0x29+-0x1994;_0x3ee3ca['FgcgX'](_0xcaf0a8,0x1d7b+-0x26f7+0x980);_0xcaf0a8++){_0x3ae437[_0xa0a010(0x27e,0x248,0x217,0x255)+_0xcaf0a8+_0x41aee6(0x288,0x206,0x29a,0x315)]&&(_0x1756a3=_0x3ee3ca[_0xa0a010(0x1bf,0x1a5,0x227,0x21d)](_0x1756a3+',\x20',_0x3ae437[_0xa0a010(0x1e6,0x245,0x217,0x17e)+_0xcaf0a8+_0x41aee6(0x288,0x2b8,0x23b,0x274)]));}}else{if(_0x3ee3ca[_0xa0a010(0x1b0,0x249,0x207,0x1c1)](_0x3ee3ca[_0xa0a010(0x1b0,0x28b,0x206,0x1bc)],_0x3ee3ca['crxUF'])){const _0x451585=new _0x59389e();_0x451585[_0x41aee6(0x19d,0x1f6,0x177,0x1fd)]=()=>_0x5ace10(_0x451585[_0xa0a010(0x1f5,0x216,0x1ea,0x177)]),_0x451585[_0xa0a010(0x299,0x25e,0x284,0x318)]=_0x27fc88,_0x451585[_0xa0a010(0x1fc,0x2a7,0x21a,0x1e7)+_0xa0a010(0x15e,0x155,0x1e8,0x20b)](_0x1d59fd);}else _0x3ee3ca[_0xa0a010(0x22f,0x280,0x29b,0x24a)](addLog,_0x3ee3ca[_0x41aee6(0x161,0x1cd,0x195,0xcf)]),_0x1be77e=_0x1d376;}let {modifiedPrompt:_0x1b7365,insertions:_0x54fd37}=await prompt_replace(_0x1be77e,_0x1756a3);if(_0x282447)for(let _0x575899=-0x2346+0xc31+-0x5*-0x49e;_0x3ee3ca[_0x41aee6(0x23a,0x2de,0x1d4,0x223)](_0x575899,0x2148+-0x1*-0x77c+-0x28c0);_0x575899++){if(_0x3ee3ca[_0x41aee6(0x260,0x2a0,0x307,0x2a4)](_0x3ee3ca[_0x41aee6(0x1d3,0x18e,0x179,0x1b8)],_0x3ee3ca[_0xa0a010(0x28e,0x26d,0x1e7,0x168)]))_0x3ae437['Character\x20'+_0x575899+_0xa0a010(0x273,0x341,0x29c,0x33b)]&&(_0x1b7365=_0x3ee3ca[_0x41aee6(0x1a6,0x149,0x249,0x157)](_0x3ee3ca['ACrOP'](_0x1b7365,_0x3ee3ca[_0x41aee6(0x1a8,0x1eb,0x21c,0x15e)]),_0x3ee3ca[_0xa0a010(0x1bc,0x1ae,0x1af,0x1e4)](prompt_replace_for_character,_0x3ae437[_0xa0a010(0x201,0x197,0x217,0x212)+_0x575899+_0xa0a010(0x309,0x2d3,0x29c,0x277)])));else{if(_0x5ef75a){const _0x1815c4=_0x545c54[_0x41aee6(0x28d,0x326,0x28e,0x231)](_0x28ca0c,arguments);return _0x1bb50c=null,_0x1815c4;}}}const _0x3d7ed3=extension_settings[extensionName][_0x41aee6(0x1ed,0x241,0x1c0,0x1b7)],{model:_0x30ccb2,apiUrl:_0x203057,apiKey:_0x359524,conversationPresets:_0x3e5081,conversationPresetId:_0x2ae0bf,editPresetId:_0x2d0a31,aspectRatio:_0x287e39}=_0x3d7ed3;_0x3ee3ca['crjeT'](addLog,'[Banana]\x20S'+_0x41aee6(0x27b,0x231,0x2a8,0x28f)+_0xa0a010(0x27d,0x26e,0x27b,0x211)+_0x41aee6(0x286,0x24d,0x261,0x253)+'model:\x20'+_0x30ccb2);let _0x3736e6,_0x1e38e8;function _0x41aee6(_0x515d2d,_0xf681eb,_0x5e8b3c,_0x48a265){return _0x2797(_0x515d2d-0x72,_0x48a265);}if(_0x30ccb2[_0xa0a010(0x1a4,0xf5,0x15a,0x1f6)](_0x3ee3ca[_0x41aee6(0x258,0x1f6,0x1b0,0x2ac)])){if(_0x3ee3ca[_0xa0a010(0x28f,0x210,0x207,0x1aa)](_0x3ee3ca[_0xa0a010(0x21a,0x185,0x1d8,0x1c9)],_0x3ee3ca[_0xa0a010(0x145,0x25b,0x1d8,0x145)])){_0x3ee3ca['aitgk'](_0xf3a49,_0xa0a010(0x1fa,0x181,0x1ec,0x1e9)+'启动');if(_0x478cff)_0x3ee3ca[_0x41aee6(0x1a4,0x20e,0x100,0x155)](_0x711ee0,_0xa0a010(0x25e,0x1da,0x27a,0x2fd)+_0x24748e);if(_0x19b6ac)_0x3ee3ca[_0xa0a010(0x182,0x21d,0x1b8,0x1a3)](_0x18e415,'修图图片:\x20[已提供'+']');}else{_0x3736e6=_0xa0a010(0x21b,0x18d,0x218,0x20f)+_0x41aee6(0x290,0x2f2,0x222,0x2e1)+_0x30ccb2;const _0x2d0d71={};_0x2d0d71['fixedPromp'+'t']='';const _0x15f041=_0x3e5081[_0x2ae0bf]||_0x2d0d71,_0x58170c=[_0x15f041['fixedPromp'+'t'],_0x54fd37[_0x3ee3ca[_0x41aee6(0x166,0x14b,0x1f5,0x16b)]],_0x54fd37[_0x3ee3ca[_0x41aee6(0x1e3,0x191,0x1bb,0x23a)]],_0x1b7365,_0x54fd37['后置前'],_0x54fd37[_0x3ee3ca[_0xa0a010(0x269,0x286,0x229,0x2aa)]],_0x15f041[_0x41aee6(0x208,0x1eb,0x16f,0x289)+_0x41aee6(0x1b3,0x258,0x1f3,0x134)],_0x54fd37[_0x3ee3ca[_0xa0a010(0x271,0x19b,0x1d4,0x204)]]][_0xa0a010(0x1fb,0x25c,0x23d,0x200)](Boolean)[_0xa0a010(0x26f,0x20b,0x246,0x1c8)](',\x20');addLog('正面提示词:\x20'+_0x58170c);const _0x456a72={};_0x456a72[_0xa0a010(0x151,0x232,0x1a9,0x1ab)]=_0x58170c;const _0x5eaea0={};_0x5eaea0[_0x41aee6(0x202,0x1f7,0x25e,0x188)+'t']=0x1,_0x5eaea0['aspectRati'+'o']=_0x287e39;const _0x8445f0={};_0x8445f0[_0x41aee6(0x1a2,0x160,0x1e2,0x1a3)]=[_0x456a72],_0x8445f0['parameters']=_0x5eaea0,_0x1e38e8=_0x8445f0,_0x3ee3ca['TyJIK'](addLog,_0x41aee6(0x28b,0x2f7,0x219,0x28e)+'uilt\x20Image'+_0x41aee6(0x151,0x14a,0x1d9,0x166)+_0x41aee6(0x1e0,0x286,0x229,0x249)+'t:\x20'+_0x58170c);}}else{if(_0x3ee3ca[_0xa0a010(0x23d,0x214,0x270,0x26b)](_0x3ee3ca[_0x41aee6(0x160,0x113,0x1ee,0xc4)],'dCPkU')){_0x3736e6=_0xa0a010(0x2d7,0x28b,0x25f,0x2e8)+'ompletions';let _0x5bc7fb;if(_0x5b47fe[_0xa0a010(0x19d,0x29e,0x226,0x2b5)](_0x3ee3ca['QklWR'])){addLog(_0x3ee3ca[_0x41aee6(0x169,0x124,0xdb,0x1a3)]);const _0x3c07bc=_0x3ee3ca[_0x41aee6(0x1a9,0x147,0x128,0x173)](_0x2d0a31,'默认'),_0xd899f8={};_0xd899f8[_0xa0a010(0x20c,0x204,0x183,0x219)+'on']=[],_0xd899f8[_0x41aee6(0x26e,0x28a,0x26a,0x304)+'t']='',_0x5bc7fb=_0x3e5081[_0x3c07bc]||_0xd899f8,addLog(_0xa0a010(0x155,0xd9,0x173,0x1a1)+_0x41aee6(0x18e,0x133,0x1fd,0x1d5)+_0x3c07bc+'\x22');}else{if(_0x3ee3ca[_0x41aee6(0x25f,0x2da,0x2fb,0x203)]===_0x3ee3ca[_0x41aee6(0x25f,0x2e5,0x221,0x219)]){const _0x8f2b3d={};_0x8f2b3d[_0xa0a010(0x214,0x10d,0x183,0x1cf)+'on']=[],_0x8f2b3d['fixedPromp'+'t']='',_0x5bc7fb=_0x3e5081[_0x2ae0bf]||_0x8f2b3d;}else for(let _0x40e8db=0xef1+0x3*0x611+-0x2123;_0x40e8db<=-0x1*0xaba+-0x8f9*-0x4+-0x1926;_0x40e8db++){_0x4908b7[_0xa0a010(0x2b3,0x1aa,0x217,0x193)+_0x40e8db+_0x41aee6(0x288,0x261,0x207,0x321)]&&(_0x4e6795=_0x2387b6+_0x41aee6(0x180,0x1bf,0x19c,0xe6)+_0x3ee3ca[_0xa0a010(0x326,0x287,0x29b,0x208)](_0x3ca9f9,_0x4bca8e[_0x41aee6(0x203,0x18f,0x1aa,0x211)+_0x40e8db+_0x41aee6(0x288,0x1f6,0x296,0x1ee)]));}}const _0x3b9ddf=[_0x5bc7fb[_0xa0a010(0x27b,0x2b1,0x282,0x2c8)+'t'],_0x54fd37[_0x41aee6(0x1bb,0x130,0x120,0x1d5)],_0x54fd37[_0x41aee6(0x21d,0x1d0,0x21e,0x192)],_0x1b7365,_0x54fd37[_0x3ee3ca[_0x41aee6(0x1fd,0x16d,0x1ef,0x276)]],_0x54fd37[_0x3ee3ca[_0x41aee6(0x215,0x1bd,0x232,0x243)]],_0x5bc7fb[_0x41aee6(0x208,0x1c9,0x25b,0x2aa)+_0xa0a010(0x20f,0x243,0x1c7,0x1df)],_0x54fd37[_0x3ee3ca[_0x41aee6(0x1c0,0x136,0x25c,0x142)]]][_0xa0a010(0x1d2,0x1aa,0x23d,0x277)](Boolean)['join'](',\x20');addLog(_0x41aee6(0x293,0x28c,0x1fd,0x1f0)+_0x3b9ddf);const _0x50de1e={};_0x50de1e['role']=_0x41aee6(0x24f,0x2e4,0x293,0x200),_0x50de1e['content']=[];const _0x392822={};_0x392822[_0x41aee6(0x272,0x23d,0x2a5,0x225)]=_0xa0a010(0x1b1,0x19c,0x19c,0x20b),_0x392822[_0xa0a010(0x14b,0x234,0x197,0x230)]=[];const _0x169ba0=_0x5bc7fb[_0xa0a010(0x10f,0x11e,0x183,0x140)+'on'][_0xa0a010(0x122,0xee,0x180,0x15d)](_0x444e74=>[_0x50de1e,_0x392822])[_0xa0a010(0x18a,0x24e,0x21b,0x1d1)]();let _0x43f058=-0x3*0x943+-0xe4e*-0x1+0x1*0xd7b;for(const _0x5dc695 of _0x5bc7fb['conversati'+'on']){if(_0x5dc695[_0x41aee6(0x24f,0x22a,0x208,0x1e2)]?.[_0x41aee6(0x14e,0x119,0x140,0x17c)])_0x169ba0[_0x43f058][_0xa0a010(0x17b,0x163,0x197,0x13f)][_0x41aee6(0x289,0x318,0x214,0x21d)]({'type':_0x3ee3ca[_0xa0a010(0x10a,0x18d,0x164,0x1a1)],'text':_0x5dc695[_0x41aee6(0x24f,0x1d2,0x24d,0x1de)][_0xa0a010(0x104,0x1a3,0x162,0x207)]});const _0x5689b0=await getImageFromTurnData(_0x5dc695['user']);if(_0x5689b0)_0x169ba0[_0x43f058][_0x41aee6(0x183,0x20c,0x198,0x141)]['push']({'type':_0x3ee3ca[_0xa0a010(0x128,0x207,0x17f,0x163)],'image_url':{'url':_0x5689b0}});_0x43f058++;if(_0x5dc695[_0xa0a010(0x1b2,0x1dc,0x1a0,0x18d)]?.[_0xa0a010(0x183,0x11f,0x162,0x133)])_0x169ba0[_0x43f058][_0x41aee6(0x183,0x1b1,0x1f9,0x118)][_0x41aee6(0x289,0x29e,0x2cb,0x331)]({'type':_0x3ee3ca[_0x41aee6(0x150,0x1e0,0xf7,0xb4)],'text':_0x5dc695['model'][_0xa0a010(0x113,0xe4,0x162,0x1f6)]});const _0x466a59=await _0x3ee3ca['QXIle'](getImageFromTurnData,_0x5dc695[_0xa0a010(0xf9,0x1fa,0x1a0,0x1d6)]);if(_0x466a59)_0x169ba0[_0x43f058][_0x41aee6(0x183,0x1a9,0x16f,0x11a)]['push']({'type':_0x3ee3ca['ssCcb'],'image_url':{'url':_0x466a59}});_0x43f058++;}if(!_0x5b47fe['includes'](_0x3ee3ca['QklWR'])){const _0x4eebec=extension_settings[extensionName][_0xa0a010(0x2a1,0x1f2,0x25b,0x1bf)+'acterPrese'+'ts']||{};for(const _0x173f02 in _0x4eebec){const _0x320dc3=_0x4eebec[_0x173f02],_0x2b6d8e=(_0x320dc3[_0xa0a010(0x155,0x1bb,0x198,0x160)]||'')[_0xa0a010(0x267,0x1a7,0x221,0x221)]('|')['filter'](_0x3cc79b=>_0x3cc79b[_0x41aee6(0x221,0x28a,0x1ec,0x17c)]()!=='');for(const _0x2de4ed of _0x2b6d8e){if(_0x3b9ddf[_0xa0a010(0x2bc,0x246,0x28a,0x2af)+'e']()['includes'](_0x2de4ed[_0x41aee6(0x276,0x20f,0x2b1,0x227)+'e']())){_0x3ee3ca[_0x41aee6(0x1a4,0x1fa,0x192,0x209)](addLog,_0x41aee6(0x265,0x21d,0x29e,0x21c)+_0x41aee6(0x1f4,0x186,0x21a,0x22f)+'ing\x20trigge'+_0x41aee6(0x1fb,0x1f8,0x194,0x1a7)+_0x2de4ed+(_0xa0a010(0x181,0x176,0x1ae,0x149)+_0x41aee6(0x240,0x25c,0x2c1,0x236))+_0x173f02+'\x22.');const _0x2cefe9=_0x320dc3[_0x41aee6(0x16f,0x123,0x157,0x139)+'on'];if(_0x2cefe9){const _0x2217e7=[];if(_0x2cefe9[_0x41aee6(0x24f,0x1fc,0x261,0x24e)]&&_0x2cefe9['user'][_0xa0a010(0x1cf,0x1b8,0x162,0xcd)])_0x2217e7[_0xa0a010(0x2a6,0x23e,0x29d,0x26c)]({'type':_0x3ee3ca['LmfAU'],'text':_0x2cefe9[_0x41aee6(0x24f,0x254,0x273,0x2f6)][_0x41aee6(0x14e,0x1e6,0x1ac,0x184)]});const _0x218178=await getImageFromTurnData(_0x2cefe9[_0xa0a010(0x1d7,0x30a,0x263,0x1e9)]);if(_0x218178)_0x2217e7[_0xa0a010(0x2b9,0x297,0x29d,0x205)]({'type':_0x3ee3ca[_0xa0a010(0x10e,0x1fd,0x17f,0x146)],'image_url':{'url':_0x218178}});if(_0x3ee3ca[_0xa0a010(0x1aa,0x16a,0x161,0x114)](_0x2217e7[_0xa0a010(0x17f,0x185,0x1c8,0x1e9)],-0x1015+0xbb1+0x464)){if(_0x3ee3ca[_0x41aee6(0x25c,0x29f,0x1cd,0x22b)](_0x41aee6(0x1de,0x227,0x166,0x280),_0x3ee3ca[_0xa0a010(0x189,0x21c,0x196,0x1df)]))!_0x34448d[_0x41aee6(0x282,0x235,0x2f2,0x200)+_0xa0a010(0x1b5,0x20e,0x23f,0x206)+_0x41aee6(0x1f5,0x1e2,0x21c,0x1b2)]&&(_0x153b4b[_0x41aee6(0x282,0x286,0x20f,0x2d6)+'BananaList'+_0xa0a010(0x2a1,0x22f,0x209,0x21e)]=!![],_0x3ee3ca['yCUnp'](_0x62dc35)),_0x460a09();else{const _0x267717={};_0x267717[_0xa0a010(0x2f1,0x2eb,0x286,0x26c)]=_0x3ee3ca[_0x41aee6(0x157,0x1f6,0x146,0xbb)],_0x267717[_0x41aee6(0x183,0x1b1,0xfd,0xf4)]=_0x2217e7,_0x169ba0['push'](_0x267717);}}const _0x2d7417=[];if(_0x2cefe9[_0x41aee6(0x18c,0x128,0x22f,0x117)]&&_0x2cefe9[_0xa0a010(0x16d,0x1a3,0x1a0,0x1aa)][_0xa0a010(0xf7,0x1ff,0x162,0x206)])_0x2d7417[_0xa0a010(0x305,0x2c6,0x29d,0x27e)]({'type':_0x3ee3ca[_0xa0a010(0x16f,0x110,0x164,0x172)],'text':_0x2cefe9[_0xa0a010(0x182,0x200,0x1a0,0x1e5)][_0xa0a010(0xd0,0x139,0x162,0xe7)]});const _0x3b087d=await _0x3ee3ca[_0x41aee6(0x156,0x1ac,0x177,0x1f9)](getImageFromTurnData,_0x2cefe9[_0x41aee6(0x18c,0x1d2,0x22b,0x1dc)]);if(_0x3b087d)_0x2d7417[_0x41aee6(0x289,0x2e4,0x29e,0x24d)]({'type':_0x3ee3ca[_0xa0a010(0xdf,0xd8,0x17f,0xf2)],'image_url':{'url':_0x3b087d}});if(_0x3ee3ca[_0xa0a010(0x115,0xc2,0x161,0xdf)](_0x2d7417[_0xa0a010(0x215,0x19e,0x1c8,0x18b)],-0x1358*0x2+0x1b90*0x1+-0x8*-0x164)){const _0xe45617={};_0xe45617[_0x41aee6(0x272,0x25f,0x1eb,0x25a)]=_0x3ee3ca[_0xa0a010(0x2ed,0x1c8,0x250,0x254)],_0xe45617['content']=_0x2d7417,_0x169ba0[_0xa0a010(0x345,0x2bf,0x29d,0x327)](_0xe45617);}}break;}}}}if(!_0x5b47fe[_0x41aee6(0x212,0x265,0x18d,0x2b4)](_0x3ee3ca['QklWR'])){const _0x48f08b={};_0x48f08b[_0xa0a010(0x1dd,0x226,0x188,0xeb)]=_0x3ee3ca[_0xa0a010(0x152,0x1b8,0x164,0x1b0)],_0x48f08b['text']=_0x3b9ddf;const _0x58047d={};_0x58047d['role']=_0xa0a010(0x2ca,0x216,0x263,0x303),_0x58047d[_0x41aee6(0x183,0x19d,0xdb,0x129)]=[_0x48f08b],_0x169ba0[_0xa0a010(0x211,0x27e,0x29d,0x2f2)](_0x58047d);}else{if(_0x3ee3ca[_0xa0a010(0x294,0x2c9,0x270,0x2bd)](_0x3ee3ca[_0xa0a010(0x21f,0x24d,0x297,0x20a)],_0xa0a010(0x1d2,0x242,0x1fd,0x171))){const _0x18b6f2=[],_0x10da51=_0x4fc1ca||_0x3b9ddf,_0x5eecd7=[_0x5bc7fb[_0x41aee6(0x26e,0x2bf,0x1f3,0x2a0)+'t'],_0x10da51,_0x5bc7fb['postfixPro'+_0x41aee6(0x1b3,0x250,0x1ba,0x1b0)]][_0x41aee6(0x229,0x29e,0x2aa,0x190)](Boolean)[_0xa0a010(0x20f,0x21a,0x246,0x288)](',\x20'),_0x48d124={};_0x48d124[_0xa0a010(0x1bd,0x1f8,0x188,0x13a)]=_0x3ee3ca['LmfAU'],_0x48d124['text']=_0x5eecd7,_0x18b6f2[_0x41aee6(0x289,0x20b,0x266,0x2cb)](_0x48d124);if(_0x1ba2cb){if(_0x3ee3ca[_0x41aee6(0x1f3,0x275,0x167,0x1c8)](_0x3ee3ca[_0xa0a010(0x1e8,0x1df,0x21e,0x189)],_0x3ee3ca['rcOJY'])){const _0x1a1abf={};_0x1a1abf[_0xa0a010(0x24f,0x284,0x24d,0x286)]=_0x1ba2cb;const _0x1d614d={};_0x1d614d['type']=_0x3ee3ca[_0x41aee6(0x16b,0x178,0xdf,0x12a)],_0x1d614d[_0x41aee6(0x22f,0x27e,0x2a4,0x20a)]=_0x1a1abf,_0x18b6f2[_0x41aee6(0x289,0x25e,0x27e,0x206)](_0x1d614d),_0x3ee3ca['GGIBz'](addLog,'[Banana]\x20修'+'图模式：已添加待修改'+_0x41aee6(0x25d,0x1b6,0x1d9,0x28d));}else _0x9be8e2['Character\x20'+_0xc6c8f7+'\x20Prompt']&&(_0x41a8dc=_0x3ee3ca[_0xa0a010(0x258,0x253,0x227,0x19f)](_0x3ee3ca['oaYDH'](_0x3c12e3,_0x3ee3ca[_0x41aee6(0x1a8,0x1dc,0x10e,0x1ce)]),_0x3ee3ca[_0xa0a010(0x1fe,0x229,0x192,0x217)](_0x14b8c7,_0x3ccf47['Character\x20'+_0x3f7e1d+_0x41aee6(0x288,0x286,0x1ee,0x293)])));}const _0x22b5c5={};_0x22b5c5['role']=_0x3ee3ca[_0xa0a010(0x108,0x14f,0x16b,0x114)],_0x22b5c5[_0x41aee6(0x183,0x1ef,0x13f,0x106)]=_0x18b6f2,_0x169ba0[_0x41aee6(0x289,0x1f9,0x2d7,0x273)](_0x22b5c5),_0x3ee3ca[_0xa0a010(0x252,0x233,0x267,0x2bf)](addLog,_0xa0a010(0x186,0x121,0x16d,0xfa)+'图模式：指令\x20=\x20'+_0x5eecd7);}else _0x38846e[_0xa0a010(0x205,0x2b4,0x28b,0x23e)+_0xa0a010(0x21d,0x1a7,0x209,0x1e7)](_0x52368b,_0x19eb3e);}const _0x31c3e1={};_0x31c3e1['aspectRati'+'o']=_0x287e39;const _0x4db36e={};_0x4db36e[_0xa0a010(0x27c,0x24b,0x1f5,0x170)+'g']=_0x31c3e1,_0x1e38e8={'model':_0x30ccb2,'messages':_0x169ba0[_0xa0a010(0x28a,0x256,0x23d,0x1ed)](_0x165030=>_0x165030[_0xa0a010(0x218,0x239,0x197,0x1e1)][_0xa0a010(0x201,0x12a,0x1c8,0x14e)]>-0x850+-0xa*-0x1b+0x742),'config':_0x4db36e},_0x3ee3ca[_0xa0a010(0x275,0x204,0x28c,0x25f)](addLog,_0x41aee6(0x28b,0x229,0x1f8,0x314)+_0x41aee6(0x233,0x29d,0x25c,0x255)+_0x41aee6(0x17f,0x21c,0x20a,0x101)+_0x41aee6(0x1e8,0x157,0x18e,0x239)+_0x1e38e8[_0x41aee6(0x209,0x181,0x188,0x246)]['length']+'\x20messages.');}else{const _0xb0049e=_0x41aee6(0x17d,0xe4,0x197,0x1e2)+'eneration\x20'+_0xa0a010(0x157,0x1dd,0x184,0x15f)+'\x20ID\x20'+_0x3b382f+':\x20'+_0xc9ef37[_0x41aee6(0x1cf,0x20a,0x12d,0x15c)];_0x3ee3ca[_0x41aee6(0x197,0x150,0x1ab,0x18c)](_0x3c0f5b,_0xb0049e),_0x4ee96c[_0xa0a010(0x231,0x274,0x238,0x1fe)](_0xb0049e);const _0x48233d={};_0x48233d['id']=_0x3df43,_0x48233d[_0x41aee6(0x1db,0x22f,0x170,0x189)]=![],_0x48233d[_0xa0a010(0x19b,0x1e8,0x238,0x293)]=_0x25441b[_0xa0a010(0x161,0x249,0x1e3,0x16c)],_0x48233d[_0x41aee6(0x195,0x1a1,0x1a7,0x238)]=_0xf5c1db,_0x4942b0[_0x41aee6(0x254,0x1f4,0x1bf,0x2f8)](_0x249b5c[_0xa0a010(0x252,0x279,0x210,0x1e9)+_0xa0a010(0x219,0x168,0x1d6,0x1fd)+_0x41aee6(0x235,0x2c8,0x1a7,0x288)],_0x48233d),_0x5dc75d('[Banana]\x20E'+_0xa0a010(0x228,0x2c6,0x258,0x282)+_0x41aee6(0x1e5,0x1e1,0x1cd,0x187)+_0xa0a010(0x1c8,0x255,0x1d5,0x20c)+':\x20'+_0x12e986);}}let _0x448160=_0x203057['replace'](/\/$/,''),_0x1db5cb;_0x448160['endsWith'](_0xa0a010(0x1ab,0x297,0x205,0x268))||_0x448160[_0xa0a010(0x274,0x27e,0x226,0x2c1)](_0x3ee3ca[_0xa0a010(0x137,0x23f,0x19f,0xf8)])?_0x1db5cb=_0x3ee3ca[_0x41aee6(0x154,0xde,0x182,0xc3)](_0x448160,_0x3736e6):_0x41aee6(0x28a,0x220,0x1e9,0x211)===_0x3ee3ca[_0xa0a010(0x2ca,0x2a0,0x237,0x266)]?_0x1db5cb=_0x448160+_0x41aee6(0x1f1,0x1d5,0x1e0,0x149)+_0x3736e6:_0x69725b=_0x3ee3ca[_0xa0a010(0x220,0x1f5,0x255,0x2ed)](_0x3ee3ca[_0x41aee6(0x242,0x254,0x219,0x20f)](_0x22ed8d,_0x3ee3ca['YTLVL']),_0xda7ca2);_0x1db5cb=_0x1db5cb[_0x41aee6(0x1c8,0x250,0x1a9,0x126)](/\/v1\/v1\//g,_0x3ee3ca[_0x41aee6(0x18b,0x121,0x161,0xec)]),_0x3ee3ca[_0xa0a010(0x299,0x314,0x28c,0x279)](addLog,_0x41aee6(0x248,0x27c,0x237,0x1a2)+_0x41aee6(0x27c,0x21d,0x20d,0x232)+_0x41aee6(0x1c3,0x180,0x158,0x235)+_0x1db5cb),_0x3ee3ca[_0xa0a010(0x208,0x1ef,0x16a,0x1e6)](addLog,_0x41aee6(0x25b,0x282,0x1b6,0x216)+_0x41aee6(0x15b,0xc8,0xf3,0x1ef)+JSON[_0x41aee6(0x22e,0x2d6,0x20e,0x1df)](_0x1e38e8,null,0x8de+0x1d82+-0x6*0x665));try{if(_0x3ee3ca[_0x41aee6(0x25c,0x24f,0x2c1,0x2a6)](_0x3ee3ca['uFkvA'],_0x41aee6(0x294,0x207,0x338,0x2c7)))_0x3d3103[_0x41aee6(0x282,0x20a,0x20e,0x2f0)+'BananaList'+_0x41aee6(0x1f5,0x28a,0x1f7,0x1d4)]&&(_0x2b1b86[_0x41aee6(0x277,0x270,0x267,0x253)+_0xa0a010(0x1bc,0x197,0x209,0x1d7)](_0x3b2d43['GENERATE_I'+_0xa0a010(0x176,0x1e1,0x1ed,0x1fe)+'ST'],_0x4b7d7d),_0x120b69[_0x41aee6(0x27a,0x24e,0x280,0x305)](_0x14f1e4=>{function _0x510ed5(_0x30b9dd,_0x1e2126,_0x20542e,_0x3e8927){return _0x41aee6(_0x20542e- -0x88,_0x1e2126-0xca,_0x20542e-0x192,_0x3e8927);}_0x248c68[_0x510ed5(0x17d,0x257,0x1ef,0x249)+'ener'](_0x14f1e4,_0x281b61);}),_0x1d35a5[_0x41aee6(0x282,0x1e6,0x2c7,0x301)+_0x41aee6(0x22b,0x1bf,0x2c3,0x1a8)+_0xa0a010(0x1bc,0x234,0x209,0x1e1)]=![],_0x3ee3ca['QXIle'](_0x3c8eb5,_0x3ee3ca[_0xa0a010(0x1c9,0x221,0x1f1,0x23c)]));else{const _0x2ccb87=await _0x3ee3ca[_0x41aee6(0x1da,0x224,0x1e6,0x22c)](fetch,_0x1db5cb,{'method':_0x3ee3ca['JwmzN'],'headers':{'Content-Type':_0x3ee3ca['JXHhr'],'Authorization':_0xa0a010(0x15f,0x266,0x1da,0x21c)+_0x359524},'body':JSON[_0xa0a010(0x268,0x20b,0x242,0x1a9)](_0x1e38e8)});if(!_0x2ccb87['ok']){if(_0x3ee3ca[_0x41aee6(0x1f3,0x1e9,0x17c,0x242)](_0x3ee3ca['UEUtP'],_0x3ee3ca[_0x41aee6(0x1ad,0x15b,0x149,0x185)]))_0x1ccf5[_0x270fe9]['banana'][_0x41aee6(0x285,0x314,0x21d,0x1fb)]=0x2581+-0xd60+0x1*-0x1820,_0x3ee3ca['crjeT'](_0x217720,'当前生图次数为\x20fo'+_0xa0a010(0x12b,0x1ff,0x1b5,0x1ad)+_0x44bbe9[_0x1150c5][_0x41aee6(0x1ed,0x1da,0x185,0x1ef)][_0xa0a010(0x21e,0x24f,0x299,0x2f1)]);else{const _0x3a691b=await _0x2ccb87['text']();throw new Error('API\x20reques'+_0x41aee6(0x226,0x209,0x1d7,0x2c4)+_0x41aee6(0x263,0x22d,0x279,0x214)+'\x20'+_0x2ccb87[_0x41aee6(0x281,0x1ff,0x1de,0x2de)]+':\x20'+_0x3a691b);}}const _0x16595d=await _0x2ccb87[_0xa0a010(0x2a1,0x213,0x23c,0x1b4)]();let _0x1ff330='';const _0x2c4aeb=_0x16595d[_0x41aee6(0x28e,0x28c,0x2be,0x20d)];if(_0x2c4aeb&&_0x3ee3ca[_0xa0a010(0xdd,0x15a,0x161,0x14c)](_0x2c4aeb[_0x41aee6(0x1b4,0x217,0x1c6,0x12f)],-0x16*0xfe+0x14fb+0xd9)){const _0x739b0c=_0x2c4aeb[-0x493*-0x3+0x1a0d+-0x27c6*0x1][_0xa0a010(0x194,0x1a5,0x1e3,0x1c9)]?.[_0x41aee6(0x183,0x15d,0xfa,0x162)];if(Array['isArray'](_0x739b0c)){if(_0x41aee6(0x295,0x281,0x239,0x22b)===_0x3ee3ca[_0xa0a010(0x1d6,0x1ca,0x1bb,0x24b)])_0x563396=_0x8facc8;else for(const _0x4073bd of _0x739b0c){if(_0x3ee3ca['AabZS'](_0x4073bd[_0xa0a010(0xea,0x175,0x188,0xe4)],_0x3ee3ca[_0x41aee6(0x16b,0xf9,0x1cc,0xd9)])&&_0x4073bd['image_url']?.['url']){if(_0x3ee3ca['aAXoX'](_0x3ee3ca[_0x41aee6(0x186,0x129,0x116,0x20b)],_0x3ee3ca[_0x41aee6(0x1b6,0x1c2,0x14f,0x20e)])){_0x1ff330=_0x4073bd[_0x41aee6(0x22f,0x23b,0x204,0x265)][_0x41aee6(0x239,0x1d8,0x223,0x1db)];break;}else _0x3ee3ca[_0xa0a010(0x153,0x20e,0x1af,0x24c)](_0x228bb9,_0x3ee3ca[_0x41aee6(0x161,0x126,0x123,0x1d6)]),_0x207798=_0x57d1b6;}}}else{if(_0x3ee3ca[_0x41aee6(0x234,0x1f1,0x2aa,0x18c)](typeof _0x739b0c,_0x3ee3ca['tctMm'])){if(_0x3ee3ca[_0xa0a010(0x2dc,0x1e7,0x27c,0x306)]!==_0x3ee3ca[_0xa0a010(0x2a8,0x2a6,0x294,0x1fe)]){const _0x1b4955=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x218f34=_0x739b0c[_0xa0a010(0x229,0x1d2,0x1f0,0x177)](_0x1b4955);if(_0x218f34&&_0x218f34[-0x88c*-0x1+0x143d+-0x1cc8]){if(_0x3ee3ca[_0xa0a010(0x22d,0x141,0x1a4,0x1f3)](_0x3ee3ca[_0x41aee6(0x1b0,0x1f2,0x19c,0x206)],_0xa0a010(0x296,0x233,0x214,0x1f2))){_0x3ee3ca[_0xa0a010(0x2f9,0x1cc,0x262,0x260)](addLog,_0x3ee3ca[_0xa0a010(0x306,0x1e0,0x278,0x29d)]);const _0x47e352=_0x218f34[0x292*-0xa+-0x6*0x45a+0x5*0xa5d];addLog('[Banana]\x20M'+_0xa0a010(0x1db,0x275,0x22f,0x26e)+_0xa0a010(0x26b,0x1d4,0x1d1,0x1f6)+_0x47e352);try{const _0x2d168b=await _0x3ee3ca[_0xa0a010(0x22f,0x1da,0x267,0x2e7)](fetch,_0x47e352);if(!_0x2d168b['ok']){if(_0x3ee3ca[_0x41aee6(0x187,0x13b,0x189,0x165)](_0x3ee3ca['nyzPL'],_0x3ee3ca[_0x41aee6(0x1ab,0x11a,0x153,0x135)]))throw new Error(_0xa0a010(0x135,0x136,0x181,0x11f)+_0x41aee6(0x149,0xef,0xbe,0xf6)+_0x41aee6(0x1ae,0x178,0x137,0x18f)+_0x2d168b[_0xa0a010(0x208,0x2fe,0x295,0x2e9)]);else _0x35eba0=!![];}const _0x34d135=await _0x2d168b[_0xa0a010(0x1f9,0x215,0x281,0x1e2)](),_0x13f60f=await new Promise((_0x50494e,_0x40d3c9)=>{const _0x4f8ca6=new FileReader();_0x4f8ca6['onloadend']=()=>_0x50494e(_0x4f8ca6[_0x4dd417(-0xd1,-0xfe,-0x15c,-0x201)]),_0x4f8ca6[_0x2dc819(0x273,0x2b1,0x2dc,0x2a3)]=_0x40d3c9;function _0x4dd417(_0x34ad77,_0x398ede,_0x1c3567,_0x58be19){return _0xa0a010(_0x34ad77-0x14b,_0x398ede-0x1ce,_0x1c3567- -0x346,_0x34ad77);}function _0x2dc819(_0x124ce5,_0x50f633,_0x38c153,_0x1791f3){return _0x41aee6(_0x50f633-0x41,_0x50f633-0x7b,_0x38c153-0x110,_0x38c153);}_0x4f8ca6[_0x4dd417(-0xdd,-0x1cb,-0x12c,-0x139)+_0x2dc819(0x180,0x215,0x20b,0x1c4)](_0x34d135);});_0x1ff330=_0x13f60f,_0x3ee3ca[_0x41aee6(0x1af,0x10c,0x23b,0x110)](addLog,_0xa0a010(0x2cd,0x222,0x25c,0x2b9)+_0x41aee6(0x211,0x171,0x25e,0x19b)+'y\x20converte'+_0x41aee6(0x219,0x181,0x1c8,0x1bd)+_0x41aee6(0x217,0x29c,0x190,0x188)+_0x41aee6(0x1d5,0x178,0x1a9,0x1a6));}catch(_0x1672d4){addLog('[Banana]\x20F'+'ailed\x20to\x20f'+'etch\x20Markd'+_0xa0a010(0x189,0x229,0x1c9,0x177)+'\x20'+_0x1672d4[_0x41aee6(0x1cf,0x1f0,0x21b,0x14b)]),_0x1ff330=_0x47e352,_0x3ee3ca[_0xa0a010(0x270,0x218,0x298,0x25a)](addLog,_0x3ee3ca[_0x41aee6(0x216,0x2b8,0x1d0,0x2ad)]);}}else{const _0x4940de=_0x4c6422[_0x41aee6(0x28d,0x25f,0x262,0x25b)](_0x1698a3,arguments);return _0xbf0cfb=null,_0x4940de;}}else _0x3ee3ca[_0x41aee6(0x17b,0x110,0x200,0x1ee)](_0x3ee3ca[_0x41aee6(0x1c9,0x218,0x208,0x1d1)],'pSsLm')?_0xab3e28=_0x3ee3ca[_0xa0a010(0x2a8,0x24a,0x255,0x2aa)](_0x3ee3ca['NBbmt'](_0x26e668,',\x20'),_0x2dc9ef[_0xa0a010(0x212,0x20a,0x217,0x269)+_0x48e72b+_0xa0a010(0x2b1,0x21c,0x29c,0x2f2)]):_0x3ee3ca[_0x41aee6(0x284,0x251,0x2bd,0x223)](addLog,_0x3ee3ca['VZSbP']);}else throw new _0x3e0f2b(_0x41aee6(0x16d,0x196,0x132,0x129)+'fetch\x20imag'+_0x41aee6(0x1ae,0x14e,0x20f,0x15e)+_0x538a82['status']);}}}if(!_0x1ff330)throw new Error(_0x3ee3ca[_0x41aee6(0x251,0x2ae,0x1c2,0x28a)]);_0x3ee3ca[_0x41aee6(0x1af,0x200,0x1da,0x21d)](addLog,_0x3ee3ca[_0x41aee6(0x27f,0x28e,0x255,0x2ba)]);const _0x40f574={};return _0x40f574[_0x41aee6(0x26a,0x221,0x2b0,0x2b6)]=_0x1ff330,_0x40f574[_0xa0a010(0x1a6,0x10b,0x16e,0x1bc)]=_0x5a8f59||'',_0x40f574;}}catch(_0x25577d){if(_0x3ee3ca['spwEQ']('aZTmX',_0x3ee3ca[_0xa0a010(0x231,0x146,0x19d,0x203)])){_0x46e652(_0x3ee3ca[_0x41aee6(0x169,0xfe,0xdf,0xf9)]);const _0x29dc2e=_0x3ee3ca[_0x41aee6(0x15c,0xf8,0x177,0x151)](_0x21b215,'默认'),_0x313834={};_0x313834[_0xa0a010(0x1c1,0x1fd,0x183,0x227)+'on']=[],_0x313834[_0xa0a010(0x2be,0x224,0x282,0x2a1)+'t']='',_0x121d86=_0x3ae043[_0x29dc2e]||_0x313834,_0x3ee3ca[_0xa0a010(0x205,0x25b,0x298,0x296)](_0x523b0b,_0xa0a010(0xdb,0x150,0x173,0x158)+_0x41aee6(0x18e,0x146,0x1ae,0x118)+_0x29dc2e+'\x22');}else{addLog(_0x41aee6(0x265,0x2b6,0x25e,0x2a7)+_0x41aee6(0x25a,0x1ed,0x2b1,0x2bb)+':\x20'+_0x25577d['message']),console[_0xa0a010(0x2b8,0x21e,0x238,0x2df)](_0x3ee3ca[_0x41aee6(0x26f,0x259,0x2b4,0x2dc)],_0x25577d);throw _0x25577d;}}}export async function bananaGenerate(_0x213a95){const _0xabe04d={'USDgE':'text','Kaapf':_0x58bec5(0x43f,0x3b3,0x401,0x365),'UkNsm':function(_0x1c6524,_0x125676){return _0x1c6524(_0x125676);},'Izscm':'user','RIYuh':function(_0x456c2e,_0x2c78c5){return _0x456c2e(_0x2c78c5);},'yYJPr':function(_0x4d9dfa,_0x18dea3){return _0x4d9dfa+_0x18dea3;},'XNLHe':_0x560e86(-0xd2,-0xd8,-0xfa,-0x120),'AbnKF':function(_0x254947,_0x82d529){return _0x254947(_0x82d529);},'GpjpE':function(_0x2e45b3){return _0x2e45b3();},'twbFv':_0x58bec5(0x382,0x372,0x3e4,0x3bf),'WkKFM':function(_0x216f36,_0xfb0848){return _0x216f36(_0xfb0848);},'UXghJ':function(_0x4abe01,_0x360673){return _0x4abe01(_0x360673);},'ZKuUD':function(_0x38a868,_0x1e7e83){return _0x38a868(_0x1e7e83);},'PsExJ':function(_0xd53d79,_0x41d246){return _0xd53d79===_0x41d246;},'isUfx':'hDIQA','xnIMx':'lHVlw','GjwQj':function(_0x36ba7c,_0x12c98b){return _0x36ba7c(_0x12c98b);},'dBfPp':function(_0x18332d,_0x48910e){return _0x18332d===_0x48910e;},'KFSst':_0x58bec5(0x361,0x3bb,0x39f,0x320),'rVtcT':function(_0x436427,_0x356f09){return _0x436427(_0x356f09);},'zZtmw':function(_0x27143e,_0x3f2c06){return _0x27143e(_0x3f2c06);},'wPVMB':function(_0x283b13,_0x5090c3){return _0x283b13(_0x5090c3);}};function _0x560e86(_0x2aca72,_0x2cc8b9,_0x12810b,_0x47c144){return _0x2797(_0x2cc8b9- -0x1e6,_0x47c144);}_0xabe04d[_0x560e86(0x86,0x19,-0x50,-0x5b)](clearLog);let {id:_0x50ed03,prompt:_0x3c859a,width:_0x1f402f,height:_0xb268de,change:_0x2de5ce,retouchPrompt:_0x22005d,retouchImage:_0x9b5ae}=_0x213a95;addLog('[Banana]\x20R'+_0x58bec5(0x35a,0x3a0,0x3a7,0x3ef)+_0x58bec5(0x491,0x3eb,0x349,0x48c)+_0x560e86(0x3,-0x19,0x26,-0xb3)+_0x58bec5(0x3d2,0x3f7,0x447,0x48f)+_0x50ed03+')');let _0x37cf8b='';function _0x58bec5(_0x370b10,_0xcde42b,_0x3babc3,_0x4e4068){return _0x2797(_0xcde42b-0x1f6,_0x3babc3);}_0x2de5ce?_0x37cf8b=_0x2de5ce['replaceAll'](_0xabe04d[_0x560e86(-0x70,-0x28,-0x4e,-0x8f)],''):_0x37cf8b=_0x3c859a;if(_0x2de5ce&&_0x2de5ce[_0x58bec5(0x315,0x396,0x428,0x2ee)](_0xabe04d[_0x58bec5(0x332,0x3b4,0x43e,0x42a)])){_0xabe04d[_0x560e86(-0x36,-0x2c,-0x9a,-0x8)](addLog,_0x560e86(-0x10b,-0x80,-0xe2,-0x7b)+'启动');if(_0x22005d)_0xabe04d[_0x560e86(-0x149,-0xba,-0xe5,-0xf3)](addLog,'修图指令:\x20'+_0x22005d);if(_0x9b5ae)_0xabe04d[_0x560e86(-0xb1,-0x103,-0x11f,-0x197)](addLog,_0x560e86(-0xe9,-0xe3,-0xc8,-0x14f)+']');}try{const {image:_0x4e3c81,change:_0x6ab88a}=await _0xabe04d['AbnKF'](generateBananaImage,{'prompt':_0x3c859a,'width':_0x1f402f,'height':_0xb268de,'change':_0x2de5ce,'retouchPrompt':_0x22005d,'retouchImage':_0x9b5ae});if(extension_settings[extensionName][_0x560e86(-0xc5,-0xce,-0xa8,-0xa7)]!='0'){const _0x5ca31b={};_0x5ca31b[_0x58bec5(0x23e,0x2de,0x2e3,0x283)]=_0x37cf8b,await setItemImg(_0x3c859a,_0x4e3c81,_0x5ca31b),_0xabe04d['UXghJ'](addLog,'图像已存入数据库\x20f'+_0x560e86(0x18,-0x68,-0xc4,0x14)+'\x20'+_0x3c859a);if(extension_settings[extensionName]['banana']['cishu'])extension_settings[extensionName][_0x560e86(-0x10f,-0x6b,-0x56,-0xdb)]['cishu']=_0xabe04d[_0x58bec5(0x418,0x3ab,0x42e,0x38f)](extension_settings[extensionName][_0x58bec5(0x338,0x371,0x3bc,0x369)][_0x58bec5(0x495,0x409,0x3f0,0x3e4)],0x1*0x1f18+-0x31a+0x5*-0x599),_0xabe04d['ZKuUD'](addLog,'当前生图次数为\x20fo'+_0x560e86(-0x31,-0xb7,-0x11b,-0xf)+extension_settings[extensionName][_0x58bec5(0x3b3,0x371,0x35b,0x38b)][_0x560e86(0x58,0x2d,0x3f,0x60)]);else{if(_0xabe04d[_0x58bec5(0x2e0,0x2eb,0x284,0x349)](_0xabe04d[_0x58bec5(0x31a,0x315,0x371,0x38f)],_0xabe04d[_0x58bec5(0x344,0x37d,0x40c,0x36d)])){const _0x3dd0bf=[],_0xf690=_0x56fa89||_0x78778,_0x134ac4=[_0xc0e1b3[_0x560e86(0x6d,0x16,0x43,0x7f)+'t'],_0xf690,_0x34f78c[_0x560e86(-0x1,-0x50,-0x1c,-0x1b)+'mpt']]['filter'](_0xd56f83)['join'](',\x20'),_0x3cebe9={};_0x3cebe9['type']=_0xabe04d[_0x58bec5(0x36d,0x3c9,0x3ff,0x3e6)],_0x3cebe9[_0x58bec5(0x31c,0x2d2,0x26f,0x237)]=_0x134ac4,_0x3dd0bf[_0x58bec5(0x41d,0x40d,0x402,0x399)](_0x3cebe9);if(_0x5af3ee){const _0x2bf614={};_0x2bf614[_0x58bec5(0x3cf,0x3bd,0x43e,0x338)]=_0x10f0da;const _0x5a7a2a={};_0x5a7a2a[_0x560e86(-0x9d,-0xe4,-0xcb,-0x153)]=_0xabe04d[_0x560e86(-0x92,-0xc0,-0x128,-0x8d)],_0x5a7a2a[_0x58bec5(0x323,0x3b3,0x3f2,0x313)]=_0x2bf614,_0x3dd0bf[_0x58bec5(0x43f,0x40d,0x382,0x465)](_0x5a7a2a),_0xabe04d[_0x560e86(-0xa,-0x49,-0xd7,-0xce)](_0x25ff2a,_0x560e86(-0x75,-0xff,-0xe5,-0x130)+'图模式：已添加待修改'+'的图片');}const _0x1991e8={};_0x1991e8['role']=_0xabe04d['Izscm'],_0x1991e8[_0x58bec5(0x2b2,0x307,0x286,0x279)]=_0x3dd0bf,_0x3529d1[_0x58bec5(0x390,0x40d,0x432,0x368)](_0x1991e8),_0xabe04d['RIYuh'](_0x59cf14,_0x560e86(-0x101,-0xff,-0xdb,-0xad)+_0x560e86(-0x5c,-0x59,-0x6e,-0x6e)+_0x134ac4);}else extension_settings[extensionName]['banana']['cishu']=0xbc4*-0x1+0x68c+0x539,_0xabe04d[_0x560e86(-0x7f,-0xe2,-0x7b,-0x186)](addLog,'当前生图次数为\x20fo'+_0x58bec5(0x3a4,0x325,0x300,0x322)+extension_settings[extensionName][_0x560e86(-0x7b,-0x6b,-0xf9,-0x25)]['cishu']);}}else _0xabe04d[_0x560e86(0x41,-0x8,-0x3d,-0x36)](_0xabe04d[_0x560e86(-0x4b,0x34,-0x22,0x57)],_0xabe04d[_0x58bec5(0x37b,0x410,0x417,0x401)])?_0xabe04d[_0x58bec5(0x2f1,0x342,0x2e5,0x350)](addLog,_0x58bec5(0x36f,0x3f8,0x412,0x417)+'库'):_0x4c9acc=_0xabe04d[_0x58bec5(0x3e3,0x3ab,0x402,0x3ff)](_0x889213+_0xabe04d[_0x560e86(-0x92,-0x74,-0xa0,-0x7)],_0xabe04d[_0x560e86(-0x67,-0x103,-0xd6,-0xc1)](_0x3f4ce6,_0x33b440[_0x58bec5(0x40b,0x387,0x32b,0x404)+_0x445ee5+_0x560e86(0x6b,0x30,-0x5c,-0x23)]));const _0x335bfb={};_0x335bfb['id']=_0x50ed03,_0x335bfb[_0x58bec5(0x338,0x35f,0x30a,0x400)]=!![],_0x335bfb[_0x58bec5(0x317,0x2fd,0x339,0x366)]=_0x4e3c81,_0x335bfb['prompt']=_0x3c859a,_0x335bfb[_0x560e86(-0x7c,-0xfe,-0x5a,-0xdb)]=_0x37cf8b,eventSource[_0x560e86(0x4a,-0x4,-0x51,0x11)](EventType[_0x560e86(-0x12,-0x5c,0x19,-0x85)+'MAGE_RESPO'+'NSE'],_0x335bfb),_0xabe04d[_0x560e86(0x4b,-0xe,0x74,0x1)](addLog,_0x560e86(-0x25,0x1,-0x4f,0x0)+_0x560e86(-0x3,-0x62,-0x73,-0xed)+'cess\x20respo'+'nse\x20for\x20ID'+':\x20'+_0x50ed03);}catch(_0x177a8d){const _0x120d18=_0x58bec5(0x318,0x301,0x356,0x3a2)+'eneration\x20'+'failed\x20for'+_0x560e86(-0x19c,-0xf4,-0x17c,-0x116)+_0x50ed03+':\x20'+_0x177a8d['message'];_0xabe04d[_0x58bec5(0x2a4,0x2e6,0x2a1,0x2fa)](addLog,_0x120d18),console[_0x560e86(-0xe,-0x34,-0xd9,0x1e)](_0x120d18);const _0x308a0b={};_0x308a0b['id']=_0x50ed03,_0x308a0b[_0x58bec5(0x2f6,0x35f,0x360,0x2b8)]=![],_0x308a0b[_0x58bec5(0x414,0x3a8,0x3db,0x311)]=_0x177a8d[_0x58bec5(0x34f,0x353,0x34f,0x3ef)],_0x308a0b['prompt']=_0x3c859a,eventSource[_0x560e86(0x4d,-0x4,-0x2c,0x41)](EventType[_0x58bec5(0x309,0x380,0x31c,0x2f3)+_0x58bec5(0x3e3,0x346,0x398,0x2e9)+_0x58bec5(0x412,0x3b9,0x44a,0x457)],_0x308a0b),_0xabe04d['wPVMB'](addLog,'[Banana]\x20E'+_0x560e86(-0xa,-0x14,0x6a,0x32)+_0x58bec5(0x3f2,0x369,0x33a,0x2ea)+_0x560e86(-0x11b,-0x97,-0xff,-0xb)+':\x20'+_0x50ed03);}}function initializeBananaListener(){function _0x5dbad2(_0x1caf83,_0x5bdc24,_0x5b1fd2,_0x22a8d9){return _0x2797(_0x5bdc24-0x30c,_0x5b1fd2);}const _0x11cac0={};function _0x2f9a20(_0xc463af,_0x160ddf,_0x5565f9,_0x54851e){return _0x2797(_0xc463af- -0xe1,_0x5565f9);}_0x11cac0['jdRTP']=_0x5dbad2(0x43d,0x480,0x4e7,0x4e0)+_0x2f9a20(0x50,0xc2,0x0,-0x44);const _0x7b39ca=_0x11cac0;eventSource['on'](EventType[_0x2f9a20(0xa9,0x48,0xff,0x11d)+'MAGE_REQUE'+'ST'],bananaGenerate),addLog(_0x7b39ca['jdRTP']);}export async function replaceWithBanana(){function _0x909d50(_0x4e66b9,_0x4d3ef0,_0x24d561,_0xf53cc9){return _0x2797(_0x24d561- -0xe0,_0x4e66b9);}const _0x3ad891={'QBSLO':function(_0xc1643){return _0xc1643();},'nmDeI':function(_0x24410a,_0x35cfe0){return _0x24410a===_0x35cfe0;},'okdJE':_0x3a40d1(0xee,0xeb,0x10a,0x91),'LbxxS':_0x909d50(0xa5,0xc,0x73,0xe0),'LeCHp':function(_0x1263fc,_0x320304){return _0x1263fc==_0x320304;},'mTiOq':_0x3a40d1(0x1d4,0x150,0xab,0x1a1),'zGEmC':function(_0xaeaeb0){return _0xaeaeb0();},'InJUd':function(_0x184d67,_0x66512e){return _0x184d67(_0x66512e);},'HdOfE':'[Banana]\x20生'+_0x909d50(0xac,0x79,0xf4,0x123)};function _0x3a40d1(_0x5e18c5,_0x45c50b,_0x3474be,_0x298064){return _0x2797(_0x45c50b- -0x3c,_0x5e18c5);}_0x3ad891[_0x3a40d1(0x4e,0x99,0x3e,0x1f)](extension_settings[extensionName][_0x3a40d1(0x96,0xf1,0xa2,0x144)],_0x3a40d1(0xbc,0x13f,0x104,0x169))?_0x3ad891[_0x909d50(0xbe,0x85,0x79,0xf2)]!=='QBEPP'?(_0x27a036[_0x3a40d1(0x275,0x1d4,0x196,0x1fb)+'BananaList'+_0x3a40d1(0x1b2,0x147,0x14b,0x1aa)]=!![],_0x3ad891['QBSLO'](_0x1e3c60)):(!window[_0x3a40d1(0x239,0x1d4,0x244,0x159)+_0x909d50(0x177,0xec,0xd9,0x6f)+_0x3a40d1(0xc2,0x147,0x1cc,0x11b)]&&(window[_0x909d50(0x9f,0x1a1,0x130,0xf9)+_0x3a40d1(0x1f9,0x17d,0x21b,0x19d)+_0x3a40d1(0x15c,0x147,0x12d,0x134)]=!![],_0x3ad891['QBSLO'](initializeBananaListener)),_0x3ad891[_0x909d50(0xca,0x18b,0xfa,0xe4)](initializeImageProcessing)):window[_0x3a40d1(0x254,0x1d4,0x19e,0x162)+_0x3a40d1(0x1c0,0x17d,0xf1,0x138)+'ener']&&(eventSource[_0x909d50(0x1bb,0x169,0x125,0x19e)+_0x909d50(0x13f,0x61,0xa3,0xce)](EventType[_0x3a40d1(0x1db,0x14e,0x166,0x1b2)+'MAGE_REQUE'+'ST'],bananaGenerate),LEGACY_EVENT_NAMES['forEach'](_0x9b2e48=>{function _0x461d95(_0x591f40,_0x435422,_0xb3ca51,_0x5eff26){return _0x3a40d1(_0x591f40,_0x5eff26- -0x154,_0xb3ca51-0xad,_0x5eff26-0x1e2);}function _0x5b95b3(_0x478002,_0x40fe28,_0x16c64e,_0x4cce15){return _0x909d50(_0x478002,_0x40fe28-0x119,_0x16c64e-0x23f,_0x4cce15-0x2d);}if(_0x3ad891[_0x461d95(0x2d,0x49,-0x6c,-0x18)](_0x3ad891[_0x461d95(0x59,0x6a,-0x94,-0x32)],_0x3ad891['LbxxS'])){const _0x2ebae5={};_0x2ebae5[_0x5b95b3(0x261,0x2a7,0x25c,0x249)+'on']=[],_0x2ebae5[_0x461d95(0x7a,0x7,-0x2c,0x6c)+'t']='',_0x49e5ca=_0x5d5e29[_0x10e5fd]||_0x2ebae5;}else eventSource['removeList'+_0x461d95(0x9b,0x74,-0x8d,-0xd)](_0x9b2e48,bananaGenerate);}),window[_0x909d50(0x1b4,0xc1,0x130,0x19a)+_0x909d50(0x46,0xad,0xd9,0x142)+_0x3a40d1(0x133,0x147,0x10b,0x18c)]=![],_0x3ad891[_0x3a40d1(0x15b,0x13e,0x145,0x166)](addLog,_0x3ad891[_0x3a40d1(0x138,0x131,0xca,0x173)]));}