function _0x29e9(){const _0x3035e1=['BwL0DgvKigzHAq','twzhAxi','tLnf','ihWG','ALD3zu0','Bw9KzwW','ChjVBxb0','kerPDMLKzv9YBW','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','ruHjELm','AM9PBG','CeLvvhC','CuPkvfK','C0PsDxa','rLHJqLO','vNLKCgC','5yMn572U5yMn','y2LZAhu','w0jHBMfUyv0G5zcV','v0r5tLy','5zco572U5zco','C2vHCMnO','BuvyzNq','sxD2tei','yxnWzwn0uMf0Aq','teLtwuy','DLDhrKi','C3rHCNrZv2L0Aa','sNfUyuq','zcbnyxjRzg93BG','zgLJr1y','BwvZC2fNzq','Cxf6v00','qxj0q0C','uwnwuM8','tMT1uxq','B1frDeO','BIbWyxLSB2fKia','BwfNzsbNzw5LCG','zxjYB3i','CMTKB3DUigLTyq','AenhqwS','5zco572U5yMn','C3vJy2vZCW','w0jHBMfUyv0G5l2/','r3bSs3q','B25LCNjVCG','CMvWBgfJzufSBa','mJa0nffRy21Vrq','tMjzAKS','txzTANm','EMXutfC','v2jdruS','ANnVBG','Dgv4Da','tw12tfe','BgvUz3rO','l3yXlW','Ae5tyNy','EsbJB252zxj0zq','Au9Iwfy','zMv0y2GGAw1HzW','Dg9tDhjPBMC','ugjyrge','yxLSB2fKoIa','u0TeBeu','ig1LC3nHz2vZlG','igLTywDLlG','Bw9KywWGCgf5Ba','tLbUB2e','zxnWB25ZzsbJBW','v3zerNq','mJq4mJHfvg9OuNO','CNDvrvu','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','D2L0AcbWCM9TCa','DhjPz2DLCNm','DxnLCG','w0jHBMfUyv0Gua','Dg9mB3DLCKnHCW','BhvYzsbYzxnWBW','r1P3AMK','w0jHBMfUyv0GrW','rfrezNa','Aw1Hz2u','5zU+5QIH5BYp77YA5OYh5lUKid0G','DwfjrvC','y29UDMvYC2f0Aq','55sO5lQo55sF5OIq55QevgfNoIa','DgfcBNy','EeXct0i','BwrjzvK','5PYa5zco572U','yvDjuxq','uhndtfK','vM9dALe','DeHQueG','reH1Dei','BI9QC29U','yMfUyw5Hq2HHCG','seLtwKy','ndeYmtm2BvLsrvbI','CMDjB3e','ANbRAvy','B21WBgv0Aw9UCW','zw5LCMf0Aw9Uia','zLn0vhy','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','Aw5NihrYAwDNzq','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','y2XPzw50','C3qGkeLeoIa','tufhrv9srvnqtW','q2HHCMfJDgvYia','yxbWBgLJyxrPBW','rgTQtxe','CMvWBgfJzq','w0jHBMfUyv0Gra','wufrte4','uhLfyxq','zxrLy3rLzcbnyq','E+s/RUwBVN0','DMHTwMS','u2nLBMuGq29TCa','B3nPDgLVBG','5l+U5zU+5OYh5lUKoIa','BLvsuLC','qMvHCMvYia','veT3reK','zxrJAcbLCNjVCG','C3rYAw5NAwz5','r0zNt0y','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','uMjSsNG','DgLVBIbYzxf1zq','C2v0ici','u0vAyuq','odaWnMTKrNLlra','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','nZyWmta4B0DJEKT0','vvjm','ywn0zxjqCMvZzq','zMLSDgvY','zLrNsvi','yKfcv2O','zgvSCY8','tu54t2q','BwL0DgvKihn1yW','EwfuAu8','DcbMywLSzwqGDW','BLHYv20','DK14qMO','BerIEgi','yxnZAxn0yw50','CKDHy3e','DNf2CvO','qvbjihjLC3bVBG','AhnxCwO','u3Lmwhi','mJvwAvrQB1C','B2fKihDPDgGG','yuTmwwG','tenqu2e','DcbVBMX5lcbUBW','55sO5l+U5zU+6Ake6k6+oIaI','ywDLigDLBMvYyq','CMvHzefZrgf0yq','y29bEg4','rgniBKS','lcdPQ5JLUQyGlsa','t3fAzKu','ifbYB21WDa','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','w0jHBMfUyv0GrG','DMTktwO','w0jHBMfUyv0Grq','zw5LCG','nJCXota0meX5B0DhyW','Aw1Hz2vFDxjS','yxjRzg93BIbPBq','qwjcsLy','Bxb0','AMPYzxe','C2fTCgXLq291BG','CwjTB1a','qKfSwMS','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','CgfYyw1LDgvYCW','yMfUyw5HioEuN+wBVUs6IW','w0jHBMfUyv0GuG','B1LYA2y','AvHQy2q','B1Dyr3e','vxjPy1C','B09nrMG','Agrdwuq','yMXKuxO','we5yA0y','y0vgBgu','Aw1Hz2vdB25MAq','C3rHDhvZ','qw5xzMW','tKTvyva','yxftvMm','l3yXl2nOyxqVyW','DhLWzq','vMfrzKC','C3bSAxq','ztOG','r1DhAwK','t2fWwgO','Ag5PBgq','z0TmqKy','vxPWBey','EvDeyuq','zw1PDa','sfH3AvK','Bw1pAwq','w0jHBMfUyv0Gsq','q1fREgq','B3vUzcbTyxrJAa','uvvREg0','EgLLqva','EuHRqMu','C2LUzYbKAxjLyW','55sO5lQgihVKV67LM759ioAGH+IVHG','ywLSzwqGDg8GzG','igLTywDLihrVia','w0jHBMfUyv0Gtq','zfvOENq','qwPSs1e','vMvyuLC','BNrHAw5ZihrLEa','Aw5ZDgfUy2vZ','CKn4AfO','qNvwzfu','y3nIrKG','ywDLifvstdOG','D1fkBMK','BujPBKS','r2rsBu0','AxrOihn0yxr1CW','Ew1LseK','5Q2J6z2I5O+q56s66k+noIa','vLLKufi','r0nwzu0','zxrJAcbnyxjRza','l3yXyMv0ys9TBW','DxjS','mZaZCMz1EwDT','EKTwsxu','DdOG','Aw1Hz2vjza','CxnewKK','D2zHsNa','rejNuhO','mtq3ntq4ndbNB2rlC2i','wK9Osui','w0jHBMfUyv0GqG','rMLjwfa','qwTLywu','qMfUyw5H5l+U5zU+5QIH5BYp','AxnbCNjHEq','y2zNAw1NxW','CMvTB3zLtgLZDa','vM9YB1i','kcGOlISPkYKRkq','DhjPBq','zw5bssbMB3jTyq','DwnJzxnZzNvSBa','A2r1sfO','CvHstKm','q2jPwNy','qwruAgy','CM9Szq','weHirNi','A3j6Aui','ChvZAa','tfrvALO','DLHmshC','yMfUyw5H','zML4zwrqCM9TCa','vezQD3O','Dgzzuvq','yxbWBhK','BNnLigzVCIbjra','BMH6v24','sKT4y3u','igv4DhjHy3rPBG','5lIT55QeihbYB21WDooaGG','zM9YrwfJAa','yMfZzty0lG','CvPxAMS','w0jHBMfUyv0GuW','Bwf0y2G','A050q0C','ug5YBgm','DwHlBwG','sfjkr3m','y29UDgvUDa','vuH4DfC','y2HVAwnLCW','Dxr6weO','uNLgCfy','ugLVv2y','B3DUigLTywDLoG','ywXSyMfJAY4','CIbWCM9TChq6ia','tvbwuwu','AMTvtwC','Aw1Hz2vU','zgz2CLG','5BYa5AEliejHBMfUyEEuNW','DcbvuKWGyxmGzG','Aw5JBhvKzxm','B0P2v08','AfPuDge','iIbMCM9TihbYzq','A1zgA1G','Cg9ZDgzPEfbYBW','reLvzeK','ufP1A20','DwLSDcbTDwX0Aq','z1fRCwO','l3yX','r0vorvjbvevFsq','uhr5veO','B25SB2fKzw5K','z2uGzM9YBwf0la','55Qe5zU+54Mh','zwnLAxzLzcbPBq','zeHTzve','zw5KAw5NihjLCq','Ben2vwS','w0jHBMfUyv0G55sF','wu1mB0C','C1PMzvy','ue5Yzue','odiWmZi0C1zLtun3','zMfPBgvKigzVCG','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','w0jHBMfUyv0Gvq','Bw9KzwW6ia','zYbvuKWUlI4','qMfUyw5HtgLZDa','y2HHBMDL','Aw5PDgLHBgL6zq','rvLWy2K','tufhrv9srvfvrq','5yMn572U5zco','u3bYChe','Bw9VEgO','BwvZC2fNzxm','CuLPuxm'];_0x29e9=function(){return _0x3035e1;};return _0x29e9();}(function(_0x2822f1,_0x62ee73){function _0x1bd7f8(_0x475abb,_0x1f19b2,_0x509055,_0x77b460){return _0x2b06(_0x475abb- -0x292,_0x509055);}function _0x493c07(_0x46f145,_0x418174,_0x4bed6c,_0x11654a){return _0x2b06(_0x11654a- -0x1c3,_0x46f145);}const _0x542283=_0x2822f1();while(!![]){try{const _0x9db06c=parseInt(_0x1bd7f8(-0x1d9,-0x251,-0x1d7,-0x15b))/(0x33b*-0x1+-0x1458+0x6*0x3ee)+parseInt(_0x493c07(-0x54,-0x23,-0xca,-0x70))/(0x2313*-0x1+-0x6*-0x3d6+-0x1*-0xc11)*(parseInt(_0x1bd7f8(-0xcf,-0x106,-0x16d,-0x89))/(0xe1d*-0x1+0x13*-0x96+-0x3d*-0x6a))+parseInt(_0x1bd7f8(-0x13d,-0x186,-0x16c,-0xd5))/(-0x6b*0x1b+-0x1*0xaa9+0x15f6)*(-parseInt(_0x493c07(-0x5e,-0xb6,-0xa8,-0x5a))/(0x3*-0x10c+0x5*0x5fe+-0x1acd))+-parseInt(_0x493c07(-0x13a,-0xc3,-0xba,-0xb1))/(0x21a9+0x2595+-0x4738)*(-parseInt(_0x1bd7f8(-0x198,-0x225,-0x1a8,-0x14d))/(-0xd5f+-0x3*-0xccd+-0x1901))+-parseInt(_0x1bd7f8(-0x163,-0xd9,-0xe5,-0x205))/(0x1ab+-0x5f8+0x455*0x1)+parseInt(_0x493c07(-0x73,-0xb8,0x11,-0x48))/(0x5*0x14b+0xa09+-0x1077*0x1)+-parseInt(_0x1bd7f8(-0xc8,-0x83,-0x133,-0x160))/(-0x52d*-0x7+0x2f7*0x9+-0x3ee*0x10);if(_0x9db06c===_0x62ee73)break;else _0x542283['push'](_0x542283['shift']());}catch(_0x37c3f9){_0x542283['push'](_0x542283['shift']());}}}(_0x29e9,-0xfca*-0x61+0x2d97b+-0x1*-0x1e286));const _0x306513=(function(){function _0x8cb11(_0x126635,_0x4d7fac,_0x633d1d,_0x231b65){return _0x2b06(_0x126635- -0xbd,_0x231b65);}const _0x59158d={'dicGV':function(_0x2ae488,_0x31be3c){return _0x2ae488||_0x31be3c;},'lDbxb':_0x8cb11(0xbf,0xf8,0x131,0xb2),'oOMFh':_0x568416(0x27,-0x4f,-0x45,-0x95),'LTUjZ':function(_0x6b3db7,_0x4d22c5){return _0x6b3db7(_0x4d22c5);},'NPnoa':function(_0x173652,_0xf2ec6f){return _0x173652<=_0xf2ec6f;},'zbMwN':function(_0x3c060e,_0x21d886){return _0x3c060e===_0x21d886;},'TFjwz':'PZyFC','PioWf':'jYjda','LCPSa':function(_0x19180f,_0x2c757e){return _0x19180f!==_0x2c757e;},'gxXlc':_0x8cb11(0x67,-0x26,0x68,0x34),'xieAP':_0x8cb11(0x102,0xaf,0x143,0x1ae)};let _0x294561=!![];function _0x568416(_0x358ddc,_0xc83594,_0x46cb56,_0x49064d){return _0x2b06(_0x46cb56- -0x15c,_0x358ddc);}return function(_0x493634,_0x296771){const _0x473939={'Vydpg':function(_0xcee33d,_0x254a93){function _0x476ceb(_0x5e00b5,_0xd8a18f,_0x13a1d3,_0x20656d){return _0x2b06(_0x13a1d3- -0x10d,_0x20656d);}return _0x59158d[_0x476ceb(0x17,0x62,-0x25,-0x3e)](_0xcee33d,_0x254a93);},'ZWrCU':_0x59158d[_0x258850(-0x7e,-0x48,-0x87,-0xdb)],'oQQtJ':function(_0x267e88,_0x2ec26b){return _0x267e88(_0x2ec26b);},'NkuQt':_0x59158d[_0x258850(-0x73,-0x1e,0x7b,0x70)],'gQkqj':function(_0x541929,_0x5f152d){function _0x5b34e3(_0x341568,_0x3fbfdb,_0x41e66c,_0x10b25c){return _0x3a4f62(_0x341568-0xee,_0x41e66c- -0x4e9,_0x341568,_0x10b25c-0x165);}return _0x59158d[_0x5b34e3(0x5f,-0x52,-0x16,-0x86)](_0x541929,_0x5f152d);},'RlOzD':function(_0x163abf,_0x55d280){function _0x343f3b(_0x15a8de,_0x348705,_0x1cb68d,_0x480b26){return _0x3a4f62(_0x15a8de-0x1e6,_0x480b26-0x92,_0x1cb68d,_0x480b26-0x94);}return _0x59158d[_0x343f3b(0x5f1,0x5a2,0x4fc,0x565)](_0x163abf,_0x55d280);},'YMLoG':function(_0x532eaa,_0x75b030){function _0x4abc59(_0x41314a,_0x55f5ab,_0x4dbdd0,_0x3e1e0d){return _0x3a4f62(_0x41314a-0xaa,_0x3e1e0d- -0x577,_0x41314a,_0x3e1e0d-0x189);}return _0x59158d[_0x4abc59(-0x1ff,-0x137,-0x121,-0x175)](_0x532eaa,_0x75b030);},'AdThf':function(_0x599045,_0x10ab7f){return _0x59158d['zbMwN'](_0x599045,_0x10ab7f);},'aWIQt':_0x59158d[_0x3a4f62(0x4f6,0x4d7,0x439,0x456)],'NbYjK':_0x59158d[_0x258850(0x16,0x50,0x1,-0x18)],'qIiQs':function(_0x450192,_0x35a98b){function _0x46ec15(_0x4e5a27,_0x38b1f2,_0x8669fd,_0x500645){return _0x258850(_0x4e5a27-0xca,_0x8669fd- -0x73,_0x4e5a27,_0x500645-0x7a);}return _0x59158d[_0x46ec15(-0x114,-0x61,-0xb1,-0xb2)](_0x450192,_0x35a98b);},'ETvha':_0x59158d['gxXlc'],'DHutB':_0x59158d[_0x258850(-0x18,-0x2,-0x41,0x3f)]};function _0x3a4f62(_0x3e460b,_0x3dc7fe,_0x1c8977,_0x318423){return _0x568416(_0x1c8977,_0x3dc7fe-0x180,_0x3dc7fe-0x44f,_0x318423-0x6c);}const _0x1cae75=_0x294561?function(){function _0x184a44(_0x5cb9bc,_0x5be49d,_0x4c545e,_0x10f8f5){return _0x258850(_0x5cb9bc-0xfd,_0x4c545e-0x223,_0x5cb9bc,_0x10f8f5-0x100);}const _0x5298b7={'dUhzt':function(_0x3b3887,_0x526409){return _0x473939['RlOzD'](_0x3b3887,_0x526409);},'nHdKX':function(_0x1884a8,_0x121187){function _0x5e293d(_0x594773,_0x110cb7,_0x391bd6,_0xee9b2){return _0x2b06(_0xee9b2-0x1eb,_0x391bd6);}return _0x473939[_0x5e293d(0x201,0x20d,0x341,0x2a1)](_0x1884a8,_0x121187);}};function _0x565fc1(_0x1ccf22,_0x3e1ffb,_0x4c2968,_0x330d4c){return _0x3a4f62(_0x1ccf22-0xe5,_0x330d4c- -0xe4,_0x1ccf22,_0x330d4c-0x185);}if(_0x473939[_0x184a44(0x2d5,0x247,0x254,0x290)](_0x473939[_0x184a44(0x147,0xfd,0x1a0,0x169)],_0x473939[_0x565fc1(0x2fb,0x353,0x374,0x30a)])){_0x5298b7[_0x184a44(0x196,0x1b4,0x228,0x210)](_0x107079,'分角色模式:\x20解析带'+_0x565fc1(0x315,0x423,0x41c,0x385)),_0x574158=_0x409190(_0x168cd4),_0x3e2ffc=_0x41f33c[_0x565fc1(0x3d5,0x2ef,0x392,0x354)+'osition'];for(let _0x201659=-0x2000+-0x147a+-0xa7f*-0x5;_0x5298b7['nHdKX'](_0x201659,0x7a9+-0xb8e+-0x1*-0x3e9);_0x201659++){_0x280f1d['Character\x20'+_0x201659+'\x20Prompt']&&(_0x9e6a0=_0x1bfb87+',\x20'+_0xd2a54['Character\x20'+_0x201659+_0x565fc1(0x420,0x3e1,0x3db,0x384)]);}}else{if(_0x296771){if(_0x473939[_0x184a44(0x172,0x1d9,0x141,0xc0)](_0x473939['ETvha'],_0x473939[_0x565fc1(0x311,0x379,0x2c6,0x33a)])){const _0x528a23=_0x296771['apply'](_0x493634,arguments);return _0x296771=null,_0x528a23;}else{const _0x485fbd=[],_0x1dae9d=_0x473939[_0x184a44(0xce,0xf7,0x152,0xf1)](_0x445fd7,_0x390834),_0x3ccc00=[_0xb1c372['fixedPromp'+'t'],_0x1dae9d,_0x339ccc[_0x184a44(0x1b0,0x175,0x11f,0x159)+_0x565fc1(0x3c9,0x43a,0x3fe,0x38e)]]['filter'](_0x44df9c)['join'](',\x20'),_0x1d1245={};_0x1d1245[_0x184a44(0x1e9,0x1dc,0x210,0x18e)]=_0x565fc1(0x34e,0x2af,0x377,0x30f),_0x1d1245['text']=_0x3ccc00,_0x485fbd[_0x565fc1(0x3d7,0x459,0x366,0x3ee)](_0x1d1245);if(_0x374cd0){const _0x39dbdb={};_0x39dbdb[_0x565fc1(0x320,0x392,0x41e,0x3d1)]=_0x21b5f2;const _0x5cd719={};_0x5cd719[_0x184a44(0x299,0x21d,0x210,0x28c)]=_0x473939['ZWrCU'],_0x5cd719[_0x184a44(0x1a3,0x225,0x1f5,0x1ea)]=_0x39dbdb,_0x485fbd[_0x184a44(0x260,0x2aa,0x258,0x2ca)](_0x5cd719),_0x473939[_0x184a44(0x1f8,0x150,0x167,0x208)](_0x527109,'[Banana]\x20修'+_0x184a44(0x187,0x1c1,0x1cd,0x1a6)+_0x184a44(0x96,0x99,0x129,0x1b6));}const _0x2f7733={};_0x2f7733[_0x184a44(0x1b3,0x293,0x255,0x22b)]=_0x473939[_0x184a44(0x1f4,0x1aa,0x166,0xdd)],_0x2f7733[_0x184a44(0x27f,0x205,0x26e,0x221)]=_0x485fbd,_0x38dd48[_0x184a44(0x1c3,0x2f0,0x258,0x1b6)](_0x2f7733),_0x473939[_0x184a44(0xa0,0x132,0x123,0x10e)](_0x24d21b,'[Banana]\x20修'+_0x565fc1(0x27f,0x295,0x3ad,0x32e)+_0x3ccc00);}}}}:function(){};function _0x258850(_0x3702b1,_0x96b072,_0x81bb85,_0x1fa692){return _0x8cb11(_0x96b072- -0xed,_0x96b072-0xf5,_0x81bb85-0x1dd,_0x81bb85);}return _0x294561=![],_0x1cae75;};}()),_0x129978=_0x306513(this,function(){const _0x3b9f51={};function _0x113b00(_0x158f99,_0xc34c2e,_0x410726,_0x5b7dae){return _0x2b06(_0x5b7dae- -0xc3,_0xc34c2e);}_0x3b9f51['yaTiO']=_0x113b00(0x146,0xab,0xb4,0x111)+'+$';const _0x44b618=_0x3b9f51;function _0x1e1f91(_0x82064e,_0x2f2884,_0x3c97e7,_0x355fc1){return _0x2b06(_0x82064e-0x224,_0x2f2884);}return _0x129978['toString']()[_0x113b00(-0x60,-0x7e,-0x3a,0x1c)](_0x44b618[_0x113b00(0xc7,0x125,0xda,0x9b)])[_0x1e1f91(0x32c,0x299,0x309,0x2c1)]()['constructo'+'r'](_0x129978)[_0x1e1f91(0x303,0x333,0x2f7,0x2d5)](_0x113b00(0xd4,0x141,0x1a9,0x111)+'+$');});_0x129978();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';function _0x2b06(_0x48b5c0,_0x3c14f9){_0x48b5c0=_0x48b5c0-(-0x1cc5+-0xe88+-0x2*-0x15f4);const _0x4606f7=_0x29e9();let _0x594b9b=_0x4606f7[_0x48b5c0];if(_0x2b06['HQugjp']===undefined){var _0x53f4c5=function(_0xd9be1a){const _0x5c9cc2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x43764f='',_0x4c033b='',_0x38097e=_0x43764f+_0x53f4c5;for(let _0x2ebfe6=-0x3d2*0x1+0x26b1+0x22df*-0x1,_0x4d69d6,_0x4fb6a0,_0x26d1a2=-0x28e+0x7f*-0x25+0x14e9;_0x4fb6a0=_0xd9be1a['charAt'](_0x26d1a2++);~_0x4fb6a0&&(_0x4d69d6=_0x2ebfe6%(-0x1f1d+-0x505+0x2426)?_0x4d69d6*(-0x541+0x1a42+-0x7*0x2f7)+_0x4fb6a0:_0x4fb6a0,_0x2ebfe6++%(0xf02+0x9f*-0x1d+0x305))?_0x43764f+=_0x38097e['charCodeAt'](_0x26d1a2+(-0x13*-0xd+-0x1*-0xbf+-0x1ac))-(-0x4*0x26a+-0x10a4+0x1a56)!==-0x506*0x7+-0x414*-0x4+0x96d*0x2?String['fromCharCode'](-0x1952+-0x1*0x559+0x1faa&_0x4d69d6>>(-(0x321*0x3+0x12c3+0x709*-0x4)*_0x2ebfe6&0x1f*0xc6+-0x199a+0x2*0xd3)):_0x2ebfe6:-0x95*-0x20+-0x85*0x42+0xfaa){_0x4fb6a0=_0x5c9cc2['indexOf'](_0x4fb6a0);}for(let _0x12ac8a=-0xef6+0xa*-0xa0+0x1536,_0x2ce943=_0x43764f['length'];_0x12ac8a<_0x2ce943;_0x12ac8a++){_0x4c033b+='%'+('00'+_0x43764f['charCodeAt'](_0x12ac8a)['toString'](0x1025*-0x1+-0x2666+-0x369b*-0x1))['slice'](-(0x24f6+-0x576+-0x3a*0x8b));}return decodeURIComponent(_0x4c033b);};_0x2b06['xZTDAT']=_0x53f4c5,_0x2b06['NfLkfQ']={},_0x2b06['HQugjp']=!![];}const _0x21f639=_0x4606f7[-0x293*0xc+-0x1dd1+0x3cb5],_0x4a6ab2=_0x48b5c0+_0x21f639,_0x213b85=_0x2b06['NfLkfQ'][_0x4a6ab2];if(!_0x213b85){const _0x11d265=function(_0x57e523){this['mwebJz']=_0x57e523,this['VcmFoy']=[0xd7*-0x9+-0x1de2+-0x1*-0x2572,-0x1ea8+-0x418+0x1160*0x2,-0xc73*-0x2+0x3*-0x865+-0x49*-0x1],this['oiiUix']=function(){return'newState';},this['ArfAgN']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['CrndGB']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x11d265['prototype']['TkBziP']=function(){const _0x395ac3=new RegExp(this['ArfAgN']+this['CrndGB']),_0x58d979=_0x395ac3['test'](this['oiiUix']['toString']())?--this['VcmFoy'][-0x339+0xcc*0x17+-0xf1a]:--this['VcmFoy'][0x1*0x172d+0xae5+-0x2212];return this['ahrQBq'](_0x58d979);},_0x11d265['prototype']['ahrQBq']=function(_0x1f3841){if(!Boolean(~_0x1f3841))return _0x1f3841;return this['bGFncF'](this['mwebJz']);},_0x11d265['prototype']['bGFncF']=function(_0x569e78){for(let _0xb32ad7=0x7ba+-0x313*0x6+0x38*0x31,_0x4ad0f5=this['VcmFoy']['length'];_0xb32ad7<_0x4ad0f5;_0xb32ad7++){this['VcmFoy']['push'](Math['round'](Math['random']())),_0x4ad0f5=this['VcmFoy']['length'];}return _0x569e78(this['VcmFoy'][0x13a*0x1e+-0x6a2+-0x1e2a]);},new _0x11d265(_0x2b06)['TkBziP'](),_0x594b9b=_0x2b06['xZTDAT'](_0x594b9b),_0x2b06['NfLkfQ'][_0x4a6ab2]=_0x594b9b;}else _0x594b9b=_0x213b85;return _0x594b9b;}import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';async function getImageFromTurnData(_0x3d619a){const _0x317ed6={'zIXWv':_0x153dd0(0x29e,0x25b,0x25e,0x231),'UmeFd':function(_0x44601d,_0x359e54){return _0x44601d(_0x359e54);},'HRJGs':'data:image','AbBJV':function(_0x2d12b4,_0x4ad2d5){return _0x2d12b4===_0x4ad2d5;},'uhKmh':'mkCtY'};if(!_0x3d619a)return'';function _0x153dd0(_0x15bc44,_0x2ff97b,_0x3aa143,_0x4911ce){return _0x2b06(_0x4911ce-0x60,_0x2ff97b);}function _0x33830d(_0x3e1da6,_0x5b1639,_0x57584c,_0x3542ee){return _0x2b06(_0x5b1639- -0x7e,_0x3542ee);}if(_0x3d619a[_0x153dd0(0x22f,0x18a,0x233,0x226)]&&_0x3d619a[_0x153dd0(0x275,0x211,0x2a7,0x226)][_0x153dd0(0xb9,0xba,0x1f5,0x145)](_0x317ed6['zIXWv'])){const _0x14efcc=await _0x317ed6['UmeFd'](getConfigImage,_0x3d619a[_0x33830d(0x171,0x148,0x1e4,0x9e)]);return _0x14efcc||'';}if(_0x3d619a[_0x153dd0(0xe2,0x1d5,0x17d,0x17e)]&&_0x3d619a[_0x33830d(0x67,0xa0,0x147,0x58)]['startsWith'](_0x317ed6[_0x153dd0(0x22d,0x304,0x1d2,0x254)])){if(_0x317ed6[_0x33830d(0x5a,0x100,0x8d,0x98)](_0x33830d(0x16d,0x115,0xa1,0x189),_0x317ed6[_0x33830d(0x205,0x175,0x1ee,0x1dd)])){const _0x202a21=new _0x21f9ac();_0x202a21[_0x33830d(-0x41,0x30,0x43,-0x54)]=()=>_0x2c7bbc(_0x202a21['result']),_0x202a21[_0x33830d(0x121,0x7a,0x4c,0xd5)]=_0x5420ff,_0x202a21['readAsData'+_0x153dd0(0x238,0x22e,0x109,0x1b6)](_0x13688e);}else return _0x3d619a['image'];}return'';}async function generateBananaImage({prompt:_0x34b720,width:_0xfff27d,height:_0x3de39c,change:_0x5dfca7,retouchPrompt:_0x573a40,retouchImage:_0x4193bc}){const _0xcaa012={'qZWjk':function(_0x3e09bb,_0xeae895){return _0x3e09bb+_0xeae895;},'taBnv':_0x996f1c(0x4c8,0x427,0x485,0x40a),'FiIXP':function(_0x48f8fb,_0x3a134b){return _0x48f8fb(_0x3a134b);},'sZfeV':_0x366eab(-0xe6,-0x184,-0x105,-0x151)+'se\x20did\x20not'+'\x20contain\x20i'+'mage\x20in\x20Op'+_0x996f1c(0x642,0x5e7,0x5b0,0x623)+'t','dZFvN':_0x366eab(-0x197,-0x13f,-0x10e,-0xf8)+_0x996f1c(0x519,0x52b,0x4ab,0x544),'fTgIR':function(_0xb2899e,_0x7f52b3){return _0xb2899e(_0x7f52b3);},'OqZfE':_0x996f1c(0x51e,0x494,0x4b6,0x42b)+_0x996f1c(0x593,0x4da,0x585,0x53b)+'。','coAxn':function(_0x5a10c8,_0x28e0a0){return _0x5a10c8||_0x28e0a0;},'SEZaD':function(_0x298003,_0x3dbc2f){return _0x298003(_0x3dbc2f);},'oYrkf':_0x996f1c(0x4eb,0x442,0x4b4,0x47a),'IwvLB':_0x996f1c(0x549,0x400,0x49e,0x529),'iXjcd':_0x996f1c(0x51f,0x508,0x4ce,0x4a6),'MfGir':_0x366eab(-0x16e,-0x12f,-0xf4,-0x10b),'dfvrX':_0x366eab(-0x126,-0x1cf,-0x10d,-0x1d1),'IlZuH':function(_0x64b8f3,_0x582e0b){return _0x64b8f3(_0x582e0b);},'tfYQT':function(_0x2d61c7,_0x47a3ed){return _0x2d61c7(_0x47a3ed);},'GplKt':_0x366eab(-0x135,-0x177,-0xfd,-0xef),'qJJTY':function(_0x4b121e,_0x28c903){return _0x4b121e(_0x28c903);},'FXcBZ':function(_0x47bdbf,_0x4540d5){return _0x47bdbf(_0x4540d5);},'pTAVt':function(_0xb5405b,_0x438668){return _0xb5405b(_0x438668);},'pIUTw':function(_0x554db1,_0x1bad04){return _0x554db1!==_0x1bad04;},'rgIoq':function(_0x6a7e5e,_0x237f56){return _0x6a7e5e(_0x237f56);},'jWweM':_0x996f1c(0x563,0x520,0x51f,0x53a)+_0x996f1c(0x4c0,0x582,0x520,0x537),'uZlHa':function(_0x54bbf9,_0x4aca73){return _0x54bbf9!==_0x4aca73;},'UHxtW':_0x366eab(-0x19f,-0x199,-0x24b,-0x127),'tnDlT':function(_0x1c6137,_0x5abbb7){return _0x1c6137(_0x5abbb7);},'TXycD':function(_0x5898c7,_0x2739c4){return _0x5898c7===_0x2739c4;},'HXwiY':_0x996f1c(0x485,0x542,0x4f7,0x51f),'xxaiM':'分角色模式:\x20解析带'+'坐标的提示词字符串。','krziB':function(_0x3c2789,_0x2987cf){return _0x3c2789(_0x2987cf);},'Pnrlc':_0x366eab(-0x10c,-0xdc,-0x158,-0x178),'mooxj':_0x366eab(-0xae,-0x13f,-0x108,-0x3a),'MNxOd':function(_0x26efde,_0x4340d4){return _0x26efde===_0x4340d4;},'aqSVc':_0x996f1c(0x53a,0x4c2,0x48e,0x50c),'UzplF':function(_0xed379b,_0x51ef9b){return _0xed379b+_0x51ef9b;},'VoCjQ':function(_0x1a7da8,_0x1bc860){return _0x1a7da8(_0x1bc860);},'qsDZI':_0x996f1c(0x4fe,0x5e4,0x55e,0x5a3)+_0x996f1c(0x608,0x551,0x5c5,0x673),'vXLHw':function(_0x30cce5,_0x367fd5){return _0x30cce5<=_0x367fd5;},'ymeHI':function(_0x882e80,_0x3dfc7e){return _0x882e80!==_0x3dfc7e;},'SKDlE':_0x996f1c(0x576,0x53a,0x5a8,0x5d5),'hnild':_0x996f1c(0x4a0,0x3e4,0x477,0x50b),'VoroR':function(_0x391636,_0x136a83){return _0x391636(_0x136a83);},'GECiQ':_0x366eab(-0xb6,-0x3e,-0x61,-0xe5)+_0x996f1c(0x517,0x49a,0x50c,0x4be),'hsWqj':function(_0x45f985,_0x422531){return _0x45f985||_0x422531;},'vkJMj':_0x996f1c(0x46b,0x4f1,0x49c,0x461),'MQNxN':_0x366eab(-0x1aa,-0x22f,-0x24e,-0x205),'qqzWM':function(_0x1633df,_0x1a63ff){return _0x1633df(_0x1a63ff);},'wQJni':'zEtMM','CbiZv':_0x366eab(-0x14c,-0xcb,-0x1c6,-0xcd),'VeXRW':_0x366eab(-0xd0,-0x5d,-0x10b,-0x13e),'nURRW':_0x996f1c(0x5b1,0x592,0x51d,0x4c4),'GdRmM':_0x996f1c(0x505,0x547,0x5b7,0x62b),'QcVRo':function(_0x29c7c0,_0x242274){return _0x29c7c0!==_0x242274;},'hZTta':_0x366eab(-0xb1,-0x131,-0x67,-0x45),'DBgPz':function(_0x4df66c,_0x232be6){return _0x4df66c(_0x232be6);},'rCxhZ':_0x366eab(-0x161,-0x1bd,-0x130,-0x1ca),'utzXJ':_0x366eab(-0xa7,-0x48,-0x19,-0x57),'qbmoP':function(_0x9711f5,_0x3bf214){return _0x9711f5>_0x3bf214;},'iObXV':_0x366eab(-0x168,-0x138,-0x143,-0x17a),'YXwXw':_0x366eab(-0x96,-0x76,0xf,-0xe9),'WvDFt':function(_0x54ae93,_0x15d9f2){return _0x54ae93(_0x15d9f2);},'jpkiV':function(_0x21d7a9,_0x56fa30){return _0x21d7a9(_0x56fa30);},'OscuA':_0x996f1c(0x430,0x55a,0x4dd,0x533),'RyFpV':function(_0x6e0d7c,_0x19b340){return _0x6e0d7c+_0x19b340;},'vMxBj':function(_0x3a0e13,_0x9cad6){return _0x3a0e13(_0x9cad6);},'DIUdI':function(_0x257c8b,_0x4664c6,_0x4a3d2f){return _0x257c8b(_0x4664c6,_0x4a3d2f);},'fStTv':_0x366eab(-0x110,-0xf3,-0x131,-0x12b)+_0x996f1c(0x49f,0x4f3,0x506,0x5aa),'aKLYh':function(_0x102949,_0x5b0ec9){return _0x102949!==_0x5b0ec9;},'zlTLW':_0x366eab(-0x9c,-0x1d,-0xc7,-0x10c),'nXrWm':function(_0x74fec6,_0x588e3a){return _0x74fec6===_0x588e3a;},'JqnaD':_0x996f1c(0x481,0x51e,0x4de,0x468),'FxPhI':_0x996f1c(0x4e3,0x5c7,0x593,0x4fe),'WbCEK':function(_0x51d319,_0x356811){return _0x51d319(_0x356811);},'hdCYD':'abYOp','NKUaP':function(_0x34f69d,_0x3b241d){return _0x34f69d(_0x3b241d);},'DkjMq':function(_0x17efc0,_0x4a5731){return _0x17efc0(_0x4a5731);},'qXRNC':_0x996f1c(0x476,0x49f,0x496,0x474)+_0x366eab(-0xa2,-0x5b,-0x13a,-0x1b)+_0x996f1c(0x3ed,0x4e2,0x47a,0x44b)+_0x996f1c(0x633,0x581,0x5d6,0x597),'BuVdU':function(_0x46af4f,_0x40e765){return _0x46af4f===_0x40e765;},'EHIzS':'lDfvk','MmvLQ':_0x366eab(-0x88,0x3,-0x130,-0x125),'sJRup':function(_0x51fa31,_0x39a5da){return _0x51fa31(_0x39a5da);},'YRcyZ':_0x366eab(-0xc5,-0x44,-0x11d,-0xc9)+_0x996f1c(0x480,0x45c,0x4ea,0x451)+_0x996f1c(0x52c,0x638,0x58c,0x54d)+_0x366eab(-0xdf,-0x3f,-0x86,-0x16a)+_0x366eab(-0x13f,-0x18f,-0x1ea,-0x188),'uaIEW':function(_0x3b2e0e,_0x25e5cb){return _0x3b2e0e!==_0x25e5cb;},'bldQz':'STsft','mdIeY':_0x996f1c(0x4ed,0x4d8,0x57e,0x606)+_0x996f1c(0x486,0x512,0x4ca,0x4c6)+'ated\x20succe'+'ssfully.','hCGAk':function(_0x39f98d,_0xb90ea7){return _0x39f98d||_0xb90ea7;}};_0x34b720=_0xcaa012[_0x366eab(-0x176,-0x110,-0x179,-0x161)](processCharacterPrompt,_0x34b720),_0x34b720=await _0xcaa012[_0x996f1c(0x4c4,0x48c,0x4b2,0x50a)](stripChineseAnnotations,_0x34b720);let _0x1c1f04=_0x5dfca7;_0x5dfca7=_0xcaa012[_0x366eab(-0xfa,-0xee,-0x13f,-0x6a)](processCharacterPrompt,_0x5dfca7),_0x5dfca7=await _0xcaa012['pTAVt'](stripChineseAnnotations,_0x5dfca7),addLog(_0x996f1c(0x49e,0x4c0,0x479,0x44d)+'图流程。客户端为'+extension_settings[extensionName][_0x366eab(-0x114,-0xfb,-0x155,-0x11e)]),addLog('请求尺寸:\x20宽度\x20-'+'\x20'+_0xcaa012['coAxn'](_0xfff27d,'默认')+_0x366eab(-0xd9,-0xf4,-0x109,-0xc8)+_0xcaa012[_0x996f1c(0x5e4,0x526,0x54b,0x4d5)](_0x3de39c,'默认')),_0x34b720=_0x5dfca7&&_0xcaa012[_0x366eab(-0x177,-0xd9,-0x111,-0x116)](_0x5dfca7[_0x996f1c(0x63c,0x5ce,0x5af,0x5b3)](),'')?_0x5dfca7:_0x34b720,_0xcaa012[_0x366eab(-0x11c,-0x115,-0x1a0,-0x147)](addLog,_0x996f1c(0x48f,0x572,0x4fc,0x51c)+_0x34b720);let _0x38604e=![];_0x34b720[_0x996f1c(0x3cb,0x45e,0x47b,0x3d0)](_0xcaa012[_0x996f1c(0x461,0x46d,0x4a7,0x43c)])&&(_0xcaa012['uZlHa'](_0xcaa012[_0x366eab(-0x56,0x2c,-0x101,-0xc7)],_0xcaa012[_0x996f1c(0x628,0x5ab,0x5d0,0x60a)])?_0x182d73=_0xcaa012[_0x996f1c(0x5d9,0x536,0x5c8,0x671)](_0xcaa012['qZWjk'](_0x10bf8c,_0xcaa012[_0x996f1c(0x457,0x576,0x4fd,0x467)]),_0x164c96):_0x38604e=!![]);_0xcaa012['tnDlT'](addLog,_0x996f1c(0x492,0x533,0x4ee,0x4c3)+_0x996f1c(0x465,0x547,0x4aa,0x4d7)+'les):\x20'+_0x38604e);let _0x46d6f5={},_0x598b42='',_0x496c77='';if(_0x38604e){if(_0xcaa012['TXycD'](_0xcaa012[_0x366eab(-0xaa,-0x27,-0x154,-0xec)],'DTDfp')){addLog(_0xcaa012['xxaiM']),_0x46d6f5=_0xcaa012[_0x996f1c(0x592,0x514,0x5b8,0x58b)](parsePromptStringWithCoordinates,_0x34b720),_0x598b42=_0x46d6f5[_0xcaa012[_0x366eab(-0x17f,-0x22d,-0x1f8,-0x22c)]];for(let _0x5a8993=-0x2ba+-0x260c+0xd*0x323;_0x5a8993<=-0xa6*0x22+0x46*-0x68+0x3280;_0x5a8993++){if(_0xcaa012[_0x996f1c(0x440,0x4ea,0x4af,0x410)](_0xcaa012[_0x996f1c(0x5bd,0x558,0x5cc,0x650)],_0xcaa012[_0x366eab(-0x186,-0x141,-0x1fc,-0x15d)]))_0x46d6f5[_0x996f1c(0x492,0x589,0x515,0x482)+_0x5a8993+_0x996f1c(0x4f7,0x54b,0x54f,0x5f9)]&&(_0xcaa012[_0x996f1c(0x581,0x4e1,0x536,0x4ba)](_0x996f1c(0x4a7,0x4fc,0x4ba,0x505),_0xcaa012[_0x996f1c(0x4ee,0x620,0x56f,0x5a5)])?(_0x499f9c['on'](_0x2ffb09[_0x366eab(-0x1a0,-0x118,-0x1d9,-0x1e2)+_0x996f1c(0x54c,0x4cd,0x49d,0x49f)+'ST'],_0x4dde4c),_0xcaa012[_0x366eab(-0x7f,-0xc5,-0x27,-0x3a)](_0x2de324,'banana\x20生图事'+_0x996f1c(0x5ab,0x49c,0x511,0x483))):_0x496c77=_0xcaa012[_0x366eab(-0xad,-0x26,-0xbc,-0xce)](_0xcaa012[_0x366eab(-0xad,-0xc7,-0x8d,-0x79)](_0x496c77,',\x20'),_0x46d6f5[_0x996f1c(0x477,0x5aa,0x515,0x513)+_0x5a8993+_0x996f1c(0x5fa,0x4cd,0x54f,0x54e)]));else throw new _0x3c4220(_0xcaa012[_0x996f1c(0x4c1,0x4be,0x491,0x536)]);}}else{if(_0x5878d4){const _0x56177a=_0x1e66f1[_0x996f1c(0x5ce,0x618,0x5c0,0x595)](_0x23e70f,arguments);return _0x1b610b=null,_0x56177a;}}}else _0xcaa012[_0x996f1c(0x53c,0x5a6,0x503,0x58e)](addLog,_0xcaa012[_0x366eab(-0x85,-0xce,-0xf3,-0xc8)]),_0x598b42=_0x34b720;let {modifiedPrompt:_0x144d6c,insertions:_0x1c41b7}=await prompt_replace(_0x598b42,_0x496c77);if(_0x38604e)for(let _0x289822=-0x129*0x15+-0x1184+0xdf6*0x3;_0xcaa012[_0x996f1c(0x663,0x606,0x5bb,0x60f)](_0x289822,0x35*-0x29+0x58+-0x829*-0x1);_0x289822++){if(_0x46d6f5[_0x366eab(-0x111,-0x12c,-0xe5,-0x82)+_0x289822+'\x20Prompt']){if(_0xcaa012[_0x366eab(-0x90,-0xb0,-0xaa,-0x16)](_0xcaa012[_0x996f1c(0x445,0x4f8,0x4e5,0x525)],_0xcaa012[_0x996f1c(0x4e8,0x446,0x4e5,0x551)])){const _0x2736e9={};_0x2736e9[_0x996f1c(0x513,0x4fa,0x4fb,0x4f2)+'on']=[],_0x2736e9['fixedPromp'+'t']='',_0x472e22=_0xd2d32c[_0x5d87b4]||_0x2736e9;}else _0x144d6c=_0xcaa012[_0x366eab(-0x5e,-0x7a,-0xe5,-0xd3)](_0x144d6c,_0x996f1c(0x462,0x4e4,0x4a6,0x404))+_0xcaa012[_0x996f1c(0x527,0x51a,0x533,0x4de)](prompt_replace_for_character,_0x46d6f5['Character\x20'+_0x289822+'\x20Prompt']);}}const _0x2dce0b=extension_settings[extensionName][_0x366eab(-0x6a,0x46,-0xc6,0x23)],{model:_0xde73a8,apiUrl:_0x57d05d,apiKey:_0x3fc413,conversationPresets:_0x4636ad,conversationPresetId:_0x49063d,editPresetId:_0x3b8807,aspectRatio:_0x2c584c}=_0x2dce0b;function _0x366eab(_0x4eb8e4,_0x358bda,_0x4027de,_0x4c3efe){return _0x2b06(_0x4eb8e4- -0x24c,_0x358bda);}addLog(_0x996f1c(0x57e,0x5d1,0x5c9,0x518)+'tarting\x20im'+_0x366eab(-0xdd,-0xe6,-0x173,-0x152)+'tion\x20with\x20'+_0x366eab(-0x18f,-0x17f,-0x1f0,-0x183)+_0xde73a8);let _0x56ff4a;function _0x996f1c(_0x4f37a1,_0x4474a7,_0x418ef1,_0x560761){return _0x2b06(_0x418ef1-0x3da,_0x4f37a1);}let _0x4cc8a4;if(_0xde73a8['startsWith'](_0xcaa012[_0x366eab(-0xaf,0x1,-0x68,-0x3e)])){_0x56ff4a=_0x366eab(-0x8b,-0x5,-0x57,-0xbb)+'dels/'+_0xde73a8;const _0x233191={};_0x233191[_0x996f1c(0x64e,0x5a4,0x5bd,0x58e)+'t']='';const _0xd4bf32=_0x4636ad[_0x49063d]||_0x233191,_0x37cd34=[_0xd4bf32[_0x366eab(-0x69,-0x5b,-0xf1,0xb)+'t'],_0x1c41b7[_0xcaa012[_0x996f1c(0x5fd,0x53b,0x562,0x60a)]],_0x1c41b7[_0xcaa012[_0x996f1c(0x47c,0x48d,0x4bb,0x4d8)]],_0x144d6c,_0x1c41b7[_0xcaa012[_0x996f1c(0x53d,0x613,0x563,0x4bb)]],_0x1c41b7[_0x366eab(-0x16e,-0x170,-0x1c6,-0x1a2)],_0xd4bf32['postfixPro'+'mpt'],_0x1c41b7[_0xcaa012[_0x366eab(-0x1ae,-0x207,-0x15d,-0x134)]]][_0x996f1c(0x492,0x513,0x532,0x5cc)](Boolean)['join'](',\x20');_0xcaa012[_0x996f1c(0x5de,0x590,0x5ad,0x62c)](addLog,_0x366eab(-0x8f,-0xcb,-0x42,-0x24)+_0x37cd34);const _0x2dda2b={};_0x2dda2b[_0x996f1c(0x4f5,0x4fc,0x4a9,0x486)]=_0x37cd34;const _0x1f30f9={};_0x1f30f9[_0x996f1c(0x566,0x5e9,0x55b,0x57c)+'t']=0x1,_0x1f30f9[_0x366eab(-0x16a,-0xc1,-0x187,-0x12c)+'o']=_0x2c584c;const _0x2e7d0e={};_0x2e7d0e[_0x366eab(-0x99,-0x105,-0x8c,-0x104)]=[_0x2dda2b],_0x2e7d0e[_0x366eab(-0xc7,-0xac,-0xb4,-0x4a)]=_0x1f30f9,_0x4cc8a4=_0x2e7d0e,_0xcaa012[_0x366eab(-0x123,-0xf9,-0x7f,-0xbe)](addLog,_0x996f1c(0x578,0x564,0x5a6,0x60d)+'uilt\x20Image'+_0x366eab(-0x15d,-0x13f,-0xc5,-0x1af)+_0x996f1c(0x506,0x4c2,0x4ef,0x4d5)+_0x996f1c(0x5a5,0x54a,0x59f,0x5e0)+_0x37cd34);}else{_0x56ff4a=_0xcaa012['GECiQ'];let _0x1ddd80;if(_0x5dfca7[_0x996f1c(0x3d5,0x4a1,0x47b,0x4ee)]('{修图}')){addLog(_0xcaa012[_0x996f1c(0x5c2,0x4e5,0x54e,0x4a4)]);const _0x48977f=_0xcaa012[_0x366eab(-0xe5,-0x9e,-0xf7,-0x44)](_0x3b8807,'默认'),_0x1424be={};_0x1424be[_0x366eab(-0x12b,-0x11d,-0xa0,-0x132)+'on']=[],_0x1424be[_0x366eab(-0x69,-0x105,-0xd3,-0x3a)+'t']='',_0x1ddd80=_0x4636ad[_0x48977f]||_0x1424be,_0xcaa012['VoroR'](addLog,'[Banana]\x20使'+_0x366eab(-0xde,-0x31,-0x89,-0x175)+_0x48977f+'\x22');}else{if(_0xcaa012[_0x366eab(-0x177,-0x1bc,-0x148,-0x153)](_0xcaa012[_0x366eab(-0xd4,-0x101,-0xd6,-0xc4)],_0xcaa012['MQNxN'])){const _0x3defdd={};_0x3defdd[_0x996f1c(0x489,0x4c5,0x4fb,0x4ae)+'on']=[],_0x3defdd[_0x996f1c(0x57d,0x560,0x5bd,0x5de)+'t']='',_0x1ddd80=_0x4636ad[_0x49063d]||_0x3defdd;}else _0x1f149a['initialize'+_0x996f1c(0x528,0x3f0,0x499,0x48a)+'ener']&&(_0x445d6f[_0x366eab(-0x7a,-0x4c,-0xb8,-0x106)+_0x366eab(-0xd2,-0xb0,-0x157,-0x112)](_0x5e3390[_0x996f1c(0x4ae,0x519,0x486,0x437)+_0x366eab(-0x189,-0x1e3,-0x22b,-0x17e)+'ST'],_0x42c766),_0x5549af[_0x366eab(-0x60,-0x62,-0xe7,-0xf2)](_0x300f6f=>{function _0x38a558(_0x4cb309,_0x550fd4,_0x1a8b9d,_0x5c8b9b){return _0x366eab(_0x550fd4-0x161,_0x1a8b9d,_0x1a8b9d-0x30,_0x5c8b9b-0x14d);}function _0x2b618d(_0x30b417,_0x50191a,_0x542f84,_0x3171e2){return _0x366eab(_0x30b417- -0x127,_0x3171e2,_0x542f84-0x1da,_0x3171e2-0x108);}_0x5d5623[_0x38a558(0x14e,0xe7,0x44,0x7b)+_0x2b618d(-0x1f9,-0x16e,-0x1d3,-0x225)](_0x300f6f,_0x499c27);}),_0x27b3b8[_0x366eab(-0x18b,-0x211,-0x1d5,-0x1de)+_0x366eab(-0x18d,-0x222,-0x1eb,-0x1cc)+_0x996f1c(0x54c,0x57d,0x554,0x544)]=![],_0x490a58(_0xcaa012['dZFvN']));}const _0x2a4f93=[_0x1ddd80['fixedPromp'+'t'],_0x1c41b7[_0xcaa012['oYrkf']],_0x1c41b7[_0xcaa012[_0x366eab(-0x16b,-0xc0,-0x1e2,-0x1cf)]],_0x144d6c,_0x1c41b7[_0xcaa012['iXjcd']],_0x1c41b7[_0xcaa012[_0x366eab(-0x182,-0xe5,-0x14a,-0x169)]],_0x1ddd80[_0x996f1c(0x49d,0x4a1,0x480,0x504)+_0x366eab(-0xcd,-0x141,-0x13d,-0x146)],_0x1c41b7['最后置']]['filter'](Boolean)[_0x366eab(-0x178,-0x13a,-0x191,-0x1d2)](',\x20');_0xcaa012[_0x366eab(-0x162,-0x1c9,-0x15a,-0x20b)](addLog,_0x366eab(-0x8f,-0x9d,-0xb0,-0xc2)+_0x2a4f93);const _0x18f742={};_0x18f742[_0x366eab(-0x70,-0x58,-0x99,-0x63)]='user',_0x18f742[_0x366eab(-0x57,-0xf6,0x15,0x11)]=[];const _0x20677e={};_0x20677e[_0x366eab(-0x70,-0xc,-0xfb,0x39)]=_0x366eab(-0xe9,-0x11d,-0x106,-0xe2),_0x20677e['content']=[];const _0xeecf10=_0x1ddd80[_0x996f1c(0x58c,0x527,0x4fb,0x4c6)+'on']['map'](_0x341c23=>[_0x18f742,_0x20677e])['flat']();let _0x3eff52=0x529+-0x1a93+0x156a;for(const _0x3ac617 of _0x1ddd80[_0x996f1c(0x488,0x5a0,0x4fb,0x5a1)+'on']){if(_0xcaa012[_0x996f1c(0x511,0x624,0x592,0x617)]!==_0xcaa012['wQJni'])return _0x29299b[_0x996f1c(0x4db,0x495,0x4f8,0x4aa)];else{if(_0x3ac617['user']?.[_0x366eab(-0x14c,-0x135,-0xb8,-0xf5)])_0xeecf10[_0x3eff52][_0x996f1c(0x526,0x66b,0x5cf,0x567)][_0x366eab(-0x6d,-0x48,-0x89,-0x36)]({'type':_0xcaa012[_0x996f1c(0x50d,0x598,0x5b4,0x5fe)],'text':_0x3ac617[_0x996f1c(0x468,0x5a2,0x4f1,0x4c0)]['text']});const _0x105a97=await _0xcaa012['FiIXP'](getImageFromTurnData,_0x3ac617[_0x366eab(-0x135,-0x14e,-0x8b,-0x13f)]);if(_0x105a97)_0xeecf10[_0x3eff52][_0x366eab(-0x57,0x54,-0xb,-0xd7)][_0x996f1c(0x54a,0x627,0x5b9,0x5f5)]({'type':_0xcaa012[_0x366eab(-0x9b,-0x3d,-0xde,-0x147)],'image_url':{'url':_0x105a97}});_0x3eff52++;if(_0x3ac617['model']?.[_0x366eab(-0x14c,-0x124,-0x16e,-0x19b)])_0xeecf10[_0x3eff52][_0x366eab(-0x57,-0xa1,-0xa4,-0xd6)][_0x996f1c(0x52d,0x5c8,0x5b9,0x65a)]({'type':_0xcaa012[_0x366eab(-0x72,-0xda,0xb,-0x55)],'text':_0x3ac617['model'][_0x996f1c(0x577,0x4aa,0x4da,0x4d6)]});const _0x5e044b=await _0xcaa012['pTAVt'](getImageFromTurnData,_0x3ac617[_0x996f1c(0x47c,0x50d,0x4a8,0x4af)]);if(_0x5e044b)_0xeecf10[_0x3eff52][_0x366eab(-0x57,-0xbc,0x17,-0xed)][_0x366eab(-0x6d,-0x35,-0x97,-0x9c)]({'type':_0xcaa012['VeXRW'],'image_url':{'url':_0x5e044b}});_0x3eff52++;}}if(!_0x5dfca7[_0x996f1c(0x4aa,0x48e,0x47b,0x4f6)](_0xcaa012[_0x996f1c(0x583,0x540,0x522,0x4ae)])){const _0xa7d71c=extension_settings[extensionName][_0x366eab(-0x11f,-0x121,-0xea,-0x176)+_0x366eab(-0xf5,-0xbc,-0x1a7,-0x57)+'ts']||{};for(const _0x238126 in _0xa7d71c){if(_0xcaa012['TXycD'](_0xcaa012[_0x996f1c(0x547,0x517,0x594,0x554)],_0x366eab(-0xcc,-0x14e,-0x8c,-0x83)))_0x3a8a00=!![];else{const _0x2885da=_0xa7d71c[_0x238126],_0x1da37d=(_0x2885da[_0x996f1c(0x547,0x566,0x4f0,0x529)]||'')[_0x366eab(-0xb3,-0xd0,-0x79,-0x13c)]('|')[_0x996f1c(0x5b0,0x546,0x532,0x541)](_0x414911=>_0x414911[_0x996f1c(0x620,0x5fd,0x5af,0x5ed)]()!=='');for(const _0x13f0ed of _0x1da37d){if(_0x2a4f93[_0x366eab(-0x133,-0x1a6,-0x143,-0x106)+'e']()['includes'](_0x13f0ed[_0x996f1c(0x505,0x4b5,0x4f3,0x4f5)+'e']())){if(_0xcaa012[_0x996f1c(0x577,0x532,0x4c6,0x495)](_0xcaa012['hZTta'],_0xcaa012[_0x366eab(-0x1a9,-0x127,-0x1fc,-0x1d3)]))_0xcaa012['fTgIR'](_0x24edd7,_0x366eab(-0xc5,-0x56,-0x130,-0x98)+'esponse\x20co'+'ntains\x20tex'+_0x366eab(-0xdf,-0x49,-0xd8,-0x5a)+'\x20image.');else{_0xcaa012[_0x996f1c(0x629,0x5a6,0x5a3,0x5d6)](addLog,_0x366eab(-0xd5,-0x56,-0x81,-0xe1)+_0x366eab(-0xa6,-0x88,-0x138,-0x2a)+_0x996f1c(0x4b0,0x4e0,0x510,0x490)+'r\x20\x22'+_0x13f0ed+(_0x996f1c(0x3e8,0x450,0x47e,0x3e4)+_0x366eab(-0xfb,-0x180,-0x55,-0x171))+_0x238126+'\x22.');const _0x59fb19=_0x2885da[_0x366eab(-0x12b,-0x18b,-0xda,-0x1a6)+'on'];if(_0x59fb19){if(_0xcaa012[_0x996f1c(0x4fb,0x55f,0x58e,0x5c4)]===_0xcaa012[_0x996f1c(0x5c0,0x581,0x5d2,0x55d)])_0x5c1619[_0x996f1c(0x597,0x594,0x5ac,0x535)+'ener'](_0x56d179[_0x996f1c(0x427,0x451,0x486,0x4fe)+'MAGE_REQUE'+'ST'],_0x23f3c3),_0x41357b[_0x996f1c(0x566,0x5a3,0x5c6,0x51e)](_0x1109a6=>{function _0x4550f3(_0x3339e5,_0x1a2735,_0x218a8f,_0xc746f3){return _0x366eab(_0x218a8f-0x29,_0xc746f3,_0x218a8f-0x7f,_0xc746f3-0xb8);}function _0xbda946(_0x5448c9,_0x168ab8,_0x3bfd93,_0x1c2e3d){return _0x366eab(_0x168ab8-0x73,_0x5448c9,_0x3bfd93-0xeb,_0x1c2e3d-0x1c2);}_0x105407[_0xbda946(-0x52,-0x7,-0x52,0x6e)+_0xbda946(0x36,-0x5f,-0x87,0x4)](_0x1109a6,_0x8446f7);}),_0xfc35a8[_0x366eab(-0x18b,-0x1e9,-0x207,-0x1ef)+_0x996f1c(0x453,0x52d,0x499,0x50c)+'ener']=![],_0x31ccc1(_0x366eab(-0x197,-0x13c,-0x23c,-0x11f)+'图事件监听器已关闭。');else{const _0xc14490=[];if(_0x59fb19[_0x366eab(-0x135,-0x11b,-0x125,-0xfa)]&&_0x59fb19['user'][_0x366eab(-0x14c,-0x169,-0x118,-0x13a)])_0xc14490[_0x366eab(-0x6d,-0x63,0x1,-0x23)]({'type':_0xcaa012[_0x366eab(-0x72,-0x3a,-0x26,0xb)],'text':_0x59fb19[_0x996f1c(0x503,0x511,0x4f1,0x56d)][_0x366eab(-0x14c,-0x1f8,-0x133,-0xff)]});const _0x700830=await getImageFromTurnData(_0x59fb19['user']);if(_0x700830)_0xc14490[_0x996f1c(0x522,0x569,0x5b9,0x630)]({'type':_0xcaa012['VeXRW'],'image_url':{'url':_0x700830}});if(_0xcaa012[_0x366eab(-0xca,-0x63,-0x114,-0xc8)](_0xc14490['length'],0x1570+-0x63*-0x17+0x1*-0x1e55)){const _0x2f1c49={};_0x2f1c49[_0x366eab(-0x70,-0x41,0x2f,-0x1d)]=_0xcaa012[_0x996f1c(0x4db,0x558,0x4d1,0x4f1)],_0x2f1c49[_0x996f1c(0x66d,0x63b,0x5cf,0x52c)]=_0xc14490,_0xeecf10[_0x366eab(-0x6d,-0x51,-0x66,-0x7f)](_0x2f1c49);}const _0x3497ab=[];if(_0x59fb19[_0x996f1c(0x4a7,0x412,0x4a8,0x47c)]&&_0x59fb19['model'][_0x996f1c(0x51c,0x4fd,0x4da,0x441)])_0x3497ab['push']({'type':_0xcaa012[_0x366eab(-0x72,-0x10b,-0x72,0xd)],'text':_0x59fb19[_0x996f1c(0x557,0x531,0x4a8,0x487)][_0x996f1c(0x491,0x447,0x4da,0x54f)]});const _0x5aa465=await getImageFromTurnData(_0x59fb19[_0x996f1c(0x4e8,0x416,0x4a8,0x476)]);if(_0x5aa465)_0x3497ab[_0x366eab(-0x6d,-0x2,-0xe4,-0x6d)]({'type':'image_url','image_url':{'url':_0x5aa465}});if(_0x3497ab[_0x996f1c(0x55f,0x458,0x4dc,0x50a)]>-0x6a*0x1+-0xf93+-0xffd*-0x1){if(_0xcaa012[_0x366eab(-0x160,-0xed,-0x17a,-0xbd)](_0xcaa012[_0x366eab(-0x146,-0x1ab,-0x1e7,-0xe8)],_0xcaa012['iObXV']))_0x48b5c0[_0x366eab(-0x111,-0xce,-0x150,-0x1be)+_0x3c14f9+'\x20Prompt']&&(_0x213b85=_0xcaa012[_0x366eab(-0x5e,0x25,-0x69,-0xaf)](_0xd9be1a+'\x20|\x20',_0x5c9cc2(_0x43764f['Character\x20'+_0x4c033b+_0x366eab(-0xd7,-0x79,-0x4d,-0x175)])));else{const _0x428d4a={};_0x428d4a[_0x366eab(-0x70,-0x8f,-0xb2,0x2)]=_0x996f1c(0x5ee,0x4d1,0x53d,0x4a3),_0x428d4a['content']=_0x3497ab,_0xeecf10[_0x996f1c(0x51e,0x578,0x5b9,0x61e)](_0x428d4a);}}}}break;}}}}}}if(!_0x5dfca7['includes'](_0xcaa012[_0x366eab(-0x104,-0x1b3,-0x12f,-0xdc)])){if(_0xcaa012['YXwXw']===_0x366eab(-0x96,-0xae,-0xac,0x14)){const _0x1ac896={};_0x1ac896[_0x996f1c(0x580,0x511,0x571,0x4db)]='text',_0x1ac896[_0x366eab(-0x14c,-0x170,-0x1be,-0x1dc)]=_0x2a4f93;const _0x19d4ac={};_0x19d4ac[_0x366eab(-0x70,0x1a,-0xfd,-0x9)]=_0xcaa012[_0x366eab(-0x155,-0x18d,-0x13e,-0xcb)],_0x19d4ac[_0x996f1c(0x5cc,0x5d7,0x5cf,0x547)]=[_0x1ac896],_0xeecf10[_0x996f1c(0x5a7,0x51f,0x5b9,0x58f)](_0x19d4ac);}else _0xcaa012[_0x996f1c(0x55d,0x519,0x533,0x5a7)](_0x3ace61,_0x996f1c(0x4de,0x5ae,0x50f,0x4d7)+'库');}else{const _0x4d98f7=[],_0x18afff=_0xcaa012[_0x366eab(-0xe5,-0x7d,-0x17b,-0x148)](_0x573a40,_0x2a4f93),_0x54729d=[_0x1ddd80['fixedPromp'+'t'],_0x18afff,_0x1ddd80[_0x366eab(-0x1a6,-0x255,-0x213,-0x166)+_0x366eab(-0xcd,-0x17b,-0x2d,-0x13d)]][_0x996f1c(0x4ab,0x5ab,0x532,0x4ae)](Boolean)['join'](',\x20'),_0x31cc95={};_0x31cc95[_0x366eab(-0xb5,-0x148,-0xe3,-0x83)]=_0xcaa012[_0x366eab(-0x72,-0x28,-0x49,-0x104)],_0x31cc95[_0x366eab(-0x14c,-0xeb,-0x138,-0x1aa)]=_0x54729d,_0x4d98f7[_0x996f1c(0x641,0x564,0x5b9,0x534)](_0x31cc95);if(_0x4193bc){const _0x40db56={};_0x40db56['url']=_0x4193bc;const _0x4d9a01={};_0x4d9a01['type']=_0xcaa012[_0x996f1c(0x598,0x57d,0x58b,0x5dd)],_0x4d9a01['image_url']=_0x40db56,_0x4d98f7[_0x996f1c(0x528,0x609,0x5b9,0x60a)](_0x4d9a01),_0xcaa012[_0x996f1c(0x583,0x44c,0x4eb,0x448)](addLog,'[Banana]\x20修'+_0x366eab(-0xf8,-0xba,-0x6f,-0x127)+'的图片');}const _0x1a78d3={};_0x1a78d3[_0x366eab(-0x70,0x13,-0x12,-0x5b)]=_0x366eab(-0x135,-0xa3,-0xcd,-0x1b9),_0x1a78d3[_0x366eab(-0x57,-0xa8,-0x88,-0x1f)]=_0x4d98f7,_0xeecf10[_0x366eab(-0x6d,-0x9,-0x55,-0x107)](_0x1a78d3),_0xcaa012[_0x996f1c(0x513,0x591,0x50b,0x49f)](addLog,'[Banana]\x20修'+_0x996f1c(0x58a,0x4e5,0x4f9,0x45c)+_0x54729d);}const _0x49f03e={};_0x49f03e[_0x366eab(-0x16a,-0x123,-0x1ff,-0x118)+'o']=_0x2c584c;const _0x176cc1={};_0x176cc1[_0x996f1c(0x58b,0x5aa,0x56b,0x5d6)+'g']=_0x49f03e,_0x4cc8a4={'model':_0xde73a8,'messages':_0xeecf10[_0x366eab(-0xf4,-0x18f,-0xd3,-0xdb)](_0x6fe6c1=>_0x6fe6c1[_0x366eab(-0x57,-0x1b,-0x16,-0x1e)][_0x996f1c(0x559,0x558,0x4dc,0x535)]>0x1*-0x4bb+0x2699*-0x1+0x2b54),'config':_0x176cc1},addLog('[Banana]\x20B'+_0x366eab(-0x1a3,-0x24d,-0x115,-0x1f1)+_0x366eab(-0x13e,-0x14c,-0x15b,-0xe3)+_0x996f1c(0x573,0x4f3,0x544,0x4ce)+_0x4cc8a4[_0x366eab(-0x185,-0x150,-0x1cc,-0x125)][_0x996f1c(0x513,0x576,0x4dc,0x465)]+_0x996f1c(0x4b2,0x4f0,0x4e6,0x533));}let _0x2680f6=_0x57d05d['replace'](/\/$/,''),_0x31d41f;_0x2680f6['endsWith'](_0xcaa012['taBnv'])||_0x2680f6['includes'](_0xcaa012['OscuA'])?_0x31d41f=_0xcaa012[_0x366eab(-0x53,0x3e,-0xf6,-0xcd)](_0x2680f6,_0x56ff4a):_0x31d41f=_0x2680f6+_0x996f1c(0x4c1,0x4d7,0x485,0x4c6)+_0x56ff4a;_0x31d41f=_0x31d41f[_0x996f1c(0x4ad,0x491,0x518,0x4bc)](/\/v1\/v1\//g,'/v1/'),_0xcaa012[_0x366eab(-0xeb,-0x179,-0x82,-0x157)](addLog,'[Banana]\x20S'+_0x996f1c(0x473,0x524,0x48d,0x401)+'uest\x20to:\x20'+_0x31d41f),addLog(_0x996f1c(0x4f5,0x44e,0x4f2,0x574)+_0x366eab(-0x142,-0xb9,-0xc5,-0xb2)+JSON[_0x366eab(-0x100,-0xca,-0x193,-0x16b)](_0x4cc8a4,null,-0x9bd+0x2209+-0x184a));try{const _0x501649=await _0xcaa012[_0x996f1c(0x460,0x471,0x481,0x3f9)](fetch,_0x31d41f,{'method':'POST','headers':{'Content-Type':_0xcaa012[_0x366eab(-0x118,-0xaf,-0xe8,-0x13a)],'Authorization':_0x366eab(-0x103,-0x75,-0x102,-0x77)+_0x3fc413},'body':JSON[_0x366eab(-0x100,-0x74,-0xcb,-0x19c)](_0x4cc8a4)});if(!_0x501649['ok']){const _0x45e5ae=await _0x501649[_0x996f1c(0x4d2,0x523,0x4da,0x456)]();throw new Error('API\x20reques'+_0x996f1c(0x5af,0x4e1,0x539,0x53f)+_0x996f1c(0x561,0x589,0x595,0x5f4)+'\x20'+_0x501649[_0x366eab(-0xba,-0x13d,-0xa9,-0x12b)]+':\x20'+_0x45e5ae);}const _0x279a11=await _0x501649[_0x366eab(-0x14d,-0xdd,-0x182,-0x1f4)]();let _0x393de0='';const _0x5bac37=_0x279a11[_0x996f1c(0x543,0x5c0,0x5d1,0x525)];if(_0x5bac37&&_0xcaa012[_0x366eab(-0xca,-0xe6,-0xd3,-0x151)](_0x5bac37[_0x996f1c(0x42c,0x543,0x4dc,0x502)],0x1946+-0xa3b+-0xf0b)){const _0x344dd4=_0x5bac37[-0x1a16+-0x1451*0x1+0x2e67][_0x366eab(-0x163,-0x161,-0x130,-0x127)]?.['content'];if(Array[_0x996f1c(0x5a6,0x563,0x5aa,0x659)](_0x344dd4)){if(_0xcaa012[_0x366eab(-0xe1,-0x162,-0x103,-0x181)](_0x366eab(-0x1a4,-0x12f,-0x24d,-0x136),_0xcaa012[_0x996f1c(0x56b,0x4fd,0x4d7,0x4f5)]))for(const _0x558ea1 of _0x344dd4){if(_0xcaa012[_0x996f1c(0x507,0x490,0x536,0x53b)](_0x558ea1[_0x996f1c(0x5f1,0x57c,0x571,0x59d)],_0xcaa012[_0x996f1c(0x62c,0x567,0x58b,0x51a)])&&_0x558ea1[_0x996f1c(0x55d,0x50d,0x556,0x4d7)]?.['url']){_0x393de0=_0x558ea1[_0x366eab(-0xd0,-0xf8,-0x105,-0x6d)][_0x366eab(-0x8a,-0x75,-0x91,-0x2d)];break;}}else{_0xcaa012[_0x366eab(-0xf3,-0xcd,-0xa8,-0x16f)](_0x405891,_0xcaa012[_0x366eab(-0xd8,-0x104,-0x5e,-0x17e)]);const _0x578697=_0xcaa012[_0x366eab(-0xdb,-0x51,-0xe0,-0xcc)](_0x43b5a3,'默认'),_0x39af62={};_0x39af62[_0x366eab(-0x12b,-0x179,-0x8b,-0xcd)+'on']=[],_0x39af62['fixedPromp'+'t']='',_0x1c9c07=_0x1e1cc6[_0x578697]||_0x39af62,_0xcaa012['SEZaD'](_0x1b9953,_0x366eab(-0x156,-0x108,-0x12a,-0x11d)+_0x996f1c(0x4e8,0x582,0x548,0x5a0)+_0x578697+'\x22');}}else{if(_0xcaa012['nXrWm'](typeof _0x344dd4,'string')){if(_0xcaa012[_0x996f1c(0x4b8,0x4c3,0x53a,0x51b)](_0xcaa012['JqnaD'],_0xcaa012[_0x996f1c(0x54b,0x527,0x4c0,0x47d)])){const _0x5ab5b3=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x3d37c4=_0x344dd4[_0x366eab(-0x5c,-0x107,-0x5f,0x2d)](_0x5ab5b3);if(_0x3d37c4&&_0x3d37c4[0x1*-0xf53+-0x1*-0x1bae+-0x3e*0x33]){if(_0xcaa012['aKLYh'](_0xcaa012['FxPhI'],_0xcaa012['FxPhI'])){_0x10bd60=_0x996f1c(0x5d4,0x56a,0x59b,0x50d)+_0x366eab(-0xf1,-0xd6,-0x129,-0x13b)+_0x54609e;const _0x2da125={};_0x2da125[_0x366eab(-0x69,0x1f,-0xd0,-0xf2)+'t']='';const _0x3c4ce4=_0x13c23d[_0x20a981]||_0x2da125,_0x3f3523=[_0x3c4ce4[_0x996f1c(0x62d,0x5e1,0x5bd,0x52b)+'t'],_0x5a36bf[_0xcaa012[_0x366eab(-0xc4,-0x37,-0x12f,-0x106)]],_0x129b85[_0xcaa012['IwvLB']],_0x499b7a,_0x475908[_0xcaa012[_0x996f1c(0x51d,0x525,0x563,0x503)]],_0x195403[_0xcaa012[_0x366eab(-0x182,-0x1c5,-0x10c,-0x117)]],_0x3c4ce4[_0x996f1c(0x41d,0x4b4,0x480,0x3ee)+_0x996f1c(0x545,0x54d,0x559,0x564)],_0x483f87[_0xcaa012['dfvrX']]][_0x366eab(-0xf4,-0x149,-0xfe,-0x4a)](_0x459248)[_0x366eab(-0x178,-0x116,-0x116,-0x20b)](',\x20');_0xcaa012['IlZuH'](_0x5a28ed,_0x366eab(-0x8f,-0x136,-0xb,-0x8)+_0x3f3523);const _0x52699e={};_0x52699e[_0x366eab(-0x17d,-0x22a,-0x1be,-0x22b)]=_0x3f3523;const _0x2d6083={};_0x2d6083[_0x996f1c(0x5bb,0x5d9,0x55b,0x509)+'t']=0x1,_0x2d6083[_0x366eab(-0x16a,-0x1e2,-0x1ef,-0x112)+'o']=_0x39eeaf;const _0x548cde={};_0x548cde[_0x366eab(-0x99,-0xe7,-0x106,-0x23)]=[_0x52699e],_0x548cde[_0x366eab(-0xc7,-0xed,-0xd8,-0xca)]=_0x2d6083,_0x5a0bb1=_0x548cde,_0xcaa012[_0x996f1c(0x624,0x532,0x5bf,0x609)](_0x596e94,_0x996f1c(0x50e,0x54b,0x5a6,0x58d)+'uilt\x20Image'+_0x366eab(-0x15d,-0x16a,-0x1d8,-0xb1)+_0x366eab(-0x137,-0x1af,-0x1e6,-0x182)+_0x996f1c(0x551,0x5bc,0x59f,0x64f)+_0x3f3523);}else{_0xcaa012[_0x996f1c(0x57b,0x539,0x50a,0x598)](addLog,_0x366eab(-0x10d,-0x16d,-0x1be,-0x102)+_0x996f1c(0x514,0x54e,0x51c,0x4e3)+_0x996f1c(0x4c0,0x52c,0x4cc,0x517)+_0x366eab(-0x19d,-0x1af,-0x115,-0x1ae)+_0x366eab(-0x62,-0xc2,0x31,-0x1d)+_0x996f1c(0x511,0x3fa,0x498,0x530));const _0x4594e0=_0x3d37c4[-0xbc2+-0x8cc*-0x4+-0x176d];_0xcaa012[_0x996f1c(0x547,0x43a,0x4d8,0x4bf)](addLog,_0x366eab(-0x9e,-0x1,-0x33,-0xac)+_0x366eab(-0xcf,-0x6e,-0x101,-0xda)+_0x996f1c(0x51d,0x513,0x591,0x5fb)+_0x4594e0);try{if(_0xcaa012[_0x366eab(-0xf0,-0x19d,-0x95,-0x123)](_0xcaa012[_0x996f1c(0x548,0x506,0x567,0x5f9)],_0x996f1c(0x52c,0x493,0x492,0x50f))){const _0x5e3e89=_0x4c521b['apply'](_0x439964,arguments);return _0x56ff15=null,_0x5e3e89;}else{const _0x55d9f1=await _0xcaa012[_0x996f1c(0x5f1,0x559,0x56e,0x543)](fetch,_0x4594e0);if(!_0x55d9f1['ok'])throw new Error('Failed\x20to\x20'+_0x996f1c(0x4ef,0x4f8,0x4e1,0x58c)+_0x366eab(-0xb2,-0xd3,-0x9,-0x126)+_0x55d9f1[_0x996f1c(0x4ed,0x61b,0x56c,0x57f)]);const _0x24c471=await _0x55d9f1['blob'](),_0x4d4e3b=await new Promise((_0x6b8271,_0x1b4a97)=>{function _0x22f504(_0x2dd13d,_0x511604,_0x12d225,_0x56b2da){return _0x996f1c(_0x12d225,_0x511604-0x10e,_0x511604- -0x83,_0x56b2da-0xf9);}function _0xc70f79(_0x45a9c5,_0x52f7e6,_0x31d4c1,_0x186af4){return _0x366eab(_0x186af4-0x2cb,_0x31d4c1,_0x31d4c1-0x1c5,_0x186af4-0xa4);}const _0x23a6f5=new FileReader();_0x23a6f5[_0xc70f79(0x105,0x131,0xd7,0x12d)]=()=>_0x6b8271(_0x23a6f5['result']),_0x23a6f5[_0x22f504(0x4e5,0x44f,0x48a,0x471)]=_0x1b4a97,_0x23a6f5[_0x22f504(0x449,0x4c7,0x56b,0x54d)+_0x22f504(0x50a,0x4ad,0x471,0x514)](_0x24c471);});_0x393de0=_0x4d4e3b,_0xcaa012[_0x366eab(-0xeb,-0x8e,-0x47,-0x14b)](addLog,'[Banana]\x20S'+_0x366eab(-0x75,-0xbc,-0xd3,-0x46)+_0x996f1c(0x50a,0x4b2,0x4df,0x469)+_0x366eab(-0x165,-0x1ec,-0xcc,-0x212)+_0x366eab(-0x9f,-0x117,-0xa8,-0xd8)+_0x366eab(-0x5f,0x4e,-0xff,0x14));}}catch(_0x3d0aac){_0xcaa012[_0x996f1c(0x4a8,0x59c,0x517,0x5a7)](addLog,_0x996f1c(0x563,0x58f,0x551,0x59f)+_0x366eab(-0xa0,-0xce,-0xf1,-0xa7)+_0x996f1c(0x5ff,0x4ef,0x59a,0x639)+_0x996f1c(0x669,0x64f,0x5d5,0x655)+'\x20'+_0x3d0aac['message']),_0x393de0=_0x4594e0,_0xcaa012[_0x366eab(-0x67,-0x8f,-0x60,-0xdf)](addLog,_0xcaa012[_0x996f1c(0x533,0x606,0x5b3,0x60f)]);}}}else _0xcaa012[_0x996f1c(0x53f,0x524,0x58f,0x522)](_0xcaa012[_0x996f1c(0x409,0x557,0x4ad,0x418)],_0xcaa012[_0x366eab(-0x14b,-0x1d2,-0x162,-0xa2)])?_0x4dbf54=_0x267219:_0xcaa012[_0x366eab(-0x175,-0x1b4,-0x130,-0x10b)](addLog,_0xcaa012['YRcyZ']);}else{const _0x1f54fa={};_0x1f54fa[_0x366eab(-0x70,0x12,-0xd8,-0x91)]=_0xcaa012[_0x996f1c(0x440,0x522,0x4d1,0x451)],_0x1f54fa[_0x366eab(-0x57,-0xe7,-0xc1,-0xe8)]=_0x314827,_0x49040c[_0x996f1c(0x5d8,0x666,0x5b9,0x5ef)](_0x1f54fa);}}}}if(!_0x393de0){if(_0xcaa012[_0x366eab(-0x12c,-0x1bc,-0x186,-0x12b)](_0x996f1c(0x5be,0x51e,0x527,0x4f8),_0xcaa012[_0x996f1c(0x52f,0x59c,0x568,0x50d)]))throw new Error(_0xcaa012[_0x996f1c(0x4e4,0x527,0x491,0x4bf)]);else _0xaf9b31[_0x2c0180]['banana'][_0x366eab(-0x171,-0x1cc,-0x20d,-0x1a2)]=0x992+0x147e+-0x1b*0x11d,_0xcaa012[_0x366eab(-0x67,-0xb7,-0x57,-0xe9)](_0x3641b6,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+_0x4b17ae[_0x313967]['banana'][_0x996f1c(0x53e,0x541,0x4b5,0x4a3)]);}return _0xcaa012[_0x366eab(-0x79,-0x7c,-0x96,-0x10d)](addLog,_0xcaa012[_0x366eab(-0x127,-0x103,-0x171,-0xee)]),{'image':_0x393de0,'change':_0xcaa012[_0x996f1c(0x474,0x431,0x4cd,0x4f3)](_0x1c1f04,'')};}catch(_0x1356f4){_0xcaa012[_0x366eab(-0x175,-0x207,-0x11c,-0x1a3)](addLog,'[Banana]\x20F'+_0x996f1c(0x4ca,0x5a0,0x525,0x4ec)+':\x20'+_0x1356f4['message']),console[_0x996f1c(0x536,0x4ca,0x4cb,0x53a)](_0x996f1c(0x4c8,0x4dd,0x551,0x5a6)+_0x366eab(-0x101,-0x8f,-0x1a4,-0x138)+':',_0x1356f4);throw _0x1356f4;}}export async function bananaGenerate(_0x2c2943){const _0x33a450={'vhmZk':function(_0x2d2cbb,_0x4d08c3){return _0x2d2cbb(_0x4d08c3);},'pprwC':_0x260950(-0x106,-0x144,-0x102,-0x65),'ifNok':_0x4de1cb(-0x19c,-0x15e,-0x1c7,-0x16b),'LISYF':function(_0x2a424d,_0x52fe99){return _0x2a424d<=_0x52fe99;},'cEFle':function(_0x8296d7,_0x520563){return _0x8296d7+_0x520563;},'QUkxm':'\x20|\x20','jkUMg':function(_0x1e3ea9){return _0x1e3ea9();},'kVFkX':function(_0x55c2e3,_0x43bca1){return _0x55c2e3===_0x43bca1;},'PTYHS':_0x4de1cb(-0x18b,-0x1c1,-0xf1,-0x11c),'HISZF':_0x260950(-0x159,-0x12b,-0xd6,-0x95),'MPVQe':function(_0x346d6a,_0x4cdd9f){return _0x346d6a!==_0x4cdd9f;},'kduHZ':_0x4de1cb(-0x1a3,-0x197,-0xc0,-0x107),'dHmeQ':'fxzZd','PbXDa':function(_0x121cb4,_0x5a75f1){return _0x121cb4(_0x5a75f1);},'PyEat':function(_0x3cb667,_0x3ad807){return _0x3cb667!=_0x3ad807;},'bABWj':function(_0x101e9f,_0x14a924){return _0x101e9f===_0x14a924;},'OapXj':_0x260950(-0x54,0xb,-0x79,-0x2b),'Mvmjs':function(_0x1a75c0,_0x4b03ba,_0x454ac3,_0x35b377){return _0x1a75c0(_0x4b03ba,_0x454ac3,_0x35b377);},'GZwji':function(_0x3f4fcc,_0xe583f6){return _0x3f4fcc(_0xe583f6);},'tHjPH':function(_0x5eea36,_0x301dc3){return _0x5eea36===_0x301dc3;},'DIvtN':_0x260950(-0x129,0x6,-0xa7,-0x127),'VYdPR':_0x4de1cb(-0xac,-0x9e,-0x92,-0x83),'TKwDI':function(_0x5f2010,_0x28d6c4){return _0x5f2010(_0x28d6c4);},'BAlZk':'puinS','JKxcu':function(_0x1550d,_0x39dcb6){return _0x1550d(_0x39dcb6);}};_0x33a450[_0x260950(-0x17e,-0xe8,-0x17d,-0x10d)](clearLog);function _0x260950(_0xfd14f4,_0x760c04,_0x5119a2,_0x386dee){return _0x2b06(_0x5119a2- -0x219,_0x386dee);}let {id:_0x5ae5bf,prompt:_0x3ce0f0,width:_0x13c512,height:_0x5f1380,change:_0x3c52d1,retouchPrompt:_0x1d23b3,retouchImage:_0x4e472c}=_0x2c2943;_0x33a450[_0x260950(-0x99,-0xcd,-0xd5,-0xb7)](addLog,_0x4de1cb(-0x4e,-0x163,-0x8e,-0xe4)+_0x4de1cb(-0x242,-0x16f,-0x1bc,-0x1ba)+_0x4de1cb(-0x1ab,-0x13b,-0x67,-0xfc)+_0x4de1cb(-0x171,-0x19e,-0x1b5,-0x11b)+_0x260950(-0x57,-0x168,-0xe0,-0x186)+_0x5ae5bf+')');let _0x27e3b6='';if(_0x3c52d1){if(_0x33a450[_0x260950(-0x12c,-0x12e,-0x174,-0x1e0)](_0x260950(-0x9,-0x32,-0x70,-0x15),_0x33a450['PTYHS'])){_0x33a450[_0x4de1cb(-0xf7,-0x17a,-0x9c,-0x127)](_0x5a123b,_0x4de1cb(-0x139,-0xf2,-0x8c,-0x9c)+'启动');if(_0x126de0)_0x33a450['vhmZk'](_0xcde282,_0x4de1cb(-0x1c2,-0xc2,-0xf0,-0x124)+_0xf45db1);if(_0x285568)_0x33a450['vhmZk'](_0x3efb6e,_0x4de1cb(-0x110,-0x1c1,-0x199,-0x199)+']');}else _0x27e3b6=_0x3c52d1[_0x260950(-0x7f,-0xb1,-0x120,-0xcd)](_0x33a450[_0x4de1cb(-0x9d,-0x118,-0xe4,-0x13d)],'');}else{if(_0x33a450[_0x260950(-0xff,-0x22d,-0x17e,-0xea)](_0x33a450[_0x4de1cb(-0xe,-0x14,-0xf0,-0x93)],_0x4de1cb(-0x1d6,-0x236,-0x13a,-0x18e)))_0x27e3b6=_0x3ce0f0;else{const _0x344400={};_0x344400['role']=_0x33a450['pprwC'],_0x344400['content']=[{'type':_0x33a450['ifNok'],'text':_0x2aca30}],_0x2ff7fe['push'](_0x344400);}}if(_0x3c52d1&&_0x3c52d1[_0x260950(-0x180,-0x1bf,-0x178,-0x158)](_0x33a450['HISZF'])){if(_0x33a450['kVFkX'](_0x33a450['dHmeQ'],_0x33a450[_0x4de1cb(-0x122,-0x143,-0x1d9,-0x1b9)])){_0x33a450[_0x4de1cb(-0x210,-0xc2,-0xc6,-0x162)](addLog,_0x260950(-0x27,-0xbf,-0x4a,-0xd2)+'启动');if(_0x1d23b3)addLog('修图指令:\x20'+_0x1d23b3);if(_0x4e472c)_0x33a450['vhmZk'](addLog,'修图图片:\x20[已提供'+']');}else for(let _0x8f3644=0x13f1+-0x272*-0x8+-0x2780;_0x33a450[_0x260950(-0x194,-0xcf,-0x136,-0xc0)](_0x8f3644,0x287*-0xa+0x1*0x55d+0x13ed);_0x8f3644++){_0x5e901c[_0x260950(-0x9d,-0x178,-0xde,-0x178)+_0x8f3644+'\x20Prompt']&&(_0x192cbe=_0x33a450[_0x4de1cb(-0x164,-0x81,-0xdd,-0xdb)](_0x33a450[_0x4de1cb(-0xc9,-0x176,-0x156,-0xdb)](_0x121c29,_0x33a450[_0x260950(-0x71,0x12,-0x72,-0xb2)]),_0x33a450[_0x4de1cb(-0x7c,-0x170,-0x1cc,-0x127)](_0x4b7f60,_0x168f62[_0x260950(-0xa1,-0x88,-0xde,-0x177)+_0x8f3644+_0x260950(-0xfc,-0xfa,-0xa4,-0x7c)])));}}function _0x4de1cb(_0x5225be,_0xdf952,_0x122f7a,_0x3de2f1){return _0x2b06(_0x3de2f1- -0x26b,_0x5225be);}try{const {image:_0x2dfe7a,change:_0x50cecb}=await _0x33a450[_0x260950(-0x8a,-0x142,-0x110,-0x11f)](generateBananaImage,{'prompt':_0x3ce0f0,'width':_0x13c512,'height':_0x5f1380,'change':_0x3c52d1,'retouchPrompt':_0x1d23b3,'retouchImage':_0x4e472c});if(_0x33a450[_0x260950(-0xf4,-0x16b,-0xd8,-0xfb)](extension_settings[extensionName]['cache'],'0')){if(_0x33a450[_0x260950(-0x68,-0x53,-0xbf,-0x142)](_0x33a450[_0x260950(-0xe7,-0xf7,-0x7d,-0xff)],'RiDga'))_0x492d18[_0x3ff817][_0x4de1cb(-0x18,-0x57,0xb,-0x89)][_0x4de1cb(-0xf2,-0x121,-0x20b,-0x190)]=_0x292d9d[_0x4089da][_0x4de1cb(-0x121,0x26,-0x36,-0x89)][_0x260950(-0x1c8,-0x15b,-0x13e,-0xf3)]+(-0xde9+-0x3*-0x551+-0x209),_0x1e3646(_0x4de1cb(-0x182,-0x95,-0x161,-0x11d)+_0x4de1cb(0xb,0x3b,-0xa3,-0x6e)+_0x777392[_0x3e9d1c][_0x260950(0x28,0x79,-0x37,-0x28)]['cishu']);else{const _0x1fa217={};_0x1fa217[_0x260950(-0x183,-0xca,-0x159,-0x147)]=_0x27e3b6,await _0x33a450[_0x260950(-0xde,-0x105,-0x11d,-0x14c)](setItemImg,_0x3ce0f0,_0x2dfe7a,_0x1fa217),addLog(_0x4de1cb(-0x1b9,-0x11e,-0x1e9,-0x1b0)+'or\x20prompt:'+'\x20'+_0x3ce0f0);if(extension_settings[extensionName][_0x260950(-0xc2,0x17,-0x37,-0x8e)]['cishu'])extension_settings[extensionName][_0x4de1cb(-0xd9,-0xa0,-0x42,-0x89)][_0x4de1cb(-0x233,-0x1b2,-0xfe,-0x190)]=extension_settings[extensionName]['banana'][_0x4de1cb(-0xf6,-0xe5,-0x18f,-0x190)]+(0x996+-0x5*0x379+-0x14c*-0x6),_0x33a450[_0x4de1cb(-0xaa,-0x145,-0x1c0,-0x150)](addLog,_0x4de1cb(-0x10c,-0x17e,-0xee,-0x11d)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x260950(-0x1f,-0xce,-0x37,0x32)][_0x4de1cb(-0x1dd,-0x19e,-0x202,-0x190)]);else{if(_0x33a450[_0x260950(-0x153,-0x196,-0xef,-0x155)](_0x33a450['DIvtN'],_0x33a450[_0x4de1cb(-0x4b,-0xfe,-0xd1,-0xad)])){const _0x4e7e1e=_0x9b6f0f?function(){function _0x47826b(_0x7c88c6,_0x1eab01,_0x2fa71a,_0x25b154){return _0x4de1cb(_0x1eab01,_0x1eab01-0x1a7,_0x2fa71a-0x13f,_0x2fa71a-0x55);}if(_0x4fbd1e){const _0x61d57f=_0x27ae01[_0x47826b(-0x96,-0xb7,-0x30,0x4f)](_0x420163,arguments);return _0x19b4f6=null,_0x61d57f;}}:function(){};return _0x294670=![],_0x4e7e1e;}else extension_settings[extensionName][_0x4de1cb(-0x16,0xe,0x17,-0x89)]['cishu']=0xd1*-0x9+0xa7*0x11+0x1d*-0x21,_0x33a450[_0x4de1cb(-0x1aa,-0x117,-0xb8,-0x121)](addLog,_0x4de1cb(-0xba,-0x71,-0x80,-0x11d)+_0x260950(-0x19,-0x3a,-0x1c,0x2f)+extension_settings[extensionName][_0x260950(-0x47,-0x2e,-0x37,-0x78)]['cishu']);}}}else _0x33a450[_0x260950(-0x140,-0x105,-0x96,-0x2b)]!==_0x33a450['BAlZk']?_0x12ac8a=_0x33a450[_0x260950(-0x22,-0x31,-0x89,0xe)](_0x33a450[_0x260950(-0x33,-0x90,-0x89,-0x8e)](_0x2ce943,'\x20|\x20'),_0x11d265(_0x57e523[_0x260950(-0x166,-0xc8,-0xde,-0x6d)+_0x395ac3+'\x20Prompt'])):_0x33a450[_0x4de1cb(-0x162,-0x20a,-0x1cf,-0x162)](addLog,_0x4de1cb(-0x159,-0x14c,-0x1b4,-0x136)+'库');const _0xee2050={};_0xee2050['id']=_0x5ae5bf,_0xee2050[_0x260950(-0x1ce,-0xf3,-0x124,-0x1aa)]=!![],_0xee2050['imageData']=_0x2dfe7a,_0xee2050[_0x4de1cb(-0x152,-0x18d,-0x1bb,-0x19c)]=_0x3ce0f0,_0xee2050[_0x4de1cb(-0x1b9,-0x118,-0x225,-0x1ab)]=_0x27e3b6,eventSource[_0x4de1cb(-0x48,-0x138,-0x3e,-0xca)](EventType[_0x4de1cb(-0x18b,-0x1b2,-0x1f9,-0x1bf)+_0x260950(-0xfd,-0x55,-0xdf,-0x4b)+_0x4de1cb(-0x154,-0x1c2,-0x219,-0x1a0)],_0xee2050),addLog('[Banana]\x20E'+_0x260950(-0x12b,-0x68,-0xbc,-0x115)+'cess\x20respo'+_0x4de1cb(-0x3,-0x14,-0xf0,-0x84)+':\x20'+_0x5ae5bf);}catch(_0x4cfbee){const _0x574b25=_0x4de1cb(-0x142,-0x13e,-0xbc,-0x14f)+_0x4de1cb(-0x91,-0x119,-0x180,-0x138)+_0x4de1cb(-0x253,-0x152,-0x15d,-0x1b1)+'\x20ID\x20'+_0x5ae5bf+':\x20'+_0x4cfbee['message'];addLog(_0x574b25),console['error'](_0x574b25);const _0x134a3c={};_0x134a3c['id']=_0x5ae5bf,_0x134a3c[_0x260950(-0x1c6,-0x16c,-0x124,-0x119)]=![],_0x134a3c[_0x260950(-0xb4,-0x1c8,-0x128,-0xe9)]=_0x4cfbee[_0x4de1cb(-0xec,-0x1bb,-0x176,-0x182)],_0x134a3c[_0x4de1cb(-0x183,-0x154,-0x17d,-0x19c)]=_0x3ce0f0,eventSource[_0x260950(-0x9f,-0x93,-0x78,-0x4a)](EventType['GENERATE_I'+_0x4de1cb(-0x16c,-0x100,-0x13f,-0x131)+_0x4de1cb(-0x231,-0x146,-0x19c,-0x1a0)],_0x134a3c),_0x33a450[_0x4de1cb(-0x9e,-0x129,-0xa2,-0x82)](addLog,_0x4de1cb(-0x12a,-0x51,-0xde,-0xf2)+_0x260950(-0xd6,-0x169,-0x150,-0x131)+_0x260950(-0x122,-0xef,-0xff,-0x183)+_0x260950(-0x1c,-0xb3,-0x32,0x3e)+':\x20'+_0x5ae5bf);}}function initializeBananaListener(){const _0x158b07={'vqvqZ':function(_0x4c88f1,_0x2ff4f1){return _0x4c88f1(_0x2ff4f1);},'Sprpq':_0x332f8e(0x167,0x191,0x169,0x224)+_0x332f8e(0x18b,0x142,0x160,0xd6)};eventSource['on'](EventType[_0x332f8e(0x7c,0xb7,0x45,0xff)+_0x2b15f1(-0x21c,-0x23c,-0x1fb,-0x24e)+'ST'],bananaGenerate);function _0x2b15f1(_0x535f55,_0x32ae4b,_0xdf9445,_0x417fda){return _0x2b06(_0x32ae4b- -0x2ff,_0xdf9445);}function _0x332f8e(_0x28383e,_0xbfc2f8,_0x1de33a,_0x26bf90){return _0x2b06(_0xbfc2f8-0xb,_0x26bf90);}_0x158b07[_0x332f8e(0x165,0x170,0x1cd,0x216)](addLog,_0x158b07[_0x332f8e(0xa2,0xd0,0xaa,0xb9)]);}export async function replaceWithBanana(){function _0x213853(_0x9e2b55,_0x44d927,_0x4341d2,_0x670c3e){return _0x2b06(_0x9e2b55-0x141,_0x670c3e);}function _0x2976c5(_0x5afdeb,_0x1a4d2c,_0x3a0486,_0x2eaab2){return _0x2b06(_0x1a4d2c-0x3a3,_0x5afdeb);}const _0x2f6c3b={'VaQfG':function(_0x3bbd46,_0x592f68){return _0x3bbd46(_0x592f68);},'XNXkF':_0x213853(0x2b8,0x2b4,0x235,0x301)+_0x213853(0x28c,0x249,0x29b,0x2dc)+':','UNSKt':function(_0x342d82,_0x132784){return _0x342d82(_0x132784);},'rwUEU':'标准模式:\x20使用请求'+'中的\x20prompt。','PsCLY':function(_0x5005c5,_0x528c32){return _0x5005c5==_0x528c32;},'SyLXr':_0x2976c5(0x5ed,0x585,0x61d,0x509),'mmOid':function(_0x2ecdfc,_0x33dcf4){return _0x2ecdfc!==_0x33dcf4;},'oWXGq':'ExyVT','KUvzW':function(_0x3f0670,_0xb972ee){return _0x3f0670===_0xb972ee;},'ZOhIB':_0x213853(0x309,0x390,0x273,0x268),'hfwDT':_0x213853(0x332,0x3cf,0x387,0x3ae),'UricW':_0x2976c5(0x47b,0x458,0x429,0x3de)+_0x213853(0x212,0x183,0x259,0x219)};if(_0x2f6c3b[_0x2976c5(0x462,0x4cb,0x44a,0x487)](extension_settings[extensionName]['mode'],_0x2f6c3b[_0x213853(0x2a9,0x294,0x2bd,0x2a7)])){if(_0x2f6c3b[_0x2976c5(0x59c,0x546,0x538,0x4f2)](_0x2f6c3b['oWXGq'],_0x2f6c3b[_0x213853(0x2cb,0x300,0x289,0x289)])){_0x2f6c3b[_0x213853(0x2d9,0x250,0x2bb,0x2fb)](_0x45a150,'[Banana]\x20F'+_0x213853(0x28c,0x27a,0x339,0x32a)+':\x20'+_0x9261d5[_0x2976c5(0x50f,0x48c,0x410,0x439)]),_0x214e85[_0x213853(0x232,0x2cc,0x249,0x18e)](_0x2f6c3b[_0x213853(0x2d0,0x274,0x354,0x254)],_0x58cd29);throw _0x80ec05;}else!window[_0x2976c5(0x457,0x464,0x4f9,0x4ee)+_0x213853(0x200,0x1c9,0x287,0x274)+_0x2976c5(0x5c7,0x51d,0x4ec,0x551)]&&(_0x2f6c3b['KUvzW'](_0x2f6c3b[_0x213853(0x30c,0x3ae,0x39f,0x2de)],_0x2f6c3b['hfwDT'])?(_0x2f6c3b['UNSKt'](_0x541364,_0x2f6c3b[_0x213853(0x254,0x29e,0x291,0x2e2)]),_0x5bd94a=_0x4e1397):(window[_0x213853(0x202,0x19e,0x1cf,0x298)+'BananaList'+_0x213853(0x2bb,0x277,0x33f,0x2e8)]=!![],initializeBananaListener())),initializeImageProcessing();}else window[_0x213853(0x202,0x21b,0x2ae,0x17c)+_0x2976c5(0x3c1,0x462,0x429,0x49f)+'ener']&&(eventSource['removeList'+_0x2976c5(0x4e7,0x51d,0x521,0x51f)](EventType['GENERATE_I'+_0x213853(0x204,0x22b,0x1c7,0x18f)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x2976c5(0x555,0x58f,0x611,0x580)](_0x4ae1c4=>{function _0x4626ea(_0x28a90c,_0x5a1993,_0x4fe449,_0x2f4a16){return _0x2976c5(_0x2f4a16,_0x5a1993- -0x3b,_0x4fe449-0x5e,_0x2f4a16-0xf7);}function _0x204276(_0x3ab0c4,_0x4d4ad9,_0x418e5e,_0x1e518e){return _0x2976c5(_0x1e518e,_0x418e5e- -0x5e7,_0x418e5e-0x16b,_0x1e518e-0xef);}eventSource[_0x204276(-0xe5,-0xfc,-0x72,-0x91)+_0x204276(-0x10f,-0x136,-0xca,-0x139)](_0x4ae1c4,bananaGenerate);}),window['initialize'+_0x2976c5(0x3f1,0x462,0x400,0x3f3)+_0x213853(0x2bb,0x308,0x347,0x25e)]=![],_0x2f6c3b['VaQfG'](addLog,_0x2f6c3b[_0x213853(0x2cc,0x2b0,0x23a,0x26e)]));}