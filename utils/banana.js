(function(_0x2cd4ee,_0xe78f98){function _0x53ed09(_0x2f205e,_0x431e8e,_0x45940b,_0x390a1f){return _0x151b(_0x390a1f-0x288,_0x2f205e);}function _0x5118b3(_0x5ec2b7,_0x3824c3,_0x4b58b4,_0x55abc8){return _0x151b(_0x3824c3-0x34e,_0x5ec2b7);}const _0x10dc62=_0x2cd4ee();while(!![]){try{const _0x322b8d=parseInt(_0x53ed09(0x44e,0x474,0x3bd,0x411))/(0x469*0x8+-0x8b9+-0x1a8e)+-parseInt(_0x5118b3(0x47f,0x472,0x3bd,0x44a))/(-0xe70+0xcb7+0x1bb)+parseInt(_0x53ed09(0x431,0x4c0,0x3c1,0x45f))/(0x1*0x5f+0x170f+-0x176b*0x1)+-parseInt(_0x5118b3(0x5e7,0x539,0x59e,0x4cc))/(0xc1a+-0xb22+-0xf4)+-parseInt(_0x5118b3(0x459,0x4e8,0x4c9,0x566))/(0x33*0x4b+0x18fd*0x1+-0x1*0x27e9)*(-parseInt(_0x5118b3(0x4e2,0x449,0x3af,0x4c1))/(0x71c+0xfa4+0x16ba*-0x1))+-parseInt(_0x5118b3(0x49e,0x4f9,0x505,0x4fc))/(0x1*0x543+-0x67*0x11+0x1*0x19b)+parseInt(_0x5118b3(0x42d,0x4e6,0x4dc,0x51a))/(-0x2*-0xdfb+-0x7b1+-0x6bf*0x3)*(parseInt(_0x5118b3(0x40c,0x3fd,0x3fa,0x43d))/(-0x1946+-0x1e3e+0x378d));if(_0x322b8d===_0xe78f98)break;else _0x10dc62['push'](_0x10dc62['shift']());}catch(_0x5f21df){_0x10dc62['push'](_0x10dc62['shift']());}}}(_0x2e24,0x6651d+0x23aa2+0x4d921*-0x1));const _0x1f4dfc=(function(){let _0xa24ad3=!![];return function(_0x28ecce,_0x9a68e9){const _0x463606=_0xa24ad3?function(){if(_0x9a68e9){const _0x340055=_0x9a68e9['apply'](_0x28ecce,arguments);return _0x9a68e9=null,_0x340055;}}:function(){};return _0xa24ad3=![],_0x463606;};}()),_0x2d6011=_0x1f4dfc(this,function(){const _0x340917={};function _0x183949(_0x32eeea,_0x5b6a60,_0x166e09,_0x39b679){return _0x151b(_0x39b679-0x73,_0x5b6a60);}_0x340917['ATWXK']=_0x183949(0x104,0x19e,0x1b5,0x146)+'+$';function _0x58c9c9(_0x294ba9,_0x4cc735,_0x53f023,_0x575c88){return _0x151b(_0x575c88- -0x1d5,_0x294ba9);}const _0x2c273f=_0x340917;return _0x2d6011[_0x183949(0x2b2,0x229,0x298,0x21b)]()['search'](_0x58c9c9(-0x158,-0x1a3,-0x199,-0x102)+'+$')[_0x58c9c9(-0xd3,0x91,0x55,-0x2d)]()['constructo'+'r'](_0x2d6011)[_0x183949(0x19c,0x278,0x13f,0x1e5)](_0x2c273f['ATWXK']);});_0x2d6011();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';function _0x151b(_0x3116b1,_0x4bb447){_0x3116b1=_0x3116b1-(-0x1*0x8b5+0x11c3+-0x87e);const _0x11e0ff=_0x2e24();let _0x2d072e=_0x11e0ff[_0x3116b1];if(_0x151b['dorveQ']===undefined){var _0x19a9c4=function(_0x2f631a){const _0x563606='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2248ed='',_0x182d62='',_0x1d9592=_0x2248ed+_0x19a9c4;for(let _0x587245=-0x15c8+-0xad5+0x209d,_0x4ca15e,_0x110e3b,_0x1e08a8=0xf6e+0x1546+-0x61e*0x6;_0x110e3b=_0x2f631a['charAt'](_0x1e08a8++);~_0x110e3b&&(_0x4ca15e=_0x587245%(0x13b7+-0x230b+0x3d6*0x4)?_0x4ca15e*(-0x24a3+0x1*0x61d+0x12f*0x1a)+_0x110e3b:_0x110e3b,_0x587245++%(-0x1f7a+0xd76+0x1208))?_0x2248ed+=_0x1d9592['charCodeAt'](_0x1e08a8+(-0x134f*-0x2+0x1cb9+-0x1*0x434d))-(0x15f3+0x1f63+0x2*-0x1aa6)!==-0x5e*0x60+-0x125*0x16+0x8a2*0x7?String['fromCharCode'](0x1*-0x12b5+-0x2*0x1381+0x5*0xbbe&_0x4ca15e>>(-(0x1*0x1ea2+0x64b+0x1*-0x24eb)*_0x587245&0x554+-0xb2f+0x12d*0x5)):_0x587245:0x3*0xc07+0x8d8+-0x2ced){_0x110e3b=_0x563606['indexOf'](_0x110e3b);}for(let _0x560a72=0x732+0x208b*-0x1+0x1959,_0x17559a=_0x2248ed['length'];_0x560a72<_0x17559a;_0x560a72++){_0x182d62+='%'+('00'+_0x2248ed['charCodeAt'](_0x560a72)['toString'](0x33*-0x6f+0x2*-0x493+-0x3*-0xa71))['slice'](-(-0x4d7+0x1*-0x8eb+0xdc4));}return decodeURIComponent(_0x182d62);};_0x151b['uPAHqC']=_0x19a9c4,_0x151b['sxNmof']={},_0x151b['dorveQ']=!![];}const _0x5ceb85=_0x11e0ff[0x990+0xc11+0x15a1*-0x1],_0x4c726e=_0x3116b1+_0x5ceb85,_0x1c519e=_0x151b['sxNmof'][_0x4c726e];if(!_0x1c519e){const _0x60b6af=function(_0x5c04d0){this['OeCaZF']=_0x5c04d0,this['yQfXpX']=[-0x2*0x80d+-0x6ff+0x171a,-0x13f3+-0x347*-0x5+0x390,-0x25c3+-0x283*-0x1+-0x2*-0x11a0],this['PSrczK']=function(){return'newState';},this['RBNsWW']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['eMWFlj']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x60b6af['prototype']['snbGqG']=function(){const _0xecf1a1=new RegExp(this['RBNsWW']+this['eMWFlj']),_0x456b18=_0xecf1a1['test'](this['PSrczK']['toString']())?--this['yQfXpX'][0x1*-0x1f51+-0x1*-0x7ea+0x1ac*0xe]:--this['yQfXpX'][-0x18b9+0x20a6+-0x7ed];return this['HnxcIv'](_0x456b18);},_0x60b6af['prototype']['HnxcIv']=function(_0x12eb7f){if(!Boolean(~_0x12eb7f))return _0x12eb7f;return this['axPqLf'](this['OeCaZF']);},_0x60b6af['prototype']['axPqLf']=function(_0x27853e){for(let _0x36fccf=-0x2367+-0x11e8+0x354f,_0x241261=this['yQfXpX']['length'];_0x36fccf<_0x241261;_0x36fccf++){this['yQfXpX']['push'](Math['round'](Math['random']())),_0x241261=this['yQfXpX']['length'];}return _0x27853e(this['yQfXpX'][-0x1f71+0xab*-0x24+-0x1*-0x377d]);},new _0x60b6af(_0x151b)['snbGqG'](),_0x2d072e=_0x151b['uPAHqC'](_0x2d072e),_0x151b['sxNmof'][_0x4c726e]=_0x2d072e;}else _0x2d072e=_0x1c519e;return _0x2d072e;}import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';function _0x2e24(){const _0x5eee26=['A0XzvfO','55sO5lQgihVKV67LM759ioAGH+IVHG','igLTywDLihrVia','ywLizg8','zMLSDgvY','y29UDMvYDfrVsG','yMfUyw5HioEuN+wBVUs6IW','uMPqq1C','5zU+5QIH5BYp77YA5OYh5lUKid0G','DhLWzq','w0jHBMfUyv0Gsq','w0jHBMfUyv0Grq','yM5jC28','uMDyqLa','yxnZAxn0yw50','yMXVyG','C3rHDhvZ','y2HHDf9JB21WBa','ihWG','CgfYyw1LDgvYCW','zwnLAxzLzcbPBq','uvzMzfu','C2v0ici','CuLTCva','zw5LCMf0Aw9Uia','iIbMCM9TihbYzq','vxP1rKG','y2zNAw1NxW','qMfUyw5H5l+U5zU+5QIH5BYp','B3iGChjVBxb0oG','BwvZC2fNzxm','zw5KAw5NihjLCq','AxnbCNjHEq','zwrKzwqGyMfZzq','zMv0y2GGAw1HzW','DMvvthe','AgP5Dvq','ksbbChbSzvDLyG','BwfNzsbMCM9Tia','mc4WlJaUmcbtyq','Aw9U','zLnVreu','Aw1Hz2vjza','y1bnu2O','wvr1Eum','v2LUnJq7ihG2na','y3vZDg9Tx2LUyW','Aw1Hz2vFDxjS','B3nPDgLVBG','B3vUzcbTyxrJAa','z01vCui','w0jHBMfUyv0Gra','mtHfBLzfzhe','zxrPB25FC291CG','vvjm','l3yXlW','yxnWzwn0uMf0Aq','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','zw5LCG','DNf6te4','qxv0Ag9YAxPHDa','BIbWyxLSB2fKia','y2XPzw50','BwfNzsbPBIbpCa','t1vNuLG','DxbKyxrLu3rHDa','zM9YrwfJAa','Dg9mB3DLCKnHCW','D2L0AcbWCM9TCa','yMfUyw5Hq2HHCG','uM5KDLC','vff2uxa','B1Pjvxm','r0vorvjbvevFsq','mNWXFdr8m3WW','yK5lsw8','zw1PDa','DhjPBq','C3rYAw5N','C0Hzrgi','w0jHBMfUyv0GuG','w0jHBMfUyv0GrW','C21dtgW','ChvZAa','DxzhBNi','ELLWyMy','kerPDMLKzv9YBW','zfrTr2u','kcGOlISPkYKRkq','ANrNz2K','zgf0ytPPBwfNzq','B3f0rhO','icHlsfrntcWGBa','CuvcDeu','u05zsfa','BNrHAw5ZihrLEa','uvjxwuO','DxnLCG','y2vZCYbYzxnWBW','q2LVvfy','w0jHBMfUyv0G55sF','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','y3DHwhC','wMLTtge','s0TewfC','Aw1Hz2vU','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','ywDLifvstdOG','w0jHBMfUyv0GuW','C3rHCNrZv2L0Aa','w0jHBMfUyv0Gtq','C3rYAw5NAwz5','zML4zwrqCM9TCa','reDgyNC','zxnWB25ZzsbJBW','ue9uwKG','w0jHBMfUyv0G5y+w','u0Xuzhq','DgLVBIbYzxf1zq','Evzlquy','yLjQDuO','yxjRzg93BIbPBq','zgvSCY8','Ewv6ugq','De1hAvm','v29NvNa','v1z3CKO','ztOG','mJi3otq2sxLjvKfS','DcbMywLSzwqGDW','zxrLy3rLzcbnyq','kI8Q','qMvHCMvYia','l3yX','C3rYzwfT','rLbIC2G','B21WBgv0Aw9UCW','B25SB2fKzw5K','55sO5l+U5zU+6Ake6k6+oIaI','C3vIC3rYAw5N','w0jHBMfUyv0GqG','z3bZvu8','tLnf','DcbVBMX5lcbUBW','y2HVAwnLCW','sM9Iu0e','ChjVBxb0','ieLeia','ELbPywW','y3vZDg9Tx3vYBa','Bxb0','DxjS','Aw1Hz2u','l3yXl2nOyxqVyW','CM9Szq','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','tufhrv9srvnqtW','y29UDMvYC2f0Aq','CNnZrxa','y2fJAgu','sKP4B1C','Be5mwhq','vNL3q2q','DdOG','C2fTCgXLq291BG','yxLSB2fKoIa','rvzJDK8','tKPvzfq','AgX1vKi','nZiYodCWBeXvDevv','suHXEhu','AxrOihn0yxr1CW','CIbWCM9TChq6ia','wfHNvvm','AML1z3vHBG','BMrZl2nOyxqTyW','CLvsqKq','AvzrzNO','BgfKs2O','Be55uuO','CMTKB3DUigvTyG','55sO55U05O6L6k+35Rgc5QIH5BYp','zxrJAcbLCNjVCG','EfnhDKK','ig1LC3nHz2vZlG','Bw9KzwW','Aw5PDgLHBgL6zq','C3vJy2vZCW','B3DUigLTywDLoG','s2L0lZuZnY4ZnG','wefyBui','AwTLieDLy2TVkq','CMvWBgfJzq','ie5uideWlJa7ia','qw9fq1i','BKfItgm','q29UDgvUDc1uEq','qvbNtxG','55sO6yws6AAg5lUJ55cg5QIH5BYp','y3vZDg9T','zMfYAs81mZCUmW','BwfNzsbNzw5LCG','BhvYzsbYzxnWBW','B2fKihDPDgGG','qMfUyw5HtgLZDa','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','BgvUz3rO','EfnmCvi','y29UDgvUDa','BwfqzLi','zMXHDa','BwvZC2fNzq','BhvKzv9OzwfKzq','EsbJB252zxj0zq','CNvUBMLUzW','vg5OB1u','uhfos2O','u1PpDwe','yxrLzcbZDwnJzq','EsbLEhrYywn0zq','wMPiufC','CMvTB3zLtgLZDa','De9vvLO','DwLSDcbjBwfNzq','Bw9Kzq','5zco572U5zco','Dgv4Da','CNDNEhC','DLPKyKG','A0HbtvC','ywn0zxjqCMvZzq','wNb4sNC','rKLAsgu','5O6L6k+35Rgc','rKLxruS','Dg9Rzw4','ywLSzwqGDg8GzG','sw1yDhC','uKPrtLO','D0rTrKq','BwL0DgvKigzHAq','C2LUzYbKAxjLyW','ue9tva','5Q2J6z2I5O+q56s66k+noIa','5yMn572U5zco','ANnVBG','BwfNzw4G5QIH5z6l5lIn5PsV','C2vHCMnO','Dvnxtfi','w0jHBMfUyv0Gua','yMfZzty0lG','zgLdEu8','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','Cuj1veC','y2fUy2vSx2jHBG','5zon5BQuicHjrdOG','zcbIyxnLnJqGAq','BI9QC29U','DgLVBIb3AxrOia','u2nLBMuGq29TCa','w0jHBMfUyv0G5l2/','wvLdELa','zMfPBgvKigzVCG','BwfW','wuTICKK','sfnkEgO','yw9Srvy','Bw9KywWGCgf5Ba','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','yw5Hx3rHC2S','mtmZnduXqxfpyuvz','rMfPBgvKihrVia','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','tufhrv9srvfvrq','CgvNu3rVCMfNzq','wxrmBxm','CMvHzefZrgf0yq','ENfNCwu','qvbjihjLCxvLCW','ienOCM9Tzs8XmG','q2HHCMfJDgvYia','C3bSAxq','DgfYDgLUzYbPBq','y2HHBMDL','ywDLigDLBMvYyq','mJe4nZm5mMT2sNvisG','55sO5lQo55sF5OIq55QevgfNoIa','ndbxt2TuqMK','5l+U5zU+5OYh5lUKoIa','zfjsqw0','BhbMze0','yxnRsuq6ia','nJqGAw1Hz2uU','BKnky3a','uuPdB1C','yMfUyw5H','AM5OEvO','Dujrs3q','AePXsui','AMjdrfe','y2LZAhu','Dg9tDhjPBMC','r0vlsNC','wKnnz2y','mJGYmtq3nM1wtLzdBa','uernt00','ruLntMy','rejQvvu','zw5KC1DPDgG','ANHxCwq','CIaI','lI4U','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','EfnuzMK','zgjWzeu','DhjHy3rPBMCUlG','Aw1Hz2vdB25MAq','CMvWBgfJzufSBa','zxiG','qMHpCuq','w0jHBMfUyv0GrG','Aw9UoIaIqMvHCG','AM9PBG','DKXitg0','zxjYB3i','C3rFy2HHDhu4xW','qLfXwgG','5lU75yQH5BEY5y+w5RAi','Aw5ZDgfUy2vZ','CMTKB3DUigLTyq','swfZqvC','wfLyqwW','BuDLEgS','BgvZktOG','zcbnyxjRzg93BG','55Qe5zU+54Mh','CK5bwfG','DhvtEwy','vxnLCI1bz2vUDa','C2uGzgLKig5VDa','ENvZtK4','Bw9KzwW6ia','qKfoqu5b','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','w0jHBMfUyv0Gvq','wfzprg0','zxrJAcbnyxjRza','BNnLigzVCIbjra','ntK3mJG1tvD2BLz4','l2fWAs9IywnRzq','yxbWBhK','nhWWFdf8mNWZ','wxbev1i','ueTOCu4','zw5bssbMB3jTyq','wfnJtKK','veTOvue','zgXNBKe','y29TCgXLDgvuyq','DwnJzxnZzNvSBa','E+s/RUwBVN0','CMvZDwX0','zujlvhC','w0jHBMfUyv0G5Ps2','twfAyLa','5yMn572U5yMn','vLDzAgO','swfYAKG','nJG1ndyWtePHrgXi','l3yXyMv0ys9TBW','s054Be4','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','vffysgK','uMrUuNy','D1nUA1i','5lIT55QeihbYB21WDooaGG','Cg9ZDgzPEfbYBW','zKzTrvq','AuvKwwu','yvnireW','w0jHBMfUyv0G5l+U','ywrKvgfZAW','DgnHuKe','renxAeG','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','uMf1wgW','qxzSr2q','re5KsMK','wg95EK4','Aw5JBhvKzxm','C3qGkeLeoIa','ifbYB21WDa','ywvPEwi'];_0x2e24=function(){return _0x5eee26;};return _0x2e24();}import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function getDirectHeaders(_0x21abf9=null,_0x5e20a3=null){function _0x818fba(_0x394a21,_0xd8e658,_0x4d6c2d,_0xb379e){return _0x151b(_0xb379e-0x125,_0x394a21);}function _0x212968(_0xc9a8fb,_0x2608bd,_0x38dc46,_0x582b23){return _0x151b(_0x2608bd-0x71,_0xc9a8fb);}const _0x3d3ed8={};_0x3d3ed8[_0x818fba(0x165,0x155,0x15f,0x200)]='Content-Ty'+'pe',_0x3d3ed8[_0x212968(0x159,0x14f,0x153,0xc7)]=_0x818fba(0x263,0x255,0x222,0x1dc)+_0x212968(0xab,0x114,0xa5,0x143);const _0x5d8484=_0x3d3ed8,_0x1bce4b={};_0x1bce4b[_0x818fba(0x329,0x384,0x249,0x2f2)]='Mozilla/5.'+'0\x20(Windows'+_0x818fba(0x19e,0x21e,0x1de,0x261)+_0x212968(0x118,0x119,0x1ad,0x16d)+_0x818fba(0x132,0x19b,0x1ed,0x1c5)+_0x212968(0x131,0x1a9,0x264,0x162)+_0x212968(0xaf,0x148,0x12d,0xb2)+_0x212968(0x12f,0x1ab,0x1e6,0xf4)+_0x212968(0x245,0x203,0x1ea,0x2a7)+_0x212968(0xb2,0x113,0x173,0xf8)+_0x212968(0x13f,0x1b4,0x173,0x137)+'6',_0x1bce4b['Accept']=_0x818fba(0x284,0x268,0x193,0x223);const _0x49addc=_0x1bce4b;return _0x21abf9&&(_0x49addc[_0x5d8484[_0x212968(0x121,0x14c,0x9b,0x1a1)]]=_0x21abf9),_0x5e20a3&&(_0x49addc[_0x5d8484['CioTV']]=_0x5e20a3),_0x49addc;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x1b6c4e){function _0x3f4a0c(_0x3f0fba,_0xdcb6bc,_0x58a72f,_0x4cec17){return _0x151b(_0x58a72f- -0x81,_0x4cec17);}const _0x2383b5={};_0x2383b5[_0x3f4a0c(0xae,0x19b,0x11b,0x142)]=_0x43470e(-0xe4,-0x99,-0x4d,0x35);const _0x5c34b7=_0x2383b5;function _0x43470e(_0x5e7bb0,_0x411f00,_0x47643a,_0x545e7b){return _0x151b(_0x47643a- -0xe3,_0x5e7bb0);}if(!_0x1b6c4e)return'';if(_0x1b6c4e[_0x3f4a0c(0x27,0x54,0x24,0x9e)]&&_0x1b6c4e[_0x43470e(-0x38,-0x24,-0x3e,0x68)][_0x3f4a0c(0xdc,-0x1,0x67,0x42)](_0x5c34b7[_0x3f4a0c(0x15b,0x151,0x11b,0x6e)])){const _0x37f863=await getConfigImage(_0x1b6c4e['imageId']);return _0x37f863||'';}if(_0x1b6c4e[_0x3f4a0c(0x5e,0xdc,0x92,0x67)]&&_0x1b6c4e['image']['startsWith']('data:image'))return _0x1b6c4e[_0x43470e(-0x2d,-0x2f,0x30,0x28)];return'';}async function generateBananaImage({prompt:_0x20207b,width:_0x25730b,height:_0x3cd1c6,change:_0x5b1384,retouchPrompt:_0x3f1246,retouchImage:_0x56051c}){const _0x2ae92e={'YpDWR':function(_0x1de511,_0x2bf65b){return _0x1de511+_0x2bf65b;},'sHYDb':_0x218d49(0x25e,0x38e,0x2f4,0x287),'xSTfi':function(_0x3f2f8f,_0x48fc11){return _0x3f2f8f||_0x48fc11;},'SLTdt':_0x218d49(0x3ff,0x2b6,0x351,0x35d),'oqtDz':function(_0x3f274a,_0x5b965a){return _0x3f274a(_0x5b965a);},'hluVB':_0x1fe26f(0x45c,0x4ac,0x4a3,0x3d2),'rURBD':_0x1fe26f(0x582,0x556,0x581,0x613)+_0x218d49(0x39c,0x2de,0x31e,0x298)+_0x1fe26f(0x4ad,0x429,0x548,0x44a)+'/generate','XVODm':function(_0x214050,_0x45b7b6){return _0x214050(_0x45b7b6);},'DCWhH':_0x218d49(0x373,0x33c,0x2d8,0x36c),'XScNI':function(_0x34e6df,_0x4d72c6){return _0x34e6df(_0x4d72c6);},'dbpdE':'applicatio'+_0x1fe26f(0x526,0x4da,0x521,0x526),'xSGvI':'{修图}','ZpxJw':'分角色模式:\x20解析带'+'坐标的提示词字符串。','zYpbf':_0x1fe26f(0x528,0x4ea,0x553,0x4ac)+_0x218d49(0x222,0x337,0x29f,0x259),'VWYhj':function(_0x46952b,_0x278189){return _0x46952b+_0x278189;},'lNyQJ':function(_0x4964fb,_0x494f7f){return _0x4964fb(_0x494f7f);},'YYCzP':_0x1fe26f(0x56c,0x535,0x4d0,0x4f9),'aeiyb':'user','zFHoo':function(_0x34ef51,_0x5d5488){return _0x34ef51(_0x5d5488);},'FPbsh':_0x1fe26f(0x57d,0x518,0x50f,0x5b5)+_0x218d49(0x35f,0x2e7,0x360,0x35d)+'t\x20URL\x20as\x20f'+'allback.','veULq':function(_0x44f85d){return _0x44f85d();},'GEKJw':function(_0x130ac7,_0x5e0d2d){return _0x130ac7+_0x5e0d2d;},'FIZHe':function(_0x476530,_0x4a4220){return _0x476530>_0x4a4220;},'bRjuJ':_0x1fe26f(0x55c,0x4a0,0x54b,0x528),'EIMNf':function(_0x36e0bd,_0x512036){return _0x36e0bd(_0x512036);},'smCLl':function(_0x4cc1c6,_0x43242){return _0x4cc1c6(_0x43242);},'tuSyf':function(_0x2c1adf,_0x1cae4f){return _0x2c1adf||_0x1cae4f;},'XoyzN':function(_0x3869bc,_0x50c5e1){return _0x3869bc(_0x50c5e1);},'rmwDe':function(_0x1dab53,_0x5a2030){return _0x1dab53!==_0x5a2030;},'TQvQp':_0x1fe26f(0x514,0x533,0x585,0x57d),'nCJcp':function(_0x2927a4,_0x19ec52){return _0x2927a4(_0x19ec52);},'dTmGe':function(_0xd1aa5c,_0x860b51){return _0xd1aa5c<=_0x860b51;},'QVfdU':function(_0x1a3247,_0x3faea4){return _0x1a3247===_0x3faea4;},'IarjH':_0x1fe26f(0x4b9,0x4db,0x548,0x497),'rhpzX':_0x1fe26f(0x5a6,0x5dd,0x633,0x4f4),'aolEV':_0x1fe26f(0x479,0x4f7,0x409,0x4d8),'KNxlN':_0x218d49(0x351,0x32b,0x36b,0x3fe)+'中的\x20prompt。','lNLXt':function(_0x1523f5,_0x387635,_0x5c9c8a){return _0x1523f5(_0x387635,_0x5c9c8a);},'IgWGA':function(_0x4f1285,_0x1197a1){return _0x4f1285!==_0x1197a1;},'aiHdo':_0x1fe26f(0x4ea,0x4a2,0x4cd,0x5a1),'RndvW':_0x1fe26f(0x503,0x51d,0x4dd,0x488),'tcaRA':_0x218d49(0x415,0x47f,0x40a,0x35e),'ZimLa':_0x1fe26f(0x592,0x51b,0x5b8,0x62e),'jxWqd':_0x218d49(0x394,0x2b9,0x363,0x33c),'RjPCW':'后置前','fFmET':'最后置','jbCDQ':function(_0x357c16,_0x5a5fa8){return _0x357c16(_0x5a5fa8);},'SZOua':function(_0x34183c,_0xc588c4){return _0x34183c(_0xc588c4);},'gMUqB':_0x1fe26f(0x4be,0x545,0x4c9,0x542)+_0x218d49(0x2a9,0x3a7,0x2f7,0x250),'YKbrI':'[Banana]\x20启'+_0x218d49(0x396,0x372,0x3f9,0x3aa)+'。','jkBqn':_0x218d49(0x3cc,0x2e4,0x350,0x410),'CMzPd':function(_0x3fe4b4,_0x909efc){return _0x3fe4b4(_0x909efc);},'kawtl':function(_0x278e55,_0x111c7c){return _0x278e55(_0x111c7c);},'mGexk':'image_url','hSnUD':function(_0x4a153c,_0x8cf6a4){return _0x4a153c===_0x8cf6a4;},'DBjUU':_0x218d49(0x267,0x228,0x2ec,0x353),'rssEp':_0x1fe26f(0x43c,0x44c,0x4dc,0x3cb),'fSoDE':function(_0x462ed8,_0xcd1840){return _0x462ed8(_0xcd1840);},'RJQNZ':function(_0x2d9dde,_0x5b5302){return _0x2d9dde(_0x5b5302);},'QJCoW':_0x1fe26f(0x522,0x49a,0x4f3,0x504),'IasAW':_0x218d49(0x3a9,0x450,0x406,0x342),'jnhyZ':_0x1fe26f(0x53a,0x599,0x4ae,0x500),'aILkE':_0x1fe26f(0x4a1,0x45d,0x4a4,0x544),'wNKUU':function(_0x2b071c,_0x4f827e){return _0x2b071c(_0x4f827e);},'JobSA':function(_0x2f8a9d,_0x30a452){return _0x2f8a9d(_0x30a452);},'UNyut':function(_0x36aeb0,_0x4894c7){return _0x36aeb0(_0x4894c7);},'POTZH':function(_0x2ab134,_0xab44da){return _0x2ab134+_0xab44da;},'JJxoW':function(_0x38e4ab,_0x3bf280){return _0x38e4ab!==_0x3bf280;},'cPMSj':_0x218d49(0x3ee,0x49c,0x404,0x385),'nAbLc':_0x1fe26f(0x4d3,0x54e,0x42d,0x589),'rNAXX':_0x1fe26f(0x4ec,0x5a8,0x584,0x59c),'diCyO':function(_0x1cadb6,_0x54d90d){return _0x1cadb6===_0x54d90d;},'RdnRv':_0x218d49(0x35e,0x354,0x399,0x3a2),'xSLqR':_0x1fe26f(0x5a0,0x61b,0x555,0x542),'cwaXw':function(_0x3198db,_0x21ace7){return _0x3198db(_0x21ace7);},'AoECR':function(_0x8d51c,_0x3ef881){return _0x8d51c>_0x3ef881;},'XAXmB':_0x1fe26f(0x5bb,0x544,0x537,0x5de),'wSnkR':'string','HSJxj':function(_0xd966af,_0x408bf6){return _0xd966af===_0x408bf6;},'XXgUS':_0x1fe26f(0x556,0x4fe,0x5bc,0x541),'lpfdM':function(_0x290a1e,_0x271e65){return _0x290a1e(_0x271e65);},'yVKAF':_0x1fe26f(0x458,0x4c0,0x4cf,0x432)+_0x218d49(0x2df,0x350,0x2f1,0x240)+_0x218d49(0x25f,0x385,0x323,0x2e0)+_0x218d49(0x342,0x26f,0x290,0x34c)+_0x218d49(0x446,0x308,0x393,0x3cf),'vLHLm':_0x218d49(0x390,0x2d5,0x2db,0x265)+_0x1fe26f(0x58c,0x5b2,0x545,0x5ce)+_0x1fe26f(0x500,0x557,0x578,0x4b8)+_0x1fe26f(0x525,0x477,0x580,0x52a)+_0x218d49(0x217,0x295,0x295,0x2ba)+'Markdown.','YTuyC':function(_0x5881a0,_0x47088f){return _0x5881a0(_0x47088f);},'ladKj':_0x1fe26f(0x458,0x516,0x410,0x3e0)+_0x1fe26f(0x4a7,0x487,0x50d,0x537)+_0x1fe26f(0x56e,0x502,0x5e9,0x59f)+'ge\x20URL,\x20ex'+_0x218d49(0x44b,0x338,0x3aa,0x33e)+'.','PKhqN':function(_0x36b30e,_0x1dd998){return _0x36b30e(_0x1dd998);},'BhOqD':function(_0x38b284,_0x3e6112){return _0x38b284===_0x3e6112;},'YtLms':function(_0x4fae4d,_0x30f570){return _0x4fae4d(_0x30f570);},'OUgRX':'true','TnhoU':function(_0x46bbd5,_0x4bbd37){return _0x46bbd5===_0x4bbd37;},'DNdJi':_0x1fe26f(0x599,0x4e3,0x53d,0x602),'rwgxw':function(_0x12b42a,_0xc7e4ee){return _0x12b42a(_0xc7e4ee);},'oZIUs':_0x1fe26f(0x475,0x3f3,0x46e,0x472)+_0x218d49(0x367,0x37c,0x2e1,0x247)+_0x1fe26f(0x484,0x4e8,0x449,0x4e2)+_0x1fe26f(0x4b4,0x422,0x45c,0x401)+'\x20image.','vZdbH':'API\x20respon'+_0x1fe26f(0x578,0x54b,0x5d1,0x55f)+'\x20contain\x20i'+_0x1fe26f(0x464,0x4b2,0x3cc,0x4f6)+_0x1fe26f(0x587,0x61b,0x5b9,0x5b6)+'t','iVQfz':function(_0x2b0e74,_0x9618b2){return _0x2b0e74(_0x9618b2);},'ZjHPW':function(_0x4ec3cc,_0x2a0b44){return _0x4ec3cc||_0x2a0b44;}};_0x2ae92e[_0x1fe26f(0x448,0x3ae,0x4ed,0x478)](clearLog);const _0x5f5911=taskQueue[_0x1fe26f(0x5a2,0x5c5,0x617,0x632)]({'name':_0x2ae92e[_0x1fe26f(0x553,0x5fb,0x4cb,0x4ed)](_0x2ae92e['xSTfi'](_0x20207b,'')[_0x218d49(0x24a,0x3b0,0x2fa,0x280)](-0x235*-0x11+-0x7d+-0x2508*0x1,-0x1*0x17c1+0xd5f*0x2+-0x2df),_0x20207b&&_0x2ae92e[_0x1fe26f(0x50d,0x5aa,0x513,0x592)](_0x20207b[_0x1fe26f(0x4f3,0x4a9,0x463,0x517)],0x24b8+-0x1acb+-0x9cf)?_0x2ae92e[_0x1fe26f(0x49d,0x4df,0x48c,0x3f7)]:''),'type':TaskType[_0x218d49(0x3c3,0x38c,0x3c5,0x378)],'prompt':_0x20207b});currentTaskId=_0x5f5911,_0x20207b=processCharacterPrompt(_0x20207b),_0x20207b=await stripChineseAnnotations(_0x20207b);let _0x9b709d=_0x5b1384;_0x5b1384=processCharacterPrompt(_0x5b1384),_0x5b1384=await _0x2ae92e[_0x1fe26f(0x57e,0x572,0x503,0x4f9)](stripChineseAnnotations,_0x5b1384),_0x2ae92e[_0x218d49(0x387,0x417,0x3a1,0x3c9)](addLog,'开始\x20Banana生'+'图流程。客户端为'+extension_settings[extensionName][_0x218d49(0x1fa,0x229,0x2ad,0x33b)]),_0x2ae92e[_0x1fe26f(0x477,0x4e8,0x3c5,0x516)](addLog,_0x1fe26f(0x5a5,0x5a2,0x567,0x53c)+'\x20'+_0x2ae92e['xSTfi'](_0x25730b,'默认')+',\x20高度\x20-\x20'+_0x2ae92e[_0x1fe26f(0x576,0x5bc,0x54c,0x633)](_0x3cd1c6,'默认')),_0x20207b=_0x5b1384&&_0x5b1384['trim']()!==''?_0x5b1384:_0x20207b,_0x2ae92e[_0x218d49(0x408,0x4ab,0x3f3,0x407)](addLog,_0x218d49(0x3af,0x3e1,0x38d,0x2fc)+_0x20207b);let _0x21a93b=![];function _0x218d49(_0x565f38,_0x53c434,_0x470627,_0x314b88){return _0x151b(_0x470627-0x1f4,_0x53c434);}_0x20207b['includes'](_0x2ae92e['zYpbf'])&&(_0x21a93b=!![]);_0x2ae92e[_0x1fe26f(0x4d8,0x47d,0x532,0x4e7)](addLog,'是否启用分角色模式\x20'+_0x1fe26f(0x47b,0x4ad,0x49e,0x4ff)+_0x218d49(0x409,0x365,0x3bc,0x47f)+_0x21a93b);let _0x582859={},_0x16957a='',_0x4219fb='';if(_0x21a93b){if(_0x2ae92e['rmwDe'](_0x2ae92e[_0x218d49(0x215,0x23c,0x2b6,0x2d5)],_0x1fe26f(0x591,0x4d9,0x5e1,0x5f0))){_0x2ae92e[_0x218d49(0x33c,0x389,0x394,0x449)](addLog,_0x2ae92e[_0x218d49(0x295,0x3cd,0x356,0x3c9)]),_0x582859=_0x2ae92e[_0x1fe26f(0x5a9,0x5cb,0x65b,0x63d)](parsePromptStringWithCoordinates,_0x20207b),_0x16957a=_0x582859[_0x2ae92e[_0x1fe26f(0x47a,0x497,0x4a3,0x4e8)]];for(let _0x5e4a33=0x19bf+0x1b73+-0x3531;_0x2ae92e[_0x1fe26f(0x47c,0x3b8,0x522,0x4be)](_0x5e4a33,0x1073+0x3*-0xc6d+-0x14d8*-0x1);_0x5e4a33++){_0x2ae92e[_0x1fe26f(0x43a,0x4c8,0x40f,0x3ee)](_0x2ae92e[_0x218d49(0x398,0x39f,0x3de,0x47e)],_0x2ae92e[_0x218d49(0x31b,0x43e,0x3de,0x3f3)])?_0x582859[_0x1fe26f(0x53d,0x5e8,0x5c1,0x521)+_0x5e4a33+_0x218d49(0x47f,0x403,0x3f6,0x433)]&&(_0x1fe26f(0x5a6,0x5c4,0x62d,0x5fc)!==_0x2ae92e['rhpzX']?(_0x76acbe[_0x1507dd]['banana']['cishu']=_0x4dca08[_0x49da2e][_0x218d49(0x33f,0x323,0x396,0x2f8)][_0x1fe26f(0x551,0x600,0x5b9,0x4fe)]+(-0xda1+-0x1*-0x9a7+0x3fb),_0x1a2de5(_0x1fe26f(0x535,0x4ae,0x492,0x58c)+_0x218d49(0x2e0,0x267,0x31b,0x369)+_0x14a502[_0x529708][_0x218d49(0x456,0x396,0x396,0x3ff)][_0x218d49(0x44d,0x302,0x39b,0x35d)])):_0x4219fb=_0x2ae92e[_0x1fe26f(0x553,0x4b7,0x4bb,0x491)](_0x2ae92e[_0x1fe26f(0x585,0x60b,0x530,0x593)](_0x4219fb,',\x20'),_0x582859['Character\x20'+_0x5e4a33+_0x1fe26f(0x5ac,0x5ad,0x5a3,0x51d)])):_0x5133f8=_0x2ae92e[_0x1fe26f(0x585,0x572,0x5ab,0x536)](_0x2ae92e[_0x1fe26f(0x585,0x5cf,0x5f0,0x4ca)](_0x47a8e9,_0x2ae92e[_0x218d49(0x2bb,0x1ff,0x2be,0x380)]),_0x4768e4);}}else _0x1778cb('标准模式:\x20使用请求'+_0x1fe26f(0x59c,0x659,0x61e,0x52c)),_0xa8b376=_0x47b187;}else{if(_0x2ae92e['rmwDe'](_0x2ae92e[_0x1fe26f(0x52f,0x5e1,0x52d,0x5cb)],_0x218d49(0x31a,0x341,0x3c3,0x43f)))_0x2ae92e[_0x1fe26f(0x5a9,0x66c,0x4e8,0x551)](addLog,_0x2ae92e[_0x218d49(0x465,0x40e,0x3e1,0x3c5)]),_0x16957a=_0x20207b;else{const _0x307539=[],_0xef591a=_0x2ae92e['xSTfi'](_0x814517,_0x47f08b),_0x3ca2d0=[_0xcc3a91[_0x218d49(0x377,0x2e5,0x2df,0x22a)+'t'],_0xef591a,_0x181b77['postfixPro'+_0x1fe26f(0x4bb,0x49e,0x57e,0x474)]][_0x218d49(0x36f,0x395,0x3fc,0x34d)](_0x6d2c6)[_0x218d49(0x319,0x46e,0x3b1,0x471)](',\x20'),_0x232573={};_0x232573[_0x1fe26f(0x5b7,0x5cf,0x514,0x5c6)]=_0x2ae92e[_0x218d49(0x2c0,0x389,0x2e4,0x36b)],_0x232573[_0x218d49(0x358,0x3da,0x351,0x2ac)]=_0x3ca2d0,_0x307539[_0x218d49(0x37b,0x362,0x2c2,0x310)](_0x232573);if(_0x42c44d){const _0x15615d={};_0x15615d[_0x218d49(0x3c6,0x259,0x306,0x2e9)]=_0x165df0;const _0x403d99={};_0x403d99[_0x218d49(0x34b,0x362,0x401,0x3ca)]=_0x1fe26f(0x454,0x4a1,0x482,0x3ab),_0x403d99['image_url']=_0x15615d,_0x307539[_0x218d49(0x22f,0x335,0x2c2,0x2f8)](_0x403d99),_0x2ae92e[_0x218d49(0x317,0x225,0x2ca,0x2e8)](_0x1cb56b,_0x1fe26f(0x5a1,0x530,0x5fd,0x509)+_0x218d49(0x35a,0x258,0x2d4,0x2a5)+_0x218d49(0x40c,0x3a1,0x3be,0x395));}const _0x4fc5fa={};_0x4fc5fa[_0x1fe26f(0x4bf,0x500,0x471,0x449)]=_0x218d49(0x30c,0x326,0x2d0,0x299),_0x4fc5fa[_0x1fe26f(0x4f5,0x4dd,0x476,0x462)]=_0x307539,_0x41a0ce['push'](_0x4fc5fa),_0x2ae92e[_0x218d49(0x258,0x31d,0x2ca,0x284)](_0x19814f,_0x1fe26f(0x5a1,0x59a,0x616,0x657)+'图模式：指令\x20=\x20'+_0x3ca2d0);}}let {modifiedPrompt:_0x364c0c,insertions:_0x3059d0}=await _0x2ae92e[_0x218d49(0x26d,0x3c3,0x310,0x389)](prompt_replace,_0x16957a,_0x4219fb);if(_0x21a93b){if(_0x2ae92e['IgWGA'](_0x1fe26f(0x59f,0x592,0x53e,0x51b),_0x2ae92e[_0x218d49(0x3fa,0x368,0x3fb,0x48d)]))for(let _0x1b47b4=-0x149*0x14+-0xdc2+-0x1*-0x2777;_0x2ae92e['dTmGe'](_0x1b47b4,-0x1c86*0x1+0x46b+0x19*0xf7);_0x1b47b4++){if(_0x582859[_0x218d49(0x3a4,0x404,0x387,0x426)+_0x1b47b4+_0x1fe26f(0x5ac,0x594,0x56a,0x645)]){if(_0x2ae92e[_0x218d49(0x296,0x1d4,0x284,0x2e6)](_0x2ae92e['RndvW'],_0x2ae92e[_0x1fe26f(0x46b,0x4b1,0x424,0x501)]))_0x364c0c=_0x2ae92e[_0x1fe26f(0x553,0x4bf,0x4ae,0x502)](_0x364c0c+_0x2ae92e[_0x1fe26f(0x5a3,0x609,0x59b,0x582)],_0x2ae92e[_0x218d49(0x31d,0x232,0x2c1,0x37a)](prompt_replace_for_character,_0x582859[_0x218d49(0x3ab,0x43c,0x387,0x3e2)+_0x1b47b4+_0x218d49(0x355,0x427,0x3f6,0x35e)]));else{const _0x473bdc=_0x10f433[_0x218d49(0x3c8,0x3dc,0x3cd,0x394)](_0x5e4591,arguments);return _0x185634=null,_0x473bdc;}}}else _0xc97619[_0x1fe26f(0x58b,0x503,0x51a,0x5e5)+'sk'](_0x11d895,![]);}function _0x1fe26f(_0x25e13b,_0x1c111b,_0x331631,_0x2cd1d1){return _0x151b(_0x25e13b-0x3aa,_0x1c111b);}const _0x48e6b4=extension_settings[extensionName][_0x218d49(0x339,0x423,0x396,0x3a6)],{model:_0x3bd892,apiUrl:_0x42bc2d,apiKey:_0x20ec52,conversationPresets:_0x3c0710,conversationPresetId:_0x329720,editPresetId:_0xdbd114,aspectRatio:_0x5d9879}=_0x48e6b4;_0x2ae92e[_0x218d49(0x246,0x2c7,0x2ca,0x2c0)](addLog,'[Banana]\x20S'+_0x1fe26f(0x53f,0x556,0x56f,0x57e)+_0x218d49(0x312,0x44d,0x38b,0x3e2)+_0x1fe26f(0x527,0x598,0x5b3,0x493)+_0x1fe26f(0x57a,0x5b4,0x522,0x579)+_0x3bd892);let _0x25ad33,_0x24457c;if(_0x3bd892[_0x1fe26f(0x492,0x4e9,0x41d,0x551)](_0x2ae92e[_0x1fe26f(0x5a4,0x514,0x551,0x620)])){_0x25ad33=_0x218d49(0x380,0x429,0x3e0,0x391)+_0x218d49(0x34e,0x29f,0x2e9,0x25f)+_0x3bd892;const _0x2ef6ad={};_0x2ef6ad['fixedPromp'+'t']='';const _0x2ecd85=_0x3c0710[_0x329720]||_0x2ef6ad,_0x416499=[_0x2ecd85['fixedPromp'+'t'],_0x3059d0[_0x2ae92e[_0x1fe26f(0x48c,0x4b2,0x3f8,0x43a)]],_0x3059d0[_0x2ae92e['jxWqd']],_0x364c0c,_0x3059d0[_0x2ae92e[_0x1fe26f(0x5b5,0x528,0x61c,0x5a9)]],_0x3059d0[_0x218d49(0x390,0x355,0x350,0x3d6)],_0x2ecd85[_0x218d49(0x481,0x3c3,0x3e7,0x39c)+'mpt'],_0x3059d0[_0x2ae92e['fFmET']]][_0x1fe26f(0x5b2,0x50b,0x5df,0x521)](Boolean)[_0x1fe26f(0x567,0x583,0x52f,0x4d2)](',\x20');_0x2ae92e[_0x218d49(0x33d,0x3d5,0x39a,0x361)](addLog,_0x1fe26f(0x518,0x507,0x57d,0x4c8)+_0x416499);const _0x2f91b9={};_0x2f91b9[_0x1fe26f(0x4b7,0x51d,0x498,0x4fc)]=_0x416499;const _0x1e879a={};_0x1e879a[_0x218d49(0x2dc,0x297,0x313,0x27f)+'t']=0x1,_0x1e879a[_0x1fe26f(0x45d,0x4fc,0x4b0,0x45e)+'o']=_0x5d9879;const _0x1c6b69={};_0x1c6b69[_0x1fe26f(0x56d,0x544,0x533,0x5a2)]=[_0x2f91b9],_0x1c6b69[_0x1fe26f(0x5c1,0x53c,0x676,0x63b)]=_0x1e879a,_0x24457c=_0x1c6b69,_0x2ae92e[_0x1fe26f(0x4fe,0x4ef,0x5a1,0x5a6)](addLog,_0x1fe26f(0x4b1,0x441,0x575,0x4e3)+_0x1fe26f(0x504,0x55d,0x52b,0x4a3)+_0x218d49(0x2d5,0x218,0x2ac,0x2d4)+_0x218d49(0x32b,0x1ee,0x2b3,0x254)+_0x218d49(0x26a,0x3c5,0x312,0x29e)+_0x416499);}else{_0x25ad33=_0x2ae92e[_0x218d49(0x2e2,0x273,0x2a1,0x1eb)];let _0xb0392d;if(_0x5b1384[_0x218d49(0x3b3,0x3d3,0x3f4,0x3c5)](_0x2ae92e['xSGvI'])){addLog(_0x2ae92e[_0x1fe26f(0x52d,0x577,0x586,0x535)]);const _0x47edae=_0x2ae92e['xSTfi'](_0xdbd114,'默认'),_0xb42ee6={};_0xb42ee6[_0x1fe26f(0x4c2,0x487,0x4ec,0x4e2)+'on']=[],_0xb42ee6['fixedPromp'+'t']='',_0xb0392d=_0x3c0710[_0x47edae]||_0xb42ee6,addLog(_0x1fe26f(0x529,0x4e6,0x482,0x577)+_0x1fe26f(0x4af,0x514,0x502,0x504)+_0x47edae+'\x22');}else{const _0x4b9898={};_0x4b9898[_0x218d49(0x36f,0x2ea,0x30c,0x3b3)+'on']=[],_0x4b9898[_0x1fe26f(0x495,0x4ca,0x442,0x423)+'t']='',_0xb0392d=_0x3c0710[_0x329720]||_0x4b9898;}const _0x85ed37=[_0xb0392d[_0x218d49(0x294,0x253,0x2df,0x33c)+'t'],_0x3059d0[_0x2ae92e['ZimLa']],_0x3059d0[_0x2ae92e[_0x1fe26f(0x55a,0x587,0x5e9,0x55d)]],_0x364c0c,_0x3059d0[_0x2ae92e[_0x1fe26f(0x5b5,0x50c,0x594,0x56e)]],_0x3059d0[_0x2ae92e['jkBqn']],_0xb0392d[_0x1fe26f(0x59d,0x520,0x635,0x5fa)+'mpt'],_0x3059d0[_0x2ae92e[_0x1fe26f(0x59e,0x54a,0x5cf,0x52a)]]][_0x1fe26f(0x5b2,0x59c,0x5f6,0x59b)](Boolean)['join'](',\x20');_0x2ae92e[_0x218d49(0x3e8,0x3e5,0x39a,0x3c1)](addLog,_0x218d49(0x3f8,0x2db,0x362,0x31b)+_0x85ed37);const _0x4d54b6={};_0x4d54b6[_0x218d49(0x2f9,0x268,0x309,0x247)]=_0x1fe26f(0x486,0x4c9,0x4ba,0x505),_0x4d54b6[_0x218d49(0x315,0x3e2,0x33f,0x354)]=[];const _0x3a54b4={};_0x3a54b4[_0x218d49(0x373,0x3a1,0x309,0x3b4)]=_0x1fe26f(0x5bc,0x52a,0x676,0x67f),_0x3a54b4[_0x218d49(0x3ff,0x298,0x33f,0x2be)]=[];const _0x29b75e=_0xb0392d[_0x1fe26f(0x4c2,0x462,0x47d,0x494)+'on'][_0x1fe26f(0x52c,0x580,0x511,0x47d)](_0x201633=>[_0x4d54b6,_0x3a54b4])[_0x1fe26f(0x4f7,0x4ce,0x496,0x48f)]();let _0x5e18d5=0x6b5*0x3+0x5f*-0x3f+0x342;for(const _0xda9cfa of _0xb0392d[_0x1fe26f(0x4c2,0x424,0x56a,0x49a)+'on']){if(_0xda9cfa['user']?.['text'])_0x29b75e[_0x5e18d5][_0x1fe26f(0x4f5,0x5b1,0x4af,0x4b0)]['push']({'type':_0x218d49(0x2be,0x375,0x351,0x3cc),'text':_0xda9cfa[_0x1fe26f(0x486,0x526,0x4e0,0x3d4)][_0x1fe26f(0x507,0x4ef,0x492,0x4a4)]});const _0x1fa1e0=await _0x2ae92e['CMzPd'](getImageFromTurnData,_0xda9cfa[_0x218d49(0x2f6,0x28b,0x2d0,0x344)]);if(_0x1fa1e0)_0x29b75e[_0x5e18d5][_0x218d49(0x2b7,0x2e6,0x33f,0x362)][_0x218d49(0x334,0x20c,0x2c2,0x236)]({'type':_0x1fe26f(0x454,0x4c6,0x4c6,0x3e1),'image_url':{'url':_0x1fa1e0}});_0x5e18d5++;if(_0xda9cfa[_0x218d49(0x3bc,0x2b7,0x328,0x3a0)]?.[_0x218d49(0x2b6,0x3ea,0x351,0x29c)])_0x29b75e[_0x5e18d5][_0x218d49(0x2da,0x3c4,0x33f,0x3fa)][_0x1fe26f(0x478,0x4f6,0x427,0x3c9)]({'type':_0x2ae92e[_0x1fe26f(0x49a,0x548,0x4d1,0x54e)],'text':_0xda9cfa[_0x218d49(0x385,0x381,0x328,0x31d)][_0x1fe26f(0x507,0x533,0x4e4,0x49e)]});const _0x293fbe=await _0x2ae92e['kawtl'](getImageFromTurnData,_0xda9cfa[_0x1fe26f(0x4de,0x4ba,0x548,0x588)]);if(_0x293fbe)_0x29b75e[_0x5e18d5][_0x218d49(0x330,0x39a,0x33f,0x37b)][_0x218d49(0x2e3,0x31b,0x2c2,0x21e)]({'type':_0x2ae92e[_0x1fe26f(0x571,0x5e2,0x56c,0x5aa)],'image_url':{'url':_0x293fbe}});_0x5e18d5++;}if(!_0x5b1384[_0x218d49(0x38c,0x3f4,0x3f4,0x3a7)](_0x1fe26f(0x58d,0x593,0x532,0x552))){const _0x586587=extension_settings[extensionName][_0x218d49(0x355,0x2cf,0x2b4,0x212)+_0x218d49(0x304,0x37f,0x355,0x3f6)+'ts']||{};for(const _0x2be0cd in _0x586587){const _0x34d76c=_0x586587[_0x2be0cd],_0x48ad70=(_0x34d76c['triggers']||'')[_0x1fe26f(0x53e,0x523,0x5c0,0x58f)]('|')['filter'](_0x1e67d3=>_0x1e67d3[_0x1fe26f(0x472,0x3bb,0x4b7,0x3c5)]()!=='');for(const _0x50443b of _0x48ad70){if(_0x85ed37[_0x218d49(0x307,0x231,0x2b2,0x373)+'e']()[_0x218d49(0x369,0x462,0x3f4,0x38b)](_0x50443b[_0x1fe26f(0x468,0x3da,0x48f,0x3cf)+'e']())){if(_0x2ae92e['hSnUD'](_0x2ae92e[_0x218d49(0x3cc,0x44a,0x3a2,0x412)],_0x2ae92e[_0x218d49(0x3a3,0x392,0x30d,0x25b)])){let _0x3594d8=_0x113be5;!_0x3594d8[_0x1fe26f(0x559,0x517,0x4ab,0x5ba)](_0x2ae92e[_0x1fe26f(0x474,0x45d,0x527,0x45e)])&&!_0x3594d8[_0x218d49(0x3f9,0x4b5,0x3f4,0x432)](_0x2ae92e['hluVB'])&&(_0x3594d8=_0x2ae92e[_0x1fe26f(0x585,0x573,0x5dd,0x4fc)](_0x3594d8,_0x1fe26f(0x4aa,0x3ed,0x53b,0x552)));_0x3594d8=_0x3594d8[_0x1fe26f(0x4e5,0x42d,0x50f,0x4ba)](/\/v1\/$/,_0x1fe26f(0x4aa,0x4df,0x408,0x464)),_0x5135b6=_0x2ae92e[_0x1fe26f(0x4d5,0x562,0x473,0x4ca)],_0xd26979=_0x2ae92e[_0x1fe26f(0x57e,0x531,0x528,0x5af)](_0x1685c2,_0x1835b5[_0x1fe26f(0x510,0x572,0x5d1,0x5c9)]);const _0x234829={};_0x234829[_0x218d49(0x41c,0x376,0x409,0x434)+_0x1fe26f(0x45a,0x50e,0x51d,0x4c7)+'ce']=_0x1fe26f(0x4ec,0x575,0x451,0x43e),_0x234829['custom_url']=_0x3594d8,_0x234829[_0x218d49(0x357,0x22a,0x29d,0x2b6)+_0x1fe26f(0x4f9,0x4d2,0x466,0x575)+'rs']='Authorizat'+_0x218d49(0x406,0x2ec,0x3b0,0x404)+_0x1fe26f(0x563,0x5c6,0x573,0x626)+_0x48a3b4+'\x22',_0x234829[_0x1fe26f(0x4de,0x53a,0x575,0x4ef)]=_0x57b9c4,_0x234829[_0x1fe26f(0x443,0x400,0x40d,0x404)]=_0x2a7ab8[_0x1fe26f(0x443,0x4b0,0x4ba,0x3f9)],_0x234829[_0x218d49(0x348,0x2f8,0x2f5,0x331)]=![],_0x5aca2c=_0x234829;if(_0x53d52c[_0x1fe26f(0x492,0x439,0x428,0x452)](_0x2ae92e['DCWhH'])){_0x2ae92e[_0x218d49(0x47f,0x430,0x3d2,0x46a)](_0x494360,_0x218d49(0x409,0x398,0x402,0x415)+_0x218d49(0x306,0x3d7,0x365,0x2e8)+_0x1fe26f(0x4f2,0x571,0x499,0x44d)+'接请求'),_0x4b9715=_0x57d30b;const _0x354a9c={};_0x354a9c['Content-Ty'+'pe']=_0x2ae92e['dbpdE'],_0x354a9c[_0x1fe26f(0x461,0x3a7,0x4a2,0x4df)+_0x218d49(0x336,0x2a3,0x297,0x357)]=_0x1fe26f(0x4a9,0x4c4,0x4cc,0x55f)+_0xcd0df7,_0xb694f5=_0x354a9c,_0x16520e=_0x462f0f;}_0x2ae92e[_0x218d49(0x406,0x3c1,0x3c8,0x3e8)](_0x5926de,'[Banana]\x20使'+_0x218d49(0x2df,0x3c7,0x335,0x296));}else{_0x2ae92e[_0x218d49(0x275,0x32a,0x298,0x302)](addLog,'[Banana]\x20F'+_0x1fe26f(0x456,0x40e,0x4d0,0x422)+'ing\x20trigge'+_0x218d49(0x3ae,0x2e7,0x3a5,0x3f5)+_0x50443b+(_0x218d49(0x2a3,0x21a,0x288,0x228)+_0x218d49(0x2d3,0x2eb,0x285,0x28b))+_0x2be0cd+'\x22.');const _0x4b640d=_0x34d76c[_0x1fe26f(0x4c2,0x56e,0x448,0x4fe)+'on'];if(_0x4b640d){const _0x3f26a8=[];if(_0x4b640d['user']&&_0x4b640d[_0x1fe26f(0x486,0x4fd,0x3fe,0x3ea)][_0x218d49(0x2ef,0x40a,0x351,0x34c)])_0x3f26a8[_0x1fe26f(0x478,0x480,0x529,0x4ad)]({'type':_0x2ae92e[_0x1fe26f(0x49a,0x425,0x502,0x55e)],'text':_0x4b640d[_0x218d49(0x318,0x242,0x2d0,0x362)]['text']});const _0x5d274d=await _0x2ae92e['smCLl'](getImageFromTurnData,_0x4b640d[_0x1fe26f(0x486,0x4ab,0x44f,0x525)]);if(_0x5d274d)_0x3f26a8[_0x218d49(0x2c0,0x33a,0x2c2,0x2b5)]({'type':_0x2ae92e[_0x218d49(0x37b,0x326,0x3bb,0x478)],'image_url':{'url':_0x5d274d}});if(_0x3f26a8[_0x1fe26f(0x4f3,0x57e,0x4d2,0x578)]>-0x5df+0x5a4+0x1*0x3b){const _0x6c7feb={};_0x6c7feb['role']='user',_0x6c7feb[_0x1fe26f(0x4f5,0x55b,0x544,0x490)]=_0x3f26a8,_0x29b75e['push'](_0x6c7feb);}const _0x5b2fa9=[];if(_0x4b640d[_0x218d49(0x335,0x3ae,0x328,0x3bd)]&&_0x4b640d[_0x218d49(0x2d1,0x37a,0x328,0x3ea)][_0x218d49(0x2b6,0x2eb,0x351,0x3df)])_0x5b2fa9[_0x1fe26f(0x478,0x49f,0x3b5,0x4df)]({'type':_0x218d49(0x34c,0x390,0x351,0x359),'text':_0x4b640d[_0x1fe26f(0x4de,0x47d,0x563,0x54a)][_0x1fe26f(0x507,0x470,0x476,0x58d)]});const _0x1d062c=await _0x2ae92e[_0x1fe26f(0x513,0x4b5,0x5bb,0x4ec)](getImageFromTurnData,_0x4b640d[_0x1fe26f(0x4de,0x573,0x4ea,0x4d3)]);if(_0x1d062c)_0x5b2fa9['push']({'type':_0x2ae92e['mGexk'],'image_url':{'url':_0x1d062c}});if(_0x2ae92e['FIZHe'](_0x5b2fa9[_0x1fe26f(0x4f3,0x465,0x4a8,0x50f)],-0x3b3*-0x5+-0x1*-0xa6d+-0x1cec)){if(_0x2ae92e['QJCoW']!==_0x2ae92e[_0x1fe26f(0x54b,0x4e3,0x519,0x536)])_0x3b9c34=_0x3474d8[_0x1fe26f(0x562,0x627,0x5af,0x5ea)](_0x2ae92e['xSGvI'],'');else{const _0x102726={};_0x102726[_0x1fe26f(0x4bf,0x50a,0x49f,0x55d)]=_0x2ae92e[_0x218d49(0x3aa,0x45c,0x3b9,0x338)],_0x102726[_0x218d49(0x2ce,0x3bf,0x33f,0x28b)]=_0x5b2fa9,_0x29b75e[_0x1fe26f(0x478,0x3bd,0x4ae,0x3b6)](_0x102726);}}}break;}}}}}if(!_0x5b1384[_0x1fe26f(0x5aa,0x576,0x5f1,0x512)](_0x2ae92e[_0x218d49(0x29d,0x334,0x326,0x275)])){const _0x1493e2={};_0x1493e2[_0x1fe26f(0x4bf,0x532,0x507,0x4d2)]=_0x2ae92e[_0x218d49(0x39c,0x4a7,0x3f7,0x42f)],_0x1493e2[_0x218d49(0x32e,0x333,0x33f,0x333)]=[{'type':_0x2ae92e[_0x218d49(0x2ea,0x22e,0x2e4,0x32b)],'text':_0x85ed37}],_0x29b75e[_0x218d49(0x319,0x292,0x2c2,0x254)](_0x1493e2);}else{if(_0x2ae92e[_0x1fe26f(0x54d,0x561,0x4a0,0x53b)]===_0x2ae92e['aILkE'])_0x2ae92e[_0x1fe26f(0x57e,0x506,0x59a,0x57b)](_0xf851f1,_0x218d49(0x295,0x2f5,0x30a,0x2ea)+'库');else{const _0x50e04d=[],_0x5b7ea3=_0x3f1246||_0x85ed37,_0x13c811=[_0xb0392d[_0x1fe26f(0x495,0x547,0x44d,0x3ea)+'t'],_0x5b7ea3,_0xb0392d[_0x218d49(0x432,0x49b,0x3e7,0x40d)+_0x218d49(0x358,0x3ae,0x305,0x2d6)]]['filter'](Boolean)[_0x218d49(0x355,0x3f0,0x3b1,0x379)](',\x20'),_0x2848cb={};_0x2848cb[_0x218d49(0x3da,0x417,0x401,0x456)]=_0x2ae92e[_0x1fe26f(0x49a,0x4ad,0x4cc,0x478)],_0x2848cb[_0x1fe26f(0x507,0x523,0x57a,0x4eb)]=_0x13c811,_0x50e04d[_0x218d49(0x29e,0x286,0x2c2,0x372)](_0x2848cb);if(_0x56051c){const _0x44eaf1={};_0x44eaf1[_0x218d49(0x2cc,0x242,0x306,0x319)]=_0x56051c;const _0x464afb={};_0x464afb[_0x218d49(0x48e,0x48b,0x401,0x44e)]=_0x2ae92e[_0x218d49(0x478,0x3c3,0x3bb,0x348)],_0x464afb[_0x1fe26f(0x454,0x4ec,0x4dc,0x3bb)]=_0x44eaf1,_0x50e04d[_0x218d49(0x2c6,0x2fe,0x2c2,0x325)](_0x464afb),_0x2ae92e['wNKUU'](addLog,_0x1fe26f(0x5a1,0x60c,0x614,0x641)+_0x218d49(0x354,0x250,0x2d4,0x22e)+'的图片');}const _0x49435f={};_0x49435f[_0x218d49(0x320,0x310,0x309,0x276)]=_0x2ae92e[_0x218d49(0x3f5,0x3ea,0x3f7,0x3d3)],_0x49435f[_0x218d49(0x2d8,0x374,0x33f,0x395)]=_0x50e04d,_0x29b75e[_0x218d49(0x2e7,0x203,0x2c2,0x241)](_0x49435f),_0x2ae92e[_0x218d49(0x34d,0x2f5,0x300,0x396)](addLog,_0x1fe26f(0x5a1,0x58b,0x5d9,0x616)+_0x1fe26f(0x5b6,0x615,0x535,0x50b)+_0x13c811);}}const _0x8fc841={};_0x8fc841[_0x218d49(0x2b5,0x2b6,0x2a7,0x263)+'o']=_0x5d9879;const _0x33f1fd={};_0x33f1fd[_0x1fe26f(0x561,0x4f7,0x59e,0x4e3)+'g']=_0x8fc841,_0x24457c={'model':_0x3bd892,'messages':_0x29b75e[_0x1fe26f(0x5b2,0x5eb,0x568,0x58b)](_0x3f3e0a=>_0x3f3e0a[_0x218d49(0x327,0x2c2,0x33f,0x3df)][_0x218d49(0x3de,0x283,0x33d,0x350)]>0xf5e+-0x16*0x155+-0x1*-0xdf0),'config':_0x33f1fd},_0x2ae92e['UNyut'](addLog,'[Banana]\x20B'+'uilt\x20multi'+_0x1fe26f(0x530,0x49c,0x4ae,0x53d)+_0x1fe26f(0x4f0,0x547,0x444,0x445)+_0x24457c[_0x1fe26f(0x443,0x43a,0x3c0,0x4db)][_0x1fe26f(0x4f3,0x560,0x48b,0x4e8)]+_0x218d49(0x3ea,0x3d1,0x327,0x3bc));}let _0x4cbda8=_0x42bc2d['replace'](/\/$/,''),_0x4d86c0;if(_0x4cbda8[_0x218d49(0x3f4,0x327,0x3a3,0x437)](_0x2ae92e[_0x1fe26f(0x474,0x49a,0x50a,0x44c)])||_0x4cbda8[_0x218d49(0x395,0x3c1,0x3f4,0x3bf)](_0x2ae92e['hluVB']))_0x4d86c0=_0x2ae92e[_0x218d49(0x2aa,0x298,0x2e2,0x389)](_0x4cbda8,_0x25ad33);else{if(_0x2ae92e[_0x218d49(0x251,0x329,0x30f,0x267)](_0x2ae92e[_0x1fe26f(0x450,0x3b1,0x4c2,0x4bf)],_0x1fe26f(0x4f6,0x58c,0x5ae,0x44b)))_0x4d86c0=_0x2ae92e[_0x1fe26f(0x498,0x42f,0x4eb,0x478)](_0x4cbda8+_0x2ae92e[_0x218d49(0x35c,0x232,0x2be,0x24d)],_0x25ad33);else{_0x248593(_0x2ae92e[_0x218d49(0x2bc,0x334,0x356,0x396)]),_0x496fb1=_0x2ae92e[_0x218d49(0x216,0x347,0x2ca,0x265)](_0x469d41,_0x4fe75c),_0x46467c=_0x4db9dd[_0x2ae92e['zYpbf']];for(let _0x40dd05=0x1d*0x50+0x152e+0x1*-0x1e3d;_0x40dd05<=0x2250+-0xf*0x5+0x1*-0x2201;_0x40dd05++){_0x3e6aff[_0x218d49(0x320,0x2ec,0x387,0x374)+_0x40dd05+'\x20Prompt']&&(_0x579848=_0x2ae92e[_0x218d49(0x45d,0x411,0x3dd,0x423)](_0x1c09d3,',\x20')+_0x27260b['Character\x20'+_0x40dd05+_0x218d49(0x488,0x497,0x3f6,0x3d2)]);}}}_0x4d86c0=_0x4d86c0[_0x218d49(0x320,0x3ee,0x32f,0x3bc)](/\/v1\/v1\//g,_0x2ae92e[_0x1fe26f(0x4cd,0x50a,0x4b2,0x4fa)]);const _0x1ae7a3=extension_settings[extensionName][_0x1fe26f(0x463,0x485,0x4ec,0x51c)];let _0x4ef31e,_0xcb2fd6,_0x2b9b16;if(_0x1ae7a3===_0x2ae92e[_0x1fe26f(0x4e8,0x4f0,0x4d1,0x477)]){let _0x1f2b51=_0x4cbda8;!_0x1f2b51[_0x1fe26f(0x559,0x555,0x4b6,0x4da)](_0x218d49(0x282,0x264,0x2f4,0x31e))&&!_0x1f2b51['includes'](_0x2ae92e[_0x218d49(0x330,0x3bc,0x317,0x2b6)])&&(_0x1f2b51=_0x1f2b51+_0x1fe26f(0x4aa,0x457,0x444,0x40d));_0x1f2b51=_0x1f2b51['replace'](/\/v1\/$/,_0x218d49(0x271,0x243,0x2f4,0x2e4)),_0x4ef31e=_0x2ae92e[_0x218d49(0x3cf,0x3d1,0x31f,0x2da)],_0xcb2fd6=_0x2ae92e[_0x218d49(0x3d1,0x417,0x394,0x3f2)](getRequestHeaders,window[_0x1fe26f(0x510,0x563,0x452,0x5be)]);const _0x1a000b={};_0x1a000b[_0x1fe26f(0x5bf,0x563,0x4fb,0x55d)+_0x1fe26f(0x45a,0x3d8,0x45f,0x3b5)+'ce']=_0x2ae92e[_0x1fe26f(0x575,0x584,0x568,0x60b)],_0x1a000b[_0x1fe26f(0x4ba,0x445,0x479,0x4cb)]=_0x1f2b51,_0x1a000b['custom_inc'+_0x218d49(0x351,0x3ac,0x343,0x299)+'rs']='Authorizat'+_0x218d49(0x315,0x3fa,0x3b0,0x406)+'er\x20'+_0x20ec52+'\x22',_0x1a000b[_0x218d49(0x2d4,0x2cf,0x328,0x3a1)]=_0x3bd892,_0x1a000b['messages']=_0x24457c[_0x1fe26f(0x443,0x4cd,0x47a,0x3cd)],_0x1a000b['stream']=![],_0x2b9b16=_0x1a000b;if(_0x3bd892[_0x1fe26f(0x492,0x532,0x414,0x512)](_0x218d49(0x29c,0x2d4,0x2d8,0x2a5))){if(_0x2ae92e[_0x1fe26f(0x520,0x5e3,0x5b2,0x48b)](_0x2ae92e[_0x1fe26f(0x59a,0x516,0x603,0x5c2)],_0x218d49(0x427,0x447,0x399,0x372))){_0x2ae92e['XVODm'](addLog,_0x218d49(0x429,0x356,0x402,0x492)+'magen\x20模型不支'+_0x218d49(0x334,0x364,0x33c,0x2bf)+'接请求'),_0x4ef31e=_0x4d86c0;const _0x201a21={};_0x201a21[_0x218d49(0x39c,0x369,0x333,0x2c3)+'pe']=_0x2ae92e[_0x1fe26f(0x55f,0x54c,0x598,0x5d3)],_0x201a21[_0x218d49(0x295,0x2f1,0x2ab,0x288)+_0x218d49(0x343,0x1f4,0x297,0x268)]=_0x1fe26f(0x4a9,0x4c7,0x430,0x47a)+_0x20ec52,_0xcb2fd6=_0x201a21,_0x2b9b16=_0x24457c;}else _0x2ae92e[_0x218d49(0x3ad,0x268,0x322,0x27e)](_0x5a283c,_0x218d49(0x221,0x2de,0x2e3,0x2e2)+_0x1fe26f(0x48f,0x3d9,0x423,0x432)+'响应\x20(ID:\x20'+_0x34ddf0+')'),_0x501705[_0x218d49(0x379,0x243,0x2bb,0x2d0)](_0x53d407[_0x218d49(0x2fb,0x20d,0x2b8,0x270)+_0x218d49(0x35f,0x2f6,0x30b,0x33d)+_0x218d49(0x365,0x2f3,0x2fd,0x27a)],{'id':_0x1f9e2a,'success':![],'error':_0x2ae92e[_0x1fe26f(0x52a,0x489,0x5c5,0x4ce)],'prompt':_0x2ae92e[_0x218d49(0x37d,0x40a,0x3a8,0x3bf)](_0x1e654c,'')}),_0x5add4b=null,_0x419188=null,_0x3d0a23=null;}_0x2ae92e[_0x1fe26f(0x588,0x64b,0x535,0x60d)](addLog,'[Banana]\x20使'+_0x1fe26f(0x4eb,0x4f5,0x57b,0x530));}else{if(_0x1fe26f(0x5a0,0x5ef,0x59e,0x5f4)!==_0x2ae92e[_0x1fe26f(0x4f4,0x44c,0x4a4,0x506)]){const _0x4f3969={};_0x4f3969[_0x218d49(0x2ce,0x27a,0x309,0x25e)]=_0x2ae92e[_0x218d49(0x40b,0x485,0x3f7,0x399)],_0x4f3969[_0x1fe26f(0x4f5,0x491,0x543,0x513)]=[{'type':_0x2ae92e[_0x1fe26f(0x49a,0x4d1,0x414,0x553)],'text':_0xd596f6}],_0x4380d2[_0x218d49(0x237,0x260,0x2c2,0x289)](_0x4f3969);}else _0x4ef31e=_0x4d86c0,_0xcb2fd6=_0x2ae92e[_0x1fe26f(0x4c6,0x49b,0x487,0x4b4)](getDirectHeaders,_0x2ae92e[_0x1fe26f(0x55f,0x57d,0x4fb,0x4d4)],_0x218d49(0x261,0x2db,0x2f3,0x343)+_0x20ec52),_0x2b9b16=_0x24457c,addLog(_0x1fe26f(0x529,0x47a,0x48a,0x5b7)+_0x1fe26f(0x4da,0x553,0x539,0x450));}_0x2ae92e['XScNI'](addLog,'[Banana]\x20S'+_0x218d49(0x231,0x2a1,0x28e,0x333)+'uest\x20to:\x20'+_0x4ef31e),_0x2ae92e[_0x218d49(0x389,0x247,0x2d5,0x343)](addLog,_0x218d49(0x2c7,0x33a,0x368,0x3aa)+_0x218d49(0x320,0x359,0x314,0x35f)+JSON[_0x218d49(0x30b,0x39e,0x2de,0x313)](_0x2b9b16,null,-0xea3+0x1a37*0x1+0x5c9*-0x2));try{taskQueue[_0x218d49(0x2c6,0x213,0x2b0,0x2bc)+'us'](_0x5f5911,_0x1fe26f(0x4fb,0x493,0x514,0x5a3));const _0x434619=await _0x2ae92e[_0x218d49(0x302,0x368,0x310,0x389)](fetch,_0x4ef31e,{'method':_0x218d49(0x37e,0x3e2,0x361,0x3a6),'headers':_0xcb2fd6,'body':JSON[_0x218d49(0x308,0x21b,0x2de,0x26e)](_0x2b9b16)});if(!_0x434619['ok']){const _0x4df676=await _0x434619[_0x1fe26f(0x507,0x51b,0x539,0x44a)]();throw new Error(_0x218d49(0x3a3,0x3e8,0x385,0x36b)+_0x1fe26f(0x4a6,0x461,0x473,0x555)+_0x1fe26f(0x4d0,0x54f,0x497,0x50b)+'\x20'+_0x434619[_0x1fe26f(0x5be,0x66f,0x5a4,0x4ff)]+':\x20'+_0x4df676);}const _0x52d781=await _0x434619[_0x1fe26f(0x51a,0x54c,0x595,0x4d7)]();let _0x1d12a1='';const _0x372b4b=_0x52d781[_0x1fe26f(0x4b5,0x521,0x4de,0x44c)];if(_0x372b4b&&_0x2ae92e[_0x1fe26f(0x4e7,0x528,0x433,0x423)](_0x372b4b[_0x218d49(0x2d0,0x372,0x33d,0x3d3)],-0xbf2+-0x10a2+0x4*0x725)){const _0x2b1543=_0x372b4b[0x11e*0x3+-0x1585+-0x122b*-0x1][_0x218d49(0x33f,0x358,0x342,0x36f)]?.[_0x1fe26f(0x4f5,0x4b6,0x45d,0x445)];if(Array[_0x1fe26f(0x445,0x4e5,0x476,0x400)](_0x2b1543))for(const _0x57aeac of _0x2b1543){if(_0x2ae92e[_0x1fe26f(0x43a,0x43a,0x445,0x3bd)](_0x57aeac[_0x1fe26f(0x5b7,0x5b7,0x51c,0x607)],_0x1fe26f(0x454,0x4c9,0x405,0x3d8))&&_0x57aeac['image_url']){if(_0x2ae92e[_0x218d49(0x3d4,0x372,0x32d,0x2f4)]!==_0x1fe26f(0x5bb,0x67f,0x639,0x524)){_0x4edbcc(_0x1fe26f(0x5b8,0x575,0x53d,0x53f)+_0x218d49(0x34c,0x322,0x365,0x2ce)+'持酒馆代理，切换为直'+_0x1fe26f(0x50e,0x494,0x58f,0x559)),_0x431d84=_0x780937;const _0x31007f={};_0x31007f[_0x218d49(0x3ea,0x33e,0x333,0x2ff)+'pe']=_0x2ae92e[_0x1fe26f(0x55f,0x620,0x4fe,0x5d9)],_0x31007f['Authorizat'+_0x218d49(0x2a0,0x222,0x297,0x218)]=_0x218d49(0x3af,0x2f8,0x2f3,0x230)+_0xbaa9f7,_0x2d3915=_0x31007f,_0x1e61d0=_0x49674d;}else{_0x1d12a1=_0x2ae92e[_0x218d49(0x226,0x310,0x284,0x23d)](typeof _0x57aeac[_0x1fe26f(0x454,0x4e9,0x3c8,0x47d)],_0x2ae92e[_0x218d49(0x461,0x34f,0x3e5,0x397)])?_0x57aeac[_0x218d49(0x2d2,0x34d,0x29e,0x31d)]:_0x57aeac[_0x218d49(0x263,0x2f9,0x29e,0x2eb)][_0x1fe26f(0x4bc,0x4dc,0x478,0x550)];break;}}}else{if(_0x2ae92e['HSJxj'](typeof _0x2b1543,_0x218d49(0x2ef,0x229,0x2bd,0x2a4))){const _0x212734=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x34417a=_0x2b1543['match'](_0x212734);if(_0x34417a&&_0x34417a[0x3*-0x2cf+0x145+0x2f*0x27]){if(_0x2ae92e[_0x1fe26f(0x520,0x58b,0x4a0,0x56f)](_0x2ae92e[_0x1fe26f(0x4d2,0x53b,0x500,0x472)],_0x218d49(0x3a9,0x39c,0x316,0x254)))_0x2ae92e[_0x1fe26f(0x57e,0x626,0x563,0x4c8)](_0x424b5b,_0x1fe26f(0x565,0x595,0x581,0x55e)+_0x1fe26f(0x511,0x58d,0x4c6,0x4cd)+_0x218d49(0x366,0x312,0x3c9,0x404)+'own\x20image:'+'\x20'+_0x252a45[_0x1fe26f(0x4f8,0x593,0x50d,0x451)]),_0x1eb6d3=_0x5ebde3,_0x2ae92e['zFHoo'](_0x5a2f53,_0x2ae92e[_0x218d49(0x277,0x2c2,0x2f6,0x2a3)]);else{const _0x53af73=_0x34417a[-0x1d76+0xf42+0xe35*0x1];if(_0x53af73[_0x218d49(0x25a,0x396,0x2dc,0x24b)](_0x218d49(0x2db,0x280,0x2c9,0x31c)+'/'))_0x2ae92e[_0x1fe26f(0x547,0x5cf,0x52a,0x4fd)](addLog,_0x2ae92e[_0x218d49(0x33e,0x33e,0x2e6,0x2db)]),_0x1d12a1=_0x53af73,addLog(_0x2ae92e[_0x218d49(0x3e1,0x44e,0x3b2,0x303)]);else{_0x2ae92e[_0x218d49(0x308,0x2b2,0x29b,0x22e)](addLog,_0x2ae92e[_0x1fe26f(0x4d7,0x49f,0x435,0x528)]),_0x2ae92e[_0x1fe26f(0x586,0x4c3,0x5e8,0x525)](addLog,_0x1fe26f(0x493,0x40b,0x4fe,0x518)+_0x1fe26f(0x49e,0x50c,0x3fb,0x400)+_0x1fe26f(0x490,0x53d,0x4f3,0x49b)+_0x53af73);try{const _0x5617d0=await fetch(_0x53af73,{'headers':_0x2ae92e[_0x218d49(0x322,0x2e6,0x292,0x241)](getDirectHeaders)});if(!_0x5617d0['ok'])throw new Error(_0x1fe26f(0x534,0x5f8,0x4e3,0x49a)+_0x218d49(0x2cf,0x328,0x291,0x2df)+_0x1fe26f(0x4a4,0x3fd,0x50c,0x40a)+_0x5617d0['status']);const _0x5edfb8=await _0x5617d0[_0x218d49(0x47a,0x39f,0x407,0x3b1)](),_0x415b64=await new Promise((_0x47d31a,_0x56a404)=>{const _0x18d30e=new FileReader();function _0x5d2413(_0x22306c,_0x2cef02,_0x2d9ab5,_0x23bbd8){return _0x1fe26f(_0x2d9ab5- -0x4b1,_0x23bbd8,_0x2d9ab5-0x20,_0x23bbd8-0x161);}_0x18d30e[_0x1ddcc9(-0x63,0x59,0x118,0x2a)]=()=>_0x47d31a(_0x18d30e[_0x1ddcc9(0x190,0x139,0x13f,0xe8)]),_0x18d30e['onerror']=_0x56a404;function _0x1ddcc9(_0x29380e,_0x409da5,_0x3d7969,_0x131936){return _0x218d49(_0x29380e-0x17e,_0x3d7969,_0x409da5- -0x29f,_0x131936-0xb);}_0x18d30e[_0x5d2413(0xd6,0x61,0x88,-0x2f)+_0x1ddcc9(0x95,0x6,-0x9c,-0x18)](_0x5edfb8);});_0x1d12a1=_0x415b64,_0x2ae92e[_0x1fe26f(0x564,0x5c9,0x5dd,0x527)](_0x2ae92e[_0x1fe26f(0x538,0x581,0x5eb,0x5eb)](String,extension_settings[extensionName][_0x218d49(0x366,0x49d,0x3fd,0x3a0)+_0x218d49(0x418,0x2be,0x381,0x3da)]),_0x2ae92e[_0x1fe26f(0x465,0x46c,0x3b7,0x518)])&&(_0x1d12a1=await convertImageToJpeg(_0x1d12a1)),addLog(_0x218d49(0x2f3,0x285,0x2db,0x388)+_0x218d49(0x490,0x342,0x3d6,0x374)+_0x218d49(0x2c8,0x2b7,0x344,0x32f)+_0x1fe26f(0x573,0x5f0,0x5d5,0x4fe)+_0x1fe26f(0x5b0,0x5d3,0x4ec,0x536)+_0x218d49(0x3b1,0x2c5,0x369,0x2c9));}catch(_0x24bcb6){if(_0x2ae92e[_0x1fe26f(0x4fc,0x50b,0x45c,0x564)]('bQXRI',_0x2ae92e[_0x1fe26f(0x5a8,0x4e7,0x5e4,0x56d)]))return _0x5bbaa3[_0x1fe26f(0x4bd,0x4fe,0x438,0x4e0)];else addLog(_0x218d49(0x3b4,0x400,0x3af,0x2f8)+_0x218d49(0x409,0x370,0x35b,0x32a)+_0x1fe26f(0x57f,0x56d,0x5f0,0x5b5)+_0x1fe26f(0x4e1,0x544,0x4fa,0x4b4)+'\x20'+_0x24bcb6[_0x218d49(0x355,0x3ca,0x342,0x2a3)]),_0x1d12a1=_0x53af73,_0x2ae92e[_0x1fe26f(0x508,0x4ee,0x4fd,0x533)](addLog,_0x2ae92e['FPbsh']);}}}}else _0x2ae92e[_0x218d49(0x2ff,0x2e8,0x2ca,0x2c2)](addLog,_0x2ae92e[_0x218d49(0x2c9,0x28e,0x2b7,0x22b)]);}}}if(!_0x1d12a1)throw new Error(_0x2ae92e[_0x218d49(0x32f,0x29f,0x353,0x32b)]);return _0x2ae92e[_0x1fe26f(0x4d6,0x518,0x4c0,0x46b)](addLog,_0x218d49(0x33e,0x398,0x402,0x38d)+_0x1fe26f(0x4ee,0x4db,0x4c0,0x515)+_0x1fe26f(0x4ff,0x54c,0x522,0x4bd)+'ssfully.'),taskQueue['completeTa'+'sk'](_0x5f5911,!![]),currentTaskId=null,{'image':_0x1d12a1,'change':_0x2ae92e[_0x1fe26f(0x501,0x56b,0x4eb,0x57a)](_0x9b709d,'')};}catch(_0x590afe){addLog('[Banana]\x20F'+_0x218d49(0x3e7,0x27b,0x325,0x37f)+':\x20'+_0x590afe[_0x1fe26f(0x4f8,0x558,0x561,0x4f6)]),console[_0x218d49(0x34b,0x380,0x3b3,0x359)](_0x1fe26f(0x565,0x558,0x5b9,0x4f9)+_0x1fe26f(0x4db,0x507,0x4c3,0x5a0)+':',_0x590afe);if(_0x2ae92e[_0x218d49(0x382,0x2d4,0x378,0x3e6)](_0x590afe[_0x1fe26f(0x4f8,0x546,0x471,0x50a)],_0x2ae92e['YYCzP'])){}else taskQueue[_0x1fe26f(0x58b,0x568,0x5aa,0x644)+'sk'](_0x5f5911,![]);currentTaskId=null;throw _0x590afe;}}export async function bananaGenerate(_0x13874c){const _0x4449f0={'SNYHP':function(_0x5e03a8,_0x4c78c2){return _0x5e03a8+_0x4c78c2;},'IHqxu':function(_0x5dfe82,_0x548bff){return _0x5dfe82(_0x548bff);},'gpsUO':function(_0x1446b3,_0x1b56ec){return _0x1446b3(_0x1b56ec);},'hjyuT':function(_0x5a67b7){return _0x5a67b7();},'kHAMW':function(_0x483ea6,_0x41ac70){return _0x483ea6===_0x41ac70;},'PqNKj':'ImXtw','qEBtE':'{修图}','AvlGd':function(_0x362e5f,_0x502863){return _0x362e5f!==_0x502863;},'WVwrJ':'DQuAx','BQqXh':function(_0x21f618,_0x37f55e){return _0x21f618(_0x37f55e);},'kLYTZ':function(_0x48ba4f,_0x31790b,_0x34d17b,_0x4868f7){return _0x48ba4f(_0x31790b,_0x34d17b,_0x4868f7);},'dlgnA':function(_0x2b37cf,_0x1597c8){return _0x2b37cf!==_0x1597c8;},'RcQss':'QNgCK','pLsLV':function(_0x4ce54a,_0x4d23b2){return _0x4ce54a(_0x4d23b2);},'ncJLh':function(_0x358a6b,_0x1e9cf2){return _0x358a6b(_0x1e9cf2);},'uSWLR':function(_0x168dd3,_0x35a60f){return _0x168dd3(_0x35a60f);},'eBKTw':function(_0x267536,_0x22db7f){return _0x267536(_0x22db7f);}};_0x4449f0[_0x5e983e(0x2b5,0x2ce,0x246,0x236)](clearLog);let {id:_0x190b29,prompt:_0xf513df,width:_0x590d43,height:_0x2f7742,change:_0x159491,retouchPrompt:_0x327e60,retouchImage:_0x205422}=_0x13874c;currentRequestId=_0x190b29,currentPrompt=_0xf513df,addLog(_0x2ecd67(-0x2a2,-0x19f,-0x263,-0x263)+_0x5e983e(0x42e,0x43c,0x432,0x3e3)+_0x5e983e(0x3ad,0x3c0,0x303,0x382)+_0x2ecd67(-0x1fb,-0x2aa,-0x23d,-0x29d)+_0x2ecd67(-0x7c,-0x71,-0x12d,-0xf2)+_0x190b29+')');function _0x2ecd67(_0xceddf,_0x27b741,_0x43cc9c,_0x3dd09f){return _0x151b(_0x43cc9c- -0x32e,_0x27b741);}let _0x1d989d='';function _0x5e983e(_0x568cfc,_0x3843b5,_0x580b0b,_0x5aa1e2){return _0x151b(_0x568cfc-0x216,_0x580b0b);}_0x159491?_0x4449f0[_0x5e983e(0x376,0x32b,0x3f9,0x39a)](_0x5e983e(0x37e,0x3fc,0x2d7,0x327),_0x4449f0[_0x5e983e(0x369,0x3d9,0x3ce,0x2b4)])?_0x1d989d=_0x159491[_0x5e983e(0x3ce,0x44d,0x3e9,0x44f)](_0x4449f0[_0x5e983e(0x2ee,0x318,0x38d,0x363)],''):_0x3b127a=_0x4449f0[_0x2ecd67(-0x296,-0x1cd,-0x255,-0x2d6)](_0x3b8b57,_0x551570):_0x1d989d=_0xf513df;if(_0x159491&&_0x159491[_0x2ecd67(-0xaa,-0x1b9,-0x12e,-0x1da)](_0x4449f0[_0x5e983e(0x2ee,0x2d9,0x2b2,0x393)])){if(_0x4449f0[_0x5e983e(0x413,0x439,0x379,0x417)](_0x5e983e(0x3c0,0x413,0x3ba,0x3bb),_0x4449f0[_0x2ecd67(-0x2ca,-0x24f,-0x235,-0x270)])){addLog(_0x5e983e(0x2ad,0x24c,0x33d,0x2b2)+'启动');if(_0x327e60)_0x4449f0[_0x2ecd67(-0x25d,-0x259,-0x209,-0x1c2)](addLog,_0x5e983e(0x3b1,0x398,0x2fe,0x38c)+_0x327e60);if(_0x205422)_0x4449f0[_0x5e983e(0x3d7,0x39a,0x3e5,0x37a)](addLog,_0x5e983e(0x39d,0x32e,0x443,0x3f4)+']');}else _0x4449f0[_0x2ecd67(-0x184,-0x196,-0x209,-0x183)](_0x529694,_0x5e983e(0x2e1,0x225,0x363,0x255)+_0x5e983e(0x303,0x368,0x34c,0x29c)+_0x2ecd67(-0x215,-0x286,-0x254,-0x1f4)+_0x5e983e(0x320,0x3d3,0x2ea,0x361)+'\x20image.');}try{const {image:_0x38cb34,change:_0x1c9aca}=await _0x4449f0['IHqxu'](generateBananaImage,{'prompt':_0xf513df,'width':_0x590d43,'height':_0x2f7742,'change':_0x159491,'retouchPrompt':_0x327e60,'retouchImage':_0x205422});if(extension_settings[extensionName][_0x2ecd67(-0x224,-0x266,-0x214,-0x288)]!='0'){const _0x3fe327={};_0x3fe327[_0x2ecd67(-0x106,-0x155,-0x198,-0x224)]=_0x1d989d,await _0x4449f0[_0x2ecd67(-0x118,-0x76,-0x12a,-0xa0)](setItemImg,_0xf513df,_0x38cb34,_0x3fe327),_0x4449f0[_0x2ecd67(-0x210,-0x20d,-0x226,-0x23b)](addLog,_0x5e983e(0x2ca,0x328,0x309,0x366)+_0x5e983e(0x2ae,0x302,0x289,0x36e)+'\x20'+_0xf513df);if(extension_settings[extensionName][_0x5e983e(0x3b8,0x42c,0x310,0x2f7)][_0x2ecd67(-0x1e7,-0x19d,-0x187,-0x1db)]){if(_0x4449f0[_0x2ecd67(-0x16b,-0xbb,-0x14e,-0x167)](_0x4449f0['RcQss'],_0x5e983e(0x337,0x2d7,0x3ca,0x2f2)))extension_settings[extensionName][_0x5e983e(0x3b8,0x3c3,0x410,0x365)][_0x5e983e(0x3bd,0x38c,0x432,0x33a)]=_0x4449f0['SNYHP'](extension_settings[extensionName][_0x5e983e(0x3b8,0x432,0x37d,0x2f7)]['cishu'],-0x1f57+-0x1eb3+-0x8dd*-0x7),_0x4449f0['pLsLV'](addLog,_0x2ecd67(-0x165,-0x1dc,-0x1a3,-0x1b4)+'r\x20prompt:\x20'+extension_settings[extensionName]['banana']['cishu']);else{const _0x3148c4='[Banana]\x20G'+_0x2ecd67(-0x232,-0x327,-0x29b,-0x233)+_0x2ecd67(-0x235,-0x193,-0x1ad,-0x101)+_0x2ecd67(-0x214,-0x1f4,-0x220,-0x2b8)+_0x2cde60+':\x20'+_0x474362[_0x5e983e(0x364,0x3ee,0x391,0x3de)];_0x4449f0['IHqxu'](_0x5de730,_0x3148c4),_0x1bd4ac[_0x2ecd67(-0x126,-0xba,-0x16f,-0x1ca)](_0x3148c4);const _0x30cf1a={};_0x30cf1a['id']=_0x17f223,_0x30cf1a[_0x5e983e(0x34c,0x2ab,0x2ea,0x2bb)]=![],_0x30cf1a[_0x2ecd67(-0x1a7,-0x11b,-0x16f,-0x1d9)]=_0x59721d[_0x5e983e(0x364,0x3e3,0x2db,0x38d)],_0x30cf1a[_0x2ecd67(-0x21c,-0x1cc,-0x221,-0x209)]=_0x390fc6,_0x1defc5[_0x5e983e(0x2dd,0x26f,0x253,0x395)](_0xa061f0[_0x5e983e(0x2da,0x318,0x22c,0x329)+'MAGE_RESPO'+_0x2ecd67(-0x2c1,-0x1ac,-0x225,-0x1df)],_0x30cf1a),_0x4449f0[_0x5e983e(0x31e,0x25e,0x301,0x2c0)](_0x17baa4,_0x5e983e(0x425,0x44f,0x394,0x4a8)+_0x5e983e(0x381,0x346,0x2ef,0x397)+_0x5e983e(0x35b,0x36a,0x3d4,0x39a)+_0x2ecd67(-0x1fd,-0x219,-0x158,-0xe9)+':\x20'+_0xa89bea);}}else extension_settings[extensionName][_0x2ecd67(-0x13b,-0x129,-0x18c,-0xea)][_0x5e983e(0x3bd,0x2f9,0x448,0x301)]=-0x1156+-0x173+0x172*0xd,_0x4449f0['ncJLh'](addLog,_0x5e983e(0x3a1,0x325,0x394,0x2f9)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x5e983e(0x3b8,0x385,0x320,0x445)][_0x2ecd67(-0x1fa,-0x1ad,-0x187,-0x1f9)]);}else _0x4449f0[_0x2ecd67(-0x150,-0x1b8,-0x209,-0x1e2)](addLog,_0x2ecd67(-0x203,-0x1d9,-0x218,-0x2af)+'库');const _0x71ad0e={};_0x71ad0e['id']=_0x190b29,_0x71ad0e['success']=!![],_0x71ad0e['imageData']=_0x38cb34,_0x71ad0e['prompt']=_0xf513df,_0x71ad0e[_0x2ecd67(-0x1e3,-0x1f6,-0x198,-0x23b)]=_0x1d989d,eventSource[_0x2ecd67(-0x1b5,-0x24b,-0x267,-0x29d)](EventType['GENERATE_I'+_0x5e983e(0x32d,0x382,0x270,0x2af)+_0x5e983e(0x31f,0x3c5,0x387,0x32d)],_0x71ad0e),_0x4449f0[_0x2ecd67(-0x1d9,-0x1d5,-0x226,-0x1aa)](addLog,_0x2ecd67(-0x166,-0x6b,-0x11f,-0xb2)+'mitted\x20suc'+_0x2ecd67(-0x29e,-0x2e1,-0x251,-0x2d1)+_0x2ecd67(-0x118,-0x19a,-0x158,-0x9f)+':\x20'+_0x190b29);}catch(_0x574d38){const _0x5a41a2=_0x2ecd67(-0x249,-0x26c,-0x262,-0x2f1)+_0x5e983e(0x2a9,0x354,0x2d4,0x276)+_0x2ecd67(-0x1e4,-0x143,-0x1ad,-0x1b1)+_0x5e983e(0x324,0x340,0x28a,0x297)+_0x190b29+':\x20'+_0x574d38[_0x5e983e(0x364,0x2ba,0x3b9,0x2c5)];_0x4449f0[_0x2ecd67(-0x1ee,-0x1b8,-0x1bb,-0x1f5)](addLog,_0x5a41a2),console[_0x2ecd67(-0x211,-0x173,-0x16f,-0x195)](_0x5a41a2);const _0x37d004={};_0x37d004['id']=_0x190b29,_0x37d004['success']=![],_0x37d004[_0x2ecd67(-0x148,-0x1d7,-0x16f,-0x187)]=_0x574d38[_0x5e983e(0x364,0x32c,0x311,0x3df)],_0x37d004[_0x5e983e(0x323,0x3b1,0x2b2,0x28f)]=_0xf513df,eventSource[_0x2ecd67(-0x29c,-0x1e2,-0x267,-0x23e)](EventType[_0x2ecd67(-0x292,-0x30e,-0x26a,-0x26b)+_0x2ecd67(-0x287,-0x1ed,-0x217,-0x268)+_0x5e983e(0x31f,0x260,0x332,0x3ca)],_0x37d004),_0x4449f0[_0x5e983e(0x3fb,0x423,0x476,0x393)](addLog,_0x2ecd67(-0x1d5,-0x1d8,-0x11f,-0xec)+_0x2ecd67(-0x11b,-0x15f,-0x1c3,-0x100)+_0x2ecd67(-0x18d,-0x192,-0x1e9,-0x131)+_0x2ecd67(-0x217,-0x9d,-0x158,-0xf2)+':\x20'+_0x190b29);}}function handleCancelBananaTask(_0x4540e8){const _0x2f0e83={'SqMmJ':function(_0x3d546e,_0x33b100){return _0x3d546e===_0x33b100;},'FIWEK':function(_0x25d5fa,_0x4d7d66){return _0x25d5fa(_0x4d7d66);},'uBQKt':function(_0x4a9a53,_0x14b712){return _0x4a9a53||_0x14b712;}},{taskId:_0xcfdfc2}=_0x4540e8;function _0x4ce2fc(_0x384220,_0x1fb3ea,_0x583d42,_0x102771){return _0x151b(_0x583d42-0x34e,_0x384220);}function _0x2de548(_0x10cd0c,_0x41c06b,_0xda72e5,_0x445275){return _0x151b(_0x445275- -0x249,_0xda72e5);}addLog(_0x4ce2fc(0x56b,0x4f4,0x534,0x48c)+_0x4ce2fc(0x522,0x580,0x520,0x469)+_0x4ce2fc(0x4e1,0x458,0x4ec,0x476)+_0xcfdfc2+')'),_0x2f0e83['SqMmJ'](currentTaskId,_0xcfdfc2)&&currentRequestId&&(_0x2f0e83[_0x2de548(-0x113,-0x118,-0xf3,-0xe4)](addLog,_0x4ce2fc(0x473,0x424,0x43d,0x46f)+_0x2de548(-0x1ba,-0x14b,-0xb1,-0x164)+_0x4ce2fc(0x501,0x4dc,0x4c8,0x4f3)+currentRequestId+')'),eventSource['emit'](EventType[_0x4ce2fc(0x429,0x36f,0x412,0x3f5)+_0x2de548(-0x72,-0x1cb,-0x1be,-0x132)+_0x4ce2fc(0x405,0x3e2,0x457,0x4b9)],{'id':currentRequestId,'success':![],'error':'任务已取消','prompt':_0x2f0e83[_0x2de548(-0x12,-0x111,-0x1e,-0xa5)](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function initializeBananaListener(){const _0x4ecd6d={};_0x4ecd6d['VywCd']=_0x45d78f(0x52f,0x4e6,0x4c0,0x515)+_0xf5479e(-0x18,-0x54,-0xc9,0x60)+_0x45d78f(0x52c,0x4a1,0x488,0x532);function _0xf5479e(_0x49df6d,_0x289802,_0x14d6db,_0x5ee0ec){return _0x151b(_0x49df6d- -0x191,_0x14d6db);}function _0x45d78f(_0x17c37d,_0x190da4,_0x8d8185,_0x3e8f6d){return _0x151b(_0x8d8185-0x300,_0x190da4);}_0x4ecd6d[_0x45d78f(0x3be,0x412,0x3b6,0x477)]=_0x45d78f(0x5b5,0x4f0,0x50a,0x50c)+_0xf5479e(0x22,0x30,-0x4d,-0x8);const _0x6701c7=_0x4ecd6d;eventSource['on'](EventType['GENERATE_I'+_0xf5479e(-0x5,-0xca,-0x8e,-0x39)+'ST'],bananaGenerate),eventSource['on'](_0x6701c7[_0x45d78f(0x4d9,0x4a8,0x41d,0x46d)],handleCancelBananaTask),addLog(_0x6701c7[_0xf5479e(-0xdb,-0xfb,-0x111,-0x12a)]);}export async function replaceWithBanana(){function _0x542a85(_0x407dd0,_0x56cb77,_0x4b9bbe,_0x5c979e){return _0x151b(_0x56cb77- -0x26,_0x407dd0);}function _0x5d77df(_0x25bca1,_0x3701b8,_0x26062a,_0x3f7dc2){return _0x151b(_0x25bca1- -0x267,_0x3701b8);}const _0x46ee38={'XYXAl':_0x542a85(0x220,0x1b4,0x17b,0x156),'jtggi':_0x542a85(0x123,0x19a,0x197,0x254)+'cancel_ban'+'ana_task','bNKIo':function(_0x569240,_0xa99e4c){return _0x569240(_0xa99e4c);},'TKhUA':_0x5d77df(-0x188,-0x135,-0x1b6,-0x20d)+_0x542a85(0x1d6,0x1c8,0x21f,0x136),'yezPd':function(_0xf7568d,_0xfc7782){return _0xf7568d==_0xfc7782;},'nbeUd':function(_0x554452,_0x1eb1db){return _0x554452===_0x1eb1db;},'UzuFH':_0x5d77df(-0x184,-0xee,-0x211,-0x22b),'DGFbw':function(_0x15c4d8){return _0x15c4d8();}};if(_0x46ee38[_0x5d77df(-0x171,-0x108,-0x178,-0x233)](extension_settings[extensionName][_0x542a85(0x123,0x135,0x1b9,0x114)],_0x542a85(0x189,0x17c,0x1f2,0x239))){if(!window[_0x5d77df(-0x132,-0xdf,-0x8b,-0x176)+_0x5d77df(-0x120,-0x96,-0xde,-0x11b)+_0x5d77df(-0x1b2,-0x1c7,-0x193,-0x13e)]){if(_0x46ee38['nbeUd'](_0x46ee38[_0x5d77df(-0x1d2,-0x200,-0x198,-0x1e5)],_0x46ee38[_0x5d77df(-0x1d2,-0x279,-0x220,-0x171)]))window[_0x542a85(0x76,0x10f,0x50,0x4e)+_0x5d77df(-0x120,-0x1bd,-0xfd,-0x61)+'ener']=!![],initializeBananaListener();else{if(_0x2af2b4[_0x542a85(0xee,0x10f,0x17d,0x19f)+_0x542a85(0x11a,0x121,0x143,0x1d3)+_0x5d77df(-0x1b2,-0x237,-0x218,-0x13f)]){const _0x1c4d74=_0x46ee38[_0x5d77df(-0xa1,-0xca,-0x12b,-0x77)][_0x542a85(0x13b,0x16e,0x132,0xfe)]('|');let _0x489b07=-0x353+-0x8bf+-0xce*-0xf;while(!![]){switch(_0x1c4d74[_0x489b07++]){case'0':_0x1e5caf[_0x5d77df(-0x10f,-0x92,-0xa0,-0xe0)+'ener'](_0x46ee38[_0x5d77df(-0x193,-0x1cc,-0x157,-0x1e1)],_0x2fddfe);continue;case'1':_0x19a586[_0x542a85(0x11d,0x97,0x151,0x119)](_0x1b0db4=>{function _0x163f03(_0x482c11,_0x2539f1,_0x4e6dda,_0x4f75ee){return _0x5d77df(_0x4e6dda- -0x90,_0x2539f1,_0x4e6dda-0x4f,_0x4f75ee-0x16a);}function _0x44eb49(_0x4d96ac,_0x2fc632,_0x5157be,_0x5539de){return _0x5d77df(_0x5539de-0x1b8,_0x4d96ac,_0x5157be-0xca,_0x5539de-0x1bf);}_0x38cb4e[_0x44eb49(0x161,0x17,0xf1,0xa9)+_0x163f03(-0x26f,-0x196,-0x242,-0x2db)](_0x1b0db4,_0x2235b8);});continue;case'2':_0x5e1d50[_0x5d77df(-0x132,-0x1d4,-0x133,-0x18e)+_0x5d77df(-0x120,-0x1c1,-0x1b9,-0x151)+_0x542a85(0x49,0x8f,0xe0,0xf8)]=![];continue;case'3':_0x46ee38[_0x5d77df(-0x1a1,-0x1bd,-0x19d,-0x120)](_0x39dcfc,_0x46ee38[_0x5d77df(-0x88,-0xf8,-0x137,0x1d)]);continue;case'4':_0x43a25d['removeList'+_0x542a85(-0x29,0x8f,0x113,0xc6)](_0x16fc4a[_0x5d77df(-0x1a3,-0x172,-0x210,-0xe7)+'MAGE_REQUE'+'ST'],_0x146471);continue;}break;}}}}_0x46ee38[_0x542a85(0x161,0xc6,0x81,0xa)](initializeImageProcessing);}else{if(window[_0x5d77df(-0x132,-0xab,-0xdb,-0xdd)+'BananaList'+_0x5d77df(-0x1b2,-0x1e6,-0x1ca,-0x216)]){const _0x2faf34=_0x542a85(0xcc,0x9f,0xc6,0x50)[_0x5d77df(-0xd3,-0x4d,-0xee,-0xfe)]('|');let _0x5dc8ae=-0x197e*-0x1+-0x2464*-0x1+-0x3de2;while(!![]){switch(_0x2faf34[_0x5dc8ae++]){case'0':addLog(_0x46ee38[_0x542a85(0x19f,0x1b9,0x22c,0x192)]);continue;case'1':eventSource[_0x5d77df(-0x10f,-0xd2,-0x17c,-0x170)+_0x542a85(0xac,0x8f,-0x15,0xc3)](_0x46ee38[_0x542a85(0x169,0xae,0x16,0x10a)],handleCancelBananaTask);continue;case'2':eventSource[_0x542a85(0x1aa,0x132,0x159,0x1a4)+_0x542a85(0xea,0x8f,0x64,0x34)](EventType[_0x542a85(0x4e,0x9e,0x8b,-0x26)+_0x5d77df(-0xdb,-0x195,-0x1e,-0xaf)+'ST'],bananaGenerate);continue;case'3':window[_0x5d77df(-0x132,-0xac,-0x112,-0x100)+_0x5d77df(-0x120,-0x1d4,-0x10f,-0xff)+_0x5d77df(-0x1b2,-0x154,-0x220,-0x1b7)]=![];continue;case'4':LEGACY_EVENT_NAMES[_0x5d77df(-0x1aa,-0x1da,-0x162,-0x116)](_0x3f1be9=>{function _0x78447b(_0x341b96,_0x121e91,_0x4c0bf1,_0x234199){return _0x542a85(_0x234199,_0x121e91-0xcc,_0x4c0bf1-0x129,_0x234199-0x33);}function _0x5b7e8c(_0x470fde,_0x13d270,_0x5d7fc8,_0x20966b){return _0x542a85(_0x5d7fc8,_0x20966b- -0x399,_0x5d7fc8-0x32,_0x20966b-0xd8);}eventSource[_0x78447b(0x1aa,0x1fe,0x27b,0x235)+_0x78447b(0xaf,0x15b,0x1e3,0x18b)](_0x3f1be9,bananaGenerate);});continue;}break;}}}}