(function(_0x4aeb63,_0x4516ea){function _0x352202(_0x111e55,_0x1c72d8,_0x4e5db9,_0x1eb8c3){return _0x3e6d(_0x111e55-0xd1,_0x4e5db9);}const _0x53b3de=_0x4aeb63();function _0x4b02df(_0x2586d2,_0x2c0e86,_0x48c351,_0x231944){return _0x3e6d(_0x231944- -0x70,_0x48c351);}while(!![]){try{const _0x546bc3=parseInt(_0x352202(0x2b5,0x222,0x25d,0x256))/(0x18ce+0xf59*0x2+-0x377f*0x1)*(parseInt(_0x352202(0x2d8,0x33a,0x35d,0x32d))/(-0x107*0x5+0x13c+0x3e9))+parseInt(_0x4b02df(0xa3,0x114,-0x26,0xa7))/(-0x19cf*-0x1+-0xaa4+-0xf28)+-parseInt(_0x352202(0x261,0x23a,0x1f6,0x1c7))/(0x1*0x737+0x3e*-0x3a+0x6d9)*(-parseInt(_0x4b02df(0x157,0x63,-0x10,0xbc))/(0x1013+-0x2c*-0xdb+0x1ad9*-0x2))+parseInt(_0x352202(0x1f7,0x23d,0x2c5,0x17e))/(-0x10bb*0x2+-0x4a*0x27+0x2cc2)*(-parseInt(_0x4b02df(0x5c,-0x7e,-0x23,0x36))/(-0x732+-0x1d2a+-0x51*-0x73))+-parseInt(_0x352202(0x1ec,0x192,0x1f3,0x15f))/(-0xae2+-0x73e+0x1228)*(-parseInt(_0x352202(0x180,0x1ca,0xf2,0xc5))/(-0x431*0x1+0x84b+-0x411))+-parseInt(_0x4b02df(-0x64,0xaf,0x1,0x3d))/(0x4d*0x47+-0x1c1*0x16+0x1145)+parseInt(_0x4b02df(0x19f,0x121,0x1ea,0x15b))/(0x7f*-0xd+-0x1ea9+0x2527)*(-parseInt(_0x4b02df(0x1e8,0x18e,0x166,0x14b))/(-0x16d4+0x19e1+-0x1*0x301));if(_0x546bc3===_0x4516ea)break;else _0x53b3de['push'](_0x53b3de['shift']());}catch(_0x42e292){_0x53b3de['push'](_0x53b3de['shift']());}}}(_0x1da9,0x25544+-0xb568*-0xa+-0x546f1));const _0x3fcc1c=(function(){let _0x36aa79=!![];return function(_0x122630,_0x504452){const _0x2154ba=_0x36aa79?function(){function _0x357d40(_0x50cd1b,_0x1cfd60,_0x21f983,_0x39ea72){return _0x3e6d(_0x21f983- -0x143,_0x1cfd60);}if(_0x504452){const _0x3c1b43=_0x504452[_0x357d40(-0x2b,0x113,0x4c,-0x6f)](_0x122630,arguments);return _0x504452=null,_0x3c1b43;}}:function(){};return _0x36aa79=![],_0x2154ba;};}()),_0x392fe1=_0x3fcc1c(this,function(){function _0x1e4024(_0x28acf8,_0x216033,_0xfc82bb,_0xaca805){return _0x3e6d(_0xfc82bb- -0x1d0,_0xaca805);}function _0x44ff6e(_0x577261,_0xa449dd,_0x526855,_0x907343){return _0x3e6d(_0x907343-0x62,_0x526855);}return _0x392fe1[_0x44ff6e(0x139,0x1b7,0xf2,0x114)]()[_0x1e4024(0x3a,0x69,-0x39,0x2f)](_0x1e4024(0xbf,-0x15,0x34,0xfc)+'+$')[_0x44ff6e(0x134,0x9d,0xc6,0x114)]()[_0x1e4024(-0x1af,-0x123,-0xf2,-0x13e)+'r'](_0x392fe1)[_0x44ff6e(0x224,0x2b4,0x2c5,0x1f9)](_0x1e4024(0x1e,0x37,0x34,-0x74)+'+$');});_0x392fe1();import{extension_settings}from'../../../../extensions.js';function _0x1da9(){const _0x3e0925=['C0LcDLK','5l+U5zU+5OYh5lUKoIa','mtjuA2Hdy3G','zxrPB25FC291CG','r2fMzLi','zNjJBLK','BhvKzv9OzwfKzq','w0jHBMfUyv0Grq','BwfW','y2fUy2vSx2jHBG','sMzTt3y','seH6yKO','BIbWyxLSB2fKia','5zon5BQuicHjrdOG','ywDLigDLBMvYyq','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','DxnLCG','ndiXmtuYnMTIsgLnAq','CMvWBgfJzq','Bw9KywWGCgf5Ba','rLDlr0y','s2Hstxe','y2fJAgu','DMrTzNK','5zU+5QIH5BYp77YA5OYh5lUKid0G','C2v0ici','55Qe5zU+54Mh','t3fYq1q','Aw1Hz2u','vg1lD0q','B21WBgv0Aw9UCW','CNnrA2S','5Q2J6z2I5O+q56s66k+noIa','Dhj1zq','zLnrtLa','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','z1zvEhq','y3vZDg9Tx3vYBa','zw5LCMf0Aw9Uia','wu1Ptxa','AhHLzuG','r0vorvjbvevFsq','nKPhyNfpBq','yxnRsuq6ia','y2HHBMDL','txLyz1G','ifbYB21WDa','qvbjihjLC3bVBG','qKLZyMK','uejxqxq','EwjmvfK','Bw5NBxG','ywrKvgfZAW','m3WXFdr8mNWW','tLnf','DgT2Axe','qMfUyw5H5l+U5zU+5QIH5BYp','l3yX','Bw9KzwW6ia','Aw1Hz2vdB25MAq','5BYa5AEliejHBMfUyEEuNW','Aw5ZDgfUy2vZ','zeTfu1y','s2L0lZuZnY4ZnG','uu1gwNy','zMv0y2GGAw1HzW','uMzYB2q','vuX4Aem','BLHQzNu','E+s/RUwBVN0','ENfLr0q','CxDyvKu','vLbNr0y','CM9HsfO','kcGOlISPkYKRkq','zgvSCY8','Dg9mB3DLCKnHCW','ndK1odzryM95yK8','w0jHBMfUyv0GrG','DhjPBq','mc4WlJaUmcbtyq','C3rHDhvZ','BKDqENq','l2fWAs9IywnRzq','DwnJzxnZzNvSBa','shbdt2m','zuLYyxi','zw5bssbMB3jTyq','rMfPBgvKihrVia','Bxb0','ywn0zxjqCMvZzq','CM9Szq','5lU75yQH5BEY5y+w5RAi','ie5uideWlJa7ia','s2noEge','z0rTAfe','Aw9U','C3vJy2vZCW','DNPJqvq','u2nLBMuGq29TCa','DhjPz2DLCNm','Aw5PDgLHBgL6zq','z2uGvvjmlcbLEa','C2fTCgXLq291BG','DgLVBIb3AxrOia','yKThwwK','BwvZC2fNzxm','C3rYAw5NAwz5','wuznrum','BuDQtuq','y2LZzvy','t2rAzKS','DwLSDcbjBwfNzq','CIbWCM9TChq6ia','zw1PDa','Aw9UoIaIqMvHCG','Aw1Hz2vFDxjS','zxrJAcbnyxjRza','BwvZC2fNzq','DKrSzKC','qMvHCMvYia','w0jHBMfUyv0G5l+U','zxjYtK8','B3DUigLTywDLoG','y2LZAhu','zw5LCG','C3rHCNrZv2L0Aa','q3vKrNG','weDVz28','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','kI8Q','EhP4vuq','rgnpCKO','C0TMChC','t09wzKe','u3rgwgC','whnhtNm','DxbKyxrLu3rHDa','txn4ALm','t2jir2u','ignVBNrHAw4GAq','yxnZAxn0yw50','w0jHBMfUyv0GqG','BgvUz3rO','mZq4mtCZA0Dprwr5','zw5KAw5NihjLCq','shrsEgy','vK5OEgK','swLTELC','z0nwq1a','CNvUBMLUzW','mtu4mdKZmfjMEezNqG','sxLnwfm','mJy5nZyZm0PWBwH1sG','qvbjihjLCxvLCW','yxnWzwn0uMf0Aq','Dg9tDhjPBMC','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','C3rYAw5N','s1zMtKi','swr2Ceq','reLRrwu','zgf0ytPPBwfNzq','qwnJzxb0','DcbvuKWGyxmGzG','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','yw5Hx3rHC2S','55sO55U05O6L6k+35Rgc5QIH5BYp','CfrgyMq','CMvZDwX0','w0jHBMfUyv0G5Ps2','yMf2uNq','Bw9KzwW','y29UDMvYDfrVsG','ueDWvgy','zw5KC1DPDgG','ChvZAa','wM5usNO','55sO5l+U5zU+6Ake6k6+oIaI','DxrUBw8','C3bSAxq','DcbMywLSzwqGDW','yMfUyw5H','5O6L6k+35Rgc','l2DLBMvYyxrL','BNb3CK0','C2LUzYbKAxjLyW','EeXdAvC','q21grxG','rw55rwC','DdOG','yxbWBgLJyxrPBW','y1DMv2m','seDHCxa','EMLKzgq','Dhv1BKW','v3foywK','DgLVBIbYzxf1zq','zfzIu0C','y29UC3rYDwn0BW','z1Pfv2q','qMfUyw5HtgLZDa','BNnLigzVCIbjra','veDRrwy','C3rFy2HHDhu4xW','AwnYzMq','qxv0Ag9YAxPHDa','zxrJAcbLCNjVCG','ywLSzwqGDg8GzG','DhjJuxG','swTtrwy','B25SB2fKzw5K','ANHKvMG','sLrsAuu','CNj1A2S','AxnbCNjHEq','u1DxEMy','ENnWqM0','yNLVBLq','wLz2Eey','ztOG','AM9PBG','s3vut0i','txjdvfa','rMLltu4','sKfqzeO','BfPIrgK','swjXvg0','l3yXlW','l3yXl2nOyxqVyW','DhD4qvG','55sO5lQgihVKV67LM759ioAGH+IVHG','zwnLAxzLzcbPBq','BeLZtMe','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','t1vxyMy','Bw9Kzq','icHlsfrntcWGBa','nhWZFdb8mxWY','DgvxreC','rNnXANC','ig1LC3nHz2vZlG','ChbYCKu','uxDXzue','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','q2HHCMfJDgvYia','EeTXu2e','DxLQyvy','qKfoqu5b','BhDvChO','yxLSB2fKoIa','EMfYs0q','Dg9Rzw4','y3zkrMe','yxjRzg93BIbPBq','AMfTtva','mZu2ote2tNPpuMPL','CMvWBgfJzufSBa','sg9hvLa','EwPYrhm','ogXNDfHkDq','DhLWzq','z0rPwgK','Cg9ZDgzPEfbYBW','wKTrAgi','l3yXyMv0ys9TBW','BwfNzsbPBIbpCa','CuDuCwm','EsbJB252zxj0zq','zMfPBgvKigzVCG','EfrpwuC','nMLrsLPtzW','BI9QC29U','CgvNu3rVCMfNzq','uvrLtLO','z0jjtLq','5yMn572U5zco','mte3nurIqMHwCW','Aw1Hz2vjza','qNDnCNi','vxnLCI1bz2vUDa','AvDezxm','y2XPzw50','CMTKB3DUigvTyG','q29UDgvUDc1uEq','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','w0jHBMfUyv0Gsq','BhvYzsbYzxnWBW','t2rTqvq','zxrLy3rLzcbnyq','zMfxv1O','ELj2Dwe','w0jHBMfUyv0GrW','CIaI','zufQEhi','DhjHy3rPBMCUlG','w0jHBMfUyv0Gvq','swzwA1O','y2vZCYbYzxnWBW','swz4yKq','DxjS','ywXSyMfJAY4','sfrrsum','ChjVBxb0','s1nZt2G','ANnVBG','zM9YrwfJAa','Bw9grNC','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','tKPADw8','ieLeia','yMXVyG','y2zNAw1NxW','y3vZDg9Tx2LUyW','zu1JqKu','AML1z3vHBG','zcbIyxnLnJqGAq','wgDkzLq','BMrZl2nOyxqTyW','tufhrv9srvnqtW','w0jHBMfUyv0GuG','CMrfBe0','wK1cr3i','BNzcEvC','ksbbChbSzvDLyG','zxiG','y2HVAwnLCW','B2fKihDPDgGG','55sO5lQo55sF5OIq55QevgfNoIa','zxnWB25ZzsbJBW','w0jHBMfUyv0G5l2/','rxbOA0e','ALPyvva','qu9zA08','BwfNzsbMCM9Tia','DwvZDcb0BZOG','A2zvu2m','zxjYB3i','zxjnCfu','uwrVvLu','CMvTB3zLtgLZDa','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','v2jLALe','Cujlzge','EwvsDhu','rMfPEwi','y2HHDf9JB21WBa','EsbLEhrYywn0zq','yNjsELy','v1zZCem','y29UDgvUDa','qvztzxG','y29TCgXLDgvuyq','qwPkvuq','v2Tevve','Aw5JBhvKzxm','tufhrv9srvfvrq','nJqGAw1Hz2uU','y29UDMvYC2f0Aq','5yMn572U5yMn','De1Ir0u','zKLtDeK','ANjuyu0','iIbMCM9TihbYzq','CgfYyw1LDgvYCW','yMfUyw5HioEuN+wBVUs6IW','DMHJzhm','zw9bqxK','rxbTy1K','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','w0jHBMfUyv0Gra','5PYa5zco572U','BxrYCu4','tKzgufi','D2L0AcbWCM9TCa','B3iGChjVBxb0oG','yxbWBhK','ntaXnMn4vhPetG','B3vUzcbTyxrJAa','AxrOihn0yxr1CW','uxDVA0O','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','yxrLzcbZDwnJzq','rxr5EMW','C2vHCMnO','EKrbCfe','teDNDLq','BNrHAw5ZihrLEa','AwTLieDLy2TVkq','sMHkwwe','ue9tva','5zco572U5yMn','BuTsBei','ELfJte0','C3rYzwfT','BwL0DgvKigzHAq','AwnwCfq','vvjozxe','ANrjDxi','yvniAKu','zMfYAs81mZCUmW','qLvhq2G','v3nzDui','ihWG','Dgv4Da','CwTqs1q','EKLQzNi','Aw5NihrYAwDNzq','DcbVBMX5lcbUBW','sLnmzxq','B25LCNjVCG','w0jHBMfUyv0GuW','zMLSDgvY','DLD4D1K','t3L3zfm','zhfJsu8','uffxB20','zML4zwrqCM9TCa'];_0x1da9=function(){return _0x3e0925;};return _0x1da9();}import{eventSource}from'../../../../../script.js';function _0x3e6d(_0x27cdc1,_0x8d6f88){_0x27cdc1=_0x27cdc1-(0x4*-0x38d+-0x2*-0x469+-0x5fb*-0x1);const _0x2caa2c=_0x1da9();let _0x8db464=_0x2caa2c[_0x27cdc1];if(_0x3e6d['pxMOlp']===undefined){var _0x1105d6=function(_0x542d25){const _0x18451d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x27736b='',_0xed314d='',_0xf8bb6=_0x27736b+_0x1105d6;for(let _0x512789=0x1*0x1391+-0x22fb*-0x1+-0x4*0xda3,_0x4c7e6d,_0x4df593,_0x286dc1=-0x13*-0x114+0x1*0xb1b+-0x1f97;_0x4df593=_0x542d25['charAt'](_0x286dc1++);~_0x4df593&&(_0x4c7e6d=_0x512789%(-0x54d*0x1+-0x1ded+-0x2b6*-0xd)?_0x4c7e6d*(-0x57*0x4f+0x132b*-0x1+0x7*0x69c)+_0x4df593:_0x4df593,_0x512789++%(0x1*-0x224+0x8d9*0x1+-0x6b1))?_0x27736b+=_0xf8bb6['charCodeAt'](_0x286dc1+(0x3*-0x4eb+-0x29+0x77a*0x2))-(0x47*0x3e+0x1960+-0x2a88)!==0x1*-0x143b+-0xd1e*-0x1+-0x71d*-0x1?String['fromCharCode'](-0x245b+-0x109*-0x23+0x11f&_0x4c7e6d>>(-(0x229d+0x9c9+-0x2c64)*_0x512789&-0x1d3e+0x18b9*0x1+0x48b)):_0x512789:-0x1f37+0x1557+0x9e0){_0x4df593=_0x18451d['indexOf'](_0x4df593);}for(let _0x4c477e=-0x22f4+-0x81b+-0x1*-0x2b0f,_0x3ed715=_0x27736b['length'];_0x4c477e<_0x3ed715;_0x4c477e++){_0xed314d+='%'+('00'+_0x27736b['charCodeAt'](_0x4c477e)['toString'](-0x6*-0x9e+0x24fb+-0x289f*0x1))['slice'](-(-0x1f6d+0x1795*-0x1+0x3704));}return decodeURIComponent(_0xed314d);};_0x3e6d['XjKGtd']=_0x1105d6,_0x3e6d['yQdFOg']={},_0x3e6d['pxMOlp']=!![];}const _0x32be45=_0x2caa2c[-0xbaf*0x3+-0x18e4+0x6a9*0x9],_0x1f0f7a=_0x27cdc1+_0x32be45,_0x1daa52=_0x3e6d['yQdFOg'][_0x1f0f7a];if(!_0x1daa52){const _0x11770a=function(_0xcbbf1d){this['HBQNla']=_0xcbbf1d,this['WBIBDZ']=[-0x1*0x685+-0x6b1+0xc7*0x11,-0x20dd*0x1+-0x167*-0x12+0x79f,-0xff6+0xb*-0x1c9+0x2399],this['CGSMRP']=function(){return'newState';},this['bpoOqL']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['NxWbkz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x11770a['prototype']['EQpDqh']=function(){const _0x4b3e80=new RegExp(this['bpoOqL']+this['NxWbkz']),_0x24276c=_0x4b3e80['test'](this['CGSMRP']['toString']())?--this['WBIBDZ'][0x10e9+0x3*-0x5f3+-0xf1*-0x1]:--this['WBIBDZ'][-0xc67+-0x1e2*0xf+0x28a5];return this['kCZFgM'](_0x24276c);},_0x11770a['prototype']['kCZFgM']=function(_0x261918){if(!Boolean(~_0x261918))return _0x261918;return this['oIWiks'](this['HBQNla']);},_0x11770a['prototype']['oIWiks']=function(_0x4f83d0){for(let _0x151aa4=-0x3b6+-0x1adc+0x25a*0xd,_0x3409ec=this['WBIBDZ']['length'];_0x151aa4<_0x3409ec;_0x151aa4++){this['WBIBDZ']['push'](Math['round'](Math['random']())),_0x3409ec=this['WBIBDZ']['length'];}return _0x4f83d0(this['WBIBDZ'][-0x31*-0x3+-0x1945*-0x1+0x8*-0x33b]);},new _0x11770a(_0x3e6d)['EQpDqh'](),_0x8db464=_0x3e6d['XjKGtd'](_0x8db464),_0x3e6d['yQdFOg'][_0x1f0f7a]=_0x8db464;}else _0x8db464=_0x1daa52;return _0x8db464;}import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function getDirectHeaders(_0x25c9c7=null,_0x1556a5=null){const _0xa5a445={};_0xa5a445['yjrDs']='Mozilla/5.'+'0\x20(Windows'+_0x19d101(0x4f2,0x465,0x4a8,0x466)+'Win64;\x20x64'+_0x19d101(0x373,0x33b,0x3db,0x3aa)+_0x19d101(0x3fb,0x4c8,0x48d,0x448)+_0x5f340d(0x31d,0x380,0x24f,0x3aa)+_0x19d101(0x435,0x447,0x46f,0x3ea)+'\x20Chrome/12'+_0x19d101(0x48e,0x3c2,0x40e,0x459)+_0x5f340d(0x3c0,0x44a,0x408,0x475)+'6',_0xa5a445['OdmAT']=_0x5f340d(0x455,0x517,0x440,0x4e5);function _0x19d101(_0x48664d,_0x320ff9,_0x5a45ba,_0x4ab622){return _0x3e6d(_0x4ab622-0x24f,_0x5a45ba);}_0xa5a445['JTRiE']=_0x19d101(0x3c1,0x43b,0x3c0,0x382)+'pe';const _0x5e1217=_0xa5a445,_0x17796a={};_0x17796a[_0x19d101(0x38c,0x3b4,0x349,0x37e)]=_0x5e1217[_0x5f340d(0x333,0x3b1,0x2bf,0x287)],_0x17796a[_0x19d101(0x378,0x2ef,0x3b7,0x309)]=_0x5e1217[_0x5f340d(0x350,0x3ea,0x3cc,0x311)];function _0x5f340d(_0x42b940,_0x5794cc,_0x3ce822,_0x291bef){return _0x3e6d(_0x42b940-0x219,_0x5794cc);}const _0x51ed38=_0x17796a;return _0x25c9c7&&(_0x51ed38[_0x5e1217[_0x5f340d(0x305,0x2b8,0x31d,0x38d)]]=_0x25c9c7),_0x1556a5&&(_0x51ed38['Authorizat'+'ion']=_0x1556a5),_0x51ed38;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x31ab2c){function _0x373f7c(_0x11b403,_0x223ed1,_0x509004,_0x3dc2be){return _0x3e6d(_0x509004-0x1e,_0x223ed1);}const _0x3e9e1b={'vWxwY':function(_0x3d7d6c,_0x1325b4){return _0x3d7d6c(_0x1325b4);},'XgJfT':_0x373f7c(0xe9,0x12c,0xf4,0x5e)+_0x42bb86(0x1b3,0x1a1,0x1b3,0x122),'VPgGF':_0x373f7c(0x20d,0xa5,0x16d,0x1b1),'KSsOh':function(_0x2f34ae,_0x635181){return _0x2f34ae===_0x635181;},'YFMEC':_0x373f7c(0x248,0x1ef,0x221,0x16a),'qGTqc':'aPJfX','AyTZq':function(_0x1713e1,_0x34505e){return _0x1713e1||_0x34505e;},'fSQNP':_0x42bb86(0x12c,-0x5,0x10f,0xb4)};function _0x42bb86(_0x5a2c13,_0x1d64a4,_0xc87ed3,_0x2a85b6){return _0x3e6d(_0x2a85b6- -0x5,_0xc87ed3);}if(!_0x31ab2c)return'';if(_0x31ab2c[_0x42bb86(0x1da,0x1d5,0xf7,0x128)]&&_0x31ab2c[_0x42bb86(0xa4,0x14d,0x1ee,0x128)]['startsWith'](_0x3e9e1b[_0x42bb86(0x197,0x1c5,0x165,0x1fd)])){if(_0x3e9e1b[_0x42bb86(0x124,0x76,0x1c6,0x142)](_0x3e9e1b[_0x373f7c(0x197,0x2f0,0x244,0x1e0)],_0x3e9e1b[_0x42bb86(0xc5,0x93,0x14c,0x11d)])){_0x3e9e1b[_0x42bb86(0xe1,0x10b,0x1e7,0x1af)](_0x4c8367,_0x373f7c(0x111,0x19b,0x153,0x104)+'magen\x20模型不支'+_0x42bb86(0x266,0x235,0x214,0x1d8)+_0x42bb86(0x6b,0xd7,-0x6,0xc9)),_0x980a4e=_0x41d899;const _0x3b9acf={};_0x3b9acf[_0x42bb86(0x135,0xc5,0x16a,0x12e)+'pe']=_0x3e9e1b[_0x42bb86(0x105,0x131,0x149,0x14f)],_0x3b9acf[_0x42bb86(0x82,0x195,0x18b,0xe0)+_0x373f7c(0x25b,0x212,0x238,0x16f)]=_0x373f7c(0x198,0x27c,0x250,0x311)+_0x3852b6,_0x57254e=_0x3b9acf,_0x3d368a=_0x129c1b;}else{const _0xf34c71=await getConfigImage(_0x31ab2c[_0x373f7c(0x19e,0x197,0x14b,0x1ae)]);return _0x3e9e1b['AyTZq'](_0xf34c71,'');}}if(_0x31ab2c[_0x42bb86(0x1b3,0x11e,0x278,0x1d1)]&&_0x31ab2c[_0x42bb86(0x28c,0x205,0x24c,0x1d1)][_0x42bb86(0x292,0x173,0x27c,0x233)](_0x3e9e1b[_0x42bb86(0x1d4,0x16e,0x295,0x1d7)]))return _0x31ab2c[_0x373f7c(0x148,0x285,0x1f4,0x29f)];return'';}async function generateBananaImage({prompt:_0xf17112,width:_0x46cefd,height:_0x2814dc,change:_0x46349a,retouchPrompt:_0x2c5a73,retouchImage:_0x5c27c1}){const _0x4e52cb={'teWDG':function(_0x1b23d9,_0x10df10){return _0x1b23d9+_0x10df10;},'OdZfK':function(_0x420c43,_0xc5d0cc){return _0x420c43(_0xc5d0cc);},'qBKda':_0x28a654(-0x208,-0x2ba,-0x2bf,-0x2bd),'PGpTf':_0x28a654(-0x1f2,-0x24b,-0x1f1,-0x1ac),'jtIur':function(_0x4ef0fd,_0x22f947){return _0x4ef0fd||_0x22f947;},'dVbSG':function(_0xe5c1ca,_0x4c0c5d){return _0xe5c1ca(_0x4c0c5d);},'EpmcY':_0x47b285(0x177,0x17f,0x1e6,0x1ab)+_0x47b285(0x165,0x188,0x1fb,0x115)+_0x28a654(-0x1f0,-0x1ac,-0x1be,-0x228)+_0x47b285(0x131,0x1d7,0x297,0x134)+'\x20image.','eIrar':function(_0x492307,_0x3a934d){return _0x492307+_0x3a934d;},'SWWzf':function(_0x57f10c,_0x298a96){return _0x57f10c+_0x298a96;},'mngmx':_0x47b285(0x1aa,0x21b,0x2b1,0x241),'ZnTJz':_0x28a654(-0x207,-0x1a1,-0x1c0,-0x1be)+'+$','bKGYi':_0x47b285(0x49,0x10b,0x65,0x9b)+'cancel_ban'+_0x28a654(-0x2db,-0x2da,-0x27c,-0x305),'rsQkk':_0x47b285(0x90,0x10d,0x151,0x194)+_0x28a654(-0x266,-0x1b0,-0x1e8,-0x1a8),'tkviq':_0x47b285(0x20e,0x1f2,0x1d9,0x198),'QwokJ':_0x28a654(-0x3b8,-0x23f,-0x263,-0x2ec)+_0x28a654(-0x2be,-0x2c8,-0x232,-0x29b),'eMcBE':_0x47b285(0x18e,0x15b,0x1e8,0x139)+'pe','eoAAy':function(_0x1a1558,_0x3e905a){return _0x1a1558===_0x3e905a;},'pTFbd':_0x47b285(0x18,0xc6,0x172,0xa4),'SoiQP':_0x28a654(-0x2e9,-0x254,-0x199,-0x24f),'OOVfA':_0x28a654(-0x178,-0x1bc,-0x2a7,-0x1d9)+'se\x20did\x20not'+_0x28a654(-0x3be,-0x2f4,-0x3be,-0x320)+_0x28a654(-0x259,-0x2f6,-0x22e,-0x2a1)+_0x47b285(0x21e,0x239,0x285,0x2c8)+'t','xSFhF':function(_0x222eb6,_0x3b5846){return _0x222eb6+_0x3b5846;},'gBINT':function(_0x30ef2b,_0x459240){return _0x30ef2b+_0x459240;},'WUlHJ':'[Banana]\x20生'+'图事件监听器已关闭。','gDiXi':function(_0x5203c6,_0x52de4f){return _0x5203c6(_0x52de4f);},'IyMXS':function(_0x2b3b41,_0x2ee9b0){return _0x2b3b41+_0x2ee9b0;},'lIsNa':function(_0x79d1fc,_0x4c4fca){return _0x79d1fc>_0x4c4fca;},'ijOjN':'...','IbqTm':function(_0x10aa79,_0x386e86){return _0x10aa79(_0x386e86);},'HPqyU':function(_0x2f7360,_0x5a68b7){return _0x2f7360||_0x5a68b7;},'HpCOc':function(_0x76fb0b,_0x34c7f5){return _0x76fb0b!==_0x34c7f5;},'KhRMq':function(_0x2adffd,_0xa2aaf4){return _0x2adffd(_0xa2aaf4);},'mGjMD':_0x47b285(0x25f,0x245,0x2ee,0x216)+'osition','hdvyt':'CiHWj','errNO':_0x28a654(-0x226,-0x25e,-0x345,-0x277)+_0x47b285(0x1dd,0x263,0x2eb,0x27e),'EphkA':function(_0x547b06,_0x3fd976){return _0x547b06<=_0x3fd976;},'VNhxi':function(_0x488d31,_0x223dd4){return _0x488d31(_0x223dd4);},'MsxjS':'标准模式:\x20使用请求'+'中的\x20prompt。','MyXgX':function(_0x464fc7,_0x9b741e){return _0x464fc7!==_0x9b741e;},'frcnY':_0x28a654(-0x218,-0x24c,-0x37c,-0x2e0),'ziddd':function(_0xa83238,_0x2b39db){return _0xa83238(_0x2b39db);},'nGPzt':'imagen','DIkEe':_0x47b285(0x158,0x1a6,0x1c2,0x270),'cvJFa':_0x28a654(-0x291,-0x2cb,-0x2e5,-0x224),'lZJtM':'后置后','Rfrod':function(_0x21ae32,_0x479746){return _0x21ae32(_0x479746);},'BIsbi':function(_0x26efe2,_0x382e01){return _0x26efe2(_0x382e01);},'HHzbJ':_0x47b285(0x14d,0x124,0x1f1,0x1ac)+'ompletions','zarKD':_0x28a654(-0x13b,-0x16d,-0x260,-0x1c3),'gZEWd':_0x47b285(0x18a,0x162,0x114,0x1f3),'WVspC':'[Banana]\x20启'+_0x28a654(-0x28a,-0x36e,-0x2a4,-0x2c4)+'。','gYIgZ':function(_0x440e99,_0xa7ca33){return _0x440e99||_0xa7ca33;},'rdElM':function(_0x32b163,_0x550a66){return _0x32b163!==_0x550a66;},'lwUpz':_0x28a654(-0x173,-0x12b,-0x200,-0x1ca),'YoCGl':_0x47b285(0x166,0x153,0xd1,0x179),'fIStI':_0x47b285(0x1ce,0x1b2,0x110,0x128),'lZbDi':function(_0x2a95d3,_0x12de4d){return _0x2a95d3(_0x12de4d);},'zspBm':_0x28a654(-0x1c2,-0x190,-0x1ee,-0x217),'WqNai':function(_0x49869e,_0x20cb24){return _0x49869e(_0x20cb24);},'CmFEx':_0x47b285(0x21d,0x256,0x1c9,0x242),'vzcAT':'uNsHd','OUWbf':_0x28a654(-0x286,-0x14f,-0x107,-0x1c5),'NFFPR':function(_0x3193ee,_0x23f6a8){return _0x3193ee(_0x23f6a8);},'jamMP':_0x47b285(0xc3,0x135,0x1e1,0x96),'eAjxr':function(_0x80aca5,_0xe2034c){return _0x80aca5(_0xe2034c);},'WsYuB':_0x47b285(0x1f3,0x214,0x2c2,0x1f3),'dqcIO':_0x47b285(0x285,0x1e1,0x1ab,0x265),'jZXUP':function(_0x3118e1,_0x4dea2a){return _0x3118e1(_0x4dea2a);},'Loiow':_0x47b285(0x2d,0xcb,0x24,0x134),'npwrM':'GgjNF','nvByW':function(_0x1508bb,_0x198ab4){return _0x1508bb===_0x198ab4;},'FWKGF':_0x28a654(-0x225,-0x340,-0x20b,-0x2d1),'KuTOB':function(_0x487b74,_0x3d9d2f){return _0x487b74===_0x3d9d2f;},'DcOrJ':_0x28a654(-0x185,-0x17a,-0x1c1,-0x188),'XERmN':function(_0x238b3c,_0x206b36){return _0x238b3c(_0x206b36);},'kfUSc':function(_0x569304,_0x1a4dac){return _0x569304(_0x1a4dac);},'adJrP':function(_0x2c2125,_0x2eeca4){return _0x2c2125!==_0x2eeca4;},'QTeNZ':'qkPKT','WbejQ':function(_0x556a4c,_0x5e24f4){return _0x556a4c+_0x5e24f4;},'CudFx':function(_0x703b97,_0x168054){return _0x703b97===_0x168054;},'vhcds':_0x47b285(0x22a,0x17a,0x21c,0xc2),'BwMrr':'afRKQ','WkDUQ':'rTNoL','SfTYY':_0x47b285(0x137,0xd3,0xd4,0xd8),'vdmfy':function(_0xcb52da,_0x433d31){return _0xcb52da(_0x433d31);},'ZKQhb':'custom','gVUxt':'XStRc','AVSex':function(_0x41b11e,_0x272878){return _0x41b11e(_0x272878);},'IdvpD':function(_0x200a99,_0x21a132,_0x44fc23){return _0x200a99(_0x21a132,_0x44fc23);},'gDmhQ':_0x28a654(-0x1da,-0x1f3,-0x261,-0x22a),'ciseV':_0x47b285(0xc7,0xd4,0x16e,0xca),'IkSEf':_0x28a654(-0x245,-0x192,-0x2ae,-0x225),'EZtYH':_0x28a654(-0x24f,-0x271,-0x38e,-0x30d),'Faiyb':function(_0x20c8a6,_0x187f91){return _0x20c8a6===_0x187f91;},'nXjfu':'QdoVU','uyjaV':_0x28a654(-0x1f5,-0x25d,-0x2ba,-0x1eb),'gWbOD':_0x47b285(0x44,0xfa,0x3e,0xb9),'ZMBGr':_0x47b285(0x210,0x1b1,0x1d3,0x19d)+'etected\x20Ma'+_0x28a654(-0x325,-0x20e,-0x1c5,-0x290)+'edded\x20base'+_0x28a654(-0x1cd,-0x2e9,-0x181,-0x246),'OGduj':function(_0x3007ae,_0xe0b19b){return _0x3007ae(_0xe0b19b);},'iWDes':_0x47b285(0x22c,0x1b1,0x1ea,0x187)+_0x47b285(0x1e1,0x160,0x140,0xc0)+'rkdown\x20ima'+_0x47b285(0x2e3,0x248,0x243,0x261)+_0x47b285(0x15a,0x166,0xf0,0x1f8)+'.','MrCTP':_0x47b285(0x1b1,0x197,0x1cb,0x228),'KcNxa':function(_0x2debc7,_0x48bb0c){return _0x2debc7===_0x48bb0c;},'YMiMp':_0x47b285(0x1ae,0x1b3,0x17b,0x246),'sKfpw':'HYCaa','erMpU':function(_0x3dd12f,_0x5d3b91){return _0x3dd12f(_0x5d3b91);},'zQcLM':_0x28a654(-0x293,-0x2a4,-0x230,-0x210)+'uccessfull'+_0x47b285(0x1ef,0x14b,0x170,0x177)+'d\x20Markdown'+'\x20image\x20to\x20'+'base64.','LntfD':_0x28a654(-0x286,-0x16c,-0x230,-0x1ff),'zstxS':_0x47b285(0x227,0x167,0xc6,0x11a)+_0x28a654(-0x26d,-0x343,-0x2fd,-0x2f1)+_0x28a654(-0x381,-0x37b,-0x3c9,-0x307)+_0x47b285(0x124,0x16c,0x1ab,0x9b),'awyZp':function(_0x28a9b8,_0x1063ec){return _0x28a9b8(_0x1063ec);},'KVfNB':function(_0x10551b,_0x2c21b2){return _0x10551b(_0x2c21b2);},'ROpfB':_0x28a654(-0x2b6,-0x320,-0x300,-0x28d)+'mage\x20gener'+_0x28a654(-0x2aa,-0x2f5,-0x173,-0x22d)+'ssfully.','QwqeA':_0x28a654(-0x37b,-0x358,-0x396,-0x2ea),'JSLet':function(_0x36e7b4,_0x5e9f48){return _0x36e7b4(_0x5e9f48);},'TkbIP':_0x28a654(-0x1a1,-0x1d9,-0x163,-0x1ba)+_0x28a654(-0x238,-0x28c,-0x2f2,-0x2dc)+':','xTOYG':_0x28a654(-0x365,-0x310,-0x210,-0x2bb),'CLupA':_0x28a654(-0x2a3,-0x202,-0x21f,-0x278)};clearLog();function _0x47b285(_0x531db7,_0x30158a,_0x101717,_0x5b6613){return _0x3e6d(_0x30158a-0x28,_0x5b6613);}const _0x1a056d=taskQueue[_0x28a654(-0x1bb,-0x25a,-0x140,-0x1d4)]({'name':_0x4e52cb[_0x28a654(-0x2ee,-0x2ca,-0x3a9,-0x314)]((_0xf17112||'')['substring'](0xbfb+-0x12cf+0x6d4,0xa8d+-0x1*0x1c1e+0x11af),_0xf17112&&_0x4e52cb[_0x47b285(0x1b8,0x128,0x1c4,0xda)](_0xf17112[_0x47b285(0x99,0xcd,0x111,0x115)],0x1*-0x1922+0x3*-0xbf0+0x3d10)?_0x4e52cb['ijOjN']:''),'type':TaskType[_0x47b285(0x16d,0x137,0xca,0xfa)],'prompt':_0xf17112});currentTaskId=_0x1a056d,_0xf17112=_0x4e52cb[_0x28a654(-0x2a2,-0x341,-0x37e,-0x2e5)](processCharacterPrompt,_0xf17112),_0xf17112=await _0x4e52cb[_0x47b285(0x182,0x105,0xd7,0x111)](stripChineseAnnotations,_0xf17112);let _0x53436c=_0x46349a;_0x46349a=_0x4e52cb[_0x28a654(-0x318,-0x218,-0x225,-0x2a5)](processCharacterPrompt,_0x46349a),_0x46349a=await stripChineseAnnotations(_0x46349a),_0x4e52cb[_0x47b285(0x91,0x145,0xdf,0xf4)](addLog,_0x28a654(-0x16e,-0x225,-0x1e3,-0x1cc)+_0x47b285(0x1d7,0x15c,0x1ea,0x19f)+extension_settings[extensionName][_0x28a654(-0x1cd,-0x231,-0x25b,-0x291)]),_0x4e52cb[_0x28a654(-0x269,-0x256,-0x218,-0x2c8)](addLog,_0x28a654(-0x20d,-0x25d,-0x23d,-0x1fa)+'\x20'+(_0x46cefd||'默认')+',\x20高度\x20-\x20'+_0x4e52cb['HPqyU'](_0x2814dc,'默认')),_0xf17112=_0x46349a&&_0x4e52cb[_0x28a654(-0x1ce,-0x1d8,-0xe7,-0x1b3)](_0x46349a['trim'](),'')?_0x46349a:_0xf17112,_0x4e52cb[_0x47b285(0x1bb,0x1f7,0x26d,0x1c5)](addLog,_0x47b285(0x103,0x187,0x148,0x1da)+_0xf17112);let _0x38b2e6=![];_0xf17112['includes'](_0x4e52cb[_0x47b285(0x1dd,0x24f,0x315,0x284)])&&(_0x4e52cb['eoAAy']('abInb',_0x4e52cb['hdvyt'])?_0x434874=_0x4e52cb[_0x28a654(-0x1f6,-0x20b,-0x2f8,-0x2bc)](_0x14531d,',\x20')+_0x445381[_0x47b285(0x164,0x134,0x1e7,0x1fd)+_0x19e824+'\x20Prompt']:_0x38b2e6=!![]);_0x4e52cb[_0x47b285(0x152,0x105,0x129,0x10c)](addLog,_0x47b285(0x1d1,0x1bc,0x24a,0x266)+'(Divide_ro'+'les):\x20'+_0x38b2e6);let _0x2d8a2a={},_0x379630='',_0x585dce='';if(_0x38b2e6){_0x4e52cb[_0x47b285(0x1e2,0x145,0x1f0,0xa9)](addLog,_0x4e52cb[_0x47b285(0x299,0x25c,0x1a5,0x1fa)]),_0x2d8a2a=parsePromptStringWithCoordinates(_0xf17112),_0x379630=_0x2d8a2a[_0x4e52cb[_0x28a654(-0x1e0,-0x232,-0x259,-0x19b)]];for(let _0x31ff8c=-0x38*-0xb+0x1*0xe21+-0x1088;_0x4e52cb[_0x28a654(-0x28b,-0x1e3,-0x1f6,-0x260)](_0x31ff8c,0x1847+0x2149+-0x1d*0x1fc);_0x31ff8c++){_0x2d8a2a['Character\x20'+_0x31ff8c+_0x47b285(0x148,0x210,0x147,0x250)]&&(_0x585dce=_0x4e52cb[_0x47b285(0x96,0x152,0x15e,0x1f8)](_0x585dce,',\x20')+_0x2d8a2a[_0x28a654(-0x31d,-0x33a,-0x223,-0x2b6)+_0x31ff8c+'\x20Prompt']);}}else _0x4e52cb[_0x47b285(0x5e,0xd1,0x96,0x10a)](addLog,_0x4e52cb[_0x28a654(-0x2fa,-0x328,-0x3d9,-0x322)]),_0x379630=_0xf17112;let {modifiedPrompt:_0x113572,insertions:_0x872b10}=await prompt_replace(_0x379630,_0x585dce);if(_0x38b2e6)for(let _0x46091e=0x9ae+0xa96+-0x3*0x6c1;_0x46091e<=0x1983+0x21f4+-0x3b73;_0x46091e++){if(_0x2d8a2a[_0x28a654(-0x21d,-0x269,-0x1f9,-0x2b6)+_0x46091e+_0x47b285(0x156,0x210,0x170,0x1b6)]){if(_0x4e52cb[_0x47b285(0x27c,0x20f,0x255,0x162)](_0x4e52cb[_0x47b285(0x19a,0x1e6,0x1a7,0x12c)],_0x28a654(-0x1db,-0x25c,-0x1a1,-0x1c2)))_0x113572=_0x4e52cb[_0x47b285(0xc7,0x152,0x12b,0x1bb)](_0x113572,'\x20|\x20')+_0x4e52cb[_0x47b285(0xad,0x101,0xf8,0x14a)](prompt_replace_for_character,_0x2d8a2a[_0x47b285(0xce,0x134,0xbf,0xbc)+_0x46091e+_0x47b285(0x158,0x210,0x257,0x150)]);else{const {taskId:_0x3ebc4f}=_0x453a37;_0x4e52cb[_0x28a654(-0x255,-0x144,-0x1ae,-0x199)](_0xef486d,_0x47b285(0xd1,0xe9,0x59,0x168)+_0x47b285(0x1a9,0x129,0x177,0x14b)+_0x28a654(-0x157,-0x27a,-0x162,-0x1dd)+_0x3ebc4f+')');if(_0x4b3d6d===_0x3ebc4f&&_0x3d031c){const _0xf34669=_0x4e52cb[_0x28a654(-0x230,-0x283,-0x1d3,-0x254)][_0x28a654(-0x2b9,-0x268,-0x381,-0x2f7)]('|');let _0x5c0fa6=-0x11*-0x6c+0x3*-0xc00+0x1cd4;while(!![]){switch(_0xf34669[_0x5c0fa6++]){case'0':_0x22048a=null;continue;case'1':_0x305fcf=null;continue;case'2':_0x25741f=null;continue;case'3':_0x52cf55[_0x28a654(-0x130,-0x25c,-0xe9,-0x196)](_0x7dd7ed[_0x28a654(-0x238,-0x247,-0x12c,-0x1df)+_0x47b285(0x23e,0x17e,0x23c,0x229)+_0x28a654(-0x29b,-0x269,-0x170,-0x1d2)],{'id':_0x29a424,'success':![],'error':_0x4e52cb[_0x28a654(-0x23e,-0x34d,-0x359,-0x2fd)],'prompt':_0x4e52cb[_0x28a654(-0x2d7,-0x18a,-0x276,-0x21d)](_0x43ad96,'')});continue;case'4':_0x4e52cb[_0x47b285(0x200,0x251,0x181,0x31d)](_0x20d4a7,'[Banana]\x20取'+_0x28a654(-0x264,-0x240,-0x17a,-0x23a)+_0x28a654(-0x1df,-0x2ae,-0x1fb,-0x1fc)+_0x57529d+')');continue;}break;}}}}}const _0xa67ece=extension_settings[extensionName]['banana'],{model:_0x355959,apiUrl:_0x4c9b79,apiKey:_0x3ece3b,conversationPresets:_0x473599,conversationPresetId:_0xd39386,editPresetId:_0x3dfaf7,aspectRatio:_0x351a1f}=_0xa67ece;function _0x28a654(_0x23ced3,_0xd74e5b,_0x162acf,_0x2cbca6){return _0x3e6d(_0x2cbca6- -0x3c2,_0x23ced3);}_0x4e52cb[_0x28a654(-0x338,-0x39e,-0x317,-0x319)](addLog,'[Banana]\x20S'+'tarting\x20im'+_0x47b285(0x2a8,0x1ef,0x151,0x184)+_0x28a654(-0x136,-0x22f,-0xde,-0x1a0)+_0x47b285(0x23a,0x21c,0x27e,0x2aa)+_0x355959);let _0x14a428,_0x2d1ccd;if(_0x355959['startsWith'](_0x4e52cb[_0x28a654(-0x230,-0x204,-0x18f,-0x1b6)])){_0x14a428=_0x47b285(0x1df,0x148,0x201,0xfb)+_0x28a654(-0x12e,-0x214,-0x174,-0x1bd)+_0x355959;const _0x13bde3={};_0x13bde3['fixedPromp'+'t']='';const _0x506b01=_0x473599[_0xd39386]||_0x13bde3,_0x4f5562=[_0x506b01[_0x47b285(0x27b,0x1e0,0x186,0x1d8)+'t'],_0x872b10[_0x4e52cb[_0x47b285(0x199,0xe0,0x171,0xc9)]],_0x872b10[_0x28a654(-0x30c,-0x1e3,-0x2ad,-0x297)],_0x113572,_0x872b10[_0x4e52cb[_0x47b285(0x82,0x13c,0x136,0x147)]],_0x872b10[_0x4e52cb['lZJtM']],_0x506b01[_0x28a654(-0x203,-0x233,-0x258,-0x2a4)+'mpt'],_0x872b10[_0x47b285(0xe5,0x1b2,0x1f0,0x26b)]][_0x47b285(0x251,0x1db,0x260,0x185)](Boolean)[_0x47b285(0xeb,0x11c,0x121,0xcd)](',\x20');_0x4e52cb[_0x28a654(-0x25c,-0x1a8,-0x1c1,-0x1c6)](addLog,_0x28a654(-0x168,-0x14f,-0x188,-0x1e8)+_0x4f5562);const _0x2b4579={};_0x2b4579['prompt']=_0x4f5562;const _0x466954={};_0x466954[_0x28a654(-0xf2,-0x158,-0x136,-0x1a1)+'t']=0x1,_0x466954[_0x47b285(0x17c,0xd9,0x3b,0x5e)+'o']=_0x351a1f;const _0x5ad8e3={};_0x5ad8e3[_0x28a654(-0x281,-0x118,-0x140,-0x1cb)]=[_0x2b4579],_0x5ad8e3[_0x47b285(0x243,0x1ab,0x112,0x1dd)]=_0x466954,_0x2d1ccd=_0x5ad8e3,_0x4e52cb[_0x47b285(0x232,0x212,0x1e7,0x1f2)](addLog,_0x47b285(0x115,0xcc,0x35,0x75)+_0x28a654(-0xd8,-0x194,-0x163,-0x198)+_0x47b285(0x1c0,0x1ed,0x28d,0x278)+_0x47b285(0x177,0x1b5,0x1e9,0x16b)+_0x47b285(0xe4,0xfd,0x82,0x1a8)+_0x4f5562);}else{_0x14a428=_0x4e52cb[_0x28a654(-0x2c7,-0x23f,-0x164,-0x1fe)];let _0x2c2ce8;if(_0x46349a[_0x28a654(-0x281,-0x296,-0x220,-0x248)](_0x4e52cb[_0x28a654(-0x22e,-0x2d0,-0x370,-0x2b0)])){if(_0x4e52cb[_0x28a654(-0x178,-0x1be,-0x264,-0x23c)](_0x4e52cb[_0x47b285(0xa1,0x107,0x19a,0x1be)],'zRvua')){_0x4e52cb[_0x28a654(-0x277,-0x224,-0x153,-0x1c6)](addLog,_0x4e52cb[_0x47b285(0x238,0x19c,0xed,0x23f)]);const _0x40f39f=_0x4e52cb['gYIgZ'](_0x3dfaf7,'默认'),_0xa39ce2={};_0xa39ce2[_0x47b285(0x1aa,0x1a5,0xf5,0xda)+'on']=[],_0xa39ce2[_0x47b285(0x22f,0x1e0,0x272,0x1b9)+'t']='',_0x2c2ce8=_0x473599[_0x40f39f]||_0xa39ce2,_0x4e52cb[_0x47b285(0x13e,0x101,0x1b3,0x17c)](addLog,_0x47b285(0x1b9,0x189,0x11b,0x1f8)+_0x47b285(0x17b,0xf1,0x6b,0x27)+_0x40f39f+'\x22');}else _0x4e52cb['dVbSG'](_0x4a8f57,_0x4e52cb[_0x28a654(-0x2f8,-0x285,-0x210,-0x23b)]);}else{if(_0x4e52cb['rdElM'](_0x47b285(0x210,0x220,0x227,0x17d),_0x4e52cb[_0x28a654(-0x32c,-0x2ac,-0x2fb,-0x2b2)])){const _0x241236=_0x2cba3a[_0x28a654(-0x195,-0x24c,-0x184,-0x233)](_0x535c4b,arguments);return _0x5cbda2=null,_0x241236;}else{const _0x266abd={};_0x266abd[_0x47b285(0xe2,0x1a5,0xde,0x24f)+'on']=[],_0x266abd[_0x28a654(-0x2b3,-0x1b0,-0x2a7,-0x20a)+'t']='',_0x2c2ce8=_0x473599[_0xd39386]||_0x266abd;}}const _0x2c8ead=[_0x2c2ce8[_0x28a654(-0x288,-0x176,-0x1c2,-0x20a)+'t'],_0x872b10[_0x4e52cb[_0x47b285(0x1ae,0xe0,0x42,0xb2)]],_0x872b10[_0x4e52cb['YoCGl']],_0x113572,_0x872b10[_0x4e52cb[_0x47b285(0x11d,0x13c,0x1d7,0x1d3)]],_0x872b10[_0x4e52cb['lZJtM']],_0x2c2ce8[_0x28a654(-0x286,-0x35a,-0x22a,-0x2a4)+_0x28a654(-0x184,-0x1fd,-0x11e,-0x1af)],_0x872b10[_0x4e52cb[_0x47b285(0x244,0x1a8,0x186,0x24a)]]][_0x28a654(-0x190,-0x1f5,-0x175,-0x20f)](Boolean)['join'](',\x20');_0x4e52cb[_0x28a654(-0x39b,-0x205,-0x2fc,-0x2c9)](addLog,'正面提示词:\x20'+_0x2c8ead);const _0x252c0a={};_0x252c0a['role']=_0x47b285(0x247,0x1f2,0x131,0x213),_0x252c0a[_0x47b285(0x1c2,0x19d,0x180,0x107)]=[];const _0x454685={};_0x454685[_0x28a654(-0x279,-0x1ab,-0x175,-0x1ad)]=_0x47b285(0xdd,0xcb,0xeb,0xf),_0x454685[_0x47b285(0x23d,0x19d,0x227,0x13b)]=[];const _0x217a1d=_0x2c2ce8['conversati'+'on'][_0x28a654(-0x21d,-0x166,-0x137,-0x201)](_0x27a43d=>[_0x252c0a,_0x454685])['flat']();let _0x37af8f=0x1239*0x1+-0x14bc+0x283;for(const _0xba3ef6 of _0x2c2ce8[_0x47b285(0x177,0x1a5,0x17b,0x148)+'on']){if(_0xba3ef6['user']?.[_0x47b285(0x106,0x1d3,0x149,0x2a1)])_0x217a1d[_0x37af8f]['content'][_0x47b285(0x1b1,0xef,0xa7,0xf6)]({'type':_0x4e52cb[_0x28a654(-0x330,-0x32b,-0x32f,-0x2d2)],'text':_0xba3ef6[_0x47b285(0x206,0x1f2,0x198,0x199)][_0x47b285(0x258,0x1d3,0x141,0x259)]});const _0x522b45=await _0x4e52cb[_0x47b285(0x11f,0x103,0xd2,0xb7)](getImageFromTurnData,_0xba3ef6[_0x28a654(-0x156,-0x263,-0x2c9,-0x1f8)]);if(_0x522b45)_0x217a1d[_0x37af8f][_0x28a654(-0x2b9,-0x2b2,-0x223,-0x24d)]['push']({'type':_0x4e52cb['CmFEx'],'image_url':{'url':_0x522b45}});_0x37af8f++;if(_0xba3ef6[_0x47b285(0x161,0xeb,0x22,0x88)]?.[_0x47b285(0x173,0x1d3,0x125,0x202)])_0x217a1d[_0x37af8f]['content']['push']({'type':_0x4e52cb[_0x28a654(-0x308,-0x31f,-0x33d,-0x2d2)],'text':_0xba3ef6[_0x28a654(-0x260,-0x29e,-0x37b,-0x2ff)]['text']});const _0x3d158c=await _0x4e52cb['WqNai'](getImageFromTurnData,_0xba3ef6[_0x47b285(0x5d,0xeb,0x1c,0xc3)]);if(_0x3d158c)_0x217a1d[_0x37af8f][_0x28a654(-0x31e,-0x18b,-0x205,-0x24d)][_0x28a654(-0x352,-0x237,-0x277,-0x2fb)]({'type':_0x4e52cb[_0x28a654(-0x36d,-0x383,-0x37c,-0x2ef)],'image_url':{'url':_0x3d158c}});_0x37af8f++;}if(!_0x46349a['includes'](_0x4e52cb[_0x28a654(-0x29c,-0x296,-0x230,-0x2b0)])){if(_0x4e52cb[_0x28a654(-0x1b6,-0x167,-0x1e5,-0x1db)]('xKrkS',_0x4e52cb[_0x28a654(-0xda,-0x1d3,-0x244,-0x1a6)])){const _0x2471ca=extension_settings[extensionName]['bananaChar'+_0x28a654(-0x264,-0x14e,-0x258,-0x1ae)+'ts']||{};for(const _0x4c2093 in _0x2471ca){const _0x774d54=_0x2471ca[_0x4c2093],_0x158c19=(_0x774d54[_0x28a654(-0x261,-0x187,-0x112,-0x1a4)]||'')[_0x28a654(-0x2ad,-0x369,-0x276,-0x2f7)]('|')['filter'](_0x513b88=>_0x513b88[_0x28a654(-0x1b9,-0x125,-0x11b,-0x1b9)]()!=='');for(const _0x3fb188 of _0x158c19){if(_0x2c8ead[_0x28a654(-0x119,-0x20a,-0x287,-0x1bc)+'e']()[_0x28a654(-0x283,-0x247,-0x205,-0x248)](_0x3fb188[_0x47b285(0x20e,0x22e,0x296,0x2aa)+'e']())){if(_0x4e52cb['eoAAy'](_0x4e52cb[_0x47b285(0xf5,0x12a,0x166,0xf6)],_0x47b285(0x1b9,0x225,0x21d,0x1de))){_0x4e52cb['NFFPR'](addLog,_0x28a654(-0x236,-0x126,-0x13c,-0x1ba)+_0x28a654(-0x17e,-0x19c,-0x16f,-0x231)+_0x47b285(0x1b0,0x1d6,0x124,0x16f)+_0x47b285(0xfb,0x164,0x207,0x115)+_0x3fb188+(_0x28a654(-0x1c2,-0x2c2,-0x21d,-0x240)+_0x28a654(-0x20d,-0x1dd,-0x24a,-0x1ef))+_0x4c2093+'\x22.');const _0x1a30cf=_0x774d54[_0x47b285(0x256,0x1a5,0x1a6,0x197)+'on'];if(_0x1a30cf){if(_0x4e52cb[_0x47b285(0x295,0x20f,0x1e1,0x2a9)](_0x47b285(0xf7,0x135,0x159,0xdf),_0x4e52cb[_0x47b285(0x1db,0x13e,0xe0,0x1f1)]))_0x4d2549=_0xb4e9f6;else{const _0x282a4a=[];if(_0x1a30cf['user']&&_0x1a30cf[_0x47b285(0x143,0x1f2,0x179,0x228)][_0x28a654(-0x2d8,-0x2b9,-0x177,-0x217)])_0x282a4a['push']({'type':_0x4e52cb[_0x28a654(-0x241,-0x254,-0x2ea,-0x2d2)],'text':_0x1a30cf[_0x28a654(-0x1ab,-0x1e1,-0x171,-0x1f8)][_0x28a654(-0x2d5,-0x1d3,-0x28b,-0x217)]});const _0x2ee8c2=await _0x4e52cb[_0x47b285(0x114,0x165,0x19d,0xec)](getImageFromTurnData,_0x1a30cf['user']);if(_0x2ee8c2)_0x282a4a[_0x47b285(0x129,0xef,0xf5,0x67)]({'type':_0x4e52cb[_0x47b285(0xaa,0xfb,0xdb,0x1b3)],'image_url':{'url':_0x2ee8c2}});if(_0x4e52cb[_0x28a654(-0x2e3,-0x246,-0x338,-0x2c2)](_0x282a4a['length'],0x1*0x1543+-0x34*-0x4f+0x1*-0x254f)){if(_0x4e52cb[_0x28a654(-0x207,-0x1f5,-0x2be,-0x23c)](_0x4e52cb[_0x47b285(0x15f,0x1d1,0x121,0x254)],_0x4e52cb[_0x47b285(0x1b6,0x1de,0x271,0x286)]))_0x5a688b=_0x4e52cb[_0x47b285(0x2c8,0x238,0x2c3,0x2ea)](_0x4e52cb[_0x28a654(-0x334,-0x37c,-0x34d,-0x2d3)](_0x167931,_0x4e52cb[_0x47b285(0x27c,0x215,0x228,0x1eb)]),_0x37c23f);else{const _0x24ff09={};_0x24ff09['role']=_0x28a654(-0x1aa,-0x22c,-0x293,-0x1f8),_0x24ff09[_0x47b285(0x13a,0x19d,0x190,0x22d)]=_0x282a4a,_0x217a1d['push'](_0x24ff09);}}const _0x10bb46=[];if(_0x1a30cf[_0x47b285(0x146,0xeb,0xe5,0x186)]&&_0x1a30cf['model'][_0x47b285(0x186,0x1d3,0x232,0x139)])_0x10bb46[_0x47b285(0x1b7,0xef,0x1b8,0x18e)]({'type':_0x4e52cb[_0x47b285(0x145,0x118,0x103,0x173)],'text':_0x1a30cf[_0x47b285(0xf3,0xeb,0x32,0x108)][_0x47b285(0x239,0x1d3,0x1d8,0x24e)]});const _0x3ef686=await _0x4e52cb[_0x28a654(-0x1d0,-0x238,-0x230,-0x25f)](getImageFromTurnData,_0x1a30cf['model']);if(_0x3ef686)_0x10bb46[_0x28a654(-0x24f,-0x2dd,-0x362,-0x2fb)]({'type':_0x4e52cb['CmFEx'],'image_url':{'url':_0x3ef686}});if(_0x4e52cb[_0x47b285(0x100,0x128,0x87,0x56)](_0x10bb46[_0x47b285(0x50,0xcd,0xb4,0x105)],-0x1806+-0x2*-0x7eb+0x830)){const _0x21b2a5={};_0x21b2a5[_0x28a654(-0x171,-0x1b8,-0x167,-0x1ad)]=_0x4e52cb['Loiow'],_0x21b2a5['content']=_0x10bb46,_0x217a1d[_0x47b285(0x16a,0xef,0x29,0x8f)](_0x21b2a5);}}}break;}else return _0x4b6ef1[_0x47b285(0xf6,0xda,0x98,0x136)]()[_0x47b285(0x1b7,0x1bf,0x264,0x232)](cvyLXz[_0x47b285(0x99,0xf0,0x142,0x6e)])[_0x47b285(0x15e,0xda,0x4e,0xfd)]()[_0x28a654(-0x32d,-0x339,-0x2da,-0x2e4)+'r'](_0x28cd6b)[_0x47b285(0x1a8,0x1bf,0x140,0x1e0)](cvyLXz[_0x28a654(-0x240,-0x241,-0x393,-0x2fa)]);}}}}else return _0xbffb7c[_0x28a654(-0x1fb,-0x26a,-0x193,-0x1ec)];}if(!_0x46349a[_0x47b285(0x22e,0x1a2,0x141,0x227)](_0x47b285(0x23e,0x227,0x1c5,0x188))){if(_0x4e52cb[_0x47b285(0xcc,0x180,0x13c,0x1bb)](_0x28a654(-0x27c,-0x248,-0x24c,-0x24a),_0x4e52cb[_0x28a654(-0x282,-0x2d0,-0x311,-0x2f2)])){const _0x31fddc={};_0x31fddc[_0x47b285(0x29c,0x23d,0x24b,0x217)]=_0x4e52cb[_0x28a654(-0x100,-0x143,-0x261,-0x1d1)],_0x31fddc['content']=[{'type':_0x4e52cb[_0x28a654(-0x333,-0x38d,-0x2fa,-0x2d2)],'text':_0x2c8ead}],_0x217a1d[_0x47b285(0x9c,0xef,0x125,0x99)](_0x31fddc);}else throw new _0x50fbc0(_0x47b285(0x26d,0x23a,0x183,0x2c7)+_0x47b285(0x259,0x223,0x1e8,0x1f1)+_0x28a654(-0x274,-0x28d,-0x343,-0x2cf)+_0x1b067b[_0x28a654(-0x281,-0x1cb,-0xeb,-0x1b7)]);}else{if(_0x4e52cb[_0x47b285(0x1cc,0x182,0xb2,0xb4)]('tTtAZ',_0x4e52cb[_0x47b285(0x1a1,0x1f6,0x1ee,0x277)]))_0x337c03['on'](_0x3f77e8[_0x28a654(-0x1bc,-0x1fc,-0x153,-0x1df)+_0x47b285(0x1ef,0x1a3,0x127,0x20b)+'ST'],_0x4004a1),_0x20bf6e['on'](_0x4e52cb[_0x28a654(-0x158,-0xde,-0x16b,-0x19f)],_0x25995f),_0x4e52cb[_0x47b285(0x2e5,0x251,0x1b9,0x230)](_0x24a17b,_0x47b285(0xe6,0x1ac,0x230,0x15a)+_0x28a654(-0x3c3,-0x270,-0x313,-0x30e));else{const _0x5e39d9=[],_0x14f26c=_0x4e52cb[_0x28a654(-0x1b8,-0x1fb,-0x26c,-0x21d)](_0x2c5a73,_0x2c8ead),_0x558524=[_0x2c2ce8['fixedPromp'+'t'],_0x14f26c,_0x2c2ce8[_0x47b285(0x1c7,0x146,0x1a1,0x1a6)+'mpt']][_0x28a654(-0x23e,-0x2bc,-0x227,-0x20f)](Boolean)['join'](',\x20'),_0x4cab8c={};_0x4cab8c['type']=_0x4e52cb['zspBm'],_0x4cab8c[_0x28a654(-0x26a,-0x276,-0x162,-0x217)]=_0x558524,_0x5e39d9[_0x47b285(0xa6,0xef,0x140,0x152)](_0x4cab8c);if(_0x5c27c1){if(_0x4e52cb[_0x28a654(-0x1ff,-0x36e,-0x257,-0x2cd)](_0x4e52cb[_0x28a654(-0x33e,-0x276,-0x338,-0x328)],_0x4e52cb[_0x28a654(-0x2b0,-0x280,-0x28b,-0x328)])){const _0x1bb046={};_0x1bb046[_0x47b285(0x106,0x16b,0x14b,0x177)]=_0x5c27c1;const _0x49be36={};_0x49be36['type']=_0x4e52cb['CmFEx'],_0x49be36[_0x47b285(0x2f7,0x256,0x278,0x1ca)]=_0x1bb046,_0x5e39d9[_0x28a654(-0x366,-0x2ff,-0x384,-0x2fb)](_0x49be36),_0x4e52cb['XERmN'](addLog,'[Banana]\x20修'+'图模式：已添加待修改'+_0x28a654(-0x218,-0x267,-0x1ec,-0x1ee));}else _0x242732[_0x4e52cb[_0x28a654(-0x29c,-0x1d8,-0x240,-0x1e9)]]=_0xd0ca14;}const _0x497825={};_0x497825['role']=_0x4e52cb[_0x47b285(0x23d,0x219,0x150,0x28a)],_0x497825[_0x28a654(-0x2de,-0x17b,-0x2b5,-0x24d)]=_0x5e39d9,_0x217a1d[_0x47b285(0x19a,0xef,0x6c,0x14b)](_0x497825),_0x4e52cb[_0x28a654(-0x220,-0x290,-0x25e,-0x285)](addLog,'[Banana]\x20修'+_0x47b285(0x136,0x1fa,0x2bd,0x162)+_0x558524);}}const _0x48d9b9={};_0x48d9b9[_0x28a654(-0x327,-0x391,-0x261,-0x311)+'o']=_0x351a1f;const _0x14f680={};_0x14f680[_0x47b285(0x287,0x21d,0x183,0x1f4)+'g']=_0x48d9b9,_0x2d1ccd={'model':_0x355959,'messages':_0x217a1d[_0x28a654(-0x1c7,-0x1d8,-0x20e,-0x20f)](_0x1bcbe9=>_0x1bcbe9['content']['length']>0xa2a+0xbd9+-0x1603),'config':_0x14f680},_0x4e52cb[_0x28a654(-0x1a8,-0x30e,-0x2d8,-0x25b)](addLog,_0x28a654(-0x3d8,-0x392,-0x260,-0x31e)+'uilt\x20multi'+_0x47b285(0x159,0x1f5,0x299,0x256)+_0x28a654(-0x216,-0x247,-0x2a7,-0x264)+_0x2d1ccd[_0x28a654(-0x1a2,-0x1e4,-0x1de,-0x19e)][_0x28a654(-0x385,-0x29c,-0x376,-0x31d)]+_0x47b285(0xf8,0x130,0xf0,0xe5));}let _0x5950b8=_0x4c9b79[_0x47b285(0x239,0x1f4,0x16b,0x233)](/\/$/,''),_0x105388;if(_0x5950b8[_0x47b285(0x184,0xee,0x9c,0x17c)](_0x4e52cb[_0x47b285(0x2a0,0x215,0x1e4,0x2c3)])||_0x5950b8[_0x47b285(0x244,0x1a2,0x241,0x154)](_0x47b285(0x87,0x123,0x71,0x98)))_0x105388=_0x5950b8+_0x14a428;else{if(_0x4e52cb['adJrP'](_0x4e52cb[_0x47b285(0x170,0x151,0x212,0x171)],_0x28a654(-0x2a2,-0x21c,-0x18b,-0x216))){const _0x1aade5={};_0x1aade5[_0x28a654(-0x1aa,-0x236,-0x207,-0x1ad)]=_0x4e52cb[_0x47b285(0x1e2,0x219,0x1d2,0x20b)],_0x1aade5[_0x47b285(0xcf,0x19d,0xf6,0x22e)]=_0x61b794,_0x55bdf9[_0x47b285(0x39,0xef,0x19b,0x150)](_0x1aade5);}else _0x105388=_0x4e52cb[_0x28a654(-0x293,-0x2cd,-0x266,-0x2d3)](_0x4e52cb[_0x28a654(-0x2b3,-0x317,-0x1ab,-0x255)](_0x5950b8,_0x4e52cb[_0x47b285(0x2e6,0x215,0x2db,0x277)]),_0x14a428);}_0x105388=_0x105388['replace'](/\/v1\/v1\//g,'/v1/');const _0x26e459=extension_settings[extensionName][_0x47b285(0x213,0x159,0xb8,0x15e)];let _0x467c0f,_0x490f26,_0x2b3643;if(_0x4e52cb[_0x28a654(-0x1d0,-0x21c,-0xcd,-0x189)](_0x26e459,_0x4e52cb[_0x47b285(0x1c5,0x1ad,0x185,0x211)])){if(_0x4e52cb['KuTOB'](_0x4e52cb[_0x28a654(-0x317,-0x269,-0x308,-0x294)],_0x4e52cb[_0x47b285(0xd3,0x156,0x20a,0x172)])){let _0x451721=_0x5950b8;!_0x451721['endsWith'](_0x47b285(0x1d3,0x21b,0x281,0x187))&&!_0x451721[_0x47b285(0x14f,0x1a2,0x246,0x1a9)](_0x28a654(-0x391,-0x2a6,-0x381,-0x2c7))&&(_0x4e52cb[_0x28a654(-0x27d,-0x1ec,-0x2a6,-0x249)]!==_0x4e52cb['SfTYY']?_0x451721=_0x4e52cb[_0x28a654(-0x2e6,-0x31f,-0x2f4,-0x314)](_0x451721,_0x4e52cb[_0x28a654(-0x2a2,-0x272,-0x15d,-0x1d5)]):_0x2c29f1=!![]);_0x451721=_0x451721[_0x28a654(-0x1bc,-0x188,-0x227,-0x1f6)](/\/v1\/$/,_0x4e52cb['mngmx']),_0x467c0f=_0x28a654(-0x18b,-0x1b3,-0x232,-0x1b5)+_0x47b285(0x139,0x17d,0x1d4,0x14a)+_0x28a654(-0x1be,-0x2af,-0x297,-0x1ea)+_0x28a654(-0x2de,-0x32c,-0x26c,-0x2f3),_0x490f26=_0x4e52cb[_0x28a654(-0x26f,-0x232,-0x162,-0x1f1)](getRequestHeaders,window[_0x28a654(-0x37a,-0x311,-0x1de,-0x2af)]);const _0x1dc6db={};_0x1dc6db[_0x28a654(-0x290,-0x262,-0x201,-0x251)+_0x47b285(0x1f8,0x1e4,0x13a,0x1c4)+'ce']=_0x4e52cb[_0x28a654(-0x350,-0x23a,-0x2ac,-0x2a3)],_0x1dc6db[_0x47b285(0x18e,0x207,0x2d4,0x1b4)]=_0x451721,_0x1dc6db[_0x47b285(0x128,0x178,0x17e,0xcd)+_0x47b285(0x2b3,0x1e7,0x123,0x1ed)+'rs']=_0x28a654(-0x350,-0x2b0,-0x298,-0x2dd)+_0x47b285(0x1c5,0x255,0x1c1,0x30b)+_0x47b285(0x157,0x184,0x23f,0xc7)+_0x3ece3b+'\x22',_0x1dc6db[_0x28a654(-0x392,-0x310,-0x2a2,-0x2ff)]=_0x355959,_0x1dc6db[_0x47b285(0x305,0x24c,0x1c5,0x1d5)]=_0x2d1ccd['messages'],_0x1dc6db[_0x47b285(0x21f,0x1c9,0x133,0x25a)]=![],_0x2b3643=_0x1dc6db;if(_0x355959[_0x47b285(0x1ea,0x260,0x1a2,0x28a)](_0x4e52cb['nGPzt'])){if(_0x4e52cb[_0x28a654(-0x206,-0x2dc,-0x2a4,-0x268)](_0x4e52cb[_0x28a654(-0x277,-0x1a1,-0x219,-0x1e4)],_0x28a654(-0x255,-0x29a,-0x288,-0x25e))){const _0x5cacb0={};_0x5cacb0[_0x28a654(-0x17e,-0x2db,-0x2d3,-0x245)+'on']=[],_0x5cacb0['fixedPromp'+'t']='',_0x5cac53=_0x1e23f7[_0x81e5fe]||_0x5cacb0;}else{_0x4e52cb[_0x47b285(0x1ad,0x1f7,0x1da,0x1cb)](addLog,'[Banana]\x20I'+'magen\x20模型不支'+_0x47b285(0x15f,0x205,0x16d,0x2b6)+_0x28a654(-0x3c1,-0x347,-0x314,-0x2f4)),_0x467c0f=_0x105388;const _0x48d893={};_0x48d893[_0x47b285(0x145,0x15b,0xc5,0x12d)+'pe']=_0x47b285(0xc6,0xfe,0x192,0x121)+_0x28a654(-0x22b,-0x305,-0x216,-0x29b),_0x48d893['Authorizat'+_0x28a654(-0x171,-0x268,-0x1d4,-0x1a8)]='Bearer\x20'+_0x3ece3b,_0x490f26=_0x48d893,_0x2b3643=_0x2d1ccd;}}_0x4e52cb[_0x28a654(-0x183,-0x1b8,-0x1e7,-0x24c)](addLog,_0x28a654(-0x287,-0x1a2,-0x2ff,-0x261)+'用酒馆代理模式');}else _0x3d3e22[_0x28a654(-0x2f3,-0x327,-0x2f3,-0x257)+'ener'](_0x1e2642,_0x417e6e);}else _0x467c0f=_0x105388,_0x490f26=_0x4e52cb[_0x28a654(-0x29a,-0x2ef,-0x343,-0x30b)](getDirectHeaders,_0x28a654(-0x356,-0x276,-0x330,-0x2ec)+_0x47b285(0xa9,0x14f,0x1e2,0x13e),_0x28a654(-0x18a,-0xc4,-0x11d,-0x190)+_0x3ece3b),_0x2b3643=_0x2d1ccd,_0x4e52cb[_0x28a654(-0x1fe,-0x21d,-0x26a,-0x25b)](addLog,_0x28a654(-0x24b,-0x2ac,-0x194,-0x261)+_0x47b285(0x19e,0xe6,0x8a,0xfe));addLog(_0x28a654(-0x20f,-0x20a,-0x2c0,-0x210)+_0x47b285(0x17a,0xcf,0x191,0x105)+_0x28a654(-0x1df,-0x1be,-0x1d5,-0x25c)+_0x467c0f),_0x4e52cb[_0x47b285(0x1dd,0x224,0x2f2,0x2c5)](addLog,'[Banana]\x20P'+_0x28a654(-0x2a4,-0x2fb,-0x323,-0x2b1)+JSON[_0x47b285(0x1ff,0x24d,0x29d,0x2fe)](_0x2b3643,null,0x1b9f+-0x6d*0x1b+-0x101e));try{if(_0x4e52cb['CudFx'](_0x4e52cb[_0x47b285(0x2b0,0x241,0x1e0,0x293)],'pbEfP'))_0x43dc3f=_0x41ef20,_0x3ac2bd=_0x5b78cb(_0x4e52cb[_0x47b285(0x272,0x1bb,0x1ed,0x232)],_0x47b285(0x18e,0x25a,0x32c,0x28d)+_0x517d20),_0x2fd5cb=_0x24aa50,_0x4e52cb[_0x47b285(0xc4,0x105,0x172,0x72)](_0xf05af5,_0x47b285(0x18a,0x189,0x132,0x1f5)+_0x47b285(0x71,0xe6,0x144,0x1a1));else{taskQueue[_0x47b285(0x152,0xc7,0xea,0x38)+'us'](_0x1a056d,_0x4e52cb[_0x47b285(0x2a6,0x250,0x1a2,0x1e4)]);const _0x36fb51=await _0x4e52cb[_0x28a654(-0x2ed,-0x281,-0x315,-0x30b)](fetch,_0x467c0f,{'method':_0x4e52cb[_0x47b285(0x144,0x111,0x19f,0x55)],'headers':_0x490f26,'body':JSON[_0x47b285(0x2c5,0x24d,0x1e9,0x1f2)](_0x2b3643)});if(!_0x36fb51['ok']){const _0x3c907c=await _0x36fb51['text']();throw new Error(_0x28a654(-0x248,-0x2ec,-0x263,-0x312)+_0x28a654(-0x2d9,-0x266,-0x398,-0x2f6)+_0x28a654(-0x20b,-0x24f,-0x2e8,-0x230)+'\x20'+_0x36fb51[_0x47b285(0x254,0x233,0x291,0x2d2)]+':\x20'+_0x3c907c);}const _0x5de6ae=await _0x36fb51[_0x28a654(-0x27a,-0x2c7,-0x2be,-0x27a)]();let _0xf8cbd6='';const _0x2cc2a4=_0x5de6ae[_0x28a654(-0x2f1,-0x1a8,-0x224,-0x265)];if(_0x2cc2a4&&_0x2cc2a4[_0x47b285(0xb4,0xcd,0x15f,0x103)]>0x3*-0x61+-0x19b5+-0x8*-0x35b){const _0x46fd91=_0x2cc2a4[0x1edd*-0x1+0x76*-0x4e+0x42d1][_0x28a654(-0x221,-0x195,-0x21f,-0x192)]?.['content'];if(Array[_0x28a654(-0x39d,-0x39f,-0x222,-0x2d4)](_0x46fd91))for(const _0x3067ce of _0x46fd91){if(_0x4e52cb[_0x47b285(0xd1,0x11d,0xe2,0xdc)](_0x3067ce['type'],_0x4e52cb[_0x47b285(0x14d,0xfb,0xcf,0xb7)])&&_0x3067ce[_0x47b285(0x30d,0x256,0x1f0,0x2b0)]?.[_0x47b285(0x1b1,0x16b,0x21d,0x104)]){_0xf8cbd6=_0x3067ce[_0x28a654(-0x14e,-0x1e6,-0x188,-0x194)][_0x28a654(-0x1d3,-0x200,-0x1c8,-0x27f)];break;}}else{if(_0x4e52cb[_0x47b285(0x1ce,0x1ae,0x116,0x205)](typeof _0x46fd91,_0x4e52cb['EZtYH'])){const _0x534c65=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x1439c9=_0x46fd91['match'](_0x534c65);if(_0x1439c9&&_0x1439c9[-0x12*0xf2+0x1028+-0x1*-0xdd]){if(_0x4e52cb[_0x47b285(0x22e,0x198,0x263,0x16b)](_0x47b285(0xc2,0x192,0xfc,0x1f2),_0x4e52cb[_0x28a654(-0x104,-0x1d5,-0x219,-0x1c4)])){const _0xcf8ba2=_0x1439c9[0x62*0x1d+-0xcf4+0x1db];if(_0xcf8ba2[_0x47b285(0x289,0x260,0x2ba,0x220)](_0x47b285(0xb3,0xe1,0x81,0xbc)+'/'))_0x4e52cb[_0x47b285(0x21c,0x198,0xea,0x23c)](_0x4e52cb[_0x47b285(0x1e0,0x136,0x1eb,0x1c1)],_0x4e52cb['gWbOD'])?_0x108296[_0x4e52cb[_0x28a654(-0x272,-0x30e,-0x249,-0x271)]]=_0x107063:(addLog(_0x4e52cb[_0x47b285(0x243,0x181,0x20d,0x133)]),_0xf8cbd6=_0xcf8ba2,_0x4e52cb['OGduj'](addLog,_0x47b285(0x1ff,0x1da,0x1d1,0x25e)+_0x28a654(-0x16d,-0x186,-0xed,-0x1b4)+_0x47b285(0x206,0x19a,0xe8,0x234)+_0x28a654(-0x269,-0x2ab,-0x1e7,-0x26f)+_0x28a654(-0x22d,-0x270,-0x329,-0x25d)+'Markdown.'));else{_0x4e52cb['vdmfy'](addLog,_0x4e52cb[_0x47b285(0x1d2,0x158,0x224,0x1e1)]),addLog('[Banana]\x20M'+_0x47b285(0x1fa,0x13d,0x1ce,0x204)+'age\x20URL:\x20'+_0xcf8ba2);try{if(_0x28a654(-0x2b6,-0x2ff,-0x2c4,-0x253)===_0x4e52cb[_0x47b285(0x7c,0x11e,0x57,0x161)]){const _0x3764d7=await _0x4e52cb['IdvpD'](fetch,_0xcf8ba2,{'headers':getDirectHeaders()});if(!_0x3764d7['ok']){if(_0x4e52cb[_0x47b285(0x1cd,0x240,0x271,0x176)](_0x4e52cb['YMiMp'],_0x4e52cb[_0x28a654(-0x2ab,-0x281,-0x1ec,-0x1e1)]))throw new Error(_0x47b285(0x25d,0x23a,0x2cb,0x1ab)+_0x28a654(-0x18d,-0x199,-0x12a,-0x1c7)+_0x47b285(0x197,0x11b,0x11b,0x51)+_0x3764d7[_0x47b285(0x25d,0x233,0x1ac,0x17d)]);else{const _0x118380=_0x2396cf?function(){function _0x25cf87(_0x6c2bdb,_0x3a49ac,_0x22229f,_0x1b6fca){return _0x28a654(_0x6c2bdb,_0x3a49ac-0x51,_0x22229f-0x188,_0x22229f-0x285);}if(_0x551b02){const _0x5675d2=_0xec008e[_0x25cf87(-0x67,0x28,0x52,-0x78)](_0xeeb438,arguments);return _0x184aea=null,_0x5675d2;}}:function(){};return _0xb2a57c=![],_0x118380;}}const _0x571a0e=await _0x3764d7[_0x47b285(0x248,0x176,0x11d,0x1a0)](),_0x2a9092=await new Promise((_0x3aba75,_0x2577cb)=>{function _0x136fae(_0x1df41d,_0x102656,_0x4b0a5e,_0x5a8a6e){return _0x28a654(_0x1df41d,_0x102656-0x158,_0x4b0a5e-0xad,_0x5a8a6e-0x20d);}function _0xc487a4(_0x1d87a6,_0x2929b2,_0x451296,_0x4eaeca){return _0x47b285(_0x1d87a6-0x192,_0x2929b2-0x1e9,_0x451296-0xe1,_0x451296);}if(_0x4e52cb[_0x136fae(-0xe6,-0xa7,0x53,-0x2f)](_0x4e52cb[_0x136fae(-0x1be,-0xef,-0x17d,-0xf6)],_0x4e52cb['SoiQP']))_0x4dd68c[_0x143891][_0xc487a4(0x2d1,0x2de,0x26e,0x3a9)][_0xc487a4(0x425,0x447,0x487,0x4dd)]=-0x57*-0xa+0x227*-0x11+0x2132,_0x4e52cb[_0x136fae(-0x11a,-0x126,-0x1a3,-0xd8)](_0x5adde9,_0x136fae(-0x5b,0xdd,-0x30,0x14)+_0xc487a4(0x42f,0x43c,0x47a,0x40f)+_0x237294[_0x2b9438][_0x136fae(-0x59,-0x80,-0x140,-0xe8)]['cishu']);else{const _0x4dddb8=new FileReader();_0x4dddb8[_0xc487a4(0x336,0x2fb,0x30b,0x3b0)]=()=>_0x3aba75(_0x4dddb8[_0xc487a4(0x296,0x2d1,0x2d3,0x303)]),_0x4dddb8[_0xc487a4(0x402,0x3c2,0x34b,0x3ba)]=_0x2577cb,_0x4dddb8['readAsData'+'URL'](_0x571a0e);}});_0xf8cbd6=_0x2a9092;if(String(extension_settings[extensionName][_0x28a654(-0x25a,-0x34b,-0x263,-0x2fe)+_0x28a654(-0x22e,-0x324,-0x2bf,-0x29a)])===_0x28a654(-0x257,-0x1b9,-0x1d3,-0x1e7)){if(_0x4e52cb[_0x47b285(0x64,0xc3,0x15e,0xd1)]===_0x4e52cb[_0x28a654(-0x3f6,-0x36a,-0x3e3,-0x327)])_0xf8cbd6=await _0x4e52cb[_0x28a654(-0x315,-0x2e7,-0x2df,-0x259)](convertImageToJpeg,_0xf8cbd6);else throw new _0x157fa1(_0x4e52cb[_0x28a654(-0x25b,-0x2ba,-0x3e5,-0x326)]);}_0x4e52cb[_0x47b285(0x259,0x18b,0x1a2,0xe9)](addLog,_0x4e52cb[_0x28a654(-0x1d4,-0x1e0,-0x19a,-0x222)]);}else _0x21bd24[_0x28a654(-0x23a,-0x306,-0x2b0,-0x2b6)+_0x55ffbf+'\x20Prompt']&&(_0x70c4fc=_0x4e52cb['xSFhF'](_0x3e2471,',\x20')+_0x152aa4[_0x28a654(-0x2ea,-0x247,-0x363,-0x2b6)+_0x2b1ae2+_0x47b285(0x141,0x210,0x294,0x23a)]);}catch(_0x4f764b){_0x4e52cb['LntfD']===_0x28a654(-0x255,-0x258,-0x170,-0x1d7)?_0x31c29c=_0x370424+_0x28a654(-0x29c,-0x240,-0x29a,-0x1cf):(_0x4e52cb[_0x28a654(-0x1bb,-0x17d,-0x167,-0x236)](addLog,_0x47b285(0x261,0x230,0x186,0x277)+_0x28a654(-0x35e,-0x2d6,-0x310,-0x2db)+_0x28a654(-0xf7,-0x1f2,-0x1ac,-0x193)+_0x28a654(-0x218,-0xde,-0xf6,-0x18d)+'\x20'+_0x4f764b['message']),_0xf8cbd6=_0xcf8ba2,addLog(_0x4e52cb['zstxS']));}}}else _0x51c9e1=_0x4e52cb['gBINT'](_0x3000d8,_0x4f5522);}else _0x4e52cb['awyZp'](addLog,_0x4e52cb[_0x28a654(-0x22c,-0x299,-0x243,-0x23b)]);}}}if(!_0xf8cbd6)throw new Error(_0x4e52cb[_0x28a654(-0x39b,-0x2b6,-0x3d1,-0x326)]);_0x4e52cb[_0x47b285(0xbe,0xde,0x2f,0x83)](addLog,_0x4e52cb['ROpfB']),taskQueue[_0x47b285(0x1c4,0x19f,0x1e4,0x12f)+'sk'](_0x1a056d,!![]),currentTaskId=null;const _0x34cc0f={};return _0x34cc0f['image']=_0xf8cbd6,_0x34cc0f[_0x28a654(-0x1dd,-0x20a,-0x211,-0x1dc)]=_0x53436c||'',_0x34cc0f;}}catch(_0x4ee5d7){if(_0x28a654(-0x32e,-0x298,-0x314,-0x2ea)!==_0x4e52cb[_0x47b285(0x115,0x132,0xd3,0x129)])_0x5abf28[_0x47b285(0x2ca,0x247,0x314,0x2ba)+_0x28a654(-0x346,-0x257,-0x280,-0x2e2)+_0x28a654(-0x173,-0x1e7,-0x238,-0x18b)]&&(_0x3fc254[_0x28a654(-0x2bc,-0x1e5,-0x2c9,-0x257)+_0x28a654(-0x176,-0x146,-0x202,-0x18b)](_0x34e7b5[_0x47b285(0x2b4,0x20b,0x2ce,0x2a1)+_0x28a654(-0x285,-0x28e,-0x2ff,-0x247)+'ST'],_0x53d6fc),_0x34ee63[_0x47b285(0x1ac,0x193,0x155,0x13d)+'ener'](_0x4e52cb['bKGYi'],_0x189ce0),_0x59d10a[_0x47b285(0x11a,0x171,0x227,0x155)](_0x25b9fe=>{_0x14c4d2['removeList'+'ener'](_0x25b9fe,_0x1eed61);}),_0x5b980f['initialize'+_0x28a654(-0x36f,-0x33b,-0x22e,-0x2e2)+_0x28a654(-0x22a,-0x10f,-0x113,-0x18b)]=![],_0x4e52cb[_0x28a654(-0x266,-0x10f,-0x19e,-0x199)](_0x4089ae,_0x4e52cb['WUlHJ']));else{_0x4e52cb[_0x47b285(0x19a,0x1d8,0x1c8,0x1a7)](addLog,_0x47b285(0x23a,0x230,0x16b,0x285)+_0x47b285(0xe3,0x10e,0x112,0x137)+':\x20'+_0x4ee5d7[_0x47b285(0x295,0x258,0x2cd,0x1f2)]),console[_0x47b285(0x217,0x190,0x161,0x115)](_0x4e52cb['TkbIP'],_0x4ee5d7);if(_0x4ee5d7[_0x28a654(-0xcd,-0x119,-0x182,-0x192)]===_0x4e52cb[_0x28a654(-0x261,-0x366,-0x3aa,-0x2fd)]){}else{if(_0x4e52cb[_0x47b285(0x199,0x240,0x2dc,0x248)](_0x4e52cb[_0x28a654(-0x26b,-0x2d6,-0x2d0,-0x29d)],_0x4e52cb['CLupA'])){const _0x40e279=_0x28a654(-0x1ef,-0x1e4,-0x2d4,-0x287)+_0x47b285(0x1c1,0x208,0x1d0,0x2bf)+'failed\x20for'+_0x28a654(-0x1ba,-0x2a0,-0x294,-0x275)+_0x2b3a9e+':\x20'+_0x311863[_0x47b285(0x2cc,0x258,0x19c,0x284)];_0x4e52cb[_0x28a654(-0x20e,-0x2e0,-0x1d5,-0x2a5)](_0x5d9c5a,_0x40e279),_0x111261[_0x47b285(0x24d,0x190,0x211,0xdb)](_0x40e279);const _0x233123={};_0x233123['id']=_0x36e17d,_0x233123[_0x47b285(0x201,0x243,0x1fd,0x192)]=![],_0x233123[_0x47b285(0x1fc,0x190,0xd2,0x131)]=_0x3984af[_0x28a654(-0xd6,-0x191,-0x1c4,-0x192)],_0x233123[_0x47b285(0x21e,0x16e,0xc8,0xb4)]=_0x409851,_0x52afc8['emit'](_0x286432[_0x28a654(-0x1f2,-0x1c2,-0x22f,-0x1df)+_0x28a654(-0x1b6,-0x276,-0x29b,-0x26c)+'NSE'],_0x233123),_0x4e52cb['OdZfK'](_0x4189fe,_0x28a654(-0x222,-0x1fd,-0x2c1,-0x202)+_0x28a654(-0x1ff,-0x292,-0x25a,-0x220)+_0x28a654(-0x299,-0x31b,-0x2cd,-0x28c)+_0x47b285(0x9d,0x109,0x12d,0x1bc)+':\x20'+_0x32327d);}else taskQueue[_0x47b285(0x1ed,0x19f,0x1eb,0x209)+'sk'](_0x1a056d,![]);}currentTaskId=null;throw _0x4ee5d7;}}}export async function bananaGenerate(_0x36bf9d){const _0x88f3d6={'GaffR':'assistant','icrfd':function(_0x398c9d,_0x5b201c){return _0x398c9d(_0x5b201c);},'QMFZv':_0x4079bd(0x272,0x2e8,0x263,0x252)+'osition','iFreL':function(_0x20ec2e,_0x490b08){return _0x20ec2e<=_0x490b08;},'HoGVP':function(_0x57e029,_0x8ef701){return _0x57e029+_0x8ef701;},'twxAX':function(_0x5bb999,_0x4e641c){return _0x5bb999||_0x4e641c;},'fqpXx':_0x4079bd(0x28d,0x295,0x2de,0x200),'hxeeH':function(_0x4eeefd,_0x13dc7c){return _0x4eeefd(_0x13dc7c);},'tuunL':function(_0xa7dd30,_0x22ebeb){return _0xa7dd30(_0x22ebeb);},'ZVvxF':'{修图}','puXoQ':function(_0x14e321,_0x98a205){return _0x14e321(_0x98a205);},'HtRxf':function(_0x591055,_0x157970){return _0x591055!==_0x157970;},'jrTaM':_0x4079bd(0x156,0x19f,0x241,0x1d1),'pprrE':_0x3d26c4(0x2d0,0x282,0x1fe,0x307),'IfxbD':function(_0x108a7d,_0x50886e){return _0x108a7d!=_0x50886e;},'mKRlB':function(_0x18a42b,_0x15eb42){return _0x18a42b!==_0x15eb42;},'OqrCT':_0x4079bd(0x223,0x282,0x312,0x203),'icVpT':function(_0x1fe4cb,_0x21e25b,_0x4ed044,_0x187c60){return _0x1fe4cb(_0x21e25b,_0x4ed044,_0x187c60);},'OKgeU':function(_0x444850,_0x6ad69e){return _0x444850===_0x6ad69e;},'rrukk':_0x4079bd(0x189,0x195,0x165,0x10a),'NJZuo':function(_0x58918c,_0xa6d27){return _0x58918c+_0xa6d27;},'JhJYa':function(_0x3bbd8b,_0x25ff9f){return _0x3bbd8b(_0x25ff9f);},'HTQIC':function(_0x124441,_0x4e2ddf){return _0x124441(_0x4e2ddf);},'URNeq':function(_0x53aa49,_0x3aaf85){return _0x53aa49(_0x3aaf85);}};function _0x3d26c4(_0x50e6ea,_0x22b41e,_0x915458,_0x3eb2ca){return _0x3e6d(_0x22b41e-0x1ab,_0x3eb2ca);}clearLog();let {id:_0x442c11,prompt:_0x302430,width:_0x326ffe,height:_0x36cd27,change:_0x5a00f9,retouchPrompt:_0x5dd5cd,retouchImage:_0xc58d92}=_0x36bf9d;currentRequestId=_0x442c11,currentPrompt=_0x302430,_0x88f3d6[_0x4079bd(0x143,0x1a5,0x258,0xe9)](addLog,_0x3d26c4(0x35a,0x302,0x2be,0x3cd)+_0x3d26c4(0x310,0x2aa,0x34a,0x2a9)+_0x3d26c4(0x42b,0x372,0x401,0x3ac)+_0x4079bd(0xfb,0x1a7,0x12e,0x1c1)+'st\x20(ID:\x20'+_0x442c11+')');let _0x55248c='';_0x5a00f9?_0x55248c=_0x5a00f9[_0x3d26c4(0x2ef,0x2c3,0x381,0x22c)](_0x4079bd(0x1fd,0x2ca,0x357,0x29a),''):_0x55248c=_0x302430;if(_0x5a00f9&&_0x5a00f9[_0x4079bd(0x212,0x245,0x2ab,0x18a)](_0x88f3d6[_0x4079bd(0x188,0x1bd,0x214,0x163)])){addLog(_0x3d26c4(0x35a,0x39d,0x2cb,0x3fd)+'启动');if(_0x5dd5cd)addLog(_0x3d26c4(0x35c,0x365,0x369,0x2e4)+_0x5dd5cd);if(_0xc58d92)_0x88f3d6['puXoQ'](addLog,'修图图片:\x20[已提供'+']');}function _0x4079bd(_0x43f86c,_0x45ba26,_0x268a6f,_0x3eca8c){return _0x3e6d(_0x45ba26-0xcb,_0x43f86c);}try{if(_0x88f3d6[_0x4079bd(0x176,0x173,0x1d1,0xac)](_0x88f3d6[_0x3d26c4(0x268,0x32c,0x2ac,0x33c)],_0x88f3d6[_0x4079bd(0x259,0x1d4,0x1f6,0x260)])){const {image:_0x231b2e,change:_0x3ff2fd}=await _0x88f3d6[_0x4079bd(0x2d2,0x2ad,0x369,0x25e)](generateBananaImage,{'prompt':_0x302430,'width':_0x326ffe,'height':_0x36cd27,'change':_0x5a00f9,'retouchPrompt':_0x5dd5cd,'retouchImage':_0xc58d92});if(_0x88f3d6[_0x4079bd(0x2ac,0x20d,0x1dc,0x2b3)](extension_settings[extensionName][_0x3d26c4(0x2b4,0x37b,0x38f,0x447)],'0')){if(_0x88f3d6[_0x4079bd(0x27d,0x26a,0x2b2,0x1b8)](_0x3d26c4(0x285,0x341,0x2df,0x2a3),_0x88f3d6[_0x3d26c4(0x3af,0x380,0x3b1,0x2b9)])){const _0x4b2eb4={};_0x4b2eb4[_0x4079bd(0x2bf,0x2b1,0x2ab,0x354)]=_0x55248c,await _0x88f3d6[_0x3d26c4(0x2db,0x34e,0x41d,0x2ca)](setItemImg,_0x302430,_0x231b2e,_0x4b2eb4),addLog(_0x4079bd(0x193,0x187,0x198,0x22c)+_0x3d26c4(0x3ee,0x339,0x330,0x35f)+'\x20'+_0x302430);if(extension_settings[extensionName][_0x3d26c4(0x224,0x278,0x2de,0x330)]['cishu']){if(_0x88f3d6['OKgeU'](_0x3d26c4(0x2e0,0x248,0x316,0x2a8),_0x88f3d6[_0x4079bd(0x1b6,0x1b8,0xec,0x150)])){const _0xbfb0aa={};_0xbfb0aa[_0x4079bd(0x24b,0x2e0,0x22d,0x38e)]=_0x88f3d6[_0x4079bd(0x2a6,0x288,0x29d,0x1f9)],_0xbfb0aa[_0x4079bd(0x220,0x240,0x289,0x186)]=_0x2489ef,_0xd0e8e1[_0x3d26c4(0x2a5,0x272,0x32a,0x2bc)](_0xbfb0aa);}else extension_settings[extensionName][_0x4079bd(0x17d,0x198,0x1d6,0x143)]['cishu']=_0x88f3d6[_0x3d26c4(0x37c,0x2f7,0x2f0,0x35b)](extension_settings[extensionName]['banana']['cishu'],0x179c+0x1a79+-0x190a*0x2),_0x88f3d6[_0x4079bd(0x1cd,0x267,0x231,0x306)](addLog,_0x4079bd(0x21f,0x294,0x222,0x33c)+_0x3d26c4(0x3d0,0x3d6,0x358,0x376)+extension_settings[extensionName][_0x3d26c4(0x2ef,0x278,0x28b,0x1c1)][_0x4079bd(0x2b0,0x301,0x379,0x3bd)]);}else extension_settings[extensionName][_0x4079bd(0x17a,0x198,0x1fb,0x1a0)][_0x3d26c4(0x395,0x3e1,0x41b,0x339)]=0x1*0x1adb+0xf*0x16d+-0x303d,_0x88f3d6['hxeeH'](addLog,_0x3d26c4(0x390,0x374,0x3d9,0x3e5)+_0x3d26c4(0x31f,0x3d6,0x33f,0x457)+extension_settings[extensionName]['banana'][_0x4079bd(0x3a3,0x301,0x303,0x3bc)]);}else{_0x88f3d6[_0x3d26c4(0x2c1,0x28f,0x334,0x298)](_0x217063,'分角色模式:\x20解析带'+'坐标的提示词字符串。'),_0xca43d5=_0x3acc2a(_0x2bde6e),_0x343572=_0x5cd340[_0x88f3d6[_0x4079bd(0x29b,0x2c5,0x26c,0x284)]];for(let _0xf92595=-0xfb7+0x126d+-0x2b5;_0x88f3d6['iFreL'](_0xf92595,0x1*-0xcb7+-0x6*-0xb5+0x87d);_0xf92595++){_0x43f615['Character\x20'+_0xf92595+_0x4079bd(0x325,0x2b3,0x2a8,0x275)]&&(_0x114e9d=_0x88f3d6[_0x4079bd(0x23c,0x1e4,0x28a,0x1d2)](_0x88f3d6[_0x3d26c4(0x2b7,0x2c4,0x215,0x252)](_0x305d0c,',\x20'),_0xa25d02['Character\x20'+_0xf92595+_0x3d26c4(0x353,0x393,0x38b,0x3b0)]));}}}else _0x88f3d6[_0x3d26c4(0x2bc,0x347,0x32d,0x284)](addLog,_0x4079bd(0x283,0x1d6,0x1c2,0x287)+'库');const _0x53de0f={};_0x53de0f['id']=_0x442c11,_0x53de0f[_0x3d26c4(0x2f5,0x3c6,0x386,0x33f)]=!![],_0x53de0f['imageData']=_0x231b2e,_0x53de0f[_0x4079bd(0x297,0x211,0x2db,0x17c)]=_0x302430,_0x53de0f[_0x4079bd(0x2a3,0x2b1,0x2fd,0x281)]=_0x55248c,eventSource['emit'](EventType[_0x4079bd(0x317,0x2ae,0x346,0x27e)+'MAGE_RESPO'+'NSE'],_0x53de0f),_0x88f3d6[_0x4079bd(0x246,0x210,0x2af,0x178)](addLog,'[Banana]\x20E'+'mitted\x20suc'+_0x3d26c4(0x2f8,0x2ec,0x361,0x225)+'nse\x20for\x20ID'+':\x20'+_0x442c11);}else{const _0x346cbb=[],_0x242fbb=_0x88f3d6[_0x4079bd(0x19b,0x1c8,0x1d1,0x191)](_0x1be297,_0x4e52a7),_0x233910=[_0x530085[_0x4079bd(0x307,0x283,0x333,0x242)+'t'],_0x242fbb,_0x2c8afd['postfixPro'+_0x4079bd(0x2a4,0x2de,0x348,0x2a4)]][_0x4079bd(0x206,0x27e,0x205,0x29d)](_0x53f55f)[_0x3d26c4(0x2a6,0x29f,0x2c9,0x327)](',\x20'),_0x2d6880={};_0x2d6880['type']=_0x3d26c4(0x2be,0x356,0x2e9,0x2da),_0x2d6880[_0x3d26c4(0x33a,0x356,0x3a5,0x2a2)]=_0x233910,_0x346cbb[_0x4079bd(0x1f3,0x192,0x18f,0x148)](_0x2d6880);if(_0x52d482){const _0x321fe9={};_0x321fe9[_0x4079bd(0x19c,0x20e,0x204,0x1a5)]=_0x354509;const _0x4b2827={};_0x4b2827[_0x3d26c4(0x225,0x2c7,0x2d0,0x24c)]='image_url',_0x4b2827['image_url']=_0x321fe9,_0x346cbb['push'](_0x4b2827),_0x58a143(_0x4079bd(0x2b5,0x2fe,0x3b0,0x384)+_0x3d26c4(0x316,0x317,0x2b3,0x37b)+_0x3d26c4(0x402,0x37f,0x443,0x3f3));}const _0x5d0d17={};_0x5d0d17[_0x3d26c4(0x3ee,0x3c0,0x365,0x487)]=_0x88f3d6['fqpXx'],_0x5d0d17[_0x4079bd(0x1ed,0x240,0x2bd,0x268)]=_0x346cbb,_0x38cb8b[_0x3d26c4(0x225,0x272,0x2ee,0x314)](_0x5d0d17),_0x88f3d6[_0x3d26c4(0x38e,0x38d,0x459,0x458)](_0x5328ca,_0x4079bd(0x378,0x2fe,0x358,0x357)+_0x4079bd(0x270,0x29d,0x350,0x22d)+_0x233910);}}catch(_0x2c8fc8){const _0x1e6d6a=_0x3d26c4(0x224,0x2e6,0x306,0x394)+_0x4079bd(0x278,0x2ab,0x245,0x369)+_0x4079bd(0x277,0x1ef,0x218,0x1f7)+_0x4079bd(0x257,0x218,0x1d6,0x203)+_0x442c11+':\x20'+_0x2c8fc8['message'];addLog(_0x1e6d6a),console[_0x4079bd(0x220,0x233,0x17b,0x184)](_0x1e6d6a);const _0x35408d={};_0x35408d['id']=_0x442c11,_0x35408d['success']=![],_0x35408d[_0x4079bd(0x1f6,0x233,0x255,0x298)]=_0x2c8fc8[_0x3d26c4(0x3a7,0x3db,0x49c,0x442)],_0x35408d[_0x4079bd(0x1ed,0x211,0x1f8,0x1e2)]=_0x302430,eventSource[_0x3d26c4(0x415,0x3d7,0x3d4,0x450)](EventType[_0x3d26c4(0x3b2,0x38e,0x448,0x3af)+_0x3d26c4(0x234,0x301,0x385,0x23d)+_0x4079bd(0x260,0x2bb,0x2ca,0x21a)],_0x35408d),_0x88f3d6[_0x4079bd(0x1f1,0x26f,0x26d,0x257)](addLog,_0x4079bd(0x33a,0x28b,0x1bb,0x332)+_0x4079bd(0x223,0x26d,0x1cd,0x27c)+_0x4079bd(0x1d6,0x201,0x176,0x252)+_0x3d26c4(0x1e2,0x28c,0x348,0x1d7)+':\x20'+_0x442c11);}}function handleCancelBananaTask(_0x26f046){function _0x15ec2b(_0x446178,_0x1eb1df,_0xa4bb39,_0x307cb3){return _0x3e6d(_0x1eb1df-0xa7,_0x307cb3);}const _0x172124={'trcQx':function(_0x2965ba,_0x5c54b6){return _0x2965ba(_0x5c54b6);},'zIjfr':function(_0x102b7d,_0x5aa8ae){return _0x102b7d(_0x5aa8ae);},'BUGCh':_0x15ec2b(0x381,0x2bd,0x2bd,0x273)},{taskId:_0xbb11ca}=_0x26f046;_0x172124[_0x540f45(-0x2c0,-0x39e,-0x350,-0x2e3)](addLog,_0x540f45(-0x297,-0x3b0,-0x399,-0x30a)+'到取消任务事件\x20(T'+_0x15ec2b(0x2b2,0x28c,0x289,0x304)+_0xbb11ca+')');function _0x540f45(_0x197c89,_0x391db9,_0x431dc5,_0x2f8f72){return _0x3e6d(_0x2f8f72- -0x3cb,_0x197c89);}if(currentTaskId===_0xbb11ca&&currentRequestId){_0x172124[_0x15ec2b(0x2e8,0x254,0x22d,0x30d)](addLog,'[Banana]\x20取'+_0x540f45(-0x1c8,-0x17d,-0x312,-0x243)+'响应\x20(ID:\x20'+currentRequestId+')');const _0xbe999b={};_0xbe999b['id']=currentRequestId,_0xbe999b[_0x540f45(-0x165,-0x1e2,-0x1bc,-0x1b0)]=![],_0xbe999b[_0x15ec2b(0x25f,0x20f,0x150,0x1d8)]=_0x172124[_0x540f45(-0x22f,-0x21b,-0x158,-0x223)],_0xbe999b[_0x540f45(-0x1e5,-0x31b,-0x336,-0x285)]=currentPrompt||'',eventSource['emit'](EventType[_0x15ec2b(0x31d,0x28a,0x306,0x265)+_0x15ec2b(0x173,0x1fd,0x256,0x1d7)+_0x540f45(-0x184,-0x236,-0x10f,-0x1db)],_0xbe999b),currentTaskId=null,currentRequestId=null,currentPrompt=null;}}function initializeBananaListener(){const _0x30a9e2={'LGgvT':'st_chatu8_'+_0xad9b5e(-0x190,-0x202,-0x2d3,-0x17a)+'ana_task','Klmdp':function(_0x5e0d3b,_0x658575){return _0x5e0d3b(_0x658575);},'OywdS':'banana\x20生图事'+_0x1a0377(0x4ff,0x4f1,0x453,0x3e4)};function _0x1a0377(_0x5ad820,_0x5da539,_0xf8b3b8,_0x29420a){return _0x3e6d(_0xf8b3b8-0x39f,_0x29420a);}eventSource['on'](EventType[_0xad9b5e(-0x287,-0x1e1,-0x28b,-0x2a2)+_0x1a0377(0x5a9,0x51d,0x51a,0x490)+'ST'],bananaGenerate),eventSource['on'](_0x30a9e2[_0xad9b5e(-0x216,-0x22b,-0x270,-0x166)],handleCancelBananaTask);function _0xad9b5e(_0x42b9b6,_0x2dfca2,_0x3fc0fe,_0xf5de3f){return _0x3e6d(_0x2dfca2- -0x3c4,_0x3fc0fe);}_0x30a9e2['Klmdp'](addLog,_0x30a9e2[_0xad9b5e(-0x237,-0x20f,-0x1ad,-0x290)]);}export async function replaceWithBanana(){const _0x3385d1={'Fqeur':'image_url','EKzLE':function(_0x25ffd1,_0x5c6859){return _0x25ffd1(_0x5c6859);},'ptEtb':function(_0x9d8f0a,_0x3efe23){return _0x9d8f0a<=_0x3efe23;},'qwXVE':_0x403b07(0x3d4,0x3d2,0x37e,0x472),'bavRt':function(_0x50873a,_0x15c1a3){return _0x50873a==_0x15c1a3;},'obdUc':_0x3ce65f(-0xc4,0x5f,-0x30,-0xba),'faWWZ':function(_0x33da75,_0x21efa8){return _0x33da75!==_0x21efa8;},'IfVkZ':'UrQwa','WjOQM':_0x403b07(0x2fe,0x313,0x2f5,0x386),'xzxUD':function(_0x5a0162){return _0x5a0162();},'IimzW':_0x403b07(0x466,0x3a7,0x3d0,0x3eb),'aSHjE':_0x3ce65f(0xa5,-0x26,-0x6,0x86),'JAPdJ':_0x3ce65f(0xdf,0x134,0xf2,0x181),'vDlfG':function(_0x5d446f,_0x2d4a21){return _0x5d446f(_0x2d4a21);},'ObHGe':_0x403b07(0x320,0x30b,0x358,0x2ca)+_0x403b07(0x3b0,0x3ea,0x46d,0x444)+'ana_task'};function _0x3ce65f(_0x5efe05,_0x1bea85,_0x4fb525,_0x257143){return _0x3e6d(_0x4fb525- -0xfd,_0x1bea85);}function _0x403b07(_0x10d74b,_0x3580aa,_0x165943,_0x3ad626){return _0x3e6d(_0x3580aa-0x228,_0x3ad626);}if(_0x3385d1[_0x403b07(0x256,0x2ea,0x325,0x2aa)](extension_settings[extensionName][_0x3ce65f(0xaf,0x76,0x6,-0x4f)],_0x3385d1['obdUc'])){if(!window[_0x403b07(0x4c9,0x447,0x3cc,0x48c)+_0x3ce65f(0x1,-0x41,-0x1d,-0x11)+_0x403b07(0x48f,0x45f,0x426,0x4db)]){if(_0x3385d1[_0x3ce65f(-0x3c,0xa0,0x3c,-0x5c)](_0x3385d1[_0x3ce65f(0x108,-0x25,0x43,-0x5f)],_0x3385d1['WjOQM']))window[_0x403b07(0x506,0x447,0x50a,0x4ec)+'BananaList'+_0x403b07(0x3d0,0x45f,0x530,0x443)]=!![],_0x3385d1[_0x403b07(0x38e,0x2c1,0x24a,0x2a9)](initializeBananaListener);else{const _0x4b8f7b={};_0x4b8f7b[_0x403b07(0x37a,0x36b,0x357,0x348)]=_0x4a8d2e;const _0x1aad14={};_0x1aad14[_0x403b07(0x29a,0x344,0x2e1,0x36b)]=_0x3385d1['Fqeur'],_0x1aad14[_0x3ce65f(0x1e0,0x1f8,0x131,0x114)]=_0x4b8f7b,_0x49052e[_0x3ce65f(0x7c,0x8e,-0x36,0x5b)](_0x1aad14),_0x3385d1['EKzLE'](_0x292d47,'[Banana]\x20修'+'图模式：已添加待修改'+'的图片');}}initializeImageProcessing();}else{if(window[_0x3ce65f(0x1dc,0x136,0x122,0x123)+_0x403b07(0x298,0x308,0x3cc,0x3da)+'ener']){if(_0x3385d1[_0x3ce65f(-0x3a,0x5d,-0x53,-0xc1)]===_0x3385d1[_0x3ce65f(0x2b,0x8b,0xa9,0x3e)])for(let _0x2fa0b2=-0x1244+0x1ca4+-0xa5f;_0x3385d1['ptEtb'](_0x2fa0b2,-0xcb5+0x21*0x7e+-0x385);_0x2fa0b2++){_0x49c660['Character\x20'+_0x2fa0b2+'\x20Prompt']&&(_0x8d6f88=_0x2caa2c+_0x3385d1[_0x403b07(0x3a3,0x429,0x3d9,0x3d2)]+_0x8db464(_0x1105d6[_0x3ce65f(-0x36,-0xbc,0xf,-0x63)+_0x2fa0b2+_0x3ce65f(0x86,0x102,0xeb,0x16d)]));}else{const _0x7d99e2=_0x3385d1[_0x403b07(0x2f3,0x320,0x381,0x362)][_0x403b07(0x2ea,0x2f3,0x26b,0x3a4)]('|');let _0x2f5905=-0x1c1+0x16e6+0x1525*-0x1;while(!![]){switch(_0x7d99e2[_0x2f5905++]){case'0':_0x3385d1[_0x403b07(0x40b,0x459,0x4b1,0x50e)](addLog,'[Banana]\x20生'+_0x3ce65f(0x66,-0xc0,-0x4a,-0xb9));continue;case'1':eventSource[_0x403b07(0x434,0x393,0x3b7,0x444)+_0x3ce65f(0x84,0xdb,0x13a,0x1fe)](_0x3385d1[_0x403b07(0x329,0x2c9,0x396,0x312)],handleCancelBananaTask);continue;case'2':window[_0x403b07(0x475,0x447,0x45d,0x454)+_0x3ce65f(0x69,-0xe6,-0x1d,0x52)+_0x3ce65f(0x94,0xa6,0x13a,0x190)]=![];continue;case'3':eventSource['removeList'+_0x3ce65f(0xf1,0x177,0x13a,0x1b3)](EventType[_0x3ce65f(0x89,0x198,0xe6,0x17e)+_0x3ce65f(0xf7,-0xd,0x7e,0xdd)+'ST'],bananaGenerate);continue;case'4':LEGACY_EVENT_NAMES['forEach'](_0x57a739=>{function _0x6e58e2(_0x5c4d8b,_0x44a9bf,_0x2b1d2e,_0x15513a){return _0x403b07(_0x5c4d8b-0x170,_0x44a9bf- -0x41a,_0x2b1d2e-0x68,_0x2b1d2e);}eventSource['removeList'+_0x6e58e2(0x2,0x45,0x23,0xf6)](_0x57a739,bananaGenerate);});continue;}break;}}}}}