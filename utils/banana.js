(function(_0xd99469,_0x2168e1){function _0x4e9e5d(_0x1dcbe9,_0x452ead,_0x1b68c0,_0x3a92c2){return _0x24cd(_0x452ead- -0x358,_0x1b68c0);}const _0x2bd86f=_0xd99469();function _0x204734(_0x5def51,_0x3aaba8,_0x43939b,_0x31d4e8){return _0x24cd(_0x31d4e8- -0x125,_0x5def51);}while(!![]){try{const _0x5d3c2f=-parseInt(_0x4e9e5d(-0x124,-0xb6,-0x162,-0x62))/(-0x1e33+-0x1c7b+-0x1*-0x3aaf)*(parseInt(_0x204734(0x17b,0x104,0x8b,0x14c))/(0x47*-0x3e+-0xfe3+0x2117))+-parseInt(_0x4e9e5d(-0xf7,-0xf0,-0x9e,-0x168))/(0x1*0x25+0x84e+-0x870)*(parseInt(_0x4e9e5d(-0x1a1,-0x150,-0x195,-0xbe))/(0x635*-0x2+-0x121+0x59*0x27))+parseInt(_0x4e9e5d(-0x28d,-0x22c,-0x192,-0x1d3))/(0x1*-0xf58+0x20e4+-0x1187)*(parseInt(_0x4e9e5d(-0x262,-0x234,-0x28e,-0x1d1))/(0x2*-0x124+0x12a3+-0x1055))+parseInt(_0x4e9e5d(-0x75,-0xb0,-0x170,-0x5))/(0xdda+0x1b88+0x3*-0xdc9)+parseInt(_0x204734(0x35,0xba,0x85,0x1))/(0x1*-0x538+-0x19*0xf2+0x1ce2)+-parseInt(_0x204734(0x103,0x54,0xae,0x112))/(0x8*0x314+-0x134b*-0x1+-0x2be2)+parseInt(_0x204734(0x96,0xb1,0xc7,0xff))/(-0x315*-0x3+-0x2367+0x1a32*0x1)*(parseInt(_0x204734(0xd4,0x73,0x2c,0xb9))/(-0x268c+-0x1*0x17a9+-0xa6*-0x60));if(_0x5d3c2f===_0x2168e1)break;else _0x2bd86f['push'](_0x2bd86f['shift']());}catch(_0x3dcc84){_0x2bd86f['push'](_0x2bd86f['shift']());}}}(_0x448e,-0xa7a89+0x2dad3*0x7+-0xfa7*-0xa));const _0x37ef15=(function(){const _0x333503={};_0x333503[_0x6c1abd(0x3ec,0x470,0x403,0x47f)]=function(_0x2b207b,_0x223f04){return _0x2b207b<=_0x223f04;},_0x333503[_0x6c1abd(0x357,0x326,0x3e4,0x3f7)]=function(_0x539554,_0x1b3a91){return _0x539554+_0x1b3a91;};function _0x6c1abd(_0x1f5470,_0x2ffc1d,_0x5e33ce,_0x1a7ece){return _0x24cd(_0x5e33ce-0x259,_0x1f5470);}_0x333503['yqycv']='\x20|\x20',_0x333503['UkwqS']=function(_0x4aec90,_0x5ea176){return _0x4aec90!==_0x5ea176;},_0x333503['tqhGk']=_0x6c1abd(0x4c0,0x57f,0x4e0,0x442),_0x333503[_0x358af8(0x2dc,0x3b0,0x39b,0x3a8)]=function(_0x5456bd,_0x4f9f1b){return _0x5456bd!==_0x4f9f1b;},_0x333503[_0x6c1abd(0x30c,0x3a7,0x3bb,0x461)]=_0x6c1abd(0x426,0x4fb,0x491,0x4f4),_0x333503['SIjiv']='hblsC';const _0x3e317c=_0x333503;let _0x80100=!![];function _0x358af8(_0x4d5d19,_0x2dab22,_0x5df392,_0x64d526){return _0x24cd(_0x5df392-0x162,_0x4d5d19);}return function(_0x2b5d60,_0x191ae2){const _0xd87cf9=_0x80100?function(){function _0x37faad(_0x4f1066,_0x14058d,_0x4e2a17,_0x4608aa){return _0x24cd(_0x14058d- -0x31b,_0x4f1066);}function _0x55bb83(_0x56f15b,_0x467a5d,_0xf6e0bc,_0x16f903){return _0x24cd(_0x56f15b-0x2db,_0x467a5d);}const _0x274f93={'FpGnu':function(_0x85e1d4,_0x4456f1){function _0x29ac3d(_0x251105,_0x1e7f61,_0xd4b41c,_0x54ed4e){return _0x24cd(_0xd4b41c-0x2f1,_0x54ed4e);}return _0x3e317c[_0x29ac3d(0x415,0x471,0x49b,0x514)](_0x85e1d4,_0x4456f1);},'VFQxB':function(_0x4dfd50,_0x1bd9af){return _0x3e317c['ZYdkZ'](_0x4dfd50,_0x1bd9af);},'oxqUA':_0x3e317c[_0x55bb83(0x547,0x4c7,0x4d7,0x600)],'hCjxn':function(_0x41c5e1,_0x3d6a32){return _0x41c5e1(_0x3d6a32);}};if(_0x3e317c[_0x37faad(-0xa9,-0xc5,-0x187,-0x23)]('NfHgR',_0x3e317c['tqhGk'])){if(_0x191ae2){if(_0x3e317c[_0x37faad(-0x102,-0xe2,-0x10c,-0x19c)](_0x3e317c[_0x37faad(-0x264,-0x1b9,-0x1cd,-0x1ae)],_0x3e317c['SIjiv'])){const _0x208392=_0x191ae2[_0x37faad(-0x1a6,-0x1b7,-0x23e,-0x195)](_0x2b5d60,arguments);return _0x191ae2=null,_0x208392;}else{const _0xcf568c=new _0x456c47();_0xcf568c[_0x55bb83(0x4fe,0x4b8,0x4c8,0x4f6)]=()=>_0x30060d(_0xcf568c[_0x37faad(-0x114,-0x8b,0x37,-0xf0)]),_0xcf568c['onerror']=_0x5267f5,_0xcf568c[_0x37faad(-0xfa,-0xad,-0x77,-0xaf)+_0x37faad(-0x1c1,-0x1bb,-0x15b,-0x229)](_0x35ef09);}}}else for(let _0x2eaa6b=0x1f77+0xd7*0x29+-0x41e5;_0x274f93[_0x37faad(-0x1da,-0x15a,-0xee,-0x135)](_0x2eaa6b,-0x707+-0xf40+0x164b);_0x2eaa6b++){_0x18f8f3[_0x37faad(-0x1d,-0xb4,-0xe2,-0x12e)+_0x2eaa6b+_0x55bb83(0x49b,0x533,0x507,0x4c4)]&&(_0x33477a=_0x274f93[_0x55bb83(0x4d9,0x478,0x594,0x575)](_0x214d57+_0x274f93[_0x55bb83(0x563,0x60f,0x4e4,0x5ca)],_0x274f93['hCjxn'](_0x2ecde1,_0x5ed0c2[_0x55bb83(0x542,0x5ca,0x538,0x532)+_0x2eaa6b+_0x55bb83(0x49b,0x503,0x473,0x4f8)])));}}:function(){};return _0x80100=![],_0xd87cf9;};}()),_0x7fe0ee=_0x37ef15(this,function(){function _0x53846a(_0x1d719e,_0x1e6a56,_0x5de9c3,_0x440b22){return _0x24cd(_0x440b22- -0xdd,_0x1e6a56);}const _0x4a6bcc={};function _0x10de72(_0x4a7c9a,_0x43d936,_0x12686b,_0x3714ec){return _0x24cd(_0x4a7c9a-0x277,_0x43d936);}_0x4a6bcc['XPMYH']=_0x10de72(0x3aa,0x303,0x3eb,0x3fc)+'+$';const _0x41e092=_0x4a6bcc;return _0x7fe0ee[_0x10de72(0x4be,0x477,0x4f3,0x56e)]()['search']('(((.+)+)+)'+'+$')[_0x10de72(0x4be,0x4c2,0x45d,0x49e)]()[_0x53846a(0x1e1,0xcc,0x189,0x165)+'r'](_0x7fe0ee)[_0x10de72(0x4ce,0x577,0x4eb,0x51f)](_0x41e092[_0x53846a(-0x24,0x102,-0x15,0x59)]);});_0x7fe0ee();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x4830f3){const _0xed4342={'mUcnq':_0x12496b(-0x256,-0x25c,-0x1af,-0x1ee),'ZSiDn':function(_0x3ca155,_0x575e5a){return _0x3ca155(_0x575e5a);},'lKciq':function(_0x51e8f8,_0x3bdd05){return _0x51e8f8||_0x3bdd05;}};function _0x12496b(_0x41d883,_0x1bd97b,_0x125e0e,_0x29522b){return _0x24cd(_0x1bd97b- -0x3c7,_0x29522b);}function _0x341a2b(_0x5c7139,_0xc999dd,_0x5d52a6,_0x2ca660){return _0x24cd(_0x5d52a6- -0x1ba,_0xc999dd);}if(!_0x4830f3)return'';if(_0x4830f3['imageId']&&_0x4830f3['imageId'][_0x12496b(-0x110,-0x1b7,-0x21c,-0x10d)](_0xed4342[_0x341a2b(0x5c,-0x5b,0xc,-0x8)])){const _0x1f7395=await _0xed4342[_0x341a2b(0x97,0x4a,0x47,0x8)](getConfigImage,_0x4830f3[_0x12496b(-0x138,-0x1a0,-0x22c,-0x143)]);return _0xed4342[_0x341a2b(0x7a,0x53,0xd7,0xc3)](_0x1f7395,'');}if(_0x4830f3[_0x341a2b(-0x6a,0x1d,-0x8,0x48)]&&_0x4830f3[_0x341a2b(-0x60,-0xc8,-0x8,0x5f)][_0x341a2b(-0x5b,0x9c,0x56,0x4f)](_0x341a2b(0x46,0xf7,0xab,0x53)))return _0x4830f3[_0x12496b(-0x2a8,-0x215,-0x184,-0x26a)];return'';}async function generateBananaImage({prompt:_0x2ba35a,width:_0x24921e,height:_0xee73df,change:_0x2f8f4e,retouchPrompt:_0x251e53,retouchImage:_0x351973}){const _0x467a5b={'gcMIr':function(_0x1560c5,_0x3cd88f){return _0x1560c5(_0x3cd88f);},'sctAw':function(_0x1e3251,_0x1643bc){return _0x1e3251(_0x1643bc);},'tCdFu':'3|2|0|4|1','HPdOo':_0x4a0f83(0xfc,0xac,0xa6,0x14e),'GeOzN':function(_0x17f210,_0x149fba){return _0x17f210||_0x149fba;},'caTMi':function(_0x9015ca,_0x3627c1){return _0x9015ca(_0x3627c1);},'mYyvF':function(_0x19946d,_0x21bc16){return _0x19946d(_0x21bc16);},'tbuOm':_0x4a0f83(0x21c,0x186,0x22b,0x1d0),'PTOOT':function(_0x1c6cbe,_0x10348a){return _0x1c6cbe+_0x10348a;},'xtiZS':_0x4a0f83(0x213,0x347,0x1f5,0x289)+'图事件监听器已关闭。','WywiF':_0x28f5f1(-0xe5,-0xa5,-0x92,-0x10),'IZSOZ':function(_0x2dd039,_0x2b4a4b){return _0x2dd039(_0x2b4a4b);},'vmXhm':function(_0x2a3a1f,_0x35a718){return _0x2a3a1f(_0x35a718);},'qvShl':_0x4a0f83(0x16c,0x153,0x1df,0x1b8)+'件监听器已初始化。','ayXWe':'[Banana]\x20U'+_0x28f5f1(-0x105,-0xce,-0xfd,-0x126)+_0x4a0f83(0x195,0x188,0x1b1,0x1af)+_0x28f5f1(-0x90,-0xc7,-0xf9,-0xd1),'TfjqZ':_0x28f5f1(-0x12c,-0x10d,-0xf2,-0x145),'OXMXR':function(_0x170cc8,_0x1806aa){return _0x170cc8||_0x1806aa;},'YaZdh':function(_0x4474dc,_0x16fd83){return _0x4474dc(_0x16fd83);},'JDmrC':'user','OTzgW':function(_0x38bdcd,_0x2c4aff){return _0x38bdcd(_0x2c4aff);},'OIATY':_0x28f5f1(-0xb6,-0x4e,0x4f,0x1a),'ccwbK':_0x28f5f1(-0x10,-0x6b,-0x1,-0x10c)+_0x4a0f83(0x1fd,0x263,0x27d,0x22f),'gtExt':function(_0x53c1cd,_0x4d8148){return _0x53c1cd(_0x4d8148);},'NDZsu':function(_0x1f776a){return _0x1f776a();},'PAIpK':function(_0xa04ff4,_0x2db31d){return _0xa04ff4===_0x2db31d;},'UiSnR':'4|3|2|1|0','cTeML':function(_0x8c4003,_0x3ece78){return _0x8c4003===_0x3ece78;},'lmACn':_0x28f5f1(-0xed,-0x3f,-0xd1,0x36),'HjPXv':'SNCCY','PwRit':'/v1/','mtWGN':function(_0x333d19,_0x4bfb28){return _0x333d19+_0x4bfb28;},'aaKug':'/api/backe'+'nds/chat-c'+_0x4a0f83(0x1c3,0x289,0x2c7,0x279)+_0x28f5f1(-0xb2,-0x119,-0xa4,-0x182),'vfoFK':function(_0x1b89be,_0xc0caee){return _0x1b89be(_0xc0caee);},'LGKHa':_0x28f5f1(-0x19f,-0x120,-0xbe,-0xd2),'YEwqb':'(((.+)+)+)'+'+$','yMtjJ':function(_0x4d11bd,_0xfa5ed2){return _0x4d11bd||_0xfa5ed2;},'dvoHI':function(_0x63ce58,_0x45f136){return _0x63ce58>_0x45f136;},'XcYRQ':_0x28f5f1(-0x116,-0x132,-0x12d,-0xb6),'aKgrY':function(_0x219932,_0x1a743b){return _0x219932(_0x1a743b);},'VODDo':'Scene\x20Comp'+_0x28f5f1(-0xaa,0xf,-0x2c,0x9d),'cDXrs':function(_0x41a8fc,_0x58e29c){return _0x41a8fc!==_0x58e29c;},'gxALh':'vAWqw','aQfok':'XMrDT','SIFEh':function(_0x5881d1,_0x3258){return _0x5881d1(_0x3258);},'wtYOK':_0x28f5f1(-0xca,-0xc,-0x86,-0x40),'MEZIi':function(_0xfe411c,_0x3656c9){return _0xfe411c!==_0x3656c9;},'TXpoJ':_0x28f5f1(-0xc2,-0xd3,-0xf0,-0xff),'hvohG':_0x4a0f83(0x275,0x1dc,0x256,0x25f),'aORNX':'GedPn','nKaxm':function(_0x223dee,_0x167ba7){return _0x223dee(_0x167ba7);},'OgAqb':function(_0x278812,_0x10c92c,_0xf6aa98){return _0x278812(_0x10c92c,_0xf6aa98);},'sXBME':function(_0x4e63a3,_0x23e703){return _0x4e63a3!==_0x23e703;},'KTmuW':_0x4a0f83(0xf4,0x15f,0x196,0x10f),'fGRNA':function(_0x1ca478,_0x46ac6a){return _0x1ca478<=_0x46ac6a;},'VLtWx':_0x28f5f1(-0x44,-0x76,-0x33,0x1a),'iZDEk':_0x28f5f1(-0x7c,-0x2b,-0x96,-0x9a),'pgxih':function(_0x1d75ef,_0x50f253){return _0x1d75ef(_0x50f253);},'eVQkd':function(_0x1a7d30,_0x5cb508){return _0x1a7d30===_0x5cb508;},'DtqbD':'FxMyd','trHIv':_0x28f5f1(-0xd8,-0xba,-0xce,-0x13),'xyLRa':_0x4a0f83(0x155,0x100,0xef,0x170),'gTgbT':'/v1/chat/c'+'ompletions','UrxDL':function(_0x54125f,_0x2ef2b7){return _0x54125f!==_0x2ef2b7;},'BrfFw':_0x4a0f83(0x20b,0x33a,0x1eb,0x27e),'EMadO':_0x4a0f83(0x124,0xf7,0x161,0x189),'jYhtb':'[Banana]\x20启'+_0x28f5f1(-0x5,0x33,0x7d,0xaf)+'。','GAycN':function(_0x2da7c8,_0x47c8ab){return _0x2da7c8||_0x47c8ab;},'cQaod':function(_0x2497a6,_0x159cf7){return _0x2497a6(_0x159cf7);},'BWAAM':function(_0x519ca6,_0x54847d){return _0x519ca6!==_0x54847d;},'DAXfF':_0x28f5f1(-0x137,-0x90,-0x73,0x17),'NgKpc':'前置前','ZVAYD':_0x28f5f1(0x20,0x1e,0xd0,0x15),'PhDUt':_0x4a0f83(0x1b8,0x1d4,0x181,0x16a),'OGpkd':function(_0x202f8e,_0x3a1a19){return _0x202f8e(_0x3a1a19);},'JjJxI':_0x4a0f83(0x249,0x23f,0x15d,0x1bd),'YokMR':function(_0x5ba6a2,_0x14b41f){return _0x5ba6a2!==_0x14b41f;},'PkdRi':'dkRUl','hMWKb':function(_0x4f88a1,_0x2b311d){return _0x4f88a1(_0x2b311d);},'DGclN':function(_0x13fb1e,_0x257455){return _0x13fb1e(_0x257455);},'SFGKK':_0x4a0f83(0x1ae,0x2cb,0x1fb,0x245),'SayHt':_0x4a0f83(0x2b2,0x1e6,0x1fc,0x249),'NgvvZ':function(_0x159bb6,_0x2351b9){return _0x159bb6!==_0x2351b9;},'gqapC':_0x4a0f83(0x23a,0x285,0x2dd,0x268),'RAqPI':function(_0xdd57fd,_0xddf90f){return _0xdd57fd||_0xddf90f;},'hEvRY':_0x4a0f83(0x81,0x195,0xe8,0x109),'YwjkC':function(_0x4f8b38,_0x35e40c){return _0x4f8b38(_0x35e40c);},'lRIAl':_0x28f5f1(-0x55,0x16,-0x58,-0xa9),'hIKnn':_0x28f5f1(-0x8a,-0xbe,-0x113,0x2),'WoTDV':function(_0x4668f2,_0x4c41d0){return _0x4668f2===_0x4c41d0;},'lclBV':_0x4a0f83(0x216,0x1fb,0x166,0x1d4),'eFuvU':_0x4a0f83(0x1cf,0x22e,0x1ff,0x17e),'RkmWq':_0x4a0f83(0x2c2,0x1c2,0x20f,0x26c),'JxuzW':function(_0x164556,_0x4c896d){return _0x164556(_0x4c896d);},'VIKrm':_0x28f5f1(-0x4b,-0xf7,-0x11a,-0x1b0),'PpmCP':'eZLRD','qbjEp':_0x4a0f83(0x2f8,0x28e,0x1db,0x286),'GcGuG':_0x28f5f1(-0x188,-0xdd,-0x9d,-0x13c),'Eobdj':_0x4a0f83(0xba,0x160,0x181,0x176),'kySDK':function(_0x410641,_0x1d7d38){return _0x410641===_0x1d7d38;},'oSQTL':_0x28f5f1(-0x78,-0x138,-0xa2,-0x1ae),'gqcRH':_0x28f5f1(-0xd3,-0x10c,-0x1b3,-0x15a),'iJsDJ':function(_0x3ba3d6,_0x23424d){return _0x3ba3d6!==_0x23424d;},'pQRCp':_0x4a0f83(0x209,0x1cc,0x13f,0x168),'rCVPs':'accDv','qAcbF':'[Banana]\x20D'+_0x4a0f83(0x7e,0x139,0x68,0x10d)+_0x4a0f83(0x133,0x277,0x168,0x1b4)+_0x28f5f1(-0x48,0x2a,-0x76,0xa5)+_0x28f5f1(0x5c,-0x49,0xf,-0xb8)+'g\x20URL...','rEtyB':function(_0x14b81c,_0x3c8704){return _0x14b81c(_0x3c8704);},'adTdL':function(_0x331175,_0x366d86){return _0x331175===_0x366d86;},'fJfSK':_0x28f5f1(-0xda,-0xc1,-0x124,-0x5c)+_0x4a0f83(0x1ca,0x244,0x199,0x191)+_0x4a0f83(0x2ee,0x1f3,0x23b,0x26b)+_0x4a0f83(0xba,0x165,0x18d,0x14b)+_0x28f5f1(-0x51,-0xb,0x75,-0x6a)+'base64.','puvuL':function(_0x3234f3,_0x311aa9){return _0x3234f3(_0x311aa9);},'guPwu':function(_0xe8fbf2,_0x5a9dbc){return _0xe8fbf2(_0x5a9dbc);},'HMaGq':_0x28f5f1(-0x115,-0x58,-0x50,0x30)+'esponse\x20co'+_0x28f5f1(0xa4,-0x1,-0x14,-0x98)+_0x28f5f1(-0x36,0x3f,0xa,-0x4f)+'\x20image.','MthIf':function(_0x2919a0,_0x306df0){return _0x2919a0===_0x306df0;},'ZcoUa':'phdXK','yuJOb':_0x28f5f1(-0x130,-0xe6,-0x2f,-0x7b)+_0x4a0f83(0x15b,0x105,0x169,0x141)+_0x4a0f83(0x1dd,0x29f,0x218,0x202)+_0x4a0f83(0x17b,0x15d,0x2ab,0x1f1)+_0x4a0f83(0x164,0x225,0x183,0x1e3)+'t','orCQY':function(_0x282123,_0xbe7cdf){return _0x282123(_0xbe7cdf);},'vWcSI':_0x28f5f1(-0xe8,-0xb4,-0xd9,-0x27)+'mage\x20gener'+_0x4a0f83(0x200,0x20d,0xec,0x153)+'ssfully.','CLYPA':'[Banana]\x20F'+_0x4a0f83(0x19a,0x138,0xbe,0x128)+':'};_0x467a5b[_0x28f5f1(-0xc,-0x45,-0x2c,-0x60)](clearLog);const _0x38080a=taskQueue[_0x28f5f1(-0x13,-0x3a,-0x73,-0x16)]({'name':_0x467a5b[_0x28f5f1(-0x143,-0x9f,-0x133,-0xac)](_0x2ba35a,'')[_0x28f5f1(-0xb4,-0x104,-0x154,-0x130)](0xf50+-0x1905+-0x1f1*-0x5,0x43*0x11+0x4*-0x662+0x43*0x51)+(_0x2ba35a&&_0x467a5b[_0x4a0f83(0x268,0x2d3,0x197,0x236)](_0x2ba35a[_0x28f5f1(-0xe1,-0x97,-0x19,-0x132)],0x1002+0x191e+-0x1*0x2902)?_0x467a5b['XcYRQ']:''),'type':TaskType['BANANA'],'prompt':_0x2ba35a});currentTaskId=_0x38080a,_0x2ba35a=processCharacterPrompt(_0x2ba35a),_0x2ba35a=await _0x467a5b[_0x4a0f83(0x198,0x134,0x138,0x111)](stripChineseAnnotations,_0x2ba35a);let _0x1c9b42=_0x2f8f4e;_0x2f8f4e=_0x467a5b[_0x4a0f83(0x16f,0x245,0x169,0x20c)](processCharacterPrompt,_0x2f8f4e),_0x2f8f4e=await _0x467a5b[_0x4a0f83(0xff,0xf6,0xf9,0x192)](stripChineseAnnotations,_0x2f8f4e),_0x467a5b['vfoFK'](addLog,'开始\x20Banana生'+_0x4a0f83(0x1d8,0x1dd,0x310,0x27a)+extension_settings[extensionName][_0x4a0f83(0x14d,0xae,0x96,0x13b)]),addLog(_0x4a0f83(0xd5,0x1d7,0x1b1,0x178)+'\x20'+(_0x24921e||'默认')+_0x28f5f1(-0x10a,-0x129,-0x1af,-0x174)+_0x467a5b[_0x28f5f1(0x19,-0xa0,-0xdb,-0xe5)](_0xee73df,'默认')),_0x2ba35a=_0x2f8f4e&&_0x2f8f4e[_0x4a0f83(0x14c,0x187,0x16d,0x158)]()!==''?_0x2f8f4e:_0x2ba35a,addLog(_0x4a0f83(0x2b4,0x240,0x1e1,0x278)+_0x2ba35a);let _0x60f3cb=![];if(_0x2ba35a[_0x4a0f83(0xbe,0x153,0x17d,0x157)](_0x467a5b[_0x4a0f83(0x2f9,0x2ad,0x28c,0x28c)])){if(_0x467a5b['cDXrs'](_0x467a5b['gxALh'],_0x467a5b[_0x4a0f83(0x104,0x1a8,0x107,0x15c)]))_0x60f3cb=!![];else{const _0x2b7797='[Banana]\x20G'+'eneration\x20'+_0x4a0f83(0xf3,0x17c,0xf0,0x1aa)+'\x20ID\x20'+_0x3d9bca+':\x20'+_0x5caace[_0x28f5f1(-0x50,-0x106,-0x68,-0x114)];_0x467a5b['gcMIr'](_0x5db642,_0x2b7797),_0x53c503[_0x4a0f83(0x25d,0x17d,0x209,0x200)](_0x2b7797);const _0x2d59cb={};_0x2d59cb['id']=_0xf74de4,_0x2d59cb['success']=![],_0x2d59cb[_0x28f5f1(-0x4e,-0x40,-0x64,0x81)]=_0x20be16['message'],_0x2d59cb[_0x4a0f83(0xbd,0x184,0x1bd,0x161)]=_0x4b1bc3,_0x58d0a6[_0x28f5f1(-0x137,-0x10e,-0x1cc,-0x126)](_0x42c7dd[_0x28f5f1(-0x91,-0xda,-0xb3,-0x64)+_0x28f5f1(0x36,-0x25,0x35,0x1d)+'NSE'],_0x2d59cb),_0x467a5b[_0x28f5f1(-0x43,-0xae,-0xf,-0x65)](_0x272abf,'[Banana]\x20E'+_0x4a0f83(0x1bb,0x183,0x193,0x17c)+_0x4a0f83(0x1f0,0x1b4,0x155,0x195)+_0x28f5f1(0x2f,-0x64,0x5d,-0xa9)+':\x20'+_0x260324);}}_0x467a5b[_0x28f5f1(-0x48,-0xe1,-0xa4,-0x18e)](addLog,'是否启用分角色模式\x20'+_0x4a0f83(0x310,0x2ed,0x2d3,0x280)+_0x4a0f83(0xa9,0xa1,0x14f,0x150)+_0x60f3cb);let _0x4afba2={},_0x5793be='',_0x2992af='';if(_0x60f3cb){if(_0x467a5b[_0x4a0f83(0x177,0x247,0x1d9,0x1eb)](_0x467a5b[_0x4a0f83(0x11e,0x17a,0x143,0x1ce)],_0x467a5b[_0x28f5f1(-0x8d,-0x72,-0x10d,-0x4b)]))return _0x2c88fa[_0x4a0f83(0x114,0x22f,0x1dc,0x198)];else{_0x467a5b[_0x28f5f1(-0xc1,-0x3b,0x4,0x7a)](addLog,_0x28f5f1(-0xd5,-0x9d,-0x48,-0x5b)+_0x28f5f1(0x5d,0x43,0xcf,-0x7f)),_0x4afba2=_0x467a5b[_0x28f5f1(-0x1c2,-0x12f,-0x123,-0x188)](parsePromptStringWithCoordinates,_0x2ba35a),_0x5793be=_0x4afba2[_0x4a0f83(0x1c1,0xe0,0x14a,0x12c)+_0x28f5f1(0xba,0xf,0x95,-0x8b)];for(let _0x554568=-0xd42+0x3*-0x273+0x1*0x149c;_0x554568<=-0x1684+0xaa3+0xbe5;_0x554568++){if(_0x4afba2[_0x4a0f83(0x295,0x2cd,0x27b,0x24d)+_0x554568+_0x28f5f1(-0xd0,-0x9a,0x1e,-0x9)]){if(_0x467a5b[_0x28f5f1(-0x53,0x45,0xe7,0x2d)](_0x467a5b[_0x4a0f83(0x185,0x18e,0x1e8,0x231)],_0x467a5b[_0x28f5f1(0x3a,0x1,-0x4,0x25)]))_0x2992af=_0x467a5b['mtWGN'](_0x467a5b[_0x28f5f1(-0xad,-0x75,-0xba,0x0)](_0x2992af,',\x20'),_0x4afba2['Character\x20'+_0x554568+_0x28f5f1(-0x2,-0x9a,-0x7b,-0x93)]);else{const _0x573cdf=_0x467a5b[_0x28f5f1(-0x61,0x47,0xee,-0x73)]['split']('|');let _0x191bff=0x2*-0x1358+-0x7b*0x1e+0x3cb*0xe;while(!![]){switch(_0x573cdf[_0x191bff++]){case'0':_0x3c8e56=null;continue;case'1':_0x3f36ba=null;continue;case'2':_0x1f999e[_0x4a0f83(0x15a,0xb6,0x1c6,0x132)](_0x21bcb1[_0x28f5f1(-0x150,-0xda,-0x11d,-0x97)+_0x4a0f83(0x1e5,0x200,0x290,0x21b)+_0x4a0f83(0xa2,0xd0,0x196,0x142)],{'id':_0x55c1dc,'success':![],'error':_0x467a5b[_0x4a0f83(0x120,0xef,0x256,0x19f)],'prompt':_0x467a5b[_0x4a0f83(0x1a0,0x24b,0x2de,0x261)](_0x333787,'')});continue;case'3':_0x467a5b[_0x28f5f1(-0x117,-0x85,-0x9,-0x120)](_0x1dc7f7,_0x28f5f1(-0x60,-0x11d,-0x115,-0x132)+_0x4a0f83(0x217,0x237,0x12e,0x1da)+_0x28f5f1(-0x3f,-0x8e,0x1,-0x108)+_0xf5fcdc+')');continue;case'4':_0x286332=null;continue;}break;}}}}}}else{if(_0x467a5b[_0x4a0f83(0x1e1,0x1dc,0x21d,0x185)](_0x467a5b[_0x28f5f1(-0x128,-0x110,-0x1bf,-0x157)],_0x28f5f1(-0x68,-0x32,-0x3d,-0x98)))_0x467a5b[_0x28f5f1(0x12,-0x68,-0x2f,-0x48)](addLog,'标准模式:\x20使用请求'+_0x4a0f83(0x1c7,0x177,0x275,0x22a)),_0x5793be=_0x2ba35a;else{_0x467a5b[_0x4a0f83(0x249,0x180,0x212,0x205)](_0x54dabc,_0x4a0f83(0x1a8,0x23f,0x1ee,0x1ae)+'启动');if(_0x694fd7)_0xe7dd32('修图指令:\x20'+_0x1c4853);if(_0x3d1dc8)_0x467a5b[_0x28f5f1(-0x8a,-0xae,-0x137,-0x25)](_0x45998c,'修图图片:\x20[已提供'+']');}}let {modifiedPrompt:_0x2890d1,insertions:_0x3007ea}=await _0x467a5b[_0x4a0f83(0xf4,0x160,0xe7,0x152)](prompt_replace,_0x5793be,_0x2992af);if(_0x60f3cb){if(_0x467a5b[_0x28f5f1(-0x56,-0x1f,0x10,-0x92)](_0x467a5b[_0x28f5f1(0x7b,0x4d,0x88,0x41)],'TEQYq')){const _0x4ad7ad=_0x47e30e?function(){if(_0x46e698){const _0x2b7323=_0x24fcb1['apply'](_0x1afa79,arguments);return _0x3ca306=null,_0x2b7323;}}:function(){};return _0x38301e=![],_0x4ad7ad;}else for(let _0x190d53=-0xfe2+-0x1df+0x11c2;_0x467a5b[_0x28f5f1(-0x141,-0x113,-0xe9,-0xca)](_0x190d53,0x178*0x1+-0x7*-0x3f1+-0x5cf*0x5);_0x190d53++){_0x4afba2[_0x28f5f1(0x24,0xd,-0x54,0x43)+_0x190d53+_0x28f5f1(0x26,-0x9a,-0x78,0x2)]&&(_0x467a5b[_0x28f5f1(0x2f,-0x1f,-0x71,0x85)](_0x467a5b['VLtWx'],_0x467a5b[_0x4a0f83(0x194,0x157,0x1c5,0x1b1)])?_0x2890d1=_0x467a5b[_0x4a0f83(0x283,0x164,0x18e,0x1ed)](_0x467a5b[_0x28f5f1(-0x5f,-0x53,-0xc4,0x43)](_0x2890d1,_0x467a5b[_0x4a0f83(0x1cb,0x309,0x1af,0x247)]),_0x467a5b[_0x4a0f83(0x25b,0x2c2,0x202,0x24a)](prompt_replace_for_character,_0x4afba2[_0x4a0f83(0x1e8,0x264,0x306,0x24d)+_0x190d53+_0x4a0f83(0x234,0x149,0x15d,0x1a6)])):_0x122e5b=_0x7404a7['replaceAll'](_0x467a5b[_0x28f5f1(-0xaa,-0x108,-0x6b,-0x168)],''));}}const _0x3d4675=extension_settings[extensionName][_0x28f5f1(-0x3e,-0x4c,-0xf0,0x4f)],{model:_0x252474,apiUrl:_0x631fbd,apiKey:_0x4cd8a2,conversationPresets:_0x4936e4,conversationPresetId:_0x55c2f5,editPresetId:_0x212b99,aspectRatio:_0x41e089}=_0x3d4675;_0x467a5b[_0x28f5f1(-0x25,-0xcb,-0xe1,-0x98)](addLog,_0x28f5f1(-0x47,-0xc1,-0x17e,-0x13)+_0x28f5f1(-0x94,-0x112,-0xce,-0x1c5)+_0x4a0f83(0x211,0xa8,0xb2,0x14d)+_0x4a0f83(0x223,0x1a3,0x188,0x1a4)+_0x28f5f1(-0xbf,-0x2,0x58,-0x6f)+_0x252474);let _0x1a1ac5,_0x22a574;function _0x4a0f83(_0x33caf1,_0x13b08e,_0x4ad024,_0x582bc5){return _0x24cd(_0x582bc5- -0x1a,_0x33caf1);}if(_0x252474[_0x28f5f1(0x73,-0x4a,0x7,0x4c)]('imagen')){if(_0x467a5b[_0x4a0f83(0x1da,0x136,0x299,0x1f9)](_0x467a5b['DtqbD'],_0x467a5b[_0x28f5f1(-0x134,-0x122,-0x1e3,-0xc7)])){_0x1a1ac5=_0x28f5f1(0x38,-0x26,-0xc2,0x31)+_0x28f5f1(-0x8d,-0x89,-0x136,-0x130)+_0x252474;const _0x305feb={};_0x305feb[_0x28f5f1(-0x33,-0xdc,-0x199,-0x34)+'t']='';const _0x1f7b83=_0x4936e4[_0x55c2f5]||_0x305feb,_0x542600=[_0x1f7b83[_0x4a0f83(0x12f,0x174,0x1cb,0x164)+'t'],_0x3007ea[_0x28f5f1(-0xe6,-0xdb,-0x80,-0x3f)],_0x3007ea[_0x467a5b[_0x4a0f83(0x320,0x1df,0x2eb,0x260)]],_0x2890d1,_0x3007ea[_0x467a5b['xyLRa']],_0x3007ea['后置后'],_0x1f7b83[_0x28f5f1(-0xa5,-0x103,-0x1a3,-0x142)+_0x28f5f1(-0x6c,-0xb2,-0x148,-0x71)],_0x3007ea[_0x4a0f83(0x134,0x13b,0x155,0x16a)]][_0x28f5f1(-0x12c,-0x11a,-0xfa,-0x18f)](Boolean)['join'](',\x20');addLog(_0x28f5f1(-0xb1,-0x60,0x24,-0xa1)+_0x542600);const _0x13f951={};_0x13f951[_0x28f5f1(-0x124,-0xdf,-0x15b,-0x155)]=_0x542600;const _0x4e2b84={};_0x4e2b84[_0x28f5f1(-0x3b,-0x1d,-0x9c,0xa5)+'t']=0x1,_0x4e2b84[_0x4a0f83(0x258,0x19e,0x2ab,0x253)+'o']=_0x41e089;const _0x578bd2={};_0x578bd2[_0x4a0f83(0xe7,0xdd,0xfe,0x16b)]=[_0x13f951],_0x578bd2[_0x4a0f83(0x113,0x92,0x130,0x122)]=_0x4e2b84,_0x22a574=_0x578bd2,addLog(_0x4a0f83(0x1d1,0x2d1,0x18a,0x22e)+_0x4a0f83(0x27a,0x13a,0x241,0x1fa)+_0x4a0f83(0xf1,0x165,0xce,0x15d)+'with\x20promp'+_0x28f5f1(-0x9e,-0x1a,-0xcd,0x6e)+_0x542600);}else _0x2bbb39[_0x4a0f83(0x29a,0x270,0x268,0x24d)+_0x1288bc+_0x28f5f1(-0x12a,-0x9a,-0x8d,-0x32)]&&(_0x5caed3=_0x467a5b[_0x28f5f1(-0x63,-0x53,0x21,-0x1d)](_0x28be0a+',\x20',_0x3255cf[_0x4a0f83(0x257,0x22e,0x23b,0x24d)+_0xb099a2+_0x4a0f83(0x1ae,0x140,0x118,0x1a6)]));}else{_0x1a1ac5=_0x467a5b[_0x4a0f83(0x2b6,0x285,0x2fa,0x264)];let _0x5e42e4;if(_0x2f8f4e[_0x4a0f83(0xa4,0x149,0x12f,0x157)](_0x4a0f83(0x1da,0x243,0x21f,0x1d0))){if(_0x467a5b[_0x28f5f1(-0xdd,-0x39,-0x68,-0xbb)](_0x467a5b['BrfFw'],_0x467a5b[_0x28f5f1(0x43,-0x42,0x6e,0x75)])){addLog(_0x467a5b[_0x4a0f83(0x1d6,0x1cf,0x28d,0x1ff)]);const _0x26f317=_0x467a5b[_0x4a0f83(0x210,0x259,0x237,0x242)](_0x212b99,'默认'),_0x1f90ec={};_0x1f90ec[_0x28f5f1(0x32,-0x78,-0x70,-0x12e)+'on']=[],_0x1f90ec[_0x4a0f83(0x13f,0x1b7,0x19f,0x164)+'t']='',_0x5e42e4=_0x4936e4[_0x26f317]||_0x1f90ec,_0x467a5b[_0x28f5f1(-0xb7,-0x1e,0x47,-0x6f)](addLog,_0x28f5f1(0x1,-0x6,0xa0,-0x5e)+_0x28f5f1(-0x103,-0x121,-0xe6,-0x9c)+_0x26f317+'\x22');}else{if(_0x2b2e3b['initialize'+_0x4a0f83(0x1f3,0x232,0x149,0x1be)+_0x28f5f1(-0x1bb,-0x111,-0x15f,-0x97)]){const _0x2880c9=_0x4a0f83(0x261,0x2ae,0x22b,0x282)[_0x4a0f83(0x1e1,0x2a7,0x1db,0x216)]('|');let _0x29ddc9=-0x26b3+0xa5f*0x3+-0x1*-0x796;while(!![]){switch(_0x2880c9[_0x29ddc9++]){case'0':_0x1c86d1[_0x4a0f83(0xba,0x1d4,0x1fa,0x139)](_0x39035c=>{function _0x2c2b80(_0x5360b6,_0x6d5257,_0x3cb2dc,_0x4dd1a7){return _0x28f5f1(_0x5360b6-0x8a,_0x4dd1a7- -0x121,_0x5360b6,_0x4dd1a7-0x1);}function _0x105ea9(_0x3ad22c,_0x54e72c,_0x247b0b,_0x5a1507){return _0x28f5f1(_0x3ad22c-0xda,_0x5a1507- -0x7f,_0x3ad22c,_0x5a1507-0x102);}_0x17da50[_0x2c2b80(-0x2d2,-0x176,-0x294,-0x236)+_0x105ea9(-0x1d1,-0x112,-0x121,-0x190)](_0x39035c,_0x26eff2);});continue;case'1':_0xd90784(_0x467a5b[_0x28f5f1(-0x1ab,-0x125,-0x1dd,-0xfc)]);continue;case'2':_0x22fd00['removeList'+_0x28f5f1(-0x199,-0x111,-0x5c,-0x73)](_0x13f696[_0x28f5f1(-0x18e,-0xda,-0xd4,-0x143)+_0x4a0f83(0x225,0x158,0x1cf,0x18d)+'ST'],_0x6eb114);continue;case'3':_0x445907['initialize'+_0x28f5f1(-0x3b,-0x82,-0x9f,-0xfc)+_0x28f5f1(-0x108,-0x111,-0x65,-0x108)]=![];continue;case'4':_0x32d778[_0x28f5f1(-0xa5,-0x115,-0xa0,-0x122)+_0x4a0f83(0x73,0xc1,0x18f,0x12f)](_0x28f5f1(0x7,0x0,0x75,-0x56)+'cancel_ban'+_0x4a0f83(0x21f,0x1c4,0x139,0x199),_0x3e5618);continue;}break;}}}}else{if(_0x467a5b[_0x28f5f1(-0x2,-0x71,-0x8f,-0x94)](_0x467a5b[_0x4a0f83(0x19a,0x25a,0x271,0x1db)],_0x467a5b['DAXfF'])){const _0x338130={};_0x338130[_0x28f5f1(-0x48,-0x44,-0x8b,-0x85)]=_0x45875f;const _0x43867c={};_0x43867c[_0x4a0f83(0x263,0x2a5,0x189,0x1ea)]=_0x467a5b['WywiF'],_0x43867c[_0x28f5f1(-0x11a,-0xa5,-0x52,-0x20)]=_0x338130,_0x11e84c[_0x28f5f1(0x2d,-0x5e,-0xff,-0x7c)](_0x43867c),_0x467a5b[_0x28f5f1(0x15,-0x95,-0x8e,-0x3d)](_0x57ada3,_0x28f5f1(0x3f,-0x50,-0xdc,0x11)+'图模式：已添加待修改'+'的图片');}else{const _0x4bada2={};_0x4bada2['conversati'+'on']=[],_0x4bada2[_0x28f5f1(-0x164,-0xdc,-0x87,-0x142)+'t']='',_0x5e42e4=_0x4936e4[_0x55c2f5]||_0x4bada2;}}const _0x5c63d6=[_0x5e42e4['fixedPromp'+'t'],_0x3007ea[_0x467a5b['NgKpc']],_0x3007ea[_0x467a5b[_0x4a0f83(0x265,0x264,0x21f,0x260)]],_0x2890d1,_0x3007ea[_0x467a5b['xyLRa']],_0x3007ea[_0x467a5b[_0x4a0f83(0x10c,0x139,0x1ae,0x16e)]],_0x5e42e4['postfixPro'+'mpt'],_0x3007ea[_0x467a5b[_0x4a0f83(0x222,0x194,0x1ca,0x1de)]]][_0x28f5f1(-0x94,-0x11a,-0x5d,-0xf0)](Boolean)[_0x4a0f83(0x33c,0x2c9,0x251,0x284)](',\x20');_0x467a5b[_0x28f5f1(-0xe0,-0x95,-0xfe,-0x118)](addLog,'正面提示词:\x20'+_0x5c63d6);const _0x1f5ab6={};_0x1f5ab6[_0x28f5f1(-0x114,-0x77,-0x30,-0xd3)]=_0x28f5f1(-0x1a6,-0x12b,-0x1d8,-0x192),_0x1f5ab6[_0x28f5f1(-0x151,-0x109,-0x1b8,-0x60)]=[];const _0x28c497={};_0x28c497[_0x4a0f83(0x16b,0x23c,0x253,0x1c9)]='assistant',_0x28c497[_0x28f5f1(-0x128,-0x109,-0x142,-0x132)]=[];const _0x238c41=_0x5e42e4[_0x28f5f1(0x34,-0x78,-0xe4,-0x6f)+'on'][_0x4a0f83(0x1c1,0x10b,0x1b2,0x11a)](_0x197d10=>[_0x1f5ab6,_0x28c497])[_0x28f5f1(0x3a,-0x1b,-0x88,0x3f)]();let _0x33101f=-0xb3*0x3+-0x2eb*0x1+-0x4*-0x141;for(const _0x2b8e70 of _0x5e42e4[_0x28f5f1(-0x29,-0x78,-0xd0,-0x90)+'on']){if(_0x2b8e70['user']?.[_0x28f5f1(-0x3e,-0x83,-0xb2,-0x5b)])_0x238c41[_0x33101f][_0x4a0f83(0x109,0x16d,0xa8,0x137)]['push']({'type':_0x4a0f83(0x242,0x141,0x18f,0x1bd),'text':_0x2b8e70[_0x4a0f83(0x8f,0xd6,0xcb,0x115)][_0x4a0f83(0x244,0x1d2,0x23e,0x1bd)]});const _0x3b1c59=await _0x467a5b[_0x28f5f1(0x6d,-0x2d,0x74,-0x2e)](getImageFromTurnData,_0x2b8e70[_0x4a0f83(0x138,0x180,0x63,0x115)]);if(_0x3b1c59)_0x238c41[_0x33101f][_0x28f5f1(-0x66,-0x109,-0xed,-0x152)][_0x28f5f1(-0x57,-0x5e,-0x6c,-0x65)]({'type':_0x467a5b[_0x4a0f83(0x2f7,0x24a,0x24c,0x237)],'image_url':{'url':_0x3b1c59}});_0x33101f++;if(_0x2b8e70[_0x28f5f1(-0x29,-0x6d,-0x42,-0x106)]?.[_0x4a0f83(0x119,0x20f,0x1d8,0x1bd)])_0x238c41[_0x33101f]['content'][_0x28f5f1(-0x82,-0x5e,0x15,0x42)]({'type':_0x467a5b[_0x4a0f83(0x28e,0x183,0x27e,0x1ec)],'text':_0x2b8e70[_0x4a0f83(0x127,0x1b3,0x1b4,0x1d3)][_0x4a0f83(0x247,0x121,0x195,0x1bd)]});const _0x43b40d=await _0x467a5b[_0x28f5f1(-0x57,-0xae,-0xe,-0xa2)](getImageFromTurnData,_0x2b8e70[_0x28f5f1(-0x3,-0x6d,-0xa8,-0xa8)]);if(_0x43b40d)_0x238c41[_0x33101f][_0x28f5f1(-0x10b,-0x109,-0xb9,-0x11d)][_0x28f5f1(-0xe6,-0x5e,0xc,-0x3d)]({'type':_0x467a5b['WywiF'],'image_url':{'url':_0x43b40d}});_0x33101f++;}if(!_0x2f8f4e[_0x28f5f1(-0x101,-0xe9,-0xa3,-0xd1)](_0x467a5b[_0x4a0f83(0x1af,0x178,0x98,0x138)])){const _0x53d529=extension_settings[extensionName]['bananaChar'+_0x4a0f83(0xdc,0x148,0x126,0x16c)+'ts']||{};for(const _0x220c1a in _0x53d529){if(_0x467a5b['YokMR'](_0x467a5b[_0x28f5f1(-0x15e,-0xf1,-0xcc,-0xd0)],_0x28f5f1(-0x10e,-0x7f,-0xdc,-0x5c))){const _0x1181bd=_0x53d529[_0x220c1a],_0x139b3c=(_0x1181bd['triggers']||'')[_0x4a0f83(0x1c4,0x182,0x1b0,0x216)]('|')['filter'](_0x5827b8=>_0x5827b8[_0x4a0f83(0x17c,0x10e,0x133,0x158)]()!=='');for(const _0x2bc6ec of _0x139b3c){if(_0x5c63d6[_0x28f5f1(-0xb5,-0x8,-0x36,-0x96)+'e']()[_0x4a0f83(0x1ec,0xc8,0xbb,0x157)](_0x2bc6ec[_0x28f5f1(0x77,-0x8,-0xc8,0x39)+'e']())){_0x467a5b['hMWKb'](addLog,_0x28f5f1(-0x85,-0xec,-0x17d,-0x172)+'ound\x20match'+_0x28f5f1(-0x80,0x15,0xb5,-0x5d)+'r\x20\x22'+_0x2bc6ec+(_0x4a0f83(0x1dc,0x271,0x204,0x27d)+_0x28f5f1(-0xdf,-0x86,-0xc4,-0x91))+_0x220c1a+'\x22.');const _0x4d060d=_0x1181bd[_0x4a0f83(0x10b,0x1c0,0x1fb,0x1c8)+'on'];if(_0x4d060d){const _0x593e13=[];if(_0x4d060d[_0x28f5f1(-0x1de,-0x12b,-0xe9,-0x16d)]&&_0x4d060d[_0x28f5f1(-0x15f,-0x12b,-0x1eb,-0x166)]['text'])_0x593e13[_0x4a0f83(0x196,0x150,0x1e2,0x1e2)]({'type':_0x4a0f83(0x159,0x1c3,0x201,0x1bd),'text':_0x4d060d[_0x28f5f1(-0xf4,-0x12b,-0x135,-0xc3)][_0x28f5f1(-0x4e,-0x83,-0xfd,0x3e)]});const _0x3f04fd=await _0x467a5b['DGclN'](getImageFromTurnData,_0x4d060d['user']);if(_0x3f04fd)_0x593e13[_0x28f5f1(-0x33,-0x5e,-0x29,-0xac)]({'type':_0x467a5b[_0x4a0f83(0x19b,0x2d4,0x2f4,0x237)],'image_url':{'url':_0x3f04fd}});if(_0x467a5b[_0x4a0f83(0x2a6,0x296,0x1ed,0x236)](_0x593e13[_0x28f5f1(-0x102,-0x97,-0x69,-0x48)],0x121*0x1f+-0x19ca*0x1+0x1*-0x935)){if('HBJpW'!==_0x467a5b[_0x28f5f1(-0x1b0,-0x11c,-0x118,-0xd1)]){const _0x2e7592={};_0x2e7592[_0x4a0f83(0x186,0x174,0x1c1,0x1c9)]=_0x467a5b[_0x28f5f1(-0x1e,-0x4b,-0x10b,-0x2)],_0x2e7592[_0x28f5f1(-0x17d,-0x109,-0xa3,-0x147)]=_0x593e13,_0x238c41['push'](_0x2e7592);}else _0x41c9b9['on'](_0x3b09cc[_0x28f5f1(-0x59,-0xda,-0xf3,-0x74)+_0x4a0f83(0x1e3,0x153,0x20f,0x18d)+'ST'],_0x46f00e),_0x2371c1['on']('st_chatu8_'+_0x28f5f1(-0x107,-0xfc,-0x12b,-0x50)+_0x28f5f1(-0x102,-0xa7,-0xef,-0x1f),_0x295155),_0x467a5b[_0x4a0f83(0x2d1,0x209,0x187,0x24a)](_0x194910,_0x467a5b[_0x28f5f1(-0xf1,-0xea,-0x14d,-0x176)]);}const _0x38d5ae=[];if(_0x4d060d[_0x4a0f83(0x1cb,0x287,0x197,0x1d3)]&&_0x4d060d[_0x28f5f1(-0xdc,-0x6d,-0x3b,-0xd7)][_0x28f5f1(0x40,-0x83,-0x101,-0x70)])_0x38d5ae[_0x28f5f1(-0x99,-0x5e,-0x1d,0x34)]({'type':_0x467a5b[_0x28f5f1(-0xa3,-0x54,-0x33,-0x64)],'text':_0x4d060d[_0x4a0f83(0x19b,0x1a3,0x25d,0x1d3)][_0x28f5f1(-0x146,-0x83,-0xdb,0x9)]});const _0x131be7=await _0x467a5b[_0x4a0f83(0x5f,0x91,0x1cc,0x111)](getImageFromTurnData,_0x4d060d[_0x28f5f1(-0xd3,-0x6d,-0xb6,-0x124)]);if(_0x131be7)_0x38d5ae['push']({'type':_0x28f5f1(-0xb4,-0xa5,-0xae,0x13),'image_url':{'url':_0x131be7}});if(_0x38d5ae[_0x4a0f83(0x204,0x147,0x266,0x1a9)]>0x1*-0x24b0+0x768+0xea4*0x2){const _0x19911a={};_0x19911a['role']=_0x467a5b[_0x28f5f1(-0x4,0x29,0x67,-0x3a)],_0x19911a[_0x28f5f1(-0x4c,-0x109,-0x1c8,-0xbd)]=_0x38d5ae,_0x238c41[_0x4a0f83(0x221,0x1ef,0x241,0x1e2)](_0x19911a);}}break;}}}else _0x467a5b[_0x28f5f1(-0x31,-0x85,-0xe7,-0x103)](_0x380341,_0x4a0f83(0x1cd,0x245,0x173,0x1d2)+_0x28f5f1(0xa,-0x16,0xa8,-0xb)),_0x409531=_0x23d4bd;}}if(!_0x2f8f4e['includes'](_0x467a5b[_0x4a0f83(0x7f,0x103,0x175,0x138)])){if(_0x467a5b[_0x4a0f83(0xfa,0x118,0x175,0x1bc)](_0x28f5f1(-0xa3,-0xaa,-0xfc,-0x11b),'fIXaA'))_0x41d1a2=_0x467a5b[_0x4a0f83(0x12c,0x181,0x26d,0x1ed)](_0x5041ab+',\x20',_0xf07b7f[_0x28f5f1(-0x46,0xd,0x35,0x77)+_0x373fa4+_0x28f5f1(-0x57,-0x9a,-0xf1,-0xc9)]);else{const _0x1dbb8c={};_0x1dbb8c[_0x4a0f83(0x1d4,0x21b,0x169,0x1ea)]=_0x467a5b[_0x4a0f83(0x21a,0x189,0x1c3,0x1ec)],_0x1dbb8c['text']=_0x5c63d6;const _0x4109ad={};_0x4109ad[_0x28f5f1(-0x111,-0x77,0x30,-0x11e)]=_0x4a0f83(0xd9,0x94,0x1d0,0x115),_0x4109ad['content']=[_0x1dbb8c],_0x238c41[_0x4a0f83(0x224,0x134,0x225,0x1e2)](_0x4109ad);}}else{if(_0x467a5b[_0x4a0f83(0x118,0x1b7,0x1a4,0x185)]('Usnwn',_0x467a5b[_0x4a0f83(0x1c8,0x229,0x222,0x20b)])){const _0x1ddcb0=[],_0x133d7b=_0x467a5b[_0x28f5f1(-0xbd,-0x10b,-0x1bc,-0xe4)](_0x251e53,_0x5c63d6),_0x1beda2=[_0x5e42e4['fixedPromp'+'t'],_0x133d7b,_0x5e42e4[_0x28f5f1(-0x185,-0x103,-0x113,-0x81)+_0x4a0f83(0x200,0x1df,0xdc,0x18e)]][_0x4a0f83(0xb4,0xea,0x1d9,0x126)](Boolean)['join'](',\x20'),_0x1d538d={};_0x1d538d['type']=_0x467a5b[_0x28f5f1(0x2c,-0x54,-0x115,0x39)],_0x1d538d[_0x4a0f83(0x1be,0x125,0x158,0x1bd)]=_0x1beda2,_0x1ddcb0[_0x4a0f83(0x129,0x219,0x20a,0x1e2)](_0x1d538d);if(_0x351973){if(_0x467a5b['MEZIi'](_0x467a5b[_0x4a0f83(0x194,0x2ec,0x22e,0x230)],_0x467a5b['hEvRY']))_0x467a5b[_0x4a0f83(0x248,0x24b,0x2e0,0x24a)](_0x2ba6a3,'[Banana]\x20F'+'ailed\x20to\x20f'+'etch\x20Markd'+'own\x20image:'+'\x20'+_0x18f689['message']),_0x5430f9=_0xc152ef,_0x57ab2e(_0x467a5b[_0x4a0f83(0x258,0x1e2,0x1df,0x22b)]);else{const _0x3287a3={};_0x3287a3['url']=_0x351973;const _0x48f9fa={};_0x48f9fa[_0x4a0f83(0x24c,0x1de,0x282,0x1ea)]=_0x467a5b[_0x28f5f1(-0x34,-0x9,0xa6,-0x49)],_0x48f9fa['image_url']=_0x3287a3,_0x1ddcb0[_0x4a0f83(0x1a8,0x277,0x153,0x1e2)](_0x48f9fa),_0x467a5b[_0x28f5f1(-0xdf,-0x1e,-0x22,0xa0)](addLog,_0x28f5f1(-0xa6,-0x50,-0x18,0x29)+'图模式：已添加待修改'+'的图片');}}const _0x1ffe59={};_0x1ffe59[_0x4a0f83(0x12c,0x217,0x1ff,0x1c9)]=_0x467a5b[_0x4a0f83(0x213,0x187,0x1b4,0x1f5)],_0x1ffe59[_0x28f5f1(-0x188,-0x109,-0x119,-0x15e)]=_0x1ddcb0,_0x238c41['push'](_0x1ffe59),_0x467a5b[_0x4a0f83(0x16b,0x1ec,0x233,0x193)](addLog,_0x4a0f83(0x285,0x251,0x156,0x1f0)+'图模式：指令\x20=\x20'+_0x1beda2);}else _0x2c4fa2=_0x467a5b[_0x4a0f83(0x170,0x1a1,0x16f,0x1ed)](_0xef7962,_0x467a5b[_0x28f5f1(0x7d,0x7,0x65,-0x7b)])+_0x467a5b[_0x28f5f1(-0x5b,-0x3b,-0x5b,0x1b)](_0x1d5b02,_0x4c6bab[_0x28f5f1(-0x1f,0xd,0x55,0x4)+_0x437893+_0x28f5f1(-0x5b,-0x9a,-0x145,-0x6b)]);}const _0x27805d={};_0x27805d[_0x28f5f1(0x8e,0x13,0x2c,-0x8b)+'o']=_0x41e089;const _0x5e0efe={};_0x5e0efe[_0x4a0f83(0x256,0x1eb,0x2e5,0x248)+'g']=_0x27805d,_0x22a574={'model':_0x252474,'messages':_0x238c41[_0x4a0f83(0x11e,0x1d3,0x1e3,0x126)](_0x899a99=>_0x899a99[_0x28f5f1(-0xdc,-0x109,-0x100,-0x6b)][_0x28f5f1(-0x64,-0x97,-0xf6,-0x13)]>-0xc96+0xf25+-0x5*0x83),'config':_0x5e0efe},_0x467a5b[_0x4a0f83(0x142,0x195,0x2ae,0x205)](addLog,_0x28f5f1(-0xf,-0x12,-0xb5,0x9c)+_0x28f5f1(-0x15,-0x73,0x4c,-0x48)+_0x28f5f1(-0x1a3,-0xe2,-0x34,-0xe4)+_0x28f5f1(0x1c,-0x67,-0x1,-0xb0)+_0x22a574[_0x4a0f83(0x1b5,0x275,0x285,0x1e5)][_0x28f5f1(0x20,-0x97,-0xea,-0x26)]+_0x28f5f1(-0x13b,-0x9b,-0x3,-0x2c));}function _0x28f5f1(_0x1a4f5a,_0x1595c5,_0x3c75eb,_0x4496b7){return _0x24cd(_0x1595c5- -0x25a,_0x3c75eb);}let _0x323f84=_0x631fbd[_0x4a0f83(0x150,0x24f,0x1b9,0x1e6)](/\/$/,''),_0x4bfe97;if(_0x323f84[_0x28f5f1(0x44,0x3b,-0x49,0x92)](_0x467a5b[_0x28f5f1(0x27,-0x29,-0x7b,-0x63)])||_0x323f84[_0x28f5f1(-0x140,-0xe9,-0x141,-0xec)](_0x28f5f1(-0x120,-0x6a,-0x119,-0x8))){if(_0x467a5b['cDXrs'](_0x467a5b[_0x28f5f1(-0xab,-0x6f,-0x9,-0x9d)],_0x4a0f83(0x1f2,0x1ae,0x305,0x256))){const _0x53283f=[],_0x577194=_0x467a5b['OXMXR'](_0x457087,_0x5a2485),_0x2223cf=[_0xfc3a29[_0x28f5f1(-0x190,-0xdc,-0x10c,-0xd1)+'t'],_0x577194,_0x27c374[_0x28f5f1(-0x146,-0x103,-0x41,-0x68)+_0x28f5f1(-0xce,-0xb2,-0x6a,-0xb0)]][_0x4a0f83(0xd3,0xfb,0x178,0x126)](_0x13fc07)[_0x28f5f1(0xe2,0x44,0x40,0x8d)](',\x20'),_0x202626={};_0x202626[_0x28f5f1(-0x102,-0x56,0x33,-0xb1)]='text',_0x202626[_0x4a0f83(0x1b8,0x109,0x225,0x1bd)]=_0x2223cf,_0x53283f['push'](_0x202626);if(_0x5a31e5){const _0x5347b2={};_0x5347b2[_0x28f5f1(0x3c,-0x44,-0xc,-0x6a)]=_0x1bcdf1;const _0xc47def={};_0xc47def[_0x28f5f1(0xb,-0x56,0x27,0x42)]=_0x467a5b[_0x28f5f1(-0x5f,-0x9,0x8e,-0xa2)],_0xc47def[_0x4a0f83(0xda,0x1ba,0x19d,0x19b)]=_0x5347b2,_0x53283f[_0x28f5f1(-0xc4,-0x5e,-0x7e,0xe)](_0xc47def),_0x467a5b['YaZdh'](_0x1bc71a,'[Banana]\x20修'+_0x4a0f83(0xe9,0x1f7,0x228,0x180)+'的图片');}const _0x41d992={};_0x41d992['role']=_0x467a5b[_0x4a0f83(0x275,0x231,0x175,0x1f5)],_0x41d992[_0x4a0f83(0x172,0x9a,0x1d2,0x137)]=_0x53283f,_0x1c8131[_0x28f5f1(-0x1b,-0x5e,0x50,0x2b)](_0x41d992),_0x467a5b['OTzgW'](_0x4f30c1,_0x4a0f83(0x287,0x283,0x1dd,0x1f0)+_0x28f5f1(-0x7,0x27,0xe3,-0x98)+_0x2223cf);}else _0x4bfe97=_0x323f84+_0x1a1ac5;}else _0x4bfe97=_0x467a5b[_0x28f5f1(-0x111,-0x53,-0xe8,-0xa3)](_0x467a5b[_0x4a0f83(0x147,0x276,0x287,0x1ed)](_0x323f84,_0x467a5b[_0x28f5f1(-0x92,-0x29,-0xd,0x21)]),_0x1a1ac5);_0x4bfe97=_0x4bfe97['replace'](/\/v1\/v1\//g,_0x467a5b['PwRit']);const _0x141f80=extension_settings[extensionName]['client'];let _0x40c347,_0x57d3bb,_0x310187;if(_0x467a5b[_0x28f5f1(-0xa1,-0xbb,-0x16c,-0x85)](_0x141f80,_0x467a5b[_0x28f5f1(0xf2,0x30,0x55,0x15)])){let _0x2f4fbd=_0x323f84;!_0x2f4fbd[_0x28f5f1(0x7f,0x3b,0xcc,0xe5)](_0x4a0f83(0x15d,0x223,0x1df,0x1f2))&&!_0x2f4fbd[_0x4a0f83(0x180,0x9e,0x11c,0x157)](_0x467a5b[_0x28f5f1(-0x1c,0x4a,-0x7,0x34)])&&(_0x467a5b[_0x28f5f1(-0x4c,-0xcd,-0x93,-0x121)](_0x467a5b['lclBV'],_0x467a5b['eFuvU'])?_0x289c7a=_0x467a5b[_0x28f5f1(-0xc6,-0x53,-0xed,0x56)](_0x2125ef,_0x467a5b[_0x4a0f83(0x27a,0x1e8,0x246,0x217)]):_0x2f4fbd=_0x467a5b[_0x4a0f83(0x167,0x1d3,0x191,0x1cb)](_0x2f4fbd,_0x467a5b[_0x4a0f83(0x270,0x1c8,0x20b,0x217)]));_0x2f4fbd=_0x2f4fbd[_0x4a0f83(0x18f,0x176,0x132,0x1e6)](/\/v1\/$/,_0x467a5b[_0x4a0f83(0x266,0x21e,0x1ad,0x217)]),_0x40c347=_0x467a5b['aaKug'],_0x57d3bb=getRequestHeaders(window[_0x4a0f83(0xe9,0x1a0,0x246,0x18b)]);const _0x2c0f33={};_0x2c0f33[_0x4a0f83(0x1da,0x1b0,0x1d9,0x25c)+_0x28f5f1(-0x16d,-0x100,-0x12c,-0x15a)+'ce']=_0x467a5b[_0x28f5f1(-0xbb,-0xa6,-0xc,-0xc0)],_0x2c0f33[_0x28f5f1(-0x117,-0xf9,-0x1b0,-0x131)]=_0x2f4fbd,_0x2c0f33[_0x28f5f1(-0xdd,-0x9e,-0x76,-0x153)+_0x4a0f83(0x1f5,0x1ed,0x1dd,0x1dd)+'rs']=_0x28f5f1(-0x2b,-0x38,0x24,-0x74)+'ion:\x20\x22Bear'+'er\x20'+_0x4cd8a2+'\x22',_0x2c0f33[_0x4a0f83(0x15a,0x279,0x15f,0x1d3)]=_0x252474,_0x2c0f33[_0x28f5f1(-0x2a,-0x5b,0x38,0x5e)]=_0x22a574['messages'],_0x2c0f33['stream']=![],_0x310187=_0x2c0f33;if(_0x252474[_0x28f5f1(-0x6,-0x4a,-0x75,-0x84)](_0x467a5b[_0x28f5f1(-0xbc,-0x87,-0xa4,-0x135)])){addLog(_0x28f5f1(-0xdb,-0xb4,-0xc5,-0x12b)+_0x4a0f83(0x1b2,0x77,0xde,0x114)+'持酒馆代理，切换为直'+'接请求'),_0x40c347=_0x4bfe97;const _0x46ff9c={};_0x46ff9c[_0x28f5f1(-0x4f,0x6,0xaa,-0xad)+'pe']=_0x467a5b[_0x28f5f1(-0x17a,-0xc6,-0x27,-0x40)],_0x46ff9c['Authorizat'+'ion']=_0x28f5f1(-0x28,-0xa4,-0xdf,-0xb7)+_0x4cd8a2,_0x57d3bb=_0x46ff9c,_0x310187=_0x22a574;}_0x467a5b['JxuzW'](addLog,'[Banana]\x20使'+_0x28f5f1(-0x105,-0x101,-0xee,-0x57));}else{if(_0x467a5b[_0x4a0f83(0x13a,0x200,0xfc,0x173)](_0x467a5b[_0x4a0f83(0x1d3,0x19e,0x1de,0x23b)],_0x467a5b[_0x28f5f1(-0x17,-0x31,-0x6f,0xc)])){_0x5f5845(_0x4a0f83(0x1f5,0xdb,0x23b,0x18c)+_0x28f5f1(-0x112,-0x12c,-0x1e2,-0xa1)+'持酒馆代理，切换为直'+_0x28f5f1(-0x82,-0x1c,-0xbd,-0xa7)),_0x29cb11=_0x16a016;const _0x2769e7={};_0x2769e7[_0x28f5f1(0x6f,0x6,0x7d,-0xa4)+'pe']=_0x467a5b[_0x4a0f83(0x10b,0x221,0x1df,0x17a)],_0x2769e7[_0x4a0f83(0x298,0x238,0x1a2,0x208)+_0x4a0f83(0x14a,0xac,0xb1,0x121)]=_0x28f5f1(-0x54,-0xa4,-0x13f,-0x60)+_0x2f1298,_0x3dfa48=_0x2769e7,_0xb2da1b=_0x188995;}else{_0x40c347=_0x4bfe97;const _0x456dd1={};_0x456dd1[_0x28f5f1(0x62,0x6,0x9a,-0x63)+'pe']=_0x467a5b[_0x4a0f83(0x141,0x212,0x169,0x17a)],_0x456dd1[_0x4a0f83(0x197,0x25d,0x23e,0x208)+_0x4a0f83(0xad,0xf4,0x12c,0x121)]=_0x28f5f1(-0xc2,-0xa4,-0x24,-0x67)+_0x4cd8a2,_0x57d3bb=_0x456dd1,_0x310187=_0x22a574,addLog(_0x28f5f1(-0x57,-0x6,0x8b,0xba)+_0x28f5f1(-0xaa,-0x4d,-0x8a,0x5b));}}addLog(_0x28f5f1(-0x10,-0xc1,-0xf9,-0x36)+'ending\x20req'+_0x28f5f1(-0x95,-0x7,-0x4e,-0x52)+_0x40c347),addLog(_0x28f5f1(-0x3b,-0xc3,-0x163,-0xcb)+_0x4a0f83(0x1cf,0x2b3,0x215,0x212)+JSON[_0x28f5f1(-0x98,0x25,0x4,0x7)](_0x310187,null,-0x111d*-0x1+-0x5*-0x123+-0x2*0xb65));try{taskQueue['updateStat'+'us'](_0x38080a,_0x467a5b['qbjEp']);const _0x4587dc=await _0x467a5b['OgAqb'](fetch,_0x40c347,{'method':_0x467a5b[_0x4a0f83(0x1e5,0x1a3,0x170,0x1b5)],'headers':_0x57d3bb,'body':JSON['stringify'](_0x310187)});if(!_0x4587dc['ok']){const _0x1698b4=await _0x4587dc[_0x28f5f1(-0xf,-0x83,-0xd7,-0x7c)]();throw new Error(_0x4a0f83(0x1fb,0x267,0x14b,0x1c7)+'t\x20failed\x20w'+_0x4a0f83(0x26d,0x309,0x21f,0x28b)+'\x20'+_0x4587dc[_0x28f5f1(-0x87,-0xbf,-0xe,-0x12c)]+':\x20'+_0x1698b4);}const _0x1b6121=await _0x4587dc[_0x4a0f83(0x1f7,0x2f5,0x19d,0x25d)]();let _0x47706a='';const _0x281216=_0x1b6121['choices'];if(_0x281216&&_0x281216[_0x4a0f83(0x22a,0x15a,0x1c1,0x1a9)]>-0x11*-0x10d+-0x10d4+-0x109){const _0x3e3bce=_0x281216[-0xe2d+0x1c98+-0xe6b]['message']?.['content'];if(Array['isArray'](_0x3e3bce)){if(_0x467a5b[_0x4a0f83(0x1eb,0x121,0x175,0x1cf)](_0x467a5b[_0x28f5f1(-0x7b,-0x19,0x60,-0xab)],_0x467a5b[_0x4a0f83(0x1d2,0x25d,0x1ef,0x227)]))_0x4821bc[_0x7fb6d][_0x4a0f83(0x1bd,0x146,0x22b,0x1f4)][_0x4a0f83(0x2b2,0x193,0x1a3,0x232)]=_0x559aa0[_0x42c88a][_0x4a0f83(0x211,0x1f6,0x160,0x1f4)][_0x4a0f83(0x278,0x245,0x27d,0x232)]+(-0x161d+-0x1df*0x2+0x677*0x4),_0x467a5b[_0x4a0f83(0x24d,0x1f0,0x1f7,0x1e9)](_0xa38c1b,'当前生图次数为\x20fo'+_0x4a0f83(0xf0,0x4b,0x1a3,0x10b)+_0x108702[_0x24fa2a][_0x28f5f1(-0xb0,-0x4c,-0x8,-0x1b)]['cishu']);else for(const _0x549992 of _0x3e3bce){if(_0x467a5b['kySDK'](_0x4a0f83(0xcb,0x1c0,0x170,0x108),_0x467a5b['oSQTL'])){if(_0x467a5b[_0x4a0f83(0x236,0x1b7,0x21a,0x173)](_0x549992[_0x4a0f83(0x1e3,0x12c,0x1e3,0x1ea)],_0x467a5b[_0x4a0f83(0x189,0x198,0x1cc,0x237)])&&_0x549992[_0x28f5f1(-0x154,-0xa5,-0xc0,-0x20)]?.[_0x4a0f83(0x213,0x18a,0x20d,0x1fc)]){_0x47706a=_0x549992[_0x4a0f83(0x217,0x18c,0x241,0x19b)]['url'];break;}}else _0x37ed62[_0x57fbbf][_0x4a0f83(0x1ad,0x2b8,0x26d,0x1f4)][_0x4a0f83(0x1f3,0x2ec,0x1d8,0x232)]=-0xda*0x13+0x2086*0x1+0x1057*-0x1,_0x3fc169(_0x4a0f83(0x147,0x1ad,0x10a,0x1c5)+'r\x20prompt:\x20'+_0x863383[_0x3e5739][_0x4a0f83(0x1e0,0x1d6,0x14c,0x1f4)][_0x4a0f83(0x2bc,0x1c7,0x23c,0x232)]);}}else{if(_0x467a5b[_0x28f5f1(-0x14b,-0xbb,-0xeb,-0x41)](typeof _0x3e3bce,_0x467a5b['gqcRH'])){const _0x4d03b5=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x6834c7=_0x3e3bce[_0x4a0f83(0x258,0x25f,0x1aa,0x1df)](_0x4d03b5);if(_0x6834c7&&_0x6834c7[-0x118*-0xe+-0xd11+-0xe*0x29]){if(_0x467a5b[_0x4a0f83(0xf1,0x103,0x86,0x136)](_0x467a5b[_0x28f5f1(-0x6e,-0xf4,-0x156,-0x134)],_0x467a5b[_0x28f5f1(-0xbd,-0x81,-0xc3,-0x144)])){_0x467a5b[_0x28f5f1(0x9d,0x23,0x24,0xdb)](addLog,_0x467a5b[_0x4a0f83(0x276,0x268,0x163,0x1c0)]);const _0x5ced94=_0x6834c7[-0x343+0x1*0x1669+-0x1325];addLog(_0x28f5f1(0x56,0x1b,0x9,0xbd)+_0x4a0f83(0x283,0x1fa,0x29f,0x250)+_0x4a0f83(0x314,0x2f9,0x284,0x26f)+_0x5ced94);try{const _0x4f148a=await _0x467a5b['rEtyB'](fetch,_0x5ced94);if(!_0x4f148a['ok']){if(_0x467a5b[_0x28f5f1(0x53,0xc,0x26,0x42)](_0x28f5f1(-0x180,-0xe5,-0x151,-0x47),'bkTpC'))throw new Error(_0x28f5f1(-0x1d,-0xd,-0x6c,-0x94)+_0x4a0f83(0x246,0x221,0x1c9,0x259)+_0x28f5f1(0x18,-0x2f,0x60,-0xde)+_0x4f148a[_0x4a0f83(0x218,0xce,0x210,0x181)]);else!_0x498674[_0x4a0f83(0x24e,0x29e,0x19e,0x204)+_0x28f5f1(-0x13d,-0x82,-0xb0,-0x16)+_0x4a0f83(0x104,0x147,0x1ee,0x12f)]&&(_0x4b5d3f[_0x4a0f83(0x207,0x1c9,0x23f,0x204)+_0x4a0f83(0x1d6,0x13e,0x1ad,0x1be)+_0x28f5f1(-0x120,-0x111,-0x147,-0x105)]=!![],_0x467a5b[_0x4a0f83(0x27b,0x229,0x26e,0x1fb)](_0x114300)),_0x467a5b[_0x4a0f83(0x2ac,0x18c,0x1de,0x1fb)](_0x1b080a);}const _0x291e7d=await _0x4f148a[_0x28f5f1(-0xfc,-0xc9,-0x183,-0xeb)](),_0x576f2f=await new Promise((_0x3cd7ff,_0x5c0028)=>{function _0x3adf01(_0x268900,_0x5a19bf,_0xe6e2b,_0x3805e7){return _0x28f5f1(_0x268900-0x118,_0x5a19bf-0x341,_0xe6e2b,_0x3805e7-0x18a);}function _0x32285d(_0x21ee51,_0x36dbf2,_0x2f2306,_0x40e44d){return _0x28f5f1(_0x21ee51-0x6,_0x2f2306-0xdf,_0x36dbf2,_0x40e44d-0x8b);}const _0x4ec1ba={'wFeIY':function(_0x3fd983,_0x403f82){return _0x3fd983(_0x403f82);},'uHbyF':function(_0x2dfb83,_0xf72d7b){function _0x405225(_0x1b517c,_0x4ace13,_0x4312c5,_0x452cee){return _0x24cd(_0x1b517c-0x77,_0x4ace13);}return _0x467a5b[_0x405225(0x2e9,0x279,0x318,0x343)](_0x2dfb83,_0xf72d7b);},'AXqPg':_0x467a5b[_0x32285d(-0xbe,-0xc,-0x1,-0x3b)],'ZAsnD':_0x467a5b[_0x3adf01(0x291,0x2a0,0x346,0x1e1)],'UxFrb':function(_0x1263ec,_0x896948){function _0xc907cf(_0x239020,_0x10bcde,_0x390d4e,_0x24480d){return _0x32285d(_0x239020-0x182,_0x24480d,_0x239020- -0x158,_0x24480d-0x117);}return _0x467a5b[_0xc907cf(-0x119,-0xb1,-0xad,-0xbf)](_0x1263ec,_0x896948);}};if(_0x467a5b[_0x32285d(0x60,0x2d,0x24,0x6e)](_0x467a5b[_0x3adf01(0x2de,0x373,0x396,0x2e5)],_0x467a5b[_0x3adf01(0x22a,0x2c3,0x2c7,0x2f3)])){const {taskId:_0x5578b7}=_0x14b773;_0x4ec1ba[_0x3adf01(0x30c,0x295,0x311,0x300)](_0x1a9c38,_0x3adf01(0x331,0x31d,0x2ba,0x3a3)+_0x3adf01(0x2c7,0x217,0x279,0x22e)+_0x3adf01(0x31f,0x304,0x270,0x32c)+_0x5578b7+')');if(_0x4ec1ba[_0x3adf01(0x34b,0x2c7,0x21d,0x2b0)](_0xe53fbb,_0x5578b7)&&_0x308cc9){const _0x592208=_0x4ec1ba['AXqPg']['split']('|');let _0x108c5d=0x24d+-0x370+0x1*0x123;while(!![]){switch(_0x592208[_0x108c5d++]){case'0':_0x136242=null;continue;case'1':_0x2fb3ab=null;continue;case'2':_0x5923ed=null;continue;case'3':_0x1e8f5a[_0x3adf01(0x2ed,0x233,0x28f,0x281)](_0xc7a62d['GENERATE_I'+'MAGE_RESPO'+_0x32285d(-0xb,0x39,-0x1f,0x13)],{'id':_0x6d4637,'success':![],'error':_0x4ec1ba['ZAsnD'],'prompt':_0x4ec1ba[_0x32285d(0x7a,0x31,0xe2,0x15a)](_0x4f2264,'')});continue;case'4':_0x4ec1ba[_0x32285d(-0x9,-0x5b,0x33,-0xa)](_0x365c7f,_0x32285d(-0x23,0x6d,-0x3e,-0xab)+_0x3adf01(0x324,0x2db,0x29e,0x2e2)+_0x32285d(-0x32,-0x67,0x51,-0x25)+_0x529cff+')');continue;}break;}}}else{const _0x199adc=new FileReader();_0x199adc[_0x3adf01(0x32f,0x30a,0x2f5,0x2af)]=()=>_0x3cd7ff(_0x199adc[_0x3adf01(0x30a,0x377,0x430,0x3a6)]),_0x199adc[_0x3adf01(0x2a8,0x244,0x24b,0x242)]=_0x5c0028,_0x199adc[_0x3adf01(0x3c3,0x355,0x2d4,0x40e)+_0x3adf01(0x2c3,0x247,0x216,0x226)](_0x291e7d);}});_0x47706a=_0x576f2f,_0x467a5b[_0x28f5f1(0x6d,0x23,0xe3,0x34)](addLog,_0x467a5b[_0x4a0f83(0x18d,0x229,0x245,0x214)]);}catch(_0x5a7e73){if(_0x467a5b[_0x28f5f1(-0x1b1,-0x10a,-0x131,-0x16f)](_0x28f5f1(-0xe,0x4,0x4d,-0x14),_0x4a0f83(0xbc,0xba,0x202,0x167)))_0x467a5b['puvuL'](addLog,'[Banana]\x20F'+_0x28f5f1(-0x110,-0x51,-0xb2,-0x64)+_0x28f5f1(-0x1b5,-0x102,-0x14d,-0x188)+_0x28f5f1(-0x114,-0xa2,-0x93,-0x39)+'\x20'+_0x5a7e73['message']),_0x47706a=_0x5ced94,_0x467a5b['guPwu'](addLog,_0x467a5b[_0x28f5f1(0x13,-0x15,0x1a,-0xb0)]);else{let _0xf82366=_0x27798d;!_0xf82366[_0x28f5f1(0x65,0x3b,0xaa,0x27)](_0x467a5b[_0x28f5f1(-0x5d,-0x29,0x3,-0xda)])&&!_0xf82366[_0x4a0f83(0x1bf,0x16a,0x170,0x157)](_0x467a5b[_0x28f5f1(0x15,0x4a,0x95,-0x3e)])&&(_0xf82366=_0x467a5b['mtWGN'](_0xf82366,_0x467a5b[_0x4a0f83(0x291,0x22e,0x1ad,0x217)]));_0xf82366=_0xf82366['replace'](/\/v1\/$/,_0x467a5b[_0x28f5f1(-0x4d,-0x29,0x4f,-0x46)]),_0x4fa048=_0x467a5b[_0x4a0f83(0x1ad,0x288,0x2c1,0x251)],_0x523940=_0x467a5b[_0x28f5f1(-0x80,0x1a,0x5e,-0x9e)](_0x3c921f,_0x26df01[_0x28f5f1(-0x11a,-0xb5,-0xd1,-0x89)]);const _0x453eeb={};_0x453eeb['chat_compl'+_0x4a0f83(0x15d,0xd4,0x183,0x140)+'ce']=_0x467a5b[_0x4a0f83(0x255,0x188,0x215,0x19a)],_0x453eeb[_0x28f5f1(-0x4c,-0xf9,-0x14c,-0x10e)]=_0xf82366,_0x453eeb['custom_inc'+_0x4a0f83(0x119,0x29d,0x20d,0x1dd)+'rs']=_0x4a0f83(0x249,0x2b9,0x1f5,0x208)+_0x4a0f83(0xa6,0x15b,0x83,0x131)+_0x28f5f1(-0xb9,-0xd1,-0x13d,-0x1d)+_0x123d4e+'\x22',_0x453eeb[_0x4a0f83(0x13a,0x190,0x1f7,0x1d3)]=_0x291b98,_0x453eeb[_0x4a0f83(0x29e,0x1cf,0x261,0x1e5)]=_0x183ed2[_0x28f5f1(-0x9,-0x5b,-0x8e,-0x100)],_0x453eeb[_0x28f5f1(-0x1cc,-0x11b,-0x1c6,-0xa9)]=![],_0x1f1170=_0x453eeb;if(_0x25e7d4['startsWith']('imagen')){_0x2f83eb(_0x4a0f83(0x151,0x1e2,0x187,0x18c)+_0x4a0f83(0x149,0x16f,0xa5,0x114)+_0x28f5f1(-0x195,-0xfb,-0x76,-0x9e)+_0x4a0f83(0x2b1,0x2c0,0x184,0x224)),_0x54a243=_0x2de1fd;const _0x4893ea={};_0x4893ea[_0x28f5f1(0x73,0x6,-0x4a,0x77)+'pe']=_0x467a5b[_0x28f5f1(-0xce,-0xc6,-0xe4,-0x166)],_0x4893ea[_0x4a0f83(0x19b,0x1d5,0x16b,0x208)+_0x28f5f1(-0x1ab,-0x11f,-0xbb,-0x16f)]=_0x28f5f1(-0x76,-0xa4,-0x148,-0x13b)+_0x149d74,_0x350b25=_0x4893ea,_0x593ab3=_0xf8c1dc;}_0x1c0b8b('[Banana]\x20使'+'用酒馆代理模式');}}}else return _0x239982['toString']()['search'](HBTWDX[_0x28f5f1(-0x4d,-0x69,-0x78,-0x9)])[_0x28f5f1(-0x32,-0x13,-0x5e,0x47)]()['constructo'+'r'](_0x40e747)[_0x4a0f83(0x264,0x2d3,0x2df,0x23d)](_0x28f5f1(-0x115,-0x127,-0x132,-0x13e)+'+$');}else _0x467a5b['IZSOZ'](addLog,_0x467a5b['HMaGq']);}}}if(!_0x47706a){if(_0x467a5b[_0x4a0f83(0xc0,0x88,0xd8,0x11d)](_0x467a5b['ZcoUa'],_0x28f5f1(-0x6d,0x3c,-0x67,-0x24)))throw new Error(_0x467a5b[_0x4a0f83(0x1c8,0x14f,0x1c9,0x1cc)]);else{const _0x4b97f5=_0x13759a[_0x4a0f83(0x20c,0x19a,0x14d,0x14a)](_0x10a9e2,arguments);return _0x31214a=null,_0x4b97f5;}}return _0x467a5b['orCQY'](addLog,_0x467a5b[_0x28f5f1(0xbf,0x41,0xe8,-0x30)]),taskQueue[_0x28f5f1(-0x56,-0x5f,-0xfc,-0x9)+'sk'](_0x38080a,!![]),currentTaskId=null,{'image':_0x47706a,'change':_0x467a5b[_0x4a0f83(0x222,0x1ec,0x1bf,0x261)](_0x1c9b42,'')};}catch(_0x1e47ea){addLog(_0x4a0f83(0x153,0x1cd,0x1d3,0x154)+_0x4a0f83(0x168,0xbf,0x6b,0x128)+':\x20'+_0x1e47ea[_0x4a0f83(0x108,0xb7,0xc6,0x13a)]),console[_0x28f5f1(0xd,-0x40,-0x7d,0xb)](_0x467a5b[_0x4a0f83(0x121,0xb5,0x1c0,0x110)],_0x1e47ea);if(_0x467a5b[_0x4a0f83(0x1e9,0x119,0x1a9,0x173)](_0x1e47ea[_0x28f5f1(-0x159,-0x106,-0x1c4,-0x13d)],_0x467a5b[_0x28f5f1(-0x125,-0xa1,-0x6,-0x135)])){}else taskQueue['completeTa'+'sk'](_0x38080a,![]);currentTaskId=null;throw _0x1e47ea;}}export async function bananaGenerate(_0x16cf21){function _0x574945(_0x567e41,_0x1d3bf0,_0x476ee5,_0x1f8ab9){return _0x24cd(_0x567e41- -0x331,_0x476ee5);}const _0x22a3d3={'XSxgB':function(_0x31116c){return _0x31116c();},'tWbqM':function(_0x28c058,_0x18333c){return _0x28c058(_0x18333c);},'hAPKW':_0x574945(-0x147,-0xb9,-0xe1,-0x95),'dFrMd':function(_0x2bbb2c,_0x149f8f){return _0x2bbb2c(_0x149f8f);},'LKNuw':function(_0xc4ff9c,_0x205805){return _0xc4ff9c!=_0x205805;},'iOqZz':function(_0x38118a,_0x45c834,_0x5de844,_0x4e5663){return _0x38118a(_0x45c834,_0x5de844,_0x4e5663);},'LUsal':function(_0x440a76,_0x260620){return _0x440a76(_0x260620);},'eEKTq':function(_0x5a1b37,_0xf0cbd8){return _0x5a1b37+_0xf0cbd8;},'CHNGm':function(_0x1014fa,_0x65bc57){return _0x1014fa(_0x65bc57);},'CrTHU':function(_0x45fe0d,_0x44822e){return _0x45fe0d(_0x44822e);},'HIcdJ':function(_0xc21dab,_0x1742ab){return _0xc21dab(_0x1742ab);}};_0x22a3d3['XSxgB'](clearLog);let {id:_0x4ebd72,prompt:_0x2c2c81,width:_0x4475d7,height:_0xbf0d67,change:_0xdb4771,retouchPrompt:_0xa606a2,retouchImage:_0x1f1d72}=_0x16cf21;currentRequestId=_0x4ebd72;function _0x1f7225(_0xf6c47b,_0x49b1c5,_0x34b75e,_0x1d51de){return _0x24cd(_0xf6c47b- -0xd1,_0x1d51de);}currentPrompt=_0x2c2c81,_0x22a3d3[_0x1f7225(0x146,0x13e,0x1c4,0x1ec)](addLog,_0x574945(-0x12f,-0xbc,-0x1cb,-0xd7)+_0x1f7225(0xa2,0x113,0x1e,0x7a)+_0x574945(-0x1ca,-0x13b,-0x285,-0x1a6)+'tion\x20reque'+_0x1f7225(0x172,0x21e,0x1a5,0xd0)+_0x4ebd72+')');let _0x1df1ac='';_0xdb4771?_0x1df1ac=_0xdb4771[_0x1f7225(0x10c,0x12d,0xb7,0x8b)](_0x22a3d3[_0x574945(-0x193,-0x1fd,-0x153,-0xfb)],''):_0x1df1ac=_0x2c2c81;if(_0xdb4771&&_0xdb4771[_0x1f7225(0xa0,0x7f,-0x23,0x126)](_0x22a3d3['hAPKW'])){_0x22a3d3[_0x1f7225(0x146,0xfc,0x151,0x1f4)](addLog,_0x1f7225(0xf7,0x17e,0x38,0xcf)+'启动');if(_0xa606a2)_0x22a3d3[_0x574945(-0x11a,-0xf4,-0x168,-0xf1)](addLog,_0x1f7225(0x141,0x186,0x121,0xd5)+_0xa606a2);if(_0x1f1d72)addLog('修图图片:\x20[已提供'+']');}try{const {image:_0x1d81dd,change:_0x14d236}=await _0x22a3d3[_0x574945(-0x19c,-0x191,-0x20a,-0x1c4)](generateBananaImage,{'prompt':_0x2c2c81,'width':_0x4475d7,'height':_0xbf0d67,'change':_0xdb4771,'retouchPrompt':_0xa606a2,'retouchImage':_0x1f1d72});if(_0x22a3d3[_0x1f7225(0x1be,0x221,0x1ab,0x14f)](extension_settings[extensionName][_0x1f7225(0xe0,0xf4,0x64,0xe0)],'0')){const _0x2c18d4={};_0x2c18d4['change']=_0x1df1ac,await _0x22a3d3[_0x1f7225(0xf6,0x53,0x5d,0x170)](setItemImg,_0x2c2c81,_0x1d81dd,_0x2c18d4),_0x22a3d3[_0x574945(-0x1ff,-0x2b1,-0x1de,-0x1a4)](addLog,_0x1f7225(0x5c,0x90,0xb8,0x37)+_0x1f7225(0xbd,0x8e,0x145,0x10b)+'\x20'+_0x2c2c81),extension_settings[extensionName][_0x574945(-0x123,-0x171,-0x7c,-0x82)]['cishu']?(extension_settings[extensionName][_0x574945(-0x123,-0x96,-0x15b,-0x1a1)]['cishu']=_0x22a3d3[_0x574945(-0x16f,-0x16c,-0x1ea,-0x205)](extension_settings[extensionName][_0x1f7225(0x13d,0x156,0x133,0x16d)]['cishu'],0x1ba6+-0x25dc+-0x20b*-0x5),_0x22a3d3[_0x574945(-0x19c,-0x14f,-0x172,-0x192)](addLog,_0x574945(-0x152,-0x16f,-0xc3,-0x207)+_0x574945(-0x20c,-0x158,-0x1a6,-0x2b1)+extension_settings[extensionName][_0x1f7225(0x13d,0x1e2,0x13d,0x181)][_0x574945(-0xe5,-0xf6,-0x48,-0x2c)])):(extension_settings[extensionName][_0x1f7225(0x13d,0x7d,0x135,0x93)][_0x574945(-0xe5,-0x10e,-0xeb,-0xd8)]=0x347*0x4+-0xdf*0x1+0x1b*-0x74,_0x22a3d3[_0x574945(-0x107,-0x8a,-0xee,-0x1aa)](addLog,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+extension_settings[extensionName]['banana']['cishu']));}else _0x22a3d3['tWbqM'](addLog,_0x574945(-0xa6,-0xf4,-0x138,-0xaf)+'库');const _0x3f3553={};_0x3f3553['id']=_0x4ebd72,_0x3f3553[_0x574945(-0xf7,-0x98,-0x1a6,-0x127)]=!![],_0x3f3553['imageData']=_0x1d81dd,_0x3f3553[_0x1f7225(0xaa,0x12e,0xfb,0x8a)]=_0x2c2c81,_0x3f3553['change']=_0x1df1ac,eventSource[_0x574945(-0x1e5,-0x172,-0x1c5,-0x196)](EventType[_0x1f7225(0xaf,0x30,0xc6,0x111)+_0x574945(-0xfc,-0x9a,-0xae,-0x184)+_0x574945(-0x1d5,-0x296,-0x13b,-0x183)],_0x3f3553),_0x22a3d3[_0x1f7225(0x175,0x14d,0x14b,0x117)](addLog,_0x1f7225(0xab,0x10a,0x22,0x68)+_0x1f7225(0xfc,0x1bf,0x152,0x176)+_0x574945(-0x17a,-0x22e,-0xe9,-0x212)+_0x1f7225(0x125,0x64,0xc8,0x81)+':\x20'+_0x4ebd72);}catch(_0x521353){const _0xc61482='[Banana]\x20G'+_0x1f7225(0x72,0x34,0xd4,0x7f)+'failed\x20for'+_0x1f7225(0x9e,0xb4,0x115,0x20)+_0x4ebd72+':\x20'+_0x521353[_0x1f7225(0x83,0x78,0x10f,0x134)];addLog(_0xc61482),console['error'](_0xc61482);const _0x297b83={};_0x297b83['id']=_0x4ebd72,_0x297b83[_0x574945(-0xf7,-0x18e,-0x122,-0xef)]=![],_0x297b83[_0x574945(-0x117,-0xeb,-0x145,-0x123)]=_0x521353[_0x1f7225(0x83,-0x3e,0xad,0xae)],_0x297b83['prompt']=_0x2c2c81,eventSource['emit'](EventType[_0x574945(-0x1b1,-0x1de,-0x1e7,-0x21a)+_0x1f7225(0x164,0x1c4,0x1b1,0x16e)+_0x574945(-0x1d5,-0x273,-0x1d2,-0x196)],_0x297b83),_0x22a3d3[_0x1f7225(0x161,0xa3,0x121,0x1d4)](addLog,'[Banana]\x20E'+'mitted\x20fai'+_0x1f7225(0xde,0xa0,0xac,0xab)+_0x574945(-0x13b,-0x16d,-0xb4,-0x1c3)+':\x20'+_0x4ebd72);}}function _0x448e(){const _0x512fb4=['y2zrvfa','l3yXyMv0ys9TBW','tufhrv9srvnqtW','w0jHBMfUyv0G5Ps2','mtaXnZC3mdrWt1vZq0y','t2ftzfO','yKDTr24','C3vJy2vZCW','C1Hctuu','y1fHB2q','C2fTCgXLq291BG','5O6L6k+35Rgc','zMXHDa','DdOG','rw9IzgO','y29UC3rYDwn0BW','C3qGkeLeoIa','5lIT55QeihbYB21WDooaGG','yxLyv2u','q3jusfu','Dg9tDhjPBMC','w0jHBMfUyv0GqG','BI9QC29U','Aev2uLK','vfHWB0O','y2LZAhu','rMfPBgvKihrVia','wLHhrM4','igLTywDLihrVia','zhzVseK','v3L3Auy','Dg9mB3DLCKnHCW','DwvZDcb0BZOG','w0jHBMfUyv0G5l2/','vKLlCM0','vwT3Cvm','C2vHCMnO','Bw9KzwW6ia','BNrHAw5ZihrLEa','C3rFy2HHDhu4xW','AhzVAeC','r0f5y04','vxHgCMi','B1jAv3O','q0H1Eei','q29UDgvUDc1uEq','vgzQCvO','Aw1Hz2vdB25MAq','yxnZAxn0yw50','DM1yAg0','zgf0ytPPBwfNzq','ywruzeW','q2HHCMfJDgvYia','mtGZywLWwK1h','B3nPDgLVBG','yxjRzg93BIbPBq','ywflDwC','Exf5y3y','yxnWzwn0uMf0Aq','CMvHzefZrgf0yq','Aw5NihrYAwDNzq','t0zsBw4','mtztBgXPrLC','uefjCeS','zMv0y2GGAw1HzW','DMzVrKS','w0jHBMfUyv0Gtq','y2HHDf9JB21WBa','ANnVBG','5zco572U5zco','tu1SBw8','Dhjisxy','r2vpEK4','yNr4yKq','reDJBe4','z1rNyLq','C3rYAw5NAwz5','D0TYufq','5zU+5QIH5BYp77YA5OYh5lUKid0G','vxnUD24','u2f5shq','z2uGzM9YBwf0la','EsbJB252zxj0zq','Aw1Hz2vU','BwL6r28','B3HXvue','ywDLifvstdOG','AeLlBM4','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','Bg1bq24','55sO5lQgihVKV67LM759ioAGH+IVHG','rM9Ky20','teToDxC','CMvZDwX0','BeTJAxe','55sO5lQo55sF5OIq55QevgfNoIa','B21WBgv0Aw9UCW','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','zw5KC1DPDgG','CgHKweS','iIbMCM9TihbYzq','uhvQqLm','DcbVBMX5lcbUBW','kerPDMLKzv9YBW','DLDJu0K','mNW0Fdb8m3WX','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','AM9PBG','tuvAswK','CNvUBMLUzW','DenKrNu','otC3nZftqvfPzKu','w0jHBMfUyv0G55sF','uhDsAxq','AxrOihn0yxr1CW','vK9erg8','s1rTDvC','nZu5mJi3uNzOq3Lm','D1Pvwe0','zMPIzKC','nJC4t0XxvwPw','CIbWCM9TChq6ia','mta1nJu4mtzSCwnLr08','zxrLy3rLzcbnyq','lI4U','vevrwxe','q0Xzuee','t1r6z1C','mJKYndvSA1nZvKG','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','BwfNzw4G5QIH5z6l5lIn5PsV','DxnLCG','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','lcdPQ5JLUQyGlsa','tfvZywW','kcGOlISPkYKRkq','BwfW','EhrPwLm','wfbnwuG','txrOswy','rhrXyKq','55sO5l+U5zU+6Ake6k6+oIaI','y3vZDg9T','Aw9U','CgfYyw1LDgvYCW','w0jHBMfUyv0G5y+w','u0zhs0S','C3rYzwfT','zMLSDgvY','l2DLBMvYyxrL','zxrJAcbLCNjVCG','zw5LCMf0Aw9Uia','yMj3vMW','CMvTB3zLtgLZDa','u2nLBMuGq29TCa','zKDstKe','DgfYDgLUzYbPBq','zw5LCG','yu9stLG','Aw9UoIaIqMvHCG','zw1PDa','ihWG','C3rYAw5N','uKfXueK','AuPZreO','y29UDgvUDa','Dgj1t20','zM9YrwfJAa','BwvZC2fNzq','y2XPzw50','C3vIC3rYAw5N','Cg9ZDgzPEfbYBW','zxrJAcbnyxjRza','55sO6yws6AAg5lUJ55cg5QIH5BYp','zxrPB25FC291CG','C2uGzgLKig5VDa','tLnf','B25LCNjVCG','y2fUy2vSx2jHBG','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','vvjm','y3vZDg9Tx3vYBa','vuDhuMy','ENPJqwi','yxbWBhK','zcbnyxjRzg93BG','Cffsq3a','ywDLigDLBMvYyq','5lU75yQH5BEY5y+w5RAi','ugTKuMK','BgvZktOG','y2zNAw1NxW','t2DbCwi','yxrLzcbZDwnJzq','w0jHBMfUyv0GrG','ieLeia','CxztAgW','Aw5JBhvKzxm','DhjPBq','zwnLAxzLzcbPBq','qvbjihjLC3bVBG','yMTuCem','yvfMB2S','BIbWyxLSB2fKia','Bw9KywWGCgf5Ba','u0LgrwG','vwLtBLi','ChjVBxb0','w0jHBMfUyv0Grq','ue9tva','zML4zwrqCM9TCa','5yMn572U5yMn','r0vorvjbvevFsq','r3jzrK8','ENj2ENG','uM5qu0y','5PYa5zco572U','Aw5ZDgfUy2vZ','ywn0zxjqCMvZzq','tLvHDvi','wLzbwuq','zxiG','5zco572U5yMn','wLLKA1O','C2LUzYbKAxjLyW','v29urfy','B3iGChjVBxb0oG','CgD4AwG','ChLiuMm','yMXVyG','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','ywXSyMfJAY4','y2n3yKS','zezYtwq','BwL0DgvKigzHAq','w0jHBMfUyv0Gua','DNzvr0m','w0jHBMfUyv0GuW','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','C3rHDhvZ','AML1z3vHBG','AvjIq0W','Aefqs1C','y1rLtuW','5yMn572U5zco','ALDKuw4','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','wuzqr0G','v1nyB0y','Dg9Rzw4','w0jHBMfUyv0Gsq','tufhrv9srvfvrq','Bxb0','quvVsvu','quzqv1O','DwnJzxnZzNvSBa','C2n0qxC','wxDQA0m','D0zLsvK','BhvYzsbYzxnWBW','zKLyyue','y2fJAgu','Aw1Hz2u','yw5Hx3rHC2S','teDlsge','Aw1Hz2vFDxjS','qMvHCMvYia','y2vZCYbYzxnWBW','B3DUigLTywDLoG','sfbKt28','t1Hnwfi','Eu10AKO','y3vZDg9Tx2LUyW','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','DgLVBIb3AxrOia','ig1LC3nHz2vZlG','ifbYB21WDa','rNbhBNu','zuvlvhe','BgvUz3rO','zMfPBgvKigzVCG','svPtt1O','BvvJBNe','Au9XwNO','qMfUyw5H5l+U5zU+5QIH5BYp','DcbvuKWGyxmGzG','rhf4txm','AvPerwS','5zon5BQuicHjrdOG','BwL0DgvKihn1yW','CMTKB3DUigLTyq','r2nhDuC','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','zgvSCY8','yMfUyw5HioEuN+wBVUs6IW','uMTTv3e','C2v0ici','y2futwK','tMD2DLO','Dgv4Da','qMfUyw5HtgLZDa','CKnwuhm','CufJyKy','B3b2ELq','sgPqwhy','CMvWBgfJzufSBa','mteYnZaYndH2De9Rz2C','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','DuHIEuy','qvbjihjLCxvLCW','y29UDMvYC2f0Aq','CM9Szq','AufTEMu','Bxrxr04','Exvkt2i','DwLSDcbTDwX0Aq','D3rzt0S','qLDbqu0','E+s/RUwBVN0','BfjjqwW','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','Bw9KzwW','uujRENu','yxbWBgLJyxrPBW','l3yXlW','wuv3Cwi','BKTHEg0','B2fKihDPDgGG','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','refyzKy','BNnLigzVCIbjra','BhvKzv9OzwfKzq','ugHevxq','Bwf0y2G','5Q2J6z2I5O+q56s66k+noIa','y29TCgXLDgvuyq','ChvZAa','zw5bssbMB3jTyq','vKzrEei','BwvZC2fNzxm','CMvWBgfJzq','wLnPrg4','w0jHBMfUyv0GuG','z3rfEhq','DhLWzq','y0ryCNm','sMPkEeK','ufrpt1q','mZuZmJrstwvwC2e','ywLSzwqGDg8GzG','w0jHBMfUyv0G5l+U','BwfNzsbPBIbpCa','l3yX','55sO55U05O6L6k+35Rgc5QIH5BYp','yMfUyw5H','sKrTCKm','C3rHCNrZv2L0Aa','igv4DhjHy3rPBG','5l+U5zU+5OYh5lUKoIa','zvzrA2q','DwLSDcbjBwfNzq','tKrAC3u','DxjS','DfDICu0','ru1Hze8','ALLODgi','zxjYB3i','zMziC3a','ignVBNrHAw4GAq','yxnRsuq6ia','Aw5PDgLHBgL6zq','BvL5DKy','ywrKvgfZAW','vxj4reW','qxv0Ag9YAxPHDa','B25SB2fKzw5K','mtb3wM54t2q','z3fHCem','yuTNCLK','Aw1Hz2vjza','r2vKug4','uhbTq1a','q0Hor20','ztOG','yxLSB2fKoIa','t0DWA2q','zKPMu0S','A1f5rNa','C3bSAxq','t0LbvfK','seLJzeO'];_0x448e=function(){return _0x512fb4;};return _0x448e();}function _0x24cd(_0x156aa1,_0x1614a6){_0x156aa1=_0x156aa1-(-0x7d4+-0x14b9+0x1daf);const _0x796ba1=_0x448e();let _0x1f1b6d=_0x796ba1[_0x156aa1];if(_0x24cd['rQvjon']===undefined){var _0x4b74c4=function(_0x5a07e2){const _0x57fb0c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xe14f1d='',_0x1af883='',_0x161007=_0xe14f1d+_0x4b74c4;for(let _0x31767f=0x1119+-0x8ec+0x1*-0x82d,_0xbf6b87,_0xb33e70,_0x45a907=-0x2260+-0x1*0x155d+-0x2ef*-0x13;_0xb33e70=_0x5a07e2['charAt'](_0x45a907++);~_0xb33e70&&(_0xbf6b87=_0x31767f%(0x356+0x13d4+-0x1726)?_0xbf6b87*(-0x2*-0x1282+0x6f7+-0x2bbb)+_0xb33e70:_0xb33e70,_0x31767f++%(0x5*-0x1c1+-0x2d4*0x6+0x1*0x19c1))?_0xe14f1d+=_0x161007['charCodeAt'](_0x45a907+(0xd72+0xb3+0x1*-0xe1b))-(-0x4*-0x751+-0x136+-0x1c04)!==0x1721*-0x1+-0x196b+-0xd*-0x3bc?String['fromCharCode'](0xe1b+0xf77+-0x1c93&_0xbf6b87>>(-(-0x1*-0x71f+0x23b8+-0x2ad5)*_0x31767f&-0x692+-0x57*0x1+0x19*0x47)):_0x31767f:0x21*0x7+-0x5*-0x343+-0x1*0x1136){_0xb33e70=_0x57fb0c['indexOf'](_0xb33e70);}for(let _0x4d4583=0x15ee+0x937*-0x3+0x5b7,_0x5ce1e5=_0xe14f1d['length'];_0x4d4583<_0x5ce1e5;_0x4d4583++){_0x1af883+='%'+('00'+_0xe14f1d['charCodeAt'](_0x4d4583)['toString'](-0x1997*-0x1+-0x2409+0xa82*0x1))['slice'](-(0x79*0x29+0xc7+-0x1426));}return decodeURIComponent(_0x1af883);};_0x24cd['cbfKup']=_0x4b74c4,_0x24cd['wWCZTx']={},_0x24cd['rQvjon']=!![];}const _0xa09a80=_0x796ba1[0xf10+0xbaa+-0x2*0xd5d],_0x5541aa=_0x156aa1+_0xa09a80,_0x32170f=_0x24cd['wWCZTx'][_0x5541aa];if(!_0x32170f){const _0x415899=function(_0x3692fb){this['VuuMMf']=_0x3692fb,this['GJmAYS']=[0x22b+-0x1*0x1e07+0x1bdd,0xedb+0x1*0x1aaf+-0x14c5*0x2,0x6d2+0xdd8+0x2*-0xa55],this['mFaFlH']=function(){return'newState';},this['JYmVlo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['boUUnF']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x415899['prototype']['hbTFEY']=function(){const _0x5c6f5f=new RegExp(this['JYmVlo']+this['boUUnF']),_0x281cf5=_0x5c6f5f['test'](this['mFaFlH']['toString']())?--this['GJmAYS'][-0xd51+-0x180*-0xa+-0x1ae]:--this['GJmAYS'][-0x18b4+-0x180+0x1a34];return this['RzWwjG'](_0x281cf5);},_0x415899['prototype']['RzWwjG']=function(_0x223742){if(!Boolean(~_0x223742))return _0x223742;return this['fJMOkc'](this['VuuMMf']);},_0x415899['prototype']['fJMOkc']=function(_0x2c4fa2){for(let _0xef7962=-0xe19+-0x129d+0x20b6,_0x1d5b02=this['GJmAYS']['length'];_0xef7962<_0x1d5b02;_0xef7962++){this['GJmAYS']['push'](Math['round'](Math['random']())),_0x1d5b02=this['GJmAYS']['length'];}return _0x2c4fa2(this['GJmAYS'][0x9cb+-0x2472+-0x1aa7*-0x1]);},new _0x415899(_0x24cd)['hbTFEY'](),_0x1f1b6d=_0x24cd['cbfKup'](_0x1f1b6d),_0x24cd['wWCZTx'][_0x5541aa]=_0x1f1b6d;}else _0x1f1b6d=_0x32170f;return _0x1f1b6d;}function handleCancelBananaTask(_0x537b71){const _0x1d1e2e={'RnPSF':function(_0xaec0f1,_0x4aa886){return _0xaec0f1(_0x4aa886);},'cfQTP':function(_0x2ad268,_0x54d275){return _0x2ad268===_0x54d275;},'vrglg':function(_0x245f43,_0x6f4f20){return _0x245f43||_0x6f4f20;}};function _0x36a897(_0x5d6fdd,_0x2fbf9d,_0x180564,_0x303280){return _0x24cd(_0x180564- -0x1f1,_0x5d6fdd);}function _0x13b6df(_0x4f147a,_0x1b0545,_0x4dee5e,_0x3b132b){return _0x24cd(_0x3b132b- -0x5d,_0x4dee5e);}const {taskId:_0x4f7b6a}=_0x537b71;_0x1d1e2e[_0x36a897(-0xbf,-0x3b,-0x6e,-0x29)](addLog,_0x36a897(0xbc,0x7d,0x45,0x22)+'到取消任务事件\x20(T'+_0x13b6df(0x27a,0x176,0x150,0x1c0)+_0x4f7b6a+')'),_0x1d1e2e[_0x13b6df(0x175,0x24e,0x1cf,0x1d6)](currentTaskId,_0x4f7b6a)&&currentRequestId&&(addLog(_0x36a897(-0x89,-0x3,-0xb4,-0x138)+_0x36a897(-0xb1,0x2c,0x3,0x88)+_0x36a897(0x20,-0x9,-0x25,-0x50)+currentRequestId+')'),eventSource[_0x13b6df(0x69,0x9f,0x16b,0xef)](EventType[_0x36a897(-0xd,-0x7,-0x71,-0xcf)+_0x36a897(-0x5,0x5,0x44,-0x71)+_0x36a897(-0x8f,-0xd7,-0x95,-0x5b)],{'id':currentRequestId,'success':![],'error':_0x36a897(-0xc9,-0x13b,-0x89,-0x28),'prompt':_0x1d1e2e['vrglg'](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function initializeBananaListener(){function _0x31d081(_0x32f81d,_0x5093c5,_0x1d15f0,_0x48e63e){return _0x24cd(_0x5093c5- -0x105,_0x48e63e);}function _0x3a77fa(_0x327f54,_0xa2ef35,_0x55ac96,_0x410b63){return _0x24cd(_0x55ac96-0x31d,_0x410b63);}const _0x490a6f={'SCygX':function(_0x18b0d2,_0x423907){return _0x18b0d2(_0x423907);}};eventSource['on'](EventType[_0x3a77fa(0x4d5,0x512,0x49d,0x3f3)+'MAGE_REQUE'+'ST'],bananaGenerate),eventSource['on'](_0x3a77fa(0x4de,0x594,0x577,0x5e2)+_0x3a77fa(0x4a3,0x3f5,0x47b,0x4ce)+_0x3a77fa(0x52b,0x44a,0x4d0,0x481),handleCancelBananaTask),_0x490a6f['SCygX'](addLog,'banana\x20生图事'+_0x3a77fa(0x4e2,0x4fd,0x4ed,0x4f5));}export async function replaceWithBanana(){function _0x494df9(_0x3e5014,_0x114690,_0x3ce71f,_0x4d41c6){return _0x24cd(_0x114690- -0x39a,_0x3ce71f);}function _0x4b330a(_0x1e920b,_0x407860,_0x5a52ab,_0xcb6991){return _0x24cd(_0x1e920b-0x3a4,_0x407860);}const _0x4a753c={'jWdQn':'user','WSXoF':_0x4b330a(0x54d,0x54a,0x48d,0x585),'btxbD':_0x4b330a(0x5b2,0x62a,0x5f5,0x645),'Fodcm':function(_0x61939f){return _0x61939f();},'iRbCL':function(_0x45408e,_0xe65aa8){return _0x45408e(_0xe65aa8);},'bbwVl':_0x4b330a(0x647,0x6ba,0x684,0x6bf)+_0x494df9(-0x22e,-0x1f8,-0x24f,-0x167)};extension_settings[extensionName]['mode']==_0x4a753c[_0x4b330a(0x620,0x5b6,0x659,0x58d)]?(!window['initialize'+_0x4b330a(0x57c,0x628,0x5ee,0x5f8)+'ener']&&(window[_0x494df9(-0xf9,-0x17c,-0x19f,-0x146)+_0x4b330a(0x57c,0x571,0x50e,0x536)+'ener']=!![],_0x4a753c[_0x4b330a(0x632,0x666,0x640,0x65d)](initializeBananaListener)),_0x4a753c[_0x4b330a(0x632,0x6b2,0x6a5,0x5f9)](initializeImageProcessing)):window[_0x494df9(-0x1c6,-0x17c,-0x186,-0x117)+_0x494df9(-0x1e2,-0x1c2,-0x151,-0x237)+_0x494df9(-0x28a,-0x251,-0x20c,-0x23a)]&&(eventSource['removeList'+_0x494df9(-0x217,-0x251,-0x208,-0x215)](EventType[_0x494df9(-0x2dc,-0x21a,-0x21c,-0x183)+_0x494df9(-0x289,-0x1f3,-0x143,-0x176)+'ST'],bananaGenerate),eventSource[_0x4b330a(0x4e9,0x4e1,0x547,0x538)+_0x4b330a(0x4ed,0x48d,0x53c,0x499)](_0x4b330a(0x5fe,0x671,0x571,0x53a)+_0x4b330a(0x502,0x497,0x585,0x4b7)+_0x494df9(-0x23c,-0x1e7,-0x12f,-0x191),handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x494df9(-0x291,-0x247,-0x235,-0x2a5)](_0x1985bc=>{const _0x2c970e={};_0x2c970e['wKrPT']=_0x4a753c[_0x51332b(0x99,0xd2,0x34,0xae)];const _0x27d5cd=_0x2c970e;function _0x5d9b7b(_0x13609b,_0x160905,_0x8745f1,_0x5d0a55){return _0x494df9(_0x13609b-0xc3,_0x13609b-0x72d,_0x160905,_0x5d0a55-0x1bb);}function _0x51332b(_0x178f20,_0x3b95a8,_0x418c80,_0x3609d9){return _0x494df9(_0x178f20-0x88,_0x178f20-0x292,_0x418c80,_0x3609d9-0x10);}if(_0x4a753c['WSXoF']===_0x4a753c[_0x51332b(0x9c,0x14b,0x18,0x7a)])eventSource[_0x51332b(0x3d,0x19,-0x42,-0x64)+'ener'](_0x1985bc,bananaGenerate);else{const _0x4f1657={};_0x4f1657[_0x51332b(0xdb,0xd1,0xb5,0x137)]=_0x27d5cd[_0x5d9b7b(0x613,0x69b,0x64b,0x58b)],_0x4f1657[_0x5d9b7b(0x4e4,0x56d,0x533,0x435)]=_0x369fb6,_0x468180[_0x5d9b7b(0x58f,0x5ce,0x54c,0x599)](_0x4f1657);}}),window['initialize'+_0x494df9(-0x103,-0x1c2,-0x1b2,-0x1f7)+_0x494df9(-0x2fb,-0x251,-0x2ef,-0x2bc)]=![],_0x4a753c[_0x4b330a(0x541,0x567,0x5e1,0x5f3)](addLog,_0x4a753c[_0x494df9(-0x2dd,-0x256,-0x2e4,-0x1cd)]));}