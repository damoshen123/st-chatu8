(function(_0x28d4e7,_0x50f6be){const _0x2a119c=_0x28d4e7();function _0x5e2d8f(_0x45f166,_0x1222a6,_0x959c65,_0x3f0e7c){return _0x45d3(_0x3f0e7c-0x14c,_0x959c65);}function _0x35a145(_0x5c98c6,_0xd30e74,_0x4529ed,_0x47bb83){return _0x45d3(_0xd30e74- -0x30c,_0x4529ed);}while(!![]){try{const _0x4806bb=-parseInt(_0x35a145(-0x1c4,-0x17f,-0x1f4,-0xd5))/(-0x1c9+0x11*-0xd2+-0x2*-0x7de)+-parseInt(_0x35a145(-0x23e,-0x1ae,-0x10f,-0xed))/(0xb99+0x973+-0x150a)+-parseInt(_0x35a145(-0x142,-0x147,-0xcc,-0xef))/(0x258e+-0x1fee+-0x59d)*(-parseInt(_0x5e2d8f(0x344,0x29a,0x3ad,0x2ee))/(-0x107*-0x23+-0xd45+0x5ab*-0x4))+parseInt(_0x5e2d8f(0x2da,0x24b,0x189,0x24a))/(0xebc*0x1+0x10e9+-0x1fa0)+parseInt(_0x35a145(-0x200,-0x1d1,-0x24b,-0x149))/(0xc2f+0x1568+0x1*-0x2191)*(parseInt(_0x5e2d8f(0x22d,0x23c,0x246,0x25e))/(0x68*-0x51+-0x1a66+0x3*0x13c7))+-parseInt(_0x35a145(-0x20b,-0x205,-0x24c,-0x2c3))/(0x4*-0x391+-0x7bc+0x18*0xeb)*(parseInt(_0x5e2d8f(0x269,0x2a7,0x249,0x2be))/(0xf*-0x1d+0x11*-0xe5+-0x1*-0x10f1))+parseInt(_0x35a145(-0x1ae,-0x1bc,-0x1fd,-0x24f))/(0xf*0x9+0x1762+-0x17df)*(parseInt(_0x5e2d8f(0x169,0x1ad,0x1e4,0x227))/(-0x1f92+0x1da0+-0x1*-0x1fd));if(_0x4806bb===_0x50f6be)break;else _0x2a119c['push'](_0x2a119c['shift']());}catch(_0x124cb1){_0x2a119c['push'](_0x2a119c['shift']());}}}(_0xcbbd,-0x2f931+-0xae15d*-0x1+-0x301*-0x146));const _0x1bf5b0=(function(){const _0x158e31={};_0x158e31[_0x1df755(-0x1e4,-0xdb,-0x18e,-0x11b)]=function(_0x23bed7,_0x3126fc){return _0x23bed7===_0x3126fc;},_0x158e31[_0x103d7d(0x33a,0x3eb,0x35c,0x2a2)]=_0x103d7d(0x345,0x309,0x34e,0x340),_0x158e31[_0x1df755(-0x16c,-0x72,-0x12a,-0x1d8)]=_0x1df755(-0xa5,-0xcb,-0x166,-0x217);function _0x1df755(_0x4c56a5,_0x7b77fd,_0x41f316,_0x532e09){return _0x45d3(_0x41f316- -0x27d,_0x532e09);}_0x158e31[_0x103d7d(0x2dd,0x390,0x25d,0x264)]='标准模式:\x20使用请求'+_0x1df755(-0x13c,-0xe5,-0xe0,-0xee);const _0x3b482e=_0x158e31;let _0x37e8e8=!![];function _0x103d7d(_0x884fd8,_0x20dfd8,_0x620307,_0x1f7615){return _0x45d3(_0x884fd8-0x236,_0x20dfd8);}return function(_0x3a674b,_0xce5be9){const _0x234073={'aBTEl':function(_0x217079,_0x2d7f6c){return _0x217079(_0x2d7f6c);},'cOqKf':_0x3b482e[_0x51e5d0(-0x13f,-0x1ee,-0x1c3,-0x1aa)]},_0xac7130=_0x37e8e8?function(){function _0x5c5cdb(_0x32ae94,_0xa3c6f8,_0x3de607,_0x2da5df){return _0x51e5d0(_0x2da5df-0x4a1,_0xa3c6f8-0x18b,_0x3de607,_0x2da5df-0x29);}function _0x1dc5cd(_0x58eddc,_0x4aef51,_0x4a22d3,_0x384115){return _0x51e5d0(_0x58eddc- -0x61,_0x4aef51-0x1ca,_0x4a22d3,_0x384115-0x66);}if(_0xce5be9){if(_0x3b482e['VnYIw'](_0x3b482e['IxJOC'],_0x3b482e[_0x5c5cdb(0x391,0x4af,0x3e7,0x40e)]))_0x234073[_0x5c5cdb(0x51e,0x414,0x52b,0x4a4)](_0xda1c1c,_0x234073[_0x5c5cdb(0x3ee,0x427,0x416,0x384)]),_0x4d3671=_0x5be78a;else{const _0x5d7ace=_0xce5be9[_0x5c5cdb(0x443,0x3c8,0x3b6,0x453)](_0x3a674b,arguments);return _0xce5be9=null,_0x5d7ace;}}}:function(){};function _0x51e5d0(_0x430f99,_0x2880ba,_0x3b1bc3,_0x16e86a){return _0x103d7d(_0x430f99- -0x41c,_0x3b1bc3,_0x3b1bc3-0x4d,_0x16e86a-0x143);}return _0x37e8e8=![],_0xac7130;};}()),_0x165a5d=_0x1bf5b0(this,function(){const _0x18daea={};_0x18daea[_0xba0fcb(0x13c,0xfe,0x149,0x4c)]=_0xba0fcb(0xd0,0xf0,0x3e,0x91)+'+$';function _0xba0fcb(_0x2618f5,_0x2ad75c,_0x490ddf,_0x4e480a){return _0x45d3(_0x2ad75c- -0x5a,_0x490ddf);}function _0xe61f3a(_0x420078,_0x3fadab,_0x28ecd1,_0x2ceb27){return _0x45d3(_0x420078-0xf7,_0x3fadab);}const _0x191f82=_0x18daea;return _0x165a5d[_0xe61f3a(0x2ba,0x2f8,0x268,0x2a8)]()[_0xba0fcb(0xc4,0x138,0x12a,0xa8)](_0x191f82[_0xba0fcb(0x17e,0xfe,0xed,0x190)])[_0xe61f3a(0x2ba,0x363,0x2cf,0x362)]()[_0xba0fcb(0x164,0x145,0xb1,0x193)+'r'](_0x165a5d)[_0xba0fcb(0x18d,0x138,0x153,0xa2)](_0x191f82[_0xba0fcb(0x46,0xfe,0xbb,0x10e)]);});_0x165a5d();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x1980e6){const _0x34c473={};_0x34c473[_0x258cb2(0x1e1,0x267,0x192,0x217)]=function(_0x1638a3,_0x2a1381){return _0x1638a3+_0x2a1381;},_0x34c473[_0x258cb2(0x339,0x2d6,0x23f,0x2cd)]=function(_0x2175d0,_0x349233){return _0x2175d0+_0x349233;};function _0x258cb2(_0x2f7214,_0x5afaa6,_0x101c8b,_0x5330d6){return _0x45d3(_0x5330d6-0x115,_0x5afaa6);}_0x34c473[_0x258cb2(0x288,0x142,0x1f0,0x1cb)]=_0x258cb2(0x2b1,0x21a,0x2c0,0x234),_0x34c473[_0x258cb2(0x1db,0x15b,0x223,0x1c4)]=_0x9dc899(0x2cf,0x26a,0x247,0x2a3),_0x34c473[_0x9dc899(0x305,0x361,0x3ba,0x368)]=function(_0x31666d,_0x14b186){return _0x31666d||_0x14b186;},_0x34c473['CiUek']=_0x258cb2(0x313,0x23e,0x2ec,0x276);const _0x38f64e=_0x34c473;if(!_0x1980e6)return'';function _0x9dc899(_0x17d783,_0x594f7f,_0x3f38f9,_0x1ae1a4){return _0x45d3(_0x17d783-0x1a2,_0x3f38f9);}if(_0x1980e6[_0x258cb2(0x2c8,0x1a0,0x2fc,0x23c)]&&_0x1980e6[_0x9dc899(0x2c9,0x29c,0x33d,0x2fd)]['startsWith'](_0x38f64e[_0x258cb2(0x220,0x22f,0x24b,0x1cb)])){if(_0x38f64e[_0x9dc899(0x251,0x2d3,0x2a0,0x1f9)]!==_0x38f64e[_0x9dc899(0x251,0x2ba,0x206,0x1ca)])_0x123141[_0x9dc899(0x245,0x253,0x19a,0x24a)+_0x5941fa+_0x9dc899(0x357,0x373,0x3b0,0x367)]&&(_0x59228b=_0x38f64e['DeUsf'](_0x38f64e[_0x9dc899(0x35a,0x3ae,0x2c3,0x32d)](_0x532fea,',\x20'),_0x10282b[_0x258cb2(0x187,0x1a5,0x1e5,0x1b8)+_0x113df1+_0x258cb2(0x328,0x315,0x2e9,0x2ca)]));else{const _0x2d14fc=await getConfigImage(_0x1980e6[_0x9dc899(0x2c9,0x30b,0x220,0x30a)]);return _0x38f64e[_0x9dc899(0x305,0x2e3,0x2df,0x334)](_0x2d14fc,'');}}if(_0x1980e6['image']&&_0x1980e6['image'][_0x258cb2(0x236,0x26e,0x1a4,0x22f)](_0x38f64e[_0x258cb2(0x337,0x2ea,0x269,0x279)]))return _0x1980e6[_0x258cb2(0x291,0x267,0x32a,0x2ba)];return'';}function _0x45d3(_0x148c65,_0x237d4d){_0x148c65=_0x148c65-(-0x1391+-0x233e+0x3771);const _0x54288b=_0xcbbd();let _0x27bbcd=_0x54288b[_0x148c65];if(_0x45d3['ulpRUP']===undefined){var _0x374def=function(_0x33d612){const _0x5c9da2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1447f1='',_0x3b66af='',_0x118595=_0x1447f1+_0x374def;for(let _0x1508ba=-0x1ca4+-0x56*-0x36+0x60*0x1c,_0x5d33f9,_0xe0171f,_0x94022d=0x11d7*0x2+0x1cd*0x1+-0x257b;_0xe0171f=_0x33d612['charAt'](_0x94022d++);~_0xe0171f&&(_0x5d33f9=_0x1508ba%(0x2548+-0x10cd+-0x1477)?_0x5d33f9*(0xf3c+0x96f+0x37d*-0x7)+_0xe0171f:_0xe0171f,_0x1508ba++%(0x19d0+0x6a7+-0x39b*0x9))?_0x1447f1+=_0x118595['charCodeAt'](_0x94022d+(0x224b+-0xd*0x15b+-0x851*0x2))-(-0xbc3+0x1*0x431+-0x1*-0x79c)!==0x18e8+0x1*0x1d6a+0x1*-0x3652?String['fromCharCode'](-0x4*0xd+0x1464+-0x1331&_0x5d33f9>>(-(0x1b*0x162+0xfdf*0x1+-0x3533)*_0x1508ba&0x1c41*-0x1+0x1*0x1c14+0x33)):_0x1508ba:-0x1*-0x2551+-0xbd0+0x1981*-0x1){_0xe0171f=_0x5c9da2['indexOf'](_0xe0171f);}for(let _0x356147=-0xb95*-0x1+0x1*0x1085+0x28e*-0xb,_0x1dc594=_0x1447f1['length'];_0x356147<_0x1dc594;_0x356147++){_0x3b66af+='%'+('00'+_0x1447f1['charCodeAt'](_0x356147)['toString'](0x2235*-0x1+0x1097+0x11ae))['slice'](-(0x59f*0x1+-0x182b+-0xa*-0x1db));}return decodeURIComponent(_0x3b66af);};_0x45d3['qpJGoR']=_0x374def,_0x45d3['juWNfl']={},_0x45d3['ulpRUP']=!![];}const _0x171e86=_0x54288b[0x21f5+0x1d16+-0x3f0b*0x1],_0x4b52c2=_0x148c65+_0x171e86,_0x3acd93=_0x45d3['juWNfl'][_0x4b52c2];if(!_0x3acd93){const _0x4b6f38=function(_0x1e6cf0){this['hTdXYp']=_0x1e6cf0,this['iZLvFZ']=[0x2b*0x5a+0x4*0x6d+-0x7b*0x23,0x876*-0x1+-0x1be7+-0xc1f*-0x3,0x217*-0x8+0x18*-0xd+-0xa4*-0x1c],this['vScGUZ']=function(){return'newState';},this['hhrZVP']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['GOyfLo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4b6f38['prototype']['kdrAuQ']=function(){const _0x3593ec=new RegExp(this['hhrZVP']+this['GOyfLo']),_0x4d6c70=_0x3593ec['test'](this['vScGUZ']['toString']())?--this['iZLvFZ'][0x1dd9*0x1+-0x14d9+-0x8ff]:--this['iZLvFZ'][0x701+0x41*-0x16+0x21*-0xb];return this['tiCmVs'](_0x4d6c70);},_0x4b6f38['prototype']['tiCmVs']=function(_0x4c5128){if(!Boolean(~_0x4c5128))return _0x4c5128;return this['JqHxxq'](this['hTdXYp']);},_0x4b6f38['prototype']['JqHxxq']=function(_0xe4b723){for(let _0xb268b5=0x194*0xb+-0xde*-0x26+-0x3250,_0x3253ca=this['iZLvFZ']['length'];_0xb268b5<_0x3253ca;_0xb268b5++){this['iZLvFZ']['push'](Math['round'](Math['random']())),_0x3253ca=this['iZLvFZ']['length'];}return _0xe4b723(this['iZLvFZ'][-0x20ba+0x527*-0x5+0x3a7d]);},new _0x4b6f38(_0x45d3)['kdrAuQ'](),_0x27bbcd=_0x45d3['qpJGoR'](_0x27bbcd),_0x45d3['juWNfl'][_0x4b52c2]=_0x27bbcd;}else _0x27bbcd=_0x3acd93;return _0x27bbcd;}async function generateBananaImage({prompt:_0x5a4880,width:_0x4456c0,height:_0x36c20f,change:_0x3cddcf,retouchPrompt:_0x315b60,retouchImage:_0x11fff8}){const _0x3cf82f={'vHbis':_0x283a68(0x2e4,0x31b,0x392,0x270),'PcvvK':function(_0x39d87c,_0x458373){return _0x39d87c(_0x458373);},'kCwfj':function(_0x51973a,_0xf7e7f){return _0x51973a(_0xf7e7f);},'eLdzk':function(_0xdeb4de){return _0xdeb4de();},'pRqXU':function(_0x650d55){return _0x650d55();},'PudqK':function(_0x5ee2fd,_0x4d8456){return _0x5ee2fd(_0x4d8456);},'nQlTE':function(_0x5bf53d,_0x4746be){return _0x5bf53d(_0x4746be);},'HfIrP':function(_0x50b490){return _0x50b490();},'rTNnd':'{修图}','ACTPu':_0x283a68(0x37f,0x378,0x2f8,0x3e9)+_0x4a3346(-0xdc,-0x45,-0xf9,-0x117)+_0x4a3346(0x63,-0x90,-0x10,-0xae)+_0x283a68(0x364,0x394,0x2ff,0x303)+'\x20image.','XiNXs':function(_0x451052,_0x3f98fc){return _0x451052+_0x3f98fc;},'tWavN':function(_0x29ed61,_0x5f53d2){return _0x29ed61(_0x5f53d2);},'AhSfp':_0x4a3346(0x61,-0x41,-0xb,-0x82)+_0x283a68(0x391,0x383,0x3cd,0x2f8)+_0x4a3346(-0x163,-0x34,-0xbb,-0xd2)+_0x4a3346(0x10,-0x65,-0x3e,-0xb),'SyDQq':function(_0x21b356,_0x22c76b){return _0x21b356(_0x22c76b);},'sXJAL':'st_chatu8_'+_0x283a68(0x3ce,0x455,0x4df,0x492)+_0x4a3346(-0x9f,-0xa4,-0x13,-0xca),'NnXkK':function(_0x421f0c,_0x236223){return _0x421f0c(_0x236223);},'zeMby':_0x283a68(0x38b,0x3e4,0x416,0x45d)+_0x4a3346(-0xa9,-0xae,-0xd1,-0xb1),'wTboq':function(_0x31289c,_0x5274c6){return _0x31289c+_0x5274c6;},'HXzMw':function(_0x371139,_0x1fa553){return _0x371139+_0x1fa553;},'IgtOz':_0x283a68(0x296,0x343,0x2b0,0x33d)+'n/json','xYEmv':function(_0x415b00,_0x57b67d){return _0x415b00(_0x57b67d);},'pBZFu':function(_0x464ef4,_0xe5712f){return _0x464ef4===_0xe5712f;},'xQVUu':_0x283a68(0x454,0x41e,0x4b0,0x38d),'SRQbY':_0x283a68(0x3bc,0x43e,0x490,0x3ef),'xQjum':function(_0x4d3ef4,_0x421ec9){return _0x4d3ef4||_0x421ec9;},'uRTIW':function(_0x110fe3,_0x507e72){return _0x110fe3>_0x507e72;},'YdrCu':'...','rFGlp':function(_0x1aaccd,_0x43155b){return _0x1aaccd(_0x43155b);},'shcOB':'Scene\x20Comp'+_0x283a68(0x4ba,0x43a,0x48d,0x4b3),'chESe':function(_0x11f6a9,_0x59debd){return _0x11f6a9(_0x59debd);},'ceHIY':function(_0x3c9e81,_0x496117){return _0x3c9e81(_0x496117);},'AhjWM':_0x4a3346(-0x160,-0x4,-0xc4,-0xd5),'CAuAV':'标准模式:\x20使用请求'+_0x4a3346(-0x2f,0x1a,-0x3a,-0x71),'CMcyc':function(_0x5c38db,_0x3478d1,_0x49eba9){return _0x5c38db(_0x3478d1,_0x49eba9);},'kZRJN':function(_0x5d70d0,_0x4755f9){return _0x5d70d0<=_0x4755f9;},'EIXEF':function(_0x209096,_0x4ed03f){return _0x209096===_0x4ed03f;},'bzBiL':_0x283a68(0x361,0x38c,0x336,0x3c7),'RmdBE':function(_0x2fa735,_0x48967f){return _0x2fa735===_0x48967f;},'QJrLR':_0x4a3346(0xdf,0x14,0x1e,-0x68),'pisqR':_0x283a68(0x404,0x45d,0x50d,0x434),'lzsAe':function(_0x43ffc8,_0x310c15){return _0x43ffc8+_0x310c15;},'hhxHl':function(_0x497fcc,_0x2f435d){return _0x497fcc(_0x2f435d);},'QmNhh':function(_0x5349ab,_0x49b486){return _0x5349ab(_0x49b486);},'qDIJO':'imagen','jRRIH':_0x4a3346(0x2b,0x6b,0x27,0x99),'vFTGn':_0x283a68(0x3d2,0x376,0x3f0,0x2d8),'gqaKO':_0x283a68(0x3b4,0x3e3,0x33e,0x45f),'kIGjO':function(_0x333144,_0x46dff0){return _0x333144(_0x46dff0);},'ehTNR':function(_0x22c4e9,_0x1a087e){return _0x22c4e9!==_0x1a087e;},'GSUbV':_0x4a3346(-0x4e,0x22,-0x97,-0xb3),'iIbiv':'exvxg','hrkMN':_0x4a3346(-0x6,-0x66,0x4a,-0x22),'AgTBW':function(_0xa9a45c,_0x4cbcf0){return _0xa9a45c(_0x4cbcf0);},'VFSrE':_0x4a3346(0x3b,-0x2c,-0x85,-0xb3)+_0x283a68(0x3aa,0x3f8,0x427,0x3b0)+'。','nlyzH':function(_0x5b6093,_0x40142d){return _0x5b6093(_0x40142d);},'XwKhe':'前置前','jKawc':function(_0x53c7d6,_0x88d51b){return _0x53c7d6(_0x88d51b);},'fpSjL':function(_0x2cf718,_0x5beb21){return _0x2cf718===_0x5beb21;},'pwUto':_0x283a68(0x447,0x425,0x40c,0x3cb),'uHNUz':function(_0x4d15,_0x4e5b4b){return _0x4d15(_0x4e5b4b);},'nZOVH':_0x4a3346(0x4d,0x6d,0x2a,0x69),'UqQcr':function(_0x5c3af9,_0x567222){return _0x5c3af9!==_0x567222;},'sDSyF':_0x4a3346(-0x150,-0x1c4,-0x133,-0x19e),'okCxx':_0x283a68(0x2fb,0x313,0x2b6,0x3b4),'xePJX':function(_0x54b687,_0x32324d){return _0x54b687(_0x32324d);},'hTPnH':_0x283a68(0x461,0x3ae,0x35e,0x3c9),'DcZNW':_0x4a3346(-0x9f,-0x27,-0xe5,-0x5b),'nzFgY':_0x4a3346(-0x21,-0x10b,-0x92,0x13),'jeJJF':_0x283a68(0x2eb,0x33c,0x33c,0x353),'UAWYF':_0x283a68(0x453,0x3e0,0x36c,0x3d6),'LzQPu':'toiZz','TDHjU':function(_0x293787,_0x136f02){return _0x293787===_0x136f02;},'Lpfsc':function(_0x2c33fd,_0x3ec8c7){return _0x2c33fd||_0x3ec8c7;},'PGENj':function(_0x122b84,_0x31d138){return _0x122b84===_0x31d138;},'KYFiL':_0x4a3346(-0x17a,-0xef,-0xc7,-0xea),'koNcd':_0x283a68(0x458,0x3c0,0x481,0x401),'QyLwN':_0x283a68(0x4b9,0x3f9,0x498,0x39c),'wTtXa':_0x283a68(0x482,0x454,0x471,0x3db),'svLHB':_0x283a68(0x42b,0x3b5,0x43f,0x32b),'vxNSa':function(_0x7cd58,_0x197bfd){return _0x7cd58+_0x197bfd;},'stBXq':function(_0x40bdbc,_0x33da06){return _0x40bdbc+_0x33da06;},'VeTdX':function(_0x2f6c86,_0x4fad62){return _0x2f6c86===_0x4fad62;},'wwLRq':function(_0x43bafa,_0x153d90){return _0x43bafa!==_0x153d90;},'sJqxJ':_0x283a68(0x35d,0x330,0x2ac,0x2fb),'gQaqg':_0x283a68(0x4e9,0x458,0x39e,0x3f5)+'nds/chat-c'+_0x4a3346(-0x17d,-0x19e,-0x120,-0x1d2)+_0x4a3346(-0x5c,-0xcb,-0x6a,0x2f),'BiTyc':_0x4a3346(-0x6e,0x13,-0x8a,0x19),'IRnZT':function(_0x29c5e1,_0x4ee772){return _0x29c5e1===_0x4ee772;},'wMJwI':_0x4a3346(-0x96,-0x82,-0x6e,-0xc0),'TrzwK':function(_0x384144,_0xbdb0ae){return _0x384144(_0xbdb0ae);},'HfQud':_0x283a68(0x42a,0x38e,0x430,0x346),'cPmpX':_0x283a68(0x35d,0x310,0x29a,0x370),'Dwcpc':function(_0x3a0bce,_0x16684b,_0x3f325c){return _0x3a0bce(_0x16684b,_0x3f325c);},'XFSeg':_0x283a68(0x38b,0x364,0x412,0x3b7),'BxnBz':_0x283a68(0x2e4,0x306,0x288,0x334),'MvXZF':_0x4a3346(-0xd1,-0x1d,-0x66,-0xf5),'pkhPh':function(_0x5b54f7,_0x49ef2d){return _0x5b54f7===_0x49ef2d;},'DlgRk':function(_0x5aaf72,_0x40bc7a){return _0x5aaf72===_0x40bc7a;},'ynfSL':_0x4a3346(-0x1bb,-0x6b,-0x113,-0x17a),'ouiAf':function(_0x56590a,_0x110d63){return _0x56590a!==_0x110d63;},'CDtgl':_0x4a3346(0x3d,-0xf0,-0x7b,0x27),'fsbCW':'[Banana]\x20D'+_0x283a68(0x350,0x315,0x356,0x2b1)+_0x4a3346(-0xc1,-0xac,-0x131,-0x72)+_0x283a68(0x532,0x46f,0x4cb,0x4e8)+'\x20extractin'+_0x4a3346(-0xa3,-0x6,-0xc3,-0x155),'ruErk':function(_0x88fa06,_0x89b517){return _0x88fa06(_0x89b517);},'sppFb':_0x283a68(0x3ec,0x37e,0x2c5,0x35e)+_0x4a3346(-0x137,-0xa7,-0x112,-0xa8)+_0x283a68(0x4d0,0x418,0x4b1,0x446)+_0x4a3346(0x69,-0xb2,-0x29,0x3e)+_0x283a68(0x340,0x31e,0x26d,0x2cb)+'base64.','DfoWp':function(_0xbf7ba7,_0x5b02a1){return _0xbf7ba7(_0x5b02a1);},'ZQMfn':_0x283a68(0x362,0x407,0x3f4,0x3da),'njZqQ':_0x283a68(0x25d,0x305,0x354,0x320)+_0x4a3346(-0xa2,-0x13a,-0xb3,-0x115)+'\x20contain\x20i'+_0x4a3346(-0x51,-0x19a,-0xd7,-0x10b)+_0x4a3346(-0xb0,0x44,0x13,-0x37)+'t','WppsW':function(_0x13294c,_0x3b7b6e){return _0x13294c(_0x3b7b6e);},'WqLfi':_0x4a3346(-0x7c,-0xb2,-0x3c,-0x28)+_0x283a68(0x370,0x401,0x390,0x3a6)+_0x4a3346(-0x146,-0x140,-0x83,-0x1b)+_0x283a68(0x449,0x412,0x3ba,0x3f8),'YuYgw':function(_0x3907f1,_0x4de030){return _0x3907f1(_0x4de030);},'wYNci':_0x283a68(0x49b,0x431,0x419,0x3bd)+_0x4a3346(0xdb,-0x50,0x19,-0x95)+':','fCmQG':_0x4a3346(-0xaf,-0x64,-0xf1,-0x35)};_0x3cf82f['HfIrP'](clearLog);const _0x4fb513=taskQueue[_0x283a68(0x39b,0x329,0x29e,0x36a)]({'name':_0x3cf82f[_0x4a3346(0xc0,0xea,0x28,0xd3)](_0x3cf82f[_0x283a68(0x40a,0x420,0x368,0x3ca)](_0x5a4880,'')['substring'](-0x1f*-0xac+-0x8eb+-0xbe9,-0x1c05+0x1a7d+0x1a6),_0x5a4880&&_0x3cf82f[_0x283a68(0x3fb,0x3a9,0x413,0x356)](_0x5a4880['length'],-0x22ba+-0x1f3+0x24cb)?_0x3cf82f[_0x4a3346(0xb5,-0x22,0x22,0xcb)]:''),'type':TaskType[_0x283a68(0x498,0x45a,0x3ff,0x43a)],'prompt':_0x5a4880});currentTaskId=_0x4fb513,_0x5a4880=_0x3cf82f[_0x4a3346(-0x6e,-0x191,-0x12b,-0x8b)](processCharacterPrompt,_0x5a4880),_0x5a4880=await _0x3cf82f[_0x4a3346(-0x9a,-0x32,-0xcf,-0x12c)](stripChineseAnnotations,_0x5a4880);let _0x1984ca=_0x3cddcf;_0x3cddcf=_0x3cf82f[_0x4a3346(-0x8b,-0xac,-0x12b,-0x8c)](processCharacterPrompt,_0x3cddcf),_0x3cddcf=await stripChineseAnnotations(_0x3cddcf),_0x3cf82f[_0x283a68(0x37f,0x42f,0x4b4,0x45a)](addLog,'开始\x20Banana生'+_0x283a68(0x4b7,0x472,0x467,0x452)+extension_settings[extensionName]['client']),_0x3cf82f[_0x283a68(0x3a1,0x446,0x4da,0x3b1)](addLog,_0x283a68(0x435,0x373,0x422,0x2d2)+'\x20'+_0x3cf82f[_0x283a68(0x424,0x420,0x4c2,0x4b5)](_0x4456c0,'默认')+_0x4a3346(0x8a,0xa,0x44,0x73)+_0x3cf82f[_0x283a68(0x399,0x420,0x379,0x387)](_0x36c20f,'默认')),_0x5a4880=_0x3cddcf&&_0x3cddcf[_0x283a68(0x36e,0x389,0x3ed,0x2cd)]()!==''?_0x3cddcf:_0x5a4880,_0x3cf82f['kCwfj'](addLog,_0x4a3346(-0x60,-0x192,-0xfa,-0x184)+_0x5a4880);let _0x575b1b=![];function _0x4a3346(_0x177af2,_0x25e3ae,_0x3aad71,_0x4ac6a2){return _0x45d3(_0x3aad71- -0x1d7,_0x177af2);}_0x5a4880[_0x4a3346(-0x49,-0xd6,-0x53,-0xd9)](_0x3cf82f[_0x283a68(0x405,0x414,0x4b1,0x3d9)])&&(_0x575b1b=!![]);_0x3cf82f[_0x4a3346(-0xd1,-0x35,-0xa5,0x8)](addLog,_0x283a68(0x2aa,0x34b,0x403,0x3ff)+_0x4a3346(-0x95,-0xc,0x1d,0x9f)+_0x4a3346(0x5d,-0xb7,-0x8,-0xbb)+_0x575b1b);let _0x345c59={},_0x4b858d='',_0x23307d='';if(_0x575b1b){_0x3cf82f[_0x4a3346(-0x74,0x50,0x30,0x25)](addLog,'分角色模式:\x20解析带'+_0x283a68(0x53e,0x47b,0x491,0x480)),_0x345c59=_0x3cf82f[_0x4a3346(-0x10c,-0x29,-0x95,-0xf1)](parsePromptStringWithCoordinates,_0x5a4880),_0x4b858d=_0x345c59[_0x3cf82f[_0x283a68(0x450,0x414,0x49d,0x41f)]];for(let _0x315590=0x74b*-0x2+-0xb*0x13c+0x1c2b*0x1;_0x315590<=-0x2424+0x1ee3*-0x1+0x1*0x430b;_0x315590++){_0x345c59[_0x283a68(0x23c,0x2fb,0x343,0x244)+_0x315590+_0x4a3346(-0x2,-0x72,-0x22,0x56)]&&(_0x23307d=_0x3cf82f[_0x283a68(0x2dd,0x384,0x41a,0x3c7)](_0x23307d+',\x20',_0x345c59[_0x283a68(0x300,0x2fb,0x366,0x395)+_0x315590+'\x20Prompt']));}}else{if(_0x4a3346(-0x5a,-0xa2,-0xb2,-0xce)===_0x3cf82f[_0x4a3346(-0x150,-0xb1,-0x94,-0xe)]){if(_0x6ff9ee){const _0x4be9ea=_0x114ceb[_0x4a3346(0x61,-0x41,-0x3f,-0xf)](_0x2155d3,arguments);return _0x34cd86=null,_0x4be9ea;}}else _0x3cf82f[_0x4a3346(-0x6f,-0x9e,0xd,-0x1f)](addLog,_0x3cf82f[_0x283a68(0x335,0x3d5,0x44c,0x3aa)]),_0x4b858d=_0x5a4880;}let {modifiedPrompt:_0x4fb2d9,insertions:_0x3fd4bc}=await _0x3cf82f[_0x4a3346(-0x109,-0x1ea,-0x12c,-0x1ce)](prompt_replace,_0x4b858d,_0x23307d);if(_0x575b1b)for(let _0x408ea1=0x26a2+-0x2f*-0xa1+0x1*-0x4430;_0x3cf82f[_0x4a3346(-0x61,-0x132,-0xfb,-0x57)](_0x408ea1,-0x1969+0x1977*0x1+0x2*-0x5);_0x408ea1++){if(_0x3cf82f[_0x4a3346(0x33,-0x72,-0x1a,0x58)](_0x3cf82f[_0x4a3346(0xe1,0xa4,0x3c,0x30)],_0x3cf82f[_0x4a3346(-0x1d,0xb7,0x3c,0xf5)])){if(_0x345c59[_0x283a68(0x29f,0x2fb,0x328,0x397)+_0x408ea1+_0x4a3346(-0xc2,0x39,-0x22,0x4c)]){if(_0x3cf82f[_0x283a68(0x37b,0x399,0x40b,0x42c)](_0x3cf82f['QJrLR'],_0x3cf82f[_0x4a3346(0x48,-0xb9,-0x47,0x36)])){const _0x860c64=[],_0x2fec50=_0x171fbc||_0x4c955f,_0x3e8b18=[_0x48bc54['fixedPromp'+'t'],_0x2fec50,_0x202771[_0x4a3346(-0x19,-0xa2,-0x2,0x2b)+_0x283a68(0x42d,0x3af,0x453,0x327)]][_0x4a3346(0x8f,-0x34,-0xe,0x59)](_0x54153a)['join'](',\x20'),_0x33f44b={};_0x33f44b[_0x283a68(0x3df,0x471,0x485,0x4ff)]=_0x3cf82f[_0x283a68(0x3f3,0x466,0x4cc,0x441)],_0x33f44b[_0x4a3346(-0x53,-0x64,-0x114,-0x5f)]=_0x3e8b18,_0x860c64['push'](_0x33f44b);if(_0x46f45a){const _0x39968f={};_0x39968f['url']=_0x2ebb6b;const _0x1eb8c3={};_0x1eb8c3[_0x4a3346(0xcd,0xb7,0x42,0xe1)]=_0x4a3346(0xd0,-0x2a,0x2a,-0x7),_0x1eb8c3[_0x4a3346(0x9e,0x9a,0x2a,0x1e)]=_0x39968f,_0x860c64[_0x283a68(0x283,0x332,0x2ae,0x2e3)](_0x1eb8c3),_0x3cf82f['PcvvK'](_0x31fb19,_0x4a3346(-0x152,-0x153,-0xb6,-0x174)+_0x4a3346(0x13,0xf,-0x9,-0x50)+_0x283a68(0x432,0x3a0,0x440,0x43b));}const _0x92472e={};_0x92472e[_0x283a68(0x466,0x40e,0x364,0x410)]='user',_0x92472e[_0x283a68(0x4dc,0x449,0x4b9,0x3d8)]=_0x860c64,_0x43eee2[_0x283a68(0x3c0,0x332,0x340,0x28a)](_0x92472e),_0x3cf82f[_0x4a3346(-0xbb,-0x7e,-0x12b,-0x15d)](_0x2e06e1,'[Banana]\x20修'+_0x4a3346(-0x50,-0xd9,-0x10b,-0x170)+_0x3e8b18);}else _0x4fb2d9=_0x3cf82f[_0x4a3346(-0x11e,-0x126,-0x68,-0x15)](_0x4fb2d9,_0x283a68(0x2a1,0x346,0x32f,0x32e))+_0x3cf82f[_0x283a68(0x473,0x432,0x3f3,0x4ad)](prompt_replace_for_character,_0x345c59[_0x4a3346(-0x1cb,-0x1bd,-0x134,-0xb5)+_0x408ea1+_0x283a68(0x41c,0x40d,0x4af,0x37b)]);}}else!_0x5ae228[_0x4a3346(0x5a,-0x103,-0x4e,-0xa5)+_0x4a3346(-0x6c,0x6d,-0x3d,0xf)+_0x4a3346(-0x44,-0x27,-0xde,-0x34)]&&(_0x144527['initialize'+_0x283a68(0x458,0x3f2,0x371,0x4a0)+'ener']=!![],_0x3cf82f[_0x4a3346(-0x8a,-0x8d,-0xfe,-0x3c)](_0x8f7acb)),_0x3cf82f[_0x4a3346(-0x125,-0x95,-0xd6,-0x162)](_0x365595);}const _0x417113=extension_settings[extensionName][_0x283a68(0x469,0x43f,0x3ac,0x493)],{model:_0x2f427a,apiUrl:_0x288313,apiKey:_0xf26fdf,conversationPresets:_0x1335a5,conversationPresetId:_0x4ee487,editPresetId:_0x922a47,aspectRatio:_0x2d30e9}=_0x417113;_0x3cf82f['QmNhh'](addLog,_0x4a3346(-0xea,-0x10,-0xb1,-0x142)+_0x283a68(0x3b7,0x3b1,0x44c,0x43c)+_0x283a68(0x31c,0x390,0x2ee,0x418)+_0x283a68(0x471,0x3b8,0x338,0x34b)+'model:\x20'+_0x2f427a);let _0x5269cb,_0x5f08e0;if(_0x2f427a[_0x4a3346(-0x147,-0xbb,-0xbd,-0x60)](_0x3cf82f['qDIJO'])){_0x5269cb=_0x283a68(0x3c2,0x3c3,0x3f3,0x367)+'dels/'+_0x2f427a;const _0x2c0b3f={};_0x2c0b3f[_0x4a3346(0x5,0x2c,0x5,0x6e)+'t']='';const _0x148057=_0x1335a5[_0x4ee487]||_0x2c0b3f,_0x930bf=[_0x148057[_0x283a68(0x3cc,0x434,0x433,0x440)+'t'],_0x3fd4bc['前置前'],_0x3fd4bc[_0x283a68(0x305,0x325,0x2c5,0x3d5)],_0x4fb2d9,_0x3fd4bc[_0x3cf82f[_0x283a68(0x3e5,0x3be,0x3ca,0x477)]],_0x3fd4bc[_0x3cf82f['vFTGn']],_0x148057[_0x283a68(0x3e3,0x42d,0x3ca,0x4cb)+_0x283a68(0x435,0x3af,0x421,0x3fd)],_0x3fd4bc[_0x3cf82f['gqaKO']]][_0x283a68(0x363,0x421,0x370,0x4d4)](Boolean)['join'](',\x20');_0x3cf82f['kIGjO'](addLog,_0x283a68(0x2e6,0x35d,0x2db,0x321)+_0x930bf);const _0x143261={};_0x143261[_0x283a68(0x2d5,0x34c,0x2d1,0x2ee)]=_0x930bf;const _0x4de83a={};_0x4de83a[_0x283a68(0x2f7,0x37a,0x3eb,0x2c7)+'t']=0x1,_0x4de83a[_0x4a3346(0x30,-0xb0,-0x46,-0x7f)+'o']=_0x2d30e9;const _0x5bbd7a={};_0x5bbd7a[_0x283a68(0x423,0x3df,0x396,0x349)]=[_0x143261],_0x5bbd7a[_0x4a3346(0x8a,0x5a,-0x2b,-0x8d)]=_0x4de83a,_0x5f08e0=_0x5bbd7a,_0x3cf82f['tWavN'](addLog,'[Banana]\x20B'+'uilt\x20Image'+'n\x20payload\x20'+_0x4a3346(-0x8e,0x71,-0x26,0x2a)+_0x283a68(0x46e,0x436,0x4b2,0x391)+_0x930bf);}else{if(_0x3cf82f[_0x4a3346(-0x59,0x21,-0x7c,-0x138)](_0x3cf82f[_0x4a3346(-0xe7,-0xb9,-0x101,-0x113)],_0x3cf82f[_0x283a68(0x281,0x311,0x276,0x374)])){_0x5269cb=_0x4a3346(0x20,-0xa,0x15,0x84)+_0x4a3346(-0x12d,-0xc4,-0x120,-0x182);let _0x1123be;if(_0x3cddcf[_0x283a68(0x38c,0x3dc,0x47f,0x3f5)](_0x3cf82f[_0x283a68(0x2ef,0x340,0x3e7,0x347)])){if(_0x3cf82f[_0x4a3346(-0xba,-0xcc,-0x62,-0x20)]==='CRfAk'){_0x3cf82f['AgTBW'](addLog,_0x3cf82f[_0x4a3346(0x94,0x9f,0x4d,0xbb)]);const _0x4fd132=_0x3cf82f['xQjum'](_0x922a47,'默认'),_0x563530={};_0x563530[_0x283a68(0x4ca,0x438,0x437,0x430)+'on']=[],_0x563530[_0x4a3346(0x69,0x8e,0x5,0xb9)+'t']='',_0x1123be=_0x1335a5[_0x4fd132]||_0x563530,_0x3cf82f[_0x283a68(0x396,0x344,0x3bc,0x3af)](addLog,_0x4a3346(0x0,-0x114,-0x57,-0xc5)+'用修图预设:\x20\x22'+_0x4fd132+'\x22');}else{_0x3cf82f[_0x283a68(0x39a,0x3d3,0x495,0x420)](_0x1ba2ba,_0x283a68(0x302,0x32f,0x3a7,0x28d)+'启动');if(_0x5b857a)_0x3cf82f['PudqK'](_0x11a4b8,_0x4a3346(-0x93,-0xa1,-0x52,-0x18)+_0xd24806);if(_0xb5730f)_0x3cf82f[_0x4a3346(-0xf2,-0x1c6,-0x12b,-0x147)](_0x243c2c,_0x283a68(0x3b8,0x45e,0x491,0x4cd)+']');}}else{const _0x5c43a2={};_0x5c43a2[_0x4a3346(0x2a,-0x9a,0x9,-0x18)+'on']=[],_0x5c43a2[_0x4a3346(-0x30,-0x96,0x5,0x1a)+'t']='',_0x1123be=_0x1335a5[_0x4ee487]||_0x5c43a2;}const _0x5b4a0b=[_0x1123be[_0x283a68(0x4ad,0x434,0x3d9,0x431)+'t'],_0x3fd4bc[_0x3cf82f[_0x283a68(0x3da,0x35b,0x357,0x309)]],_0x3fd4bc[_0x283a68(0x2ce,0x325,0x2d8,0x2cd)],_0x4fb2d9,_0x3fd4bc[_0x3cf82f[_0x283a68(0x35f,0x3be,0x32f,0x3e7)]],_0x3fd4bc[_0x3cf82f['vFTGn']],_0x1123be[_0x4a3346(0x41,0x56,-0x2,-0x88)+_0x4a3346(-0x59,-0x135,-0x80,-0x6)],_0x3fd4bc[_0x3cf82f[_0x283a68(0x4d2,0x43b,0x37a,0x474)]]][_0x4a3346(-0x19,-0x82,-0xe,-0x54)](Boolean)[_0x4a3346(-0x1dc,-0x199,-0x11d,-0x162)](',\x20');_0x3cf82f[_0x283a68(0x36b,0x3d4,0x471,0x3b6)](addLog,_0x283a68(0x357,0x35d,0x38a,0x3d2)+_0x5b4a0b);const _0x1e62e2={};_0x1e62e2[_0x4a3346(-0xc1,-0xc2,-0x21,-0xc)]=_0x4a3346(-0x30,-0xc6,-0x92,-0xd9),_0x1e62e2[_0x4a3346(-0x72,-0xa9,0x1a,0x16)]=[];const _0x2bf902={};_0x2bf902[_0x283a68(0x40a,0x40e,0x47b,0x46c)]=_0x283a68(0x3a3,0x33c,0x3d6,0x335),_0x2bf902[_0x283a68(0x399,0x449,0x421,0x4a1)]=[];const _0x1a294e=_0x1123be[_0x283a68(0x4a0,0x438,0x3ed,0x487)+'on']['map'](_0x321889=>[_0x1e62e2,_0x2bf902])[_0x283a68(0x3e7,0x42a,0x3e1,0x3f1)]();let _0x503808=0x3*0xc6d+-0x13*0x180+0x3*-0x2ed;for(const _0x621cf0 of _0x1123be[_0x283a68(0x3c3,0x438,0x432,0x391)+'on']){if(_0x3cf82f[_0x4a3346(-0xc9,-0x1be,-0x135,-0x19d)](_0x3cf82f['pwUto'],_0x3cf82f[_0x283a68(0x40a,0x433,0x3f3,0x47f)])){if(_0x621cf0['user']?.['text'])_0x1a294e[_0x503808][_0x4a3346(0x1e,-0x6,0x1a,0x91)][_0x283a68(0x3f3,0x332,0x351,0x3be)]({'type':_0x3cf82f[_0x4a3346(-0x75,-0x4e,0x37,0x1d)],'text':_0x621cf0[_0x4a3346(-0x69,-0x2d,-0x92,-0x91)][_0x4a3346(-0x1bd,-0x5c,-0x114,-0x141)]});const _0x144df2=await _0x3cf82f['uHNUz'](getImageFromTurnData,_0x621cf0['user']);if(_0x144df2)_0x1a294e[_0x503808][_0x283a68(0x40f,0x449,0x39c,0x3b8)]['push']({'type':_0x3cf82f[_0x4a3346(-0x94,-0x74,-0xf2,-0xf7)],'image_url':{'url':_0x144df2}});_0x503808++;if(_0x621cf0[_0x283a68(0x459,0x3cb,0x314,0x41f)]?.[_0x4a3346(-0xa6,-0x1c0,-0x114,-0x17a)])_0x1a294e[_0x503808][_0x283a68(0x3dd,0x449,0x432,0x399)][_0x4a3346(-0x1be,-0x194,-0xfd,-0x125)]({'type':_0x3cf82f[_0x283a68(0x4c7,0x466,0x451,0x4f4)],'text':_0x621cf0[_0x4a3346(-0xab,-0xa9,-0x64,0x16)][_0x4a3346(-0x1b3,-0x10e,-0x114,-0x9b)]});const _0xcfe805=await _0x3cf82f[_0x283a68(0x4c3,0x45f,0x4a3,0x47e)](getImageFromTurnData,_0x621cf0[_0x283a68(0x450,0x3cb,0x47d,0x41a)]);if(_0xcfe805)_0x1a294e[_0x503808][_0x4a3346(0x37,0xd2,0x1a,-0x20)]['push']({'type':_0x3cf82f[_0x283a68(0x2b7,0x33d,0x2a4,0x3c8)],'image_url':{'url':_0xcfe805}});_0x503808++;}else _0x3d2b58[_0x57d6ac][_0x283a68(0x488,0x43f,0x451,0x4bb)]['cishu']=0x2*-0x392+0xf84+-0x85f,_0x3cf82f['PudqK'](_0x53df12,'当前生图次数为\x20fo'+_0x4a3346(0xe2,-0x2c,0x45,0x66)+_0x4dde1b[_0x960f03][_0x283a68(0x4f4,0x43f,0x48e,0x3b7)][_0x283a68(0x34a,0x386,0x42d,0x3a5)]);}if(!_0x3cddcf[_0x4a3346(-0xe2,-0x2,-0x53,-0xc6)](_0x3cf82f[_0x283a68(0x291,0x340,0x2a2,0x355)])){if(_0x3cf82f[_0x283a68(0x3ee,0x453,0x4a8,0x41a)]('NdoDc',_0x3cf82f['sDSyF'])){const _0x3ed97d=_0x283a68(0x3ac,0x39f,0x3e4,0x3fc)+_0x4a3346(-0x50,-0x115,-0x105,-0xbb)+'failed\x20for'+_0x283a68(0x400,0x3c2,0x385,0x3cd)+_0x5371ab+':\x20'+_0x34d117[_0x4a3346(-0x122,-0xb7,-0xae,-0x113)];_0x3cf82f[_0x4a3346(-0x18e,-0xf2,-0x119,-0x185)](_0x5dcc56,_0x3ed97d),_0x495690[_0x283a68(0x4aa,0x465,0x3d7,0x422)](_0x3ed97d);const _0x4be202={};_0x4be202['id']=_0xc9685a,_0x4be202[_0x4a3346(-0x97,-0xde,-0x39,0x2f)]=![],_0x4be202['error']=_0x1a1ff4[_0x283a68(0x391,0x381,0x392,0x2c2)],_0x4be202['prompt']=_0x5efcc5,_0xb06138[_0x283a68(0x30c,0x314,0x2ea,0x2eb)](_0x4f0231[_0x283a68(0x3b6,0x3d0,0x360,0x3e1)+'MAGE_RESPO'+_0x4a3346(-0xa0,-0xa2,-0xbe,-0xce)],_0x4be202),_0x37fc3b(_0x4a3346(0x10,-0x51,0x39,-0x7a)+'mitted\x20fai'+'lure\x20respo'+'nse\x20for\x20ID'+':\x20'+_0x543246);}else{const _0x31b242=extension_settings[extensionName][_0x4a3346(-0x160,-0xba,-0xf0,-0x117)+_0x4a3346(-0x10f,-0x68,-0x60,-0x11f)+'ts']||{};for(const _0x2afbf6 in _0x31b242){const _0x133c8c=_0x31b242[_0x2afbf6],_0x534c4f=(_0x133c8c[_0x283a68(0x4a4,0x47a,0x48f,0x449)]||'')['split']('|')[_0x4a3346(-0x65,-0x3,-0xe,-0xb2)](_0x46196a=>_0x46196a[_0x283a68(0x3b7,0x389,0x43d,0x34f)]()!=='');for(const _0x2a6778 of _0x534c4f){if(_0x3cf82f[_0x4a3346(-0x105,-0x142,-0x96,-0x1c)](_0x283a68(0x2b9,0x366,0x3e2,0x304),_0x3cf82f[_0x283a68(0x30b,0x3bd,0x31b,0x378)])){const _0x36cece=new _0x23479a();_0x36cece['onloadend']=()=>_0x59def2(_0x36cece[_0x4a3346(-0x123,-0x1b0,-0x110,-0x143)]),_0x36cece['onerror']=_0x310979,_0x36cece[_0x283a68(0x358,0x357,0x39b,0x3da)+_0x4a3346(0x27,-0x7,0x6,0xa6)](_0x37ef7a);}else{if(_0x5b4a0b['toLowerCas'+'e']()['includes'](_0x2a6778[_0x283a68(0x45f,0x40b,0x444,0x404)+'e']())){_0x3cf82f[_0x283a68(0x368,0x3d4,0x3d9,0x316)](addLog,_0x4a3346(0xa6,-0x7a,0x2,-0xac)+_0x283a68(0x4ba,0x47d,0x3f7,0x499)+_0x4a3346(0x85,0x4a,0xe,0x90)+_0x283a68(0x4b6,0x3f4,0x427,0x4b4)+_0x2a6778+(_0x283a68(0x420,0x3de,0x3b6,0x38a)+_0x4a3346(-0xb9,-0x54,-0x56,-0x7d))+_0x2afbf6+'\x22.');const _0xf0367a=_0x133c8c['conversati'+'on'];if(_0xf0367a){const _0x544c6c=[];if(_0xf0367a[_0x283a68(0x3dd,0x39d,0x310,0x307)]&&_0xf0367a[_0x4a3346(-0x117,-0x1b,-0x92,-0xc)]['text'])_0x544c6c['push']({'type':_0x3cf82f[_0x283a68(0x48a,0x466,0x447,0x4e7)],'text':_0xf0367a[_0x283a68(0x3b3,0x39d,0x39e,0x404)][_0x283a68(0x37f,0x31b,0x3ce,0x2a7)]});const _0x3e8a81=await _0x3cf82f[_0x4a3346(-0xed,-0x88,-0x102,-0x17f)](getImageFromTurnData,_0xf0367a['user']);if(_0x3e8a81)_0x544c6c['push']({'type':_0x3cf82f['nZOVH'],'image_url':{'url':_0x3e8a81}});if(_0x544c6c['length']>-0xaf4+-0x290*0xa+0x2494*0x1){if(_0x3cf82f[_0x283a68(0x32b,0x3a4,0x422,0x3d2)]!==_0x3cf82f[_0x283a68(0x24a,0x30a,0x2cd,0x3bb)]){const _0x41779f={};_0x41779f['role']=_0x3cf82f[_0x283a68(0x348,0x34d,0x2d2,0x403)],_0x41779f[_0x283a68(0x468,0x449,0x3aa,0x509)]=_0x544c6c,_0x1a294e[_0x4a3346(-0xb7,-0x10b,-0xfd,-0xfd)](_0x41779f);}else _0x5ea0b1[_0x283a68(0x383,0x3e1,0x46f,0x44d)+_0x4a3346(-0x9f,-0xc5,-0x3d,0x85)+_0x283a68(0x30a,0x351,0x3e7,0x3d4)]=!![],_0x3cf82f[_0x283a68(0x3e3,0x391,0x306,0x2ea)](_0x32de1f);}const _0x40f628=[];if(_0xf0367a[_0x4a3346(0x2a,-0xd5,-0x64,-0x105)]&&_0xf0367a[_0x4a3346(-0xb8,0x44,-0x64,0x1a)][_0x4a3346(-0x1a4,-0x194,-0x114,-0x195)])_0x40f628['push']({'type':_0x3cf82f[_0x4a3346(-0x27,-0x3a,0x37,0x55)],'text':_0xf0367a[_0x283a68(0x30d,0x3cb,0x389,0x3c7)]['text']});const _0x160e87=await getImageFromTurnData(_0xf0367a[_0x4a3346(-0x50,-0xac,-0x64,-0x9b)]);if(_0x160e87)_0x40f628['push']({'type':_0x283a68(0x43e,0x459,0x4ec,0x432),'image_url':{'url':_0x160e87}});if(_0x3cf82f[_0x4a3346(-0x54,-0x1e,-0x86,-0x13)](_0x40f628[_0x283a68(0x3f5,0x447,0x4cb,0x43d)],-0x209+0x2256+-0x204d)){const _0x18cb3f={};_0x18cb3f[_0x4a3346(-0xbd,-0x16,-0x21,0x2)]=_0x3cf82f[_0x283a68(0x39b,0x39e,0x434,0x3fa)],_0x18cb3f[_0x4a3346(-0x2a,-0x5e,0x1a,0xb3)]=_0x40f628,_0x1a294e[_0x4a3346(-0x181,-0x4d,-0xfd,-0x3f)](_0x18cb3f);}}break;}}}}}}if(!_0x3cddcf[_0x283a68(0x37c,0x3dc,0x403,0x445)](_0x3cf82f[_0x4a3346(-0x112,-0xe1,-0xef,-0x126)])){if(_0x3cf82f['ehTNR'](_0x3cf82f['UAWYF'],_0x3cf82f['LzQPu'])){const _0x136142={};_0x136142[_0x283a68(0x3f3,0x40e,0x45f,0x4c5)]=_0x3cf82f[_0x283a68(0x318,0x34d,0x294,0x2c1)],_0x136142[_0x4a3346(0x36,-0x52,0x1a,-0x86)]=[{'type':_0x3cf82f[_0x283a68(0x416,0x466,0x48f,0x48e)],'text':_0x5b4a0b}],_0x1a294e[_0x283a68(0x279,0x332,0x3c8,0x36f)](_0x136142);}else _0x13250e=_0x4a58a0[_0x283a68(0x39a,0x3d2,0x476,0x46c)](_0x3cf82f[_0x283a68(0x3fe,0x340,0x3b9,0x3c7)],'');}else{if(_0x3cf82f[_0x4a3346(0x11,-0x48,-0xa8,-0x14f)](_0x283a68(0x47d,0x3ed,0x39d,0x33f),_0x283a68(0x3b7,0x36e,0x307,0x360)))_0x3cf82f[_0x4a3346(-0x12a,-0xac,-0x119,-0x171)](_0x529994,_0x3cf82f['ACTPu']);else{const _0x84bca0=[],_0x475356=_0x3cf82f['Lpfsc'](_0x315b60,_0x5b4a0b),_0x5121f8=[_0x1123be[_0x283a68(0x3c8,0x434,0x4e2,0x42d)+'t'],_0x475356,_0x1123be['postfixPro'+_0x4a3346(0x3d,-0x133,-0x80,-0x8e)]]['filter'](Boolean)[_0x4a3346(-0xec,-0xef,-0x11d,-0x198)](',\x20'),_0x4818a5={};_0x4818a5['type']=_0x3cf82f[_0x4a3346(0xe1,0xf9,0x37,0xb1)],_0x4818a5['text']=_0x5121f8,_0x84bca0['push'](_0x4818a5);if(_0x11fff8){if(_0x3cf82f[_0x283a68(0x3de,0x3ee,0x386,0x345)](_0x3cf82f[_0x283a68(0x3d8,0x437,0x3e7,0x461)],_0x3cf82f['koNcd'])){const _0x4eb058={};_0x4eb058[_0x4a3346(-0x27,0x92,-0x21,-0x5d)]=_0x283a68(0x368,0x33c,0x2e8,0x319),_0x4eb058[_0x4a3346(0x37,0x8e,0x1a,0x8)]=_0x19e120,_0x418f77['push'](_0x4eb058);}else{const _0x3a8080={};_0x3a8080[_0x4a3346(-0x3c,-0x5,-0x2f,-0x30)]=_0x11fff8;const _0x2f5e85={};_0x2f5e85[_0x4a3346(-0x1e,0xda,0x42,-0x59)]=_0x3cf82f[_0x283a68(0x2d3,0x33d,0x2f3,0x33b)],_0x2f5e85[_0x283a68(0x3a9,0x459,0x3dd,0x3db)]=_0x3a8080,_0x84bca0[_0x283a68(0x35f,0x332,0x2ff,0x378)](_0x2f5e85),addLog('[Banana]\x20修'+_0x4a3346(0x4b,-0x4d,-0x9,0x5a)+'的图片');}}const _0x938c5e={};_0x938c5e[_0x4a3346(0x53,0x45,-0x21,0x80)]=_0x3cf82f['nzFgY'],_0x938c5e['content']=_0x84bca0,_0x1a294e[_0x283a68(0x3b0,0x332,0x353,0x2c2)](_0x938c5e),addLog('[Banana]\x20修'+_0x4a3346(-0x7a,-0xaa,-0x10b,-0x106)+_0x5121f8);}}const _0x13b1dd={};_0x13b1dd['aspectRati'+'o']=_0x2d30e9;const _0x49bcf6={};_0x49bcf6[_0x283a68(0x2ee,0x317,0x3d0,0x2c6)+'g']=_0x13b1dd,_0x5f08e0={'model':_0x2f427a,'messages':_0x1a294e['filter'](_0x527729=>_0x527729[_0x4a3346(0xa7,0x65,0x1a,0x6)][_0x4a3346(-0x4,-0x47,0x18,0x8e)]>-0x140f+-0x1f*0x121+0x1b*0x20a),'config':_0x49bcf6},addLog(_0x283a68(0x49e,0x467,0x3d7,0x45d)+_0x283a68(0x409,0x430,0x4b4,0x3f7)+'modal\x20payl'+_0x4a3346(0x7,-0xac,-0x55,0x61)+_0x5f08e0['messages'][_0x283a68(0x3a5,0x447,0x440,0x4a7)]+_0x283a68(0x36c,0x3ba,0x3ec,0x445));}else _0x1e8180=!![];}let _0x4da07f=_0x288313['replace'](/\/$/,'');function _0x283a68(_0x2724ef,_0x47d3f0,_0x5f42fd,_0x562968){return _0x45d3(_0x47d3f0-0x258,_0x562968);}let _0x5b48dd;_0x4da07f[_0x4a3346(-0x168,-0x65,-0x107,-0xc9)](_0x3cf82f['SRQbY'])||_0x4da07f[_0x4a3346(0x2d,0x46,-0x53,-0xaf)](_0x3cf82f[_0x4a3346(0x5c,0xa6,0x4f,0x71)])?_0x283a68(0x4c3,0x454,0x3fa,0x4b6)===_0x3cf82f['wTtXa']?_0x5b48dd=_0x4da07f+_0x5269cb:_0x5ee7dc=_0x3cf82f[_0x283a68(0x31a,0x31a,0x2ea,0x28e)](_0x3cf82f[_0x283a68(0x2db,0x31a,0x308,0x364)](_0x446310,',\x20'),_0x515ead[_0x4a3346(-0x1c3,-0xb7,-0x134,-0x1a0)+_0x40f7dd+_0x283a68(0x3ac,0x40d,0x462,0x37f)]):_0x3cf82f[_0x4a3346(-0xc1,-0x40,-0x1a,-0x22)](_0x3cf82f[_0x4a3346(-0xe4,-0x26,-0xce,-0xc3)],_0x3cf82f[_0x4a3346(-0xcb,-0x58,-0xce,-0x107)])?_0x5b48dd=_0x3cf82f[_0x4a3346(0x44,0xdb,0x3d,0x16)](_0x3cf82f[_0x4a3346(0x15,-0x5a,0x35,-0x8d)](_0x4da07f,_0x3cf82f['SRQbY']),_0x5269cb):(_0x3cf82f['tWavN'](_0x49f029,'[Banana]\x20F'+_0x4a3346(-0x5b,0x19,0x1b,0x53)+_0x283a68(0x43e,0x3ec,0x3ec,0x32f)+_0x4a3346(-0x54,-0x7b,0x14,0xb3)+'\x20'+_0x40140d[_0x4a3346(-0x65,-0x71,-0xae,-0x16b)]),_0x5a7c99=_0x37ea59,_0x3cf82f[_0x4a3346(-0xa8,-0xf6,-0x12b,-0x197)](_0x30ff96,_0x3cf82f[_0x4a3346(-0x11e,-0x5e,-0x93,-0x129)]));_0x5b48dd=_0x5b48dd[_0x4a3346(-0x11c,-0x95,-0x67,-0x31)](/\/v1\/v1\//g,_0x3cf82f[_0x4a3346(0x95,0xb6,0x4f,0x13)]);const _0x5036cb=extension_settings[extensionName][_0x4a3346(-0xd4,-0x99,-0xe1,-0x17f)];let _0x3523fe,_0x5711ba,_0x357289;if(_0x3cf82f[_0x283a68(0x344,0x33a,0x37c,0x3f0)](_0x5036cb,_0x283a68(0x401,0x470,0x425,0x44c))){let _0x737701=_0x4da07f;!_0x737701['endsWith'](_0x3cf82f[_0x4a3346(-0x168,-0x52,-0xea,-0xe7)])&&!_0x737701['includes'](_0x3cf82f[_0x4a3346(0x38,-0x36,0x4f,-0x33)])&&(_0x3cf82f['wwLRq'](_0x4a3346(-0xde,-0x95,-0xff,-0x76),_0x3cf82f[_0x283a68(0x3b0,0x30b,0x3cb,0x248)])?(_0x4d0898[_0xbbf3e][_0x283a68(0x3a5,0x43f,0x4c0,0x4bb)][_0x4a3346(-0xa2,-0x124,-0xa9,-0x29)]=_0x3cf82f[_0x4a3346(-0x15d,-0x13c,-0x115,-0x1c0)](_0x1f7e94[_0x2f76f2]['banana'][_0x283a68(0x3a3,0x386,0x320,0x2f0)],-0xfd4+-0x17a1*0x1+0x2776),_0x3cf82f['SyDQq'](_0x41c3a2,_0x283a68(0x45a,0x44f,0x3a6,0x479)+'r\x20prompt:\x20'+_0x33b757[_0x1544b0][_0x4a3346(-0x8e,0x13,0x10,-0x1b)][_0x4a3346(-0x3d,-0x139,-0xa9,-0x82)])):_0x737701=_0x3cf82f[_0x283a68(0x405,0x457,0x3e0,0x497)](_0x737701,_0x3cf82f[_0x4a3346(-0x132,-0xfc,-0xea,-0x8c)]));_0x737701=_0x737701[_0x283a68(0x473,0x3c8,0x460,0x458)](/\/v1\/$/,_0x3cf82f[_0x283a68(0x366,0x345,0x306,0x33f)]),_0x3523fe=_0x3cf82f[_0x4a3346(-0x1b8,-0xea,-0x12e,-0xf3)],_0x5711ba=_0x3cf82f[_0x4a3346(-0x9f,-0x10,0x0,0x36)](getRequestHeaders,window[_0x283a68(0x404,0x40c,0x47f,0x4ae)]);const _0x5c9f71={};_0x5c9f71['chat_compl'+_0x283a68(0x357,0x3d1,0x427,0x361)+'ce']=_0x4a3346(-0xa,-0x20,0x3e,0x7a),_0x5c9f71[_0x283a68(0x261,0x308,0x34b,0x265)]=_0x737701,_0x5c9f71[_0x4a3346(-0xa6,-0xd0,-0xed,-0x7c)+_0x4a3346(0x73,-0x26,0x48,-0x7b)+'rs']=_0x283a68(0x34b,0x322,0x2dc,0x344)+_0x4a3346(-0xff,-0x51,-0x88,-0xdc)+_0x283a68(0x37d,0x30d,0x2f3,0x34f)+_0xf26fdf+'\x22',_0x5c9f71['model']=_0x2f427a,_0x5c9f71['messages']=_0x5f08e0[_0x4a3346(-0xa9,-0x64,-0x6,-0x91)],_0x5c9f71['stream']=![],_0x357289=_0x5c9f71;if(_0x2f427a['startsWith']('imagen')){if(_0x3cf82f[_0x4a3346(0x62,-0x54,0x47,0xac)]!==_0x3cf82f[_0x283a68(0x51a,0x476,0x3d6,0x422)])_0x2f0529[_0x4a3346(-0xc3,-0x83,-0x4e,-0x2f)+'BananaList'+_0x4a3346(-0xcf,-0x9a,-0xde,-0xa3)]&&(_0x29257a[_0x283a68(0x353,0x33b,0x342,0x29d)+'ener'](_0x3d155b[_0x4a3346(-0x1c,0x46,-0x5f,-0x26)+_0x4a3346(0x6b,-0x54,-0x7,0x27)+'ST'],_0x1ef7f4),_0x453ea7['removeList'+_0x283a68(0x3bc,0x351,0x2c6,0x3b6)](_0x3cf82f['sXJAL'],_0x5782f1),_0x4aaf2e[_0x283a68(0x35d,0x3cc,0x3d8,0x415)](_0x211685=>{function _0x5ab30a(_0x334694,_0xe02c5,_0x372bbf,_0x44fe30){return _0x4a3346(_0xe02c5,_0xe02c5-0x1b2,_0x44fe30-0x4c9,_0x44fe30-0x15e);}function _0x141d21(_0x19b936,_0x42a09d,_0x19b848,_0x1ca02e){return _0x283a68(_0x19b936-0xaa,_0x1ca02e- -0x62d,_0x19b848-0x4e,_0x19b848);}_0x5b4ddd[_0x141d21(-0x372,-0x2d7,-0x389,-0x2f2)+_0x141d21(-0x27e,-0x21c,-0x373,-0x2dc)](_0x211685,_0xc5e4db);}),_0x243259['initialize'+'BananaList'+_0x283a68(0x2eb,0x351,0x307,0x2f2)]=![],_0x3cf82f[_0x283a68(0x3b4,0x360,0x3ed,0x398)](_0x106e17,_0x3cf82f[_0x283a68(0x498,0x460,0x4ef,0x438)]));else{_0x3cf82f[_0x4a3346(-0xf5,-0x1e6,-0x123,-0x1c3)](addLog,_0x4a3346(-0x3c,-0x7e,-0x3c,0x25)+_0x283a68(0x422,0x3ef,0x340,0x4ac)+_0x283a68(0x3a5,0x36d,0x34d,0x3d1)+_0x4a3346(-0x29,-0x123,-0x6b,-0x40)),_0x3523fe=_0x5b48dd;const _0x25cf3f={};_0x25cf3f['Content-Ty'+'pe']='applicatio'+_0x283a68(0x385,0x348,0x2e3,0x375),_0x25cf3f['Authorizat'+_0x4a3346(-0x11a,-0x158,-0x116,-0x1a8)]=_0x4a3346(-0xcc,-0x77,-0xe6,-0x52)+_0xf26fdf,_0x5711ba=_0x25cf3f,_0x357289=_0x5f08e0;}}addLog(_0x283a68(0x467,0x3d8,0x3e4,0x431)+_0x4a3346(-0xc1,-0x11b,-0xa4,-0x102));}else{if(_0x3cf82f[_0x283a68(0x386,0x355,0x2ed,0x3d9)](_0x3cf82f[_0x4a3346(-0xb7,0x35,-0x1e,0x7a)],_0x3cf82f['wMJwI'])){_0x3523fe=_0x5b48dd;const _0x41837f={};_0x41837f[_0x4a3346(-0xc0,-0x43,-0x34,-0x50)+'pe']=_0x3cf82f['IgtOz'],_0x41837f[_0x4a3346(-0xab,-0xae,-0x10d,-0x69)+_0x283a68(0x26b,0x319,0x37a,0x318)]=_0x4a3346(-0x176,-0x150,-0xe6,-0x5e)+_0xf26fdf,_0x5711ba=_0x41837f,_0x357289=_0x5f08e0,_0x3cf82f[_0x283a68(0x3f7,0x469,0x4e5,0x4e6)](addLog,_0x4a3346(-0x8e,-0x64,-0x57,-0xe7)+_0x283a68(0x3ec,0x38f,0x41a,0x3ec));}else _0x103e91[_0x4a3346(-0x1e9,-0x1a0,-0x134,-0x1d0)+_0x21b9b6+'\x20Prompt']&&(_0x54288b=_0x3cf82f[_0x283a68(0x448,0x457,0x494,0x437)](_0x3cf82f[_0x4a3346(-0x9d,-0xd,-0xab,-0x3d)](_0x27bbcd,_0x283a68(0x28e,0x346,0x380,0x3f1)),_0x3cf82f[_0x4a3346(0x4f,0x97,0x17,-0x33)](_0x374def,_0x171e86['Character\x20'+_0x4b52c2+'\x20Prompt'])));}_0x3cf82f['xYEmv'](addLog,_0x283a68(0x302,0x37e,0x2e9,0x41d)+_0x4a3346(-0xd3,0x24,-0x44,0x56)+_0x283a68(0x478,0x3fe,0x41e,0x3ac)+_0x3523fe),_0x3cf82f[_0x4a3346(0xd7,-0x80,0x3b,-0x20)](addLog,'[Banana]\x20P'+_0x4a3346(0x94,0x53,-0xd,-0x6d)+JSON[_0x283a68(0x2e4,0x338,0x3aa,0x3fb)](_0x357289,null,0x1251+0x1d*0x143+-0x36e6));try{if(_0x3cf82f['HfQud']!=='aQDJj'){taskQueue['updateStat'+'us'](_0x4fb513,_0x3cf82f[_0x4a3346(-0x9d,-0x67,-0xee,-0x143)]);const _0x417166=await _0x3cf82f[_0x4a3346(-0x9d,-0xfb,-0xdc,-0x192)](fetch,_0x3523fe,{'method':_0x3cf82f[_0x283a68(0x403,0x3e6,0x3d3,0x457)],'headers':_0x5711ba,'body':JSON[_0x4a3346(-0x158,-0xf1,-0xf7,-0x14e)](_0x357289)});if(!_0x417166['ok']){const _0x3bb85f=await _0x417166[_0x283a68(0x3ce,0x31b,0x3d4,0x2d7)]();throw new Error(_0x283a68(0x346,0x337,0x310,0x3d1)+_0x4a3346(-0x4c,0x46,-0x7d,-0xb4)+'ith\x20status'+'\x20'+_0x417166[_0x283a68(0x3ff,0x3d6,0x493,0x394)]+':\x20'+_0x3bb85f);}const _0x35bbb4=await _0x417166[_0x283a68(0x402,0x478,0x4e8,0x3c4)]();let _0x140da9='';const _0x357a00=_0x35bbb4[_0x283a68(0x358,0x38d,0x334,0x3de)];if(_0x357a00&&_0x3cf82f['uRTIW'](_0x357a00['length'],0x22e6+-0x3*0x876+-0x984)){const _0x3727a9=_0x357a00[-0x1865+0x24*0x52+0xcdd][_0x4a3346(-0x14d,-0xb0,-0xae,-0x143)]?.[_0x283a68(0x4a8,0x449,0x42d,0x423)];if(Array['isArray'](_0x3727a9))for(const _0x16e9a6 of _0x3727a9){if(_0x3cf82f[_0x4a3346(0xa9,0x95,0x11,0xd3)]===_0x3cf82f[_0x4a3346(0x45,-0x50,0x50,0xec)]){_0x4598e0=_0x4a04c4;const _0x24796d={};_0x24796d[_0x4a3346(-0x66,0x6d,-0x34,0x7)+'pe']=_0x283a68(0x3ab,0x343,0x2bb,0x2aa)+_0x283a68(0x2b9,0x348,0x28b,0x2b0),_0x24796d[_0x283a68(0x2f0,0x322,0x2e9,0x361)+_0x4a3346(-0xbc,-0xaf,-0x116,-0x1bf)]=_0x283a68(0x37b,0x349,0x2bf,0x393)+_0xcab295,_0x2e3532=_0x24796d,_0x101528=_0x287392,_0x3cf82f['SyDQq'](_0xdf1325,_0x4a3346(-0x3a,-0x10d,-0x57,0x25)+'用直接请求模式');}else{if(_0x3cf82f[_0x4a3346(0x1,-0x167,-0xa7,-0x14)](_0x16e9a6['type'],_0x3cf82f[_0x4a3346(-0xaf,-0xe5,-0xf2,-0x3a)])&&_0x16e9a6[_0x4a3346(-0x13,-0x68,0x2a,0x5a)]?.[_0x283a68(0x4bc,0x400,0x453,0x463)]){_0x140da9=_0x16e9a6[_0x283a68(0x45b,0x459,0x3e7,0x421)][_0x4a3346(-0xee,0x72,-0x2f,-0xce)];break;}}}else{if(_0x3cf82f[_0x283a68(0x313,0x354,0x2f8,0x2d8)](typeof _0x3727a9,_0x3cf82f[_0x283a68(0x316,0x380,0x3f1,0x351)])){if(_0x3cf82f[_0x283a68(0x3ca,0x34f,0x3d1,0x3e6)](_0x3cf82f[_0x283a68(0x327,0x2fd,0x388,0x2ee)],_0x4a3346(-0x49,0x17,-0x7b,0x13))){_0x4f8ba8(_0x283a68(0x3a2,0x3f3,0x39c,0x394)+'magen\x20模型不支'+_0x283a68(0x3d6,0x36d,0x368,0x2e5)+'接请求'),_0x205adc=_0x44a943;const _0x3e0d00={};_0x3e0d00[_0x283a68(0x351,0x3fb,0x472,0x4a7)+'pe']=_0x3cf82f[_0x283a68(0x417,0x3a1,0x3e1,0x2ed)],_0x3e0d00[_0x4a3346(-0x194,-0x11e,-0x10d,-0x16e)+_0x4a3346(-0x148,-0x1b1,-0x116,-0xac)]=_0x4a3346(-0xcf,-0x12b,-0xe6,-0x156)+_0x1c2361,_0x47b784=_0x3e0d00,_0x115236=_0x4ccd1b;}else{const _0x38108f=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x20cefe=_0x3727a9[_0x4a3346(0x73,-0x52,-0x48,0x1)](_0x38108f);if(_0x20cefe&&_0x20cefe[0x15aa+0x4c*-0x32+-0x6d1]){_0x3cf82f[_0x283a68(0x39e,0x30c,0x34a,0x2fc)](addLog,_0x3cf82f[_0x4a3346(-0x62,-0x125,-0x70,-0x8d)]);const _0x212b75=_0x20cefe[-0x1ab+0x2c4*-0x5+0xf80];addLog(_0x4a3346(-0x171,-0xa7,-0xba,-0xb0)+_0x283a68(0x387,0x423,0x3a9,0x3f5)+_0x4a3346(-0xd7,-0xe1,-0x61,-0xe2)+_0x212b75);try{const _0x2f4505=await _0x3cf82f[_0x283a68(0x4f4,0x45f,0x4f1,0x480)](fetch,_0x212b75);if(!_0x2f4505['ok'])throw new Error(_0x283a68(0x49b,0x3fc,0x3ff,0x47a)+_0x4a3346(-0x38,-0x37,-0x99,-0x15c)+_0x4a3346(-0x10b,-0x67,-0x104,-0x157)+_0x2f4505[_0x283a68(0x3df,0x3d6,0x3f9,0x33a)]);const _0x3d1d44=await _0x2f4505[_0x4a3346(-0x45,0x75,0x3f,-0x3f)](),_0x2dc1d3=await new Promise((_0x149367,_0x411732)=>{function _0x1d44bf(_0x550fb6,_0x687fa1,_0x28c91d,_0x472726){return _0x4a3346(_0x550fb6,_0x687fa1-0x87,_0x28c91d-0x2d4,_0x472726-0x137);}const _0x11fd3e={'aeTNW':function(_0x20a18e,_0x5ec1ac){return _0x3cf82f['xYEmv'](_0x20a18e,_0x5ec1ac);}};function _0x632d90(_0x2beed8,_0x25dfc3,_0x3c8758,_0x594d77){return _0x4a3346(_0x2beed8,_0x25dfc3-0x153,_0x594d77-0x350,_0x594d77-0x1ea);}if(_0x3cf82f[_0x1d44bf(0x1cc,0x112,0x1bd,0x251)](_0x3cf82f['xQVUu'],_0x1d44bf(0x385,0x30d,0x2c3,0x2c1))){const _0x13f133=new FileReader();_0x13f133['onloadend']=()=>_0x149367(_0x13f133[_0x632d90(0x2da,0x18c,0x1b1,0x240)]),_0x13f133[_0x1d44bf(0x1b2,0x23b,0x25c,0x1c4)]=_0x411732,_0x13f133['readAsData'+_0x1d44bf(0x314,0x368,0x2da,0x273)](_0x3d1d44);}else _0x11fd3e[_0x632d90(0x2c3,0x3a9,0x362,0x36c)](_0x5ae8b2,'缓存设置为不存入数据'+'库');});_0x140da9=_0x2dc1d3,_0x3cf82f[_0x283a68(0x46f,0x42e,0x3d4,0x4b3)](addLog,_0x3cf82f['sppFb']);}catch(_0x3d7e90){_0x3cf82f[_0x283a68(0x367,0x3d4,0x343,0x486)](addLog,'[Banana]\x20F'+_0x4a3346(0x88,-0xd,0x1b,0x34)+_0x283a68(0x35d,0x3ec,0x466,0x37f)+_0x283a68(0x417,0x443,0x467,0x4b2)+'\x20'+_0x3d7e90[_0x283a68(0x359,0x381,0x3ff,0x3c9)]),_0x140da9=_0x212b75,_0x3cf82f['DfoWp'](addLog,_0x3cf82f[_0x283a68(0x414,0x39c,0x442,0x42a)]);}}else addLog(_0x3cf82f[_0x283a68(0x3a1,0x462,0x3c0,0x524)]);}}}}if(!_0x140da9){if(_0x3cf82f[_0x283a68(0x3a9,0x40f,0x3c3,0x431)]===_0x283a68(0x383,0x370,0x36f,0x2d5)){const _0x5bcb2c=_0x29504e['apply'](_0x4e15e0,arguments);return _0x5396ad=null,_0x5bcb2c;}else throw new Error(_0x3cf82f['njZqQ']);}_0x3cf82f[_0x4a3346(-0xd0,-0xc1,-0x19,-0x84)](addLog,_0x3cf82f[_0x4a3346(-0x62,-0x88,-0x108,-0xeb)]),taskQueue[_0x4a3346(0x70,0x76,0x34,0xdf)+'sk'](_0x4fb513,!![]),currentTaskId=null;const _0x12fe8a={};return _0x12fe8a[_0x283a68(0x403,0x3fd,0x3ef,0x3fa)]=_0x140da9,_0x12fe8a['change']=_0x1984ca||'',_0x12fe8a;}else _0x2f038f=_0x3cf82f[_0x283a68(0x461,0x457,0x497,0x3aa)](_0x5b24db,_0x3cf82f[_0x283a68(0x33f,0x345,0x3a0,0x282)])+_0x185a95;}catch(_0x329ac6){_0x3cf82f[_0x4a3346(0x23,0x21,-0x54,0x34)](addLog,_0x283a68(0x4ef,0x431,0x46d,0x4c3)+_0x4a3346(0x11,0x8a,0x19,-0x25)+':\x20'+_0x329ac6[_0x283a68(0x37f,0x381,0x2f3,0x42b)]),console[_0x283a68(0x3dc,0x465,0x4eb,0x4d6)](_0x3cf82f[_0x283a68(0x367,0x37b,0x430,0x2c7)],_0x329ac6);if(_0x329ac6[_0x283a68(0x386,0x381,0x3cc,0x43e)]===_0x3cf82f['fCmQG']){}else taskQueue[_0x283a68(0x4e3,0x463,0x3c7,0x3b9)+'sk'](_0x4fb513,![]);currentTaskId=null;throw _0x329ac6;}}function _0xcbbd(){const _0x2b0ac5=['EfLfBxy','zxiG','BffcwM4','B21WBgv0Aw9UCW','CNvUBMLUzW','AuLIAxy','AM9PBG','r25ArMy','zw1PDa','zxrLy3rLzcbnyq','BLfSveu','Aw1Hz2vdB25MAq','CejArNu','Aw9U','wgLowhm','Dgv4Da','C3rYAw5N','DwnJzxnZzNvSBa','igLTywDLihrVia','CMvZDwX0','BhvYzsbYzxnWBW','y09Xs2y','qxv0Ag9YAxPHDa','q3LTrKy','5zU+5QIH5BYp77YA5OYh5lUKid0G','5yMn572U5zco','BwL0DgvKigzHAq','v3fmzMK','zw5KC1DPDgG','ywrKvgfZAW','zw5LCMf0Aw9Uia','ztOG','Du5Wsui','EgvqsLG','r1nvyLy','qMfUyw5H5l+U5zU+5QIH5BYp','swrREg0','zuXKEMS','ChvZAa','mtfvEvnZsuO','A1PssK4','55sO5lQo55sF5OIq55QevgfNoIa','zxnWB25ZzsbJBW','qvbjihjLCxvLCW','C3rYAw5NAwz5','CNHJqu0','vMvuzfG','CMvTB3zLtgLZDa','yxnZAxn0yw50','BLPpvKG','5lU75yQH5BEY5y+w5RAi','yMfUyw5Hq2HHCG','CLroBMq','y1bTCfG','y3vZDg9Tx2LUyW','yxbWBgLJyxrPBW','BMX5EKG','u1jryLK','ihWG','vM5zsxC','BI9QC29U','qMvHCMvYia','yLjMufa','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','ChjVBxb0','BNPgz1K','y2XPzw50','B3vPqwy','DgLVBIbYzxf1zq','zw5LCG','yLn3ugy','rhDJCgm','rgXNuMS','svjUwLq','mZmZmdy4mhDkv2HlBa','CMvHzefZrgf0yq','BwfNzsbPBIbpCa','CfjXwfu','rgvvC2y','whDlAgu','sxHkt0m','5Q2J6z2I5O+q56s66k+noIa','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','odaZndG1nK1KqwzJvq','tM5yA0S','C3zmsei','ChnjENK','tgrvyKC','ue9tva','w0jHBMfUyv0G5y+w','Cw1jBee','rhjJAMm','wxnJwgS','uvbwCKG','mty4mdK4BLLAqxjR','rhjQBNy','zYbvuKWUlI4','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','A3PLrNC','CMr6B1e','v25VDKW','tLnf','C3rHCNrZv2L0Aa','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','DcbvuKWGyxmGzG','w0jHBMfUyv0Gtq','5zco572U5zco','y2zNAw1NxW','w0jHBMfUyv0GuG','w0jHBMfUyv0G5l+U','C2fTCgXLq291BG','D1Loy2K','C2uGzgLKig5VDa','ExfMqvC','w0jHBMfUyv0GuW','Aw1Hz2vjza','Ew5Mu0W','BwvZC2fNzq','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','C2LUzYbKAxjLyW','sfH6txC','CKffDge','y2LZAhu','veriALu','CgTOugG','DhjPBq','y2Hfu2u','55sO6yws6AAg5lUJ55cg5QIH5BYp','rKnozwi','y2HVAwnLCW','qvDICxC','55sO55U05O6L6k+35Rgc5QIH5BYp','ywDLigDLBMvYyq','sgzjCLa','zwnLAxzLzcbPBq','mJu4EKTACNb6','DcbVBMX5lcbUBW','C3bSAxq','zMv0y2GGAw1HzW','mNWWFdr8m3WX','uKvithy','uM1KqKu','DfDHDK4','qwHQv00','qwHtzNa','DxnLCG','AMvksKy','w0jHBMfUyv0GrW','55Qe5zU+54Mh','swD0t3O','kcGOlISPkYKRkq','yMfUyw5HioEuN+wBVUs6IW','AfrqBKG','uhf3r2W','sw1xyKG','Aw9UoIaIqMvHCG','mteZmJGWnZbSCxD2yKC','DvjusvC','w0jHBMfUyv0G5zcV','seDkENu','yxrLzcbZDwnJzq','tufhrv9srvnqtW','swL4Ege','Bxb0','vKPqD2W','DgfYDgLUzYbPBq','DcbMywLSzwqGDW','zwHutLi','DKnPCem','ug1RBKW','otCZmda4u2z1svHX','B25LCNjVCG','DgLVBIb3AxrOia','zgf0ytPPBwfNzq','ig1LC3nHz2vZlG','r1HzseW','q2LvzwS','B2TdEhG','ALjssuG','zNnIq1C','ENjlC00','CNnxEhG','ieLeia','l3yXyMv0ys9TBW','5O6L6k+35Rgc','l2DLBMvYyxrL','yxnRsuq6ia','BhPZqwu','CMvWBgfJzq','wujyBgm','owXmANzftG','Bw9KzwW','zM9YrwfJAa','AhjRtu4','ywDLifvstdOG','ywn0zxjqCMvZzq','r0vorvjbvevFsq','zxrPB25FC291CG','CMvWBgfJzufSBa','ugn2DKS','AKTHD2m','q0f1qvy','C3rHDhvZ','A01Ru2K','w0jHBMfUyv0G5l2/','C2v0ici','B2fKihDPDgGG','wxvzz3C','Aw5JBhvKzxm','5l+U5zU+5OYh5lUKoIa','iIbMCM9TihbYzq','Aw5ZDgfUy2vZ','DLDqu2u','Aw5PDgLHBgL6zq','y2HHBMDL','5PYa5zco572U','w0jHBMfUyv0G55sF','mtqXnJe1oenbuMnNva','weztzwC','Bwf0y2G','CgLZCvi','yxnWzwn0uMf0Aq','C2vHCMnO','zw5KAw5NihjLCq','zxrJAcbnyxjRza','A0nwz20','ueDftMO','BwfNzw4G5QIH5z6l5lIn5PsV','yxbWBhK','ywXSyMfJAY4','qMfUyw5HtgLZDa','w0jHBMfUyv0Gsq','CIaI','5lIT55QeihbYB21WDooaGG','C3vJy2vZCW','y29UC3rYDwn0BW','55sO5lQgihVKV67LM759ioAGH+IVHG','l3yXlW','nJyYmJrdvvjnqMu','q29UDgvUDc1uEq','rMfPBgvKihrVia','Aw1Hz2u','DwvZDcb0BZOG','y2vZCYbYzxnWBW','DxjS','BwfNzsbNzw5LCG','y2f4ywy','EwDfqNG','CgfYyw1LDgvYCW','yunQwKO','zcbnyxjRzg93BG','wNvNre4','q1LPsfm','D2L0AcbWCM9TCa','vwv2yLm','Dg9mB3DLCKnHCW','Dg9Rzw4','ifbYB21WDa','CM9Szq','wLfnzM4','zffTq0O','D01kD0K','C3nMDwXSEs4','E+s/RUwBVN0','C2HJt0i','ruLyruy','v3bWC1C','C3rFy2HHDhu4xW','EsbJB252zxj0zq','w0jHBMfUyv0G5Ps2','BNnLigzVCIbjra','Dg9tDhjPBMC','yw5Hx3rHC2S','mtuZuxfjqxPR','vuPeu20','BNrHAw5ZihrLEa','EffQDw0','zMLSDgvY','yxLSB2fKoIa','yxjRzg93BIbPBq','w0jHBMfUyv0Gvq','DhzvDxO','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','BgvZktOG','tufhrv9srvfvrq','BwvZC2fNzxm','zMXHDa','uNbRz0K','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','Cg9ZDgzPEfbYBW','CNvfCMS','CKzhBha','DwLSDcbTDwX0Aq','w0jHBMfUyv0GrG','AgH4sgW','ChDvDg8','zML4zwrqCM9TCa','vvjm','DdOG','s1LgAuW','y29UDMvYC2f0Aq','5zon5BQuicHjrdOG','B3nPDgLVBG','z3fHs08','u3Leuxe','Aw5NihrYAwDNzq','l3yX','yMfUyw5H','qNHUqNO','yujurwW','zw5bssbMB3jTyq','B3DUigLTywDLoG','l3yXl2nOyxqVyW','BvbOqM4','uhvKCuS','BgvUz3rO','zxrJAcbLCNjVCG','y29UDgvUDa','ywLSzwqGDg8GzG','ywvutLC','kerPDMLKzv9YBW','BxvSu0W','y2fJAgu','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','EezgEeS','wwrYq3u','mNWWFdf8nhWZ','vxfry3i','BfDXyNq','y2fUy2vSx2jHBG','5zco572U5yMn','D1rIB3e','l2fWAs9IywnRzq','Aw1Hz2vFDxjS','qKfoqu5b','z3D2vwC','tg90t0u','tNvlrwC','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','y2visvK','EMvnyNK','v2DpBxO','qunuuhu','y29TCgXLDgvuyq','C3rcwhe','zxjYB3i','DKHIAxm','w0jHBMfUyv0GqG','w0jHBMfUyv0Grq','vhj6D0S','qwDuqLC','yNPcAuW','DNHou2e','y3vZDg9T','yMXVyG','z2uGzM9YBwf0la','AML1z3vHBG','DhLWzq','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','lcdPQ5JLUQyGlsa','CIbWCM9TChq6ia','De5Mreu','qMLuEwm','BhvKzv9OzwfKzq','ANnVBG','q1jMqwS','DhjPz2DLCNm','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','vKztCKu','B3vUzcbTyxrJAa','uxLmD04','txzywKy','zNbtAKW','q2HHCMfJDgvYia','tMrVrgm','q0r0z2W','CMTKB3DUigLTyq','sgHzu3O','EvHKqvO','z1fHCwC','yK9JuLK','q01JEwm','A0n3zMO','qvbjihjLC3bVBG','AhP3DM8','weH2EeS','y3vZDg9Tx3vYBa','y0jkDvq','rgnAtLC','C0PXEeO'];_0xcbbd=function(){return _0x2b0ac5;};return _0xcbbd();}export async function bananaGenerate(_0x2bc82d){const _0x137104={'tNfDE':function(_0x5b7417,_0x40237e){return _0x5b7417===_0x40237e;},'ybQHa':_0x3a3798(0x38a,0x3c1,0x43a,0x30d),'LdUbG':function(_0x6a85a,_0x2ffd39){return _0x6a85a||_0x2ffd39;},'gwvUg':function(_0x20ee9a,_0x794315){return _0x20ee9a(_0x794315);},'mPhBn':function(_0x59a5a9,_0x41ab0f){return _0x59a5a9(_0x41ab0f);},'CYiHS':_0x3a3798(0x41b,0x43d,0x445,0x3cc),'aCjZJ':function(_0x3ca67a,_0x5e9cd1){return _0x3ca67a!==_0x5e9cd1;},'xFFxK':_0x3a3798(0x36e,0x34d,0x33a,0x313),'HVvRn':_0x3a3798(0x49a,0x42c,0x42c,0x482),'WgOmz':function(_0x214657,_0x350b8a){return _0x214657!=_0x350b8a;},'bSwPf':function(_0x16b197,_0x1c8013,_0xfc0ef7,_0x344b54){return _0x16b197(_0x1c8013,_0xfc0ef7,_0x344b54);},'uNpIB':function(_0xfe1a5a,_0x51f471){return _0xfe1a5a(_0x51f471);},'psIzy':function(_0x3d5ced,_0x3a0972){return _0x3d5ced(_0x3a0972);}};function _0x5e2bc4(_0x436515,_0x5609fc,_0xadb062,_0x3226cb){return _0x45d3(_0x3226cb- -0x2ff,_0x436515);}clearLog();let {id:_0x26468e,prompt:_0x4716a0,width:_0x1621ee,height:_0x1eac5e,change:_0x461b36,retouchPrompt:_0x4fe7ef,retouchImage:_0x516534}=_0x2bc82d;function _0x3a3798(_0x14ee03,_0x171a72,_0x15f503,_0x5ead8a){return _0x45d3(_0x171a72-0x282,_0x14ee03);}currentRequestId=_0x26468e,currentPrompt=_0x4716a0,_0x137104[_0x5e2bc4(-0x1af,-0x54,-0x18b,-0x112)](addLog,_0x3a3798(0x312,0x3a2,0x3d8,0x3e2)+_0x5e2bc4(-0x1ad,-0x120,-0x10e,-0x1c5)+'age\x20genera'+_0x3a3798(0x2e0,0x37a,0x33d,0x3ea)+'st\x20(ID:\x20'+_0x26468e+')');let _0x5cd10f='';if(_0x461b36)_0x5cd10f=_0x461b36[_0x5e2bc4(-0xe7,-0x1b1,-0x114,-0x185)](_0x137104[_0x5e2bc4(-0x113,-0xf7,-0xa7,-0x14f)],'');else{if(_0x137104[_0x5e2bc4(-0x124,-0xb7,-0x141,-0x152)](_0x137104[_0x5e2bc4(-0x91,-0x65,-0x1b6,-0x107)],_0x137104['HVvRn']))_0x5cd10f=_0x4716a0;else{const {taskId:_0x1a7007}=_0x42b40a;_0x42279b(_0x5e2bc4(-0x128,-0x107,-0x120,-0x13e)+'到取消任务事件\x20(T'+_0x5e2bc4(-0x118,-0x100,-0x131,-0x191)+_0x1a7007+')');if(_0x137104[_0x5e2bc4(-0x87,-0x170,-0xe3,-0xe2)](_0x912153,_0x1a7007)&&_0x58d5ed){const _0x26f6ac=_0x137104['ybQHa']['split']('|');let _0x38fd32=0x19cb+-0x20b1+-0x1*-0x6e6;while(!![]){switch(_0x26f6ac[_0x38fd32++]){case'0':_0x2586ef[_0x3a3798(0x2da,0x33e,0x2ff,0x2c5)](_0x2779bd[_0x3a3798(0x46d,0x3fa,0x45e,0x3f6)+'MAGE_RESPO'+_0x5e2bc4(-0x198,-0x1b5,-0x162,-0x1e6)],{'id':_0x390674,'success':![],'error':_0x3a3798(0x402,0x368,0x3f4,0x3c5),'prompt':_0x137104[_0x5e2bc4(-0x251,-0x261,-0x1c3,-0x1f4)](_0x34f4a3,'')});continue;case'1':_0x1ae6b4=null;continue;case'2':_0x137104['gwvUg'](_0x5ad159,'[Banana]\x20取'+'消当前任务，发送失败'+_0x5e2bc4(-0xae,-0x187,-0x1c8,-0x11e)+_0xae70dd+')');continue;case'3':_0x5c9d90=null;continue;case'4':_0x36f752=null;continue;}break;}}}}if(_0x461b36&&_0x461b36[_0x5e2bc4(-0x1c1,-0x1f1,-0x18d,-0x17b)](_0x137104['CYiHS'])){_0x137104[_0x5e2bc4(-0x191,-0x17e,-0xde,-0xfc)](addLog,_0x5e2bc4(-0x1b3,-0x245,-0x1f9,-0x228)+'启动');if(_0x4fe7ef)addLog(_0x3a3798(0x48c,0x407,0x35f,0x379)+_0x4fe7ef);if(_0x516534)addLog(_0x5e2bc4(-0x187,-0x5d,-0x117,-0xf9)+']');}try{const {image:_0xfc6296,change:_0x182dc9}=await _0x137104['gwvUg'](generateBananaImage,{'prompt':_0x4716a0,'width':_0x1621ee,'height':_0x1eac5e,'change':_0x461b36,'retouchPrompt':_0x4fe7ef,'retouchImage':_0x516534});if(_0x137104[_0x5e2bc4(-0x60,-0x194,-0x19e,-0xf6)](extension_settings[extensionName][_0x3a3798(0x4a7,0x478,0x4ca,0x4e1)],'0')){const _0x219f06={};_0x219f06['change']=_0x5cd10f,await _0x137104[_0x5e2bc4(-0x28f,-0x1e6,-0x172,-0x205)](setItemImg,_0x4716a0,_0xfc6296,_0x219f06),_0x137104[_0x5e2bc4(-0x1ab,-0x29f,-0x2b5,-0x22b)](addLog,_0x5e2bc4(-0x125,-0x189,-0x166,-0x1d5)+'or\x20prompt:'+'\x20'+_0x4716a0),extension_settings[extensionName]['banana'][_0x5e2bc4(-0x1cd,-0x180,-0x115,-0x1d1)]?(extension_settings[extensionName][_0x3a3798(0x42a,0x469,0x3b7,0x3b3)][_0x3a3798(0x35a,0x3b0,0x3ef,0x3c7)]=extension_settings[extensionName][_0x3a3798(0x3d1,0x469,0x40e,0x51a)][_0x5e2bc4(-0x234,-0x191,-0x222,-0x1d1)]+(0x226f+-0x2*0x1048+-0x1de*0x1),addLog(_0x5e2bc4(-0x19a,-0x117,-0x11d,-0x108)+_0x5e2bc4(-0x133,-0x162,-0x7a,-0xe3)+extension_settings[extensionName][_0x5e2bc4(-0x1ca,-0x1c2,-0x107,-0x118)][_0x3a3798(0x30d,0x3b0,0x3a1,0x399)])):(extension_settings[extensionName][_0x3a3798(0x438,0x469,0x3c1,0x4b4)][_0x3a3798(0x38c,0x3b0,0x3c4,0x469)]=-0x70+-0x228*0x1+0x1*0x299,addLog(_0x3a3798(0x528,0x479,0x44e,0x48d)+_0x5e2bc4(-0xc3,-0x28,-0x1a3,-0xe3)+extension_settings[extensionName][_0x3a3798(0x3ea,0x469,0x40c,0x423)][_0x3a3798(0x3e3,0x3b0,0x417,0x350)]));}else _0x137104[_0x3a3798(0x40d,0x485,0x4ee,0x453)](addLog,'缓存设置为不存入数据'+'库');const _0x2a4685={};_0x2a4685['id']=_0x26468e,_0x2a4685['success']=!![],_0x2a4685['imageData']=_0xfc6296,_0x2a4685[_0x3a3798(0x382,0x376,0x437,0x2b8)]=_0x4716a0,_0x2a4685[_0x5e2bc4(-0xb3,-0x143,-0x11d,-0x175)]=_0x5cd10f,eventSource['emit'](EventType[_0x5e2bc4(-0x135,-0x194,-0xcd,-0x187)+_0x5e2bc4(-0x15a,-0x252,-0x178,-0x1aa)+_0x5e2bc4(-0x156,-0x1ee,-0x1e5,-0x1e6)],_0x2a4685),_0x137104[_0x5e2bc4(-0x2a5,-0x20f,-0x1fa,-0x22b)](addLog,'[Banana]\x20E'+'mitted\x20suc'+_0x3a3798(0x3de,0x429,0x3c9,0x4bb)+_0x5e2bc4(-0x105,-0x95,-0x7c,-0x13d)+':\x20'+_0x26468e);}catch(_0xf2e09b){const _0x8fed5c=_0x3a3798(0x3ae,0x3c9,0x41b,0x332)+'eneration\x20'+'failed\x20for'+_0x5e2bc4(-0x1a2,-0x247,-0x234,-0x195)+_0x26468e+':\x20'+_0xf2e09b[_0x5e2bc4(-0x13d,-0x228,-0x1d5,-0x1d6)];_0x137104[_0x3a3798(0x3f1,0x38c,0x31c,0x414)](addLog,_0x8fed5c),console['error'](_0x8fed5c);const _0x215145={};_0x215145['id']=_0x26468e,_0x215145[_0x5e2bc4(-0x1b7,-0x1b1,-0xde,-0x161)]=![],_0x215145['error']=_0xf2e09b['message'],_0x215145[_0x5e2bc4(-0x1a2,-0x183,-0x159,-0x20b)]=_0x4716a0,eventSource[_0x5e2bc4(-0x277,-0x25b,-0x18a,-0x243)](EventType[_0x3a3798(0x4b4,0x3fa,0x3b4,0x45a)+_0x5e2bc4(-0x15e,-0x23a,-0xff,-0x1aa)+'NSE'],_0x215145),_0x137104[_0x5e2bc4(-0x250,-0x206,-0x24a,-0x22b)](addLog,_0x5e2bc4(-0x1a8,-0x1a4,-0x103,-0xef)+_0x5e2bc4(-0x25b,-0x2bf,-0x267,-0x231)+_0x3a3798(0x34e,0x34a,0x3af,0x3c2)+_0x5e2bc4(-0x1da,-0x1fa,-0x110,-0x13d)+':\x20'+_0x26468e);}}function handleCancelBananaTask(_0x1dd2a5){const _0x5ea3d6={'UevbS':function(_0x4ff94a,_0x1bb6f2){return _0x4ff94a(_0x1bb6f2);},'cBJuT':function(_0x3d6970,_0xdb2989){return _0x3d6970(_0xdb2989);},'RpkgI':function(_0x4c68e1,_0x529be3){return _0x4c68e1===_0x529be3;},'QPVrH':function(_0xa1b23e,_0x222a07){return _0xa1b23e(_0x222a07);},'LotOE':_0x433d56(0x3e,0x5e,0x13,0x27)};function _0x36f0d2(_0x2dc5e0,_0x1727db,_0x5488bf,_0x18ee2d){return _0x45d3(_0x1727db- -0x32c,_0x5488bf);}function _0x433d56(_0x33b761,_0x391d62,_0x3ff662,_0x20301a){return _0x45d3(_0x20301a- -0xbf,_0x33b761);}const {taskId:_0x54aafc}=_0x1dd2a5;_0x5ea3d6[_0x36f0d2(-0x322,-0x27b,-0x203,-0x253)](addLog,'[Banana]\x20收'+'到取消任务事件\x20(T'+_0x433d56(0x106,0xaf,0x90,0xaf)+_0x54aafc+')');if(_0x5ea3d6[_0x36f0d2(-0x15a,-0x159,-0xc1,-0x1ca)](currentTaskId,_0x54aafc)&&currentRequestId){if(_0x36f0d2(-0x139,-0x181,-0x1a3,-0x1f4)!==_0x36f0d2(-0x154,-0x1de,-0x251,-0x138)){_0x5ea3d6[_0x433d56(0x32,0xa5,-0x58,0x52)](addLog,_0x433d56(0x10c,0x5c,0xc9,0x4e)+'消当前任务，发送失败'+_0x36f0d2(-0x15d,-0x14b,-0x209,-0x16c)+currentRequestId+')');const _0x2ce783={};_0x2ce783['id']=currentRequestId,_0x2ce783[_0x433d56(0xa4,0x109,0x125,0xdf)]=![],_0x2ce783[_0x433d56(0xd8,0x102,0xf1,0x14e)]=_0x5ea3d6[_0x36f0d2(-0xad,-0x128,-0xb4,-0x1a2)],_0x2ce783[_0x433d56(0xd3,0x4d,0x40,0x35)]=currentPrompt||'',eventSource['emit'](EventType[_0x36f0d2(-0x101,-0x1b4,-0x1fd,-0x181)+_0x36f0d2(-0x147,-0x1d7,-0x1ff,-0x258)+'NSE'],_0x2ce783),currentTaskId=null,currentRequestId=null,currentPrompt=null;}else{const _0x2f7db2={};_0x2f7db2[_0x433d56(0x109,0x18f,0x57,0xe9)]=_0x4a6d85;const _0xb9f17c={};_0xb9f17c[_0x433d56(0x15d,0x158,0x141,0x15a)]=_0x36f0d2(-0x1e2,-0x12b,-0x7f,-0x10d),_0xb9f17c[_0x36f0d2(-0xde,-0x12b,-0x181,-0x1aa)]=_0x2f7db2,_0x318493[_0x433d56(0x2,0xc0,-0x42,0x1b)](_0xb9f17c),_0x5ea3d6[_0x433d56(0x90,0x4a,0x15b,0xf3)](_0x174246,_0x36f0d2(-0x2be,-0x20b,-0x1a3,-0x212)+_0x36f0d2(-0xba,-0x15e,-0x1da,-0xbd)+_0x36f0d2(-0x1c8,-0x1e4,-0x25b,-0x1ee));}}}function initializeBananaListener(){function _0x1f8e8b(_0x28bbea,_0x489401,_0x29702d,_0x4c66fe){return _0x45d3(_0x29702d- -0x3d,_0x489401);}const _0x140481={'kvNer':_0x1f8e8b(0x198,0x1a5,0x182,0x135)+_0x1f8e8b(0x150,0x1c2,0x1c0,0xfe)+'ana_task','kMkSi':function(_0x1f8ca7,_0x369889){return _0x1f8ca7(_0x369889);}};eventSource['on'](EventType[_0x1f8e8b(0x144,0xe0,0x13b,0x103)+_0x1f8e8b(0x1d9,0xd4,0x193,0x19f)+'ST'],bananaGenerate),eventSource['on'](_0x140481['kvNer'],handleCancelBananaTask);function _0x259185(_0x14c638,_0x423cfd,_0x456b4e,_0x39833b){return _0x45d3(_0x456b4e- -0xfb,_0x14c638);}_0x140481[_0x1f8e8b(0x1ad,0x102,0x142,0x85)](addLog,_0x259185(-0x6a,0x111,0x50,-0x16)+_0x259185(0x8c,0x40,0xd9,0x87));}export async function replaceWithBanana(){function _0xa99a7c(_0x3cf5ff,_0x569c7d,_0x3bf952,_0x344622){return _0x45d3(_0x344622- -0x191,_0x569c7d);}const _0xa2d6f={'yXdAZ':_0x5c300f(0x1bc,0x25f,0x1a6,0x1b1),'bOcRY':function(_0x4cbc26){return _0x4cbc26();},'dhrMx':_0xa99a7c(0x9d,0x31,-0x48,0x69),'rxcAM':'st_chatu8_'+_0xa99a7c(0xf6,0xd1,0x1f,0x6c)+'ana_task','OLCea':'[Banana]\x20生'+_0xa99a7c(-0xe8,-0xb1,-0xbd,-0x8b)};function _0x5c300f(_0x2e3c2b,_0x53ce95,_0x1efc99,_0xe95bd6){return _0x45d3(_0x2e3c2b- -0x2b,_0x1efc99);}if(extension_settings[extensionName]['mode']==_0xa2d6f[_0xa99a7c(-0xd8,-0xe0,-0x18e,-0xe9)])!window[_0x5c300f(0x15e,0xe2,0x122,0x19f)+_0xa99a7c(0xb2,0x32,-0x37,0x9)+_0xa99a7c(-0x9b,-0x12c,-0x110,-0x98)]&&(window[_0x5c300f(0x15e,0x14c,0x1b1,0x1b3)+'BananaList'+_0x5c300f(0xce,0x115,0xc6,0xfb)]=!![],_0xa2d6f[_0x5c300f(0x7f,0x41,0x54,0xc2)](initializeBananaListener)),_0xa2d6f[_0x5c300f(0x7f,0xc3,-0x14,0x4a)](initializeImageProcessing);else{if(window[_0x5c300f(0x15e,0x1ae,0x118,0x1e6)+_0x5c300f(0x16f,0x10c,0x183,0x1a4)+_0xa99a7c(-0x10,-0x6a,-0x140,-0x98)]){const _0x2015d9=_0xa2d6f['dhrMx'][_0xa99a7c(0x47,0xd,-0xb4,-0x54)]('|');let _0xf009d3=0x1*0xbf+-0x62*0x29+-0x1*-0xef3;while(!![]){switch(_0x2015d9[_0xf009d3++]){case'0':eventSource[_0x5c300f(0xb8,0xef,0x9d,0x53)+'ener'](_0xa2d6f[_0x5c300f(0xb6,0x4b,0xd9,0xcc)],handleCancelBananaTask);continue;case'1':LEGACY_EVENT_NAMES[_0xa99a7c(-0x86,-0xc3,-0x61,-0x1d)](_0x1f4f36=>{function _0x19cdd9(_0x3d2547,_0x167518,_0x54fccf,_0x43bfca){return _0x5c300f(_0x43bfca-0x152,_0x167518-0x18b,_0x54fccf,_0x43bfca-0x66);}function _0x1d1a58(_0x1ab6b5,_0x548722,_0x1c5d52,_0x5c3674){return _0x5c300f(_0x1c5d52- -0x36a,_0x548722-0x69,_0x548722,_0x5c3674-0x55);}eventSource[_0x1d1a58(-0x26b,-0x1f2,-0x2b2,-0x28f)+_0x1d1a58(-0x35d,-0x2a8,-0x29c,-0x357)](_0x1f4f36,bananaGenerate);});continue;case'2':eventSource[_0x5c300f(0xb8,0x113,0xd0,0x162)+'ener'](EventType[_0xa99a7c(-0x8d,-0x9f,-0x9d,-0x19)+_0x5c300f(0x1a5,0x178,0x153,0xe5)+'ST'],bananaGenerate);continue;case'3':addLog(_0xa2d6f['OLCea']);continue;case'4':window[_0xa99a7c(0xb8,-0x9c,0xad,-0x8)+_0x5c300f(0x16f,0x1cf,0x120,0x1cd)+_0x5c300f(0xce,0xa0,0xcd,0x10b)]=![];continue;}break;}}}}