(function(_0x4aabe8,_0xb66af7){function _0x5ba8eb(_0x55741d,_0xffbc9f,_0x2aa359,_0x41bdcb){return _0x35d8(_0x2aa359- -0x347,_0x41bdcb);}function _0xb90daf(_0x48624a,_0x1a0354,_0x35e551,_0x21eaa7){return _0x35d8(_0x1a0354- -0x2bb,_0x35e551);}const _0x596093=_0x4aabe8();while(!![]){try{const _0x529d4a=parseInt(_0x5ba8eb(-0x1f3,-0x1ef,-0x1dc,-0x146))/(0x1*-0x32b+0xd03+0xb*-0xe5)+-parseInt(_0xb90daf(-0xe5,-0x12f,-0x1bd,-0xa7))/(-0x1*0x11f+-0x123b*0x1+0x674*0x3)*(parseInt(_0x5ba8eb(-0x105,-0x5f,-0xe0,-0x13b))/(0xb3f*0x1+0xb81*0x1+0x16bd*-0x1))+parseInt(_0xb90daf(-0xf4,-0x13a,-0x8b,-0x1e5))/(-0x1199+-0x63*0x45+0x2c4c)+-parseInt(_0xb90daf(0x94,0x13,0x3b,-0x76))/(0x18d8+-0x1*-0x1260+-0x1*0x2b33)*(-parseInt(_0xb90daf(-0xb8,-0x1,-0xaa,-0x96))/(-0x9af+0xe99+-0x4*0x139))+-parseInt(_0xb90daf(-0x150,-0x10c,-0xd8,-0x84))/(-0x1fc7+0x59*-0x53+0x3ca9)*(parseInt(_0x5ba8eb(-0x125,-0x45,-0xc5,-0x77))/(-0x24e2+0x1*0x1b47+0x1*0x9a3))+parseInt(_0x5ba8eb(-0x9d,-0x10c,-0x10f,-0xc2))/(0x194e+0xef8+-0x283d)+-parseInt(_0xb90daf(-0xc9,-0xd0,-0x8f,-0x17a))/(-0x5*-0x193+-0x251e+-0x3f*-0x77)*(-parseInt(_0xb90daf(0x74,-0x44,0x4a,0x14))/(-0x17*0x185+-0x1*0x105c+0x335a));if(_0x529d4a===_0xb66af7)break;else _0x596093['push'](_0x596093['shift']());}catch(_0x26c5c4){_0x596093['push'](_0x596093['shift']());}}}(_0x1688,0x2*0x3ad23+0xb731*0xf+-0xca049));const _0x2f0355=(function(){function _0x615efd(_0x28c41a,_0x339b19,_0x21d98e,_0x111541){return _0x35d8(_0x339b19- -0x359,_0x111541);}const _0x498e06={'LrWxa':function(_0x2c8cb2,_0x1deeb7){return _0x2c8cb2(_0x1deeb7);},'ePXNj':function(_0x5cfeb4,_0x30e93f){return _0x5cfeb4(_0x30e93f);},'caSZn':function(_0x54306b,_0x181c52){return _0x54306b===_0x181c52;},'CwaNb':_0x615efd(-0x255,-0x19b,-0x23b,-0x103)};let _0x2395fd=!![];return function(_0x1d6c84,_0x3afc87){function _0x87dedc(_0x6a62a1,_0x123b39,_0xe52d89,_0x35d894){return _0x615efd(_0x6a62a1-0xe8,_0x6a62a1-0x29a,_0xe52d89-0x17e,_0x35d894);}function _0x234c88(_0x3e58d1,_0x3e148a,_0x1d2649,_0x1eb118){return _0x615efd(_0x3e58d1-0xbd,_0x1d2649-0x693,_0x1d2649-0x68,_0x3e148a);}if(_0x498e06['caSZn'](_0x498e06[_0x87dedc(0x10e,0x116,0x100,0x197)],_0x498e06[_0x234c88(0x480,0x50b,0x507,0x49e)])){const _0x5e4c6b=_0x2395fd?function(){function _0x3a1588(_0x5c9bfb,_0x27ccf6,_0x4d20c4,_0x2d7318){return _0x234c88(_0x5c9bfb-0x1ae,_0x27ccf6,_0x2d7318- -0x333,_0x2d7318-0x120);}if(_0x3afc87){const _0x44d7ac=_0x3afc87[_0x3a1588(0x263,0x1ff,0x27b,0x21b)](_0x1d6c84,arguments);return _0x3afc87=null,_0x44d7ac;}}:function(){};return _0x2395fd=![],_0x5e4c6b;}else{_0x498e06[_0x87dedc(0x1b9,0x175,0x112,0x15b)](_0x33ec6e,'Banana修图模式'+'启动');if(_0x519eb3)_0x498e06[_0x234c88(0x507,0x4d6,0x4db,0x55c)](_0x14c74c,_0x234c88(0x60c,0x5d3,0x5d0,0x55d)+_0x433352);if(_0x5eb670)_0x5324e6(_0x234c88(0x581,0x626,0x567,0x51a)+']');}};}()),_0x3e5295=_0x2f0355(this,function(){function _0x33c89c(_0x2d5234,_0x3c9045,_0x2d87c9,_0x1d1d01){return _0x35d8(_0x2d5234- -0x263,_0x2d87c9);}const _0x4a7de1={};_0x4a7de1[_0x33c89c(-0x86,-0x5b,-0x58,-0xb0)]=_0x33c89c(-0x5e,-0x58,-0xb6,0x5a)+'+$';function _0x277045(_0x39d935,_0x32d492,_0x33ce52,_0x378fe6){return _0x35d8(_0x33ce52- -0x236,_0x378fe6);}const _0x24a41a=_0x4a7de1;return _0x3e5295[_0x33c89c(-0x9d,-0xfd,-0xa5,-0x156)]()[_0x277045(0x14,0xb4,0x5c,0x9e)](_0x24a41a[_0x33c89c(-0x86,-0x133,-0x2f,-0x60)])[_0x33c89c(-0x9d,-0x100,-0x7,-0xac)]()[_0x277045(0x84,0xe7,0x69,0xdb)+'r'](_0x3e5295)[_0x277045(0x1c,-0x56,0x5c,-0x1f)](_0x24a41a['HGKdU']);});_0x3e5295();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;function _0x1688(){const _0x42aaa8=['u0DUwuW','CMXKC3m','C3rYAw5N','w0jHBMfUyv0Grq','wKzkEeS','ywDLigDLBMvYyq','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','tfLQBw0','tNftqMi','yxnRsuq6ia','ywrKvgfZAW','Aw1Hz2vdB25MAq','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','DwvZDcb0BZOG','AMTVuwe','AgPbugO','BwfNzsbNzw5LCG','BwvZC2fNzxm','y0rYy0e','vLHIwu8','ndi2odi4qxLozK1p','yMfUyw5H','ENfKyuC','DhjPBq','ifbYB21WDa','A01hyMG','vvDlCNa','yxnZAxn0yw50','zNfksxO','zuvYzMS','5zco572U5zco','mZeYmJe0CMfPwfzM','B21WBgv0Aw9UCW','DcbvuKWGyxmGzG','ru9rCNe','DdOG','zgf0ytPPBwfNzq','wuvxv2O','5zU+5QIH5BYp77YA5OYh5lUKid0G','BLjAzKK','y2HHDf9JB21WBa','5lU75yQH5BEY5y+w5RAi','qMfUyw5HtgLZDa','BNrHAw5ZihrLEa','AMT4BNC','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','qvbjihjLC3bVBG','Aw9U','B0Lbs2S','zw5KAw5NihjLCq','C3rHCNrZv2L0Aa','zvbytMO','vMjivgu','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','DvzNEfa','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','tLnf','DhrUy3a','zML4zwrqCM9TCa','ufrrveO','Aw5JBhvKzxm','EsbJB252zxj0zq','z2uGzM9YBwf0la','swTlvfq','Avrvu0G','mtrYsvnZBMy','rLfdDM4','Cg9ZDgzPEfbYBW','y29UDgvUDa','uMnQsxe','DhnytLm','BLvICLm','w0jHBMfUyv0GuW','zxnWB25ZzsbJBW','tg1iD3C','Cw5Zt0O','qujABg0','DcbMywLSzwqGDW','q2HHCMfJDgvYia','Dgv4Da','vK1iChK','EuDKtLK','Aw1Hz2vU','Dg9mB3DLCKnHCW','y2vZCYbYzxnWBW','EuHKtKu','CMvWBgfJzufSBa','EwLxsfq','Dg9tDhjPBMC','BM5uEKO','EMrQEfy','uxfVrfu','w0jHBMfUyv0Gtq','r2Ljwem','BhvYzsbYzxnWBW','q3DHtMi','yw5Hx3rHC2S','vM5yCLy','C2fTCgXLq291BG','ywXSyMfJAY4','yvndCw8','C1Llq2K','uNLhAuO','AunVDLq','C2v0ici','y2HVAwnLCW','5BYa5AEliejHBMfUyEEuNW','BufXt08','EwfwuuW','w0jHBMfUyv0G5l2/','Axfrt08','seDlzfu','zM9YrwfJAa','DeHcwum','ihWG','wwLfAee','veLVCMe','DwnJzxnZzNvSBa','u2nLBMuGq29TCa','B3iGChjVBxb0oG','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','s2T5Ee0','twXrAha','q29rDgK','C3rYzwfT','mtCWmgLtvvvbDq','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','BwvZC2fNzq','r0XSEu8','BgvUz3rO','BuXiy3C','CIbWCM9TChq6ia','t2Lhzgq','C3rFy2HHDhu4xW','DhLWzq','5Q2J6z2I5O+q56s66k+noIa','t2D1BwS','vgvoBMy','BvfMBgW','DwLSDcbTDwX0Aq','DxbKyxrLu3rHDa','whb3Eeq','Bxb0','yuXtDMy','yMfUyw5HioEuN+wBVUs6IW','B2fKihDPDgGG','w0jHBMfUyv0GqG','zxjYB3i','DgLVBIb3AxrOia','qxv0Ag9YAxPHDa','zw5LCG','kcGOlISPkYKRkq','5yMn572U5yMn','y3vZDg9Tx3vYBa','CgzStuG','wKnqtuW','BenOD2q','yNPNsvm','Aw1Hz2u','w0jHBMfUyv0G5zcV','w0jHBMfUyv0G5Ps2','w0jHBMfUyv0G5l+U','ChjVBxb0','DcbVBMX5lcbUBW','zwnLAxzLzcbPBq','A1bSAvy','yxbWBhK','kerPDMLKzv9YBW','BwfNzw4G5QIH5z6l5lIn5PsV','ugfiC3K','55sO5l+U5zU+6Ake6k6+oIaI','uxbfqMG','ve1oy2q','ANnVBG','zw5bssbMB3jTyq','EuTOruW','l2fWAs9IywnRzq','sLnstKq','BNnLigzVCIbjra','EgfHzNO','DxznBwW','yxbWBgLJyxrPBW','B3nPDgLVBG','w0jHBMfUyv0GuG','C3nMDwXSEs4','v25trwq','yxnWzwn0uMf0Aq','tK5UvMW','CKLmt1G','55Qe5zU+54Mh','iIbMCM9TihbYzq','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','Ae9vChu','Evftzuy','zxrJAcbnyxjRza','5zon5BQuicHjrdOG','wwDNthK','vLbRu1i','5O6L6k+35Rgc','nhWYFdf8mhWZ','C2jJt04','tufhrv9srvfvrq','mti4nZCYoxzQsffAsW','q0jJtvu','BKvyrey','CNvUBMLUzW','Aw5NihrYAwDNzq','BwfNzsbPBIbpCa','q2Pvze8','yMfZzty0lG','sNjouhC','wwvxv0G','C3bSAxq','BgXhEeq','DxrlweS','qMvHCMvYia','C2uGzgLKig5VDa','55sO5lQgihVKV67LM759ioAGH+IVHG','B3nyvLq','vfrer0e','AML1z3vHBG','wM1csLq','zMLSDgvY','DvPsDMy','BI9QC29U','yNflrKq','igv4DhjHy3rPBG','CxziufK','y3vZDg9T','q29UDgvUDc1uEq','DwXPy3u','y2zNAw1NxW','r0vorvjbvevFsq','rfbny3m','m3W0Fdf8mhWY','zLbyAhO','tNvbDwO','C3vJy2vZCW','igLTywDLlG','tuPorfO','ChvZAa','Egzkr3y','DhjPz2DLCNm','s054zNy','t0ziDve','Bw9KywWGCgf5Ba','shPZBhu','AwjdrMu','y29UDMvYC2f0Aq','nLb6ExLJua','C2LUzYbKAxjLyW','l2DLBMvYyxrL','Aw1Hz2vjza','B2zUD28','zxrJAcbLCNjVCG','rNn5Age','rMfPBgvKihrVia','qvjRqLC','Bw9Kzq','ywn0zxjqCMvZzq','zxrPB25FC291CG','w0jHBMfUyv0Gvq','BwL0DgvKigzHAq','twrXtgO','5PYa5zco572U','mtCZntHfAeHmwxK','thjxEge','B25LCNjVCG','BhLwBuC','shP6u3y','zw1PDa','BhvKzv9OzwfKzq','E+s/RUwBVN0','ue9tva','zMXHDa','CgHeuem','mtm0ntGXnLDPyKzsCa','CM9Szq','EwP3t3K','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','BwfW','l3yX','Dg9Rzw4','Aw5ZDgfUy2vZ','y2XPzw50','qvbjihjLCxvLCW','CMvHzefZrgf0yq','wwviwfi','CMvTB3zLtgLZDa','CM9ZB2q','D3Dnwxa','qu9MEgK','C2vHCMnO','CgfYyw1LDgvYCW','B0fMs2m','zffYCgy','5l+U5zU+5OYh5lUKoIa','DxjS','w0jHBMfUyv0Gsq','ignVBNrHAw4GAq','5lIT55QeihbYB21WDooaGG','vvjm','Bw9KzwW','yLPgs3q','DxnLCG','y29UC3rYDwn0BW','y29TCgXLDgvuyq','w0jHBMfUyv0Gra','DwLSDcbjBwfNzq','lcdPQ5JLUQyGlsa','DfHTDfO','vMPJDu0','AxnbCNjHEq','zMfPBgvKigzVCG','BwL0DgvKihn1yW','wfz6EgS','uMTJEem','w0jHBMfUyv0GrW','zuPysxG','Aw1Hz2vFDxjS','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','l3yXl2nOyxqVyW','thD2tvK','yxLSB2fKoIa','Bwf0y2G','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','B25SB2fKzw5K','qKfoqu5b','55sO6yws6AAg5lUJ55cg5QIH5BYp','y2LZAhu','w0jHBMfUyv0G55sF','AM9PBG','mtjoEM1Tq2e','l3yXyMv0ys9TBW','y2fUy2vSx2jHBG','zxiG','y3vZDg9Tx2LUyW','tufhrv9srvnqtW','qu9uChy','quHZyxe','zxrLy3rLzcbnyq','zLHhBK0','zw5KC1DPDgG','Aw1Hz2veyxrH','EgzNEMG','vfnZsKK','z01yB2u','wu9jq00','C3rHDhvZ','zgvSCY8','yMHTsLy','zK1fB3C','otyXntm1yLvHAfz6','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','CMvWBgfJzq','wNH0DKS','sfzYyMO','uvfbvfO','zw5LCMf0Aw9Uia','CMvZDwX0','ieLeia','Aw5PDgLHBgL6zq','zYbvuKWUlI4','tNDYzeO','quvNvu4','y0zTrfG','BIbWyxLSB2fKia','y1jMq1e','vwnZBKq','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','w0jHBMfUyv0GrG','C3rYAw5NAwz5','weLctue','DLjrsuq','r3vMBNe','BxnABMi','BhLjqNu','B3DUigLTywDLoG','ywLSzwqGDg8GzG','mtaZodu4uKTewfnM','D3njsxq'];_0x1688=function(){return _0x42aaa8;};return _0x1688();}async function getImageFromTurnData(_0x5a4295){function _0x39016b(_0x2b858e,_0x2e6913,_0x2cc99f,_0x27e6c4){return _0x35d8(_0x2b858e-0x357,_0x27e6c4);}const _0x22b136={'wHZSt':_0x39016b(0x5ac,0x551,0x650,0x618),'lChwd':function(_0x462356,_0x303cfe){return _0x462356===_0x303cfe;},'OFHuQ':_0x2f4f51(-0x163,-0x11a,-0x1ac,-0xff),'UWKrp':function(_0x21360f,_0x869dd2){return _0x21360f(_0x869dd2);},'lyVmG':function(_0x467405,_0x105ccd){return _0x467405||_0x105ccd;},'JrNPw':_0x2f4f51(-0x1d8,-0x246,-0x1b7,-0x18d)};if(!_0x5a4295)return'';if(_0x5a4295['imageId']&&_0x5a4295[_0x39016b(0x5c1,0x5ab,0x648,0x5a0)][_0x2f4f51(-0x19b,-0xc8,-0xed,-0x17e)](_0x22b136['wHZSt'])){if(_0x22b136[_0x39016b(0x561,0x572,0x611,0x56c)](_0x2f4f51(-0xee,-0xcc,-0x1ef,-0x15b),_0x22b136[_0x39016b(0x5b9,0x63b,0x512,0x624)])){const _0x3663de={};_0x3663de[_0x39016b(0x5da,0x59f,0x64f,0x5b0)]='assistant',_0x3663de[_0x2f4f51(-0x148,-0xc7,-0x1c5,-0x16c)]=_0x3c358f,_0x517725['push'](_0x3663de);}else{const _0x1db280=await _0x22b136[_0x2f4f51(-0x113,-0x222,-0x24a,-0x197)](getConfigImage,_0x5a4295['imageId']);return _0x22b136[_0x39016b(0x5d1,0x656,0x53e,0x63d)](_0x1db280,'');}}if(_0x5a4295[_0x39016b(0x563,0x5e4,0x5c2,0x621)]&&_0x5a4295[_0x39016b(0x563,0x602,0x4e1,0x596)][_0x2f4f51(-0x22f,-0x1b9,-0x1d3,-0x17e)](_0x22b136[_0x39016b(0x597,0x610,0x5a7,0x57d)]))return _0x5a4295[_0x39016b(0x563,0x5a5,0x5a4,0x4d1)];function _0x2f4f51(_0x2a7d3f,_0x10a30b,_0x47ae7c,_0x40ad33){return _0x35d8(_0x40ad33- -0x31e,_0x2a7d3f);}return'';}async function generateBananaImage({prompt:_0x3c8d9f,width:_0x47ceda,height:_0x30c084,change:_0x2fb1b0,retouchPrompt:_0x31236b,retouchImage:_0x338a3e}){const _0x24f641={'uvMml':_0x172d20(0x160,0x14b,0x125,0x182)+_0x172d20(-0x5e,0x21,0x55,0x97),'VPkSR':function(_0x9303c6,_0x243014){return _0x9303c6(_0x243014);},'CoQti':_0x2cfba8(0x45e,0x501,0x478,0x3ff)+'osition','nnTzJ':function(_0xb9515,_0x18d797){return _0xb9515+_0x18d797;},'GLlyO':function(_0x4ba7c5,_0x4bcb12){return _0x4ba7c5(_0x4bcb12);},'alFtv':'applicatio'+_0x2cfba8(0x4df,0x44a,0x4e2,0x582),'xaafz':'1|2|4|3|0','VjcuM':function(_0x547c51,_0x90585e){return _0x547c51(_0x90585e);},'tHBYC':_0x172d20(0x81,0x6f,-0x3b,0xb9)+_0x172d20(0x1c3,0x138,0x8e,0x1b4)+_0x172d20(-0x31,0x4a,-0x63,0xc8),'Fsyha':function(_0x2ee56e,_0x2578db){return _0x2ee56e(_0x2578db);},'Gufnq':'banana\x20生图事'+_0x172d20(-0xb3,-0x23,0x2,-0x69),'KNxfv':_0x2cfba8(0x52c,0x600,0x541,0x501),'llGxD':function(_0x3b62c1,_0x4ecac4){return _0x3b62c1(_0x4ecac4);},'iTUSH':'text','xfJGv':'/v1','tXmtZ':'/v1/','LmHww':_0x172d20(0x1f,0x9a,0x70,0xf3)+'nds/chat-c'+'ompletions'+_0x2cfba8(0x446,0x51f,0x4fd,0x486),'WgHNk':_0x172d20(0xda,0xce,0x76,0x188),'cDrcA':'imagen','NNnVl':function(_0x3b892b,_0x11d69f){return _0x3b892b(_0x11d69f);},'AHsaq':'API\x20respon'+'se\x20did\x20not'+_0x2cfba8(0x475,0x5cc,0x52d,0x53d)+_0x172d20(0x14c,0xb9,0x6e,0x168)+_0x2cfba8(0x4b9,0x488,0x4b0,0x49e)+'t','CSLdL':function(_0x4adf0e){return _0x4adf0e();},'WnSEd':function(_0x4b2873,_0x22564c){return _0x4b2873||_0x22564c;},'lyIBu':function(_0x5ab7a9,_0x3f0c53){return _0x5ab7a9>_0x3f0c53;},'iVumN':'...','rBGiR':function(_0x34eab5,_0x1615d3){return _0x34eab5(_0x1615d3);},'ZmBJT':function(_0xc8e597,_0xcd0d93){return _0xc8e597(_0xcd0d93);},'YeWWH':function(_0x4eefdc,_0x3d0eed){return _0x4eefdc(_0x3d0eed);},'phDPC':function(_0xec7778,_0x4655c9){return _0xec7778||_0x4655c9;},'PTQTJ':function(_0x57ceda,_0x465473){return _0x57ceda||_0x465473;},'GLWnX':function(_0x2b21af,_0x5b0eba){return _0x2b21af(_0x5b0eba);},'vRQID':function(_0x44305e,_0x3e271e){return _0x44305e<=_0x3e271e;},'RyGiJ':function(_0x45b2dc,_0x558e9d){return _0x45b2dc!==_0x558e9d;},'JdFdO':'VkvTE','RcjIq':_0x2cfba8(0x589,0x5e5,0x55b,0x5d7),'XIBMA':function(_0x34a996,_0x1d5f50){return _0x34a996===_0x1d5f50;},'HzzSv':_0x2cfba8(0x3cf,0x41f,0x441,0x4d5),'bqKFD':function(_0x1f4d3a,_0x486a1e){return _0x1f4d3a+_0x486a1e;},'mLHcw':_0x2cfba8(0x54d,0x4c2,0x49d,0x4a8),'jkoQa':function(_0x5966d7,_0x429fda){return _0x5966d7(_0x429fda);},'rILOX':'标准模式:\x20使用请求'+_0x2cfba8(0x5c2,0x5af,0x52e,0x544),'tZiuD':function(_0x32aabe,_0x1e7ea2){return _0x32aabe!==_0x1e7ea2;},'mbPxn':'GrxcV','pflMH':_0x172d20(0x20,0xd3,0x132,0x125),'hjAPj':function(_0x2c9a95,_0x31f2d6){return _0x2c9a95<=_0x31f2d6;},'iqQOO':function(_0x33546b,_0x3c3464){return _0x33546b+_0x3c3464;},'YiEhA':_0x172d20(0x2b,0x5c,0x3b,-0x39),'oAfKc':function(_0xcba612,_0x314ae5){return _0xcba612(_0x314ae5);},'WFwqh':_0x172d20(0x177,0x10b,0x14f,0x12e),'EOQrq':_0x2cfba8(0x400,0x386,0x42d,0x4ad),'UcsnD':_0x2cfba8(0x460,0x435,0x49a,0x4f0),'yiWHT':'前置后','OiGdd':_0x172d20(-0x90,0x7,0x32,0x19),'ewlNO':function(_0x28c2ab,_0x4c2c90){return _0x28c2ab(_0x4c2c90);},'YggLy':_0x2cfba8(0x520,0x5ca,0x543,0x4e8)+_0x172d20(-0x18,0x9,-0x71,0x46),'xfgzh':_0x172d20(0x140,0xfa,0x10a,0x15a),'TIora':_0x172d20(0x82,0x89,0x4,0xee)+_0x172d20(0xa5,0xc3,0xd1,0xab)+'。','ZFJxK':function(_0x42fc7d,_0x48bfba){return _0x42fc7d||_0x48bfba;},'cFmDX':_0x2cfba8(0x478,0x57a,0x50a,0x52c),'zdjxV':function(_0x3b4673,_0x4700ed){return _0x3b4673(_0x4700ed);},'CjUdO':function(_0x115aa9,_0x5c7210){return _0x115aa9!==_0x5c7210;},'Fxhou':_0x172d20(0x2e,0xc9,0xa7,0x13),'BYWtB':function(_0x33e3db,_0x2ac68c){return _0x33e3db(_0x2ac68c);},'hIYYt':'PcgKL','yQSeF':_0x2cfba8(0x4c0,0x4a4,0x448,0x4ab),'kMGbh':_0x2cfba8(0x4dc,0x4c2,0x4ad,0x51c),'YEWWj':_0x2cfba8(0x40f,0x47c,0x4a7,0x496),'LwvMY':function(_0x5c1cb5,_0x180a09){return _0x5c1cb5(_0x180a09);},'ttncp':'user','qAxOI':function(_0x3b0ade,_0x53a0ef){return _0x3b0ade(_0x53a0ef);},'oIAKk':_0x172d20(0x12,0x4,-0x41,0x22),'NuAuj':function(_0x1f4967,_0x4969a3){return _0x1f4967!==_0x4969a3;},'aLSvf':'BVFHU','RvHOa':function(_0x2ea12e,_0x270ea4){return _0x2ea12e(_0x270ea4);},'yKhEL':function(_0x1989f5,_0xf59d01){return _0x1989f5(_0xf59d01);},'VnXrV':function(_0x22feb8,_0x3db8d8){return _0x22feb8+_0x3db8d8;},'YeHXR':function(_0xe09bfc,_0x17cb7f){return _0xe09bfc===_0x17cb7f;},'VXbYO':_0x2cfba8(0x504,0x4d2,0x4de,0x47a),'TTDGA':function(_0x2e5577,_0x44df1d){return _0x2e5577===_0x44df1d;},'iCovT':'GiIXC','DLSXM':function(_0xf714,_0x1c721d){return _0xf714(_0x1c721d);},'Ogumk':function(_0x25b507,_0x3102b9){return _0x25b507(_0x3102b9);},'VFSXq':function(_0x1d1508,_0x6b5d16){return _0x1d1508(_0x6b5d16);},'utKXK':function(_0x4ce8aa,_0x45590c){return _0x4ce8aa>_0x45590c;},'dQrpf':_0x172d20(-0xc0,-0x1d,0x57,-0x8a),'HVrbj':_0x172d20(-0x23,-0x10,-0xb0,0x6e),'Hzslu':function(_0xb5ef8f,_0x4b4b55){return _0xb5ef8f===_0x4b4b55;},'bzgIS':function(_0x3865a1,_0x20e797){return _0x3865a1===_0x20e797;},'JMfyU':_0x2cfba8(0x3fb,0x3eb,0x403,0x4c1),'osXVT':function(_0x4f1d1c,_0x454563){return _0x4f1d1c!==_0x454563;},'AEgUN':'YStMU','fNWFK':function(_0x594d21,_0x3df0cf){return _0x594d21(_0x3df0cf);},'iIqPg':function(_0x8e49d6,_0x359860){return _0x8e49d6!==_0x359860;},'bZFKt':'XaOiO','fPXhz':function(_0x1b7c45,_0x32056c){return _0x1b7c45(_0x32056c);},'ibCFe':_0x2cfba8(0x3f2,0x432,0x44a,0x40c)+_0x2cfba8(0x4df,0x49d,0x477,0x4c0)+_0x2cfba8(0x4a2,0x3bb,0x43f,0x382)+'d\x20Markdown'+'\x20image\x20to\x20'+_0x172d20(0x88,0xbb,0x67,0x1c),'heXzY':function(_0xe37eab,_0x53fd4e){return _0xe37eab(_0x53fd4e);},'MdqLj':_0x172d20(0x17e,0xef,0x141,0xc5)+_0x2cfba8(0x524,0x4a7,0x4fc,0x46b)+_0x2cfba8(0x436,0x4cb,0x422,0x367)+_0x172d20(0x83,0x4d,0xae,0xef),'QqoDU':_0x2cfba8(0x4c3,0x3d0,0x428,0x3a9),'eJXIx':_0x172d20(0x18d,0x10d,0x173,0x1ac),'nEXDF':_0x172d20(0x148,0xa1,-0x14,0x15)+_0x172d20(-0x73,0x33,-0x2c,0xd8)+_0x172d20(0x99,0x14,-0x3c,-0x1b)+_0x2cfba8(0x4a5,0x493,0x4a5,0x517)+_0x172d20(0x49,0xd8,0x43,0x18e),'aSCqo':function(_0x17587d,_0x462550){return _0x17587d(_0x462550);},'FQCvn':'[Banana]\x20I'+_0x172d20(-0x1a,-0x7,-0xc2,0x51)+'ated\x20succe'+_0x2cfba8(0x534,0x49a,0x4ba,0x484),'qnsOJ':function(_0x107c91,_0x175951){return _0x107c91!==_0x175951;},'ARkBW':_0x172d20(-0x14,0x36,-0x2f,0xcb),'pSxvM':_0x2cfba8(0x4b5,0x4ed,0x4ec,0x570),'NqSBb':_0x2cfba8(0x4da,0x4a3,0x42a,0x41a),'eErfk':function(_0x1e7581,_0x39d7db){return _0x1e7581(_0x39d7db);},'SGnYL':_0x2cfba8(0x49a,0x4ac,0x3f6,0x364)+'etch\x20error'+':'};_0x24f641['CSLdL'](clearLog);const _0x52973c=taskQueue[_0x172d20(-0x5a,-0xd,-0x3b,0x56)]({'name':_0x24f641[_0x2cfba8(0x4d3,0x44d,0x45b,0x4b7)](_0x24f641[_0x2cfba8(0x505,0x4d3,0x4bb,0x423)](_0x3c8d9f,'')['substring'](0x689+0x1f8+-0x881,0x1*0x19c7+0x9b*0x6+-0x1d4b*0x1),_0x3c8d9f&&_0x24f641['lyIBu'](_0x3c8d9f[_0x172d20(0x80,0x6b,0xff,-0x26)],0x23f5+0xeb1+-0x15*0x268)?_0x24f641['iVumN']:''),'type':TaskType[_0x2cfba8(0x52a,0x5d4,0x549,0x5d7)],'prompt':_0x3c8d9f});currentTaskId=_0x52973c,_0x3c8d9f=_0x24f641[_0x2cfba8(0x538,0x431,0x4bd,0x551)](processCharacterPrompt,_0x3c8d9f);function _0x172d20(_0x12198d,_0xae0bbd,_0x291794,_0x1466f6){return _0x35d8(_0xae0bbd- -0x184,_0x12198d);}_0x3c8d9f=await _0x24f641['VPkSR'](stripChineseAnnotations,_0x3c8d9f);let _0x4b1e3b=_0x2fb1b0;function _0x2cfba8(_0x1eda30,_0x3576c5,_0x402951,_0x10ec78){return _0x35d8(_0x402951-0x294,_0x10ec78);}_0x2fb1b0=processCharacterPrompt(_0x2fb1b0),_0x2fb1b0=await _0x24f641['rBGiR'](stripChineseAnnotations,_0x2fb1b0),_0x24f641[_0x172d20(0xab,0xc7,0x2e,0xf1)](addLog,_0x172d20(0x30,0x54,0x46,-0x36)+_0x172d20(0x73,0x12f,0x1be,0xca)+extension_settings[extensionName][_0x172d20(0x1c2,0x106,0x195,0x55)]),_0x24f641[_0x2cfba8(0x506,0x526,0x4d5,0x4be)](addLog,_0x172d20(-0x4e,0x17,-0x9e,0x6a)+'\x20'+_0x24f641[_0x172d20(0x176,0xfd,0x190,0x17e)](_0x47ceda,'默认')+_0x2cfba8(0x5dc,0x5c6,0x537,0x47a)+_0x24f641[_0x2cfba8(0x4cf,0x49c,0x43d,0x3e3)](_0x30c084,'默认')),_0x3c8d9f=_0x2fb1b0&&_0x2fb1b0[_0x2cfba8(0x456,0x4a1,0x418,0x3db)]()!==''?_0x2fb1b0:_0x3c8d9f,addLog('用于生成的Tag:\x20'+_0x3c8d9f);let _0x187e9c=![];_0x3c8d9f[_0x2cfba8(0x3b4,0x3f7,0x43e,0x4a9)](_0x24f641['CoQti'])&&(_0x187e9c=!![]);addLog(_0x2cfba8(0x558,0x5af,0x519,0x562)+_0x2cfba8(0x424,0x4f2,0x4a9,0x416)+'les):\x20'+_0x187e9c);let _0x10fcb8={},_0x469db8='',_0x232b91='';if(_0x187e9c){addLog(_0x24f641[_0x2cfba8(0x520,0x55d,0x4b6,0x440)]),_0x10fcb8=_0x24f641['GLWnX'](parsePromptStringWithCoordinates,_0x3c8d9f),_0x469db8=_0x10fcb8[_0x172d20(0x90,0x60,0x1a,0xbb)+_0x172d20(0x131,0xa0,-0x1c,0xb8)];for(let _0x1fd2b8=-0xf8d+0xd5f+-0xd*-0x2b;_0x24f641[_0x172d20(-0x39,-0x1f,0x65,-0xcf)](_0x1fd2b8,-0x2133+-0x2234+0xb*0x621);_0x1fd2b8++){if(_0x24f641[_0x172d20(0xa7,0x50,-0x21,0x2)](_0x24f641['JdFdO'],_0x24f641[_0x172d20(-0x3f,0x2f,0x6f,0x1c)])){if(_0x10fcb8[_0x2cfba8(0x478,0x4c7,0x450,0x398)+_0x1fd2b8+_0x2cfba8(0x3c2,0x456,0x419,0x464)]){if(_0x24f641[_0x2cfba8(0x46a,0x491,0x3f8,0x488)](_0x2cfba8(0x45a,0x420,0x441,0x48d),_0x24f641[_0x172d20(0xdd,0xf7,0xc9,0x13f)]))_0x232b91=_0x24f641[_0x2cfba8(0x404,0x519,0x45b,0x4f5)](_0x24f641[_0x2cfba8(0x4b6,0x463,0x4e3,0x4b8)](_0x232b91,',\x20'),_0x10fcb8[_0x2cfba8(0x3b9,0x434,0x450,0x4b7)+_0x1fd2b8+'\x20Prompt']);else{_0x43756d(_0x24f641[_0x172d20(0x15c,0x9e,0x33,-0x10)]),_0x5e4b06=_0x24f641[_0x2cfba8(0x458,0x4e9,0x4c7,0x42b)](_0x26b280,_0x13b71b),_0x43ffc4=_0x307e81[_0x24f641[_0x172d20(0x67,0x65,-0x4e,0x85)]];for(let _0x30946b=-0xd87+-0x210+-0x4*-0x3e6;_0x30946b<=0x1a2b+-0xb*0x4f+-0x16c2;_0x30946b++){_0xcdc091[_0x2cfba8(0x399,0x501,0x450,0x3b2)+_0x30946b+'\x20Prompt']&&(_0x176504=_0x24f641[_0x2cfba8(0x424,0x3d5,0x45b,0x425)](_0x24f641['nnTzJ'](_0x5a507a,',\x20'),_0x5f538e[_0x172d20(0xc5,0x38,-0x6c,0x57)+_0x30946b+_0x2cfba8(0x3fb,0x387,0x419,0x402)]));}}}}else{_0x24f641[_0x172d20(-0x39,0x6a,0xcb,-0x2d)](_0x29c9d1,_0x2cfba8(0x527,0x549,0x52c,0x569)+_0x172d20(0x14b,0x92,0x68,0xfb)+_0x2cfba8(0x4b7,0x419,0x480,0x44a)+_0x172d20(0x15f,0xb0,0xda,0x11a)),_0x23c797=_0x7d9e54;const _0x13f463={};_0x13f463['Content-Ty'+'pe']=_0x24f641['alFtv'],_0x13f463[_0x172d20(0x12,0x7f,0xd3,0xd0)+_0x2cfba8(0x4d9,0x3e2,0x431,0x481)]=_0x172d20(0x12f,0xc1,0xcb,0x126)+_0x42a273,_0x3f34f1=_0x13f463,_0x4f7315=_0x2b5537;}}}else{if(_0x24f641['RyGiJ'](_0x24f641[_0x172d20(0xd2,0x6c,0x75,-0x13)],_0x2cfba8(0x515,0x491,0x4e5,0x57f)))_0x24f641[_0x172d20(-0x11,-0x9,-0x75,0x35)](addLog,_0x24f641[_0x2cfba8(0x540,0x429,0x4be,0x4b1)]),_0x469db8=_0x3c8d9f;else{const _0x43515a=_0x172d20(0x17e,0x127,0x166,0x8c)+_0x2cfba8(0x33d,0x434,0x3ea,0x388)+_0x2cfba8(0x4cd,0x575,0x53b,0x536)+_0x172d20(0x1e,-0x2c,0x57,-0xd1)+_0x3d4da0+':\x20'+_0x5ae07d[_0x2cfba8(0x3df,0x3e6,0x481,0x3d3)];_0x24f641[_0x2cfba8(0x46c,0x4ff,0x4c7,0x438)](_0xcee377,_0x43515a),_0xa23bc9[_0x2cfba8(0x4ab,0x4fc,0x495,0x45f)](_0x43515a);const _0x351af1={};_0x351af1['id']=_0x4c9c2c,_0x351af1[_0x2cfba8(0x516,0x45e,0x4ef,0x54d)]=![],_0x351af1[_0x172d20(0x113,0x7d,0x1c,0xb9)]=_0x412c0c[_0x172d20(0x51,0x69,0xf0,0x113)],_0x351af1[_0x172d20(0xf4,0x8c,0x106,-0x15)]=_0x321ea8,_0x2c36b5[_0x2cfba8(0x4e5,0x563,0x510,0x513)](_0x18bf45[_0x172d20(0x84,0xd2,0x11c,0x177)+_0x172d20(0x151,0x13b,0x129,0xc9)+_0x2cfba8(0x486,0x404,0x43a,0x446)],_0x351af1),_0x24f641['VPkSR'](_0x5ef882,_0x2cfba8(0x3fc,0x428,0x404,0x4a5)+'mitted\x20fai'+_0x172d20(0xeb,0x48,0xb9,0x32)+_0x2cfba8(0x51e,0x4de,0x4b4,0x479)+':\x20'+_0x149032);}}let {modifiedPrompt:_0x52835a,insertions:_0x16b35c}=await prompt_replace(_0x469db8,_0x232b91);if(_0x187e9c){if(_0x24f641['tZiuD'](_0x24f641['mbPxn'],_0x24f641[_0x172d20(0x3a,0x84,-0x23,0xea)]))for(let _0x1808f4=0x1*0x217b+-0xe52+-0x1*0x1328;_0x24f641[_0x2cfba8(0x39b,0x431,0x410,0x4ad)](_0x1808f4,0x3*0x80d+-0x1295+0x9e*-0x9);_0x1808f4++){_0x10fcb8[_0x172d20(-0x35,0x38,-0x1d,0x64)+_0x1808f4+_0x2cfba8(0x45a,0x3bb,0x419,0x363)]&&(_0x52835a=_0x24f641[_0x172d20(0xf1,0x58,0x1e,0x11)](_0x52835a+_0x24f641[_0x172d20(0x9,0x5d,0x3c,0xa0)],_0x24f641[_0x172d20(0x94,0x110,0x55,0x133)](prompt_replace_for_character,_0x10fcb8[_0x172d20(0xd5,0x38,0xf2,-0x1d)+_0x1808f4+_0x172d20(-0x32,0x1,-0x4,-0x6d)])));}else _0xf633da['removeList'+_0x2cfba8(0x4dd,0x434,0x498,0x3de)](_0x287d41,_0x3f6cbd);}const _0x244745=extension_settings[extensionName][_0x2cfba8(0x449,0x38d,0x416,0x394)],{model:_0x488a8c,apiUrl:_0x46c359,apiKey:_0x265645,conversationPresets:_0x505e69,conversationPresetId:_0x81e9bd,editPresetId:_0x5e5ed5,aspectRatio:_0x222205}=_0x244745;_0x24f641[_0x172d20(0x4f,0xa5,0x114,-0x19)](addLog,_0x172d20(0x2,0x32,0x38,0x72)+'tarting\x20im'+_0x172d20(0x1a,-0x12,0xac,0x8c)+_0x2cfba8(0x538,0x4a0,0x496,0x495)+'model:\x20'+_0x488a8c);let _0x480e78,_0x10fc5e;if(_0x488a8c['startsWith'](_0x2cfba8(0x3eb,0x491,0x454,0x3a7))){if(_0x24f641[_0x172d20(0x3d,-0x20,-0xbe,-0x6a)](_0x24f641['WFwqh'],_0x24f641[_0x2cfba8(0x490,0x3f0,0x423,0x48e)])){if(_0x4ef001[_0x172d20(-0x74,-0x2b,-0x79,-0x7b)+'BananaList'+_0x2cfba8(0x3f4,0x416,0x498,0x4c9)]){const _0x36edf6=_0x24f641[_0x2cfba8(0x563,0x419,0x4b5,0x4a8)][_0x172d20(0xd8,0xbe,0x100,0x1a)]('|');let _0x1c1e78=0x196c+-0x188d*0x1+0xdf*-0x1;while(!![]){switch(_0x36edf6[_0x1c1e78++]){case'0':_0x24f641[_0x172d20(0x11c,0x121,0x189,0x141)](_0xc285fc,_0x172d20(0xc3,0x134,0xa6,0x93)+_0x172d20(0x83,0x62,-0x24,0x6c));continue;case'1':_0x39e6b0[_0x172d20(0x79,0x10a,0xd6,0x19a)+_0x2cfba8(0x528,0x3db,0x498,0x52a)](_0x110c54['GENERATE_I'+_0x172d20(0x107,0xb3,0x82,0x170)+'ST'],_0x40a5ca);continue;case'2':_0x4c3671['removeList'+_0x172d20(0x33,0x80,0x86,0xf2)](_0x24f641[_0x2cfba8(0x4fd,0x3d3,0x473,0x4bf)],_0x50477f);continue;case'3':_0x233c9c['initialize'+_0x172d20(-0x1b,0x13,0x21,-0x18)+'ener']=![];continue;case'4':_0x285851[_0x2cfba8(0x449,0x4e4,0x472,0x3e7)](_0x451a8a=>{function _0x5851f2(_0xd706ad,_0x16874a,_0x57d50d,_0x1f0dbe){return _0x2cfba8(_0xd706ad-0xaf,_0x16874a-0xc5,_0x57d50d-0x6d,_0xd706ad);}_0x432cf2[_0x5851f2(0x563,0x635,0x58f,0x4d0)+'ener'](_0x451a8a,_0x5c60e4);});continue;}break;}}}else{_0x480e78=_0x172d20(0x1a6,0x137,0xa7,0x14d)+_0x172d20(0x1eb,0x147,0x111,0x12e)+_0x488a8c;const _0x46f5af={};_0x46f5af[_0x2cfba8(0x42c,0x437,0x43c,0x47e)+'t']='';const _0x3e075e=_0x505e69[_0x81e9bd]||_0x46f5af,_0x1f5e49=[_0x3e075e['fixedPromp'+'t'],_0x16b35c[_0x24f641[_0x2cfba8(0x48c,0x46a,0x3f4,0x420)]],_0x16b35c[_0x24f641['yiWHT']],_0x52835a,_0x16b35c['后置前'],_0x16b35c[_0x24f641[_0x2cfba8(0x45c,0x502,0x486,0x4ec)]],_0x3e075e[_0x172d20(0xd0,0x2d,-0x7d,-0x60)+_0x172d20(0xc8,0x78,0x8d,0x23)],_0x16b35c[_0x172d20(0xb5,0xf2,0x57,0x113)]][_0x172d20(0xa1,0xc8,0x70,0x1d)](Boolean)[_0x2cfba8(0x53a,0x4db,0x54d,0x491)](',\x20');_0x24f641['ewlNO'](addLog,_0x172d20(-0x2f,0x71,-0x3,-0x3b)+_0x1f5e49);const _0x12f73a={};_0x12f73a[_0x2cfba8(0x4a8,0x4f7,0x4a4,0x538)]=_0x1f5e49;const _0x3ad4be={};_0x3ad4be[_0x172d20(0x85,0x4c,0xf8,0x73)+'t']=0x1,_0x3ad4be['aspectRati'+'o']=_0x222205;const _0x423b33={};_0x423b33[_0x2cfba8(0x53d,0x58b,0x51d,0x5d8)]=[_0x12f73a],_0x423b33[_0x172d20(0x74,0x10f,0xd8,0x18f)]=_0x3ad4be,_0x10fc5e=_0x423b33,addLog(_0x172d20(0xd9,0x7c,0x12c,0xe1)+_0x2cfba8(0x4ae,0x4ed,0x536,0x5a8)+_0x172d20(-0x51,-0x26,0x1,-0x59)+'with\x20promp'+_0x2cfba8(0x44d,0x42e,0x424,0x421)+_0x1f5e49);}}else{_0x480e78=_0x24f641[_0x172d20(0x104,0xae,0x136,0x9e)];let _0x56c8ec;if(_0x2fb1b0[_0x2cfba8(0x3f6,0x4fa,0x43e,0x417)](_0x24f641[_0x172d20(0xb9,0x142,0x13c,0xd4)])){_0x24f641['jkoQa'](addLog,_0x24f641[_0x172d20(-0x8,0x5e,0xb8,0xd3)]);const _0x577f7b=_0x24f641[_0x2cfba8(0x43f,0x406,0x405,0x47b)](_0x5e5ed5,'默认'),_0x8943dc={};_0x8943dc[_0x172d20(0x117,0xe2,0x144,0x8b)+'on']=[],_0x8943dc[_0x172d20(0xab,0x24,0x9c,0x8b)+'t']='',_0x56c8ec=_0x505e69[_0x577f7b]||_0x8943dc,addLog('[Banana]\x20使'+_0x2cfba8(0x4ce,0x569,0x4ac,0x45c)+_0x577f7b+'\x22');}else{const _0x3d10bc={};_0x3d10bc['conversati'+'on']=[],_0x3d10bc[_0x2cfba8(0x39e,0x38b,0x43c,0x4f5)+'t']='',_0x56c8ec=_0x505e69[_0x81e9bd]||_0x3d10bc;}const _0x22e71d=[_0x56c8ec[_0x172d20(-0x1d,0x24,0xa3,0xd4)+'t'],_0x16b35c[_0x172d20(0x58,0x82,0x42,0xd8)],_0x16b35c[_0x24f641[_0x172d20(0x12,0x41,-0x5c,0xa2)]],_0x52835a,_0x16b35c['后置前'],_0x16b35c[_0x24f641['OiGdd']],_0x56c8ec[_0x2cfba8(0x3cb,0x46c,0x445,0x4b2)+_0x172d20(-0x2d,0x78,0x10d,0x9d)],_0x16b35c[_0x24f641[_0x172d20(-0xcf,-0x27,0x56,0x3f)]]][_0x172d20(0x2c,0xc8,0x10a,0x16d)](Boolean)[_0x2cfba8(0x48e,0x5e2,0x54d,0x521)](',\x20');_0x24f641[_0x2cfba8(0x3e9,0x454,0x45c,0x3da)](addLog,'正面提示词:\x20'+_0x22e71d);const _0x111db0={};_0x111db0[_0x2cfba8(0x4df,0x5b0,0x517,0x583)]=_0x172d20(0x117,0x11a,0x1a5,0x109),_0x111db0[_0x2cfba8(0x410,0x42e,0x446,0x43c)]=[];const _0x50adfe={};_0x50adfe['role']=_0x2cfba8(0x44b,0x3bc,0x41c,0x478),_0x50adfe[_0x172d20(-0x81,0x2e,0x14,0xae)]=[];const _0x41b6d2=_0x56c8ec[_0x2cfba8(0x446,0x59e,0x4fa,0x4a2)+'on'][_0x172d20(0x81,0x102,0x74,0x71)](_0x12d2e2=>[_0x111db0,_0x50adfe])[_0x2cfba8(0x537,0x4d5,0x514,0x577)]();let _0x5247cb=0x14c6+0x3*0x36e+-0x1f10;for(const _0xa769af of _0x56c8ec[_0x2cfba8(0x52e,0x583,0x4fa,0x54f)+'on']){if(_0x24f641[_0x172d20(0xec,0xba,0xfb,0x2d)]('uZRvf',_0x24f641['Fxhou']))_0xdb212b=_0x24f641['nnTzJ'](_0x24f641[_0x2cfba8(0x3a9,0x3b1,0x45b,0x3c4)](_0x1d91a1,',\x20'),_0x254d19[_0x172d20(0x54,0x38,0x82,-0x23)+_0x5c1b8d+_0x2cfba8(0x374,0x4a5,0x419,0x3e5)]);else{if(_0xa769af['user']?.[_0x172d20(-0x40,0x39,-0x4d,0x6c)])_0x41b6d2[_0x5247cb][_0x2cfba8(0x4e4,0x444,0x446,0x3b9)][_0x172d20(0x153,0xda,0x102,0x16f)]({'type':_0x24f641[_0x2cfba8(0x3b7,0x3ab,0x442,0x3d9)],'text':_0xa769af['user']['text']});const _0x2ee729=await _0x24f641['Fsyha'](getImageFromTurnData,_0xa769af[_0x172d20(0x7f,0x11a,0x135,0x19e)]);if(_0x2ee729)_0x41b6d2[_0x5247cb]['content']['push']({'type':_0x24f641[_0x2cfba8(0x4ca,0x44e,0x4f5,0x55b)],'image_url':{'url':_0x2ee729}});_0x5247cb++;if(_0xa769af[_0x2cfba8(0x5c1,0x501,0x530,0x555)]?.['text'])_0x41b6d2[_0x5247cb]['content']['push']({'type':_0x24f641[_0x2cfba8(0x4e9,0x41b,0x442,0x49a)],'text':_0xa769af['model'][_0x172d20(-0x35,0x39,0xc7,-0x82)]});const _0x51d7a1=await _0x24f641['BYWtB'](getImageFromTurnData,_0xa769af[_0x2cfba8(0x4d5,0x4e8,0x530,0x4f3)]);if(_0x51d7a1)_0x41b6d2[_0x5247cb][_0x172d20(0xcd,0x2e,0x87,-0x1c)]['push']({'type':_0x24f641[_0x172d20(0x95,0xdd,0x173,0x6b)],'image_url':{'url':_0x51d7a1}});_0x5247cb++;}}if(!_0x2fb1b0[_0x2cfba8(0x41f,0x3a5,0x43e,0x451)](_0x24f641[_0x2cfba8(0x58e,0x5cb,0x55a,0x5fc)])){const _0x449e1a=extension_settings[extensionName]['bananaChar'+_0x2cfba8(0x5c4,0x4c8,0x505,0x48f)+'ts']||{};for(const _0x241d36 in _0x449e1a){if(_0x24f641['hIYYt']!==_0x24f641[_0x172d20(-0xe,0xab,0xea,0x4e)]){const _0x37a3ed=_0x449e1a[_0x241d36],_0x51f6e1=(_0x37a3ed[_0x172d20(0x19b,0xdc,0x139,0x51)]||'')[_0x172d20(0x142,0xbe,0xa,0x34)]('|')['filter'](_0x3386f5=>_0x3386f5[_0x2cfba8(0x4cd,0x3f6,0x418,0x38c)]()!=='');for(const _0x24d83b of _0x51f6e1){if(_0x24f641[_0x172d20(-0x86,0x2,0x2e,0x5)]!==_0x24f641[_0x172d20(-0x44,0x2,0x8,0x94)])_0x178ee6['on'](_0x128504['GENERATE_I'+_0x2cfba8(0x4af,0x541,0x4cb,0x574)+'ST'],_0x269e79),_0x23f0e0['on'](_0x24f641[_0x172d20(0x8a,0x5b,0xe0,0x118)],_0x2162fc),_0x24f641[_0x172d20(0x93,0xe9,0x40,0x17f)](_0x5a9961,_0x24f641[_0x2cfba8(0x450,0x455,0x3fa,0x3f5)]);else{if(_0x22e71d['toLowerCas'+'e']()[_0x172d20(0x31,0x26,0xd1,-0x21)](_0x24d83b[_0x2cfba8(0x4e2,0x409,0x455,0x415)+'e']())){if(_0x24f641['YEWWj']!==_0x24f641[_0x2cfba8(0x483,0x435,0x426,0x398)]){const _0x2664dd={};_0x2664dd['url']=_0x5a8820;const _0x260435={};_0x260435[_0x172d20(0xb0,0x70,-0x3,-0x3d)]=_0x24f641[_0x2cfba8(0x488,0x574,0x4f5,0x53e)],_0x260435['image_url']=_0x2664dd,_0x5d7001[_0x172d20(0x120,0xda,0xb1,0x113)](_0x260435),_0x24f641[_0x172d20(0x99,0xbf,0x149,0x9f)](_0x188726,_0x172d20(0x66,0x8b,0xf9,0x12f)+_0x172d20(-0x36,0x1f,-0x1d,0x8)+_0x172d20(0x9a,0xa7,0x165,0x13f));}else{_0x24f641[_0x2cfba8(0x519,0x546,0x544,0x4c7)](addLog,'[Banana]\x20F'+'ound\x20match'+_0x2cfba8(0x546,0x4af,0x4d0,0x524)+'r\x20\x22'+_0x24d83b+(_0x172d20(0x3a,0xa8,0x2,0x73)+_0x2cfba8(0x45f,0x3be,0x46a,0x43b))+_0x241d36+'\x22.');const _0x29988c=_0x37a3ed['conversati'+'on'];if(_0x29988c){const _0x138510=[];if(_0x29988c['user']&&_0x29988c[_0x172d20(0x9d,0x11a,0xb6,0xa6)][_0x172d20(-0x41,0x39,-0x2b,0xe)])_0x138510[_0x2cfba8(0x44b,0x53c,0x4f2,0x4e4)]({'type':_0x24f641[_0x2cfba8(0x4d9,0x4a7,0x442,0x403)],'text':_0x29988c[_0x172d20(0x1ca,0x11a,0x12c,0xb5)][_0x172d20(0xb7,0x39,-0x38,0xf6)]});const _0x1f5904=await getImageFromTurnData(_0x29988c[_0x2cfba8(0x56e,0x556,0x532,0x543)]);if(_0x1f5904)_0x138510[_0x2cfba8(0x440,0x47d,0x4f2,0x538)]({'type':_0x24f641['KNxfv'],'image_url':{'url':_0x1f5904}});if(_0x24f641[_0x2cfba8(0x48b,0x3da,0x3fc,0x3b9)](_0x138510['length'],-0x1b4a+-0x205a+0x3ba4)){const _0x52fb60={};_0x52fb60['role']=_0x24f641[_0x2cfba8(0x434,0x395,0x43b,0x482)],_0x52fb60['content']=_0x138510,_0x41b6d2[_0x2cfba8(0x513,0x569,0x4f2,0x574)](_0x52fb60);}const _0x16a8ec=[];if(_0x29988c['model']&&_0x29988c[_0x2cfba8(0x53c,0x576,0x530,0x5b5)][_0x172d20(-0x18,0x39,-0x2e,0x1c)])_0x16a8ec['push']({'type':_0x24f641[_0x172d20(-0x37,0x2a,-0x1d,-0x3c)],'text':_0x29988c['model'][_0x2cfba8(0x4f0,0x3d6,0x451,0x4e3)]});const _0x49c40e=await _0x24f641['qAxOI'](getImageFromTurnData,_0x29988c[_0x2cfba8(0x479,0x4e3,0x530,0x50b)]);if(_0x49c40e)_0x16a8ec[_0x2cfba8(0x522,0x592,0x4f2,0x52c)]({'type':_0x24f641[_0x2cfba8(0x51e,0x572,0x4f5,0x4dc)],'image_url':{'url':_0x49c40e}});if(_0x16a8ec['length']>-0xd7b+0x4*0x18+-0x37*-0x3d){const _0x4d6344={};_0x4d6344[_0x172d20(0xde,0xff,0x187,0x56)]=_0x24f641[_0x2cfba8(0x49a,0x3bc,0x432,0x4c1)],_0x4d6344[_0x2cfba8(0x505,0x4ce,0x446,0x4d9)]=_0x16a8ec,_0x41b6d2['push'](_0x4d6344);}}break;}}}}}else{const _0x7f6186={};_0x7f6186[_0x172d20(0x1c,0x70,0x70,0xbd)]=_0x24f641[_0x2cfba8(0x408,0x3ec,0x442,0x49f)],_0x7f6186[_0x2cfba8(0x4cf,0x3f0,0x451,0x44d)]=_0x35a06;const _0x179558={};_0x179558[_0x172d20(0x120,0xff,0xc3,0xd0)]=_0x172d20(0x66,0x11a,0xfb,0x13e),_0x179558[_0x2cfba8(0x4aa,0x39b,0x446,0x4c2)]=[_0x7f6186],_0x48ee41['push'](_0x179558);}}}if(!_0x2fb1b0[_0x172d20(0x23,0x26,0xd6,0xd7)]('{修图}')){if(_0x24f641[_0x2cfba8(0x589,0x463,0x4ee,0x597)](_0x24f641['aLSvf'],_0x24f641[_0x2cfba8(0x505,0x3d5,0x491,0x4ad)])){const _0x43566f={};_0x43566f[_0x2cfba8(0x43f,0x4c2,0x4fa,0x548)+'on']=[],_0x43566f[_0x172d20(0x4c,0x24,0x33,0x3b)+'t']='',_0x348414=_0x1f00ee[_0x2b4f39]||_0x43566f;}else{const _0x301048={};_0x301048[_0x172d20(0x129,0x70,0x12d,0xde)]=_0x172d20(-0x14,0x39,0xcc,-0x1e),_0x301048['text']=_0x22e71d;const _0x4aa942={};_0x4aa942['role']='user',_0x4aa942[_0x172d20(0xe6,0x2e,0x95,-0x88)]=[_0x301048],_0x41b6d2[_0x172d20(0xe1,0xda,0x3d,0x36)](_0x4aa942);}}else{const _0x434c45=[],_0x433420=_0x31236b||_0x22e71d,_0x614dcd=[_0x56c8ec[_0x172d20(-0x5a,0x24,0xa3,0x91)+'t'],_0x433420,_0x56c8ec[_0x2cfba8(0x4ba,0x4bb,0x445,0x4ef)+'mpt']][_0x2cfba8(0x490,0x56f,0x4e0,0x573)](Boolean)[_0x172d20(0x9b,0x135,0xe3,0x1bc)](',\x20'),_0x12a715={};_0x12a715[_0x2cfba8(0x422,0x4dd,0x488,0x407)]=_0x24f641[_0x172d20(-0x88,0x2a,0x5e,-0x31)],_0x12a715[_0x2cfba8(0x417,0x4d5,0x451,0x480)]=_0x614dcd,_0x434c45[_0x2cfba8(0x4d8,0x55a,0x4f2,0x4fa)](_0x12a715);if(_0x338a3e){const _0x20cc8d={};_0x20cc8d[_0x172d20(0x71,0x113,0x111,0x1c0)]=_0x338a3e;const _0x86bc6d={};_0x86bc6d[_0x172d20(0x30,0x70,0x78,0x3e)]=_0x24f641['KNxfv'],_0x86bc6d['image_url']=_0x20cc8d,_0x434c45['push'](_0x86bc6d),_0x24f641['RvHOa'](addLog,_0x2cfba8(0x3f9,0x445,0x4a3,0x4f3)+_0x172d20(0x63,0x1f,-0x9b,0xb4)+'的图片');}const _0x21636a={};_0x21636a[_0x2cfba8(0x4c6,0x497,0x517,0x4d5)]=_0x24f641[_0x2cfba8(0x4a1,0x4fa,0x43b,0x424)],_0x21636a[_0x2cfba8(0x422,0x469,0x446,0x3eb)]=_0x434c45,_0x41b6d2['push'](_0x21636a),addLog(_0x172d20(0xbf,0x8b,0xab,0x12b)+_0x2cfba8(0x4b4,0x497,0x427,0x471)+_0x614dcd);}const _0x44c4f6={};_0x44c4f6[_0x2cfba8(0x4e8,0x485,0x4bc,0x54b)+'o']=_0x222205;const _0x1fe964={};_0x1fe964[_0x2cfba8(0x3f2,0x385,0x40c,0x40c)+'g']=_0x44c4f6,_0x10fc5e={'model':_0x488a8c,'messages':_0x41b6d2['filter'](_0x55ca1b=>_0x55ca1b[_0x2cfba8(0x482,0x4e7,0x446,0x4b1)][_0x172d20(-0x36,0x6b,-0x39,0xfd)]>0x1*0x3fb+-0x52c+0x5*0x3d),'config':_0x1fe964},_0x24f641[_0x2cfba8(0x405,0x526,0x4b1,0x483)](addLog,_0x172d20(0x7d,0x7c,0x10a,0x3d)+_0x172d20(-0x2e,0x75,0xe7,-0x15)+_0x2cfba8(0x527,0x492,0x4f7,0x59f)+_0x2cfba8(0x47a,0x43a,0x493,0x4d8)+_0x10fc5e[_0x2cfba8(0x4ac,0x3a4,0x412,0x3c4)]['length']+'\x20messages.');}let _0x36c2ca=_0x46c359[_0x2cfba8(0x563,0x555,0x564,0x616)](/\/$/,''),_0x11c96a;_0x36c2ca[_0x2cfba8(0x56b,0x60f,0x558,0x4e4)](_0x172d20(0xba,0x103,0x143,0x17c))||_0x36c2ca['includes'](_0x24f641[_0x172d20(0xff,0x120,0xbc,0x180)])?_0x11c96a=_0x36c2ca+_0x480e78:_0x11c96a=_0x24f641['iqQOO'](_0x24f641[_0x172d20(0x5d,0x4b,0x83,-0x22)](_0x36c2ca,_0x24f641[_0x2cfba8(0x4d9,0x451,0x4f3,0x4fc)]),_0x480e78);_0x11c96a=_0x11c96a['replace'](/\/v1\/v1\//g,_0x24f641[_0x2cfba8(0x58f,0x57a,0x538,0x495)]);const _0x55a617=extension_settings[extensionName][_0x172d20(0x177,0x106,0xef,0x74)];let _0x5f51bf,_0x52c8c7,_0x3502df;if(_0x24f641[_0x172d20(0x110,0x109,0xd6,0x126)](_0x55a617,_0x24f641[_0x2cfba8(0x4ce,0x40c,0x414,0x445)])){let _0x545e0a=_0x36c2ca;!_0x545e0a['endsWith'](_0x24f641[_0x172d20(0xce,0xdb,0x137,0x160)])&&!_0x545e0a[_0x172d20(0x64,0x26,-0x43,-0x5e)](_0x24f641[_0x172d20(0x16d,0x120,0x84,0x1b2)])&&(_0x545e0a=_0x545e0a+_0x24f641[_0x2cfba8(0x584,0x4bd,0x4f3,0x569)]);_0x545e0a=_0x545e0a[_0x172d20(0x11d,0x14c,0x115,0xb9)](/\/v1\/$/,_0x2cfba8(0x49d,0x4f2,0x51b,0x493)),_0x5f51bf=_0x24f641[_0x172d20(0x55,0x34,-0x15,0x67)],_0x52c8c7=getRequestHeaders(window[_0x172d20(0x16c,0x104,0xf4,0x184)]);const _0x378940={};_0x378940[_0x2cfba8(0x442,0x3a9,0x429,0x403)+_0x2cfba8(0x44f,0x456,0x506,0x44b)+'ce']=_0x2cfba8(0x494,0x578,0x4e6,0x46c),_0x378940['custom_url']=_0x545e0a,_0x378940[_0x2cfba8(0x608,0x54a,0x552,0x4f6)+_0x172d20(0x196,0xf9,0x113,0x172)+'rs']=_0x172d20(0x33,0x7f,0x97,0x3)+'ion:\x20\x22Bear'+_0x2cfba8(0x579,0x5eb,0x551,0x4ab)+_0x265645+'\x22',_0x378940[_0x2cfba8(0x52b,0x538,0x530,0x5c0)]=_0x488a8c,_0x378940[_0x2cfba8(0x425,0x399,0x412,0x36e)]=_0x10fc5e[_0x2cfba8(0x3f0,0x454,0x412,0x35d)],_0x378940[_0x172d20(0x10a,0x66,0x107,0xaf)]=![],_0x3502df=_0x378940;if(_0x488a8c[_0x172d20(0x40,0x1c,0xa,0xc9)](_0x24f641[_0x2cfba8(0x3f4,0x417,0x413,0x428)])){if(_0x24f641[_0x172d20(0x108,0xc5,0xd8,0x39)](_0x24f641[_0x172d20(-0x6,0x51,-0x3c,0x83)],_0x2cfba8(0x451,0x416,0x45f,0x453))){_0x24f641[_0x2cfba8(0x567,0x427,0x4d5,0x559)](addLog,_0x2cfba8(0x518,0x4ec,0x52c,0x4e0)+_0x2cfba8(0x436,0x4e9,0x4aa,0x3f2)+_0x2cfba8(0x461,0x48c,0x480,0x53c)+_0x172d20(0x117,0xb0,-0x1,0x2a)),_0x5f51bf=_0x11c96a;const _0x2a105d={};_0x2a105d[_0x172d20(0x2e,0xcf,0xce,0x17d)+'pe']=_0x2cfba8(0x556,0x4b2,0x4b7,0x3f8)+_0x2cfba8(0x4ab,0x467,0x4e2,0x498),_0x2a105d[_0x172d20(0x139,0x7f,0x92,0xac)+_0x2cfba8(0x37f,0x3b2,0x431,0x396)]=_0x2cfba8(0x4ff,0x581,0x4d9,0x518)+_0x265645,_0x52c8c7=_0x2a105d,_0x3502df=_0x10fc5e;}else{let _0x354c83=_0x23a39e;!_0x354c83[_0x2cfba8(0x50f,0x5d1,0x558,0x583)](_0x24f641[_0x2cfba8(0x471,0x4fe,0x4f3,0x484)])&&!_0x354c83[_0x2cfba8(0x39b,0x380,0x43e,0x3dd)](_0x24f641['tXmtZ'])&&(_0x354c83=_0x24f641[_0x2cfba8(0x39f,0x4e7,0x45b,0x477)](_0x354c83,_0x24f641[_0x172d20(0x158,0xdb,0x57,0xff)]));_0x354c83=_0x354c83['replace'](/\/v1\/$/,_0x24f641['xfJGv']),_0x22652b=_0x24f641['LmHww'],_0x4c02e0=_0x1772d9(_0x1e922b[_0x2cfba8(0x544,0x52d,0x51c,0x491)]);const _0x213293={};_0x213293[_0x2cfba8(0x3e8,0x469,0x429,0x4af)+'etion_sour'+'ce']=_0x24f641['WgHNk'],_0x213293[_0x172d20(0x10a,0x83,-0x5,0xa6)]=_0x354c83,_0x213293[_0x2cfba8(0x49a,0x541,0x552,0x510)+'lude_heade'+'rs']='Authorizat'+'ion:\x20\x22Bear'+_0x172d20(0x1db,0x139,0x165,0xfe)+_0x21d172+'\x22',_0x213293['model']=_0x2c1152,_0x213293[_0x2cfba8(0x462,0x41a,0x412,0x366)]=_0x5a4df7[_0x172d20(-0x54,-0x6,-0x4,-0x48)],_0x213293[_0x172d20(0x64,0x66,0xf2,0xfa)]=![],_0x26db39=_0x213293;if(_0x3414b4['startsWith'](_0x24f641[_0x172d20(0xb9,-0x5,-0x89,-0x23)])){_0x24f641[_0x172d20(0x104,0xaf,0xdf,0xbe)](_0x17e57a,_0x2cfba8(0x4c8,0x50b,0x52c,0x500)+_0x2cfba8(0x408,0x4f2,0x4aa,0x46e)+'持酒馆代理，切换为直'+_0x2cfba8(0x4f9,0x54c,0x4c8,0x43b)),_0x23a793=_0x3df2c9;const _0x251646={};_0x251646['Content-Ty'+'pe']=_0x172d20(0x14a,0x9f,0xe5,0xeb)+_0x172d20(0xf2,0xca,0x86,0x158),_0x251646[_0x2cfba8(0x436,0x496,0x497,0x4b1)+_0x172d20(-0x16,0x19,-0x64,0x63)]=_0x172d20(0xd7,0xc1,0xb8,0xff)+_0x5f1d60,_0x42235b=_0x251646,_0x32c47a=_0xbbf4ae;}_0x24f641['NNnVl'](_0x4c8671,_0x2cfba8(0x495,0x42f,0x46f,0x491)+_0x2cfba8(0x553,0x559,0x54a,0x5cb));}}_0x24f641['DLSXM'](addLog,_0x2cfba8(0x4af,0x402,0x46f,0x409)+_0x172d20(0x98,0x132,0x90,0xda));}else{_0x5f51bf=_0x11c96a;const _0x4a83c7={};_0x4a83c7[_0x172d20(0xaa,0xcf,0x27,0xeb)+'pe']=_0x24f641['alFtv'],_0x4a83c7[_0x172d20(0xd8,0x7f,0x11f,-0x2c)+_0x172d20(-0x49,0x19,-0x27,0x5c)]='Bearer\x20'+_0x265645,_0x52c8c7=_0x4a83c7,_0x3502df=_0x10fc5e,_0x24f641[_0x2cfba8(0x41a,0x543,0x48a,0x454)](addLog,_0x172d20(-0x54,0x57,0xfb,0xc5)+'用直接请求模式');}_0x24f641['VFSXq'](addLog,_0x172d20(-0x1,0x32,0x7a,0x8e)+_0x2cfba8(0x4c4,0x446,0x433,0x42f)+_0x172d20(-0x7,-0xa,-0xa7,-0x31)+_0x5f51bf),_0x24f641[_0x2cfba8(0x468,0x462,0x4bd,0x55d)](addLog,'[Banana]\x20P'+_0x2cfba8(0x4e5,0x5d6,0x545,0x4a5)+JSON[_0x2cfba8(0x49b,0x3df,0x3f7,0x35e)](_0x3502df,null,-0x1d*0x5b+-0x8d*0x2b+0x110*0x20));try{taskQueue[_0x2cfba8(0x47a,0x508,0x48e,0x53a)+'us'](_0x52973c,_0x2cfba8(0x56a,0x4ed,0x4cf,0x497));const _0x128346=await fetch(_0x5f51bf,{'method':_0x172d20(0xb1,0xfb,0x114,0x7f),'headers':_0x52c8c7,'body':JSON[_0x172d20(0x96,-0x21,0x71,-0x1a)](_0x3502df)});if(!_0x128346['ok']){const _0x59a890=await _0x128346[_0x172d20(0xeb,0x39,-0x57,-0x1e)]();throw new Error(_0x172d20(0x1a6,0x107,0xc9,0x1ac)+_0x2cfba8(0x3c8,0x423,0x44f,0x451)+'ith\x20status'+'\x20'+_0x128346[_0x172d20(0x113,0x146,0x1ac,0xf5)]+':\x20'+_0x59a890);}const _0x47ecdb=await _0x128346[_0x2cfba8(0x46e,0x45b,0x4af,0x42b)]();let _0x27005d='';const _0x3c1deb=_0x47ecdb[_0x2cfba8(0x4c0,0x4eb,0x46b,0x47d)];if(_0x3c1deb&&_0x24f641[_0x172d20(0xbb,0xc0,0x10e,0x118)](_0x3c1deb[_0x2cfba8(0x409,0x45b,0x483,0x4af)],0x139f*-0x1+-0xb15+0x1eb4)){const _0x503a76=_0x3c1deb[0x1*0xaf2+0x5*0x70a+-0x2e24][_0x172d20(0xb4,0x69,0x34,0x127)]?.[_0x2cfba8(0x40f,0x43f,0x446,0x3d5)];if(Array[_0x2cfba8(0x553,0x56e,0x53a,0x4ba)](_0x503a76)){if(_0x24f641[_0x2cfba8(0x51a,0x59d,0x529,0x5ab)]===_0x24f641[_0x172d20(0x1f0,0x14e,0xfd,0x111)]){const _0x9163a1=_0x2708fb?function(){if(_0x263b2b){const _0x2c0358=_0x30c71c['apply'](_0x2f9ff9,arguments);return _0x27da5a=null,_0x2c0358;}}:function(){};return _0x45127c=![],_0x9163a1;}else for(const _0x51261f of _0x503a76){if(_0x24f641[_0x172d20(0x115,0xe0,0x127,0xdf)](_0x51261f[_0x2cfba8(0x418,0x4ee,0x488,0x50c)],_0x24f641['KNxfv'])&&_0x51261f[_0x172d20(0xfb,0x129,0x181,0xce)]?.['url']){_0x27005d=_0x51261f[_0x2cfba8(0x541,0x487,0x541,0x57a)][_0x2cfba8(0x583,0x587,0x52b,0x500)];break;}}}else{if(_0x24f641[_0x2cfba8(0x43a,0x40e,0x49f,0x406)](typeof _0x503a76,_0x24f641['JMfyU'])){if(_0x24f641[_0x2cfba8(0x4ee,0x52c,0x4dc,0x4aa)](_0x24f641[_0x172d20(-0x43,-0x28,0x6d,0x5d)],'HZRoF')){const _0x26c266=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x2d7747=_0x503a76[_0x172d20(0x83,0x12e,0xd7,0xbe)](_0x26c266);if(_0x2d7747&&_0x2d7747[-0x6a*0x1f+-0x1c*-0x68+0x177*0x1]){addLog(_0x172d20(0x16d,0x11d,0xb4,0xbb)+_0x172d20(0xc6,0x13e,0x1e9,0x19f)+'rkdown\x20ima'+_0x2cfba8(0x4ca,0x44f,0x440,0x3bd)+_0x172d20(0x12e,0xcc,0x145,0x18)+_0x172d20(-0x28,-0x2a,-0x29,0x12));const _0x1fe279=_0x2d7747[0x56a+0xedb+-0x2*0xa22];_0x24f641['fNWFK'](addLog,_0x172d20(0x7c,0x46,0x24,0x53)+'arkdown\x20im'+'age\x20URL:\x20'+_0x1fe279);try{if(_0x24f641['iIqPg'](_0x24f641[_0x172d20(0x18a,0x119,0x12c,0xd5)],_0x172d20(0x12,0xb5,0x11f,0x16e))){const _0x24618a=await _0x24f641['VFSXq'](fetch,_0x1fe279);if(!_0x24618a['ok'])throw new Error(_0x2cfba8(0x5b2,0x52e,0x502,0x4b6)+'fetch\x20imag'+'e:\x20'+_0x24618a['status']);const _0x4fc828=await _0x24618a['blob'](),_0x55994a=await new Promise((_0x227147,_0x1e14e3)=>{const _0x401607=new FileReader();function _0x25edcb(_0x4628da,_0x67f75,_0x2158b7,_0x4c6c09){return _0x172d20(_0x2158b7,_0x4628da-0x414,_0x2158b7-0x3f,_0x4c6c09-0x10c);}_0x401607[_0x499c9f(0x1b0,0x22a,0x24a,0x1fd)]=()=>_0x227147(_0x401607[_0x499c9f(0x134,0xcd,0x98,0x18c)]),_0x401607[_0x499c9f(0x28c,0x1ef,0x183,0x244)]=_0x1e14e3;function _0x499c9f(_0x2e7a37,_0x4ea2f8,_0x5070e4,_0x215575){return _0x172d20(_0x2e7a37,_0x4ea2f8-0xfa,_0x5070e4-0x139,_0x215575-0xa2);}_0x401607[_0x499c9f(0x23f,0x202,0x157,0x1da)+_0x499c9f(0x270,0x211,0x199,0x192)](_0x4fc828);});_0x27005d=_0x55994a,_0x24f641[_0x172d20(0x84,0xd5,0x36,0x169)](addLog,_0x24f641[_0x2cfba8(0x5b7,0x469,0x4f9,0x549)]);}else _0x2893c6[_0x172d20(0xaf,0x11c,0x144,0x118)+'sk'](_0x4ee93d,![]);}catch(_0x51673c){addLog(_0x172d20(0xf,-0x22,0x8b,-0x87)+_0x2cfba8(0x37b,0x3b5,0x3fe,0x4a5)+_0x172d20(0x163,0xac,0x9e,0xc6)+_0x172d20(-0x79,-0x1b,-0xb5,-0x1)+'\x20'+_0x51673c[_0x172d20(0x115,0x69,-0x4f,0x7f)]),_0x27005d=_0x1fe279,_0x24f641['heXzY'](addLog,_0x24f641[_0x2cfba8(0x525,0x593,0x509,0x4a9)]);}}else{if(_0x24f641['Hzslu'](_0x24f641[_0x172d20(0x94,0x45,-0x15,0x1a)],_0x24f641[_0x172d20(0xc3,0x128,0x83,0x139)]))throw new _0x5544fc(_0x24f641[_0x172d20(0x152,0x13d,0xd3,0x1f6)]);else _0x24f641['LwvMY'](addLog,_0x24f641[_0x172d20(0x62,0xb6,0x7e,0x96)]);}}else{if(_0x4018c7){const _0x12502c=_0x5f1d85['apply'](_0x26bdde,arguments);return _0x59f19d=null,_0x12502c;}}}}}if(!_0x27005d)throw new Error(_0x2cfba8(0x3a5,0x49e,0x430,0x3c3)+_0x172d20(0x7d,0xc2,0x172,0x14c)+_0x172d20(0x16c,0x115,0x16e,0x195)+_0x2cfba8(0x4fe,0x567,0x4d1,0x446)+_0x172d20(0x121,0x98,0x6a,0xd4)+'t');return _0x24f641[_0x172d20(0x4d,0x4e,0xfd,0x2d)](addLog,_0x24f641[_0x172d20(0x8,0x2c,-0x54,-0x41)]),taskQueue[_0x172d20(0x1c3,0x11c,0x18a,0xc0)+'sk'](_0x52973c,!![]),currentTaskId=null,{'image':_0x27005d,'change':_0x24f641['PTQTJ'](_0x4b1e3b,'')};}catch(_0x5b8c62){if(_0x24f641[_0x2cfba8(0x4ad,0x3da,0x44d,0x47d)](_0x24f641['ARkBW'],_0x24f641[_0x172d20(0x119,0xeb,0x148,0xb9)]))return _0x19967e[_0x2cfba8(0x4c7,0x4b1,0x4a0,0x432)];else{const _0x22efc7=_0x24f641['pSxvM'][_0x172d20(0x57,0xbe,0x14e,0x21)]('|');let _0x1eee7c=0x1617+-0x1f7b+0x964;while(!![]){switch(_0x22efc7[_0x1eee7c++]){case'0':currentTaskId=null;continue;case'1':if(_0x24f641['TTDGA'](_0x5b8c62[_0x172d20(-0x52,0x69,-0x14,0x64)],_0x24f641[_0x2cfba8(0x36e,0x418,0x409,0x4c4)])){}else taskQueue[_0x2cfba8(0x59a,0x5c8,0x534,0x597)+'sk'](_0x52973c,![]);continue;case'2':throw _0x5b8c62;continue;case'3':_0x24f641[_0x172d20(0x16,0x6,0x46,0xc1)](addLog,'[Banana]\x20F'+_0x172d20(0x1a7,0xe8,0x193,0x127)+':\x20'+_0x5b8c62[_0x2cfba8(0x3c3,0x4b3,0x481,0x40b)]);continue;case'4':console[_0x172d20(0x5e,0x7d,0x21,0x6)](_0x24f641[_0x2cfba8(0x4a6,0x3c8,0x401,0x420)],_0x5b8c62);continue;}break;}}}}export async function bananaGenerate(_0x4cebaf){function _0x38ca84(_0x136035,_0x1de4d1,_0x446ca3,_0x6ce5da){return _0x35d8(_0x1de4d1-0x2df,_0x446ca3);}const _0x291134={'TeNnf':function(_0x449973,_0x1eb0f0){return _0x449973+_0x1eb0f0;},'nUbrS':function(_0x348fae){return _0x348fae();},'TMNcd':_0x38ca84(0x549,0x566,0x604,0x53d),'yaVQL':function(_0x2da2b6,_0x20c7c3){return _0x2da2b6(_0x20c7c3);},'mAqOO':function(_0x562426,_0x32884f){return _0x562426!==_0x32884f;},'TrftI':'hsatn','RzFre':_0x40630b(0x547,0x516,0x56e,0x53e),'bhmJV':_0x38ca84(0x5a0,0x55d,0x607,0x559),'ZxtvK':function(_0x37e1d0,_0x46f3d2){return _0x37e1d0(_0x46f3d2);},'KkyxM':function(_0x3aff5b,_0x3d72a4){return _0x3aff5b(_0x3d72a4);},'pPaEA':function(_0x4d172d,_0x292293){return _0x4d172d(_0x292293);},'WKCOR':function(_0x1bd945,_0x30615d){return _0x1bd945!=_0x30615d;},'ulicu':function(_0x2496e2,_0xd99a1a,_0x2c0a2c,_0x5d3008){return _0x2496e2(_0xd99a1a,_0x2c0a2c,_0x5d3008);},'XVzxk':_0x40630b(0x5b0,0x5bf,0x545,0x546),'tAMlJ':_0x38ca84(0x4fd,0x49e,0x47c,0x4eb),'fXGnM':function(_0x1ac6f2,_0x5372d5){return _0x1ac6f2(_0x5372d5);},'PaHsy':_0x38ca84(0x441,0x4c7,0x529,0x4d0),'YOICM':_0x40630b(0x5e6,0x549,0x52b,0x576),'yjwOy':_0x40630b(0x3c9,0x38d,0x407,0x446)};_0x291134[_0x40630b(0x40c,0x3a4,0x450,0x495)](clearLog);let {id:_0x16e87b,prompt:_0x4d2dda,width:_0x1d6e4d,height:_0x1d0281,change:_0x200fdc,retouchPrompt:_0x5af139,retouchImage:_0x470b74}=_0x4cebaf;currentRequestId=_0x16e87b,currentPrompt=_0x4d2dda;function _0x40630b(_0x34a4fe,_0x84f76b,_0x4e922d,_0x1b1eb6){return _0x35d8(_0x4e922d-0x29b,_0x84f76b);}_0x291134[_0x38ca84(0x522,0x4b9,0x4c3,0x52a)](addLog,_0x38ca84(0x4c6,0x504,0x595,0x599)+_0x38ca84(0x4a1,0x4f1,0x4e7,0x4b1)+_0x40630b(0x4b5,0x46d,0x40d,0x3f4)+'tion\x20reque'+'st\x20(ID:\x20'+_0x16e87b+')');let _0x3b089e='';if(_0x200fdc){if(_0x291134[_0x40630b(0x44e,0x4c6,0x474,0x4fb)](_0x291134['TrftI'],_0x40630b(0x46f,0x40d,0x46e,0x4b9)))_0x3b089e=_0x200fdc[_0x40630b(0x3d6,0x3d1,0x45f,0x510)](_0x40630b(0x57b,0x4e5,0x519,0x4fb),'');else{const _0x419f29=_0x5bbca4['apply'](_0x479bd6,arguments);return _0x57f632=null,_0x419f29;}}else _0x291134[_0x40630b(0x4a5,0x4f5,0x474,0x4bc)](_0x291134['RzFre'],'QQATZ')?_0x1e7b95=_0x291134['TeNnf'](_0x321e3,_0x33725c):_0x3b089e=_0x4d2dda;if(_0x200fdc&&_0x200fdc[_0x40630b(0x4da,0x440,0x445,0x45f)](_0x291134[_0x40630b(0x4cd,0x589,0x567,0x5c6)])){_0x291134[_0x40630b(0x53d,0x5df,0x56c,0x616)](addLog,'Banana修图模式'+'启动');if(_0x5af139)_0x291134['KkyxM'](addLog,'修图指令:\x20'+_0x5af139);if(_0x470b74)_0x291134[_0x40630b(0x3f2,0x540,0x482,0x47b)](addLog,_0x40630b(0x4a3,0x4bd,0x4c8,0x42a)+']');}try{const {image:_0xdec7ef,change:_0x3bb8fa}=await _0x291134['pPaEA'](generateBananaImage,{'prompt':_0x4d2dda,'width':_0x1d6e4d,'height':_0x1d0281,'change':_0x200fdc,'retouchPrompt':_0x5af139,'retouchImage':_0x470b74});if(_0x291134['WKCOR'](extension_settings[extensionName]['cache'],'0')){const _0x12c018={};_0x12c018['change']=_0x3b089e,await _0x291134[_0x40630b(0x4c1,0x4c5,0x4ef,0x52f)](setItemImg,_0x4d2dda,_0xdec7ef,_0x12c018),addLog(_0x38ca84(0x5a7,0x58d,0x504,0x604)+_0x40630b(0x3d8,0x499,0x480,0x4e2)+'\x20'+_0x4d2dda),extension_settings[extensionName][_0x38ca84(0x4ae,0x461,0x4bf,0x424)]['cishu']?_0x291134[_0x38ca84(0x504,0x4b8,0x480,0x566)](_0x291134[_0x38ca84(0x5dc,0x588,0x639,0x522)],_0x291134['tAMlJ'])?(extension_settings[extensionName]['banana']['cishu']=extension_settings[extensionName][_0x40630b(0x361,0x4c7,0x41d,0x3db)][_0x40630b(0x608,0x5a5,0x552,0x56d)]+(0x3*-0x844+-0x18*0x183+0x1*0x3d15),_0x291134[_0x38ca84(0x4ed,0x5a2,0x618,0x5c1)](addLog,_0x40630b(0x48f,0x402,0x414,0x362)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x38ca84(0x3d1,0x461,0x518,0x51f)][_0x40630b(0x602,0x55e,0x552,0x51a)])):(!_0x23e6bd[_0x40630b(0x36f,0x412,0x3f4,0x3ca)+_0x38ca84(0x4ba,0x476,0x483,0x421)+_0x38ca84(0x4e2,0x4e3,0x49a,0x4b0)]&&(_0x811dc4[_0x40630b(0x48b,0x3c7,0x3f4,0x43e)+_0x38ca84(0x494,0x476,0x4e0,0x4bb)+_0x38ca84(0x478,0x4e3,0x558,0x463)]=!![],_0x16e33f()),_0x291134['nUbrS'](_0x488884)):_0x291134['PaHsy']===_0x291134[_0x40630b(0x4af,0x40e,0x4b2,0x543)]?(extension_settings[extensionName][_0x40630b(0x3a2,0x36d,0x41d,0x4c2)][_0x40630b(0x4d5,0x580,0x552,0x52d)]=-0x882+0x8*-0xc5+0x1*0xeab,_0x291134['yaVQL'](addLog,'当前生图次数为\x20fo'+_0x40630b(0x542,0x438,0x48c,0x46c)+extension_settings[extensionName][_0x40630b(0x3cc,0x35e,0x41d,0x4bc)]['cishu'])):_0x59a881=_0x291134[_0x38ca84(0x4eb,0x4d6,0x49f,0x56f)](_0x3c609a+_0x291134[_0x40630b(0x436,0x560,0x4b5,0x446)],_0xbc764c);}else _0x291134[_0x38ca84(0x511,0x4b8,0x569,0x4d1)](_0x291134[_0x38ca84(0x653,0x5a8,0x5db,0x617)],_0x291134[_0x38ca84(0x54e,0x563,0x61a,0x5f4)])?_0x291134[_0x38ca84(0x53c,0x5b0,0x54e,0x5c4)](addLog,'缓存设置为不存入数据'+'库'):_0x41f336[_0x40630b(0x420,0x3f1,0x457,0x4d6)+_0x49d361+_0x40630b(0x490,0x443,0x420,0x456)]&&(_0x2e0e0e=_0x291134['TeNnf'](_0x291134[_0x38ca84(0x477,0x4d6,0x549,0x572)](_0x1f02e9,',\x20'),_0x28999e[_0x38ca84(0x53e,0x49b,0x4d9,0x4ec)+_0xb16535+_0x40630b(0x3bf,0x3bc,0x420,0x3e1)]));const _0x38aaa1={};_0x38aaa1['id']=_0x16e87b,_0x38aaa1[_0x38ca84(0x49e,0x53a,0x482,0x5a9)]=!![],_0x38aaa1[_0x40630b(0x59a,0x55a,0x560,0x615)]=_0xdec7ef,_0x38aaa1[_0x38ca84(0x442,0x4ef,0x585,0x450)]=_0x4d2dda,_0x38aaa1['change']=_0x3b089e,eventSource[_0x40630b(0x5c9,0x53e,0x517,0x56f)](EventType[_0x38ca84(0x57f,0x535,0x4c7,0x4d4)+_0x40630b(0x515,0x4a4,0x55a,0x4f9)+_0x40630b(0x4a8,0x46e,0x441,0x3d4)],_0x38aaa1),addLog(_0x40630b(0x3ca,0x3fe,0x40b,0x46a)+_0x40630b(0x5b0,0x495,0x543,0x53b)+_0x38ca84(0x42b,0x4a1,0x4e6,0x496)+_0x40630b(0x40d,0x570,0x4bb,0x47e)+':\x20'+_0x16e87b);}catch(_0x3def71){const _0x301dc2=_0x40630b(0x550,0x506,0x546,0x5cd)+_0x40630b(0x402,0x422,0x3f1,0x3de)+'failed\x20for'+_0x40630b(0x481,0x337,0x3f3,0x40d)+_0x16e87b+':\x20'+_0x3def71[_0x38ca84(0x581,0x4cc,0x4a4,0x491)];_0x291134[_0x38ca84(0x44f,0x4b9,0x441,0x404)](addLog,_0x301dc2),console[_0x38ca84(0x563,0x4e0,0x4cb,0x43f)](_0x301dc2);const _0xe087eb={};_0xe087eb['id']=_0x16e87b,_0xe087eb[_0x40630b(0x55e,0x5a1,0x4f6,0x43c)]=![],_0xe087eb[_0x38ca84(0x4ee,0x4e0,0x563,0x55f)]=_0x3def71[_0x38ca84(0x588,0x4cc,0x485,0x4de)],_0xe087eb['prompt']=_0x4d2dda,eventSource[_0x38ca84(0x514,0x55b,0x584,0x541)](EventType[_0x40630b(0x445,0x557,0x4f1,0x49d)+'MAGE_RESPO'+_0x40630b(0x3e3,0x4b3,0x441,0x3ad)],_0xe087eb),_0x291134[_0x38ca84(0x541,0x4c6,0x4d8,0x457)](addLog,'[Banana]\x20E'+_0x40630b(0x4a6,0x533,0x50f,0x58f)+_0x40630b(0x40c,0x4fe,0x467,0x3d4)+_0x38ca84(0x532,0x4ff,0x457,0x463)+':\x20'+_0x16e87b);}}function handleCancelBananaTask(_0x5ccbbc){const _0x469ee0={'AOTpv':function(_0x5a69fa,_0x255fd4){return _0x5a69fa(_0x255fd4);},'gMXoe':function(_0x456260,_0x569e84){return _0x456260===_0x569e84;},'jbwTi':function(_0xb6f34c,_0x209bb3){return _0xb6f34c||_0x209bb3;}},{taskId:_0x55550e}=_0x5ccbbc;function _0x29437c(_0x51cacd,_0x2aa316,_0xf543,_0x5d2c4f){return _0x35d8(_0x5d2c4f-0x5c,_0xf543);}function _0x265e93(_0x3342bf,_0x61510,_0x411519,_0x4bc6ea){return _0x35d8(_0x4bc6ea-0x3d1,_0x411519);}_0x469ee0[_0x265e93(0x68b,0x670,0x609,0x691)](addLog,_0x29437c(0x26b,0x1e1,0x2eb,0x26a)+_0x265e93(0x56f,0x545,0x5aa,0x544)+_0x265e93(0x596,0x5b7,0x53f,0x547)+_0x55550e+')'),_0x469ee0[_0x29437c(0x267,0x387,0x2e3,0x324)](currentTaskId,_0x55550e)&&currentRequestId&&(_0x469ee0[_0x265e93(0x61a,0x651,0x5d3,0x691)](addLog,'[Banana]\x20取'+_0x29437c(0x156,0x293,0x1f3,0x1f6)+_0x29437c(0x22e,0x242,0x1e0,0x28d)+currentRequestId+')'),eventSource[_0x265e93(0x5a4,0x630,0x6ef,0x64d)](EventType[_0x265e93(0x5bb,0x5b4,0x6b1,0x627)+_0x29437c(0x2db,0x334,0x37c,0x31b)+_0x265e93(0x56e,0x4c0,0x4d8,0x577)],{'id':currentRequestId,'success':![],'error':'任务已取消','prompt':_0x469ee0['jbwTi'](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function _0x35d8(_0x3df462,_0x26d39b){_0x3df462=_0x3df462-(0x110c+-0x1*-0x2520+-0x34d6);const _0x3e42ad=_0x1688();let _0x7b4bf1=_0x3e42ad[_0x3df462];if(_0x35d8['YTkDXt']===undefined){var _0x3a7358=function(_0x2eac1e){const _0x3cfe4c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x401e9f='',_0x281e4d='',_0x33a0f3=_0x401e9f+_0x3a7358;for(let _0x257d03=0x50c+0x380+0x4*-0x223,_0x52a739,_0x2c58b8,_0x25849d=-0x1a95+0x854+0x1241*0x1;_0x2c58b8=_0x2eac1e['charAt'](_0x25849d++);~_0x2c58b8&&(_0x52a739=_0x257d03%(-0x98+-0x717*0x1+0x1b*0x49)?_0x52a739*(-0x7c0+0x1*0x1b52+-0x1352)+_0x2c58b8:_0x2c58b8,_0x257d03++%(-0x1*0x66b+-0x21*-0xd+0x4c2))?_0x401e9f+=_0x33a0f3['charCodeAt'](_0x25849d+(-0xd72*-0x1+-0x1*-0x1042+0xed5*-0x2))-(0x1b90+0x121*-0x1f+0x1*0x779)!==-0x4*-0x297+-0x40*-0x79+0x1c4*-0x17?String['fromCharCode'](0x89*0x2f+0xdfa+-0x65b*0x6&_0x52a739>>(-(-0x1b0e+0x1e08*-0x1+0x3918)*_0x257d03&-0x1*0x16eb+0x1e*0x8e+0x64d*0x1)):_0x257d03:-0x304*0x5+0x44f+-0xac5*-0x1){_0x2c58b8=_0x3cfe4c['indexOf'](_0x2c58b8);}for(let _0x3fab86=0x2d8*-0x7+0x22ed+-0x5*0x301,_0x4125f5=_0x401e9f['length'];_0x3fab86<_0x4125f5;_0x3fab86++){_0x281e4d+='%'+('00'+_0x401e9f['charCodeAt'](_0x3fab86)['toString'](0x18*-0x189+0x11*-0x18b+0x905*0x7))['slice'](-(0x255d+-0x157+-0x2404));}return decodeURIComponent(_0x281e4d);};_0x35d8['SfYqBW']=_0x3a7358,_0x35d8['OqOxQJ']={},_0x35d8['YTkDXt']=!![];}const _0x36c271=_0x3e42ad[-0x1bc1+-0x41c*-0x9+-0x93b],_0x5cafe1=_0x3df462+_0x36c271,_0x20c635=_0x35d8['OqOxQJ'][_0x5cafe1];if(!_0x20c635){const _0x47e537=function(_0x100243){this['GkYKMj']=_0x100243,this['awvgbT']=[-0x1*0x883+0x2465*0x1+-0x1be1,-0x32a*-0x1+0x25ab*0x1+-0x28d5,-0xe3*0x1+0x1194+-0x10b1],this['mZwlzJ']=function(){return'newState';},this['rdpGwk']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['XDrafi']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x47e537['prototype']['orjOmX']=function(){const _0x4f272c=new RegExp(this['rdpGwk']+this['XDrafi']),_0x288a01=_0x4f272c['test'](this['mZwlzJ']['toString']())?--this['awvgbT'][-0x27*0x1a+0x1*0x36b+0x8c]:--this['awvgbT'][-0x15dd+-0x3cb*0x1+0x19a8];return this['riMeiq'](_0x288a01);},_0x47e537['prototype']['riMeiq']=function(_0xf38125){if(!Boolean(~_0xf38125))return _0xf38125;return this['kHdZcc'](this['GkYKMj']);},_0x47e537['prototype']['kHdZcc']=function(_0x44140c){for(let _0x10828d=0x1*0x24f9+0xa7c+0x1*-0x2f75,_0x44bd50=this['awvgbT']['length'];_0x10828d<_0x44bd50;_0x10828d++){this['awvgbT']['push'](Math['round'](Math['random']())),_0x44bd50=this['awvgbT']['length'];}return _0x44140c(this['awvgbT'][-0x1f3a+-0x11c8+-0x12*-0x2b9]);},new _0x47e537(_0x35d8)['orjOmX'](),_0x7b4bf1=_0x35d8['SfYqBW'](_0x7b4bf1),_0x35d8['OqOxQJ'][_0x5cafe1]=_0x7b4bf1;}else _0x7b4bf1=_0x20c635;return _0x7b4bf1;}function initializeBananaListener(){function _0x379af7(_0x4c7b99,_0x42c617,_0x357c47,_0x58ce67){return _0x35d8(_0x58ce67-0x313,_0x357c47);}const _0x2b544f={'hOUpu':function(_0x1423ad,_0x258bbd){return _0x1423ad(_0x258bbd);},'HSUuN':_0x379af7(0x58d,0x4ab,0x57a,0x511)+'件监听器已初始化。'};function _0x12fdc5(_0x466066,_0x6cca8e,_0x360d8c,_0x8dfc99){return _0x35d8(_0x360d8c-0x48,_0x466066);}eventSource['on'](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],bananaGenerate),eventSource['on'](_0x12fdc5(0x1db,0x219,0x23b,0x223)+_0x12fdc5(0x26c,0x2f2,0x304,0x278)+_0x12fdc5(0x1a5,0x28d,0x216,0x1c9),handleCancelBananaTask),_0x2b544f[_0x379af7(0x5c5,0x4c4,0x56a,0x541)](addLog,_0x2b544f['HSUuN']);}export async function replaceWithBanana(){function _0x3366a0(_0x5405b7,_0xa43e8a,_0x140336,_0x4c8bda){return _0x35d8(_0x5405b7-0xb7,_0x4c8bda);}function _0x2cd422(_0x1f034d,_0x49e595,_0x27d681,_0xe1dc03){return _0x35d8(_0x27d681-0x54,_0x49e595);}const _0x3eabae={'VbHTe':function(_0x7650fd,_0x3c0afe){return _0x7650fd(_0x3c0afe);},'fMEow':_0x3366a0(0x24d,0x1f1,0x1d9,0x2f0),'zqdaG':function(_0xd61da0,_0x33cda3){return _0xd61da0||_0x33cda3;},'rldss':_0x3366a0(0x240,0x274,0x1c1,0x28d),'sbcON':function(_0x4e4866){return _0x4e4866();},'mQfll':function(_0x5b2aa3,_0x494f2f){return _0x5b2aa3===_0x494f2f;},'NwrdJ':_0x3366a0(0x2b2,0x358,0x2d7,0x2b0),'MJNDZ':function(_0x85fbd9,_0x4ba4b8){return _0x85fbd9(_0x4ba4b8);},'ofnwo':'[Banana]\x20生'+_0x2cd422(0x2bf,0x1f2,0x23a,0x228)};extension_settings[extensionName][_0x2cd422(0x236,0x20d,0x2c4,0x30c)]==_0x2cd422(0x20f,0x287,0x1d6,0x14a)?(!window[_0x2cd422(0x197,0x16e,0x1ad,0x251)+_0x3366a0(0x24e,0x2ce,0x2fa,0x1a3)+_0x2cd422(0x28a,0x282,0x258,0x2eb)]&&(window[_0x3366a0(0x210,0x29c,0x2ae,0x177)+_0x3366a0(0x24e,0x266,0x242,0x267)+_0x3366a0(0x2bb,0x33a,0x28d,0x201)]=!![],initializeBananaListener()),_0x3eabae[_0x2cd422(0x2ae,0x30a,0x28a,0x329)](initializeImageProcessing)):_0x3eabae[_0x2cd422(0x2b6,0x19d,0x24c,0x2b3)](_0x3eabae[_0x2cd422(0x1a8,0x214,0x1af,0x17d)],'ADfQz')?_0x3eabae[_0x2cd422(0x2a4,0x226,0x1f6,0x1b0)](_0x18c070,'[Banana]\x20R'+_0x2cd422(0x152,0x1b8,0x20b,0x299)+'ntains\x20tex'+_0x3366a0(0x2c8,0x2bb,0x330,0x2aa)+'\x20image.'):window[_0x3366a0(0x210,0x190,0x262,0x1d0)+_0x2cd422(0x1e9,0x153,0x1eb,0x1ac)+_0x2cd422(0x19d,0x1a2,0x258,0x2f6)]&&(eventSource[_0x3366a0(0x345,0x3b4,0x299,0x3ef)+_0x2cd422(0x25d,0x1ba,0x258,0x1d4)](EventType['GENERATE_I'+_0x2cd422(0x2fd,0x313,0x28b,0x29f)+'ST'],bananaGenerate),eventSource[_0x2cd422(0x240,0x386,0x2e2,0x33f)+_0x3366a0(0x2bb,0x24a,0x2f9,0x2cd)](_0x3366a0(0x2aa,0x344,0x1f7,0x363)+_0x3366a0(0x373,0x2bc,0x378,0x389)+_0x3366a0(0x285,0x1d2,0x298,0x1dd),handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x3366a0(0x295,0x2a5,0x2ba,0x326)](_0x596c7b=>{const _0x1e3a18={'UUwBx':function(_0xccdf9f,_0x56cee2){return _0xccdf9f(_0x56cee2);},'Idevz':function(_0x5e7664,_0x14c774){return _0x5e7664===_0x14c774;},'uVgxP':_0x3eabae[_0x48bacf(0xed,0xec,0x195,0x1ed)],'cRfCQ':function(_0x2eb55b,_0xdd596d){function _0x2e6d0d(_0xa609e3,_0x5e55bf,_0x33783f,_0x22ec4a){return _0x48bacf(_0xa609e3-0xa6,_0x22ec4a,_0xa609e3-0x3c6,_0x22ec4a-0x23);}return _0x3eabae[_0x2e6d0d(0x411,0x3d9,0x445,0x479)](_0x2eb55b,_0xdd596d);}};function _0x18aec1(_0x1ff28e,_0x23e2fd,_0x2c3ab8,_0x5de517){return _0x2cd422(_0x1ff28e-0x17d,_0x23e2fd,_0x5de517- -0x310,_0x5de517-0x56);}function _0x48bacf(_0x2c8b67,_0x1b2af3,_0x1aa8bc,_0x133a5c){return _0x3366a0(_0x1aa8bc- -0x1ef,_0x1b2af3-0x6f,_0x1aa8bc-0x16b,_0x1b2af3);}if(_0x3eabae[_0x48bacf(0xf2,0xae,0x36,0x74)]!==_0x3eabae[_0x18aec1(-0x90,-0xb8,-0x18c,-0x14e)]){const {taskId:_0x43cfa2}=_0x34243c;_0x1e3a18['UUwBx'](_0x37cd10,_0x18aec1(-0x8a,-0x12e,-0x13f,-0xae)+_0x48bacf(0xea,0xca,0x3b,-0x39)+_0x18aec1(-0x184,-0x17b,-0x1c1,-0x146)+_0x43cfa2+')');if(_0x1e3a18['Idevz'](_0x8d4690,_0x43cfa2)&&_0x8f4f7a){const _0x1a53b9=_0x48bacf(0xc1,0x12b,0xfd,0x100)[_0x18aec1(-0x8c,-0x46,0x3,-0x7a)]('|');let _0xecd9f9=-0x71*-0x11+-0x1*-0x25ff+-0x2d80;while(!![]){switch(_0x1a53b9[_0xecd9f9++]){case'0':_0x2391e6=null;continue;case'1':_0x5a6e8a=null;continue;case'2':_0x59833f[_0x18aec1(-0x26,0x1f,0x34,-0x40)](_0xdcdf40[_0x48bacf(0x1c2,0xac,0x11e,0x17c)+'MAGE_RESPO'+_0x48bacf(0x2f,-0x3d,0x6e,0xf4)],{'id':_0x4ef3cb,'success':![],'error':_0x1e3a18[_0x48bacf(0x2e,0xe,0x6c,0xd8)],'prompt':_0x1e3a18[_0x18aec1(-0x205,-0x10d,-0x1f4,-0x15d)](_0x550167,'')});continue;case'3':_0xa725d=null;continue;case'4':_0x3125f5('[Banana]\x20取'+'消当前任务，发送失败'+_0x18aec1(-0xcf,-0x99,-0xee,-0x8b)+_0x162c3e+')');continue;}break;}}}else eventSource[_0x48bacf(0x17c,0xd8,0x156,0xbb)+_0x18aec1(-0xad,-0x92,-0x41,-0xb8)](_0x596c7b,bananaGenerate);}),window[_0x3366a0(0x210,0x1c5,0x270,0x215)+_0x2cd422(0x266,0x296,0x1eb,0x1b7)+'ener']=![],_0x3eabae[_0x2cd422(0x266,0x23a,0x2b1,0x35a)](addLog,_0x3eabae[_0x2cd422(0x35a,0x36b,0x2bf,0x273)]));}