(function(_0x19ecb5,_0x3d5804){function _0x308e80(_0x5001b0,_0x2b4615,_0xb029b,_0x232252){return _0x5d64(_0x2b4615- -0x377,_0x232252);}const _0x3364ba=_0x19ecb5();function _0x152a82(_0x599610,_0x32fa4a,_0x1cb0e6,_0x49d924){return _0x5d64(_0x599610- -0x187,_0x1cb0e6);}while(!![]){try{const _0x5e9270=-parseInt(_0x308e80(-0x1c2,-0x1b7,-0x1c3,-0x169))/(-0x1*0x2e3+0x1ee0+-0x1bfc)*(-parseInt(_0x308e80(-0x20e,-0x1dc,-0x19f,-0x1d4))/(0x595*-0x3+0x1*0xeed+0x1d4))+parseInt(_0x308e80(-0x19b,-0x171,-0x19d,-0x134))/(-0x1*-0xce7+-0x527+-0x7bd)+parseInt(_0x152a82(0x26,-0x15,0x48,-0x1d))/(0x1e3d*-0x1+-0x1bb5+0x39f6)+-parseInt(_0x308e80(-0x1e1,-0x1c0,-0x1da,-0x19b))/(-0x10f3*0x1+-0x179f+0x2897)+parseInt(_0x308e80(-0x198,-0x1b0,-0x177,-0x163))/(-0x71*-0x2f+0x1*-0x112f+-0x2*0x1c5)+-parseInt(_0x308e80(-0x17a,-0x1a9,-0x166,-0x1a5))/(-0x26f8+-0x1*0x10e1+0x37e*0x10)+-parseInt(_0x152a82(0x52,0x11,0x7e,0x32))/(0x18d5+-0x839+-0x1094);if(_0x5e9270===_0x3d5804)break;else _0x3364ba['push'](_0x3364ba['shift']());}catch(_0x5a0eb9){_0x3364ba['push'](_0x3364ba['shift']());}}}(_0x4d01,-0x10d474+-0x179dff+0x351093));const _0x35b813=(function(){const _0x4e413c={};_0x4e413c['MbxIQ']=function(_0x3a9e1b,_0x53140c){return _0x3a9e1b!==_0x53140c;};function _0x13dc72(_0x41e82d,_0x235d38,_0x56aaf5,_0x494994){return _0x5d64(_0x56aaf5- -0x247,_0x494994);}_0x4e413c['VjOrR']=_0x13dc72(-0xe3,-0x95,-0xb2,-0x6c),_0x4e413c['HxzwE']='xPqmV';const _0x15975d=_0x4e413c;let _0x210979=!![];return function(_0xa01795,_0x2199cf){function _0xc190cb(_0x1f8c44,_0xcae390,_0x4bd3fd,_0x4d44c5){return _0x13dc72(_0x1f8c44-0x1d0,_0xcae390-0x3a,_0xcae390-0x381,_0x4bd3fd);}function _0x7fcf92(_0x3819e9,_0x316e93,_0x590508,_0x1c02c2){return _0x13dc72(_0x3819e9-0xe5,_0x316e93-0x18c,_0x316e93- -0x17b,_0x3819e9);}if(_0x15975d['VjOrR']===_0x15975d[_0xc190cb(0x2b0,0x2f4,0x31f,0x2f3)]){const {original:_0x12e88b,cleaned:_0x305b39,skip:_0x54876a}=_0x53bdc6;if(_0x54876a){const _0x13034b={};return _0x13034b[_0xc190cb(0x353,0x345,0x311,0x349)]=_0x12e88b,_0x13034b[_0x7fcf92(-0x200,-0x1bf,-0x192,-0x186)+'n']='',_0x13034b[_0x7fcf92(-0x23e,-0x226,-0x221,-0x1e7)]=_0x305b39,_0x13034b[_0xc190cb(0x335,0x336,0x31b,0x374)]=!![],_0x13034b;}const _0x3c59cc=_0x12f692[_0x305b39[_0x7fcf92(-0x183,-0x1ca,-0x1a3,-0x1db)+'e']()]||'',_0x3be60d={};return _0x3be60d[_0xc190cb(0x34b,0x345,0x339,0x321)]=_0x12e88b,_0x3be60d['translatio'+'n']=_0x3c59cc,_0x3be60d[_0xc190cb(0x2ba,0x2d6,0x2c7,0x2aa)]=_0x305b39,_0x3be60d['skipped']=![],_0x3be60d;}else{const _0xc56d98=_0x210979?function(){function _0x3a509d(_0x156935,_0x3f62f8,_0x2ee094,_0x3552be){return _0x7fcf92(_0x2ee094,_0x3552be- -0x1c,_0x2ee094-0x199,_0x3552be-0x48);}function _0x4540d5(_0x2aba0b,_0x5ea833,_0x26b105,_0x88824f){return _0x7fcf92(_0x26b105,_0x5ea833-0x56d,_0x26b105-0xed,_0x88824f-0x149);}if(_0x15975d[_0x4540d5(0x3c8,0x390,0x3a0,0x349)](_0x3a509d(-0x272,-0x264,-0x249,-0x25b),_0x4540d5(0x37b,0x32e,0x311,0x33e)))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x491269()};else{if(_0x2199cf){const _0x2ee8a1=_0x2199cf[_0x4540d5(0x352,0x332,0x37d,0x33a)](_0xa01795,arguments);return _0x2199cf=null,_0x2ee8a1;}}}:function(){};return _0x210979=![],_0xc56d98;}};}()),_0x12fd46=_0x35b813(this,function(){const _0x5d0c68={};function _0x36ebd0(_0x2e0f0b,_0x2a6b35,_0x325932,_0x3062c2){return _0x5d64(_0x2e0f0b-0x14a,_0x3062c2);}function _0x482ddf(_0x3d87cf,_0x481b60,_0x3c9c42,_0x4b8754){return _0x5d64(_0x3d87cf-0x1eb,_0x481b60);}_0x5d0c68[_0x36ebd0(0x337,0x330,0x349,0x357)]=_0x482ddf(0x3e5,0x3a6,0x398,0x3ac)+'+$';const _0x5aafed=_0x5d0c68;return _0x12fd46['toString']()['search'](_0x5aafed['CdRMm'])[_0x482ddf(0x3b1,0x3d0,0x3ad,0x3a3)]()['constructo'+'r'](_0x12fd46)[_0x482ddf(0x3d4,0x419,0x3db,0x3fc)](_0x5aafed[_0x482ddf(0x3d8,0x407,0x3c7,0x39a)]);});_0x12fd46();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';function _0x5d64(_0x5b2cda,_0x8c4fef){_0x5b2cda=_0x5b2cda-(-0xdb*0x1e+0xe1*0x19+0x77*0xb);const _0x46cc51=_0x4d01();let _0x34c3c0=_0x46cc51[_0x5b2cda];if(_0x5d64['VXTNMj']===undefined){var _0x2f7441=function(_0x5bb329){const _0x24efcb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x509f2c='',_0x591325='',_0x33bba5=_0x509f2c+_0x2f7441;for(let _0x6800e9=0x2*0x47b+0x6d*-0x2b+0x959,_0x343083,_0x169e27,_0x5aa670=0x1381+-0x3*0x671+-0x2e*0x1;_0x169e27=_0x5bb329['charAt'](_0x5aa670++);~_0x169e27&&(_0x343083=_0x6800e9%(-0x2*0x435+-0xf2*-0x19+-0x116*0xe)?_0x343083*(0x1d9c+-0x803*-0x4+-0x3d68)+_0x169e27:_0x169e27,_0x6800e9++%(-0xbf5*-0x3+0x121e+-0x35f9))?_0x509f2c+=_0x33bba5['charCodeAt'](_0x5aa670+(-0x48*-0x84+-0x2b0+0x275*-0xe))-(0x295+-0xb9c+0xb*0xd3)!==-0xb8+-0xe84*0x1+-0x32*-0x4e?String['fromCharCode'](-0x3b*0x16+0x1*0x10b1+-0xaa0&_0x343083>>(-(0x71*0x29+-0x89f*-0x2+0x2355*-0x1)*_0x6800e9&-0x79d+0x27*-0x7f+0x1afc)):_0x6800e9:0x23d7+0x349*-0x1+0x208e*-0x1){_0x169e27=_0x24efcb['indexOf'](_0x169e27);}for(let _0x52209f=-0x9b5+-0x1738+0x20ed,_0x4ed9fd=_0x509f2c['length'];_0x52209f<_0x4ed9fd;_0x52209f++){_0x591325+='%'+('00'+_0x509f2c['charCodeAt'](_0x52209f)['toString'](-0x26d6+0x71f*0x3+0x1189))['slice'](-(0xaed*-0x3+0x249a+-0x3d1));}return decodeURIComponent(_0x591325);};_0x5d64['mGpSbE']=_0x2f7441,_0x5d64['uQdYLE']={},_0x5d64['VXTNMj']=!![];}const _0x4fee5a=_0x46cc51[-0x91c+-0xf3a+0x1*0x1856],_0x5f2714=_0x5b2cda+_0x4fee5a,_0x5b7b3c=_0x5d64['uQdYLE'][_0x5f2714];if(!_0x5b7b3c){const _0x2b3942=function(_0x32d86a){this['JolWlX']=_0x32d86a,this['UuqpFs']=[-0xd21+0x5b0*-0x2+0x1882,0x53*0x4a+-0x1715+-0xe9,-0xb*-0x151+0x3*-0x59f+-0x3d*-0xa],this['naqcEJ']=function(){return'newState';},this['naFUBG']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['tRbtXO']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2b3942['prototype']['PRJxLN']=function(){const _0x8bb9fa=new RegExp(this['naFUBG']+this['tRbtXO']),_0xe3ccad=_0x8bb9fa['test'](this['naqcEJ']['toString']())?--this['UuqpFs'][-0xb08*-0x3+-0x1969+-0x7ae]:--this['UuqpFs'][0x2af*-0x6+0x2608+-0x322*0x7];return this['ZFRfYD'](_0xe3ccad);},_0x2b3942['prototype']['ZFRfYD']=function(_0x1d85e0){if(!Boolean(~_0x1d85e0))return _0x1d85e0;return this['LRnaTI'](this['JolWlX']);},_0x2b3942['prototype']['LRnaTI']=function(_0x4aad22){for(let _0x30416e=-0xa0*-0x15+0x1*0x841+-0x1561,_0x59e292=this['UuqpFs']['length'];_0x30416e<_0x59e292;_0x30416e++){this['UuqpFs']['push'](Math['round'](Math['random']())),_0x59e292=this['UuqpFs']['length'];}return _0x4aad22(this['UuqpFs'][-0xbdc+-0x23c1+0x2cd*0x11]);},new _0x2b3942(_0x5d64)['PRJxLN'](),_0x34c3c0=_0x5d64['mGpSbE'](_0x34c3c0),_0x5d64['uQdYLE'][_0x5f2714]=_0x34c3c0;}else _0x34c3c0=_0x5b7b3c;return _0x34c3c0;}import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function _0x4d01(){const _0x48f649=['D0fmyKO','B3jPz2LUywW','C3qTy2HHDhu4oG','wK92yKi','CMfUzg9T','AxnbCNjHEq','tNrgtgy','rvnu','wfPqvNi','t3HQuwm','Aw5KzxHpzG','yMHUvwm','u1bjB1G','BfrfuKm','zxjYB3i','C3rYAw5N','CM9Szq','y29TD3a','Cg1kr1u','Bg9N','su5Nr2m','A0jxwNe','ChjVBxb0','CMvWBgfJzq','C2TPCa','CLvpy3K','r2HAqKO','u3r6sNO','CMvZDwX0','yxbWBhK','rMDkrfi','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','AMfUzg4','zw5LCG','qvrjt05FuKvtua','57+76k+r5AsX6lsLoG','uwLqyM8','B3LTC3C','BwfW','zefrquW','DxnLCG','vxrKvfO','DgvZDa','u2rqDxq','ufjptvbux1jfuq','CMfUzg9Tvvvjra','ChvZAa','EwPsDu0','tMDAvfq','mZe3mtm0mM9xtKngzq','y2XLyw5Lza','D1fZqwC','B2jQzwn0','C29Tzq','vhrxyxq','C1Dhzwe','BLnOre4','icHjrdOG','C2XPy2u','CMvTB3zLtgLZDa','qwjVCNrfCNjVCG','vKvju2m','AeDVtuC','ENzvugi','AM9PBG','qvrjt05FuKvrvq','BuvZs0W','ndaWnty5mLjUshfXtq','C3vJy2vZCW','DhjPBq','zgLZCgXHEvrLEa','BwziC0S','rxvMvhe','zMLSDgvY','y05ZBvK','uhfvD2q','57+76k+rieXmtsdMIAFOOyZOTOu','mJmZmZG0nwvMyvL6tq','B3jPz2LUywXuyq','ioIVT+AXGUE/U+IVKsbmte0G','shH6D0u','t05trq','ze5qD2u','iow3SUAuTUwiSoE/U+IVKsbmte0','EuT1tg4','C3bSAxq','mvDJALjHDq','iefjioIUVUE9RUw3SUE7N+s4GowiSa','DgrrwNK','BwvZC2fNzq','r3P0vue','D2fYBG','Dg9tDhjPBMC','odaYnJm4mfzAveHzrq','EMnAugm','rMXADfy','tvvNzKO','C3rYAw5NAwz5','B09XqKm','ufjptvbux1jfuW','nZi4nJG2n1zNq0fmDq','CKDdA2W','ieXmtsdORR7NVA7POBxPNAi','zw50CMLLCW','v2jdCxi','BMfTzq','BM93','DKv6B08','zfjqCg4','CwvLBxe','DgXhwue','mtC4nJe5mJb1Cfnkqw8','Dfn0yKG','C3vIC3rYAw5N','Cej2EhG','ue9ou0u','CxzqtM0','wg9xwum','vfvru3C','ww9kvNa','zfPcC3q','ugrtvuq','DePtvhy','twj4sve','BMLSuM4','vfjbwuu','teXnx1rsqu5tta','C2vHCMnO','CgPYBwK','qvrjt05Fr0vuxW','uNztuxy','q2rstw0','keLeoIa','CNrLt0y','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','EMvjrKe','t1zrBeS','vuvtva','57+76k+r5AsX6lsLoIa','tMPXDgq','v3bcBfC','BgvUz3rO','Dg9mB3DLCKnHCW','B0fkwuC','kcGOlISPkYKRkq','zw1PDa','C2TPChbLza','shfnAxq','Bwf0y2G','zhH1s2m','s0vzvKC','uxvkyLG','DvzkEue','DhjHBNnSyxrPBW','y29UDgvUDa','zvjnwKS','mtKYnZCZngjUEvzrqW','D1j2CLa','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','C2v0'];_0x4d01=function(){return _0x48f649;};return _0x4d01();}function shouldSkipTranslation(_0x4ace11){function _0x31cedc(_0x476be3,_0x53409b,_0x38b677,_0x1c1926){return _0x5d64(_0x1c1926-0x2e2,_0x38b677);}return SKIP_PATTERNS['some'](_0xa23468=>_0xa23468['test'](_0x4ace11[_0x31cedc(0x498,0x491,0x490,0x491)]()));}export function tagsToJsonString(_0xa1ef60){if(!Array[_0x58f3b5(0x353,0x36d,0x37c,0x349)](_0xa1ef60))return'[]';function _0x129f16(_0x4addc4,_0x395f51,_0x115c69,_0x293620){return _0x5d64(_0x293620- -0x7a,_0x4addc4);}function _0x58f3b5(_0xdb8f36,_0x521563,_0xee0f7e,_0x173dff){return _0x5d64(_0xdb8f36-0x1e4,_0x173dff);}return JSON[_0x129f16(0x122,0x134,0x16f,0x151)](_0xa1ef60[_0x129f16(0xf3,0x16d,0x103,0x139)](_0x53236d=>_0x53236d&&typeof _0x53236d===_0x129f16(0xb6,0x109,0xee,0xff)));}export function preprocessPromptForTranslation(_0x2367de){const _0x47468a={'nShDN':function(_0x48e3f3,_0x180e09){return _0x48e3f3===_0x180e09;},'OVQlK':_0x3bf70d(-0xeb,-0x115,-0x101,-0xec),'eRMZK':function(_0x8963d4,_0x2b77ee){return _0x8963d4===_0x2b77ee;},'wALbJ':function(_0x20227e,_0x36a7b7){return _0x20227e===_0x36a7b7;},'RvSQv':function(_0x5dabf4,_0x11e6ac){return _0x5dabf4!==_0x11e6ac;},'qnirI':'string','cNsmY':function(_0x5f28c4,_0x3cea72){return _0x5f28c4(_0x3cea72);}};if(!_0x2367de||_0x47468a[_0x2d4a1b(-0x63,-0x6b,-0xa3,-0xac)](typeof _0x2367de,_0x47468a['qnirI']))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0x558719=_0x594a57=>{function _0x2f8917(_0x4d9e3c,_0xd67d28,_0x21290e,_0x1ebf4f){return _0x3bf70d(_0xd67d28,_0x21290e-0x618,_0x21290e-0xcc,_0x1ebf4f-0x12c);}function _0x436ed7(_0x334671,_0x3fdd25,_0x58bfee,_0x45ad2d){return _0x2d4a1b(_0x45ad2d,_0x334671-0x56f,_0x58bfee-0x14c,_0x45ad2d-0x168);}if(_0x47468a[_0x2f8917(0x48a,0x48a,0x4a3,0x47c)](_0x47468a[_0x436ed7(0x50a,0x4bf,0x51f,0x519)],_0x47468a['OVQlK'])){const _0x316848=[];let _0x5e1492='',_0x53b9bc=![];for(let _0x48ac7f=-0x1*-0x266c+0x472*-0x5+-0x1032;_0x48ac7f<_0x594a57[_0x436ed7(0x50f,0x4eb,0x52c,0x54c)];_0x48ac7f++){const _0x5e35ff=_0x594a57[_0x48ac7f];if(_0x47468a[_0x436ed7(0x4ba,0x506,0x4ac,0x4a6)](_0x5e35ff,'$'))_0x53b9bc=!_0x53b9bc,_0x5e1492+=_0x5e35ff;else{if((_0x47468a[_0x436ed7(0x51d,0x51c,0x549,0x4eb)](_0x5e35ff,',')||_0x47468a[_0x436ed7(0x522,0x4eb,0x4d4,0x4d7)](_0x5e35ff,'，'))&&!_0x53b9bc){const _0x2df913=_0x5e1492[_0x2f8917(0x497,0x4e7,0x4b0,0x4bd)]();if(_0x2df913)_0x316848[_0x2f8917(0x4ce,0x468,0x499,0x466)](_0x2df913);_0x5e1492='';}else _0x5e1492+=_0x5e35ff;}}if(_0x5e1492[_0x436ed7(0x4c7,0x4b1,0x484,0x504)]())_0x316848[_0x436ed7(0x4b0,0x477,0x481,0x4f8)](_0x5e1492[_0x2f8917(0x4a1,0x4c4,0x4b0,0x4e2)]());return _0x316848;}else return _0x79ed[_0x2f8917(0x455,0x4bb,0x4a0,0x4e9)](_0x5ec089=>_0x5ec089[_0x436ed7(0x4ac,0x4fa,0x46c,0x4d0)](_0x1ad6b9[_0x436ed7(0x4c7,0x4a8,0x494,0x4d3)]()));},_0x65b9a0=_0x558719(_0x2367de),_0x2b2ed5=[],_0x4bfe67=[],_0x4bea25=new Map();for(const _0x2d9b7b of _0x65b9a0){const _0x1344ae=_0x2d9b7b['match'](SD_SYMBOL_PATTERN);if(_0x1344ae){const _0x343cb2=_0x1344ae[0x176+0x1df*-0x13+0x886*0x4]||'',_0x5bbcbe=(_0x1344ae[-0x2*-0x1190+0x3ed+-0x1*0x270b]||'')[_0x2d4a1b(-0xd1,-0xa8,-0x5b,-0x68)](),_0x41b6e8=_0x1344ae[-0x11*0x90+0x218f+-0x17fc]||'',_0x3d58ad=_0x1344ae[-0x670+0xc9*-0x31+0x2ced]||'',_0x1b84d4={'original':_0x2d9b7b,'cleaned':_0x5bbcbe,'prefix':_0x343cb2,'suffix':_0x41b6e8,'weight':_0x3d58ad,'skip':_0x47468a['cNsmY'](shouldSkipTranslation,_0x2d9b7b)||_0x47468a[_0x2d4a1b(-0x82,-0xa3,-0xee,-0xb4)](shouldSkipTranslation,_0x5bbcbe)};_0x2b2ed5['push'](_0x1b84d4),!_0x1b84d4[_0x2d4a1b(-0xa6,-0xd5,-0x111,-0x95)]&&_0x5bbcbe&&(_0x4bfe67[_0x2d4a1b(-0xfd,-0xbf,-0xab,-0xf0)](_0x5bbcbe),_0x4bea25['set'](_0x5bbcbe[_0x2d4a1b(-0x71,-0x5f,-0x4c,-0x70)+'e'](),_0x1b84d4));}else{const _0x327915={'original':_0x2d9b7b,'cleaned':_0x2d9b7b,'prefix':'','suffix':'','weight':'','skip':_0x47468a[_0x3bf70d(-0x11d,-0x163,-0x171,-0x1b1)](shouldSkipTranslation,_0x2d9b7b)};_0x2b2ed5['push'](_0x327915),!_0x327915[_0x2d4a1b(-0x104,-0xd5,-0xd4,-0xe8)]&&_0x2d9b7b&&(_0x4bfe67[_0x3bf70d(-0x13f,-0x17f,-0x147,-0x185)](_0x2d9b7b),_0x4bea25[_0x2d4a1b(-0x67,-0x4e,-0x47,-0x62)](_0x2d9b7b[_0x2d4a1b(-0x87,-0x5f,-0x8f,-0x97)+'e'](),_0x327915));}}function _0x3bf70d(_0x22cb23,_0x3a8f44,_0x460b1a,_0x38f062){return _0x5d64(_0x3a8f44- -0x317,_0x22cb23);}function _0x2d4a1b(_0xfafeed,_0x23bc51,_0x1b2a1b,_0x104b80){return _0x5d64(_0x23bc51- -0x257,_0xfafeed);}return{'originalTags':_0x2b2ed5,'cleanedTags':_0x4bfe67,'cleanedText':_0x47468a[_0x3bf70d(-0x193,-0x163,-0x17c,-0x15d)](tagsToJsonString,_0x4bfe67),'tagMap':_0x4bea25};}export function combineTranslationResult(_0x2d7084,_0x3af586){const _0x986e08={'dxuKc':_0x1e8c2b(0x2b5,0x310,0x2f7,0x2f4),'yKuLn':function(_0x64e224){return _0x64e224();},'zcZPc':function(_0x42c39d,_0x1a3640){return _0x42c39d!==_0x1a3640;},'UtdTZ':'cXDiA','VEISc':_0x5cf8e6(0x3b8,0x375,0x3c5,0x402),'oAJYG':function(_0x2a367a,_0x12a5e3){return _0x2a367a===_0x12a5e3;},'OxjQc':_0x5cf8e6(0x355,0x325,0x326,0x354),'yjRuM':function(_0xf1727a,_0x4b0611){return _0xf1727a===_0x4b0611;},'FgJDR':_0x1e8c2b(0x23a,0x228,0x268,0x261),'wRvrP':_0x5cf8e6(0x335,0x324,0x33c,0x31b)};if(!_0x2d7084||!Array[_0x1e8c2b(0x236,0x24e,0x2a0,0x25b)](_0x2d7084))return[];function _0x5cf8e6(_0x1fcae8,_0x4952bc,_0x34aa34,_0x10603e){return _0x5d64(_0x1fcae8-0x1b7,_0x10603e);}const _0x413ede={};if(_0x3af586&&_0x986e08[_0x5cf8e6(0x3b0,0x391,0x3c7,0x3a0)](typeof _0x3af586,_0x986e08[_0x1e8c2b(0x290,0x256,0x212,0x25f)])){if(_0x986e08[_0x1e8c2b(0x28e,0x275,0x241,0x285)](_0x986e08[_0x1e8c2b(0x2b7,0x27e,0x228,0x274)],_0x1e8c2b(0x2ae,0x27f,0x23d,0x261)))for(const [_0x259ddc,_0xd3d1bb]of Object[_0x5cf8e6(0x388,0x3ad,0x3be,0x37c)](_0x3af586)){_0x986e08[_0x1e8c2b(0x283,0x271,0x24f,0x285)](_0x986e08[_0x5cf8e6(0x3be,0x40c,0x387,0x403)],_0x1e8c2b(0x23b,0x276,0x26d,0x26a))?_0x413ede[_0x259ddc['toLowerCas'+'e']()]=_0xd3d1bb:(_0x583cae[_0x1e8c2b(0x22a,0x249,0x284,0x269)](_0x1e8c2b(0x24d,0x258,0x245,0x258)+_0x5cf8e6(0x378,0x38a,0x37d,0x33f)+_0x1e8c2b(0x2d2,0x2d4,0x2f2,0x2bc)),_0x2d4000=!![]);}else _0x3b5002[_0x5cf8e6(0x34f,0x309,0x303,0x392)](_0x6c6ff),_0x49064c['set'](_0x527e54[_0x5cf8e6(0x3af,0x3c6,0x39f,0x368)+'e'](),_0x12773d);}function _0x1e8c2b(_0x430cc5,_0x1d4868,_0x519799,_0x1f9ef3){return _0x5d64(_0x1f9ef3-0xec,_0x519799);}return _0x2d7084[_0x1e8c2b(0x2cb,0x25b,0x292,0x27c)](_0x3fc98d=>{const _0x3919e5={'rGCkl':function(_0x2a44b1){function _0x15e028(_0x443dba,_0x11a3a9,_0x1ecc0b,_0x4c116e){return _0x5d64(_0x4c116e-0x1fc,_0x1ecc0b);}return _0x986e08[_0x15e028(0x399,0x3e6,0x395,0x3ba)](_0x2a44b1);}},{original:_0x35ef1f,cleaned:_0x339e28,skip:_0xb380b3}=_0x3fc98d;function _0x58c33c(_0x1de17b,_0x2e4807,_0x1df591,_0x1372bc){return _0x5cf8e6(_0x1372bc- -0x342,_0x2e4807-0x14,_0x1df591-0xc0,_0x2e4807);}if(_0xb380b3){if(_0x986e08[_0x2872be(0x3fe,0x3fc,0x40c,0x41a)](_0x986e08[_0x58c33c(-0x29,-0x3b,0x28,0x8)],_0x986e08[_0x58c33c(0x27,-0x1a,0x6,0x1c)])){const _0x2436e6={};return _0x2436e6[_0x2872be(0x42c,0x468,0x46c,0x45d)]=_0x35ef1f,_0x2436e6[_0x58c33c(0x63,0x68,0x6a,0x78)+'n']='',_0x2436e6[_0x2872be(0x3c1,0x419,0x411,0x3ee)]=_0x339e28,_0x2436e6[_0x2872be(0x427,0x49a,0x42d,0x44e)]=!![],_0x2436e6;}else{const _0x53fba6={'pjrmi':function(_0x1bee60,_0x8fb072){return _0x1bee60!==_0x8fb072;},'tStbH':function(_0x445a77,_0x5ed9f9){return _0x445a77(_0x5ed9f9);},'mfHsK':_0x986e08[_0x58c33c(0x44,0x54,0x55,0x74)]};return new _0x1d9216((_0x5ebd02,_0x2964ea)=>{function _0x2a8841(_0x32c53b,_0x41b563,_0x34f88a,_0x16f6f2){return _0x2872be(_0x32c53b-0x100,_0x41b563-0x5d,_0x32c53b,_0x16f6f2- -0x3c5);}function _0x5ea606(_0x2105a0,_0x5caf7b,_0x5b8643,_0x32f37c){return _0x2872be(_0x2105a0-0xb6,_0x5caf7b-0x8f,_0x5b8643,_0x5caf7b- -0x10c);}const _0x560a66=_0x3919e5[_0x5ea606(0x325,0x315,0x343,0x2c7)](_0x43b751);_0x2c01db['log'](_0x5ea606(0x2cb,0x2b2,0x277,0x276)+'\x20请求获取翻译提示词'+_0x2a8841(0x36,0x1e,-0xa,0x30)+_0x560a66+')');const _0x4d149c=_0x2836c0=>{if(_0x53fba6[_0x299b69(0x2ac,0x279,0x263,0x277)](_0x2836c0['id'],_0x560a66))return;_0x2feff1[_0x3fda3a(0x40,0x6b,0x51,0x95)+'ener'](_0x315880[_0x299b69(0x28c,0x277,0x289,0x28a)+_0x299b69(0x27e,0x27a,0x266,0x268)+_0x299b69(0x239,0x25c,0x21a,0x26c)+_0x299b69(0x296,0x26c,0x245,0x22e)],_0x4d149c);function _0x3fda3a(_0x2401f2,_0x33b016,_0x194d4c,_0x357a2e){return _0x2a8841(_0x357a2e,_0x33b016-0x155,_0x194d4c-0xe,_0x33b016-0x39);}function _0x299b69(_0x403d07,_0x283972,_0x1ae73e,_0xa5dccc){return _0x5ea606(_0x403d07-0x167,_0x283972- -0xb7,_0x403d07,_0xa5dccc-0x103);}const {prompt:_0x1b68d9}=_0x2836c0;_0xd6d04c[_0x299b69(0x247,0x20c,0x1f2,0x1cb)](_0x3fda3a(0x4b,0x32,0x7b,0x7f)+_0x299b69(0x21d,0x218,0x247,0x1ce)+'(ID:\x20'+_0x560a66+'):',_0x1b68d9),_0x53fba6[_0x299b69(0x266,0x269,0x2a8,0x26e)](_0x5ebd02,_0x1b68d9);};_0x3b4cfa['on'](_0x18460d[_0x2a8841(0xc5,0x8f,0xc1,0x75)+'ATION_GET_'+_0x2a8841(0x44,0x6b,0x18,0x5a)+_0x2a8841(0x4f,0x48,0xb1,0x6a)],_0x4d149c);const _0x1249d4={};_0x1249d4['id']=_0x560a66,_0x5beb59[_0x2a8841(0x8a,0xa2,0x9e,0x88)](_0x42366e[_0x5ea606(0x364,0x32e,0x2fa,0x2f2)+_0x5ea606(0x35f,0x331,0x364,0x313)+_0x2a8841(0x40,-0x19,-0x1d,0x23)+_0x2a8841(0xb2,0x42,0x91,0x80)],_0x1249d4),_0x46d699(()=>{function _0x24a991(_0x5a717e,_0xa62ddc,_0x123b42,_0x5aabba){return _0x5ea606(_0x5a717e-0x1e6,_0xa62ddc-0x161,_0x5a717e,_0x5aabba-0x1a6);}_0x26b3d9[_0xfc951e(0x2a3,0x24f,0x28f,0x2bd)+_0x24a991(0x45a,0x432,0x3e9,0x3f3)](_0x215ebf[_0xfc951e(0x2d2,0x30b,0x2d2,0x2e7)+_0xfc951e(0x320,0x316,0x2d5,0x2a0)+_0x24a991(0x428,0x474,0x46f,0x4a7)+'PONSE'],_0x4d149c);function _0xfc951e(_0x4f3343,_0x426ddd,_0x10eda7,_0x518f96){return _0x5ea606(_0x4f3343-0x186,_0x10eda7- -0x5c,_0x4f3343,_0x518f96-0x61);}_0x2964ea(new _0x13ef19(_0x53fba6[_0xfc951e(0x258,0x2c7,0x29b,0x24f)]));},-0x15d*-0x22+-0x1*0x4285+0x3b3b);});}}function _0x2872be(_0x512882,_0x54ab3e,_0xcc9e4e,_0x138f62){return _0x1e8c2b(_0x512882-0x18b,_0x54ab3e-0x189,_0xcc9e4e,_0x138f62-0x166);}const _0x367858=_0x413ede[_0x339e28[_0x58c33c(0x42,0x24,0x95,0x6d)+'e']()]||'',_0x5846b8={};return _0x5846b8['original']=_0x35ef1f,_0x5846b8[_0x2872be(0x44b,0x423,0x458,0x455)+'n']=_0x367858,_0x5846b8['cleaned']=_0x339e28,_0x5846b8[_0x2872be(0x466,0x48f,0x47f,0x44e)]=![],_0x5846b8;});}export function formatTranslationDisplay(_0x341b6f,_0x34950a={}){const _0x2dbf43={'uQLZC':function(_0x381d81,_0x58c4f5){return _0x381d81(_0x58c4f5);},'wQsAg':function(_0x598b93,_0x269e72){return _0x598b93===_0x269e72;},'BdRMb':'MRjoC'};function _0x4c27e3(_0x597636,_0x2e7f72,_0x25f7f4,_0xa51a73){return _0x5d64(_0x2e7f72-0x258,_0xa51a73);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x34950a;function _0x4b54a1(_0x155f60,_0x59bf73,_0x2ef751,_0x3f6a00){return _0x5d64(_0x59bf73- -0xda,_0x155f60);}if(!_0x341b6f||!Array[_0x4c27e3(0x40d,0x3c7,0x3f2,0x3f9)](_0x341b6f))return'';return _0x341b6f['map'](_0x421747=>{const _0x2d41dc={'rteOF':function(_0x567522,_0x53fbf2){return _0x2dbf43['uQLZC'](_0x567522,_0x53fbf2);}};function _0x15b1f4(_0x5e10f5,_0x4cc2bb,_0x10d989,_0x51b0b3){return _0x4c27e3(_0x5e10f5-0xc2,_0x10d989-0xa8,_0x10d989-0xcd,_0x4cc2bb);}if(_0x421747[_0x15b1f4(0x4bf,0x519,0x4fc,0x4d5)])return showOriginal?_0x421747[_0x2b581a(0x32c,0x38b,0x378,0x36b)]:'';const _0x210399=[];if(showOriginal)_0x210399[_0x2b581a(0x31c,0x33e,0x308,0x2f8)](_0x421747[_0x15b1f4(0x4c5,0x4ff,0x50b,0x4f3)]);function _0x2b581a(_0x21b54a,_0x1f4683,_0x3a276c,_0x57a582){return _0x4c27e3(_0x21b54a-0x18f,_0x57a582- -0xf8,_0x3a276c-0x40,_0x1f4683);}if(showTranslation&&_0x421747['translatio'+'n']){if(_0x2dbf43[_0x15b1f4(0x491,0x458,0x49d,0x4e4)](_0x2dbf43['BdRMb'],_0x2dbf43['BdRMb']))_0x210399[_0x15b1f4(0x4cd,0x4c2,0x498,0x4a4)]('('+_0x421747[_0x2b581a(0x394,0x347,0x379,0x363)+'n']+')');else{const _0x36395b=new _0x31ca5f(_0x397bf8['error'][_0x15b1f4(0x4c7,0x478,0x4c3,0x47c)]);_0x36395b[_0x2b581a(0x353,0x339,0x365,0x333)]=_0x2b581a(0x33c,0x2fd,0x2ba,0x306),_0x2d41dc[_0x15b1f4(0x4e7,0x524,0x4ef,0x4ac)](_0x2b92b8,_0x36395b);}}return _0x210399[_0x2b581a(0x2c5,0x2e1,0x2c1,0x30a)]('\x20');})[_0x4c27e3(0x41f,0x40b,0x3e6,0x3f6)](Boolean)[_0x4b54a1(0xcd,0xd0,0xea,0xb6)](separator);}export async function translatePromptTags(_0x5657df){const _0x140976={'dNPwe':function(_0x36f0fb,_0x14e612){return _0x36f0fb(_0x14e612);},'liywW':function(_0xf5ec09,_0x2f2bf5){return _0xf5ec09===_0x2f2bf5;},'FlZtV':'zIsEx','COFPx':_0x4e3ad7(-0x140,-0x18d,-0xfd,-0x17f),'PdSUD':function(_0x32cf2e,_0x376e01){return _0x32cf2e(_0x376e01);},'QiPbo':function(_0x41f89b,_0x373a2a,_0x5a610c){return _0x41f89b(_0x373a2a,_0x5a610c);},'WbCqr':_0xc63d9f(0x233,0x20e,0x1c4,0x217)+_0x4e3ad7(-0x132,-0x16b,-0x128,-0x179)+':'},{originalTags:_0x8758f5,cleanedText:_0x504f35}=_0x140976[_0x4e3ad7(-0x166,-0x16c,-0x180,-0x19f)](preprocessPromptForTranslation,_0x5657df);function _0xc63d9f(_0x2b2d57,_0x577f9f,_0x3a913a,_0x20a4fc){return _0x5d64(_0x577f9f-0xa2,_0x2b2d57);}if(!_0x504f35){if(_0x140976['liywW'](_0x140976[_0x4e3ad7(-0x159,-0x135,-0x15a,-0x156)],_0x140976['COFPx']))return[];else{const _0xe15ae0={};return _0xe15ae0['results']=[],_0xe15ae0[_0xc63d9f(0x23f,0x252,0x228,0x265)+'t']='',_0xe15ae0[_0x4e3ad7(-0x16a,-0x179,-0x17f,-0x19c)+'gs']=[],_0xe15ae0;}}function _0x4e3ad7(_0x2a9eb8,_0x341deb,_0x57fe4d,_0x457073){return _0x5d64(_0x2a9eb8- -0x322,_0x57fe4d);}try{const _0x18243d=await _0x140976[_0xc63d9f(0x2d5,0x285,0x280,0x2c6)](callTranslation,_0x504f35),_0x1ffbfd=parseTranslationResult(_0x18243d),_0x4d626a=_0x140976[_0xc63d9f(0x27b,0x230,0x268,0x243)](combineTranslationResult,_0x8758f5,_0x1ffbfd),_0x551b13=_0x140976[_0xc63d9f(0x23d,0x285,0x259,0x299)](formatTranslationDisplay,_0x4d626a),_0x259c1c={};return _0x259c1c['results']=_0x4d626a,_0x259c1c[_0xc63d9f(0x22a,0x252,0x22f,0x278)+'t']=_0x551b13,_0x259c1c[_0x4e3ad7(-0x16a,-0x126,-0x140,-0x128)+'gs']=_0x8758f5,_0x259c1c;}catch(_0x5e1189){console['error'](_0x140976[_0xc63d9f(0x24b,0x274,0x227,0x23d)],_0x5e1189);throw _0x5e1189;}}export function parseTranslationResult(_0x3ac164){const _0x3b5278={'XZPVr':function(_0x41deed,_0x348f80){return _0x41deed+_0x348f80;},'zvUPb':function(_0xe69a90,_0x3aac6d){return _0xe69a90!==_0x3aac6d;},'XoWYC':function(_0x14f88d,_0x1673a6){return _0x14f88d===_0x1673a6;},'NgZTT':_0x3c0b35(-0x6d,-0xab,-0xe8,-0x6f),'GclGB':function(_0x582df9,_0x320d61){return _0x582df9(_0x320d61);},'qeemq':_0xd16384(0x4e,0x83,0x78,0x55),'HhZue':function(_0xb6620e,_0x2225f9){return _0xb6620e>_0x2225f9;}};if(!_0x3ac164)return{};try{if(_0x3b5278[_0xd16384(0x56,0x65,0x1e,0xa4)](_0x3c0b35(-0x11c,-0xcf,-0x9c,-0x10d),_0x3c0b35(-0xb7,-0xcf,-0xac,-0xa7)))return _0x282713['randomUUID']();else{const _0x35b98b=_0x3ac164[_0x3c0b35(-0x72,-0x4d,-0x53,-0x1b)](/\{[\s\S]*\}/);if(_0x35b98b){const _0xc3489=JSON['parse'](_0x35b98b[0x2a*-0x3d+0x25f0+-0x1bee]);if(_0x3b5278['XoWYC'](typeof _0xc3489,_0xd16384(0x4b,0x5c,0x8a,0x1c))&&_0x3b5278['zvUPb'](_0xc3489,null)){if(_0x3b5278[_0x3c0b35(-0x22,-0x6c,-0xba,-0x31)](_0x3b5278[_0x3c0b35(-0xb2,-0xb1,-0xca,-0xfb)],_0x3b5278[_0xd16384(0x47,-0x5,0xe,0x63)]))return _0xc3489;else{const _0x4380d3={};return _0x4380d3[_0xd16384(0xb8,0xe6,0xf2,0x102)]=_0x4ca704,_0x4380d3[_0xd16384(0xb0,0x8d,0xdf,0x7f)+'n']='',_0x4380d3[_0xd16384(0x49,0x84,0x66,0x91)]=_0x5a0570,_0x4380d3[_0xd16384(0xa9,0xb8,0x9e,0x91)]=!![],_0x4380d3;}}}}}catch(_0x269237){console[_0x3c0b35(-0x8d,-0x86,-0xab,-0xa5)](_0x3c0b35(-0xf8,-0xdf,-0xc9,-0xd8)+'\x20JSON解析失败，'+'尝试旧格式:',_0x269237[_0x3c0b35(-0x82,-0x88,-0x43,-0x9e)]);}const _0x351122=_0x3b5278['GclGB'](String,_0x3ac164)[_0xd16384(0x2e,0x64,-0x19,0x41)](/[\r\n]+/g,'\x20')[_0x3c0b35(-0xcc,-0xca,-0xee,-0xd7)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x3c0b35(-0xc2,-0x9c,-0x54,-0x93)](),_0x2796e3=_0x351122[_0x3c0b35(-0x7a,-0x8c,-0xa0,-0xab)](/[,，]/)[_0xd16384(0x3d,0x85,-0xd,0x16)](_0x2d4444=>_0x2d4444['trim']())[_0x3c0b35(-0x87,-0x98,-0x5e,-0x9a)](Boolean);function _0xd16384(_0x52f9a0,_0x46ce5e,_0x402556,_0x118de0){return _0x5d64(_0x52f9a0- -0x153,_0x46ce5e);}const _0x54e325={};for(const _0xf6fa90 of _0x2796e3){if(_0x3b5278[_0xd16384(0x56,0x36,0x1c,0x5a)](_0x3b5278[_0x3c0b35(-0xbb,-0x74,-0x59,-0x8d)],_0x3b5278['qeemq'])){const _0x151f10=_0x142e3d[_0x3c0b35(-0x106,-0xd7,-0x9a,-0x9d)]('\x5c');if(_0x151f10>-0x154+-0x1*-0x986+0x2*-0x419){const _0x33a26a=_0x4dc4b9[_0xd16384(0x51,0x7b,0xa1,0x13)](0x1*-0x58e+-0x132*0xd+0x1518,_0x151f10)[_0xd16384(0x5c,0x3e,0x14,0x71)](),_0x25308a=_0x23530f[_0xd16384(0x51,0x5e,0x18,0x79)](_0x3b5278[_0x3c0b35(-0xe1,-0xd9,-0x9d,-0x10c)](_0x151f10,0x135f+-0x81*0x4a+0x11ec))[_0xd16384(0x5c,0x48,0x4d,0x5c)]();if(_0x33a26a)_0x2db72c[_0x33a26a]=_0x25308a;}}else{const _0x43ae97=_0xf6fa90[_0xd16384(0x21,0xc,0x12,0x4c)]('\x5c');if(_0x3b5278['HhZue'](_0x43ae97,0xf3e*0x1+0x4f0+0x7e*-0x29)){const _0x5eadbd=_0xf6fa90[_0xd16384(0x51,0x8b,0x25,0x23)](0x3*-0x9d3+0xf8*0x1d+0x161*0x1,_0x43ae97)['trim'](),_0x4a293f=_0xf6fa90[_0xd16384(0x51,0x6d,0x9f,0x3)](_0x43ae97+(-0x1*-0xa3b+0x14a4+-0x1ede))[_0xd16384(0x5c,0x8f,0xa4,0x26)]();if(_0x5eadbd)_0x54e325[_0x5eadbd]=_0x4a293f;}}}function _0x3c0b35(_0x3a6393,_0x6b3b19,_0x2addeb,_0x191ebb){return _0x5d64(_0x6b3b19- -0x24b,_0x2addeb);}return _0x54e325;}function generateRequestId(){function _0x5cbb75(_0x1acdcc,_0x34cc5b,_0x184e96,_0xd2d9c9){return _0x5d64(_0x184e96- -0x3,_0x34cc5b);}const _0x561a38={};_0x561a38[_0xe2c948(0x45,0x3f,0x6b,0x63)]=function(_0x187933,_0x37013f){return _0x187933+_0x37013f;};const _0x4292ab=_0x561a38;function _0xe2c948(_0x56f83b,_0x1e2ba2,_0x433682,_0x1e0ef1){return _0x5d64(_0x1e2ba2- -0x173,_0x433682);}if(crypto&&crypto[_0x5cbb75(0x1cd,0x1ca,0x194,0x144)])return crypto[_0xe2c948(0xe,0x24,-0x2a,0xc)]();return _0x4292ab[_0xe2c948(0x86,0x3f,0x86,0x54)](Date[_0x5cbb75(0x188,0x208,0x1d1,0x19a)]()['toString'](-0xca*-0x19+-0x1*-0x844+-0x1bda),Math[_0xe2c948(-0xc,-0x5,0x23,0x44)]()[_0x5cbb75(0x1da,0x18b,0x1c3,0x20f)](0x1db2+-0x83f*0x4+-0x1b7*-0x2)[_0x5cbb75(0x1f8,0x1b9,0x1d8,0x1a9)](0x16a4+-0x241*0x6+-0x91c));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x158848(_0x46f40d,_0x507304,_0x507353,_0x5ef2f4){return _0x5d64(_0x507353- -0x3ae,_0x507304);}const _0x24e31f={'mfaRx':function(_0x220ef2,_0x13b320){return _0x220ef2(_0x13b320);},'GhZBJ':function(_0x5417f3,_0x4c7f69){return _0x5417f3===_0x4c7f69;},'comwp':_0x158848(-0x1d0,-0x20c,-0x1c7,-0x18c),'zWOFb':function(_0x455763){return _0x455763();},'TUQSw':function(_0x398396,_0x5b0e4c,_0x394490){return _0x398396(_0x5b0e4c,_0x394490);}};return new Promise((_0x2863f4,_0x155afa)=>{const _0x53a507={'rofWb':function(_0x50a0e5,_0x119c84){return _0x50a0e5(_0x119c84);},'aBhlr':_0x5a3c1a(0x4f1,0x4f5,0x4c2,0x4f2)};function _0x10be75(_0x260322,_0x1d943a,_0x5240b5,_0x79e7ed){return _0x158848(_0x260322-0x90,_0x5240b5,_0x1d943a-0x17,_0x79e7ed-0x1ac);}function _0x5a3c1a(_0x1f9670,_0x466099,_0x68d5e4,_0x3ca446){return _0x158848(_0x1f9670-0x1b4,_0x68d5e4,_0x1f9670-0x697,_0x3ca446-0x10c);}if(_0x24e31f[_0x5a3c1a(0x46d,0x42e,0x492,0x449)](_0x24e31f[_0x5a3c1a(0x464,0x41c,0x49f,0x428)],'TRAYE')){const _0x21eb8c=_0x24e31f['zWOFb'](generateRequestId);console['log'](_0x5a3c1a(0x455,0x478,0x459,0x454)+'\x20请求获取翻译提示词'+_0x5a3c1a(0x48c,0x49c,0x461,0x467)+_0x21eb8c+')');const _0x509d98=_0x532703=>{if(_0x532703['id']!==_0x21eb8c)return;eventSource['removeList'+_0x16bb5d(0x48e,0x471,0x471,0x47a)](eventNames['LLM_TRANSL'+'ATION_GET_'+_0x16bb5d(0x4c1,0x4b3,0x4ab,0x480)+_0xc83f41(0x46c,0x433,0x47e,0x48f)],_0x509d98);const {prompt:_0x19eaea}=_0x532703;function _0xc83f41(_0x504b4f,_0xa28c38,_0x12264e,_0x149abc){return _0x10be75(_0x504b4f-0x156,_0x504b4f-0x626,_0xa28c38,_0x149abc-0xbf);}console[_0x16bb5d(0x4ac,0x463,0x4a6,0x4a9)]('st-chatu8:'+'\x20已获取翻译提示词\x20'+_0x16bb5d(0x49c,0x4d4,0x507,0x51e)+_0x21eb8c+'):',_0x19eaea);function _0x16bb5d(_0x200b6d,_0x59da34,_0x32cfaa,_0x54adc9){return _0x10be75(_0x200b6d-0x7b,_0x59da34-0x67d,_0x32cfaa,_0x54adc9-0xb8);}_0x24e31f['mfaRx'](_0x2863f4,_0x19eaea);};eventSource['on'](eventNames[_0x10be75(-0x16f,-0x1af,-0x16c,-0x1e8)+_0x5a3c1a(0x4d4,0x4ab,0x49d,0x504)+_0x5a3c1a(0x4b6,0x468,0x505,0x4fd)+'PONSE'],_0x509d98);const _0x4f3dcb={};_0x4f3dcb['id']=_0x21eb8c,eventSource[_0x10be75(-0x19c,-0x19c,-0x181,-0x1c2)](eventNames[_0x5a3c1a(0x4d1,0x4b7,0x4ee,0x4de)+_0x5a3c1a(0x4d4,0x4cc,0x4ca,0x505)+_0x10be75(-0x245,-0x201,-0x22d,-0x228)+_0x10be75(-0x159,-0x1a4,-0x1d3,-0x1c5)],_0x4f3dcb),_0x24e31f[_0x5a3c1a(0x4c9,0x490,0x504,0x487)](setTimeout,()=>{function _0x1898e9(_0x25e3be,_0x50536e,_0x101b67,_0x12c46e){return _0x10be75(_0x25e3be-0xda,_0x12c46e-0x2c7,_0x50536e,_0x12c46e-0x13b);}function _0x531ac7(_0x262399,_0x508189,_0x4991ec,_0x1da61e){return _0x5a3c1a(_0x4991ec- -0x3d4,_0x508189-0x60,_0x1da61e,_0x1da61e-0x17);}eventSource['removeList'+_0x531ac7(0x61,0xeb,0xa0,0x6d)](eventNames['LLM_TRANSL'+_0x1898e9(0xd2,0x155,0x10a,0x11b)+_0x531ac7(0xc4,0xde,0xe2,0xa0)+_0x1898e9(0xed,0x110,0xde,0x10d)],_0x509d98),_0x53a507['rofWb'](_0x155afa,new Error(_0x53a507['aBhlr']));},-0x3072+0x33a3+0x3*0xbf5);}else return'';});}export function LLM_TRANSLATION(_0x578577,{timeoutMs:timeoutMs=0xb8b8+0xa58c+-0x73e4}={}){function _0x5c3b5c(_0x3c7066,_0xb581d4,_0x5a20c7,_0x2345ca){return _0x5d64(_0x2345ca-0x37e,_0xb581d4);}const _0x2422e5={'nilRn':function(_0x59ef1c,_0x4a6785){return _0x59ef1c(_0x4a6785);},'Njqtd':_0x438d25(0x3fd,0x43d,0x420,0x454),'dRPpn':function(_0x36f490){return _0x36f490();},'tlGYA':function(_0x24cf02){return _0x24cf02();},'jandn':function(_0x282701,_0x3fdf2d){return _0x282701===_0x3fdf2d;},'NtFLf':_0x5c3b5c(0x591,0x52e,0x542,0x55a),'hGoMG':function(_0x174f69,_0x1a80bc){return _0x174f69(_0x1a80bc);},'SPIoX':function(_0x369181,_0x3cfc6f){return _0x369181!==_0x3cfc6f;},'kBWZq':'onHfY','GztUA':_0x438d25(0x3c6,0x37e,0x3be,0x372),'StzJz':function(_0x4e4afb,_0x80d132){return _0x4e4afb(_0x80d132);},'YoJVp':function(_0x700586){return _0x700586();},'HqMit':function(_0x248bc8,_0x28209d){return _0x248bc8(_0x28209d);},'tdQZy':_0x438d25(0x431,0x3c0,0x409,0x406),'WpBlW':_0x5c3b5c(0x55b,0x553,0x598,0x54a),'mEsKL':function(_0x4cd240){return _0x4cd240();},'GXwFu':function(_0x5319e3,_0x5c8820,_0x133cfe){return _0x5319e3(_0x5c8820,_0x133cfe);}};function _0x438d25(_0x39b0d6,_0x3a3f31,_0x456c40,_0x428182){return _0x5d64(_0x456c40-0x218,_0x428182);}return new Promise((_0x265ca0,_0x977f27)=>{function _0x1e5af2(_0x2bb532,_0x216b25,_0x50bfa9,_0x4f77be){return _0x438d25(_0x2bb532-0x19,_0x216b25-0x1cc,_0x4f77be- -0x46d,_0x50bfa9);}function _0x53f331(_0x411fa3,_0x1c0f31,_0x57a18d,_0x24e64a){return _0x5c3b5c(_0x411fa3-0x12d,_0x411fa3,_0x57a18d-0xa0,_0x1c0f31- -0x2ab);}if(_0x2422e5[_0x1e5af2(-0x110,-0xa2,-0xd5,-0xdf)](_0x2422e5[_0x1e5af2(-0x68,-0xc7,-0x62,-0x93)],_0x2422e5[_0x1e5af2(-0x9d,-0x58,-0x5e,-0x5f)])){const _0x5dc480=_0x2422e5[_0x1e5af2(-0x79,-0xa5,-0xa6,-0xa9)](generateRequestId);console[_0x1e5af2(-0xe8,-0x100,-0xf5,-0xd8)]('st-chatu8:'+_0x1e5af2(-0x71,-0xd7,-0x65,-0x9c)+_0x1e5af2(-0xac,-0x1a,-0xb4,-0x67)+_0x5dc480+')');let _0x24e0b3=null;const _0x40b6e8=()=>{eventSource[_0x52788b(-0x36,0x4,-0x6f,-0x1c)+_0x52788b(-0x50,-0x93,-0x66,-0x69)](eventNames[_0x337d58(0x2be,0x30a,0x303,0x2df)+_0x52788b(-0x4f,-0x1d,-0x30,-0x64)+'ONSE'],_0x1e029b);function _0x337d58(_0x3ce65f,_0x3468ec,_0x4a5500,_0x54c538){return _0x1e5af2(_0x3ce65f-0x1c4,_0x3468ec-0xb4,_0x4a5500,_0x54c538-0x34c);}function _0x52788b(_0x4a362a,_0x618465,_0x25e46c,_0x4df5e8){return _0x1e5af2(_0x4a362a-0x12c,_0x618465-0xa8,_0x4df5e8,_0x4a362a-0x7a);}if(_0x24e0b3)clearTimeout(_0x24e0b3);},_0x1e029b=_0x1ceb48=>{const _0x3ecffd={'lTERC':function(_0x7ade95,_0x3248f3){return _0x7ade95!==_0x3248f3;},'tJSTv':function(_0x1dc6cd,_0x4340a5){function _0xe4e78c(_0x1e6db2,_0x2eda5f,_0x3dc255,_0x1e996e){return _0x5d64(_0x1e996e- -0x95,_0x2eda5f);}return _0x2422e5[_0xe4e78c(0x102,0x150,0x15e,0x151)](_0x1dc6cd,_0x4340a5);},'ZOvbB':_0x2422e5[_0x52cfeb(-0x8d,-0xbb,-0xdb,-0xaa)],'KEYVG':function(_0x1faea4){function _0x2e5b69(_0x5972d4,_0x4b5279,_0x32ee2f,_0xb0985){return _0x52cfeb(_0x5972d4-0x1e7,_0x5972d4,_0x32ee2f-0xf5,_0x4b5279-0x13a);}return _0x2422e5[_0x2e5b69(0x44,0x71,0x63,0x47)](_0x1faea4);}};if(_0x1ceb48['id']!==_0x5dc480)return;_0x2422e5[_0x517de4(0x548,0x4d1,0x4c3,0x511)](_0x40b6e8),console[_0x517de4(0x47e,0x4e3,0x47e,0x4b6)](_0x517de4(0x482,0x477,0x496,0x4a5)+_0x52cfeb(-0xc2,-0xe7,-0x11e,-0xe2)+'\x20执行结果\x20(ID:'+'\x20'+_0x5dc480+'):',_0x1ceb48);function _0x517de4(_0x40a7a0,_0x1724f2,_0xfcc952,_0x23d0f8){return _0x53f331(_0xfcc952,_0x23d0f8-0x266,_0xfcc952-0x103,_0x23d0f8-0x3);}function _0x52cfeb(_0x30d20e,_0x20c85c,_0x383bde,_0x39b6b3){return _0x53f331(_0x20c85c,_0x39b6b3- -0x372,_0x383bde-0x110,_0x39b6b3-0x34);}if(_0x1ceb48[_0x517de4(0x4fc,0x4f8,0x4b4,0x4e7)]){if(_0x2422e5[_0x52cfeb(-0xc6,-0x10f,-0xfd,-0x115)](_0x2422e5['NtFLf'],_0x2422e5[_0x52cfeb(-0x11b,-0x142,-0x120,-0x12f)]))_0x2422e5[_0x517de4(0x4a0,0x4e7,0x517,0x4e1)](_0x265ca0,_0x1ceb48[_0x52cfeb(-0x167,-0xf5,-0x167,-0x119)]);else{const _0x1f29b6={'MUgfJ':function(_0x1bd2e6,_0x4a99fe){function _0x19deff(_0x512f26,_0x11c620,_0x5063c8,_0x24d665){return _0x52cfeb(_0x512f26-0x7f,_0x11c620,_0x5063c8-0x4,_0x512f26-0x61c);}return _0x3ecffd[_0x19deff(0x561,0x517,0x542,0x563)](_0x1bd2e6,_0x4a99fe);},'PqUwd':_0x3ecffd[_0x517de4(0x497,0x4a9,0x494,0x4a6)]},_0x39bbc8=_0x3ecffd[_0x517de4(0x550,0x56f,0x4f7,0x539)](_0x18626f);_0xe93134[_0x517de4(0x4de,0x4f3,0x4c0,0x4b6)](_0x52cfeb(-0x140,-0x13c,-0xfd,-0x133)+'\x20请求获取翻译提示词'+'\x20(ID:\x20'+_0x39bbc8+')');const _0x895ac2=_0x1a80fb=>{if(_0x3ecffd[_0x146911(0x417,0x44e,0x425,0x45b)](_0x1a80fb['id'],_0x39bbc8))return;_0x14f1c5[_0x236688(0x411,0x418,0x3fe,0x44d)+_0x236688(0x44a,0x3fe,0x42e,0x3ee)](_0x19287f['LLM_TRANSL'+_0x146911(0x481,0x486,0x499,0x4b0)+_0x146911(0x4bb,0x46c,0x47b,0x456)+_0x146911(0x44a,0x474,0x48b,0x494)],_0x895ac2);const {prompt:_0x580ca9}=_0x1a80fb;_0x4e1284[_0x146911(0x3e6,0x42a,0x42b,0x404)]('st-chatu8:'+_0x236688(0x445,0x3fc,0x40b,0x3cb)+_0x146911(0x4a3,0x455,0x49c,0x45d)+_0x39bbc8+'):',_0x580ca9);function _0x236688(_0x7a187c,_0x4f8745,_0x5a6959,_0x3c2c6a){return _0x517de4(_0x7a187c-0x112,_0x4f8745-0x133,_0x5a6959,_0x4f8745- -0xc6);}function _0x146911(_0x1b7ac6,_0x45a984,_0x1e0eb5,_0x1614df){return _0x517de4(_0x1b7ac6-0x8b,_0x45a984-0xe9,_0x1614df,_0x1e0eb5- -0x8b);}_0x5e3e13(_0x580ca9);};_0xd572af['on'](_0x4cba98[_0x52cfeb(-0xc6,-0xf0,-0xb2,-0xb7)+_0x52cfeb(-0xd8,-0x101,-0x94,-0xb4)+_0x52cfeb(-0xe1,-0x106,-0xc5,-0xd2)+'PONSE'],_0x895ac2);const _0x517e5d={};_0x517e5d['id']=_0x39bbc8,_0x3f5b6d[_0x52cfeb(-0xc7,-0x6b,-0xbd,-0xa4)](_0x787177['LLM_TRANSL'+'ATION_GET_'+'PROMPT_REQ'+_0x52cfeb(-0xaf,-0x96,-0x99,-0xac)],_0x517e5d),_0x54c59f(()=>{function _0x34018a(_0x124fe9,_0x48f8c6,_0x523453,_0x163eea){return _0x52cfeb(_0x124fe9-0x63,_0x523453,_0x523453-0x4,_0x48f8c6-0x543);}_0x1fa0c1['removeList'+_0x34018a(0x429,0x42f,0x3e2,0x3eb)](_0x315c30[_0x34018a(0x496,0x48c,0x4ae,0x4c0)+_0x34018a(0x477,0x48f,0x494,0x44d)+'PROMPT_RES'+'PONSE'],_0x895ac2);function _0x2d2100(_0x39b2de,_0x1730fa,_0x3a6b4c,_0x133527){return _0x517de4(_0x39b2de-0xf0,_0x1730fa-0x189,_0x3a6b4c,_0x1730fa- -0x6a5);}_0x1f29b6[_0x34018a(0x43a,0x46e,0x483,0x49d)](_0x10008b,new _0x15b4df(_0x1f29b6[_0x2d2100(-0x194,-0x1b7,-0x1aa,-0x198)]));},-0x8*0xe2+0x135a*-0x3+0x682e);}}else{if(_0x2422e5['SPIoX']('onHfY',_0x2422e5[_0x517de4(0x474,0x486,0x508,0x4b8)]))return _0x4543ca;else{if(_0x1ceb48['error']&&_0x2422e5[_0x52cfeb(-0x134,-0xd8,-0x145,-0x115)](_0x1ceb48[_0x52cfeb(-0x15c,-0x16c,-0x154,-0x127)]['name'],_0x52cfeb(-0x139,-0xbc,-0x125,-0xf9))){const _0x11515f=new Error(_0x1ceb48[_0x52cfeb(-0x172,-0x134,-0x14c,-0x127)][_0x517de4(0x4e4,0x4ff,0x531,0x4fc)]);_0x11515f[_0x517de4(0x543,0x4d6,0x4e9,0x50c)]=_0x2422e5[_0x52cfeb(-0xc6,-0xed,-0x9d,-0xdb)],_0x2422e5[_0x517de4(0x4db,0x471,0x496,0x4be)](_0x977f27,_0x11515f);}else _0x977f27(new Error(_0x1ceb48[_0x52cfeb(-0xcb,-0x125,-0xca,-0x119)]));}}};eventSource['on'](eventNames[_0x1e5af2(-0x28,-0x5c,-0x30,-0x6d)+_0x53f331(0x210,0x25f,0x257,0x274)+'ONSE'],_0x1e029b);const _0x5b17e9={};_0x5b17e9[_0x1e5af2(-0x95,-0x88,-0x88,-0xd5)]=_0x578577,_0x5b17e9['id']=_0x5dc480,eventSource['emit'](eventNames['LLM_TRANSL'+_0x1e5af2(-0xcb,-0xc0,-0x8b,-0xaa)+_0x1e5af2(-0xc7,-0xb6,-0xe4,-0xe4)],_0x5b17e9),_0x24e0b3=_0x2422e5['GXwFu'](setTimeout,()=>{function _0x18af1f(_0x2b1129,_0x12f075,_0x11404f,_0x56a8c8){return _0x53f331(_0x12f075,_0x11404f- -0x172,_0x11404f-0x4,_0x56a8c8-0xaa);}_0x2422e5[_0x139f50(-0x123,-0x145,-0x149,-0x121)](_0x40b6e8);function _0x139f50(_0x134d47,_0x444d6e,_0x3bc93a,_0x310369){return _0x53f331(_0x310369,_0x134d47- -0x3d7,_0x3bc93a-0x1c7,_0x310369-0x19e);}_0x977f27(new Error(_0x139f50(-0x14e,-0x156,-0x165,-0x140)+'时（'+timeoutMs+'ms）'));},timeoutMs);}else{_0x5b8e17[_0x1e5af2(-0xec,-0xee,-0x68,-0xb0)+_0x53f331(0x251,0x25e,0x285,0x21f)](_0x19174d[_0x53f331(0x2ed,0x2bb,0x2aa,0x298)+_0x1e5af2(-0x7b,-0xad,-0xf6,-0xc9)+_0x53f331(0x25e,0x28e,0x28e,0x257)],_0x2530dd);if(_0x2f05d0)_0x2422e5[_0x1e5af2(-0x39,-0x7e,-0x88,-0x58)](_0x3bf6f1,_0x49cfe9);}});}export async function callTranslation(_0x4ead09){function _0x17258a(_0x214e2e,_0x2d63b3,_0x3f61c4,_0x2b7871){return _0x5d64(_0x2b7871- -0x103,_0x3f61c4);}function _0x3046f7(_0x326907,_0x1d6b2b,_0x56cbd8,_0x3e6c5e){return _0x5d64(_0x326907-0x2eb,_0x3e6c5e);}const _0x25ac6d={'qvPNm':function(_0x270951,_0x5332f2,_0x4cce64){return _0x270951(_0x5332f2,_0x4cce64);},'OPbLi':function(_0x5bdb63,_0xecae69){return _0x5bdb63||_0xecae69;},'vEzoO':function(_0x3e014d,_0x5901ad){return _0x3e014d(_0x5901ad);},'oymsw':function(_0x34e886,_0x399020){return _0x34e886(_0x399020);},'arpLI':_0x17258a(0xb9,0x7c,0xc1,0x8a)};try{let _0x5f55cc=_0x25ac6d[_0x17258a(0xc6,0xbf,0xb2,0xdb)](buildPromptForRequestType,_0x17258a(0x121,0xb2,0xf4,0x100)+'n',_0x25ac6d['OPbLi'](_0x4ead09,''));_0x5f55cc=_0x25ac6d[_0x17258a(0x8e,0x119,0xe1,0xd2)](mergeAdjacentMessages,_0x5f55cc);const _0x18ba62={};_0x18ba62[_0x3046f7(0x465,0x424,0x47d,0x48e)]=_0x17258a(0x74,0x63,0xb7,0x8f),_0x18ba62[_0x17258a(0x123,0xba,0x121,0x101)]=_0x4ead09||'';const _0x4c6c33=[..._0x5f55cc,_0x18ba62];updateCombinedPrompt(_0x4c6c33);const _0x1f85d8=await _0x25ac6d[_0x3046f7(0x4c0,0x509,0x4b7,0x475)](LLM_TRANSLATION,_0x4c6c33);return _0x1f85d8;}catch(_0x256b67){_0x25ac6d[_0x17258a(0x65,0x61,0xb7,0x8c)](addLog,_0x3046f7(0x4df,0x529,0x4ae,0x4e3)+_0x256b67['message']),console[_0x3046f7(0x463,0x43e,0x42c,0x420)](_0x25ac6d['arpLI'],_0x256b67);throw _0x256b67;}}let isAiInitialized=![];export function initAiSettings(_0x26d8f1){const _0x1e7b64={};function _0xdb449c(_0x20926c,_0x194197,_0x1c3d18,_0xae063d){return _0x5d64(_0x20926c- -0x2bd,_0x1c3d18);}_0x1e7b64[_0x49c952(0x333,0x3ab,0x372,0x392)]=_0x49c952(0x398,0x2fd,0x34d,0x369)+_0xdb449c(-0xfc,-0xe0,-0x101,-0x147)+_0xdb449c(-0xed,-0xf1,-0x118,-0xc0);const _0x11a27f=_0x1e7b64;function _0x49c952(_0x42a2ab,_0x21c319,_0x5a3b60,_0x127ead){return _0x5d64(_0x5a3b60-0x1e1,_0x21c319);}!isAiInitialized&&(console[_0x49c952(0x37a,0x310,0x35e,0x337)](_0x11a27f['dAQAL']),isAiInitialized=!![]);}