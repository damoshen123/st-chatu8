(function(_0x2f507a,_0x49a288){function _0x5bdca5(_0x480169,_0x58299e,_0x4c5bf5,_0x576537){return _0x1684(_0x576537- -0x17,_0x58299e);}const _0x56158c=_0x2f507a();function _0x94ccca(_0x48a1fc,_0x245034,_0x4b7d1f,_0x1959db){return _0x1684(_0x4b7d1f- -0xfd,_0x48a1fc);}while(!![]){try{const _0x20ba57=-parseInt(_0x5bdca5(0x203,0x213,0x1ff,0x1bd))/(-0x20cb+-0x1*0x117f+0x1*0x324b)*(-parseInt(_0x94ccca(0xbb,0xb1,0x8e,0xcb))/(0x933+0x107*-0x23+0x1ac4))+parseInt(_0x5bdca5(0x24a,0x24f,0x252,0x214))/(-0x2495+-0xf9b+0x3433*0x1)+parseInt(_0x5bdca5(0x1c0,0x21d,0x20f,0x207))/(-0x486+0x84+0x1*0x406)*(-parseInt(_0x94ccca(0x103,0x140,0x106,0x155))/(0x53a+-0x1837+0x6*0x32b))+parseInt(_0x5bdca5(0x221,0x18c,0x1f6,0x1da))/(0x21f1*0x1+0x24ee+-0x46d9*0x1)+parseInt(_0x94ccca(0xd9,0xb9,0x10f,0x131))/(-0x1*-0x97+-0x2d2+0x2*0x121)*(parseInt(_0x94ccca(0x6a,0x90,0x8d,0xb2))/(-0x2198+-0x5f*0x43+0x3a7d))+-parseInt(_0x5bdca5(0x169,0x1c1,0x1fd,0x1c5))/(0x64d+-0x1033*0x1+-0x1*-0x9ef)*(-parseInt(_0x5bdca5(0x17a,0x223,0x1f6,0x1cc))/(0x11e*-0x21+-0x5d*0x1f+-0xd1*-0x3b))+-parseInt(_0x94ccca(0x135,0x168,0x115,0x112))/(-0xb1f+0x1c59+-0x35*0x53)*(parseInt(_0x94ccca(0x18e,0x12d,0x136,0x11b))/(-0x2b*-0x63+0x1*-0x1e5b+0xdc6));if(_0x20ba57===_0x49a288)break;else _0x56158c['push'](_0x56158c['shift']());}catch(_0x518d5a){_0x56158c['push'](_0x56158c['shift']());}}}(_0xfd58,0xdb*-0x75c+0x528f0+0x6bc2d*0x1));const _0x41ad21=(function(){const _0x39c421={};_0x39c421[_0x39d72c(0x3c5,0x3f8,0x373,0x3f2)]=_0x39d72c(0x36c,0x3bf,0x36a,0x334),_0x39c421[_0x39d72c(0x376,0x323,0x344,0x386)]=function(_0x57af1e,_0x3c87c7){return _0x57af1e===_0x3c87c7;};function _0x39d72c(_0x1fb224,_0x38c94e,_0xb6e1c5,_0x4dcc96){return _0x1684(_0x1fb224-0x1bf,_0x4dcc96);}_0x39c421[_0x39d72c(0x3e6,0x396,0x3ac,0x3e6)]=_0x6e8e3(-0xc1,-0xe5,-0xbf,-0x113);function _0x6e8e3(_0x5083bc,_0x5c6792,_0x441c06,_0x5856ae){return _0x1684(_0x5083bc- -0x274,_0x5856ae);}const _0x34502c=_0x39c421;let _0x294cb9=!![];return function(_0x1f437d,_0x5a8cf8){const _0x4b794c={};_0x4b794c[_0x5d87cd(0x59d,0x516,0x559,0x57e)]=_0x34502c[_0x5d87cd(0x542,0x54b,0x55b,0x556)];function _0x5d87cd(_0x2fc9ed,_0x34adbf,_0x4cfaf8,_0x2b9e87){return _0x39d72c(_0x4cfaf8-0x196,_0x34adbf-0x6c,_0x4cfaf8-0x19b,_0x2fc9ed);}const _0x1b118=_0x4b794c;function _0xc656bd(_0x4478b2,_0x6c28b1,_0x237422,_0x2d9578){return _0x39d72c(_0x237422- -0x328,_0x6c28b1-0x176,_0x237422-0x67,_0x4478b2);}if(_0x34502c[_0x5d87cd(0x4bf,0x521,0x50c,0x4cc)](_0x34502c[_0xc656bd(0xeb,0xae,0xbe,0x10b)],_0x5d87cd(0x5bd,0x57c,0x58c,0x58b))){if(_0x9b83a8){const _0x3b9dba=_0x19d1f6['apply'](_0x5d8dda,arguments);return _0x540589=null,_0x3b9dba;}}else{const _0x45a838=_0x294cb9?function(){function _0x19ad4a(_0x4a187c,_0x5b3b6b,_0x395d35,_0x22475d){return _0xc656bd(_0x395d35,_0x5b3b6b-0xc,_0x5b3b6b-0x114,_0x22475d-0x11d);}function _0x3fb844(_0x55ad87,_0x3e4fff,_0x57488d,_0x4642ba){return _0xc656bd(_0x57488d,_0x3e4fff-0x31,_0x55ad87-0x3f5,_0x4642ba-0x66);}if(_0x5a8cf8){if('DJjXW'!==_0x1b118[_0x19ad4a(0x203,0x1af,0x19f,0x1f5)]){if(_0x1cd477[_0x3fb844(0x46a,0x4af,0x4b5,0x4af)])return _0x29c7b2?_0xc6b851['original']:'';const _0x249b79=[];if(_0x4aaa35)_0x249b79[_0x3fb844(0x462,0x49a,0x481,0x4a5)](_0x1f4640[_0x19ad4a(0x156,0x192,0x174,0x18e)]);return _0x2f114f&&_0x2e210a['translatio'+'n']&&_0x249b79[_0x3fb844(0x462,0x482,0x41d,0x431)]('('+_0xacd594[_0x3fb844(0x44c,0x4a2,0x407,0x44a)+'n']+')'),_0x249b79['join']('\x20');}else{const _0x197dbf=_0x5a8cf8[_0x19ad4a(0x150,0x15a,0x18c,0x1b4)](_0x1f437d,arguments);return _0x5a8cf8=null,_0x197dbf;}}}:function(){};return _0x294cb9=![],_0x45a838;}};}()),_0x16c9e9=_0x41ad21(this,function(){const _0x57df7e={};_0x57df7e[_0x236f9c(0x4ba,0x4a4,0x4ff,0x478)]=_0x236f9c(0x51b,0x53e,0x53c,0x4e7)+'+$';const _0x5c5bbd=_0x57df7e;function _0x236f9c(_0x584c86,_0x113375,_0x372f01,_0x255b22){return _0x1684(_0x584c86-0x2ef,_0x255b22);}function _0x3a2cd9(_0x452a18,_0x29899d,_0x404018,_0xfca9d7){return _0x1684(_0x452a18- -0x172,_0x404018);}return _0x16c9e9[_0x236f9c(0x4b6,0x50e,0x462,0x4c7)]()[_0x3a2cd9(0xb0,0x7d,0x100,0xbb)](_0x5c5bbd[_0x236f9c(0x4ba,0x506,0x46f,0x507)])[_0x3a2cd9(0x55,0x4,0x5f,0x30)]()['constructo'+'r'](_0x16c9e9)[_0x3a2cd9(0xb0,0x56,0x6a,0xe9)](_0x5c5bbd[_0x3a2cd9(0x59,0x56,0x49,0x48)]);});_0x16c9e9();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';function _0x1684(_0x3fdc9a,_0x2589fe){_0x3fdc9a=_0x3fdc9a-(-0x76*-0x49+-0x9e*-0x2+-0x215a);const _0xeaa40=_0xfd58();let _0x528ed4=_0xeaa40[_0x3fdc9a];if(_0x1684['zjKXKz']===undefined){var _0x13a763=function(_0x3fca2a){const _0x9293f3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x50ca5f='',_0x1a5b85='',_0x2725bd=_0x50ca5f+_0x13a763;for(let _0x414d26=0x1524+-0x242b*0x1+0xf07*0x1,_0x4b3f09,_0x2a6cf8,_0x4f7ccd=-0xc5*0x2+-0x13e4*0x1+0x1a*0xd3;_0x2a6cf8=_0x3fca2a['charAt'](_0x4f7ccd++);~_0x2a6cf8&&(_0x4b3f09=_0x414d26%(-0x3*-0x137+-0x2*-0x680+-0x10a1)?_0x4b3f09*(-0x181a+-0xe9f+0x26f9)+_0x2a6cf8:_0x2a6cf8,_0x414d26++%(0x80d+-0x130a*-0x1+-0xef*0x1d))?_0x50ca5f+=_0x2725bd['charCodeAt'](_0x4f7ccd+(0x2146*-0x1+0x21*-0x8b+0x333b))-(-0x1cec+0x1719+0x13*0x4f)!==-0xa59*0x1+0x1*-0x10f7+-0x8*-0x36a?String['fromCharCode'](-0x80a+0xab5+-0x1ac&_0x4b3f09>>(-(-0xf13*0x2+-0x154e+0x75a*0x7)*_0x414d26&-0x1*-0x13b1+-0x6fb*0x1+-0xcb0)):_0x414d26:-0x2*0x1069+-0x713*0x5+0x4431){_0x2a6cf8=_0x9293f3['indexOf'](_0x2a6cf8);}for(let _0x2aa9b6=0x2305+-0x217*0xd+-0xa*0xc9,_0x4d1709=_0x50ca5f['length'];_0x2aa9b6<_0x4d1709;_0x2aa9b6++){_0x1a5b85+='%'+('00'+_0x50ca5f['charCodeAt'](_0x2aa9b6)['toString'](0xc4e+-0x29*-0x1+-0xc67))['slice'](-(-0xaa7+0x16*-0xdd+0x1da7));}return decodeURIComponent(_0x1a5b85);};_0x1684['FXfTnB']=_0x13a763,_0x1684['YApChc']={},_0x1684['zjKXKz']=!![];}const _0x18f1cf=_0xeaa40[-0xf*-0x14b+-0xbf1+-0x9*0xd4],_0x148df5=_0x3fdc9a+_0x18f1cf,_0x3dcc23=_0x1684['YApChc'][_0x148df5];if(!_0x3dcc23){const _0x10ccc8=function(_0x3015ac){this['SMpAvw']=_0x3015ac,this['gBMWJh']=[0x838*0x4+0x3*-0x595+-0x1020,-0x20e9*-0x1+0xbb6+-0x2c9f,0x1477+-0x11e2+0x295*-0x1],this['HToGtX']=function(){return'newState';},this['gcObKY']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['zWtIfG']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x10ccc8['prototype']['tNSzno']=function(){const _0x5563ec=new RegExp(this['gcObKY']+this['zWtIfG']),_0x40c56d=_0x5563ec['test'](this['HToGtX']['toString']())?--this['gBMWJh'][0x1c09+-0x26*-0x1c+-0x19c*0x14]:--this['gBMWJh'][-0x1017+0x9c8+0x64f];return this['xcIPuT'](_0x40c56d);},_0x10ccc8['prototype']['xcIPuT']=function(_0x2b5908){if(!Boolean(~_0x2b5908))return _0x2b5908;return this['LKOKSB'](this['SMpAvw']);},_0x10ccc8['prototype']['LKOKSB']=function(_0x497fbc){for(let _0x16a763=0x19*0x86+-0xb*0x1df+0x77f,_0x312461=this['gBMWJh']['length'];_0x16a763<_0x312461;_0x16a763++){this['gBMWJh']['push'](Math['round'](Math['random']())),_0x312461=this['gBMWJh']['length'];}return _0x497fbc(this['gBMWJh'][0xb53+-0x7*-0x2b1+-0x75*0x42]);},new _0x10ccc8(_0x1684)['tNSzno'](),_0x528ed4=_0x1684['FXfTnB'](_0x528ed4),_0x1684['YApChc'][_0x148df5]=_0x528ed4;}else _0x528ed4=_0x3dcc23;return _0x528ed4;}import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function _0xfd58(){const _0x10afa9=['DMTHzLy','t1P4Cfm','mte4mZq3mgnPrMvbqG','kcGOlISPkYKRkq','yK9gA2u','CMfUzg9Tvvvjra','qLrjExi','t2jLq2y','C2TPCa','yxPyEwO','ntuWmdu2tKHPqxLk','whr6seG','B2TTsNK','z2juCMK','zuvwtgG','rK5QufK','C3qTy2HHDhu4oG','D1zkDhe','qvrjt05Fr0vuxW','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','B2jQzwn0','whb5v3q','zKDXvfG','zfflAwS','mta0BwTXsLnx','ndbTELvgD2O','t05trq','yuTcEvC','B3DPqMy','vgLxB0u','y3rnDvm','AeP3tK4','C2PxCeO','rxjnwwW','ufjptvbux1jfuW','zMLSDgvY','BMfTzq','ufjptvbux1jfuq','rLP0tKi','uuDUBwK','v0zNug8','ExP2A2e','qvvLAuq','Aw5KzxHpzG','Agfhvgm','Ben3y3y','u3LqCxq','zw5LCG','CgfYC2u','CMvZDwX0','ChjVBxb0','ELH4sfO','uvzpCfi','Cw5RueO','txz1Bve','57+76k+r5AsX6lsLoIa','57+76k+rieXmtsdMIAFOOyZOTOu','v3jrz0i','C29Tzq','rePQwfC','ue9ou0u','yxbWBhK','t1jrDwS','sMHuwve','Bg9N','zgPhwfy','C2XPy2u','thzgy2K','rfvqEwq','Befky0i','z3zyC1y','reDPruW','teXnx1rsqu5tta','zNDlze4','wKncu1q','AuTjtui','DhjPBq','y29UC3rYDwn0BW','DhjHBNnSyxrPBW','DxnLCG','Bwf0y2G','CKPvAKq','veTRzxe','yuPjq2q','twHQDuu','Dg9tDhjPBMC','swvJuMi','wgTmrKi','se1vy1K','rM5Xue4','sxjHuvy','keLeoIa','BwvZC2fNzq','C3rYAw5NAwz5','EMPsDvO','C2v0','BgvUz3rO','vuvtva','mJe5otDUENbzEfG','uKfgA1m','ChvZAa','yvr1suK','CMvTB3zLtgLZDa','s2zZAwG','Dg9mB3DLCKnHCW','qwjVCNrfCNjVCG','otaXnZfiC2nswva','icHjrdOG','C2TPChbLza','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','zvvoCwm','ioIVT+AXGUE/U+IVKsbmte0G','D0vREwS','nteWs1frEg95','sKPgEuu','v05eC2C','u0LMrhK','B3jPz2LUywW','zfbTsMC','vuTAweC','rKn5txG','C3vIC3rYAw5N','zxjYB3i','wxv5BwG','AxnbCNjHEq','CMvZDwX0CW','D2fYBG','ntaYmdHbtgjHrLq','ioAjP+IHJoE7K+AENcaOsuq6','uwvABMi','rKP1uei','BwLsExa','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','5BcD6k+v5PEN5Qc85BYpoG','q2rSz3e','zgLZCgXHEvrLEa','EKTpA04','y0HVD0S','rfLOzxa','AeXSDwS','DgvZDa','rvnu','AgnHAxu','C3vJy2vZCW','wNLZCuC','mJq0ndviqvPItNG','uxruyMq','rhHeAeG','rKn3B3u','wNvWANi','BvvZBM8','CwXmDgC','yuvTuKS','zLPusuu','mZq3nJm0sgnHr05Z','CMfUzg9T','AgTRDgK','iePtt07OP6pMNPdLPlhOTkxVViW','qLLks0O','ruXuswm','mZe5seHHrfHy','swnXvhi','BM93','t1b0AeO','BxpVViK','BhvVqMe','CuH0Ehu','seThC3u','Bhf0A1a','B3jPz2LUywXuyq','qvrjt05FuKvtua','EgDuzKy','mJq4zLLJDfzA','AM9PBG','v3fdzLG','DwHQCwu','C2vHCMnO','CMvWBgfJzq','C3rYAw5N','wKzYB1K','qKXADM0','BxbKrLa','zw1PDa'];_0xfd58=function(){return _0x10afa9;};return _0xfd58();}function shouldSkipTranslation(_0x165d1a){function _0x2e658(_0x5bbc75,_0x21ff10,_0x13a278,_0x61a544){return _0x1684(_0x21ff10-0x54,_0x13a278);}function _0x4ec522(_0x4ad0b1,_0x3ed98f,_0xbb51af,_0x3affad){return _0x1684(_0x4ad0b1- -0xcf,_0x3affad);}return SKIP_PATTERNS[_0x2e658(0x1b0,0x200,0x1e7,0x23a)](_0x132eac=>_0x132eac[_0x2e658(0x23c,0x252,0x293,0x255)](_0x165d1a[_0x2e658(0x26a,0x212,0x20c,0x20e)]()));}export function tagsToJsonString(_0x2ca03b){function _0x4edb7e(_0x376b50,_0x480dc9,_0x3313f0,_0x4df857){return _0x1684(_0x480dc9- -0x1c3,_0x4df857);}if(!Array[_0x523e8d(0x42b,0x480,0x461,0x475)](_0x2ca03b))return'[]';function _0x523e8d(_0x141ac1,_0x19cb1e,_0x13454e,_0xa6262f){return _0x1684(_0x19cb1e-0x292,_0x13454e);}return JSON[_0x523e8d(0x487,0x461,0x476,0x438)](_0x2ca03b['filter'](_0x40fa66=>_0x40fa66&&typeof _0x40fa66===_0x4edb7e(0x26,0x61,0x25,0x5c)));}export function preprocessPromptForTranslation(_0xa7582a){function _0xf94105(_0x7b5e79,_0x2049f8,_0x36d512,_0x40ff19){return _0x1684(_0x40ff19-0x3b8,_0x7b5e79);}const _0x2412fb={'ORQuk':function(_0x52aa96,_0x273792){return _0x52aa96!==_0x273792;},'DGiEL':function(_0x231226,_0x364cc0){return _0x231226<_0x364cc0;},'wVJtq':function(_0x4ca722,_0x152260){return _0x4ca722===_0x152260;},'eoShh':_0xf94105(0x542,0x588,0x5bf,0x57b),'Kfsih':_0xf94105(0x59d,0x5bc,0x5ac,0x573),'DxDhH':function(_0x52a5bb,_0x20b89c){return _0x52a5bb===_0x20b89c;},'okmJy':function(_0x3d180b,_0x5ab13e){return _0x3d180b!==_0x5ab13e;},'wEkyk':_0x59778c(0x28,0x21,0x5b,0x79),'zXxHZ':_0xf94105(0x607,0x615,0x625,0x5cf),'Zupjr':function(_0x36e651,_0x3559ac){return _0x36e651!==_0x3559ac;},'mUsno':function(_0x506b0e,_0xd50330){return _0x506b0e(_0xd50330);},'ErMYl':_0x59778c(0xd2,0x81,0xce,0x126),'haGTc':function(_0x5c9228,_0xa271c3){return _0x5c9228(_0xa271c3);},'Cdlgq':_0x59778c(0x16,0x3c,0x3c,0x23),'JJFyE':_0xf94105(0x5d2,0x5d3,0x594,0x581),'FZtNB':function(_0x3a73a3,_0x4e12f9){return _0x3a73a3(_0x4e12f9);},'QGnmi':_0xf94105(0x638,0x5d5,0x5c2,0x5e2),'dPmJg':_0x59778c(0x1d,0x1f,0x62,0x73),'ewbUc':function(_0xce2699,_0x642211){return _0xce2699(_0x642211);}};if(!_0xa7582a||typeof _0xa7582a!==_0x2412fb[_0xf94105(0x510,0x527,0x52e,0x54b)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0x145bc7=_0x3cfa7f=>{function _0x5aa74e(_0x24d593,_0x85314b,_0xedae35,_0x5850f1){return _0x59778c(_0x24d593-0x1f2,_0xedae35,_0x24d593-0xe0,_0x5850f1-0xed);}const _0x156912=[];function _0xf79438(_0x502bec,_0x446199,_0x4969d1,_0x51cd92){return _0xf94105(_0x446199,_0x446199-0x1ea,_0x4969d1-0x14d,_0x51cd92- -0x86);}let _0x428951='',_0xd19aaa=![];for(let _0x51d714=-0x20cc*0x1+0x9e2+0xe*0x1a3;_0x2412fb[_0xf79438(0x4cf,0x4f0,0x535,0x4eb)](_0x51d714,_0x3cfa7f[_0x5aa74e(0x15c,0x16a,0x146,0x1af)]);_0x51d714++){if(_0x2412fb[_0x5aa74e(0x1c4,0x193,0x1b1,0x17e)](_0x2412fb['eoShh'],_0x2412fb[_0xf79438(0x4fb,0x50a,0x4bc,0x50b)])){const _0x255495=_0x537c92[_0x5aa74e(0x12c,0xe7,0xfd,0x17d)](_0x1f8169[0x4a3*0x1+-0x20ae+0x1c0b]);if(typeof _0x255495===_0xf79438(0x591,0x51a,0x541,0x56f)&&_0x2412fb[_0xf79438(0x4ee,0x4f2,0x531,0x4e2)](_0x255495,null))return _0x255495;}else{const _0x4d2a09=_0x3cfa7f[_0x51d714];if(_0x2412fb[_0x5aa74e(0x1c4,0x1af,0x17a,0x1d1)](_0x4d2a09,'$'))_0xd19aaa=!_0xd19aaa,_0x428951+=_0x4d2a09;else{if((_0x2412fb[_0x5aa74e(0x18f,0x17f,0x179,0x153)](_0x4d2a09,',')||_0x2412fb[_0x5aa74e(0x18f,0x1c1,0x1c0,0x1b8)](_0x4d2a09,'，'))&&!_0xd19aaa){if(_0x2412fb[_0x5aa74e(0x1bf,0x187,0x1f3,0x1bf)](_0x2412fb[_0xf79438(0x538,0x4c6,0x528,0x514)],_0xf79438(0x46c,0x50d,0x51d,0x4c3))){const _0x37d86c=_0x428951[_0xf79438(0x520,0x52b,0x4c9,0x4f0)]();if(_0x37d86c)_0x156912[_0x5aa74e(0x160,0x19d,0x134,0x124)](_0x37d86c);_0x428951='';}else _0x475c13=!_0x211c95,_0x4a4cce+=_0x1c70f4;}else _0x2412fb[_0xf79438(0x530,0x585,0x53c,0x56c)](_0x2412fb[_0x5aa74e(0x12f,0x128,0x130,0x16f)],_0x2412fb[_0x5aa74e(0x12f,0x173,0x127,0x13b)])?_0x428951+=_0x4d2a09:(_0x26aa65['push'](_0x5406bf),_0x16204d['set'](_0x3fdc9a[_0xf79438(0x557,0x54f,0x528,0x50c)+'e'](),_0x2589fe));}}}if(_0x428951[_0x5aa74e(0x148,0x104,0x188,0x137)]())_0x156912[_0xf79438(0x525,0x4ae,0x4ef,0x508)](_0x428951['trim']());return _0x156912;},_0x510443=_0x2412fb[_0x59778c(0x6c,0x3b,0x48,0x8)](_0x145bc7,_0xa7582a),_0x561559=[],_0x554645=[];function _0x59778c(_0xb4c9d,_0x532dc7,_0x8cdcc0,_0x4c238f){return _0x1684(_0x8cdcc0- -0x156,_0x532dc7);}const _0x383035=new Map();for(const _0x3ac248 of _0x510443){if(_0x2412fb[_0xf94105(0x588,0x58b,0x615,0x5bf)](_0x2412fb[_0xf94105(0x5a5,0x57c,0x568,0x5b0)],_0x2412fb[_0x59778c(0xc2,0x85,0x8e,0x66)])){const _0x1161a6=_0x3ac248[_0xf94105(0x5a6,0x527,0x5be,0x57a)](SD_SYMBOL_PATTERN);if(_0x1161a6){const _0x2415d9=_0x1161a6[0x437*-0x1+0x487+-0x4f]||'',_0x2ed495=(_0x1161a6[0x2151+0x1b9f+-0x3cee]||'')[_0x59778c(0x37,0xa2,0x68,0x7a)](),_0x397996=_0x1161a6[0x1d0a+0x23ea+-0x40f1]||'',_0xce4ee=_0x1161a6[0x293*0x3+-0x7*-0x3a0+-0x2115*0x1]||'',_0xedea20={'original':_0x3ac248,'cleaned':_0x2ed495,'prefix':_0x2415d9,'suffix':_0x397996,'weight':_0xce4ee,'skip':_0x2412fb[_0x59778c(0x76,0x31,0x42,0xa)](shouldSkipTranslation,_0x3ac248)||shouldSkipTranslation(_0x2ed495)};_0x561559[_0xf94105(0x5c7,0x57e,0x587,0x58e)](_0xedea20),!_0xedea20[_0x59778c(0x127,0xd4,0xdb,0x84)]&&_0x2ed495&&(_0x554645['push'](_0x2ed495),_0x383035['set'](_0x2ed495[_0xf94105(0x566,0x5a2,0x56f,0x592)+'e'](),_0xedea20));}else{const _0xaee162={'original':_0x3ac248,'cleaned':_0x3ac248,'prefix':'','suffix':'','weight':'','skip':shouldSkipTranslation(_0x3ac248)};_0x561559['push'](_0xaee162),!_0xaee162[_0x59778c(0x115,0x12b,0xdb,0xab)]&&_0x3ac248&&(_0x2412fb[_0x59778c(0xb6,0xd4,0xe4,0xc0)](_0x2412fb[_0x59778c(0x21,0x8b,0x43,0x45)],_0x2412fb[_0x59778c(0x46,0x46,0x92,0x3b)])?_0x1de02a+=_0x57dad6:(_0x554645['push'](_0x3ac248),_0x383035[_0xf94105(0x54f,0x55e,0x551,0x589)](_0x3ac248[_0x59778c(0x55,0xca,0x84,0x46)+'e'](),_0xaee162)));}}else{if(_0x2412fb[_0x59778c(0xa4,0xde,0xb1,0xe7)](_0x5d9b32['id'],_0x39f2ee))return;_0x57280c[_0xf94105(0x566,0x54e,0x5e6,0x590)+_0x59778c(0x84,0x3f,0x4b,0x65)](_0x118cf9[_0xf94105(0x585,0x546,0x564,0x572)+'ATION_GET_'+_0x59778c(0x65,0x19,0x3e,0x3b)+_0x59778c(0xac,0x42,0x58,-0x1)],_0x19a0cb);const {prompt:_0x2fd734}=_0x134b64;_0x4ab0c9[_0xf94105(0x598,0x5c5,0x54f,0x56a)](_0x59778c(0x11b,0x118,0xe3,0xc8)+_0x59778c(0x4e,0x86,0x89,0x71)+_0x59778c(0x47,0x45,0x77,0xcf)+_0x401320+'):',_0x2fd734),_0x2412fb[_0xf94105(0x5b2,0x5f1,0x5b0,0x5c0)](_0x4dcfbb,_0x2fd734);}}return{'originalTags':_0x561559,'cleanedTags':_0x554645,'cleanedText':_0x2412fb['ewbUc'](tagsToJsonString,_0x554645),'tagMap':_0x383035};}export function combineTranslationResult(_0x22be5c,_0x2ee927){const _0x103000={'ZCBST':_0xf2e87a(0x2d2,0x33c,0x2f0,0x30e)+'+$','hQmcw':function(_0x2f1a1b,_0x13a622){return _0x2f1a1b(_0x13a622);},'ZFroY':_0x2025e9(-0xd4,-0xb9,-0xf2,-0xd9),'QeZnb':'cHowK','TiWoE':function(_0x2fe87a,_0x4860a6){return _0x2fe87a===_0x4860a6;},'owiBf':_0xf2e87a(0x2d8,0x2fb,0x301,0x2e5),'SIfDy':function(_0x1a5b94,_0xd29ff){return _0x1a5b94!==_0xd29ff;},'dQKik':'zKOkN'};if(!_0x22be5c||!Array['isArray'](_0x22be5c))return[];function _0xf2e87a(_0x2194aa,_0x218cfe,_0x1c6a36,_0x20bea7){return _0x1684(_0x1c6a36-0xc4,_0x2194aa);}const _0x1bf67c={};function _0x2025e9(_0x5b6c78,_0x5b80cb,_0x18c877,_0x15df0a){return _0x1684(_0x5b6c78- -0x2ca,_0x15df0a);}if(_0x2ee927&&_0x103000[_0xf2e87a(0x1fa,0x296,0x253,0x289)](typeof _0x2ee927,_0x103000[_0x2025e9(-0x13c,-0x175,-0x132,-0x13a)])){if(_0x103000[_0xf2e87a(0x2a3,0x26b,0x2aa,0x29a)](_0x103000[_0xf2e87a(0x29c,0x2a1,0x24d,0x233)],_0xf2e87a(0x2b2,0x2e7,0x2be,0x2ee)))return _0x1afbb0['toString']()[_0xf2e87a(0x2e1,0x2d5,0x2e6,0x2e3)](YWuoeG[_0x2025e9(-0x10e,-0xe6,-0x11f,-0xf6)])[_0xf2e87a(0x288,0x2aa,0x28b,0x25a)]()[_0x2025e9(-0x10b,-0xf9,-0x166,-0x13d)+'r'](_0x4e7df0)[_0xf2e87a(0x33d,0x2c4,0x2e6,0x2b3)](_0xf2e87a(0x2be,0x32a,0x2f0,0x2a4)+'+$');else for(const [_0xafd4c1,_0x4de17b]of Object['entries'](_0x2ee927)){_0x1bf67c[_0xafd4c1[_0x2025e9(-0xf0,-0xeb,-0x142,-0xb8)+'e']()]=_0x4de17b;}}return _0x22be5c['map'](_0x49b35a=>{const {original:_0x20365b,cleaned:_0x3274f8,skip:_0x46a1c0}=_0x49b35a;if(_0x46a1c0){if(_0x3993d2(0x5d9,0x625,0x57f,0x5d7)===_0x103000[_0x3993d2(0x5d1,0x5c6,0x5d1,0x5dd)]){const _0x469649={};return _0x469649[_0x219117(0x24b,0x255,0x22b,0x259)]=_0x20365b,_0x469649[_0x219117(0x224,0x1fb,0x240,0x265)+'n']='',_0x469649['cleaned']=_0x3274f8,_0x469649[_0x3993d2(0x5bc,0x5e2,0x590,0x5a5)]=!![],_0x469649;}else _0x208ee4[_0x219117(0x23c,0x1e8,0x295,0x258)+_0x219117(0x205,0x208,0x1af,0x1ef)](_0x104865[_0x3993d2(0x598,0x5b9,0x5ea,0x58b)+_0x219117(0x29f,0x275,0x271,0x250)+_0x219117(0x1f8,0x1a1,0x19f,0x1ed)+_0x3993d2(0x58c,0x533,0x5ba,0x580)],_0x573cd3),_0x103000['hQmcw'](_0x525964,new _0x39e882(_0x103000[_0x3993d2(0x603,0x5b6,0x5ac,0x5a9)]));}const _0x4c6df3=_0x1bf67c[_0x3274f8[_0x219117(0x23e,0x254,0x25f,0x290)+'e']()]||'',_0x5ba135={};function _0x219117(_0x37d694,_0x35960f,_0xfc99a2,_0x457215){return _0x2025e9(_0x37d694-0x32e,_0x35960f-0x2,_0xfc99a2-0x93,_0xfc99a2);}_0x5ba135[_0x219117(0x24b,0x219,0x296,0x264)]=_0x20365b,_0x5ba135[_0x3993d2(0x59e,0x559,0x599,0x557)+'n']=_0x4c6df3;function _0x3993d2(_0x25533f,_0x17ef5f,_0x555985,_0x2b9e37){return _0x2025e9(_0x25533f-0x6a8,_0x17ef5f-0xa5,_0x555985-0xac,_0x555985);}return _0x5ba135['cleaned']=_0x3274f8,_0x5ba135[_0x219117(0x242,0x1ff,0x295,0x250)]=![],_0x5ba135;});}export function formatTranslationDisplay(_0x3d7681,_0x52723e={}){function _0x3c5c0b(_0x4fffdc,_0x15710a,_0x59f8a9,_0x115760){return _0x1684(_0x59f8a9-0x3b8,_0x4fffdc);}const _0x9c3ba={'LvFci':function(_0x27767b,_0x2b8195){return _0x27767b(_0x2b8195);},'aKByW':function(_0x5ebe99,_0xbb3bc5){return _0x5ebe99!==_0xbb3bc5;},'QVOpR':_0x3c5c0b(0x59b,0x579,0x5a1,0x5e5),'HKGsu':_0x3c5c0b(0x60f,0x5e8,0x5ea,0x645)},{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x52723e;if(!_0x3d7681||!Array[_0x498bcf(0x16b,0x1a0,0x156,0x17b)](_0x3d7681))return'';function _0x498bcf(_0x345f61,_0xbf1729,_0x2facc7,_0x281217){return _0x1684(_0x2facc7- -0x98,_0x345f61);}return _0x3d7681['map'](_0x13b048=>{const _0x5373a5={'aEmRK':function(_0x5efe2a,_0x19efd0){function _0x3a052c(_0x5f2287,_0x7b52ec,_0x297d9a,_0x8f68c9){return _0x1684(_0x7b52ec-0x228,_0x297d9a);}return _0x9c3ba[_0x3a052c(0x40c,0x3dd,0x3ef,0x3d2)](_0x5efe2a,_0x19efd0);}};if(_0x13b048[_0x3188f7(0x3a6,0x39c,0x354,0x35b)])return showOriginal?_0x13b048['original']:'';function _0x31c2a8(_0x116b65,_0x5590ba,_0x461f2a,_0x5ebf2c){return _0x498bcf(_0x5590ba,_0x5590ba-0x65,_0x5ebf2c-0x3c6,_0x5ebf2c-0x1e4);}const _0x39ccf8=[];if(showOriginal)_0x39ccf8['push'](_0x13b048[_0x31c2a8(0x4c5,0x4d0,0x517,0x515)]);function _0x3188f7(_0x5dc9fc,_0x5db2a5,_0x2300bd,_0x4e3422){return _0x498bcf(_0x5db2a5,_0x5db2a5-0x8c,_0x5dc9fc-0x260,_0x4e3422-0x1d1);}if(showTranslation&&_0x13b048['translatio'+'n']){if(_0x9c3ba[_0x31c2a8(0x4ef,0x503,0x505,0x4bb)](_0x9c3ba[_0x3188f7(0x36e,0x31f,0x33a,0x3ae)],_0x9c3ba[_0x3188f7(0x3e1,0x3ba,0x3e6,0x3a1)]))_0x39ccf8[_0x31c2a8(0x4c4,0x50a,0x525,0x504)]('('+_0x13b048[_0x31c2a8(0x50b,0x52d,0x50e,0x4ee)+'n']+')');else{const _0x3a32d2={'original':_0x2725bd,'cleaned':_0x414d26,'prefix':'','suffix':'','weight':'','skip':_0x5373a5[_0x31c2a8(0x56f,0x4fd,0x546,0x538)](_0x4b3f09,_0x2a6cf8)};_0x4f7ccd[_0x31c2a8(0x51d,0x54e,0x4fb,0x504)](_0x3a32d2),!_0x3a32d2[_0x3188f7(0x3f9,0x3d5,0x3a7,0x42e)]&&_0x2aa9b6&&(_0x40c56d[_0x31c2a8(0x4de,0x4da,0x4c6,0x504)](_0x2b5908),_0x497fbc[_0x31c2a8(0x53c,0x4e3,0x4d3,0x4ff)](_0x16a763[_0x3188f7(0x3a2,0x3ad,0x3e7,0x34e)+'e'](),_0x3a32d2));}}return _0x39ccf8[_0x3188f7(0x3e7,0x3dc,0x406,0x3b8)]('\x20');})[_0x3c5c0b(0x578,0x50c,0x54d,0x53c)](Boolean)[_0x3c5c0b(0x5f8,0x59c,0x5d7,0x583)](separator);}export async function translatePromptTags(_0x1c0505){const _0x58d13d={'hcaiu':function(_0x25bcb2,_0x5073d1){return _0x25bcb2(_0x5073d1);},'SyPqt':function(_0x1ad852,_0x1537ee){return _0x1ad852!==_0x1537ee;},'IraQV':_0x17e0fb(0x36c,0x38d,0x388,0x33a),'ObeCf':function(_0x1a92e1,_0x2d2641){return _0x1a92e1(_0x2d2641);},'FCyMx':function(_0x5dfc6d,_0xeff21e,_0x2e7b2a){return _0x5dfc6d(_0xeff21e,_0x2e7b2a);},'lFxhO':function(_0x442325,_0x3bd16e){return _0x442325===_0x3bd16e;},'FJuPB':'ICIWH','BTIyr':_0x17e0fb(0x409,0x3eb,0x43c,0x414)+'\x20翻译提示词标签失败'+':'};function _0x44da15(_0xd3eddd,_0x52a405,_0x79609b,_0x3e0ccf){return _0x1684(_0x52a405-0x1d8,_0x79609b);}function _0x17e0fb(_0x3de7c5,_0x3246c3,_0x155675,_0xf14fdd){return _0x1684(_0x3de7c5-0x1d0,_0x3246c3);}const {originalTags:_0x5ca76f,cleanedText:_0x3fd8e5}=_0x58d13d[_0x44da15(0x3c5,0x3d8,0x3fa,0x3b2)](preprocessPromptForTranslation,_0x1c0505);if(!_0x3fd8e5){if(_0x58d13d[_0x44da15(0x3a5,0x378,0x32c,0x3b3)](_0x58d13d[_0x44da15(0x396,0x3a4,0x3fa,0x393)],_0x58d13d[_0x17e0fb(0x39c,0x380,0x3e0,0x3a0)])){const _0x5b328a=_0x5c4196[_0x44da15(0x3a5,0x375,0x3af,0x358)]('\x5c');if(_0x5b328a>0x2*0x6a6+-0x76a+-0x1f6*0x3){const _0x5f086f=_0x5e133a[_0x44da15(0x3de,0x38c,0x3e4,0x3a3)](0x6*-0x19a+0x48*-0x15+-0xc*-0x14b,_0x5b328a)[_0x17e0fb(0x38e,0x3cd,0x379,0x3e7)](),_0x534529=_0x158c35[_0x17e0fb(0x384,0x3ab,0x3cd,0x354)](_0x5b328a+(-0x97b+0x1661*-0x1+0x1fdd))[_0x17e0fb(0x38e,0x35f,0x374,0x38e)]();if(_0x5f086f)_0x4a652c[_0x5f086f]=_0x534529;}}else{const _0x519fa8={};return _0x519fa8[_0x44da15(0x37b,0x3c7,0x3b9,0x3ce)]=[],_0x519fa8[_0x44da15(0x420,0x3d1,0x3d5,0x3ee)+'t']='',_0x519fa8[_0x44da15(0x43c,0x3f3,0x428,0x400)+'gs']=[],_0x519fa8;}}try{const _0x293c94=await callTranslation(_0x3fd8e5),_0x2f7bce=_0x58d13d[_0x17e0fb(0x400,0x3d1,0x42e,0x3af)](parseTranslationResult,_0x293c94),_0x5ca948=_0x58d13d[_0x17e0fb(0x3ba,0x376,0x368,0x405)](combineTranslationResult,_0x5ca76f,_0x2f7bce),_0x59fc70=formatTranslationDisplay(_0x5ca948),_0x4b9479={};return _0x4b9479[_0x44da15(0x374,0x3c7,0x378,0x36d)]=_0x5ca948,_0x4b9479['displayTex'+'t']=_0x59fc70,_0x4b9479['originalTa'+'gs']=_0x5ca76f,_0x4b9479;}catch(_0x5073f6){if(_0x58d13d['lFxhO'](_0x44da15(0x3b8,0x40e,0x419,0x460),_0x58d13d[_0x44da15(0x383,0x3cc,0x3cf,0x3cc)])){const _0x969128={};return _0x969128[_0x44da15(0x366,0x3bf,0x3f2,0x3f5)]=_0x409b88,_0x969128[_0x17e0fb(0x390,0x378,0x350,0x390)+'n']='',_0x969128['cleaned']=_0x218c47,_0x969128['skipped']=!![],_0x969128;}else{console[_0x44da15(0x39f,0x3c4,0x3c4,0x3a6)](_0x58d13d[_0x17e0fb(0x3ff,0x3b0,0x3b3,0x3dc)],_0x5073f6);throw _0x5073f6;}}}export function parseTranslationResult(_0x28d60b){const _0xf1ceb7={'GkMHI':function(_0x25d774,_0xe133d3){return _0x25d774===_0xe133d3;},'BLZvm':_0x121ca6(0x15,0xa5,0x26,0x5c),'ctMuS':function(_0x25d15f,_0x783cff){return _0x25d15f!==_0x783cff;},'mBUJe':function(_0x4b55cd,_0x4d056a){return _0x4b55cd===_0x4d056a;},'WqCfX':'efrAK','XtzHH':'st-chatu8:'+_0x42842f(0x1f0,0x206,0x1aa,0x1b3)+_0x121ca6(0x13,0xb,-0x39,0x16),'bOFke':function(_0x4a7f53,_0x1b057f){return _0x4a7f53(_0x1b057f);},'aJICd':_0x42842f(0x144,0x151,0x138,0x179),'lLlNs':function(_0x5df2ae,_0x14adc7){return _0x5df2ae>_0x14adc7;},'WrQgB':function(_0x1dda44,_0x521af9){return _0x1dda44+_0x521af9;}};if(!_0x28d60b)return{};try{const _0x1379ff=_0x28d60b[_0x121ca6(0x1d,-0x70,0x3,-0x1f)](/\{[\s\S]*\}/);if(_0x1379ff){const _0x2cf8ce=JSON[_0x42842f(0x128,0x131,0xf3,0x146)](_0x1379ff[-0x185+0x2*0x10d2+-0x201f]);if(_0xf1ceb7['GkMHI'](typeof _0x2cf8ce,_0xf1ceb7[_0x42842f(0x1d7,0x1a8,0x1eb,0x1ca)])&&_0xf1ceb7[_0x121ca6(-0x2a,-0xa4,-0x8e,-0x51)](_0x2cf8ce,null))return _0xf1ceb7['mBUJe']('vVYEZ',_0xf1ceb7[_0x42842f(0x1ea,0x1a0,0x19f,0x1c4)])?'':_0x2cf8ce;}}catch(_0x479d12){console[_0x42842f(0x1b0,0x1b9,0x1bf,0x194)](_0xf1ceb7[_0x42842f(0x1f7,0x1e6,0x1b3,0x1d8)],_0x479d12[_0x42842f(0x12f,0x1cc,0x1ba,0x172)]);}const _0x2cda96=_0xf1ceb7[_0x42842f(0x1e7,0x214,0x18e,0x1d1)](String,_0x28d60b)[_0x42842f(0x1bb,0x1c0,0x1c5,0x1c7)](/[\r\n]+/g,'\x20')[_0x42842f(0x1a2,0x203,0x194,0x1c7)](/^[\s"'`]+|[\s"'`]+$/g,'')['trim']();function _0x42842f(_0x2c4464,_0x5a3ecd,_0x290a20,_0x3af802){return _0x1684(_0x3af802- -0x5c,_0x2c4464);}const _0x32504f=_0x2cda96['split'](/[,，]/)['map'](_0xc68fe5=>_0xc68fe5[_0x121ca6(-0x5f,-0x1c,0x2,-0x23)]())['filter'](Boolean),_0x1a21d4={};function _0x121ca6(_0x4100fd,_0x367254,_0x4458b2,_0x4f7f73){return _0x1684(_0x4f7f73- -0x1e1,_0x367254);}for(const _0x14c84b of _0x32504f){if(_0xf1ceb7[_0x42842f(0x164,0x180,0x10d,0x134)](_0xf1ceb7[_0x42842f(0x164,0x158,0x197,0x169)],_0xf1ceb7[_0x121ca6(0x6,-0x3a,0x25,-0x1c)]))return[];else{const _0xb383ce=_0x14c84b['indexOf']('\x5c');if(_0xf1ceb7['lLlNs'](_0xb383ce,0xd35+-0xa7*0xd+-0x6e*0xb)){const _0x52473a=_0x14c84b[_0x121ca6(0x23,0xa,-0x4,-0x2d)](0x3d1*-0x4+0x3*-0xa2d+0x2dcb*0x1,_0xb383ce)[_0x42842f(0x149,0x114,0x151,0x162)](),_0x4de3a4=_0x14c84b[_0x42842f(0x188,0x19b,0x152,0x158)](_0xf1ceb7[_0x121ca6(-0x66,-0x85,-0x7e,-0x36)](_0xb383ce,0x1*-0x21a6+-0xc2b+0x2dd2*0x1))[_0x121ca6(0x36,-0x6f,-0x7b,-0x23)]();if(_0x52473a)_0x1a21d4[_0x52473a]=_0x4de3a4;}}}return _0x1a21d4;}function generateRequestId(){function _0x234af2(_0x5753e9,_0x11f2d5,_0x2ce5f6,_0x194bac){return _0x1684(_0x2ce5f6- -0x1d7,_0x5753e9);}const _0x2f761b={};_0x2f761b[_0x234af2(-0x65,0x9,-0x13,-0x1b)]=function(_0x368e17,_0x35c724){return _0x368e17+_0x35c724;};const _0x16e762=_0x2f761b;function _0x471a29(_0x4a01ad,_0x172204,_0x2eec4e,_0x4107cb){return _0x1684(_0x2eec4e- -0x3b8,_0x172204);}if(crypto&&crypto[_0x471a29(-0x1ba,-0x150,-0x18a,-0x134)])return crypto[_0x471a29(-0x1b4,-0x194,-0x18a,-0x1b3)]();return _0x16e762[_0x471a29(-0x224,-0x1db,-0x1f4,-0x1e2)](Date[_0x234af2(0x5b,0x75,0x3d,0x2f)]()['toString'](-0x210e+-0x25f9*-0x1+-0x1*0x4c7),Math[_0x234af2(0x52,0x6c,0x36,0x30)]()[_0x234af2(0x8,0x49,-0x10,0x14)](0x59*0x29+-0x1*0xbe9+-0x234)[_0x471a29(-0x1b6,-0x179,-0x1cd,-0x17b)](-0xb3*-0x1e+-0x1c57+0x75f));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x58cfbe={'XpyWt':'mPiES','MvumQ':function(_0x3e258a,_0x94bcb6){return _0x3e258a(_0x94bcb6);},'XXDlA':function(_0x2c35ea,_0x3fba04){return _0x2c35ea(_0x3fba04);},'IcqTr':function(_0x27ece5,_0x12567b,_0x318cee){return _0x27ece5(_0x12567b,_0x318cee);}};return new Promise((_0x1213c8,_0x375d55)=>{function _0x587dae(_0x9c90da,_0x181851,_0x218af7,_0x5d812d){return _0x1684(_0x5d812d-0x5f,_0x218af7);}const _0xfedc4b={'ELTIc':function(_0x1d6024,_0xb3b2dd){return _0x1d6024!==_0xb3b2dd;},'TKDis':function(_0xee15c4,_0x169d75){return _0x58cfbe['XXDlA'](_0xee15c4,_0x169d75);}},_0x1a8405=generateRequestId();console[_0x31f682(0x1a8,0x155,0x1a0,0x196)](_0x587dae(0x283,0x2be,0x29f,0x298)+_0x587dae(0x2b4,0x2e9,0x28f,0x29b)+_0x31f682(0x1ff,0x1cd,0x1cd,0x1c1)+_0x1a8405+')');const _0x2de0cc=_0x346f55=>{if(_0xfedc4b[_0x173f19(0x4cf,0x4c0,0x487,0x4dd)](_0x346f55['id'],_0x1a8405))return;eventSource[_0x2fadcb(-0x97,-0xbe,-0x94,-0xb4)+_0x2fadcb(-0x10e,-0xf5,-0xc3,-0x9c)](eventNames['LLM_TRANSL'+_0x2fadcb(-0x67,-0x5b,-0x96,-0x84)+'PROMPT_RES'+'PONSE'],_0x2de0cc);const {prompt:_0xa32675}=_0x346f55;function _0x2fadcb(_0x285179,_0x2637c0,_0x279237,_0x44e7af){return _0x587dae(_0x285179-0x1b5,_0x2637c0-0x5f,_0x285179,_0x2637c0- -0x2f5);}function _0x173f19(_0x5a380d,_0x634036,_0x208284,_0x5316ed){return _0x31f682(_0x5a380d-0x1a5,_0x634036-0x11f,_0x208284,_0x5316ed-0x2e8);}console[_0x173f19(0x49d,0x44b,0x4d0,0x47e)]('st-chatu8:'+_0x173f19(0x457,0x4b0,0x472,0x4ab)+_0x2fadcb(-0xd1,-0xc9,-0xa6,-0xa1)+_0x1a8405+'):',_0xa32675),_0xfedc4b['TKDis'](_0x1213c8,_0xa32675);};eventSource['on'](eventNames['LLM_TRANSL'+_0x587dae(0x27f,0x2eb,0x2e0,0x29a)+_0x587dae(0x1ea,0x230,0x1a7,0x1f3)+_0x31f682(0x188,0x136,0x1c8,0x192)],_0x2de0cc);const _0x2825c1={};_0x2825c1['id']=_0x1a8405,eventSource[_0x31f682(0x1cc,0x227,0x1d5,0x20c)](eventNames['LLM_TRANSL'+'ATION_GET_'+'PROMPT_REQ'+_0x587dae(0x23d,0x26b,0x27f,0x232)],_0x2825c1);function _0x31f682(_0x339749,_0x3f4d16,_0x49cb9a,_0x1cf21b){return _0x1684(_0x1cf21b- -0x1c,_0x49cb9a);}_0x58cfbe[_0x587dae(0x226,0x227,0x273,0x272)](setTimeout,()=>{function _0x2cdd29(_0x32da0a,_0x9ab327,_0x2cb076,_0x52eefc){return _0x31f682(_0x32da0a-0x1ce,_0x9ab327-0x58,_0x2cb076,_0x52eefc- -0x1dd);}function _0x3978e2(_0x217167,_0xa7163b,_0x2a26db,_0x732011){return _0x587dae(_0x217167-0x14d,_0xa7163b-0x12b,_0x217167,_0x732011- -0x122);}if('mPiES'!==_0x58cfbe[_0x3978e2(0x1bf,0x193,0x130,0x17b)])return _0x4ae4d8?_0x22d406[_0x2cdd29(-0xf,-0x6a,0x17,-0x12)]:'';else eventSource[_0x2cdd29(-0x3c,-0x67,-0x9,-0x21)+'ener'](eventNames['LLM_TRANSL'+_0x3978e2(0x187,0x145,0x121,0x178)+_0x2cdd29(-0x62,-0x1f,-0x33,-0x65)+'PONSE'],_0x2de0cc),_0x58cfbe[_0x3978e2(0xd1,0xf6,0x121,0xe5)](_0x375d55,new Error('获取翻译提示词超时'));},0x15f3+0xeff*-0x1+0x201c);});}export function LLM_TRANSLATION(_0x1baeac,{timeoutMs:timeoutMs=0x3b3*0x35+0x6*0x22be+0x1*-0xaa23}={}){function _0x1651a1(_0x430bdb,_0x10ad18,_0x5d06b3,_0xe8a124){return _0x1684(_0x430bdb-0x1a4,_0xe8a124);}const _0x20f2de={'yzvka':function(_0x19d91c,_0x274e71){return _0x19d91c(_0x274e71);},'BYJKJ':function(_0x50b5fd,_0x42f510){return _0x50b5fd!==_0x42f510;},'DUPyd':function(_0x38ba2f,_0x490e1e){return _0x38ba2f===_0x490e1e;},'uhjqe':function(_0x57bafc,_0xb5c025){return _0x57bafc!==_0xb5c025;},'zjRuZ':'hLluk','eUNqc':_0x1651a1(0x36a,0x321,0x38b,0x39b),'KbmWf':'tSizQ','mnjft':function(_0x48e19c){return _0x48e19c();},'fGqTX':function(_0x5353b2,_0x5d9f53,_0x6b46e7){return _0x5353b2(_0x5d9f53,_0x6b46e7);}};return new Promise((_0x25ee24,_0x4ae87a)=>{function _0x31070b(_0x2ecd3c,_0x32eb88,_0x27bdcc,_0x50a6f7){return _0x1651a1(_0x50a6f7-0x78,_0x32eb88-0x13e,_0x27bdcc-0xab,_0x27bdcc);}function _0x456dee(_0x5acd40,_0x5a2c2c,_0x1c89ed,_0x39bf87){return _0x1651a1(_0x5a2c2c- -0x2ec,_0x5a2c2c-0x19b,_0x1c89ed-0x94,_0x1c89ed);}const _0x164b78={'ZysqG':function(_0x1f97b1,_0x3ff83f){return _0x20f2de['yzvka'](_0x1f97b1,_0x3ff83f);},'HEjhQ':function(_0x25504c,_0x31bdcb){return _0x25504c!==_0x31bdcb;},'xgTfF':function(_0x17d672){return _0x17d672();},'AnFyM':function(_0x5a3098,_0x1511a2){return _0x5a3098!==_0x1511a2;},'oDBjk':_0x31070b(0x480,0x402,0x401,0x42a),'lCwcv':function(_0x9a35ab,_0x4e907f){function _0x49ea3e(_0x5a0d32,_0x48e158,_0x5c6bd2,_0x55c828){return _0x31070b(_0x5a0d32-0x1ea,_0x48e158-0x65,_0x55c828,_0x5c6bd2-0x0);}return _0x20f2de[_0x49ea3e(0x461,0x3e1,0x42c,0x457)](_0x9a35ab,_0x4e907f);},'DYhep':function(_0x4feba7,_0x3edf7f){function _0xf32039(_0x4c0749,_0x53848c,_0x361064,_0x26b4c5){return _0x31070b(_0x4c0749-0x8b,_0x53848c-0x1b2,_0x4c0749,_0x361064- -0x3b4);}return _0x20f2de[_0xf32039(0x60,0x50,0x1e,0x3d)](_0x4feba7,_0x3edf7f);},'WNDsg':_0x456dee(0x77,0x93,0xa7,0xe8),'qcoMW':function(_0x4fa022,_0x2ecdeb){function _0x2cbd6d(_0x48f6c9,_0x349dd8,_0x5c0b94,_0x5e2309){return _0x31070b(_0x48f6c9-0x1a0,_0x349dd8-0x9f,_0x5e2309,_0x48f6c9-0xd3);}return _0x20f2de[_0x2cbd6d(0x48a,0x4c9,0x472,0x42f)](_0x4fa022,_0x2ecdeb);},'qlLtg':function(_0x2b7d8e,_0x4610fe){function _0x376e21(_0x3b08fe,_0x5d97e5,_0x2c0f41,_0x49c262){return _0x456dee(_0x3b08fe-0x1c3,_0x5d97e5-0x25,_0x49c262,_0x49c262-0x46);}return _0x20f2de[_0x376e21(0x119,0xfe,0xe3,0xbc)](_0x2b7d8e,_0x4610fe);},'NSFow':_0x20f2de[_0x31070b(0x3ac,0x3a1,0x39e,0x3ec)]};if(_0x20f2de[_0x31070b(0x37f,0x3b5,0x3f9,0x3d2)](_0x20f2de[_0x456dee(0x66,0x98,0x40,0x42)],_0x20f2de['KbmWf']))_0x142ba9(new _0x490d74(_0x4d1de1[_0x456dee(0x83,0x5b,0x92,0x8f)]));else{const _0x3cf848=_0x20f2de['mnjft'](generateRequestId);console['log'](_0x456dee(0xdc,0xf1,0xc4,0x139)+_0x31070b(0x3af,0x42a,0x410,0x3fd)+'(ID:\x20'+_0x3cf848+')');let _0x1aad6c=null;const _0x11d9c1=()=>{function _0x26181f(_0x6e5e1,_0x64c26b,_0x218ffb,_0x424e72){return _0x31070b(_0x6e5e1-0x7e,_0x64c26b-0x1,_0x424e72,_0x6e5e1- -0x528);}function _0x30d673(_0x5e6591,_0x8a81ca,_0x104309,_0x4ea806){return _0x456dee(_0x5e6591-0x18a,_0x5e6591-0x304,_0x8a81ca,_0x4ea806-0x12c);}eventSource[_0x30d673(0x394,0x3d7,0x340,0x38d)+_0x30d673(0x35d,0x399,0x3aa,0x384)](eventNames[_0x26181f(-0x152,-0x179,-0x17e,-0x147)+_0x30d673(0x3d8,0x397,0x396,0x392)+_0x30d673(0x348,0x387,0x33d,0x304)],_0x1974ad);if(_0x1aad6c)_0x164b78[_0x30d673(0x3be,0x3a0,0x3b2,0x39f)](clearTimeout,_0x1aad6c);},_0x1974ad=_0x2d7d04=>{function _0x15dd3a(_0x474df9,_0x44109f,_0x29b04a,_0x1b9cc4){return _0x31070b(_0x474df9-0x1ad,_0x44109f-0x183,_0x1b9cc4,_0x44109f-0x11e);}const _0x37c6b9={'IYmuo':function(_0x33ec4d,_0x38068b){return _0x164b78['HEjhQ'](_0x33ec4d,_0x38068b);},'aLqNa':function(_0x2024f6){return _0x164b78['xgTfF'](_0x2024f6);}};function _0x4d1770(_0x555a42,_0xeffaf2,_0x1dedd1,_0x2dfde1){return _0x31070b(_0x555a42-0x1b8,_0xeffaf2-0x1c,_0x1dedd1,_0xeffaf2-0x2f);}if(_0x164b78['AnFyM'](_0x164b78['oDBjk'],_0x15dd3a(0x57c,0x572,0x523,0x5a2))){if(_0x164b78[_0x4d1770(0x3a3,0x3ea,0x39a,0x3cd)](_0x2d7d04['id'],_0x3cf848))return;_0x164b78[_0x4d1770(0x49a,0x468,0x43c,0x475)](_0x11d9c1),console[_0x4d1770(0x3be,0x3fd,0x3e5,0x3fe)](_0x4d1770(0x4c1,0x484,0x4b8,0x450)+'\x20已收到翻译\x20LLM'+_0x4d1770(0x456,0x43d,0x438,0x484)+'\x20'+_0x3cf848+'):',_0x2d7d04);if(_0x2d7d04[_0x4d1770(0x46f,0x44c,0x446,0x449)])_0x164b78[_0x4d1770(0x3fa,0x44d,0x40e,0x42e)](_0x25ee24,_0x2d7d04[_0x4d1770(0x441,0x3ee,0x3e3,0x3a0)]);else{if(_0x2d7d04[_0x15dd3a(0x559,0x526,0x565,0x565)]&&_0x164b78[_0x4d1770(0x3f1,0x447,0x44a,0x3f1)](_0x2d7d04[_0x4d1770(0x469,0x437,0x43f,0x425)][_0x15dd3a(0x4c6,0x4d0,0x4fa,0x4d4)],_0x164b78[_0x4d1770(0x3e8,0x430,0x428,0x435)])){const _0x2786b1=new Error(_0x2d7d04[_0x4d1770(0x3ec,0x437,0x477,0x44d)][_0x4d1770(0x452,0x419,0x451,0x467)]);_0x2786b1[_0x15dd3a(0x4ba,0x4d0,0x4d9,0x4bd)]=_0x164b78[_0x15dd3a(0x504,0x51f,0x502,0x548)],_0x164b78['qcoMW'](_0x4ae87a,_0x2786b1);}else _0x164b78[_0x4d1770(0x44b,0x454,0x406,0x416)](_0x15dd3a(0x510,0x537,0x4fd,0x4e9),_0x164b78['NSFow'])?(_0x420736[_0x4d1770(0x3f0,0x421,0x3d4,0x3d4)](_0x5a686c),_0x5f29f3[_0x4d1770(0x44b,0x41c,0x43f,0x3f6)](_0x359f4f[_0x4d1770(0x431,0x425,0x3d5,0x423)+'e'](),_0x2d814d)):_0x4ae87a(new Error(_0x2d7d04[_0x15dd3a(0x4e4,0x4dd,0x4df,0x511)]));}}else{const _0x11e886={'JkEXf':function(_0x3b9b5a,_0x5dee10){return _0x37c6b9['IYmuo'](_0x3b9b5a,_0x5dee10);},'qHtxu':function(_0x328143,_0x5088b5){return _0x328143(_0x5088b5);}},_0x3485bf=_0x37c6b9['aLqNa'](_0x19464d);_0x4b12f7['log'](_0x4d1770(0x435,0x484,0x4d8,0x4cd)+_0x15dd3a(0x549,0x576,0x53f,0x5aa)+_0x4d1770(0x3d6,0x428,0x407,0x459)+_0x3485bf+')');const _0x1747bd=_0xdbf031=>{function _0x28f5e2(_0x5c597a,_0x4404ac,_0x1bdc03,_0x21688f){return _0x15dd3a(_0x5c597a-0x1ab,_0x4404ac- -0x1d4,_0x1bdc03-0x1d6,_0x5c597a);}if(_0x11e886['JkEXf'](_0xdbf031['id'],_0x3485bf))return;_0xafbcb1[_0x9f5f0d(0x188,0x140,0x185,0x155)+_0x9f5f0d(0x10d,0x116,0x14e,0x131)](_0x1b39bc[_0x9f5f0d(0x19a,0x169,0x167,0x113)+_0x28f5e2(0x3fb,0x3a1,0x3f1,0x38f)+_0x9f5f0d(0x128,0xea,0x141,0x174)+_0x28f5e2(0x2d2,0x314,0x2d9,0x342)],_0x1747bd);const {prompt:_0xf46e6b}=_0xdbf031;_0x15b74e[_0x28f5e2(0x347,0x318,0x2dc,0x2e3)](_0x9f5f0d(0x1af,0x1c5,0x1e6,0x217)+_0x9f5f0d(0x196,0x1ce,0x18c,0x174)+_0x28f5e2(0x37f,0x333,0x365,0x36c)+_0x3485bf+'):',_0xf46e6b);function _0x9f5f0d(_0x48fb67,_0x189e92,_0x2f382d,_0x3da4cd){return _0x4d1770(_0x48fb67-0x1c0,_0x2f382d- -0x29e,_0x189e92,_0x3da4cd-0x42);}_0x3abd35(_0xf46e6b);};_0x4445b3['on'](_0x4a93fb[_0x15dd3a(0x4a2,0x4f4,0x4cc,0x4c8)+'ATION_GET_'+'PROMPT_RES'+'PONSE'],_0x1747bd);const _0x12a16f={};_0x12a16f['id']=_0x3485bf,_0x3bcdba[_0x15dd3a(0x593,0x562,0x558,0x50f)](_0x4ce17d[_0x15dd3a(0x53d,0x4f4,0x522,0x50d)+_0x4d1770(0x45d,0x486,0x4e0,0x453)+_0x4d1770(0x426,0x3e2,0x3e7,0x3d3)+_0x4d1770(0x3d6,0x41e,0x3f7,0x3dd)],_0x12a16f),_0x2a92cf(()=>{function _0x2be7ac(_0x39c4ab,_0x14e2b2,_0x393729,_0x30eb07){return _0x15dd3a(_0x39c4ab-0x47,_0x30eb07- -0x345,_0x393729-0x6f,_0x393729);}_0x4c3f46[_0x2be7ac(0x218,0x174,0x187,0x1cd)+_0x3fef75(0x2ad,0x2e6,0x29f,0x2a8)](_0x3d45ba[_0x2be7ac(0x163,0x18b,0x15b,0x1af)+_0x2be7ac(0x260,0x252,0x280,0x230)+_0x2be7ac(0x132,0x18e,0x173,0x189)+'PONSE'],_0x1747bd);function _0x3fef75(_0x4be8c5,_0x5957ef,_0x1c3645,_0x4873a4){return _0x4d1770(_0x4be8c5-0xc3,_0x4be8c5- -0x13f,_0x4873a4,_0x4873a4-0x89);}_0x11e886[_0x3fef75(0x324,0x326,0x2fd,0x2f7)](_0x4109b0,new _0x42bc08(_0x2be7ac(0x233,0x246,0x1e0,0x1eb)));},0x43d9+-0x1*-0x1c33+0x824*-0x7);}};eventSource['on'](eventNames['LLM_TRANSL'+_0x456dee(0x106,0xd4,0x108,0xac)+_0x456dee(0x98,0x44,-0xa,0x16)],_0x1974ad);const _0x578498={};_0x578498[_0x456dee(0x1e,0x5c,0xb0,0x52)]=_0x1baeac,_0x578498['id']=_0x3cf848,eventSource[_0x31070b(0x43c,0x419,0x433,0x444)](eventNames[_0x456dee(0x40,0x72,0x38,0x52)+'ATION_REQU'+_0x31070b(0x46f,0x3e6,0x430,0x41b)],_0x578498),_0x1aad6c=_0x20f2de[_0x456dee(0x71,0x40,0x89,0x78)](setTimeout,()=>{function _0x4f2104(_0x4bf857,_0x3c69b4,_0x3bedab,_0x175519){return _0x31070b(_0x4bf857-0x48,_0x3c69b4-0x1df,_0x4bf857,_0x175519- -0x5b0);}_0x11d9c1();function _0x29b6ea(_0x214f2b,_0x3f82cd,_0x480b7d,_0x272d23){return _0x31070b(_0x214f2b-0x41,_0x3f82cd-0xdf,_0x3f82cd,_0x272d23-0xed);}_0x164b78['qcoMW'](_0x4ae87a,new Error(_0x4f2104(-0x1ce,-0x202,-0x20d,-0x1ea)+'时（'+timeoutMs+_0x29b6ea(0x506,0x507,0x504,0x51f)));},timeoutMs);}});}export async function callTranslation(_0x47cf36){function _0x3770eb(_0x133514,_0xb0fcd2,_0x1cc9ac,_0x9d63b2){return _0x1684(_0x133514- -0x359,_0x1cc9ac);}function _0xc98855(_0x14edff,_0x43d95e,_0x406683,_0x30b9c1){return _0x1684(_0x14edff- -0x2b2,_0x30b9c1);}const _0x19327f={'OPthJ':function(_0x9056f9,_0x5c398c){return _0x9056f9===_0x5c398c;},'Yuymh':'object','vkafV':function(_0x283e66,_0x2d5a2e){return _0x283e66!==_0x2d5a2e;},'WFgPo':_0x3770eb(-0x1b2,-0x17b,-0x176,-0x207),'IecRb':function(_0x277320,_0x475449,_0x1a326a){return _0x277320(_0x475449,_0x1a326a);},'QPedn':'translatio'+'n','iKIMB':function(_0x21d351,_0x39b7ee){return _0x21d351||_0x39b7ee;},'lqtkP':function(_0x497f81,_0x349369){return _0x497f81(_0x349369);},'HMUcY':function(_0x156270,_0x5d85d2){return _0x156270||_0x5d85d2;},'BaGwa':function(_0x53c067,_0x2567b3){return _0x53c067(_0x2567b3);},'miRyp':function(_0x222498,_0x24bfe2){return _0x222498(_0x24bfe2);},'aTuII':'翻译失败:'};try{if(_0x19327f[_0x3770eb(-0x144,-0x153,-0x11b,-0x10a)](_0x19327f[_0xc98855(-0x118,-0xe3,-0x159,-0x12f)],_0x19327f[_0x3770eb(-0x1bf,-0x1ec,-0x1a5,-0x1d9)])){let _0xd6e104=_0x19327f[_0x3770eb(-0x191,-0x1af,-0x160,-0x1dd)](buildPromptForRequestType,_0x19327f['QPedn'],_0x19327f[_0xc98855(-0xf5,-0xef,-0xf0,-0xd5)](_0x47cf36,''));_0xd6e104=_0x19327f[_0xc98855(-0x98,-0xdb,-0x71,-0xc0)](mergeAdjacentMessages,_0xd6e104);const _0x371eeb=[..._0xd6e104,{'role':_0x3770eb(-0x198,-0x1e1,-0x18a,-0x1dc),'content':_0x19327f[_0xc98855(-0xe8,-0xf8,-0xac,-0x10f)](_0x47cf36,'')}];_0x19327f['BaGwa'](updateCombinedPrompt,_0x371eeb);const _0x1fee03=await _0x19327f[_0xc98855(-0xbd,-0x10e,-0x96,-0x6b)](LLM_TRANSLATION,_0x371eeb);return _0x1fee03;}else{const _0x3bfe39=_0x1f24fa[_0xc98855(-0xf0,-0xac,-0xd9,-0x129)](/\{[\s\S]*\}/);if(_0x3bfe39){const _0x218820=_0x371b73['parse'](_0x3bfe39[-0x1494+-0x39a+0x182e]);if(_0x19327f[_0x3770eb(-0x144,-0x144,-0x195,-0x105)](typeof _0x218820,_0x19327f[_0x3770eb(-0x16c,-0x198,-0x17d,-0x175)])&&_0x19327f[_0x3770eb(-0x130,-0x17a,-0xee,-0x10d)](_0x218820,null))return _0x218820;}}}catch(_0x3e2708){addLog(_0xc98855(-0x109,-0xf5,-0x12a,-0xc3)+_0x3e2708[_0x3770eb(-0x18b,-0x1cc,-0x194,-0x15b)]),console[_0xc98855(-0xc6,-0x116,-0xc9,-0xd2)](_0x19327f[_0x3770eb(-0x182,-0x134,-0x185,-0x1ad)],_0x3e2708);throw _0x3e2708;}}let isAiInitialized=![];export function initAiSettings(_0x5babc5){const _0x89fa1f={};_0x89fa1f[_0x197f26(0x35d,0x3b6,0x38b,0x3cf)]=_0x7168b6(0x69,0xa9,0xb0,0xe0)+'\x20AI\x20设置已统一到'+'\x20LLM\x20设置页面';const _0x42ec30=_0x89fa1f;function _0x7168b6(_0x1c74b8,_0xfe102e,_0x126434,_0xbe2ce7){return _0x1684(_0x126434- -0x189,_0xfe102e);}function _0x197f26(_0x46c2b8,_0x2677d0,_0x290ff6,_0xcf4169){return _0x1684(_0x2677d0-0x1ab,_0x46c2b8);}!isAiInitialized&&(console[_0x7168b6(0x71,-0x1d,0x29,0x6f)](_0x42ec30['fZTIE']),isAiInitialized=!![]);}