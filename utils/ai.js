(function(_0xb0a83a,_0x289157){function _0x88cc7c(_0x51915c,_0xc034eb,_0x4c21e9,_0x19bfec){return _0x4387(_0xc034eb- -0x281,_0x4c21e9);}const _0x2e7949=_0xb0a83a();function _0x40acd7(_0x32b140,_0x882f33,_0x4baab1,_0xf64460){return _0x4387(_0x32b140- -0x27d,_0xf64460);}while(!![]){try{const _0x4a7b95=-parseInt(_0x40acd7(-0x3f,-0x6f,-0x13,-0x5c))/(-0x7f0+0x49d+0x354)*(parseInt(_0x40acd7(-0x8b,-0xd5,-0xa2,-0xe1))/(0x1*-0xf52+-0x18e3+0x2837))+parseInt(_0x40acd7(-0xb5,-0x9e,-0x7b,-0xec))/(-0xe8e+0x993+0x4fe*0x1)*(-parseInt(_0x88cc7c(-0xb7,-0xb2,-0x8b,-0x88))/(-0x1842+0x13*-0x67+-0x1*-0x1feb))+-parseInt(_0x40acd7(-0xcf,-0x10d,-0x101,-0xcd))/(-0x1*0x659+0x7*-0x36f+0x1e67)*(-parseInt(_0x40acd7(-0xaa,-0xe5,-0xd3,-0xab))/(0x1*0x13a+0x15f1+-0x1725))+parseInt(_0x40acd7(-0xcc,-0x10c,-0x9c,-0xfb))/(-0x5e9*0x1+0x163*0x16+-0x1892)*(-parseInt(_0x40acd7(-0xce,-0xb4,-0x108,-0xb9))/(0x1*-0xf08+0x7e2+0x2*0x397))+-parseInt(_0x88cc7c(-0x9a,-0x69,-0xa3,-0x78))/(-0x8*0x25c+0x1a9b+0x2*-0x3d9)*(parseInt(_0x40acd7(-0xd5,-0x127,-0xf2,-0x113))/(-0x3*-0x55d+-0x4b*-0x51+-0x4*0x9f2))+-parseInt(_0x88cc7c(-0xb5,-0xbd,-0xad,-0xab))/(0x19e2+0x61c+-0x1ff3)*(parseInt(_0x40acd7(-0x56,-0x62,-0x8b,-0x3a))/(-0x1530+0x5b4+0xf88*0x1))+-parseInt(_0x88cc7c(-0x53,-0x93,-0xb8,-0x74))/(-0x15d8+0x1d65+-0x780)*(-parseInt(_0x40acd7(-0xcd,-0x9a,-0xac,-0xc5))/(0x1*0x2333+0xe5*-0x19+-0xcc8));if(_0x4a7b95===_0x289157)break;else _0x2e7949['push'](_0x2e7949['shift']());}catch(_0x4b0563){_0x2e7949['push'](_0x2e7949['shift']());}}}(_0x2dcf,0xd0*-0xdb1+-0x86c3c+-0x2f*-0x88df));const _0xc4cbc4=(function(){const _0x5a20ac={};function _0x2b7733(_0xcbb4b4,_0x2384d4,_0x8f7369,_0x3cc303){return _0x4387(_0x8f7369- -0x16c,_0xcbb4b4);}_0x5a20ac[_0x2b7733(0xd2,0xb9,0xcd,0x108)]=function(_0x4d3f1f,_0x15e67a){return _0x4d3f1f!==_0x15e67a;},_0x5a20ac[_0x2b7733(0x59,-0x4,0x3f,0x2a)]=_0x4e9513(0x78,0x49,0x2f,-0x8),_0x5a20ac[_0x4e9513(-0x9,0x35,0x38,0x53)]='zPaEa',_0x5a20ac['KEqcv']=_0x2b7733(0x7c,0xe9,0xbc,0xe6);function _0x4e9513(_0x37be43,_0x312088,_0x52fb9a,_0x54407e){return _0x4387(_0x312088- -0x1ac,_0x52fb9a);}_0x5a20ac['rnxsl']=_0x2b7733(0x88,0x89,0x3b,0x1b)+'\x20JSON解析失败，'+_0x4e9513(0xb5,0x8c,0xe4,0xba),_0x5a20ac[_0x2b7733(0xc4,0xd8,0xd9,0x10d)]=function(_0x3bd9a9,_0x594c03){return _0x3bd9a9!==_0x594c03;},_0x5a20ac[_0x4e9513(0x35,0x28,0x51,0x64)]=_0x2b7733(0x65,0x7b,0x6a,0xa9);const _0x597986=_0x5a20ac;let _0x1e2f29=!![];return function(_0x5f0d4a,_0x4cfd9e){function _0x114e99(_0x5922e4,_0x2c38bc,_0x128f6c,_0x54542b){return _0x2b7733(_0x2c38bc,_0x2c38bc-0x183,_0x5922e4-0x44c,_0x54542b-0x36);}function _0x2a4e37(_0x445566,_0x21c211,_0x1d9dcb,_0x370f9b){return _0x4e9513(_0x445566-0xab,_0x445566-0x4fe,_0x1d9dcb,_0x370f9b-0x14c);}const _0x19cefd={};_0x19cefd[_0x2a4e37(0x542,0x585,0x564,0x584)]=_0x597986[_0x114e99(0x4b1,0x4de,0x498,0x4e9)];const _0x1c7e96=_0x19cefd;if(_0x597986['vzsLQ'](_0x597986[_0x114e99(0x4b4,0x4e8,0x462,0x4da)],_0x2a4e37(0x5a2,0x5a5,0x5e5,0x570))){const _0xa9c278=_0x1e2f29?function(){function _0x507872(_0x4d7acb,_0x3651e8,_0x3db872,_0x1cf839){return _0x114e99(_0x1cf839- -0x697,_0x4d7acb,_0x3db872-0x19d,_0x1cf839-0xa4);}function _0x42977(_0x53cc38,_0x55b55f,_0x2355f5,_0x291b10){return _0x114e99(_0x291b10-0x36,_0x55b55f,_0x2355f5-0x166,_0x291b10-0x15b);}if(_0x597986['boTvQ'](_0x597986[_0x507872(-0x230,-0x203,-0x1b8,-0x20c)],'QPnhG')){if(_0x4cfd9e){if(_0x597986[_0x507872(-0x19a,-0x197,-0x1c5,-0x1d6)]===_0x597986[_0x507872(-0x1b8,-0x135,-0x154,-0x18d)])_0x913a1d[_0x507872(-0x156,-0x199,-0x15a,-0x19e)](_0x1c7e96[_0x507872(-0x1d1,-0x191,-0x1d4,-0x1c7)],_0x3239a9[_0x42977(0x53c,0x4d7,0x4b8,0x4eb)]);else{const _0x34d0e4=_0x4cfd9e[_0x507872(-0x1c0,-0x1c4,-0x196,-0x1e9)](_0x5f0d4a,arguments);return _0x4cfd9e=null,_0x34d0e4;}}}else _0x1d9dab+=_0x2a0728;}:function(){};return _0x1e2f29=![],_0xa9c278;}else{const {original:_0x1c80ce,cleaned:_0x313cb0,skip:_0x148b44}=_0x4259ab;if(_0x148b44){const _0x4b303c={};return _0x4b303c[_0x2a4e37(0x4f8,0x4fd,0x4ab,0x4d1)]=_0x1c80ce,_0x4b303c[_0x2a4e37(0x560,0x59f,0x524,0x5a9)+'n']='',_0x4b303c[_0x114e99(0x494,0x4e0,0x43f,0x4e7)]=_0x313cb0,_0x4b303c[_0x114e99(0x4ef,0x50b,0x510,0x533)]=!![],_0x4b303c;}const _0x16fedd=_0x21125e[_0x313cb0[_0x2a4e37(0x55d,0x56d,0x5a3,0x532)+'e']()]||'',_0xa57556={};return _0xa57556[_0x2a4e37(0x4f8,0x4b2,0x49f,0x513)]=_0x1c80ce,_0xa57556[_0x114e99(0x4ee,0x4df,0x538,0x4ee)+'n']=_0x16fedd,_0xa57556[_0x2a4e37(0x506,0x511,0x537,0x528)]=_0x313cb0,_0xa57556[_0x2a4e37(0x561,0x51a,0x561,0x50e)]=![],_0xa57556;}};}()),_0x47304c=_0xc4cbc4(this,function(){function _0x568bbc(_0x26d118,_0x36ab62,_0x4be9e9,_0x3d9f38){return _0x4387(_0x4be9e9-0x15d,_0x26d118);}function _0xb7880(_0x3a759d,_0x4c5671,_0x1498ca,_0x58d227){return _0x4387(_0x4c5671-0x22d,_0x3a759d);}return _0x47304c[_0xb7880(0x421,0x411,0x452,0x419)]()[_0x568bbc(0x31a,0x334,0x373,0x365)](_0xb7880(0x43e,0x44b,0x43d,0x3fc)+'+$')['toString']()['constructo'+'r'](_0x47304c)[_0xb7880(0x439,0x443,0x436,0x471)]('(((.+)+)+)'+'+$');});_0x47304c();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0xf72553){function _0x1aea34(_0x48fc42,_0x339ecb,_0x4b2214,_0x445ac0){return _0x4387(_0x4b2214- -0x343,_0x445ac0);}function _0x105de1(_0x3fb781,_0xc0b2cb,_0x3a3498,_0x303f6d){return _0x4387(_0x3fb781- -0x168,_0xc0b2cb);}return SKIP_PATTERNS[_0x1aea34(-0x17f,-0xfb,-0x129,-0x175)](_0x43f1f3=>_0x43f1f3[_0x1aea34(-0x139,-0x14d,-0x11f,-0xdb)](_0xf72553[_0x1aea34(-0xf5,-0xc1,-0xf5,-0xb8)]()));}export function tagsToJsonString(_0x256d1d){if(!Array[_0x4040af(0x509,0x50a,0x537,0x558)](_0x256d1d))return'[]';function _0x4040af(_0x24a7ac,_0x1cf6b2,_0x14ee95,_0x5de437){return _0x4387(_0x24a7ac-0x307,_0x5de437);}function _0x326bc5(_0x1ef62c,_0x4ddef6,_0x3cb4a0,_0x19e69f){return _0x4387(_0x1ef62c- -0x209,_0x19e69f);}return JSON[_0x326bc5(-0x27,-0x2a,-0x42,-0x6d)](_0x256d1d['filter'](_0x1b9977=>_0x1b9977&&typeof _0x1b9977===_0x326bc5(-0x4b,0x6,-0x86,-0x2b)));}export function preprocessPromptForTranslation(_0x3675bd){const _0xa06d5a={'DblVW':_0x1ac04e(0x519,0x4f8,0x542,0x4f0),'tCgLe':function(_0x136a6b,_0x48858e){return _0x136a6b(_0x48858e);},'LIpla':function(_0x21d90b,_0x1391cf){return _0x21d90b<_0x1391cf;},'vjpwc':function(_0x1fb48d,_0x35edd0){return _0x1fb48d!==_0x35edd0;},'mnPCj':_0x1ac04e(0x4ed,0x4e5,0x51b,0x543),'GfqyZ':function(_0x1a937e,_0x398379){return _0x1a937e===_0x398379;},'XvEow':function(_0x432965,_0x56a634){return _0x432965!==_0x56a634;},'sDMgN':function(_0x248e29,_0x277609){return _0x248e29(_0x277609);},'DuAam':function(_0x1f7f07,_0x1f3880){return _0x1f7f07(_0x1f3880);},'dkekW':'sNSDY','DNjIE':function(_0x5ee4c6,_0x433375){return _0x5ee4c6===_0x433375;},'FhyrM':_0x478347(-0x36,-0x70,-0x89,-0x47),'RzOYf':_0x1ac04e(0x4be,0x513,0x4b8,0x46d),'GcVpJ':function(_0xf05212,_0x15b54f){return _0xf05212!==_0x15b54f;},'eUkRN':'MniBl'};function _0x478347(_0x5f33bf,_0x5bde7f,_0x4ad70a,_0x2197d3){return _0x4387(_0x5bde7f- -0x29b,_0x2197d3);}if(!_0x3675bd||_0xa06d5a[_0x478347(-0x8e,-0x9d,-0x53,-0x4a)](typeof _0x3675bd,_0x1ac04e(0x4a2,0x4ce,0x4d4,0x458)))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0x58f881=_0x10ad85=>{const _0x1d1adb=[];function _0x5ea3e0(_0x448e7f,_0x416bca,_0x5bd457,_0x2102d4){return _0x478347(_0x448e7f-0x104,_0x448e7f-0x54c,_0x5bd457-0xbd,_0x2102d4);}let _0x1b28c4='',_0x1837fb=![];function _0x365fd7(_0x3a8ff9,_0x349e26,_0x18c125,_0x3a6ab5){return _0x1ac04e(_0x18c125-0xb4,_0x349e26-0xaf,_0x3a6ab5,_0x3a6ab5-0x146);}for(let _0x568086=0x247+-0x8ba*0x2+0x103*0xf;_0xa06d5a[_0x5ea3e0(0x4a7,0x4d7,0x45f,0x4e4)](_0x568086,_0x10ad85['length']);_0x568086++){if(_0xa06d5a[_0x365fd7(0x524,0x505,0x544,0x551)](_0xa06d5a['mnPCj'],_0x5ea3e0(0x4b5,0x493,0x4da,0x4a9))){const _0x12ba80=_0x10ad85[_0x568086];if(_0x12ba80==='$')_0xa06d5a[_0x5ea3e0(0x500,0x512,0x538,0x52e)](_0x5ea3e0(0x4c2,0x514,0x4f0,0x4d8),_0x365fd7(0x583,0x5b7,0x5ce,0x5f9))?(_0x1802a6[_0x5ea3e0(0x4b6,0x4d4,0x48d,0x46e)](_0xc4909c),_0x239ce8['set'](_0x5b9e34['toLowerCas'+'e'](),_0x31c231)):(_0x1837fb=!_0x1837fb,_0x1b28c4+=_0x12ba80);else{if((_0xa06d5a[_0x5ea3e0(0x500,0x536,0x4d7,0x4ec)](_0x12ba80,',')||_0x12ba80==='，')&&!_0x1837fb){if(_0x365fd7(0x53d,0x593,0x54d,0x58b)!=='vyiUG'){const _0x1480da=new _0x1b9f6f(_0x186d44[_0x365fd7(0x61c,0x621,0x5c8,0x616)][_0x365fd7(0x544,0x573,0x56d,0x5af)]);_0x1480da[_0x365fd7(0x5d8,0x579,0x593,0x53d)]=_0xa06d5a[_0x5ea3e0(0x477,0x4c9,0x442,0x466)],_0x103e46(_0x1480da);}else{const _0x5d1dba=_0x1b28c4[_0x5ea3e0(0x4ff,0x543,0x4a8,0x4dd)]();if(_0x5d1dba)_0x1d1adb[_0x365fd7(0x5e3,0x58a,0x59d,0x5df)](_0x5d1dba);_0x1b28c4='';}}else _0x1b28c4+=_0x12ba80;}}else{const _0x3a4fa6=_0x13c7c0[0x73e+0x4*0x257+0x7*-0x25f]||'',_0x2b0a0a=(_0xd3ea63[0x15f4*-0x1+0xe1c+0x6*0x14f]||'')[_0x5ea3e0(0x4ff,0x529,0x54e,0x4bb)](),_0x28efb6=_0x433317[-0x1*-0x74f+0x165+-0x8b1]||'',_0xe0d8cd=_0x18b058[-0x635+0x1d*0x8f+-0x9fa]||'',_0x18d5ec={'original':_0x30fac4,'cleaned':_0x2b0a0a,'prefix':_0x3a4fa6,'suffix':_0x28efb6,'weight':_0xe0d8cd,'skip':_0xa06d5a[_0x5ea3e0(0x47b,0x4d0,0x43f,0x4b0)](_0x24ba16,_0x18820f)||_0x152d37(_0x2b0a0a)};_0x3299bc[_0x365fd7(0x582,0x5e7,0x59d,0x5a2)](_0x18d5ec),!_0x18d5ec[_0x5ea3e0(0x488,0x474,0x434,0x454)]&&_0x2b0a0a&&(_0xcbee3d[_0x5ea3e0(0x4b6,0x49f,0x486,0x465)](_0x2b0a0a),_0x381e2a[_0x365fd7(0x624,0x5e0,0x5d7,0x587)](_0x2b0a0a[_0x5ea3e0(0x4bc,0x4eb,0x490,0x50b)+'e'](),_0x18d5ec));}}if(_0x1b28c4[_0x365fd7(0x59e,0x5ba,0x5e6,0x622)]())_0x1d1adb[_0x365fd7(0x553,0x5b5,0x59d,0x56d)](_0x1b28c4[_0x365fd7(0x5d8,0x629,0x5e6,0x592)]());return _0x1d1adb;},_0x1e39db=_0xa06d5a[_0x1ac04e(0x496,0x465,0x4bb,0x4b7)](_0x58f881,_0x3675bd),_0x145266=[],_0x124f55=[];function _0x1ac04e(_0x4ed54c,_0x50ffd6,_0x997f21,_0x491545){return _0x4387(_0x4ed54c-0x2e4,_0x997f21);}const _0x451419=new Map();for(const _0x4faa80 of _0x1e39db){const _0x397ba8=_0x4faa80[_0x478347(-0x5e,-0x93,-0xb7,-0x51)](SD_SYMBOL_PATTERN);if(_0x397ba8){const _0x403c53=_0x397ba8[-0x3fc*0x6+-0xcbd*0x2+0x3163]||'',_0x58b014=(_0x397ba8[-0x2e*-0xc4+-0x5c7*-0x5+0x3d*-0x10d]||'')[_0x1ac04e(0x532,0x4e8,0x50b,0x541)](),_0xce606e=_0x397ba8[0x1950+-0x59*-0x1+-0x62*0x43]||'',_0x3bbe2d=_0x397ba8[0x2e*0x25+0x1981+-0x2023]||'',_0x3b7207={'original':_0x4faa80,'cleaned':_0x58b014,'prefix':_0x403c53,'suffix':_0xce606e,'weight':_0x3bbe2d,'skip':_0xa06d5a['DuAam'](shouldSkipTranslation,_0x4faa80)||shouldSkipTranslation(_0x58b014)};_0x145266[_0x1ac04e(0x4e9,0x4dc,0x4bb,0x4e9)](_0x3b7207),!_0x3b7207[_0x1ac04e(0x4bb,0x4e7,0x500,0x486)]&&_0x58b014&&(_0xa06d5a[_0x478347(-0xcc,-0xcf,-0x11f,-0xc5)]===_0xa06d5a[_0x478347(-0x9c,-0xcf,-0xc1,-0xec)]?(_0x124f55[_0x1ac04e(0x4e9,0x4fd,0x500,0x521)](_0x58b014),_0x451419['set'](_0x58b014['toLowerCas'+'e'](),_0x3b7207)):_0x10952d[_0x122f59[_0x478347(-0x5a,-0x90,-0xd6,-0x9e)+'e']()]=_0x53238c);}else{if(_0xa06d5a[_0x478347(-0x79,-0x6c,-0x4c,-0x8f)](_0xa06d5a[_0x478347(-0x59,-0x67,-0x13,-0xb5)],_0xa06d5a[_0x478347(-0xde,-0xb1,-0xbd,-0xa5)]))_0x5a4142[_0x478347(-0x7d,-0x96,-0xeb,-0x8f)](_0x10fd8e),_0x2e85b4['set'](_0x17fe2e['toLowerCas'+'e'](),_0x4efc40);else{const _0x145b75={'original':_0x4faa80,'cleaned':_0x4faa80,'prefix':'','suffix':'','weight':'','skip':_0xa06d5a[_0x1ac04e(0x4ae,0x4bb,0x462,0x47a)](shouldSkipTranslation,_0x4faa80)};_0x145266[_0x1ac04e(0x4e9,0x4c5,0x504,0x49a)](_0x145b75);if(!_0x145b75[_0x478347(-0xe3,-0xc4,-0x110,-0x7a)]&&_0x4faa80){if(_0xa06d5a[_0x478347(-0xc9,-0x7b,-0x89,-0xc9)](_0x478347(-0x61,-0x51,-0x97,-0x2f),_0xa06d5a[_0x478347(-0x2d,-0x6f,-0x97,-0x78)])){if(_0x34acdd){const _0x520d92=_0x2f2daf[_0x1ac04e(0x4b2,0x4c7,0x493,0x4b0)](_0x22425d,arguments);return _0x2eb375=null,_0x520d92;}}else _0x124f55[_0x1ac04e(0x4e9,0x4b2,0x4b3,0x51c)](_0x4faa80),_0x451419[_0x1ac04e(0x523,0x52e,0x510,0x534)](_0x4faa80[_0x1ac04e(0x4ef,0x527,0x501,0x536)+'e'](),_0x145b75);}}}}return{'originalTags':_0x145266,'cleanedTags':_0x124f55,'cleanedText':_0xa06d5a['DuAam'](tagsToJsonString,_0x124f55),'tagMap':_0x451419};}export function combineTranslationResult(_0xe64dca,_0x1cf55b){const _0x5eb4b1={};_0x5eb4b1[_0x5ee79d(0x1c4,0x1e4,0x217,0x1e6)]=function(_0x53aa7a,_0x3c34c3){return _0x53aa7a===_0x3c34c3;};const _0x1bef11=_0x5eb4b1;if(!_0xe64dca||!Array[_0x5ee79d(0x1f9,0x1e0,0x24f,0x211)](_0xe64dca))return[];const _0x3313e0={};if(_0x1cf55b&&_0x1bef11['XMfAY'](typeof _0x1cf55b,_0xd9393e(-0x18e,-0x1b1,-0x1fe,-0x1c3)))for(const [_0x5367c3,_0x23cd2f]of Object[_0xd9393e(-0x194,-0x19b,-0x18e,-0x19e)](_0x1cf55b)){_0x3313e0[_0x5367c3[_0xd9393e(-0x200,-0x197,-0x209,-0x1b2)+'e']()]=_0x23cd2f;}function _0x5ee79d(_0x1a3348,_0x5c6352,_0x19609e,_0xee7989){return _0x4387(_0x1a3348- -0x9,_0x19609e);}function _0xd9393e(_0x4d1946,_0xcc50c0,_0x249453,_0x835769){return _0x4387(_0x835769- -0x3bd,_0xcc50c0);}return _0xe64dca[_0xd9393e(-0x195,-0x1bf,-0x181,-0x1d8)](_0x24b4ed=>{const {original:_0x137f00,cleaned:_0x53a538,skip:_0x4b1ad5}=_0x24b4ed;if(_0x4b1ad5){if(_0x5ac0f1(0x508,0x53d,0x53f,0x507)!==_0x26fa9b(0x1c4,0x1c1,0x1fa,0x1b4)){const _0xf55236={};return _0xf55236[_0x26fa9b(0x16c,0x1dd,0x19d,0x1f6)]=_0x137f00,_0xf55236['translatio'+'n']='',_0xf55236[_0x26fa9b(0x197,0x19a,0x1ab,0x183)]=_0x53a538,_0xf55236[_0x5ac0f1(0x4ca,0x511,0x4e2,0x4d3)]=!![],_0xf55236;}else return'';}const _0x4dcc36=_0x3313e0[_0x53a538['toLowerCas'+'e']()]||'';function _0x26fa9b(_0x917396,_0x47aafe,_0x1d5a5f,_0x308087){return _0xd9393e(_0x917396-0x4a,_0x47aafe,_0x1d5a5f-0x1d9,_0x1d5a5f-0x3b4);}const _0x42d04e={};_0x42d04e['original']=_0x137f00,_0x42d04e[_0x26fa9b(0x1bb,0x1d8,0x205,0x21b)+'n']=_0x4dcc36,_0x42d04e[_0x5ac0f1(0x472,0x4b6,0x4a5,0x498)]=_0x53a538,_0x42d04e[_0x26fa9b(0x1ba,0x217,0x206,0x1d1)]=![];function _0x5ac0f1(_0xaf505,_0x20f9b5,_0x4c51b7,_0x3e971c){return _0xd9393e(_0xaf505-0xdf,_0xaf505,_0x4c51b7-0x1e,_0x20f9b5-0x6bf);}return _0x42d04e;});}export function formatTranslationDisplay(_0x1ec90,_0x9d038e={}){const _0x1ed7a5={};_0x1ed7a5[_0x5198f(-0x78,-0x54,-0x1d,-0x31)]=function(_0x5dc37c,_0x2a9536){return _0x5dc37c!==_0x2a9536;},_0x1ed7a5['KfLnP']=_0x5198f(-0x44,-0x94,-0x61,-0x6a),_0x1ed7a5['vOouo']='pnpgJ';const _0x5d535c=_0x1ed7a5;function _0x5f3054(_0x329554,_0x21e537,_0x1ed2f1,_0x2b0608){return _0x4387(_0x21e537- -0x14b,_0x2b0608);}function _0x5198f(_0x34e33f,_0x5ac1db,_0x52a073,_0x27644f){return _0x4387(_0x27644f- -0x229,_0x34e33f);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x9d038e;if(!_0x1ec90||!Array[_0x5198f(-0x69,0x31,-0x22,-0x27)](_0x1ec90))return _0x5d535c[_0x5f3054(0xda,0xad,0x8e,0xd5)](_0x5d535c[_0x5f3054(0xd6,0xe3,0x96,0xe2)],_0x5d535c[_0x5198f(0x24,0x3c,-0x59,-0xd)])?'':_0x2ca917;return _0x1ec90[_0x5f3054(0xd6,0x9a,0x85,0xbf)](_0x53adb1=>{if(_0x53adb1[_0x201504(0x68,0x75,0x92,0xa3)])return showOriginal?_0x53adb1[_0x201504(-0x1,0x27,0xc,0x2a)]:'';const _0x2814b8=[];if(showOriginal)_0x2814b8['push'](_0x53adb1[_0x19c866(0x26a,0x260,0x27a,0x26b)]);function _0x19c866(_0x49d305,_0xd6b90a,_0x1b78f0,_0x364203){return _0x5198f(_0x1b78f0,_0xd6b90a-0x119,_0x1b78f0-0x12e,_0x364203-0x2ee);}function _0x201504(_0x1b497e,_0x1cf22a,_0x1249dd,_0x52ffee){return _0x5f3054(_0x1b497e-0x10e,_0x1b497e- -0x5c,_0x1249dd-0x3a,_0x52ffee);}return showTranslation&&_0x53adb1['translatio'+'n']&&_0x2814b8[_0x19c866(0x2b7,0x29d,0x2ba,0x2ca)]('('+_0x53adb1['translatio'+'n']+')'),_0x2814b8[_0x201504(-0x4,0x30,0x4d,-0x6)]('\x20');})[_0x5f3054(0x3c,0x62,0x58,0x47)](Boolean)['join'](separator);}export async function translatePromptTags(_0x2ac6d2){const _0x6fd473={'CzuqH':function(_0x482e60,_0x2291c9){return _0x482e60(_0x2291c9);},'BUDpN':function(_0x424b27,_0x52b33d){return _0x424b27(_0x52b33d);},'SLgRg':function(_0x3336aa,_0x2bd6ff,_0x4f9f7e){return _0x3336aa(_0x2bd6ff,_0x4f9f7e);},'dkUru':function(_0x5cb178,_0x2422eb){return _0x5cb178(_0x2422eb);},'xjkzr':_0x2c3410(0x2bb,0x2bd,0x2c3,0x312)},{originalTags:_0x29376a,cleanedText:_0x37f839}=preprocessPromptForTranslation(_0x2ac6d2);if(!_0x37f839){const _0x514d4f={};return _0x514d4f[_0x2c3410(0x299,0x291,0x257,0x2b5)]=[],_0x514d4f[_0x2c3410(0x2c6,0x30a,0x31f,0x335)+'t']='',_0x514d4f[_0x2c3410(0x30c,0x339,0x33f,0x320)+'gs']=[],_0x514d4f;}function _0x551dae(_0x5f0543,_0x4c0686,_0x2b5424,_0x44b39f){return _0x4387(_0x2b5424- -0x196,_0x5f0543);}function _0x2c3410(_0x43609f,_0x2477f7,_0x2456a9,_0x3f47eb){return _0x4387(_0x2477f7-0xed,_0x3f47eb);}try{const _0x52c5e0=await _0x6fd473[_0x2c3410(0x280,0x2d8,0x2bc,0x312)](callTranslation,_0x37f839),_0x421919=_0x6fd473[_0x551dae(0x80,0x55,0x47,0xf)](parseTranslationResult,_0x52c5e0),_0x3d6d94=_0x6fd473[_0x2c3410(0x2e2,0x2b6,0x288,0x2b5)](combineTranslationResult,_0x29376a,_0x421919),_0x39083f=_0x6fd473[_0x2c3410(0x2e1,0x2e4,0x2cd,0x31b)](formatTranslationDisplay,_0x3d6d94),_0x476808={};return _0x476808[_0x551dae(-0x44,0x16,0xe,0x34)]=_0x3d6d94,_0x476808[_0x2c3410(0x343,0x30a,0x2e8,0x32a)+'t']=_0x39083f,_0x476808[_0x551dae(0x96,0x7a,0xb6,0xd2)+'gs']=_0x29376a,_0x476808;}catch(_0x90f0b5){if(_0x6fd473['xjkzr']!==_0x6fd473[_0x551dae(0x15,0x81,0x42,0x3e)])_0x27fa29[_0x551dae(0xed,0x91,0xa4,0x6f)](_0x551dae(0x1f,0x50,0x11,0x17)+'\x20AI\x20设置已统一到'+_0x2c3410(0x2fd,0x2d5,0x2c6,0x29f)),_0x257f73=!![];else{console['error'](_0x2c3410(0x2b6,0x294,0x23c,0x2b5)+_0x551dae(0x25,0xd,0xb,0x60)+':',_0x90f0b5);throw _0x90f0b5;}}}export function parseTranslationResult(_0x2c352b){const _0x836497={'ydDRZ':function(_0x328c8d,_0x2b4cdb){return _0x328c8d(_0x2b4cdb);},'cExqE':function(_0x530dde,_0x3f43a1){return _0x530dde===_0x3f43a1;},'DxcAf':function(_0x4d1896,_0xf4302b){return _0x4d1896===_0xf4302b;},'OrMEj':_0x18d1a5(0x327,0x309,0x35c,0x30e),'BfyyX':function(_0x10d63d,_0x21e7a6){return _0x10d63d(_0x21e7a6);},'kVhHK':'boQCn','xjBtR':function(_0x104f1f,_0x540835){return _0x104f1f===_0x540835;},'lgYRB':_0x18d1a5(0x282,0x2d1,0x2a1,0x31f),'FJrsd':function(_0x4067bb,_0x448122){return _0x4067bb!==_0x448122;},'HiVCU':'DtbxN','SKNCR':_0x18d1a5(0x2d5,0x31b,0x2f4,0x302),'dfbyR':'pcuZA','rGBwa':function(_0x3d3070,_0x5d11ad){return _0x3d3070+_0x5d11ad;}};function _0x41749c(_0x324727,_0x15d615,_0x21b035,_0x46a105){return _0x4387(_0x15d615- -0x334,_0x324727);}function _0x18d1a5(_0x1734c5,_0x52bc98,_0x19539c,_0x58720c){return _0x4387(_0x52bc98-0xd4,_0x19539c);}if(!_0x2c352b)return{};try{if(_0x836497[_0x41749c(-0x12a,-0x173,-0x19a,-0x133)](_0x836497[_0x41749c(-0xc7,-0x10e,-0x140,-0xfe)],_0x836497[_0x18d1a5(0x317,0x2fa,0x2b1,0x2c1)])){const _0xccdad1=_0x2c352b[_0x41749c(-0x15a,-0x12c,-0x146,-0x111)](/\{[\s\S]*\}/);if(_0xccdad1){if(_0x836497[_0x41749c(-0x171,-0x17c,-0x178,-0x17b)](_0x836497[_0x41749c(-0xf6,-0x119,-0xfc,-0x12f)],_0x836497[_0x18d1a5(0x2b5,0x2ef,0x2c6,0x2fd)])){const _0x1702bd=JSON[_0x18d1a5(0x27b,0x2d0,0x287,0x307)](_0xccdad1[0x1*0x26cb+0x1*0x16d7+0x3da2*-0x1]);if(typeof _0x1702bd===_0x41749c(-0x147,-0x13a,-0x189,-0x13f)&&_0x836497[_0x41749c(-0x126,-0x111,-0x100,-0xc6)](_0x1702bd,null)){if(_0x836497[_0x18d1a5(0x309,0x2c7,0x2db,0x2e6)]==='DtbxN')return _0x1702bd;else _0xdf60b9=!_0x41a07b,_0x38d978+=_0x19b947;}}else _0x836497[_0x18d1a5(0x2d2,0x314,0x2c2,0x2ce)](_0x254001,new _0x21130e(_0x16ebf1['result']));}}else{const _0x5bdd72=_0x27c18a[_0x1060d8];if(_0x836497[_0x18d1a5(0x33f,0x321,0x351,0x30a)](_0x5bdd72,'$'))_0x328d58=!_0x3f5b3c,_0x28214f+=_0x5bdd72;else{if((_0x836497[_0x41749c(-0x1a5,-0x173,-0x188,-0x121)](_0x5bdd72,',')||_0x836497[_0x41749c(-0x126,-0x173,-0x189,-0x129)](_0x5bdd72,'，'))&&!_0x52daea){const _0x12e8fa=_0x5f34a0[_0x18d1a5(0x328,0x322,0x31a,0x364)]();if(_0x12e8fa)_0x4c0e30['push'](_0x12e8fa);_0x9f1738='';}else _0x558581+=_0x5bdd72;}}}catch(_0x17d193){if(_0x836497[_0x41749c(-0x168,-0x17c,-0x172,-0x19f)](_0x836497[_0x18d1a5(0x281,0x2c8,0x27b,0x29c)],_0x836497['dfbyR'])){if(_0x3d9506['error']&&_0x836497[_0x41749c(-0x162,-0x173,-0x137,-0x130)](_0x7a63fd[_0x18d1a5(0x332,0x304,0x34e,0x2ff)][_0x18d1a5(0x2d8,0x2cf,0x2ab,0x2f9)],_0x836497[_0x41749c(-0x14a,-0x128,-0x16b,-0xd5)])){const _0x489483=new _0x50353f(_0x191f54[_0x41749c(-0x14c,-0x104,-0x121,-0xee)]['message']);_0x489483[_0x18d1a5(0x296,0x2cf,0x277,0x309)]=_0x836497['OrMEj'],_0x836497[_0x41749c(-0x177,-0x18b,-0x17d,-0x1b9)](_0x54c2ff,_0x489483);}else _0x836497[_0x41749c(-0x12e,-0xf4,-0x120,-0xb7)](_0x5b7661,new _0x2b75c5(_0xb4ba5e[_0x41749c(-0x1a4,-0x14b,-0x14d,-0x110)]));}else console['warn'](_0x41749c(-0x135,-0x18d,-0x1e1,-0x1d7)+'\x20JSON解析失败，'+_0x41749c(-0xb3,-0xfc,-0x13c,-0xaf),_0x17d193['message']);}const _0x227258=_0x836497[_0x41749c(-0xbc,-0xf4,-0x101,-0xb4)](String,_0x2c352b)[_0x18d1a5(0x23f,0x28f,0x23d,0x2c4)](/[\r\n]+/g,'\x20')[_0x41749c(-0x132,-0x179,-0x153,-0x18e)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x18d1a5(0x36f,0x322,0x2ed,0x33c)](),_0x10a984=_0x227258['split'](/[,，]/)[_0x18d1a5(0x2ea,0x2b9,0x284,0x2d6)](_0x340435=>_0x340435[_0x41749c(-0xfd,-0xe6,-0x13f,-0x12b)]())[_0x18d1a5(0x297,0x281,0x28b,0x276)](Boolean),_0x5a8616={};for(const _0xd76317 of _0x10a984){const _0x30d9c8=_0xd76317['indexOf']('\x5c');if(_0x30d9c8>0x26f2*-0x1+0xdec+0x2*0xc83){const _0x442c2a=_0xd76317['slice'](-0x283+-0x1303+0x1586,_0x30d9c8)[_0x41749c(-0x10e,-0xe6,-0xa8,-0xbc)](),_0x1a1cc1=_0xd76317['slice'](_0x836497['rGBwa'](_0x30d9c8,-0x2*-0xdd+0x103*0x11+-0x12ec))[_0x41749c(-0x136,-0xe6,-0x94,-0xb7)]();if(_0x442c2a)_0x5a8616[_0x442c2a]=_0x1a1cc1;}}return _0x5a8616;}function generateRequestId(){const _0x408973={};_0x408973[_0x229d45(0x56c,0x548,0x58a,0x53a)]=function(_0x49c0ac,_0x159b54){return _0x49c0ac+_0x159b54;};function _0x229d45(_0x1b4713,_0x16817b,_0x41e053,_0x200114){return _0x4387(_0x41e053-0x377,_0x200114);}const _0x33d59e=_0x408973;function _0xb25473(_0x3cba1f,_0xa17385,_0x1960ae,_0x107c2a){return _0x4387(_0x1960ae-0x1a9,_0x107c2a);}if(crypto&&crypto['randomUUID'])return crypto[_0x229d45(0x5fd,0x56c,0x5a9,0x5b6)]();return _0x33d59e[_0x229d45(0x55c,0x543,0x58a,0x54d)](Date[_0x229d45(0x550,0x590,0x566,0x5b8)]()[_0x229d45(0x517,0x505,0x55b,0x512)](0x17e*-0xd+0x3dc*-0x2+0xda1*0x2),Math[_0xb25473(0x3fd,0x3d9,0x3e6,0x3ec)]()[_0xb25473(0x368,0x389,0x38d,0x353)](-0x3*-0x975+0x26f3+-0x432e)['substring'](0xf4c+-0xffa*0x1+0xb0));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x346703(_0x1e24b4,_0x1d73cd,_0x4e7b68,_0x2d7f2b){return _0x4387(_0x1d73cd-0x39f,_0x2d7f2b);}function _0x27f273(_0x19651e,_0x5627c9,_0x289f63,_0x257e5f){return _0x4387(_0x257e5f-0x2ad,_0x19651e);}const _0x99b86={'CuwbV':_0x27f273(0x473,0x4dd,0x4cb,0x4c2),'jdUZC':function(_0x48b3b2,_0x5315c3){return _0x48b3b2(_0x5315c3);},'vGCFy':function(_0x2f1af6,_0x3a2c97){return _0x2f1af6(_0x3a2c97);},'xJllu':_0x346703(0x5b5,0x5b6,0x578,0x60b),'YuuTx':function(_0x4709e9){return _0x4709e9();},'UPrKV':function(_0x4b1dd1,_0x2e137,_0x5006a8){return _0x4b1dd1(_0x2e137,_0x5006a8);}};return new Promise((_0x3bad33,_0x5a19ea)=>{const _0x359a9d={'VkXtZ':function(_0x54741b,_0x434749){function _0x5a8115(_0x9ce3b7,_0x43ade0,_0x5d88d9,_0x261626){return _0x4387(_0x9ce3b7-0x7b,_0x5d88d9);}return _0x99b86[_0x5a8115(0x23b,0x263,0x266,0x206)](_0x54741b,_0x434749);}},_0x3a386b=_0x99b86[_0x4f79ae(0x3d8,0x402,0x3fc,0x448)](generateRequestId);console[_0x55365e(0x2bc,0x2d8,0x311,0x2e6)](_0x4f79ae(0x343,0x3de,0x391,0x3c0)+'\x20请求获取翻译提示词'+_0x55365e(0x2f8,0x2dc,0x29e,0x2bc)+_0x3a386b+')');function _0x4f79ae(_0x95954b,_0x578a2f,_0x4e9c12,_0x9c290f){return _0x27f273(_0x95954b,_0x578a2f-0x64,_0x4e9c12-0x10f,_0x4e9c12- -0xc3);}const _0x56042d=_0x4f4dd8=>{function _0x39ca6d(_0x5a9346,_0x523a5b,_0x35f4ab,_0x1f31f3){return _0x55365e(_0x35f4ab,_0x523a5b-0x26,_0x35f4ab-0x68,_0x5a9346- -0x271);}function _0x13b84d(_0x151ca9,_0x40b2ca,_0x319e36,_0x2f6fcb){return _0x55365e(_0x40b2ca,_0x40b2ca-0x5c,_0x319e36-0x18e,_0x2f6fcb- -0x32f);}if(_0x99b86[_0x13b84d(-0x60,-0xff,-0x87,-0xb8)]!==_0x99b86['CuwbV'])_0x359a9d[_0x13b84d(-0x1c,-0x83,-0x20,-0x38)](_0x98ef56,_0x4b3369[_0x39ca6d(0x24,0x9,0x23,0x9)]);else{if(_0x4f4dd8['id']!==_0x3a386b)return;eventSource[_0x13b84d(-0x88,-0x83,-0x2a,-0x56)+_0x39ca6d(0x48,0x71,0x43,0x42)](eventNames[_0x39ca6d(0x7e,0x3b,0x4b,0x56)+_0x13b84d(-0x54,-0x53,-0x7f,-0x79)+_0x39ca6d(0x83,0x74,0xae,0x76)+_0x39ca6d(0x21,0x6c,-0x5,-0x2d)],_0x56042d);const {prompt:_0x44e7ad}=_0x4f4dd8;console[_0x39ca6d(0x75,0x82,0x34,0xa4)](_0x39ca6d(-0x1e,0x23,-0x46,0xf)+'\x20已获取翻译提示词\x20'+_0x13b84d(-0xb0,-0xff,-0xdc,-0xca)+_0x3a386b+'):',_0x44e7ad),_0x99b86['jdUZC'](_0x3bad33,_0x44e7ad);}};eventSource['on'](eventNames[_0x55365e(0x2fe,0x2dc,0x2e8,0x2ef)+_0x4f79ae(0x3dd,0x3bd,0x3f4,0x416)+_0x55365e(0x2e3,0x2fb,0x303,0x2f4)+_0x4f79ae(0x3bf,0x404,0x3d0,0x399)],_0x56042d);const _0x531c95={};function _0x55365e(_0x1026e3,_0x8b46a3,_0x52d935,_0x243576){return _0x27f273(_0x1026e3,_0x8b46a3-0x1a7,_0x52d935-0x106,_0x243576- -0x201);}_0x531c95['id']=_0x3a386b,eventSource[_0x55365e(0x2ae,0x329,0x2ee,0x2ee)](eventNames[_0x55365e(0x319,0x2c0,0x31d,0x2ef)+_0x4f79ae(0x415,0x3df,0x3f4,0x39b)+_0x4f79ae(0x42f,0x3bc,0x3e3,0x399)+'UEST'],_0x531c95),_0x99b86[_0x55365e(0x2b4,0x2be,0x236,0x285)](setTimeout,()=>{eventSource[_0x475cf1(-0x153,-0x16e,-0x194,-0x1b7)+_0x391c2f(-0x80,-0xfd,-0xba,-0xf5)](eventNames['LLM_TRANSL'+_0x391c2f(-0xd1,-0x6f,-0xbd,-0xff)+_0x391c2f(-0x8d,-0x5c,-0x7f,-0x99)+_0x475cf1(-0x1cb,-0x1b5,-0x1cb,-0x1c0)],_0x56042d);function _0x475cf1(_0x54ff11,_0x388245,_0x27bc92,_0x186254){return _0x4f79ae(_0x186254,_0x388245-0x68,_0x388245- -0x585,_0x186254-0x13b);}function _0x391c2f(_0x5c879b,_0x144ba3,_0x9483a8,_0xfe1b4c){return _0x4f79ae(_0xfe1b4c,_0x144ba3-0x140,_0x9483a8- -0x4b1,_0xfe1b4c-0x13f);}_0x99b86[_0x475cf1(-0x211,-0x1db,-0x1c9,-0x233)](_0x5a19ea,new Error(_0x99b86['xJllu']));},0xc61*0x5+0x8d9+0x5*-0x656);});}export function LLM_TRANSLATION(_0x15720d,{timeoutMs:timeoutMs=-0x1cc83+0x77b3*-0x2+0x3a649}={}){const _0x13df49={'hYwzB':_0x3b825d(0x36f,0x3c6,0x3ba,0x36e),'HIAqA':function(_0x3f9586,_0x146787){return _0x3f9586(_0x146787);},'kblSe':function(_0x4be2f0,_0x2f2ede){return _0x4be2f0===_0x2f2ede;},'lAiFx':_0x3b825d(0x367,0x3ad,0x393,0x372),'MhNbu':function(_0x1c3ca9,_0xbf485){return _0x1c3ca9!==_0xbf485;},'CvHbt':_0x5d8760(0x4ea,0x573,0x534,0x51d),'zMUnX':function(_0x510a94){return _0x510a94();},'rclJT':function(_0x1bcdf7,_0x263741){return _0x1bcdf7!==_0x263741;},'Zkike':_0x5d8760(0x53c,0x540,0x51c,0x519),'WvzBg':function(_0x1fe351,_0x5acc7d){return _0x1fe351===_0x5acc7d;},'UjsiT':'uyniG','yABSL':_0x3b825d(0x424,0x377,0x3ce,0x3e3),'WWAGv':function(_0x3b92e7,_0x33b1bf){return _0x3b92e7(_0x33b1bf);},'AHfxe':function(_0x310974,_0x1c8d0d){return _0x310974===_0x1c8d0d;},'JnPhQ':_0x3b825d(0x3a4,0x3a0,0x379,0x3c2),'Ydykt':_0x5d8760(0x507,0x567,0x4ce,0x51c),'oYMrJ':function(_0x424786,_0x3747c5){return _0x424786!==_0x3747c5;},'YCEJb':_0x3b825d(0x351,0x3c0,0x36b,0x35f),'FMwiT':function(_0x5c4920,_0x296334){return _0x5c4920(_0x296334);},'bJkLl':function(_0x42a56f,_0x2d7705,_0x4c45f2){return _0x42a56f(_0x2d7705,_0x4c45f2);}};function _0x3b825d(_0x2f1a43,_0x57bbfa,_0x646f8d,_0x8143d2){return _0x4387(_0x646f8d-0x199,_0x8143d2);}function _0x5d8760(_0x11b9f4,_0x138d72,_0x504b5e,_0x5c38c7){return _0x4387(_0x5c38c7-0x33e,_0x504b5e);}return new Promise((_0x13c777,_0x1ec01f)=>{const _0x5ed70e={'Fobhe':function(_0x2fafdb,_0x25ad76){function _0xca8a65(_0x53a53c,_0x115fe1,_0x371737,_0x3dc94c){return _0x4387(_0x53a53c- -0x28e,_0x371737);}return _0x13df49[_0xca8a65(-0xd7,-0x10f,-0x118,-0x9f)](_0x2fafdb,_0x25ad76);}},_0x1988a8=_0x13df49[_0x30761e(0x5fe,0x5dd,0x5e6,0x5b2)](generateRequestId);function _0x24649b(_0x2a460d,_0xb23020,_0x2948c7,_0x35e4ac){return _0x3b825d(_0x2a460d-0xc2,_0xb23020-0x11b,_0xb23020- -0x10d,_0x2a460d);}console[_0x30761e(0x63a,0x5e4,0x59d,0x62c)]('st-chatu8:'+_0x30761e(0x55f,0x5aa,0x5ef,0x5de)+_0x30761e(0x599,0x563,0x591,0x511)+_0x1988a8+')');let _0x4f4c07=null;const _0x539b3b=()=>{function _0xd5e54b(_0x4f246b,_0x2317fb,_0x5b3456,_0x545da9){return _0x30761e(_0x4f246b-0x65,_0x545da9- -0x146,_0x5b3456-0x172,_0x4f246b);}function _0x3340a1(_0xfb43b8,_0xf27b43,_0x504824,_0x55e995){return _0x30761e(_0xfb43b8-0x41,_0xf27b43- -0x3d3,_0x504824-0x98,_0x504824);}if(_0x13df49[_0xd5e54b(0x434,0x466,0x3d1,0x41a)]===_0x13df49[_0x3340a1(0x146,0x18d,0x149,0x1c3)]){eventSource['removeList'+_0x3340a1(0x1b0,0x1e4,0x20c,0x1b2)](eventNames[_0xd5e54b(0x483,0x4ae,0x4e1,0x4a7)+_0xd5e54b(0x442,0x402,0x3ea,0x429)+_0x3340a1(0x208,0x1ba,0x1c8,0x1b5)],_0x498af2);if(_0x4f4c07)clearTimeout(_0x4f4c07);}else{if(!_0x287796[_0xd5e54b(0x498,0x459,0x438,0x466)](_0x3e9b54))return'[]';return _0x46e3b9[_0xd5e54b(0x44c,0x3fb,0x43b,0x446)](_0x2b1a62[_0x3340a1(0x19d,0x184,0x12f,0x1c9)](_0xb2e315=>_0xb2e315&&typeof _0xb2e315===_0x3340a1(0x16e,0x195,0x1c1,0x1c0)));}},_0x498af2=_0x5a1448=>{function _0x354be9(_0x1f9abf,_0x2afc2c,_0x56d74b,_0x35169f){return _0x24649b(_0x2afc2c,_0x1f9abf- -0x410,_0x56d74b-0x61,_0x35169f-0x1a0);}function _0x305d19(_0x4b64ee,_0x88d315,_0x2bf5b6,_0x1ed29c){return _0x30761e(_0x4b64ee-0x6b,_0x2bf5b6-0x2e,_0x2bf5b6-0x194,_0x88d315);}const _0x58789={'OjlOH':function(_0x72c98b,_0x434589){function _0x5de21e(_0x5df874,_0x4f1a05,_0x503248,_0x56fbd8){return _0x4387(_0x56fbd8- -0xcd,_0x5df874);}return _0x13df49[_0x5de21e(0x141,0x1c6,0x1ba,0x174)](_0x72c98b,_0x434589);},'qscwp':function(_0x18c526,_0x48cb2e){function _0xc49cd5(_0x27710a,_0x5f4113,_0x1fa58b,_0x3c5688){return _0x4387(_0x1fa58b-0x2ab,_0x27710a);}return _0x13df49[_0xc49cd5(0x459,0x469,0x450,0x3fa)](_0x18c526,_0x48cb2e);},'rpBIk':_0x13df49[_0x305d19(0x557,0x5b3,0x59a,0x58f)],'NSCvH':function(_0x22d726,_0x1d7383){function _0x41c0a7(_0x558254,_0x16e2a1,_0x5270a5,_0x1cb615){return _0x305d19(_0x558254-0xa4,_0x16e2a1,_0x1cb615- -0x5c5,_0x1cb615-0x194);}return _0x13df49[_0x41c0a7(-0x55,-0x47,-0x8,-0x1)](_0x22d726,_0x1d7383);}};if(_0x13df49['MhNbu'](_0x13df49['CvHbt'],_0x13df49[_0x305d19(0x5a0,0x5a6,0x5df,0x5f0)])){const _0x580cd8={'original':_0xf932,'cleaned':_0x253c58,'prefix':'','suffix':'','weight':'','skip':_0x58789['OjlOH'](_0x228cb4,_0x325d03)};_0x104063[_0x305d19(0x616,0x5d4,0x5dd,0x5e6)](_0x580cd8),!_0x580cd8[_0x305d19(0x5f3,0x5bc,0x5af,0x55f)]&&_0x24e844&&(_0x2412e4[_0x354be9(-0x17f,-0x1b5,-0x142,-0x1a1)](_0x30e223),_0x52f0e1[_0x354be9(-0x145,-0x11d,-0xf4,-0xf7)](_0x5b8f6a['toLowerCas'+'e'](),_0x580cd8));}else{if(_0x13df49['MhNbu'](_0x5a1448['id'],_0x1988a8))return;_0x13df49[_0x305d19(0x614,0x645,0x60b,0x641)](_0x539b3b),console[_0x305d19(0x5eb,0x64f,0x612,0x5e4)](_0x305d19(0x5a0,0x54b,0x57f,0x5d4)+'\x20已收到翻译\x20LLM'+_0x354be9(-0x133,-0x108,-0x166,-0x110)+'\x20'+_0x1988a8+'):',_0x5a1448);if(_0x5a1448[_0x305d19(0x5fb,0x61d,0x5c5,0x5d9)]){if(_0x13df49[_0x305d19(0x641,0x60b,0x601,0x612)](_0x13df49[_0x354be9(-0x1bd,-0x1e9,-0x1d0,-0x188)],_0x354be9(-0x1e4,-0x1ec,-0x1c5,-0x1d4)))_0x13df49[_0x354be9(-0x143,-0x12d,-0x143,-0x187)](_0x13c777,_0x5a1448[_0x354be9(-0x19b,-0x180,-0x180,-0x174)]);else{const _0x2a02db=_0xa3d292[_0x354be9(-0x17c,-0x1c3,-0x18b,-0x17b)](/\{[\s\S]*\}/);if(_0x2a02db){const _0x5b5bb2=_0x3c841e['parse'](_0x2a02db[-0x725*-0x3+0x1037*0x1+-0x25a6]);if(_0x58789['qscwp'](typeof _0x5b5bb2,_0x58789[_0x305d19(0x5bb,0x5bd,0x5c9,0x5d6)])&&_0x58789['NSCvH'](_0x5b5bb2,null))return _0x5b5bb2;}}}else{if(_0x13df49[_0x354be9(-0x15f,-0x173,-0x16e,-0x1b2)](_0x13df49[_0x305d19(0x605,0x61c,0x61e,0x669)],_0x13df49['UjsiT'])){if(_0x5a1448['error']&&_0x13df49[_0x305d19(0x5cf,0x58d,0x57d,0x5c3)](_0x5a1448[_0x305d19(0x62b,0x64f,0x608,0x5c9)][_0x305d19(0x5fc,0x587,0x5d3,0x628)],_0x13df49[_0x305d19(0x62d,0x604,0x60f,0x629)])){const _0xb10cd=new Error(_0x5a1448[_0x305d19(0x62b,0x65e,0x608,0x5b0)]['message']);_0xb10cd['name']=_0x354be9(-0x14f,-0x187,-0x177,-0x125),_0x13df49[_0x354be9(-0x1a8,-0x162,-0x1c0,-0x188)](_0x1ec01f,_0xb10cd);}else{if(_0x13df49[_0x305d19(0x602,0x5d6,0x5bf,0x586)](_0x13df49['JnPhQ'],_0x13df49['Ydykt']))return _0x7e3932['randomUUID']();else _0x1ec01f(new Error(_0x5a1448[_0x354be9(-0x19b,-0x168,-0x1f0,-0x190)]));}}else{_0x8c1b85[_0x354be9(-0x157,-0x122,-0x1aa,-0x165)+'ener'](_0x457298[_0x354be9(-0x141,-0xea,-0x194,-0x118)+'ATION_RESP'+'ONSE'],_0x3b23c4);if(_0x1f8f3d)_0x5ed70e[_0x305d19(0x5cc,0x586,0x592,0x54d)](_0xdfef3f,_0x3b59a9);}}}};eventSource['on'](eventNames[_0x30761e(0x644,0x5ed,0x5b8,0x629)+_0x24649b(0x24b,0x251,0x212,0x220)+_0x24649b(0x286,0x26f,0x231,0x229)],_0x498af2);const _0x304b29={};function _0x30761e(_0x20c56a,_0x392e0f,_0x224525,_0x55ad41){return _0x5d8760(_0x20c56a-0x1e2,_0x392e0f-0x60,_0x55ad41,_0x392e0f-0x6c);}_0x304b29[_0x30761e(0x575,0x5be,0x616,0x5fe)]=_0x15720d,_0x304b29['id']=_0x1988a8,eventSource[_0x24649b(0x2f4,0x2ce,0x282,0x2bd)](eventNames[_0x30761e(0x62e,0x5ed,0x5b9,0x62e)+_0x30761e(0x59f,0x5db,0x59d,0x621)+_0x24649b(0x28d,0x2d0,0x2b1,0x293)],_0x304b29),_0x4f4c07=_0x13df49[_0x24649b(0x318,0x2d5,0x2b6,0x2cc)](setTimeout,()=>{function _0x59c802(_0x44db3d,_0x4ff08a,_0x3b93ca,_0x412bff){return _0x24649b(_0x4ff08a,_0x3b93ca-0x1ce,_0x3b93ca-0x8f,_0x412bff-0x1c1);}function _0x3fc7a2(_0x271c5c,_0x2f18a5,_0x57c365,_0x463fc0){return _0x24649b(_0x2f18a5,_0x57c365-0x21c,_0x57c365-0x33,_0x463fc0-0xb8);}if(_0x13df49[_0x3fc7a2(0x419,0x431,0x464,0x413)](_0x13df49['YCEJb'],'KjvuP'))_0x13df49[_0x3fc7a2(0x504,0x50d,0x4db,0x496)](_0x539b3b),_0x13df49[_0x3fc7a2(0x463,0x44e,0x484,0x4d1)](_0x1ec01f,new Error('翻译\x20LLM\x20执行超'+'时（'+timeoutMs+_0x59c802(0x403,0x3e1,0x40d,0x466)));else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x50ace7()};},timeoutMs);});}export async function callTranslation(_0x2b12f8){function _0x23de0b(_0xdf2fe0,_0x5286da,_0x3178d7,_0x1d567f){return _0x4387(_0x1d567f- -0x1cb,_0x5286da);}const _0x53a1c9={'iCXJL':_0x3624ee(-0xaa,-0x56,-0x5c,-0x70)+'n','GoThO':function(_0x3fd65f,_0x4331f3){return _0x3fd65f(_0x4331f3);},'GMljI':function(_0x2e33ee,_0x50bbb0){return _0x2e33ee||_0x50bbb0;},'zRSML':function(_0x37d93e,_0x155bda){return _0x37d93e(_0x155bda);},'VHVaO':function(_0x351124,_0x4fb653){return _0x351124(_0x4fb653);},'fghER':function(_0x271e10,_0x53ffc0){return _0x271e10(_0x53ffc0);},'uAnAD':_0x23de0b(0x3b,-0x1b,-0x54,-0xe)};function _0x3624ee(_0x3312e1,_0x285f9f,_0x5eee95,_0x251074){return _0x4387(_0x285f9f- -0x264,_0x5eee95);}try{let _0x123c27=buildPromptForRequestType(_0x53a1c9[_0x23de0b(0x33,0x92,0x3b,0x3b)],_0x2b12f8||'');_0x123c27=_0x53a1c9[_0x23de0b(0x4b,0x7e,0x38,0x71)](mergeAdjacentMessages,_0x123c27);const _0x5ed1ba=[..._0x123c27,{'role':_0x3624ee(-0xee,-0xba,-0x100,-0x80),'content':_0x53a1c9['GMljI'](_0x2b12f8,'')}];_0x53a1c9['zRSML'](updateCombinedPrompt,_0x5ed1ba);const _0xaf9c48=await _0x53a1c9['VHVaO'](LLM_TRANSLATION,_0x5ed1ba);return _0xaf9c48;}catch(_0x267b08){_0x53a1c9[_0x23de0b(0x12,0x68,0x55,0x57)](addLog,_0x23de0b(0x15,0x8,0x2a,0x36)+_0x267b08['message']),console[_0x3624ee(-0x25,-0x34,-0x2c,-0xc)](_0x53a1c9[_0x3624ee(-0xd7,-0xa1,-0xa5,-0x5e)],_0x267b08);throw _0x267b08;}}function _0x4387(_0x5484cd,_0x1802a6){_0x5484cd=_0x5484cd-(0x1f*-0x53+0x6a2+0x50b);const _0xc4909c=_0x2dcf();let _0x239ce8=_0xc4909c[_0x5484cd];if(_0x4387['DqYimv']===undefined){var _0x5b9e34=function(_0x5d0b69){const _0x40d229='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c4900='',_0x2e8b0b='',_0x105a70=_0x1c4900+_0x5b9e34;for(let _0x3e3160=-0x1042*-0x1+-0x5db*-0x1+-0x9*0x275,_0x2bac9a,_0x3aaf7b,_0xf932=-0x7*0x53e+-0x5b*0xb+-0x2d*-0xe7;_0x3aaf7b=_0x5d0b69['charAt'](_0xf932++);~_0x3aaf7b&&(_0x2bac9a=_0x3e3160%(0x5*-0x711+0x7*-0x3e5+0x3e9c*0x1)?_0x2bac9a*(0x10aa+0x14d0+-0x253a)+_0x3aaf7b:_0x3aaf7b,_0x3e3160++%(-0xddb*0x1+0xd*-0x130+-0x1*-0x1d4f))?_0x1c4900+=_0x105a70['charCodeAt'](_0xf932+(-0xb01+-0xcf+0xbda))-(-0x105a*-0x1+-0x193+0x1*-0xebd)!==-0x1fc9+0x1ac4+0x1*0x505?String['fromCharCode'](-0xe75+-0x26f0+0x3664&_0x2bac9a>>(-(0x3fd+-0x1*0x5eb+-0x10*-0x1f)*_0x3e3160&-0x25*-0xbb+0x7*0x4b3+0x1*-0x3be6)):_0x3e3160:-0x4*0x645+-0x438+0x14*0x177){_0x3aaf7b=_0x40d229['indexOf'](_0x3aaf7b);}for(let _0x253c58=0x17d2+0x1cd0+-0x34a2,_0x228cb4=_0x1c4900['length'];_0x253c58<_0x228cb4;_0x253c58++){_0x2e8b0b+='%'+('00'+_0x1c4900['charCodeAt'](_0x253c58)['toString'](-0x1*-0x27f+0x259*0x1+-0x4c8))['slice'](-(-0x3*-0xa55+-0x1df6+-0x107));}return decodeURIComponent(_0x2e8b0b);};_0x4387['BkoRtG']=_0x5b9e34,_0x4387['YpnrFU']={},_0x4387['DqYimv']=!![];}const _0x31c231=_0xc4909c[0x1*-0x1c67+-0x1ba2+0x3809*0x1],_0x479666=_0x5484cd+_0x31c231,_0x213236=_0x4387['YpnrFU'][_0x479666];if(!_0x213236){const _0x325d03=function(_0x104063){this['EQMxTG']=_0x104063,this['KIKIVr']=[-0x13f4+0x8e5+-0x10*-0xb1,0xd4c+-0xecf*0x1+0x183,0x1414+0x443+-0x1857],this['fUjaTU']=function(){return'newState';},this['AAPVgA']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['JhGhEZ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x325d03['prototype']['OUKwUK']=function(){const _0x24e844=new RegExp(this['AAPVgA']+this['JhGhEZ']),_0x1eb4be=_0x24e844['test'](this['fUjaTU']['toString']())?--this['KIKIVr'][0x25cf+0x1aa+-0x2778]:--this['KIKIVr'][-0xb*-0x174+-0x25cf+0x15d3];return this['WlERiU'](_0x1eb4be);},_0x325d03['prototype']['WlERiU']=function(_0x22ab80){if(!Boolean(~_0x22ab80))return _0x22ab80;return this['NlaLqv'](this['EQMxTG']);},_0x325d03['prototype']['NlaLqv']=function(_0x5a34c7){for(let _0x472470=0x263+0x1c02+-0x1f*0xfb,_0x2412e4=this['KIKIVr']['length'];_0x472470<_0x2412e4;_0x472470++){this['KIKIVr']['push'](Math['round'](Math['random']())),_0x2412e4=this['KIKIVr']['length'];}return _0x5a34c7(this['KIKIVr'][-0x8*0x44f+0x4*0x7a+0x2*0x1048]);},new _0x325d03(_0x4387)['OUKwUK'](),_0x239ce8=_0x4387['BkoRtG'](_0x239ce8),_0x4387['YpnrFU'][_0x479666]=_0x239ce8;}else _0x239ce8=_0x213236;return _0x239ce8;}let isAiInitialized=![];function _0x2dcf(){const _0x2e2c76=['C3rYAw5NAwz5','t05trq','Dg9tDhjPBMC','BwfW','ue9ou0u','quHMEgu','ieXmtsdORR7NVA7POBxPNAi','CMvZDwX0','uNPpwwy','q3P1CuG','twHoyNu','C3vJy2vZCW','mtngsvHQCxG','BM93','z0DoreW','CNbcswS','nejkuenZra','sgLwq1u','u0Toq1i','ru52zM8','teLWBge','zgTvCNu','AvPlze4','ufjptvbux1jfuq','B2jQzwn0','BMfTzq','CgfYC2u','uwnjsvm','whzfB3C','BuPRwhG','ioIVT+AXGUE/U+IVKsbmte0G','57+76k+r5AsX6lsLoIa','AxnbCNjHEq','ENjpzfm','v2Hutuu','ChvZAa','AunysKW','q3ziyNq','Bwf0y2G','suPQCu0','qvrjt05Fr0vuxW','Dg9mB3DLCKnHCW','t3jnrwO','zw5LCG','DhjHBNnSyxrPBW','C2TPChbLza','icHjrdOG','rgrtDK0','wxv1vhG','r1vUtxy','ChjVBxb0','BhrRs0O','C2vHCMnO','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','mtHYDKPYtfe','D2fYBG','C29Tzq','BgDzuKi','DK9VDw8','zgLZCgXHEvrLEa','kcGOlISPkYKRkq','zw50CMLLCW','r2nwCeO','yvjzDg0','zMDOrvi','rKPYC2q','DgvZDa','v3z6qMC','A1zOseS','mtu0ohz2ALj0Bq','y1DxA0u','CMnSsLq','s0vXy3y','r01sB24','zvvRuK4','CMvTB3zLtgLZDa','s2zmBLa','re5Qsuu','zxjYB3i','qvrjt05FuKvrvq','CMfUzg9Tvvvjra','EK1vBLG','rMH5CK0','qwjVCNrfCNjVCG','yLjQA1C','Eufcu0W','5BcD6k+v5PEN5Qc85BYpoG','yM9uDLe','Bg9N','EM1vsee','r29uAe8','CMfUzg9T','nJa4nJbHDhH5qwG','C2v0','EwreuLO','seLbCue','zw1PDa','teXnx1rsqu5tta','rvnu','DNPZtfe','vwPZAvq','r0PlEem','ufjptvbux1jfuW','yKPRtgW','tw5PqMW','vMTyDfO','B3jPz2LUywXuyq','y0v4Cuu','DhjPBq','r2zXEvO','r3znEu0','ioAjP+IHJoE7K+AENcaOsuq6','yxrQtwe','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','iefjioIUVUE9RUw3SUE7N+s4GowiSa','AM9PBG','CMvZDwX0CW','A2jSu2u','B3jPz2LUywW','C3qTy2HHDhu4oG','mZm1nJe1mfHPz0Lxwq','qMz5EvG','DxnLCG','D1zpq3i','DMPWD2m','zMLSDgvY','mtmWntiZnxryC01nuq','nJC1mNLbu3fTqW','mJaZmta1ntzKyMfer0K','mty2nLn1uenjwG','C0rnz04','BxpVViK','y2XLyw5Lza','DNLPvuC','AfL3EKi','rK13Avq','EgPcDfi','keLeoIa','rM9IAgu','CMvWBgfJzq','B1LnCKO','57+76k+r5AsX6lsLoG','C3rYAw5N','t1nSr0y','DKDdrNK','rhHJqwy','BefPrNG','DufUquq','ntm3ouHqvLP5qG','qvrjt05FuKvtua','rgjSvLC','wMTPA2u','otK2owHhruHHrW','u0XNuMC','DenNtgu','q3v3yLy','zgTLA1C','we1MqvK','yxbWBhK','mZq4EffdD0nh','qK9WDu4','CM54C2W','t01yufG','nMXUyur6qW','qKT5qNu','BwvZC2fNzq','qxnLzfC','C2TPCa','EgPRENi','vvbYs1y','tuvwugS','tgDPEeW','v1Dbr3y','qLveCe4','tMHbC3O','r2Piu0K','z1bYzem','yvP0zeS'];_0x2dcf=function(){return _0x2e2c76;};return _0x2dcf();}export function initAiSettings(_0x56de67){function _0x567a2a(_0x516120,_0x5a9809,_0x2ad820,_0x2b04ee){return _0x4387(_0x2b04ee-0x2b6,_0x516120);}const _0x38eac8={};function _0x26c99f(_0x5870d2,_0x1f35cb,_0x3eaf63,_0x4c27b9){return _0x4387(_0x3eaf63-0x184,_0x1f35cb);}_0x38eac8[_0x567a2a(0x48b,0x4db,0x50e,0x4b5)]=_0x26c99f(0x300,0x33f,0x32b,0x2d4)+_0x26c99f(0x313,0x358,0x326,0x358)+_0x567a2a(0x458,0x491,0x46f,0x49e);const _0x11d35c=_0x38eac8;!isAiInitialized&&(console[_0x26c99f(0x392,0x406,0x3be,0x38d)](_0x11d35c[_0x26c99f(0x3b7,0x3bd,0x383,0x38e)]),isAiInitialized=!![]);}
//# sourceMappingURL=http://localhost:8000/ai.js.map