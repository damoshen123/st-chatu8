(function(_0x418e5b,_0x5e93c9){function _0x15f750(_0x1418db,_0x4afaef,_0x3a8848,_0x4a9894){return _0x3fab(_0x4a9894- -0x182,_0x3a8848);}const _0x4f0145=_0x418e5b();function _0x6d6d1e(_0x2eb4f3,_0x2e8c12,_0x29a7a9,_0x22d945){return _0x3fab(_0x29a7a9-0x3ab,_0x2e8c12);}while(!![]){try{const _0x4ce1bc=-parseInt(_0x15f750(-0xab,-0x66,-0x19,-0x4e))/(0x2*-0x139+0x1d43+-0xd0*0x21)+-parseInt(_0x15f750(-0x9d,-0xed,-0x67,-0xbc))/(-0x2*0x114f+0x41e*-0x4+0x3318)+parseInt(_0x15f750(-0x63,-0x99,-0x7f,-0x9f))/(0xe66+-0x1562+0x6ff)*(-parseInt(_0x6d6d1e(0x44f,0x427,0x44f,0x431))/(-0x1d56*0x1+-0x21c4+0x3f1e))+parseInt(_0x6d6d1e(0x402,0x4ac,0x456,0x44e))/(0x23ce+0x35*0xb5+-0x4942)+parseInt(_0x15f750(-0x5d,-0xc5,-0x6b,-0x78))/(0x8f*-0x3e+0x24e3+0x23b*-0x1)+parseInt(_0x15f750(0x19,-0x36,-0x47,-0x2e))/(0x1e05+0x1*0xcc9+-0x2ac7)*(parseInt(_0x15f750(-0xa4,-0x67,-0x87,-0x8c))/(0x268+0xc5f+-0x2f3*0x5))+parseInt(_0x15f750(-0x4e,-0x49,-0x74,-0x35))/(-0xd*-0xa2+-0x169d+0xe6c);if(_0x4ce1bc===_0x5e93c9)break;else _0x4f0145['push'](_0x4f0145['shift']());}catch(_0x103676){_0x4f0145['push'](_0x4f0145['shift']());}}}(_0x1f0a,0xa*0x6203+0x59c96+-0x5d4e4));const _0xc0d435=(function(){function _0x37e32e(_0x588638,_0x21ba05,_0x14a528,_0x334cfc){return _0x3fab(_0x21ba05-0x1bb,_0x334cfc);}const _0x88ae57={'eowAN':function(_0x81925b,_0x55f6f8){return _0x81925b(_0x55f6f8);},'CwfFG':_0x53bbe4(0x17f,0x15f,0x14f,0xf4),'JfiSc':_0x53bbe4(0x237,0x1fd,0x1de,0x210)+_0x37e32e(0x22f,0x284,0x23b,0x253)+_0x53bbe4(0x1a8,0x104,0x159,0x12e),'PjOjt':function(_0x4556d1,_0x391772){return _0x4556d1===_0x391772;},'DWPKF':_0x37e32e(0x356,0x2f9,0x2de,0x2cf)};let _0x342b64=!![];function _0x53bbe4(_0x365e75,_0x2aa17c,_0x3b0793,_0x2ef232){return _0x3fab(_0x3b0793-0x94,_0x365e75);}return function(_0x53837d,_0x5d146d){const _0x459969={'gvGxe':function(_0xc802f7,_0xe56151){function _0x57ea39(_0x338286,_0x4536d0,_0x1562bc,_0x1bc212){return _0x3fab(_0x4536d0- -0x61,_0x1562bc);}return _0x88ae57[_0x57ea39(0x1,0x3c,0x8b,0x5a)](_0xc802f7,_0xe56151);},'ckXXz':function(_0x556d2c,_0xd31877){return _0x556d2c!==_0xd31877;},'uhiSm':'cmNLh','uMdVj':_0x88ae57[_0x1b7a13(-0x15e,-0x157,-0x166,-0x198)],'rrlPf':_0x88ae57[_0x4b30b2(-0x215,-0x28a,-0x24e,-0x28b)]};function _0x1b7a13(_0xf3158c,_0x3caae2,_0x3e683c,_0x5f49ac){return _0x37e32e(_0xf3158c-0x11d,_0x5f49ac- -0x4a4,_0x3e683c-0x1b8,_0x3caae2);}function _0x4b30b2(_0xdf73d2,_0x1f8474,_0x3dd458,_0x37ca7f){return _0x53bbe4(_0xdf73d2,_0x1f8474-0x1ed,_0x3dd458- -0x42d,_0x37ca7f-0xcd);}if(_0x88ae57[_0x4b30b2(-0x278,-0x2b4,-0x2cf,-0x31d)](_0x88ae57['DWPKF'],_0x88ae57[_0x1b7a13(-0x237,-0x195,-0x233,-0x1da)])){const _0x56c2b7=_0x342b64?function(){function _0x20165e(_0x2fa3f5,_0x38c10f,_0x1fa2ce,_0x623478){return _0x1b7a13(_0x2fa3f5-0xd8,_0x1fa2ce,_0x1fa2ce-0x42,_0x2fa3f5-0x6bd);}function _0x4d0b71(_0xdd19ac,_0x2c262d,_0xcdd7dd,_0x4db33e){return _0x1b7a13(_0xdd19ac-0xf6,_0xdd19ac,_0xcdd7dd-0x132,_0x2c262d-0x33f);}if(_0x5d146d){if(_0x459969[_0x20165e(0x4d6,0x4ee,0x532,0x48b)](_0x459969['uhiSm'],_0x459969[_0x4d0b71(0x155,0x159,0x173,0x172)])){const _0x39c902=_0x5d146d['apply'](_0x53837d,arguments);return _0x5d146d=null,_0x39c902;}else{const _0x30cc44={'original':_0x32ae01,'cleaned':_0x48fb8a,'prefix':'','suffix':'','weight':'','skip':_0x459969[_0x20165e(0x517,0x505,0x560,0x51c)](_0x1f19d6,_0x5c11de)};_0x52b6b9[_0x20165e(0x4c4,0x4d6,0x490,0x4bf)](_0x30cc44),!_0x30cc44['skip']&&_0xdc954&&(_0x2dadcc[_0x4d0b71(0x111,0x146,0x180,0x112)](_0x6c94f6),_0x8ef597['set'](_0x4ae344[_0x20165e(0x50d,0x561,0x4d0,0x558)+'e'](),_0x30cc44));}}}:function(){};return _0x342b64=![],_0x56c2b7;}else!_0x914a94&&(_0x4ad7b6[_0x1b7a13(-0x23a,-0x20a,-0x1ea,-0x21c)](_0x459969[_0x1b7a13(-0x1bf,-0x1af,-0x1f6,-0x209)]),_0x3e89d6=!![]);};}()),_0x23e812=_0xc0d435(this,function(){const _0x209f0a={};_0x209f0a['ZKxon']='(((.+)+)+)'+'+$';function _0x527472(_0x25d765,_0x4a2e3d,_0x2781ec,_0x81facc){return _0x3fab(_0x81facc- -0x184,_0x4a2e3d);}function _0xd1fc3f(_0x2102fa,_0x30b90e,_0x23d824,_0x59589d){return _0x3fab(_0x59589d- -0x18a,_0x30b90e);}const _0x2b68e0=_0x209f0a;return _0x23e812[_0xd1fc3f(-0x4e,-0x38,-0x14,-0x72)]()[_0x527472(-0x94,-0x126,-0x11f,-0xe2)](_0x2b68e0[_0xd1fc3f(-0xdf,-0xf5,-0x125,-0xc7)])['toString']()[_0xd1fc3f(-0xdf,-0xa8,-0x77,-0x89)+'r'](_0x23e812)['search'](_0x2b68e0[_0x527472(-0xa9,-0xc2,-0x96,-0xc1)]);});function _0x3fab(_0x4b22fd,_0xe1c0e){const _0x195dff=_0x1f0a();return _0x3fab=function(_0x5b6f8a,_0x51ed36){_0x5b6f8a=_0x5b6f8a-(-0x6*-0xf2+-0x1d0c+0x17f8);let _0xef2296=_0x195dff[_0x5b6f8a];if(_0x3fab['NtlCdq']===undefined){var _0x4003fb=function(_0x50a88f){const _0x427c37='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1a9c8c='',_0x48356a='',_0x498657=_0x1a9c8c+_0x4003fb;for(let _0x32ae01=0xd18+0xac6+-0x17de,_0x48fb8a,_0x1f19d6,_0x5c11de=0x67*0x41+-0xd5d+-0xcca;_0x1f19d6=_0x50a88f['charAt'](_0x5c11de++);~_0x1f19d6&&(_0x48fb8a=_0x32ae01%(-0x251e+0x1*0x1a95+0xa8d)?_0x48fb8a*(0x1b1*0x17+-0xbb*0x2e+-0x50d)+_0x1f19d6:_0x1f19d6,_0x32ae01++%(-0xd*0x43+-0xab2*0x1+0x1*0xe1d))?_0x1a9c8c+=_0x498657['charCodeAt'](_0x5c11de+(-0xac1+-0x2639+0xc41*0x4))-(-0x1*0x79a+0x23f6+0x1c52*-0x1)!==-0x2078+-0x4ff*-0x5+0x77d?String['fromCharCode'](0xf5d+0x174d+-0x1*0x25ab&_0x48fb8a>>(-(-0xb54+-0x214+-0x6b5*-0x2)*_0x32ae01&0xfc1+-0x137d+0x3c2)):_0x32ae01:0x1b9f+-0xa78+-0x1127){_0x1f19d6=_0x427c37['indexOf'](_0x1f19d6);}for(let _0x52b6b9=0x24ab+-0x655*0x4+-0xb57,_0xdc954=_0x1a9c8c['length'];_0x52b6b9<_0xdc954;_0x52b6b9++){_0x48356a+='%'+('00'+_0x1a9c8c['charCodeAt'](_0x52b6b9)['toString'](0x151*0x9+0x1bbd*-0x1+0xff4))['slice'](-(-0x2*0x11b0+-0x2f4+0x2656));}return decodeURIComponent(_0x48356a);};_0x3fab['SxpbmR']=_0x4003fb,_0x4b22fd=arguments,_0x3fab['NtlCdq']=!![];}const _0x41c6a2=_0x195dff[0x14f*0xe+-0xd*-0x2ba+-0x1ae2*0x2],_0x2f3675=_0x5b6f8a+_0x41c6a2,_0x28d1bf=_0x4b22fd[_0x2f3675];if(!_0x28d1bf){const _0x46fc4b=function(_0x2c8336){this['avffJF']=_0x2c8336,this['jYljOk']=[0x1ce0+0x1*-0x201a+-0x1*-0x33b,-0x1*0xd28+-0xe32+-0x1b5a*-0x1,-0x1*0x149+0x221f+-0x20d6*0x1],this['IEkjnY']=function(){return'newState';},this['pkllRO']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VhjSvR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x46fc4b['prototype']['xECiXs']=function(){const _0x5073c6=new RegExp(this['pkllRO']+this['VhjSvR']),_0x6e725d=_0x5073c6['test'](this['IEkjnY']['toString']())?--this['jYljOk'][0x7b*-0x21+-0x39f*-0x3+-0x1*-0x4ff]:--this['jYljOk'][-0x11*-0x221+-0x1*0x21f8+-0x239];return this['thSBXD'](_0x6e725d);},_0x46fc4b['prototype']['thSBXD']=function(_0x2dadcc){if(!Boolean(~_0x2dadcc))return _0x2dadcc;return this['CJWlVP'](this['avffJF']);},_0x46fc4b['prototype']['CJWlVP']=function(_0x6c94f6){for(let _0x8ef597=-0x1ce*0x8+0x1*-0x1871+0x26e1,_0x4ae344=this['jYljOk']['length'];_0x8ef597<_0x4ae344;_0x8ef597++){this['jYljOk']['push'](Math['round'](Math['random']())),_0x4ae344=this['jYljOk']['length'];}return _0x6c94f6(this['jYljOk'][0x172*-0x13+-0x88a*-0x2+0xa62]);},new _0x46fc4b(_0x3fab)['xECiXs'](),_0xef2296=_0x3fab['SxpbmR'](_0xef2296),_0x4b22fd[_0x2f3675]=_0xef2296;}else _0xef2296=_0x28d1bf;return _0xef2296;},_0x3fab(_0x4b22fd,_0xe1c0e);}_0x23e812();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';function _0x1f0a(){const _0x4ecb24=['DvLiANC','C0fIq2e','svjPBui','D1Dgwxi','swzvBvO','ioAjP+IHJoE7K+AENcaOsuq6','Bwf0y2G','C3vJy2vZCW','C3bSAxq','C2v0','DhjPBq','ufjptvbux1jfuq','C3zZte0','vePZuwO','CMvWBgfJzq','qKzyCNu','sMnxCeK','t3bruhi','C3rYAw5NAwz5','y1bzEuG','wKT4B24','BM93','ieXmtsdORR7NVA7POBxPNAi','odu5mZCYBfjqCLzz','wLneqwO','zw1PDa','iefjioIUVUE9RUw3SUE7N+s4GowiSa','ugPpANq','DuX0DLe','AM9PBG','Bg9N','tMPorgG','DerMAvq','A0XzChC','yxbWBhK','uKzKwNa','C3rTtNO','zxHmwvO','zhrdufC','y2jxDKW','ANDpwfi','C3vIC3rYAw5N','DhjHBNnSyxrPBW','CgfYC2u','C29Tzq','zxjYB3i','qxvuuwm','zgLZCgXHEvrLEa','D2fYBG','CNjSugy','tfD3A3y','Afnizfq','mJC1mdf2qvDAEee','vuX5vhu','C2HTD3O','BgvUz3rO','rvnu','Chv3BwK','sLD4teO','BwfW','EvPhCxC','zw5LCG','57+76k+rieXmtsdMIAFOOyZOTOu','5BcD6k+v5PEN5Qc85BYpoG','CMvZDwX0CW','ChvZAa','tMvLthm','CLfPuNa','zw50CMLLCW','CMvTB3zLtgLZDa','C2TPCa','mZy1nZq4oeXJAhfXua','C2TPChbLza','wNjXrNu','s0Hmz3G','CvfOvhC','AM1wCg8','tefPwMe','vvb5s0i','uMjerxe','ugLyzKS','uwXeEM4','y29UC3rYDwn0BW','y2TywhO','Du1KvMO','57+76k+r5AsX6lsLoIa','D0DyuNa','u0PqEfi','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','v3HhruW','uhLgzwG','mJC3otmYnNHoweX3vW','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','uNnWD08','qMTUruW','ioIVT+AXGUE/U+IVKsbmte0G','rfDqs0y','qxzfswm','wMvOrhK','BMfTzq','ufjptvbux1jfuW','y0z5u1e','Bg5rvgq','DMHZCNy','rwzjteq','Dg9tDhjPBMC','yxDvDvq','qvrjt05FuKvtua','uwDptxe','BwvZC2fNzq','tMffCKy','ue9ou0u','teXnx1rsqu5tta','runLz1K','uxbAyuy','tNfytwS','qNnxvfe','qvrjt05Fr0vuxW','ENbStee','Ew1cs3q','AxnbCNjHEq','y2XLyw5Lza','Aw5KzxHpzG','D0zfwMK','CwXOAuO','sw1Zuhi','B3D5uNm','t05trq','B3jPz2LUywXuyq','qK5hzu8','zuzuzxi','CvLoz24','Evr3A0O','nZu4ntnUAvHrrLy','Bg9oDwy','Cxbfq2W','BxpVViK','iow3SUAuTUwiSoE/U+IVKsbmte0','Dg9mB3DLCKnHCW','CMfUzg9Tvvvjra','zwrTvgS','rMH5Cvm','ANLTyNm','DhvzqvO','CMvZDwX0','AhH6rNG','qvrjt05FuKvrvq','Avn4se0','z3zhEgu','yMjVsvm','rMDIBLi','icHjrdOG','yvrozu8','z1rIyKq','iePtt07OP6pMNPdLPlhOTkxVViW','C3qTy2HHDhu4oG','sMzPu2m','CvHXvLa','mtK2otKYoxbXCg5ywa','EwPSDNO','Ce1WvLi','B2jQzwn0','q3DMrKC','Ae9zwKq','uLDuyLi','n3D4AhHyEG','zMLSDgvY','57+76k+r5AsX6lsLoG','C3rYAw5N','B3jPz2LUywW','u0TVBhi','zw93qu4','vuvtva','DxnLCG','yMPmzNy','qwjVCNrfCNjVCG','C2vHCMnO','A1rpsfm','mJaWu0TIvuzL','tg9uvuy','qMvRBeO','EgXgs3C','BhrSqxa','ugTjA1C','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','mZa1ndG1yNLSzufr','C2XPy2u','s0rvD2e','keLeoIa'];_0x1f0a=function(){return _0x4ecb24;};return _0x1f0a();}let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x31f374){function _0x99c972(_0x1ea663,_0x4c2c28,_0x55d485,_0x1f6665){return _0x3fab(_0x4c2c28-0xcf,_0x55d485);}function _0x5219fc(_0x586bb5,_0x5743bc,_0x43ac4c,_0x565836){return _0x3fab(_0x43ac4c- -0x26b,_0x5743bc);}return SKIP_PATTERNS[_0x99c972(0x19e,0x1aa,0x156,0x153)](_0x440096=>_0x440096['test'](_0x31f374[_0x99c972(0x17a,0x188,0x194,0x13c)]()));}export function tagsToJsonString(_0x16bd1c){if(!Array['isArray'](_0x16bd1c))return'[]';function _0x1594d7(_0x426380,_0x4c9998,_0x151bb6,_0x1f9add){return _0x3fab(_0x1f9add-0x294,_0x4c9998);}function _0x1daf8e(_0x18b823,_0x56d95f,_0x201834,_0x4a5385){return _0x3fab(_0x18b823-0x271,_0x56d95f);}return JSON['stringify'](_0x16bd1c[_0x1daf8e(0x309,0x2da,0x35c,0x319)](_0x45f625=>_0x45f625&&typeof _0x45f625===_0x1594d7(0x38c,0x307,0x364,0x32e)));}export function preprocessPromptForTranslation(_0x282b3d){const _0x15a49e={'wFEZi':'yrqvt','VDFPG':function(_0x3ed08a,_0x51a8d7){return _0x3ed08a<_0x51a8d7;},'mIhZE':function(_0x48cfd4,_0x1b5c23){return _0x48cfd4!==_0x1b5c23;},'ymBKt':'WyDzq','zplLA':_0x165b44(0x11b,0xfe,0x117,0x12d),'HRPzf':function(_0xab91db,_0x4ad19f){return _0xab91db===_0x4ad19f;},'hOYZD':_0x165b44(0x162,0x10f,0xb0,0x114),'ULyTu':_0x165b44(0x16f,0x152,0x192,0x1a6),'ltlAp':_0x165b44(0xc8,0xd6,0x88,0x11a),'PiXfK':function(_0xfdd9b8,_0x393b5a){return _0xfdd9b8(_0x393b5a);}};if(!_0x282b3d||typeof _0x282b3d!==_0x15a49e[_0x165b44(0xe4,0xe4,0xa7,0xa0)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};function _0x165b44(_0x29b935,_0x356c48,_0x4be82c,_0x5b3fb1){return _0x3fab(_0x356c48-0x3c,_0x29b935);}const _0x342861=_0x1f2d12=>{function _0xee810c(_0x499802,_0xa83c8a,_0x5621ad,_0x379897){return _0x1f381b(_0x499802-0x7f,_0x379897,_0x5621ad- -0xff,_0x379897-0x1a);}function _0x4aaad2(_0x55f8fe,_0x4ac0ba,_0x3e6f69,_0x3bffa2){return _0x165b44(_0x3e6f69,_0x4ac0ba- -0x27a,_0x3e6f69-0xb0,_0x3bffa2-0xf5);}if(_0x15a49e[_0x4aaad2(-0xba,-0x114,-0x105,-0xf9)]!==_0x15a49e[_0xee810c(0x2fb,0x2d2,0x29f,0x272)])return _0x4650ef;else{const _0x120a79=[];let _0x58830a='',_0x4078ff=![];for(let _0x3b182c=-0x123f+-0x2322+0x1*0x3561;_0x15a49e['VDFPG'](_0x3b182c,_0x1f2d12[_0x4aaad2(-0x15f,-0x158,-0x13e,-0x196)]);_0x3b182c++){if(_0x15a49e['mIhZE'](_0x15a49e[_0xee810c(0x296,0x247,0x29b,0x242)],_0x15a49e[_0xee810c(0x2b5,0x2a0,0x29a,0x29c)])){const _0x14f685=_0x1f2d12[_0x3b182c];if(_0x15a49e['HRPzf'](_0x14f685,'$'))_0x4078ff=!_0x4078ff,_0x58830a+=_0x14f685;else{if((_0x14f685===','||_0x14f685==='，')&&!_0x4078ff){if(_0x15a49e[_0x4aaad2(-0xb2,-0xec,-0x11d,-0xd4)]!==_0x15a49e[_0x4aaad2(-0x135,-0x15a,-0x10e,-0x179)]){const _0x1e2056=_0x58830a[_0xee810c(0x27b,0x23a,0x22e,0x220)]();if(_0x1e2056)_0x120a79[_0x4aaad2(-0x17a,-0x14e,-0x150,-0xfc)](_0x1e2056);_0x58830a='';}else{const _0x461c11={};return _0x461c11[_0x4aaad2(-0x185,-0x14f,-0x11a,-0x101)]=[],_0x461c11['displayTex'+'t']='',_0x461c11[_0x4aaad2(-0xe5,-0x10f,-0xfe,-0x118)+'gs']=[],_0x461c11;}}else _0x58830a+=_0x14f685;}}else _0x295b1b[_0xee810c(0x279,0x236,0x254,0x252)](_0x4aaad2(-0x121,-0xf4,-0x139,-0xdf)+'\x20JSON解析失败，'+'尝试旧格式:',_0x151826['message']);}if(_0x58830a[_0x4aaad2(-0x15d,-0x185,-0x166,-0x1b6)]())_0x120a79[_0x4aaad2(-0x18b,-0x14e,-0x1a1,-0x177)](_0x58830a[_0x4aaad2(-0x12f,-0x185,-0x157,-0x157)]());return _0x120a79;}},_0x23e498=_0x342861(_0x282b3d),_0x5f0831=[],_0x47e45c=[],_0x5cb73c=new Map();for(const _0x5f764f of _0x23e498){const _0x168424=_0x5f764f['match'](SD_SYMBOL_PATTERN);if(_0x168424){const _0x3c7db9=_0x168424[-0x211e+-0x138f+0x34ae]||'',_0x30ab1a=(_0x168424[-0x1*-0xbdd+0x1fe6+-0x2bc1]||'')[_0x165b44(0xbb,0xf5,0x9e,0x149)](),_0x3bbf26=_0x168424[0x1*-0x14b1+0x12f3+0x1c1]||'',_0x3069b0=_0x168424[0xd*-0x7c+-0x48*-0x47+0x1*-0xda8]||'',_0x4e74c0={'original':_0x5f764f,'cleaned':_0x30ab1a,'prefix':_0x3c7db9,'suffix':_0x3bbf26,'weight':_0x3069b0,'skip':_0x15a49e[_0x165b44(0xed,0x13b,0x184,0x123)](shouldSkipTranslation,_0x5f764f)||_0x15a49e[_0x1f381b(0x36b,0x36a,0x373,0x399)](shouldSkipTranslation,_0x30ab1a)};_0x5f0831[_0x1f381b(0x368,0x315,0x364,0x376)](_0x4e74c0),!_0x4e74c0[_0x165b44(0x18d,0x131,0x177,0x138)]&&_0x30ab1a&&(_0x47e45c[_0x165b44(0x10d,0x12c,0x139,0xe3)](_0x30ab1a),_0x5cb73c[_0x1f381b(0x378,0x2ed,0x32c,0x366)](_0x30ab1a[_0x165b44(0x1ba,0x175,0x1ce,0x18d)+'e'](),_0x4e74c0));}else{const _0x413487={'original':_0x5f764f,'cleaned':_0x5f764f,'prefix':'','suffix':'','weight':'','skip':_0x15a49e[_0x1f381b(0x348,0x3ce,0x373,0x385)](shouldSkipTranslation,_0x5f764f)};_0x5f0831[_0x165b44(0x145,0x12c,0x148,0x142)](_0x413487),!_0x413487[_0x165b44(0x105,0x131,0xf7,0x177)]&&_0x5f764f&&(_0x47e45c[_0x1f381b(0x339,0x33c,0x364,0x374)](_0x5f764f),_0x5cb73c[_0x165b44(0x114,0xf4,0x10a,0xdd)](_0x5f764f['toLowerCas'+'e'](),_0x413487));}}function _0x1f381b(_0xfae1cd,_0x4cec30,_0x11e72e,_0x4c0c46){return _0x3fab(_0x11e72e-0x274,_0x4cec30);}return{'originalTags':_0x5f0831,'cleanedTags':_0x47e45c,'cleanedText':_0x15a49e['PiXfK'](tagsToJsonString,_0x47e45c),'tagMap':_0x5cb73c};}export function combineTranslationResult(_0x1b45bd,_0xb106c5){const _0x1e36cb={};function _0x463476(_0x35a6da,_0xc9ac2b,_0x3c1ee8,_0x1ce9fc){return _0x3fab(_0x35a6da- -0x203,_0x1ce9fc);}_0x1e36cb['ZehDy']=function(_0x503af0,_0x3443be){return _0x503af0===_0x3443be;},_0x1e36cb[_0x463476(-0xfa,-0x158,-0x122,-0xaf)]=_0x463476(-0xb3,-0xa8,-0xd4,-0xbb),_0x1e36cb[_0x42e2d2(0x2ac,0x2b2,0x308,0x258)]=function(_0x3aa6dc,_0x2795f1){return _0x3aa6dc!==_0x2795f1;};function _0x42e2d2(_0x42c842,_0x2d80f4,_0x1e4245,_0xe58b1d){return _0x3fab(_0x42c842-0x15e,_0xe58b1d);}_0x1e36cb[_0x42e2d2(0x246,0x249,0x28b,0x27e)]=_0x42e2d2(0x28f,0x239,0x232,0x297),_0x1e36cb[_0x463476(-0xbc,-0x114,-0x86,-0xd4)]=_0x42e2d2(0x22d,0x217,0x22a,0x224);const _0x48a3eb=_0x1e36cb;if(!_0x1b45bd||!Array['isArray'](_0x1b45bd))return[];const _0x1e6e6a={};if(_0xb106c5&&_0x48a3eb[_0x42e2d2(0x26f,0x22e,0x248,0x294)](typeof _0xb106c5,_0x48a3eb['PyFeh']))for(const [_0x22a9bd,_0x9e2bf0]of Object[_0x42e2d2(0x251,0x225,0x296,0x204)](_0xb106c5)){if(_0x48a3eb['yjlvz'](_0x42e2d2(0x203,0x1fc,0x1fd,0x1f7),_0x48a3eb[_0x463476(-0xbc,-0x72,-0xd8,-0x10f)]))_0x1e6e6a[_0x22a9bd['toLowerCas'+'e']()]=_0x9e2bf0;else{const _0x101990=_0x54f3b1[_0x463476(-0x14e,-0x17b,-0x184,-0x13f)](/\{[\s\S]*\}/);if(_0x101990){const _0x3fd6bf=_0x5a2e37[_0x463476(-0x129,-0x184,-0x14c,-0x104)](_0x101990[0x1da+-0x262f+-0x83*-0x47]);if(_0x48a3eb[_0x463476(-0xf2,-0x124,-0x105,-0xfa)](typeof _0x3fd6bf,_0x48a3eb[_0x42e2d2(0x267,0x21f,0x212,0x2a3)])&&_0x48a3eb[_0x463476(-0xb5,-0x6c,-0x62,-0xf1)](_0x3fd6bf,null))return _0x3fd6bf;}}}return _0x1b45bd['map'](_0x5d32e8=>{function _0x1e42ee(_0x19c751,_0x229574,_0x3822bb,_0x4988d9){return _0x42e2d2(_0x3822bb- -0x512,_0x229574-0x98,_0x3822bb-0x1aa,_0x229574);}function _0x44f449(_0x13dd0,_0x40530b,_0x1fa11d,_0x2e5d9c){return _0x463476(_0x2e5d9c-0x31d,_0x40530b-0x192,_0x1fa11d-0x1d7,_0x13dd0);}if(_0x48a3eb['yjlvz'](_0x48a3eb['puwmi'],_0x1e42ee(-0x23f,-0x288,-0x283,-0x2c8))){const _0x33dfeb={};return _0x33dfeb[_0x1e42ee(-0x30d,-0x2fe,-0x319,-0x33a)]=_0x1682f3,_0x33dfeb[_0x44f449(0x1b2,0x234,0x1a2,0x1f3)+'n']='',_0x33dfeb[_0x44f449(0x250,0x292,0x244,0x242)]=_0xf09925,_0x33dfeb[_0x1e42ee(-0x304,-0x2c9,-0x2bd,-0x312)]=!![],_0x33dfeb;}else{const {original:_0x234be6,cleaned:_0xe302c4,skip:_0x5633c4}=_0x5d32e8;if(_0x5633c4){const _0x218e32={};return _0x218e32[_0x44f449(0x164,0x15b,0x168,0x1b5)]=_0x234be6,_0x218e32[_0x1e42ee(-0x2e1,-0x2a2,-0x2db,-0x2aa)+'n']='',_0x218e32[_0x1e42ee(-0x238,-0x25c,-0x28c,-0x2d3)]=_0xe302c4,_0x218e32['skipped']=!![],_0x218e32;}const _0x56ae1c=_0x1e6e6a[_0xe302c4[_0x1e42ee(-0x21e,-0x24e,-0x27b,-0x270)+'e']()]||'',_0x2e9a57={};return _0x2e9a57[_0x1e42ee(-0x307,-0x32f,-0x319,-0x2d2)]=_0x234be6,_0x2e9a57[_0x44f449(0x1e5,0x195,0x243,0x1f3)+'n']=_0x56ae1c,_0x2e9a57[_0x44f449(0x27d,0x238,0x21d,0x242)]=_0xe302c4,_0x2e9a57[_0x44f449(0x1e4,0x1f9,0x217,0x211)]=![],_0x2e9a57;}});}export function formatTranslationDisplay(_0x42165d,_0x11ead5={}){const _0x502108={};_0x502108[_0x3de21f(0x25f,0x275,0x297,0x24c)]=function(_0x44903c,_0x13837a){return _0x44903c!==_0x13837a;},_0x502108['xrtOX']=_0x1faf72(-0x1d8,-0x26b,-0x200,-0x22a),_0x502108[_0x3de21f(0x2d1,0x27e,0x2c7,0x226)]=function(_0x4e01ad,_0x1f3846){return _0x4e01ad===_0x1f3846;};function _0x3de21f(_0x3734a6,_0x14b4b0,_0x300d39,_0x16a303){return _0x3fab(_0x14b4b0-0x1aa,_0x16a303);}_0x502108['pCbvl']=_0x3de21f(0x27f,0x253,0x213,0x262),_0x502108[_0x1faf72(-0x2fc,-0x2e0,-0x30d,-0x2ba)]=_0x1faf72(-0x28b,-0x1eb,-0x28d,-0x23b),_0x502108[_0x1faf72(-0x23c,-0x295,-0x2b3,-0x25b)]=_0x3de21f(0x325,0x2cd,0x272,0x2d7),_0x502108[_0x1faf72(-0x222,-0x23e,-0x224,-0x27c)]=_0x1faf72(-0x286,-0x2ba,-0x28a,-0x2c5);const _0x1ebb29=_0x502108;function _0x1faf72(_0x206b5c,_0x3e4f68,_0x9cc1eb,_0x55e796){return _0x3fab(_0x55e796- -0x376,_0x3e4f68);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x11ead5;if(!_0x42165d||!Array[_0x1faf72(-0x29f,-0x22c,-0x285,-0x24f)](_0x42165d))return'';return _0x42165d[_0x3de21f(0x2c3,0x294,0x246,0x289)](_0x3636ed=>{function _0x127d30(_0x4b955a,_0x4e6ab8,_0x15e4e2,_0x2ecc55){return _0x1faf72(_0x4b955a-0x45,_0x15e4e2,_0x15e4e2-0x9e,_0x4b955a-0x104);}function _0x42b5bd(_0x2eaf10,_0x49237,_0x4f9f93,_0x317c6d){return _0x1faf72(_0x2eaf10-0x1ca,_0x317c6d,_0x4f9f93-0x6e,_0x49237-0x1c);}if(_0x1ebb29[_0x42b5bd(-0x285,-0x28f,-0x2ec,-0x2a6)](_0x42b5bd(-0x1ef,-0x20e,-0x1ca,-0x1cd),_0x1ebb29['xrtOX']))return _0x57777f?_0x35cf50[_0x127d30(-0x1d7,-0x20e,-0x21d,-0x197)]:'';else{if(_0x3636ed[_0x42b5bd(-0x23b,-0x263,-0x21f,-0x29d)]){if(_0x1ebb29[_0x42b5bd(-0x280,-0x286,-0x236,-0x25d)](_0x1ebb29['pCbvl'],_0x1ebb29[_0x127d30(-0x1b6,-0x188,-0x1d6,-0x1de)])){if(!_0x502e7e['isArray'](_0xa6314b))return'[]';return _0x42ea7d[_0x42b5bd(-0x2e6,-0x299,-0x2b6,-0x26d)](_0x17e6b7[_0x42b5bd(-0x2e7,-0x2c2,-0x284,-0x2c0)](_0x56f4d8=>_0x56f4d8&&typeof _0x56f4d8==='string'));}else return showOriginal?_0x3636ed[_0x42b5bd(-0x294,-0x2bf,-0x2f6,-0x27b)]:'';}const _0x4927e9=[];if(showOriginal)_0x4927e9['push'](_0x3636ed['original']);if(showTranslation&&_0x3636ed[_0x42b5bd(-0x269,-0x281,-0x292,-0x25a)+'n']){if(_0x1ebb29[_0x42b5bd(-0x20b,-0x23f,-0x1e3,-0x285)]!==_0x1ebb29[_0x127d30(-0x178,-0x16f,-0x1bf,-0x171)])_0x4927e9[_0x127d30(-0x182,-0x1d0,-0x16b,-0x1d0)]('('+_0x3636ed[_0x127d30(-0x199,-0x1c7,-0x14b,-0x1b8)+'n']+')');else{if(_0x22908b){const _0x4fc479=_0x542e30[_0x127d30(-0x1a1,-0x162,-0x1ea,-0x196)](_0x4831cd,arguments);return _0x2669b6=null,_0x4fc479;}}}return _0x4927e9[_0x127d30(-0x1a6,-0x1ae,-0x16c,-0x151)]('\x20');}})['filter'](Boolean)[_0x1faf72(-0x2b6,-0x254,-0x2f4,-0x2aa)](separator);}export async function translatePromptTags(_0x5e4ab1){const _0x387ac1={'kLYpw':function(_0x1ffb95,_0x4bd89a){return _0x1ffb95(_0x4bd89a);},'BknEL':function(_0x2d702e,_0x256070){return _0x2d702e(_0x256070);},'pMpVR':function(_0x382804,_0x3e6d76,_0x2ae106){return _0x382804(_0x3e6d76,_0x2ae106);},'KHLgx':function(_0x1d8f69,_0x462fc2){return _0x1d8f69===_0x462fc2;},'UPyKB':_0x26247b(-0x289,-0x27e,-0x2d9,-0x2c8),'iSxHM':_0x42fadd(0x1a4,0x16b,0x15d,0x19f),'AvEIc':_0x42fadd(0x17c,0x1a2,0x17a,0x198)+'\x20翻译提示词标签失败'+':'},{originalTags:_0x543dc4,cleanedText:_0x59ea78}=_0x387ac1[_0x26247b(-0x2ef,-0x2be,-0x2b7,-0x2a5)](preprocessPromptForTranslation,_0x5e4ab1);function _0x26247b(_0x1ac08f,_0x59b27e,_0x19432b,_0x2ca5b8){return _0x3fab(_0x1ac08f- -0x3bf,_0x2ca5b8);}function _0x42fadd(_0x58f2c5,_0x2e6336,_0x43112e,_0x1e56eb){return _0x3fab(_0x43112e-0x30,_0x2e6336);}if(!_0x59ea78){const _0x4fa580={};return _0x4fa580[_0x26247b(-0x2d0,-0x302,-0x295,-0x2f0)]=[],_0x4fa580['displayTex'+'t']='',_0x4fa580[_0x26247b(-0x290,-0x292,-0x2de,-0x2b2)+'gs']=[],_0x4fa580;}try{const _0xf1521d=await _0x387ac1[_0x42fadd(0x14f,0x125,0x13d,0x163)](callTranslation,_0x59ea78),_0x1b8589=_0x387ac1[_0x42fadd(0xce,0x15e,0x100,0xb1)](parseTranslationResult,_0xf1521d),_0x1a7336=_0x387ac1[_0x42fadd(0x172,0x1b8,0x17f,0x1bb)](combineTranslationResult,_0x543dc4,_0x1b8589),_0x6e8ac2=_0x387ac1[_0x26247b(-0x2ef,-0x2e1,-0x2ba,-0x2f5)](formatTranslationDisplay,_0x1a7336),_0x2dc5ef={};return _0x2dc5ef[_0x26247b(-0x2d0,-0x306,-0x318,-0x2d8)]=_0x1a7336,_0x2dc5ef[_0x42fadd(0x16b,0x130,0x10e,0xf4)+'t']=_0x6e8ac2,_0x2dc5ef[_0x42fadd(0x134,0x1aa,0x15f,0x19d)+'gs']=_0x543dc4,_0x2dc5ef;}catch(_0x5edced){if(_0x387ac1[_0x26247b(-0x2c6,-0x30c,-0x2d0,-0x276)](_0x387ac1[_0x42fadd(0x114,0x130,0x12d,0x150)],_0x387ac1[_0x42fadd(0x1ad,0x145,0x172,0x12e)])){const _0x48f822=_0x58ebcc['apply'](_0x5e23ac,arguments);return _0x80fd5b=null,_0x48f822;}else{console[_0x26247b(-0x2e3,-0x2d8,-0x290,-0x33d)](_0x387ac1[_0x42fadd(0x173,0x17f,0x140,0x18d)],_0x5edced);throw _0x5edced;}}}export function parseTranslationResult(_0x39e9af){function _0x7cd164(_0x59bc43,_0x15f413,_0x4354b7,_0x882b5b){return _0x3fab(_0x4354b7-0x17d,_0x882b5b);}const _0x5467c6={'bboIS':function(_0x565b9a,_0x4aa026){return _0x565b9a(_0x4aa026);},'BeklJ':function(_0x1993bc,_0xfbcc04){return _0x1993bc(_0xfbcc04);},'QpZaF':function(_0x3b0ec4){return _0x3b0ec4();},'JcWpI':function(_0x16ecd2,_0x591048,_0x3933f4){return _0x16ecd2(_0x591048,_0x3933f4);},'bjLfv':function(_0x37db62,_0x316a30){return _0x37db62!==_0x316a30;},'qYNgn':_0x2a32ae(0x47a,0x444,0x470,0x442),'yZGqw':function(_0x49ca91,_0xf01421){return _0x49ca91!==_0xf01421;},'OpQPr':_0x2a32ae(0x41f,0x491,0x483,0x45c),'FhyqS':function(_0x3b320a,_0x246c98){return _0x3b320a===_0x246c98;},'xEjCO':_0x7cd164(0x29c,0x309,0x2cd,0x2b4),'TSLtP':function(_0x38f37b,_0x1db3fa){return _0x38f37b!==_0x1db3fa;},'ImsPr':_0x2a32ae(0x42a,0x40a,0x48b,0x45f),'LWwkv':_0x2a32ae(0x452,0x405,0x468,0x461)+_0x2a32ae(0x46a,0x458,0x4ae,0x460)+_0x7cd164(0x29b,0x2ae,0x26b,0x254),'YoNii':function(_0x550293,_0x3cc62d){return _0x550293>_0x3cc62d;},'SzSkL':function(_0x1efd6a,_0xb312da){return _0x1efd6a+_0xb312da;}};if(!_0x39e9af)return{};try{if(_0x5467c6[_0x2a32ae(0x378,0x416,0x3a3,0x3b7)](_0x5467c6[_0x7cd164(0x28a,0x28d,0x2af,0x2b9)],_0x7cd164(0x271,0x2b5,0x2a8,0x2f9))){const _0xe04257={'cFySQ':function(_0x42ac3b,_0x577855){function _0xe59e85(_0x371834,_0x5bfb65,_0x52a4b6,_0x45b597){return _0x2a32ae(_0x5bfb65,_0x5bfb65-0x139,_0x52a4b6-0x1f1,_0x45b597- -0x20f);}return _0x5467c6[_0xe59e85(0x16e,0x19c,0x206,0x1ae)](_0x42ac3b,_0x577855);}},_0x424fb9=_0x5467c6[_0x7cd164(0x2ea,0x2bd,0x29e,0x2ed)](_0x1f21a6);_0x4d0a65[_0x7cd164(0x25e,0x278,0x24a,0x211)]('st-chatu8:'+'\x20请求获取翻译提示词'+_0x2a32ae(0x462,0x498,0x402,0x45d)+_0x424fb9+')');const _0x99b495=_0x3fe87c=>{if(_0x3fe87c['id']!==_0x424fb9)return;_0x332ff2[_0xc92363(0xb4,0x124,0xa2,0xc6)+_0x55d652(-0x1d2,-0x1ec,-0x19f,-0x1b7)](_0x47ebc3[_0xc92363(0x115,0xe2,0x11e,0xf1)+_0x55d652(-0x15e,-0x11b,-0x167,-0x1a9)+'PROMPT_RES'+'PONSE'],_0x99b495);const {prompt:_0x2e19b}=_0x3fe87c;function _0x55d652(_0x2053c4,_0x4b0e9a,_0x44db3a,_0xaa0153){return _0x2a32ae(_0xaa0153,_0x4b0e9a-0x50,_0x44db3a-0xf2,_0x44db3a- -0x5a2);}_0x25f1fd[_0x55d652(-0x1de,-0x201,-0x1be,-0x1a5)](_0xc92363(0x144,0x10d,0xef,0x11c)+_0xc92363(0xc6,0xe3,0x10d,0xdd)+_0x55d652(-0x1f8,-0x1f6,-0x1dd,-0x1e3)+_0x424fb9+'):',_0x2e19b);function _0xc92363(_0x48b070,_0x1f2c94,_0xfdeada,_0x43fbb3){return _0x7cd164(_0x48b070-0x18e,_0x1f2c94-0x11c,_0x43fbb3- -0x1ab,_0xfdeada);}_0x5467c6[_0xc92363(0xfd,0xbc,0x10e,0x116)](_0x25bf0b,_0x2e19b);};_0x39ca64['on'](_0x1432d3['LLM_TRANSL'+_0x7cd164(0x246,0x261,0x2a1,0x26c)+_0x2a32ae(0x411,0x3d6,0x43d,0x42a)+_0x2a32ae(0x463,0x45e,0x3eb,0x435)],_0x99b495);const _0x57d67f={};_0x57d67f['id']=_0x424fb9,_0x1830db[_0x2a32ae(0x427,0x3b1,0x417,0x3df)](_0x121277[_0x2a32ae(0x412,0x464,0x435,0x436)+_0x2a32ae(0x455,0x443,0x449,0x43b)+_0x2a32ae(0x41a,0x393,0x426,0x3d1)+_0x2a32ae(0x3d8,0x409,0x384,0x3b5)],_0x57d67f),_0x5467c6[_0x7cd164(0x21d,0x269,0x23c,0x290)](_0x2a6f96,()=>{function _0x1632fa(_0x46718c,_0x1544af,_0x42b3e2,_0x375a1c){return _0x7cd164(_0x46718c-0x29,_0x1544af-0x8a,_0x42b3e2-0x11d,_0x46718c);}_0x537e05[_0x1632fa(0x340,0x33e,0x38e,0x35d)+_0x3e5ada(0x233,0x1f5,0x231,0x28f)](_0x5b4886[_0x1632fa(0x381,0x402,0x3b9,0x40e)+_0x1632fa(0x399,0x3dd,0x3be,0x407)+'PROMPT_RES'+_0x3e5ada(0x265,0x244,0x2b7,0x25a)],_0x99b495);function _0x3e5ada(_0x467503,_0x5974a7,_0x5b60a5,_0x597d18){return _0x2a32ae(_0x597d18,_0x5974a7-0xe,_0x5b60a5-0x1bd,_0x467503- -0x1d0);}_0xe04257[_0x3e5ada(0x25b,0x2a1,0x29f,0x201)](_0x5e438e,new _0x536f6d(_0x1632fa(0x362,0x3c0,0x3a1,0x3f1)));},0x4a8d+0x1f*-0xf4+-0x5f1);}else{const _0x330c19=_0x39e9af['match'](/\{[\s\S]*\}/);if(_0x330c19){if(_0x5467c6['yZGqw'](_0x5467c6[_0x7cd164(0x224,0x284,0x23d,0x221)],_0x5467c6[_0x2a32ae(0x38e,0x3ef,0x401,0x3d7)]))for(const [_0x2b5a9d,_0x7f86b4]of _0xa3d877['entries'](_0x3faa62)){_0xad9aa1[_0x2b5a9d['toLowerCas'+'e']()]=_0x7f86b4;}else{const _0x172f7f=JSON[_0x7cd164(0x27a,0x1fd,0x257,0x26b)](_0x330c19[0x157*-0x2+0x1f*-0xec+-0xfa1*-0x2]);if(_0x5467c6[_0x7cd164(0x29b,0x266,0x2b9,0x2fe)](typeof _0x172f7f,_0x5467c6['xEjCO'])&&_0x5467c6['TSLtP'](_0x172f7f,null))return _0x5467c6[_0x2a32ae(0x407,0x43a,0x408,0x402)](_0x5467c6[_0x2a32ae(0x489,0x464,0x495,0x443)],_0x5467c6['ImsPr'])?[]:_0x172f7f;}}}}catch(_0x2d201b){console[_0x7cd164(0x29e,0x2a3,0x25c,0x276)](_0x5467c6[_0x2a32ae(0x438,0x3b0,0x3fa,0x3f8)],_0x2d201b[_0x7cd164(0x2b9,0x259,0x299,0x245)]);}function _0x2a32ae(_0x41e353,_0x2a1697,_0x2bf394,_0xf4b432){return _0x3fab(_0xf4b432-0x317,_0x41e353);}const _0x4b79f0=String(_0x39e9af)[_0x7cd164(0x249,0x201,0x23a,0x231)](/[\r\n]+/g,'\x20')[_0x2a32ae(0x3f3,0x37e,0x3f1,0x3d4)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x2a32ae(0x3ed,0x3dc,0x42c,0x3d0)](),_0x44e4f4=_0x4b79f0[_0x2a32ae(0x36f,0x382,0x3ce,0x3ce)](/[,，]/)[_0x7cd164(0x221,0x20a,0x267,0x215)](_0x4bd590=>_0x4bd590[_0x2a32ae(0x3f8,0x422,0x3d2,0x3d0)]())[_0x7cd164(0x256,0x23d,0x215,0x20f)](Boolean),_0x4481c0={};for(const _0x522821 of _0x44e4f4){const _0x3a32fb=_0x522821[_0x7cd164(0x2d1,0x256,0x2a6,0x25f)]('\x5c');if(_0x5467c6['YoNii'](_0x3a32fb,0x975*0x3+0x9b1+-0x2610)){const _0x1d3d13=_0x522821[_0x2a32ae(0x3aa,0x395,0x3cf,0x3c3)](-0x1096+0x78*0x4f+-0x1472,_0x3a32fb)['trim'](),_0x5d17b3=_0x522821[_0x7cd164(0x259,0x22b,0x229,0x1eb)](_0x5467c6['SzSkL'](_0x3a32fb,-0x1*-0xe9+0x24eb+-0x25d3))[_0x2a32ae(0x429,0x3d0,0x3ce,0x3d0)]();if(_0x1d3d13)_0x4481c0[_0x1d3d13]=_0x5d17b3;}}return _0x4481c0;}function generateRequestId(){function _0x941852(_0x3dd6f7,_0x3d4dd9,_0x45c0c4,_0x2a90ac){return _0x3fab(_0x2a90ac- -0x3b4,_0x45c0c4);}function _0x85cbc1(_0x21fcb0,_0x930882,_0x26ca98,_0x4ac701){return _0x3fab(_0x930882- -0xa5,_0x4ac701);}const _0x5f2d72={'Ecixn':function(_0x53ab49,_0x1cce81){return _0x53ab49(_0x1cce81);},'SJPxR':function(_0x348c40,_0x33c177){return _0x348c40===_0x33c177;},'shmwz':_0x85cbc1(-0x3d,0xd,-0x6,-0x3f),'dtCPW':function(_0x3a4bbf,_0xdffead){return _0x3a4bbf+_0xdffead;}};if(crypto&&crypto[_0x941852(-0x23c,-0x279,-0x223,-0x27a)]){if(_0x5f2d72[_0x85cbc1(0x98,0x61,0x30,0x45)](_0x5f2d72[_0x941852(-0x29f,-0x293,-0x2cf,-0x2cf)],_0x5f2d72[_0x85cbc1(0x1d,0x40,0x50,-0x6)]))return crypto[_0x941852(-0x2d2,-0x272,-0x25b,-0x27a)]();else{const _0x1e25d2=new _0x13e410(_0x5e95e5['error'][_0x941852(-0x263,-0x2d2,-0x247,-0x298)]);_0x1e25d2[_0x85cbc1(0x92,0x6d,0x52,0x12)]=_0x941852(-0x2c2,-0x2ca,-0x321,-0x313),_0x5f2d72['Ecixn'](_0xd90d65,_0x1e25d2);}}return _0x5f2d72[_0x85cbc1(0x48,0x30,0x81,0x67)](Date[_0x85cbc1(-0x39,0x1f,0x2d,0x22)]()[_0x941852(-0x299,-0x28b,-0x25e,-0x29c)](0x1a00+0x2453+-0x3e2f),Math['random']()[_0x85cbc1(0x67,0x73,0x26,0xc0)](-0x1*0x2627+-0x1d43+0x2*0x21c7)[_0x941852(-0x317,-0x2c9,-0x300,-0x2dc)](-0x18c0+0x2*0x10e8+-0x90e));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x3d921d(_0x5df8c5,_0x4b95ba,_0x18e449,_0x30bbd6){return _0x3fab(_0x18e449- -0xd1,_0x30bbd6);}const _0x530a84={'lnQTd':function(_0x5adb3d,_0x3c1ab6){return _0x5adb3d!==_0x3c1ab6;},'AuTQc':function(_0x47b973,_0x545109){return _0x47b973(_0x545109);},'SKolr':_0x3d921d(-0x15,-0x3a,0x11,0x6b),'fbDfr':'获取翻译提示词超时'};return new Promise((_0x25186d,_0x323f1d)=>{const _0xc4aa7=generateRequestId();console[_0x359d04(0x136,0x18d,0x17a,0x19e)](_0x359d04(0x229,0x20a,0x25c,0x253)+_0x359d04(0x1b3,0x16a,0x10f,0x10c)+_0x359d04(0x1fd,0x206,0x221,0x1fa)+_0xc4aa7+')');const _0x5e87e5=_0x227698=>{if(_0x530a84[_0x172ffc(-0x8c,-0x5f,-0xba,-0xbb)](_0x227698['id'],_0xc4aa7))return;eventSource[_0x172ffc(-0xd9,-0x8a,-0xe4,-0xdc)+'ener'](eventNames[_0x15080f(0x35b,0x326,0x34a,0x381)+_0x15080f(0x360,0x3ac,0x36c,0x325)+_0x15080f(0x34f,0x351,0x329,0x353)+_0x172ffc(-0x6a,-0xbc,-0x104,-0xb2)],_0x5e87e5);const {prompt:_0x254b53}=_0x227698;console[_0x172ffc(-0x15c,-0xb0,-0x11c,-0x103)]('st-chatu8:'+_0x15080f(0x347,0x333,0x33c,0x38f)+_0x172ffc(-0xed,-0xf4,-0x172,-0x122)+_0xc4aa7+'):',_0x254b53);function _0x172ffc(_0x1de1de,_0x6ac942,_0x89bd69,_0xd425a8){return _0x5091e9(_0x1de1de,_0xd425a8- -0x3b8,_0x89bd69-0x6d,_0xd425a8-0x1b3);}function _0x15080f(_0x4ea7dc,_0x5b5ddc,_0x5603d1,_0x4e9135){return _0x359d04(_0x4ea7dc-0x104,_0x4ea7dc-0x17c,_0x5b5ddc,_0x4e9135-0xb8);}_0x530a84[_0x172ffc(-0xb5,-0xad,-0xbd,-0xf3)](_0x25186d,_0x254b53);};eventSource['on'](eventNames[_0x359d04(0x1e4,0x1df,0x1c5,0x1d9)+_0x359d04(0x18c,0x1e4,0x217,0x1c9)+_0x5091e9(0x2b7,0x2fb,0x2c1,0x31e)+_0x359d04(0x182,0x1de,0x1db,0x20a)],_0x5e87e5);const _0x541d2e={};_0x541d2e['id']=_0xc4aa7;function _0x5091e9(_0x27fe2d,_0x487877,_0x3500cf,_0x10a99f){return _0x3d921d(_0x27fe2d-0x6d,_0x487877-0x143,_0x487877-0x2b9,_0x27fe2d);}function _0x359d04(_0x21adb3,_0x47a3ae,_0x4415de,_0x51e2e8){return _0x3d921d(_0x21adb3-0x133,_0x47a3ae-0xf0,_0x47a3ae-0x191,_0x4415de);}eventSource[_0x5091e9(0x2cd,0x2b0,0x271,0x302)](eventNames[_0x359d04(0x20d,0x1df,0x1aa,0x1ec)+_0x359d04(0x1e4,0x1e4,0x199,0x199)+'PROMPT_REQ'+'UEST'],_0x541d2e),setTimeout(()=>{function _0xfcb413(_0x4797c7,_0x139ead,_0x2b3449,_0x6fd0a2){return _0x5091e9(_0x2b3449,_0x4797c7- -0x3c,_0x2b3449-0x1c3,_0x6fd0a2-0xc8);}function _0x2f4e7c(_0x42ee22,_0x4c8a48,_0x483042,_0xe57ec0){return _0x359d04(_0x42ee22-0x1c9,_0xe57ec0-0x17c,_0x4c8a48,_0xe57ec0-0x166);}if(_0x530a84[_0xfcb413(0x248,0x22d,0x291,0x21b)]===_0x530a84['SKolr'])eventSource[_0x2f4e7c(0x382,0x311,0x2f4,0x330)+_0xfcb413(0x298,0x259,0x265,0x262)](eventNames[_0x2f4e7c(0x3b3,0x3ae,0x390,0x35b)+_0x2f4e7c(0x32c,0x37f,0x357,0x360)+_0xfcb413(0x2bf,0x299,0x2d3,0x309)+'PONSE'],_0x5e87e5),_0x530a84[_0x2f4e7c(0x36b,0x2d8,0x304,0x319)](_0x323f1d,new Error(_0x530a84['fbDfr']));else return'';},-0x3095*-0x1+-0x2478+0x1af3);});}export function LLM_TRANSLATION(_0x14d628,{timeoutMs:timeoutMs=0xb43+-0x1cba0+0x2aabd}={}){function _0x4d5b0c(_0x953c85,_0x4dea8f,_0x4d0b8c,_0x4b2875){return _0x3fab(_0x4b2875-0x49,_0x953c85);}const _0x5b3a7d={'LAiZa':_0x4d5b0c(0x185,0x168,0x16e,0x149),'ZSDAj':function(_0x5b2e05,_0x1c0161){return _0x5b2e05(_0x1c0161);},'wTtMQ':function(_0x20ecb9,_0x6f1588){return _0x20ecb9!==_0x6f1588;},'vmavw':_0x4bd732(0x172,0x1a2,0x15a,0x162),'Cuzto':_0x4bd732(0x119,0x121,0xf9,0x102),'jwOXR':function(_0x4cc89b){return _0x4cc89b();},'ECegY':_0x4d5b0c(0xf8,0x8e,0x11c,0xea),'IfUmZ':_0x4d5b0c(0x13d,0x14f,0x13d,0x14e),'JWxLJ':function(_0x348f5e,_0x40c999,_0x2069b7){return _0x348f5e(_0x40c999,_0x2069b7);}};function _0x4bd732(_0x32f135,_0x4ea6f7,_0x2a54d7,_0x3ecb32){return _0x3fab(_0x32f135-0x5b,_0x2a54d7);}return new Promise((_0x4aaa38,_0x608346)=>{const _0x52055c={'kTOHS':function(_0x530df0,_0x1d014d){return _0x530df0===_0x1d014d;},'loNuf':_0x5b3a7d[_0x3e2d0f(0x1ff,0x17f,0x1dd,0x233)],'xlFKw':_0x11e754(0x425,0x44b,0x46c,0x46a),'NaErF':function(_0x391d49,_0x5b9c68){function _0x3b394c(_0x3366c5,_0x2f68fd,_0x36df1d,_0x2c4c7c){return _0x3e2d0f(_0x3366c5-0x14,_0x2f68fd-0x5f,_0x3366c5- -0x23c,_0x2f68fd);}return _0x5b3a7d[_0x3b394c(-0x94,-0x8b,-0xbc,-0x8b)](_0x391d49,_0x5b9c68);},'BNGeO':function(_0x4867e6,_0x1a17a6){return _0x5b3a7d['wTtMQ'](_0x4867e6,_0x1a17a6);},'rgqja':_0x5b3a7d['vmavw'],'cbWvL':_0x5b3a7d['Cuzto'],'jmVpo':function(_0xcec28){function _0x1932ae(_0x12c3d0,_0x569fed,_0x591958,_0xcc4709){return _0x3e2d0f(_0x12c3d0-0x173,_0x569fed-0x1c1,_0x569fed-0x291,_0xcc4709);}return _0x5b3a7d[_0x1932ae(0x3ef,0x449,0x3f5,0x464)](_0xcec28);},'NjNDh':_0x5b3a7d[_0x3e2d0f(0x20b,0x250,0x201,0x22d)],'hxzFx':_0x3e2d0f(0x1f0,0x238,0x214,0x23f),'NeeLs':_0x5b3a7d[_0x3e2d0f(0x1e4,0x1e7,0x194,0x17d)]},_0x908605=_0x5b3a7d[_0x3e2d0f(0x1aa,0x1eb,0x1b8,0x20c)](generateRequestId);console[_0x11e754(0x39f,0x3ca,0x361,0x3b8)](_0x3e2d0f(0x275,0x24c,0x22b,0x22a)+_0x11e754(0x3e0,0x3d1,0x419,0x41c)+_0x11e754(0x380,0x3a7,0x359,0x3b3)+_0x908605+')');let _0x1c1845=null;const _0x1c242e=()=>{function _0x4883e3(_0x30c17c,_0x1bfdad,_0x251ec1,_0x3816e2){return _0x3e2d0f(_0x30c17c-0x54,_0x1bfdad-0x163,_0x3816e2- -0x48c,_0x251ec1);}function _0x1d22d1(_0x2bffe3,_0x153021,_0x3a64a9,_0x4e5e83){return _0x11e754(_0x4e5e83-0x89,_0x153021-0x3c,_0x2bffe3,_0x4e5e83-0x7b);}if(_0x52055c[_0x1d22d1(0x46b,0x467,0x4cc,0x490)]!==_0x52055c[_0x1d22d1(0x3e4,0x431,0x3af,0x402)]){eventSource['removeList'+_0x4883e3(-0x29a,-0x28d,-0x2a7,-0x2bf)](eventNames['LLM_TRANSL'+_0x1d22d1(0x4bf,0x4b3,0x4a4,0x475)+'ONSE'],_0x243678);if(_0x1c1845)_0x52055c[_0x1d22d1(0x4b9,0x43e,0x43e,0x478)](clearTimeout,_0x1c1845);}else{const _0x2c4365=_0x186255[_0x3e2686];if(_0x52055c[_0x1d22d1(0x3d0,0x3a5,0x3c0,0x3fe)](_0x2c4365,'$'))_0x546dc9=!_0x2a89dc,_0x486b52+=_0x2c4365;else{if((_0x52055c[_0x1d22d1(0x441,0x3bd,0x425,0x3fe)](_0x2c4365,',')||_0x2c4365==='，')&&!_0x2fd204){const _0x114dde=_0x11a81b[_0x1d22d1(0x3e8,0x44f,0x444,0x414)]();if(_0x114dde)_0x460c71['push'](_0x114dde);_0x5af3db='';}else _0x4fc62a+=_0x2c4365;}}};function _0x3e2d0f(_0x303c4b,_0xb6aba0,_0x5eb3b5,_0x4a5b19){return _0x4d5b0c(_0x4a5b19,_0xb6aba0-0x84,_0x5eb3b5-0xd0,_0x5eb3b5-0x98);}const _0x243678=_0x3b1c75=>{function _0x338af9(_0x4023d6,_0x4b36b0,_0x3da693,_0x492f67){return _0x3e2d0f(_0x4023d6-0x32,_0x4b36b0-0xb6,_0x3da693- -0x116,_0x4b36b0);}function _0x3db169(_0x14d0a3,_0x4ca0a4,_0x3fbecb,_0x3d855e){return _0x3e2d0f(_0x14d0a3-0x45,_0x4ca0a4-0x2e,_0x4ca0a4-0xf8,_0x3fbecb);}if(_0x52055c[_0x338af9(0x155,0x150,0xfb,0xcc)](_0x52055c['rgqja'],_0x52055c[_0x338af9(0x6b,0x53,0xa1,0xdd)])){if(_0x52055c['BNGeO'](_0x3b1c75['id'],_0x908605))return;_0x52055c[_0x338af9(0x6f,0x89,0xc6,0xbb)](_0x1c242e),console[_0x338af9(0xeb,0xdb,0x98,0xe5)](_0x338af9(0x15a,0x105,0x115,0xf2)+_0x3db169(0x329,0x311,0x2c1,0x342)+_0x3db169(0x2ad,0x28d,0x24d,0x242)+'\x20'+_0x908605+'):',_0x3b1c75);if(_0x3b1c75[_0x3db169(0x232,0x28f,0x28c,0x2ad)])_0x52055c[_0x338af9(0x8e,0xec,0xe8,0xe7)](_0x4aaa38,_0x3b1c75[_0x338af9(0x151,0x14f,0x10a,0x12c)]);else{if(_0x3b1c75[_0x338af9(0xc3,0xdc,0xa7,0xbe)]&&_0x3b1c75[_0x338af9(0xd1,0x6b,0xa7,0xb6)][_0x338af9(0x102,0x12f,0xdd,0x12a)]===_0x52055c[_0x338af9(0xe2,0x9b,0x99,0x65)]){if(_0x52055c['kTOHS'](_0x52055c[_0x338af9(0xc9,0xfb,0x10b,0x135)],_0x52055c[_0x338af9(0xe4,0x8a,0xbc,0xa8)]))return _0x4724fa[_0x338af9(0xdc,0xc8,0x105,0xbf)]();else{const _0x5a5c45=new Error(_0x3b1c75['error'][_0x338af9(0x118,0x125,0xe7,0x112)]);_0x5a5c45[_0x338af9(0x139,0xc5,0xdd,0x8d)]=_0x52055c[_0x338af9(0x65,0xe8,0x99,0xf4)],_0x52055c['NaErF'](_0x608346,_0x5a5c45);}}else _0x52055c[_0x3db169(0x2ad,0x2f6,0x322,0x297)](_0x608346,new Error(_0x3b1c75[_0x338af9(0xf0,0x140,0x10a,0x10d)]));}}else{const {original:_0x1ff2a0,cleaned:_0x5750a1,skip:_0x25d62e}=_0x1052eb;if(_0x25d62e){const _0x1c2927={};return _0x1c2927['original']=_0x1ff2a0,_0x1c2927[_0x338af9(0xf2,0xeb,0xa4,0x56)+'n']='',_0x1c2927[_0x3db169(0x2ff,0x301,0x341,0x342)]=_0x5750a1,_0x1c2927[_0x338af9(0xab,0xc3,0xc2,0x6a)]=!![],_0x1c2927;}const _0x7fc64=_0x5b0a5e[_0x5750a1[_0x338af9(0x13e,0xfc,0x104,0xf6)+'e']()]||'',_0x5a6183={};return _0x5a6183[_0x3db169(0x215,0x274,0x28c,0x228)]=_0x1ff2a0,_0x5a6183['translatio'+'n']=_0x7fc64,_0x5a6183[_0x3db169(0x333,0x301,0x2ee,0x2ab)]=_0x5750a1,_0x5a6183[_0x3db169(0x2f0,0x2d0,0x32d,0x2e1)]=![],_0x5a6183;}};function _0x11e754(_0x2c9665,_0x2ca67c,_0x55ab1f,_0x48b536){return _0x4bd732(_0x2c9665-0x277,_0x2ca67c-0xe1,_0x55ab1f,_0x48b536-0xcc);}eventSource['on'](eventNames[_0x11e754(0x3f1,0x3d8,0x3f9,0x431)+'ATION_RESP'+'ONSE'],_0x243678);const _0x3b6cde={};_0x3b6cde['prompt']=_0x14d628,_0x3b6cde['id']=_0x908605,eventSource['emit'](eventNames[_0x11e754(0x3f1,0x414,0x416,0x446)+_0x3e2d0f(0x24e,0x265,0x222,0x21a)+_0x3e2d0f(0x1f0,0x18f,0x1c8,0x19c)],_0x3b6cde),_0x1c1845=_0x5b3a7d[_0x11e754(0x3bb,0x3fc,0x3d7,0x3de)](setTimeout,()=>{function _0x38fcea(_0x24d933,_0x512b78,_0x3e641d,_0x2f382e){return _0x3e2d0f(_0x24d933-0xbf,_0x512b78-0x84,_0x2f382e-0x19e,_0x3e641d);}_0x1c242e();function _0x8f88d2(_0x8349a8,_0x1ccf5a,_0x434978,_0xbf786){return _0x11e754(_0x434978-0x23,_0x1ccf5a-0xde,_0x8349a8,_0xbf786-0x1cb);}_0x52055c[_0x8f88d2(0x458,0x43a,0x412,0x3e3)](_0x608346,new Error(_0x8f88d2(0x3b6,0x409,0x3e2,0x3ed)+'时（'+timeoutMs+_0x8f88d2(0x425,0x453,0x42c,0x472)));},timeoutMs);});}export async function callTranslation(_0x1bbbeb){function _0x586ba8(_0x43edd5,_0x4fd4ce,_0x432498,_0x187b79){return _0x3fab(_0x432498- -0x1dc,_0x187b79);}const _0x23aad9={'WxGEL':function(_0x17885e,_0x585fd1){return _0x17885e(_0x585fd1);},'RbDEq':function(_0x482a67,_0x4969c2){return _0x482a67!==_0x4969c2;},'uYHjw':_0x52bd21(-0x117,-0x114,-0xf2,-0x12d),'rqTcx':_0x586ba8(-0x12e,-0x95,-0xe4,-0x8a),'RFdZp':function(_0x1a1e9b,_0x291baa,_0x267515){return _0x1a1e9b(_0x291baa,_0x267515);},'DmNSK':_0x586ba8(-0xec,-0x136,-0x103,-0xec)+'n','RspwO':function(_0x3d299f,_0x1b689d){return _0x3d299f||_0x1b689d;},'NqXMk':_0x52bd21(-0x1e4,-0x1b2,-0x1d7,-0x1e2),'rQiRp':function(_0xc995b9,_0x4151b3){return _0xc995b9||_0x4151b3;},'KDUwa':function(_0x4423f1,_0x1b5399){return _0x4423f1(_0x1b5399);},'WOlPw':function(_0x276480,_0x288429){return _0x276480(_0x288429);},'awUuT':_0x586ba8(-0xed,-0x145,-0x143,-0x107)};function _0x52bd21(_0x3624f4,_0x2ccb8a,_0x49e3aa,_0x20b40f){return _0x3fab(_0x2ccb8a- -0x251,_0x20b40f);}try{if(_0x23aad9[_0x52bd21(-0x180,-0x153,-0x134,-0x16b)](_0x23aad9[_0x52bd21(-0x167,-0x1a2,-0x166,-0x1d5)],_0x23aad9['rqTcx'])){let _0x31f330=_0x23aad9[_0x586ba8(-0xfd,-0xc4,-0x10a,-0x158)](buildPromptForRequestType,_0x23aad9['DmNSK'],_0x23aad9[_0x586ba8(-0xbd,-0x94,-0xd0,-0x102)](_0x1bbbeb,''));_0x31f330=mergeAdjacentMessages(_0x31f330);const _0x44df38=[..._0x31f330,{'role':_0x23aad9[_0x52bd21(-0x100,-0x12f,-0x16e,-0x156)],'content':_0x23aad9[_0x52bd21(-0x1ac,-0x15f,-0x156,-0x18c)](_0x1bbbeb,'')}];_0x23aad9[_0x52bd21(-0x183,-0x149,-0x1a1,-0x16c)](updateCombinedPrompt,_0x44df38);const _0x3f071b=await _0x23aad9[_0x586ba8(-0x10b,-0x10e,-0x12f,-0x12e)](LLM_TRANSLATION,_0x44df38);return _0x3f071b;}else{_0x1fac1e[_0x586ba8(-0xc9,-0x8a,-0xe8,-0xd1)+'ener'](_0x5022f9[_0x52bd21(-0x12d,-0x132,-0x14d,-0x11b)+_0x52bd21(-0xe8,-0x137,-0x184,-0xec)+_0x586ba8(-0xb0,-0xe0,-0xae,-0x5e)],_0x5b46b2);if(_0x25dfcb)_0x23aad9[_0x52bd21(-0x10b,-0x149,-0x13f,-0x128)](_0x287fba,_0x8b7143);}}catch(_0x2bb769){_0x23aad9['WOlPw'](addLog,_0x586ba8(-0x8d,-0x7c,-0xd8,-0x7f)+_0x2bb769['message']),console['error'](_0x23aad9[_0x586ba8(-0x85,-0x72,-0xc3,-0x83)],_0x2bb769);throw _0x2bb769;}}let isAiInitialized=![];export function initAiSettings(_0x212786){const _0x11af4d={};function _0x2067a9(_0x321daa,_0x10b589,_0x44bdae,_0x562dde){return _0x3fab(_0x562dde-0x52,_0x321daa);}function _0x5f3742(_0x5ba9a0,_0xb7065,_0xb345a5,_0x1b5f0d){return _0x3fab(_0xb7065-0x142,_0x5ba9a0);}_0x11af4d[_0x2067a9(0xce,0xfd,0x146,0x102)]=_0x5f3742(0x2a7,0x28c,0x246,0x285)+_0x2067a9(0x10c,0xfe,0x10c,0x11b)+'\x20LLM\x20设置页面';const _0xa58e7f=_0x11af4d;!isAiInitialized&&(console[_0x5f3742(0x1fa,0x20f,0x241,0x1cd)](_0xa58e7f[_0x2067a9(0xaf,0xcd,0xca,0x102)]),isAiInitialized=!![]);}
//# sourceMappingURL=http://localhost:8000/ai.js.map