(function(_0x5bb248,_0x141101){function _0x42e0e8(_0x3dd811,_0x46a16c,_0x2a20f7,_0x1f8387){return _0x21a4(_0x2a20f7-0x352,_0x46a16c);}function _0x1b8915(_0x2493d9,_0x1f301d,_0x46a495,_0x26ef39){return _0x21a4(_0x2493d9-0x176,_0x46a495);}const _0x1b4f34=_0x5bb248();while(!![]){try{const _0x40913d=parseInt(_0x42e0e8(0x452,0x4f1,0x49b,0x457))/(-0x4d0+0x1*-0xe53+0x1324)*(-parseInt(_0x1b8915(0x2e4,0x2e5,0x28d,0x307))/(0x1*0x26f6+-0x67*0x55+-0x4c1))+parseInt(_0x1b8915(0x288,0x2a7,0x280,0x254))/(-0x526*0x1+-0x42d*0x8+-0x449*-0x9)+parseInt(_0x1b8915(0x271,0x281,0x28e,0x26e))/(0x1*0x4bd+0x7*0xb3+-0x99e*0x1)+-parseInt(_0x42e0e8(0x497,0x474,0x44a,0x3fd))/(0x1b4a+0x1*-0x795+0x28*-0x7e)*(parseInt(_0x1b8915(0x2d4,0x311,0x2c9,0x2bd))/(0x1fe4+0x10e2*0x2+-0x41a2))+parseInt(_0x1b8915(0x2e5,0x2e1,0x2b9,0x2ee))/(0x1a18+-0x20f*-0xb+-0x30b6)*(-parseInt(_0x42e0e8(0x52c,0x4ff,0x4db,0x4f2))/(0x9e0+-0x2cd+-0x259*0x3))+-parseInt(_0x1b8915(0x2cb,0x305,0x2c0,0x2a9))/(0x4*-0x646+0xb2b+0xdf6*0x1)+parseInt(_0x42e0e8(0x497,0x471,0x4ac,0x498))/(-0x1*-0xde7+-0x2119+-0x4cf*-0x4);if(_0x40913d===_0x141101)break;else _0x1b4f34['push'](_0x1b4f34['shift']());}catch(_0x431acf){_0x1b4f34['push'](_0x1b4f34['shift']());}}}(_0x462f,-0x11db5+-0x5b1ed*-0x1+0x6164b));function _0x21a4(_0x447fd8,_0x360a34){_0x447fd8=_0x447fd8-(0x1493*0x1+-0x193f+-0x1*-0x59f);const _0x53400c=_0x462f();let _0x1f9415=_0x53400c[_0x447fd8];if(_0x21a4['wLENwG']===undefined){var _0x14cea3=function(_0x20a967){const _0x119bfd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ae8ea='',_0x3723b0='',_0x5f5150=_0x1ae8ea+_0x14cea3;for(let _0x4ea1b2=0x3d*-0x13+0x1950+-0x14c9,_0x43ff80,_0x3d7bdf,_0x481bcd=-0x24a5+-0x24ad+0x4952;_0x3d7bdf=_0x20a967['charAt'](_0x481bcd++);~_0x3d7bdf&&(_0x43ff80=_0x4ea1b2%(-0x11bf+0xa63*0x3+-0xd66)?_0x43ff80*(0x1*0xd85+-0x3f1*-0x9+-0x30be)+_0x3d7bdf:_0x3d7bdf,_0x4ea1b2++%(0x8d5+0x1*-0xe01+-0x298*-0x2))?_0x1ae8ea+=_0x5f5150['charCodeAt'](_0x481bcd+(-0x1b39+-0x300*0x6+-0x2d43*-0x1))-(0x1*0x11e7+-0x6e2*-0x4+-0x2d65)!==-0x21be+0x77*-0x2b+0x35bb?String['fromCharCode'](0x3de+-0x20f0+0x1e11&_0x43ff80>>(-(0xcd*-0x11+-0x44*-0x5e+0x19f*-0x7)*_0x4ea1b2&-0x1dff+-0x165a+-0x7b*-0x6d)):_0x4ea1b2:0x31*-0x7f+0x70d+-0x2*-0x8a1){_0x3d7bdf=_0x119bfd['indexOf'](_0x3d7bdf);}for(let _0x2fad73=0x24a+0xc3*0x3+0x1*-0x493,_0x498a87=_0x1ae8ea['length'];_0x2fad73<_0x498a87;_0x2fad73++){_0x3723b0+='%'+('00'+_0x1ae8ea['charCodeAt'](_0x2fad73)['toString'](0x1336*-0x1+-0x1342+0x2688))['slice'](-(-0x55*-0x17+-0x1be*0xb+0xb89));}return decodeURIComponent(_0x3723b0);};_0x21a4['Kxpfpm']=_0x14cea3,_0x21a4['QqyQUK']={},_0x21a4['wLENwG']=!![];}const _0x32ede0=_0x53400c[-0x1*-0x4c2+-0x5*0x2d9+0x97b],_0xf7912e=_0x447fd8+_0x32ede0,_0x4f56cc=_0x21a4['QqyQUK'][_0xf7912e];if(!_0x4f56cc){const _0x4e3181=function(_0x3c381c){this['nEmPYp']=_0x3c381c,this['igFeDG']=[-0xace*-0x1+-0xcef+0x222,0xe3*-0x3+0x1*-0x1fac+0x31f*0xb,-0x2fb+-0x224f*0x1+0x254a],this['YlnePn']=function(){return'newState';},this['QuShhI']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['eUikkK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4e3181['prototype']['DaonQH']=function(){const _0x3aad19=new RegExp(this['QuShhI']+this['eUikkK']),_0x4a1978=_0x3aad19['test'](this['YlnePn']['toString']())?--this['igFeDG'][-0x16a9+0x4*0x39b+0xd3*0xa]:--this['igFeDG'][-0x3*-0xa4a+0xbf*0x19+-0x3185];return this['MAqsYg'](_0x4a1978);},_0x4e3181['prototype']['MAqsYg']=function(_0xfd12a1){if(!Boolean(~_0xfd12a1))return _0xfd12a1;return this['jeunMI'](this['nEmPYp']);},_0x4e3181['prototype']['jeunMI']=function(_0x424809){for(let _0x4e2438=-0x3*-0x7b5+-0x1*-0x1b65+-0x1942*0x2,_0x570ba6=this['igFeDG']['length'];_0x4e2438<_0x570ba6;_0x4e2438++){this['igFeDG']['push'](Math['round'](Math['random']())),_0x570ba6=this['igFeDG']['length'];}return _0x424809(this['igFeDG'][-0x515+-0x1d7e+0x35*0xa7]);},new _0x4e3181(_0x21a4)['DaonQH'](),_0x1f9415=_0x21a4['Kxpfpm'](_0x1f9415),_0x21a4['QqyQUK'][_0xf7912e]=_0x1f9415;}else _0x1f9415=_0x4f56cc;return _0x1f9415;}const _0x1c0318=(function(){let _0x76c582=!![];return function(_0x1a81ca,_0xd7c851){const _0x9615fa=_0x76c582?function(){if(_0xd7c851){const _0xe07f3=_0xd7c851['apply'](_0x1a81ca,arguments);return _0xd7c851=null,_0xe07f3;}}:function(){};return _0x76c582=![],_0x9615fa;};}()),_0x581892=_0x1c0318(this,function(){const _0x3a228b={};_0x3a228b['puLYk']=_0x102f22(0x1db,0x192,0x1bc,0x1f5)+'+$';function _0x1b7876(_0x37bf94,_0x4ea437,_0x2cc90e,_0x97694e){return _0x21a4(_0x37bf94- -0x6c,_0x97694e);}function _0x102f22(_0x5a5c80,_0x58a612,_0xec1ebc,_0x5ba090){return _0x21a4(_0x5a5c80-0x49,_0x58a612);}const _0x456b94=_0x3a228b;return _0x581892[_0x1b7876(0xd1,0xc3,0xc1,0x7b)]()[_0x102f22(0x1e6,0x1ed,0x1d1,0x20d)](_0x456b94['puLYk'])[_0x1b7876(0xd1,0xe5,0xf3,0xb6)]()[_0x1b7876(0xfb,0x12c,0xba,0x144)+'r'](_0x581892)[_0x102f22(0x1e6,0x1ab,0x1b0,0x1a0)]('(((.+)+)+)'+'+$');});_0x581892();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x5238c6){function _0x3e51df(_0x10f2cd,_0x1f1b08,_0xd2ce47,_0x452466){return _0x21a4(_0x10f2cd-0x12c,_0xd2ce47);}function _0x4654ca(_0x3a6516,_0x1b36e1,_0x28f9a5,_0x1b3921){return _0x21a4(_0x28f9a5- -0x263,_0x3a6516);}return SKIP_PATTERNS[_0x4654ca(-0x121,-0x177,-0x137,-0x170)](_0x2fbc3d=>_0x2fbc3d['test'](_0x5238c6[_0x3e51df(0x27c,0x24f,0x230,0x2c9)]()));}function _0x462f(){const _0x28326a=['6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','ug9QuM8','zgLZCgXHEvrLEa','DxnLCG','vMjus1O','B1v6u3m','Dg9tDhjPBMC','B0vyufG','DKTNsKS','iefjioIUVUE9RUw3SUE7N+s4GowiSa','vuvtva','uujMu28','C2v0','y3bUrvG','57+76k+r5AsX6lsLoG','v3DnA0G','rg1cs0G','ChjVBxb0','mtjvBvPKru4','DNjRBKG','keLeoIa','Eg16qLa','ALfKywy','zwPpEvC','EuPNrgG','DhjPBq','Aw5KzxHpzG','u2rzEgq','ExLZBKK','C3vJy2vZCW','mZK4mta5nKnZwxb0AG','rK9fuwS','Bg9N','vevLvfq','EKf3A0G','mJm0ntq5otbhugvyuwi','tfPrzMe','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','BwvZC2fNzq','mtm1mdu0AKP6vNz0','BMfTzq','CMHLrKu','C3rYAw5N','t0DZz1i','tvHVBKe','CMfUzg9T','rfDxAKu','ufjptvbux1jfuq','y29UC3rYDwn0BW','qwDtENi','AM9PBG','vKrlEfO','icHjrdOG','q3r3AKK','D2fYBG','mtu3mJr1t2fzrgK','mJffC2DIDwW','C2XPy2u','qvrjt05FuKvrvq','B3bTqNe','BNbNvK0','EKP3C1K','CgHwyvq','qvrjt05FuKvtua','CgfYC2u','Bwf0y2G','rMD2Ae0','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','ufjptvbux1jfuW','rvnu','tKfSyxe','BM93','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','wMHSEK8','C3rYAw5NAwz5','q2rlzgS','zw1PDa','s1jlt0e','q1vorNa','Ae1Vr3i','vvHAB0S','zMvdt08','mZe5mJG0ogfKrertCW','y2XLyw5Lza','swPxvfu','C2TPChbLza','weXjD3K','BwfW','yvvJzKu','ue9ou0u','B2jQzwn0','kcGOlISPkYKRkq','EwnfAwq','uLPqq00','B3jPz2LUywW','sgjnCue','BxpVViK','t05trq','u2Dtt2u','EM5hBuC','AxnbCNjHEq','teXnx1rsqu5tta','C2vHCMnO','u0j1zxq','tuveCLa','zM51r1y','CMvWBgfJzq','zxjYB3i','t3HRCKS','DgHdBxm','AKTxywO','rw5bCeO','mte1BuXNyxjf','D1jvEKK','v1DnzeS','odCYnJbyvw9ksNC','qMPxEum','DhjHBNnSyxrPBW','C3vIC3rYAw5N','swP5BgC','57+76k+rieXmtsdMIAFOOyZOTOu','whbev3q','uxbdwwi','CMvZDwX0','ieXmtsdORR7NVA7POBxPNAi','rhbKq0e','DgvZDa','uhnxseq','CKXfDfi','iePtt07OP6pMNPdLPlhOTkxVViW','thjvrxm','yxbWBhK','C2LdBxy','CMvZDwX0CW','CMfUzg9Tvvvjra','zhnzyuu','yKfLC0K','wePzt2y','mtC1mdiZmenQyujZvG','uLnhqLG','BgvUz3rO','CM9Szq','CMvTB3zLtgLZDa','AKLdzfG','q3zwtgu','uxDUDg4','r3vPALa','zvbYDLe','57+76k+r5AsX6lsLoIa','zhLsq0C','zMLSDgvY','q2rdrMq','qvrjt05Fr0vuxW','B3jPz2LUywXuyq','AM5mqKu','BxDbt0K','DwL6re4','BwnXu0G','uxDKtu4','qwjVCNrfCNjVCG','ChvZAa','y29UDgvUDa','vLjPufO','zMfXt3m','C29Tzq','AwjSv1u','EefAuem','B3jprgC','C3qTy2HHDhu4oG','C3bSAxq','Dg9mB3DLCKnHCW','s1bSvKO','zw5LCG','ioAjP+IHJoE7K+AENcaOsuq6','ru9Zzgy'];_0x462f=function(){return _0x28326a;};return _0x462f();}export function tagsToJsonString(_0x3cf1b1){function _0x3aabcc(_0x2d32c6,_0x436a0d,_0xcd5ba4,_0x5d9a33){return _0x21a4(_0x436a0d-0x19c,_0x5d9a33);}if(!Array[_0x134333(-0xbc,-0xf4,-0xdf,-0xd0)](_0x3cf1b1))return'[]';function _0x134333(_0x4640a2,_0x11d7b4,_0x3ad00b,_0x48420b){return _0x21a4(_0x3ad00b- -0x27a,_0x4640a2);}return JSON[_0x134333(-0x11c,-0x10e,-0xf9,-0xee)](_0x3cf1b1[_0x134333(-0x182,-0x113,-0x15c,-0x151)](_0x149a37=>_0x149a37&&typeof _0x149a37===_0x3aabcc(0x2eb,0x2fd,0x2f9,0x2c8)));}export function preprocessPromptForTranslation(_0x3f7be1){function _0x389979(_0x58b3d3,_0x5c4914,_0x2b39da,_0x5cc55c){return _0x21a4(_0x5c4914- -0x277,_0x5cc55c);}const _0x3f8d6c={'YLKtr':function(_0x5e52ee,_0x21c01a){return _0x5e52ee(_0x21c01a);},'Ijylg':function(_0x44d7b4,_0x3367ff){return _0x44d7b4===_0x3367ff;},'HbMqA':_0x75d269(0x2b9,0x28d,0x2c3,0x27e),'yysnI':function(_0x3eafb9,_0x272c77){return _0x3eafb9!==_0x272c77;},'bAesI':function(_0x12d13b,_0x5f5b9a){return _0x12d13b<_0x5f5b9a;},'CUNFp':function(_0x253e2f,_0x265179){return _0x253e2f===_0x265179;},'DmBKH':function(_0x495f4e,_0x252bea){return _0x495f4e!==_0x252bea;},'yJgDh':_0x389979(-0x197,-0x183,-0x1ab,-0x172),'iblWU':function(_0x1d8cd5,_0x31e739){return _0x1d8cd5(_0x31e739);},'gKtGw':function(_0x4efe04,_0x2a079c,_0x4526b1){return _0x4efe04(_0x2a079c,_0x4526b1);},'CvVLe':function(_0x23069f,_0x3d5e92){return _0x23069f!==_0x3d5e92;},'DiKeX':function(_0x28189b,_0x2d6300){return _0x28189b!==_0x2d6300;},'aUcfE':_0x75d269(0x209,0x1fb,0x241,0x217),'wRUzI':function(_0x118535,_0xf0cc53){return _0x118535(_0xf0cc53);},'FOEQk':_0x75d269(0x1de,0x1ff,0x1c5,0x1e7),'lZkQa':'GUZse','MXonA':_0x75d269(0x1bb,0x1b1,0x1b3,0x1ee),'IgMAK':_0x75d269(0x203,0x1f4,0x230,0x22b),'PsWHD':function(_0x92011f,_0x2bbbd9){return _0x92011f(_0x2bbbd9);}};if(!_0x3f7be1||_0x3f8d6c[_0x389979(-0x17c,-0x15f,-0x11e,-0x150)](typeof _0x3f7be1,'string')){if(_0x3f8d6c['DiKeX'](_0x3f8d6c[_0x389979(-0xc5,-0xe8,-0xc9,-0xcb)],_0x3f8d6c['aUcfE'])){_0x51b6c7[_0x389979(-0x17e,-0x161,-0x11a,-0x11a)+_0x75d269(0x26d,0x1e8,0x20b,0x221)](_0x3d4940['LLM_TRANSL'+_0x75d269(0x279,0x21e,0x253,0x263)+'ONSE'],_0x24699c);if(_0x16a152)_0x3f8d6c['YLKtr'](_0x3a952d,_0x586eaf);}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};}const _0x36d782=_0x4ab3d8=>{const _0x2e9f17={'CdCFd':function(_0x41786e,_0x584311){function _0xa8bcc4(_0x1afe46,_0x412ade,_0x2e8789,_0x2751c4){return _0x21a4(_0x2e8789-0x18f,_0x2751c4);}return _0x3f8d6c[_0xa8bcc4(0x256,0x2df,0x28e,0x288)](_0x41786e,_0x584311);},'zJwsY':_0x3f8d6c[_0x4ae953(-0x233,-0x255,-0x21c,-0x242)],'XLIwy':function(_0x1f8521,_0x2407cb){return _0x3f8d6c['yysnI'](_0x1f8521,_0x2407cb);}},_0x325290=[];let _0x1b9af6='';function _0x4ae953(_0x513c1f,_0x52e818,_0x52410b,_0x1b6b3d){return _0x75d269(_0x513c1f-0xe5,_0x52e818,_0x52410b-0xfb,_0x52410b- -0x49f);}let _0x8d2e63=![];function _0x29e60f(_0x532c4b,_0x5a838a,_0x52047f,_0x458308){return _0x389979(_0x532c4b-0xfb,_0x5a838a-0x5c8,_0x52047f-0x18c,_0x532c4b);}for(let _0x4233bd=-0x34a+-0x20f7+-0x1*-0x2441;_0x3f8d6c[_0x29e60f(0x45d,0x461,0x45c,0x4b0)](_0x4233bd,_0x4ab3d8[_0x4ae953(-0x296,-0x2d6,-0x29e,-0x25b)]);_0x4233bd++){const _0x25ce23=_0x4ab3d8[_0x4233bd];if(_0x3f8d6c[_0x4ae953(-0x2cd,-0x270,-0x2b3,-0x2b7)](_0x25ce23,'$'))_0x8d2e63=!_0x8d2e63,_0x1b9af6+=_0x25ce23;else{if((_0x3f8d6c[_0x29e60f(0x4f9,0x4d6,0x495,0x4d5)](_0x25ce23,',')||_0x25ce23==='，')&&!_0x8d2e63){const _0x5dbf72=_0x1b9af6[_0x4ae953(-0x295,-0x292,-0x262,-0x271)]();if(_0x5dbf72)_0x325290['push'](_0x5dbf72);_0x1b9af6='';}else{if(_0x3f8d6c[_0x4ae953(-0x228,-0x24d,-0x26b,-0x266)](_0x3f8d6c[_0x29e60f(0x44e,0x4a0,0x4dc,0x4cc)],_0x4ae953(-0x2f7,-0x277,-0x2aa,-0x278)))_0x1b9af6+=_0x25ce23;else{const _0x1a0c73=_0x33f023[_0x4ae953(-0x26b,-0x255,-0x23b,-0x20f)](_0x2e6d6e[0x1961+0x7d4+-0x2135]);if(_0x2e9f17[_0x4ae953(-0x2e9,-0x23c,-0x293,-0x24e)](typeof _0x1a0c73,_0x2e9f17[_0x29e60f(0x477,0x4c5,0x501,0x516)])&&_0x2e9f17[_0x4ae953(-0x227,-0x260,-0x225,-0x244)](_0x1a0c73,null))return _0x1a0c73;}}}}if(_0x1b9af6[_0x4ae953(-0x271,-0x2a2,-0x262,-0x24e)]())_0x325290[_0x29e60f(0x474,0x479,0x45f,0x450)](_0x1b9af6[_0x29e60f(0x4d5,0x4a1,0x4f7,0x454)]());return _0x325290;},_0x34ac99=_0x3f8d6c['wRUzI'](_0x36d782,_0x3f7be1),_0x58d833=[];function _0x75d269(_0x155188,_0x7943c0,_0x1af54b,_0x55095a){return _0x21a4(_0x55095a-0xed,_0x7943c0);}const _0x2435d6=[],_0x3b4d85=new Map();for(const _0x5cf989 of _0x34ac99){if(_0x3f8d6c[_0x75d269(0x232,0x217,0x23a,0x1ec)](_0x3f8d6c[_0x389979(-0xcc,-0x121,-0x15f,-0xf2)],_0x3f8d6c['lZkQa']))return _0x77d656['some'](_0x59622c=>_0x59622c[_0x75d269(0x1ba,0x249,0x228,0x1f3)](_0x2298d4[_0x75d269(0x20f,0x27b,0x25a,0x23d)]()));else{const _0x1abe50=_0x5cf989['match'](SD_SYMBOL_PATTERN);if(_0x1abe50){if(_0x3f8d6c[_0x75d269(0x20e,0x29a,0x20e,0x250)]!==_0x3f8d6c[_0x75d269(0x1ff,0x218,0x22a,0x250)]){const {original:_0x32546a,cleaned:_0x24cab6,skip:_0xb27393}=_0xb511d7;if(_0xb27393){const _0xdbc127={};return _0xdbc127['original']=_0x32546a,_0xdbc127['translatio'+'n']='',_0xdbc127['cleaned']=_0x24cab6,_0xdbc127['skipped']=!![],_0xdbc127;}const _0x33011e=_0x1d4d5e[_0x24cab6[_0x389979(-0x110,-0x145,-0x160,-0x16c)+'e']()]||'',_0x1a526b={};return _0x1a526b[_0x75d269(0x2bf,0x290,0x294,0x282)]=_0x32546a,_0x1a526b[_0x389979(-0x144,-0x17a,-0x136,-0x149)+'n']=_0x33011e,_0x1a526b[_0x389979(-0xb4,-0xed,-0x103,-0xb4)]=_0x24cab6,_0x1a526b['skipped']=![],_0x1a526b;}else{const _0x6629a7=_0x1abe50[0x5*-0x3e+-0x34d+0x484]||'',_0xdce2a7=(_0x1abe50[0xe*0x1da+0xa37+-0x2421]||'')['trim'](),_0x1c329a=_0x1abe50[-0x1f35+-0x9f7*-0x1+0x1541]||'',_0xf2938f=_0x1abe50[-0x265f+-0x23ed+0x4a50]||'',_0xb5ddbb={'original':_0x5cf989,'cleaned':_0xdce2a7,'prefix':_0x6629a7,'suffix':_0x1c329a,'weight':_0xf2938f,'skip':_0x3f8d6c[_0x389979(-0x13c,-0x17e,-0x1a8,-0x1aa)](shouldSkipTranslation,_0x5cf989)||_0x3f8d6c[_0x75d269(0x220,0x228,0x205,0x21a)](shouldSkipTranslation,_0xdce2a7)};_0x58d833[_0x389979(-0x165,-0x14f,-0x196,-0x196)](_0xb5ddbb);if(!_0xb5ddbb['skip']&&_0xdce2a7){if('RSGBX'===_0x75d269(0x24a,0x249,0x1e1,0x200))_0x2435d6[_0x75d269(0x21e,0x200,0x1e6,0x215)](_0xdce2a7),_0x3b4d85[_0x389979(-0x144,-0x134,-0x188,-0x14d)](_0xdce2a7['toLowerCas'+'e'](),_0xb5ddbb);else{const _0x11e4b6=_0x55b80f?function(){function _0x43e507(_0x5d55c1,_0x2a298e,_0x3f953e,_0x265ce5){return _0x389979(_0x5d55c1-0x75,_0x3f953e-0x5df,_0x3f953e-0x2a,_0x5d55c1);}if(_0x5afb97){const _0x94d034=_0x120bd1[_0x43e507(0x433,0x477,0x473,0x426)](_0x11657c,arguments);return _0x3a7772=null,_0x94d034;}}:function(){};return _0x402fe9=![],_0x11e4b6;}}}}else{const _0x59597a={'original':_0x5cf989,'cleaned':_0x5cf989,'prefix':'','suffix':'','weight':'','skip':shouldSkipTranslation(_0x5cf989)};_0x58d833[_0x75d269(0x1f1,0x209,0x1f5,0x215)](_0x59597a);if(!_0x59597a['skip']&&_0x5cf989){if(_0x3f8d6c[_0x389979(-0x101,-0x124,-0x151,-0xce)](_0x3f8d6c['IgMAK'],_0x3f8d6c['IgMAK'])){const _0xe47dff={'RZPCM':function(_0x373915,_0x4f200e){function _0x9e9caa(_0x262c90,_0x7a228d,_0xc63c12,_0x336ace){return _0x389979(_0x262c90-0x31,_0x7a228d-0x32a,_0xc63c12-0xe6,_0x262c90);}return _0x3f8d6c[_0x9e9caa(0x203,0x1e0,0x1ff,0x1df)](_0x373915,_0x4f200e);},'mwAOI':function(_0x2fe2ec){return _0x2fe2ec();},'awROt':function(_0x305c54,_0x4a3361,_0x1b84c2){return _0x3f8d6c['gKtGw'](_0x305c54,_0x4a3361,_0x1b84c2);}};return new _0x54e416((_0x4f7e9a,_0x4a6057)=>{const _0x59bef0=_0xe47dff[_0x26f4c1(0x48b,0x4bc,0x492,0x46d)](_0x3f23d2);_0x596977[_0x3869ec(0x1a9,0x1ab,0x1d4,0x1a9)](_0x26f4c1(0x4a5,0x4c9,0x4b4,0x51d)+_0x26f4c1(0x4ed,0x518,0x4f6,0x512)+_0x3869ec(0x1bd,0x1c4,0x1e0,0x1b2)+_0x59bef0+')');function _0x3869ec(_0x212d21,_0x430cd9,_0x347b74,_0x3b79ea){return _0x389979(_0x212d21-0xdd,_0x212d21-0x2c9,_0x347b74-0x23,_0x430cd9);}const _0x163751=_0x33d8ae=>{if(_0x33d8ae['id']!==_0x59bef0)return;_0x1bc724[_0x58ff8c(0x172,0x1cc,0x1d2,0x1c9)+_0x58ff8c(0x22a,0x231,0x1fb,0x1e7)](_0x23f86b[_0x346399(0x145,0x16a,0x13c,0x172)+'ATION_GET_'+_0x346399(0x124,0x12a,0x16b,0x15c)+'PONSE'],_0x163751);function _0x58ff8c(_0x8b6dbb,_0x1b3a8c,_0x208049,_0x35e964){return _0x3869ec(_0x35e964-0x61,_0x208049,_0x208049-0x18c,_0x35e964-0x1e8);}function _0x346399(_0x1d94ff,_0x341f88,_0x1f2dc0,_0x2a7e23){return _0x26f4c1(_0x1d94ff-0x197,_0x1d94ff- -0x3f0,_0x2a7e23,_0x2a7e23-0xbf);}const {prompt:_0xed1736}=_0x33d8ae;_0x4806e2[_0x58ff8c(0x1c8,0x1ce,0x25f,0x20a)](_0x346399(0xd9,0x8b,0xf6,0xeb)+_0x346399(0x105,0xf3,0x14e,0x13a)+_0x346399(0xf4,0x11d,0x10b,0x135)+_0x59bef0+'):',_0xed1736),_0xe47dff[_0x346399(0x13d,0x118,0x188,0x18b)](_0x4f7e9a,_0xed1736);};function _0x26f4c1(_0x573d8c,_0x212353,_0x1ffd81,_0x41d806){return _0x75d269(_0x573d8c-0xd8,_0x1ffd81,_0x1ffd81-0x88,_0x212353-0x2ac);}_0x524832['on'](_0x1d5f1c[_0x3869ec(0x1ee,0x1a3,0x1f2,0x1fc)+_0x26f4c1(0x46e,0x4b9,0x4db,0x507)+_0x3869ec(0x1cd,0x1ec,0x1e0,0x1e8)+_0x26f4c1(0x4d3,0x529,0x53f,0x544)],_0x163751);const _0x35dd13={};_0x35dd13['id']=_0x59bef0,_0xb644e9[_0x26f4c1(0x4d8,0x51c,0x526,0x4f7)](_0xc2c187['LLM_TRANSL'+_0x3869ec(0x172,0x18a,0x18f,0x11b)+_0x26f4c1(0x4db,0x4ff,0x53b,0x4d5)+_0x3869ec(0x193,0x181,0x15f,0x1c0)],_0x35dd13),_0xe47dff['awROt'](_0x17c3ef,()=>{_0x52cfb8['removeList'+_0x371599(0xb0,0x106,0xf9,0xde)](_0x4e8ca8[_0x371599(0x172,0x16e,0x19d,0x18d)+_0x1bf324(0x496,0x48b,0x459,0x4ae)+_0x371599(0x190,0x14d,0x143,0x10e)+_0x371599(0x16e,0x162,0x187,0x1b6)],_0x163751);function _0x1bf324(_0x60b4c3,_0x315d17,_0x387ef6,_0x3ec7fe){return _0x3869ec(_0x387ef6-0x2e7,_0x315d17,_0x387ef6-0x1c0,_0x3ec7fe-0x9a);}function _0x371599(_0x158c9b,_0x3a2972,_0x4317bb,_0x463b4f){return _0x3869ec(_0x3a2972- -0x80,_0x4317bb,_0x4317bb-0x6e,_0x463b4f-0x38);}_0x4a6057(new _0x228ec2(_0x1bf324(0x43c,0x4c1,0x470,0x451)));},0xa7a*0x4+0x1f6d+-0x2245);});}else _0x2435d6[_0x75d269(0x202,0x1f4,0x1df,0x215)](_0x5cf989),_0x3b4d85[_0x389979(-0x15f,-0x134,-0x15d,-0x171)](_0x5cf989[_0x75d269(0x1f1,0x208,0x217,0x21f)+'e'](),_0x59597a);}}}}return{'originalTags':_0x58d833,'cleanedTags':_0x2435d6,'cleanedText':_0x3f8d6c[_0x75d269(0x1fc,0x1e5,0x1eb,0x1f4)](tagsToJsonString,_0x2435d6),'tagMap':_0x3b4d85};}export function combineTranslationResult(_0x39a328,_0x27833c){const _0x2204fc={};_0x2204fc[_0xcf08b7(0x185,0x1cf,0x203,0x1ac)]=function(_0x3687e3,_0x504b1b){return _0x3687e3===_0x504b1b;},_0x2204fc[_0xcf08b7(0x1d5,0x1d4,0x1b2,0x187)]=_0xd3496f(0x439,0x448,0x47e,0x405);const _0x4abf71=_0x2204fc;if(!_0x39a328||!Array[_0xcf08b7(0x206,0x205,0x1c1,0x1c2)](_0x39a328))return[];const _0x310188={};function _0xcf08b7(_0x2c521b,_0x19733d,_0x2578f6,_0x2f3755){return _0x21a4(_0x19733d-0x6a,_0x2f3755);}if(_0x27833c&&_0x4abf71[_0xd3496f(0x40d,0x449,0x412,0x417)](typeof _0x27833c,_0x4abf71[_0xcf08b7(0x20f,0x1d4,0x1ef,0x221)]))for(const [_0x2948dd,_0x1bb59a]of Object['entries'](_0x27833c)){_0x310188[_0x2948dd[_0xd3496f(0x3da,0x3e8,0x430,0x403)+'e']()]=_0x1bb59a;}function _0xd3496f(_0x171ae2,_0x314b2e,_0x237d36,_0x12ecf1){return _0x21a4(_0x171ae2-0x2a8,_0x12ecf1);}return _0x39a328[_0xd3496f(0x436,0x470,0x3ec,0x46f)](_0xe3a415=>{const {original:_0x4518be,cleaned:_0x52f962,skip:_0x7d16af}=_0xe3a415;if(_0x7d16af){const _0x25b9ad={};return _0x25b9ad[_0x249493(0x227,0x262,0x295,0x286)]=_0x4518be,_0x25b9ad[_0x249493(0x1e8,0x1ca,0x1db,0x1c3)+'n']='',_0x25b9ad['cleaned']=_0x52f962,_0x25b9ad[_0x477b57(0x5c,0x68,0x78,0xad)]=!![],_0x25b9ad;}const _0x13b337=_0x310188[_0x52f962[_0x249493(0x1c6,0x1ff,0x1d7,0x213)+'e']()]||'',_0x3784b7={};function _0x477b57(_0x46bf0c,_0x53d5e5,_0x3212d7,_0x128259){return _0xd3496f(_0x128259- -0x387,_0x53d5e5-0x109,_0x3212d7-0x181,_0x53d5e5);}function _0x249493(_0x41b4b7,_0x552c57,_0x5a96d7,_0x12f9fd){return _0xd3496f(_0x552c57- -0x1db,_0x552c57-0x195,_0x5a96d7-0x8d,_0x41b4b7);}return _0x3784b7[_0x477b57(0xf7,0x62,0xf3,0xb6)]=_0x4518be,_0x3784b7[_0x477b57(0x34,0x20,-0x1a,0x1e)+'n']=_0x13b337,_0x3784b7[_0x477b57(0xd8,0xbf,0x9d,0xab)]=_0x52f962,_0x3784b7[_0x249493(0x26d,0x259,0x287,0x254)]=![],_0x3784b7;});}export function formatTranslationDisplay(_0x194b06,_0x292f49={}){function _0x4a92e2(_0x1746d3,_0x2993eb,_0x5b534a,_0x5472d0){return _0x21a4(_0x2993eb- -0x17,_0x5b534a);}const _0x2357de={};_0x2357de[_0x4a92e2(0x172,0x174,0x196,0x158)]=function(_0x686bfa,_0x2b9c6c){return _0x686bfa===_0x2b9c6c;},_0x2357de[_0x665212(-0xf1,-0x119,-0xb5,-0xf4)]=_0x4a92e2(0x16a,0x170,0x156,0x1b9);function _0x665212(_0x102cb1,_0x2f7427,_0x363159,_0x3b4f33){return _0x21a4(_0x3b4f33- -0x238,_0x2f7427);}_0x2357de[_0x4a92e2(0x11c,0x13b,0x18c,0x130)]=_0x4a92e2(0x142,0x100,0xc3,0xd6);const _0xfebc34=_0x2357de,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x292f49;if(!_0x194b06||!Array[_0x4a92e2(0x14d,0x184,0x1db,0x176)](_0x194b06))return'';return _0x194b06[_0x4a92e2(0x19e,0x177,0x1c7,0x1c3)](_0x5b4897=>{function _0x26aef1(_0x13025e,_0x9fa940,_0x327466,_0x48e2a0){return _0x665212(_0x13025e-0x17d,_0x327466,_0x327466-0x15c,_0x13025e- -0x3d);}if(_0x5b4897[_0x10ea92(0x44a,0x417,0x418,0x445)])return showOriginal?_0x5b4897[_0x26aef1(-0xe0,-0x11d,-0xf1,-0x10f)]:'';const _0x46d953=[];if(showOriginal)_0x46d953[_0x26aef1(-0x14d,-0x114,-0x166,-0x16e)](_0x5b4897[_0x10ea92(0x477,0x3f8,0x42e,0x44e)]);showTranslation&&_0x5b4897['translatio'+'n']&&(_0xfebc34[_0x10ea92(0x3fb,0x430,0x45e,0x444)](_0xfebc34[_0x26aef1(-0x131,-0x113,-0x118,-0xeb)],_0xfebc34[_0x10ea92(0x440,0x43b,0x413,0x40b)])?_0xbc2603[_0x10ea92(0x38e,0x3d6,0x3af,0x3e1)]('('+_0x5563c9[_0x10ea92(0x3e0,0x3c1,0x385,0x3b6)+'n']+')'):_0x46d953[_0x26aef1(-0x14d,-0x13a,-0x1a4,-0x15f)]('('+_0x5b4897[_0x10ea92(0x39e,0x402,0x3f0,0x3b6)+'n']+')'));function _0x10ea92(_0x2fa970,_0x1fa96d,_0x21cf6c,_0xe027d0){return _0x665212(_0x2fa970-0xc5,_0x21cf6c,_0x21cf6c-0x137,_0xe027d0-0x4f1);}return _0x46d953[_0x26aef1(-0x10c,-0x125,-0xfa,-0xb6)]('\x20');})['filter'](Boolean)['join'](separator);}export async function translatePromptTags(_0xd14977){function _0x34f376(_0x1a80f9,_0x1852ca,_0x79cfd6,_0x58bb2c){return _0x21a4(_0x58bb2c- -0x79,_0x79cfd6);}const _0x57022e={'DpdCA':function(_0x4d2b90,_0x304dbf){return _0x4d2b90(_0x304dbf);},'hMoGr':function(_0xb02a00,_0x131fb7){return _0xb02a00!==_0x131fb7;},'zAwkH':_0x34f376(0xc7,0xbb,0x97,0xe7),'vKgJK':function(_0x336769,_0x2bd8fb){return _0x336769(_0x2bd8fb);},'HdhEY':function(_0x28f51c,_0x2c39eb,_0x1ada3f){return _0x28f51c(_0x2c39eb,_0x1ada3f);},'CdKdk':_0x5619c1(0xc0,0xcd,0xf8,0x95)+_0x34f376(0xb4,0xf1,0x10c,0x101)+':'},{originalTags:_0x3db747,cleanedText:_0x420dc5}=_0x57022e[_0x34f376(0x4f,0xba,0x41,0x8c)](preprocessPromptForTranslation,_0xd14977);if(!_0x420dc5){const _0xe09154={};return _0xe09154['results']=[],_0xe09154['displayTex'+'t']='',_0xe09154['originalTa'+'gs']=[],_0xe09154;}function _0x5619c1(_0x370502,_0x55ed90,_0x253058,_0x109df0){return _0x21a4(_0x55ed90- -0x63,_0x370502);}try{if(_0x57022e[_0x34f376(0xe1,0x123,0xfb,0x10d)](_0x34f376(0xb0,0xdf,0xe9,0xc2),_0x57022e[_0x34f376(0x10a,0x12d,0x11f,0xe0)])){const _0x23c99e=await callTranslation(_0x420dc5),_0x236894=_0x57022e[_0x5619c1(0xcd,0xdc,0x101,0xca)](parseTranslationResult,_0x23c99e),_0x5aeda2=_0x57022e['HdhEY'](combineTranslationResult,_0x3db747,_0x236894),_0x5cd6ad=_0x57022e[_0x5619c1(0xe9,0xa2,0xa7,0x9f)](formatTranslationDisplay,_0x5aeda2),_0xe05b07={};return _0xe05b07[_0x34f376(0x3d,0x4b,0xd8,0x94)]=_0x5aeda2,_0xe05b07[_0x5619c1(0xb1,0xd6,0xca,0xdb)+'t']=_0x5cd6ad,_0xe05b07[_0x34f376(0xaa,0xe3,0xfb,0xa8)+'gs']=_0x3db747,_0xe05b07;}else for(const [_0x123c8f,_0x56abed]of _0x154b92['entries'](_0x511a91)){_0x244886[_0x123c8f[_0x5619c1(0x8a,0xcf,0xa7,0xff)+'e']()]=_0x56abed;}}catch(_0x52c3eb){console[_0x34f376(0x6a,0x82,0xb8,0x7a)](_0x57022e[_0x34f376(0x13a,0x100,0x14a,0x109)],_0x52c3eb);throw _0x52c3eb;}}export function parseTranslationResult(_0xd9dc58){const _0xad4a01={};_0xad4a01['QpCYb']=function(_0x394543,_0x51b6da){return _0x394543+_0x51b6da;},_0xad4a01[_0x58681b(0x149,0x126,0xe7,0x131)]=function(_0x54f292,_0x18a1da){return _0x54f292!==_0x18a1da;},_0xad4a01['feCOO']=_0x58681b(0x1df,0x18c,0x16f,0x167);function _0x34713d(_0x3b258e,_0x1959f8,_0x1d45a6,_0x3cd916){return _0x21a4(_0x3b258e- -0x25c,_0x1d45a6);}_0xad4a01['LZQfa']=function(_0x585ddd,_0x23a283){return _0x585ddd>_0x23a283;};function _0x58681b(_0x2da8ae,_0x177a89,_0xa22e32,_0x56ad94){return _0x21a4(_0x177a89- -0x5,_0x2da8ae);}_0xad4a01[_0x34713d(-0x10f,-0x10e,-0xc5,-0x100)]=function(_0x2320e4,_0x930a28){return _0x2320e4===_0x930a28;},_0xad4a01[_0x34713d(-0xbc,-0x76,-0x86,-0x6d)]=_0x34713d(-0xdf,-0xd5,-0x99,-0x98);const _0x185b92=_0xad4a01;if(!_0xd9dc58)return{};try{const _0x44e1ff=_0xd9dc58['match'](/\{[\s\S]*\}/);if(_0x44e1ff){if(_0x185b92[_0x58681b(0xf8,0x126,0x127,0xfb)](_0x34713d(-0xe7,-0xb7,-0x126,-0x96),_0x58681b(0x1c6,0x17b,0x176,0x158))){const _0x4b08b0=JSON[_0x58681b(0x19e,0x172,0x142,0x12c)](_0x44e1ff[0x67f+0x6b*0x47+-0x1cf*0x14]);if(typeof _0x4b08b0===_0x185b92[_0x34713d(-0xd4,-0xe8,-0x11f,-0xda)]&&_0x185b92[_0x58681b(0x123,0x126,0x129,0x109)](_0x4b08b0,null))return _0x4b08b0;}else{if(_0x3c4c83&&_0x10fe47[_0x34713d(-0x14e,-0xf7,-0x190,-0x12b)])return _0x5b38f1['randomUUID']();return _0x185b92[_0x34713d(-0x15a,-0x15f,-0x17c,-0x192)](_0x1a93db[_0x34713d(-0xde,-0xc5,-0x127,-0xe4)]()[_0x34713d(-0x11f,-0x15b,-0x142,-0xf2)](0x1f13+0x1*-0xa31+-0x14be),_0x2b7f91[_0x34713d(-0xf8,-0x10a,-0xf8,-0xf2)]()[_0x34713d(-0x11f,-0x11d,-0x13e,-0xfa)](0x22f5+-0x1766+0xb6b*-0x1)[_0x34713d(-0x15e,-0x183,-0x17d,-0x167)](0x8e9*-0x1+-0x327+-0x3*-0x406));}}}catch(_0x5658d0){console[_0x34713d(-0xef,-0xa8,-0xac,-0x9c)](_0x34713d(-0x12c,-0x165,-0x15e,-0x120)+_0x34713d(-0x153,-0x16a,-0x17b,-0x101)+'尝试旧格式:',_0x5658d0[_0x34713d(-0xff,-0x134,-0x120,-0x10d)]);}const _0x16130e=String(_0xd9dc58)[_0x58681b(0x170,0x19c,0x19f,0x1ac)](/[\r\n]+/g,'\x20')[_0x58681b(0x169,0x19c,0x1be,0x159)](/^[\s"'`]+|[\s"'`]+$/g,'')['trim'](),_0x4e8cf3=_0x16130e[_0x58681b(0x181,0x12c,0x10d,0x181)](/[,，]/)[_0x34713d(-0xce,-0x94,-0x9b,-0x118)](_0x5b2c44=>_0x5b2c44['trim']())['filter'](Boolean),_0x5a0f60={};for(const _0x317faf of _0x4e8cf3){const _0x43bf9c=_0x317faf[_0x58681b(0x136,0x14c,0x181,0x147)]('\x5c');if(_0x185b92[_0x58681b(0xff,0x156,0x16e,0x10c)](_0x43bf9c,0x10d3+0x1988+-0x2a5b)){if(_0x185b92['jQdaf'](_0x58681b(0x1d6,0x195,0x1ea,0x183),_0x185b92[_0x34713d(-0xbc,-0x97,-0x81,-0xe5)]))_0x40bd26[_0x58681b(0x145,0x123,0xeb,0x109)](_0x3d42b8),_0x433fc8[_0x58681b(0x141,0x13e,0x115,0x17e)](_0x447fd8[_0x34713d(-0x12a,-0xe2,-0x120,-0x158)+'e'](),_0x360a34);else{const _0x53b8fa=_0x317faf[_0x34713d(-0xec,-0x144,-0xf4,-0x12a)](-0x37*-0x1d+-0x95*-0x2+-0x3*0x277,_0x43bf9c)[_0x58681b(0x146,0x14b,0x116,0x188)](),_0x1dcc04=_0x317faf[_0x58681b(0x17d,0x16b,0x1be,0x14c)](_0x185b92['QpCYb'](_0x43bf9c,0x7d0+0x427+0x1*-0xbf6))[_0x34713d(-0x10c,-0x103,-0xc5,-0xe4)]();if(_0x53b8fa)_0x5a0f60[_0x53b8fa]=_0x1dcc04;}}}return _0x5a0f60;}function generateRequestId(){const _0x5bccb6={};_0x5bccb6[_0x2ef500(0x307,0x2f0,0x2c0,0x338)]=_0x4d3a2e(0x163,0x148,0x10c,0x102),_0x5bccb6[_0x2ef500(0x2c2,0x2a2,0x316,0x295)]=function(_0xd5a455,_0x3367e4){return _0xd5a455!==_0x3367e4;},_0x5bccb6[_0x2ef500(0x2f1,0x2ff,0x33d,0x317)]=function(_0x154e3,_0xfc299f){return _0x154e3===_0xfc299f;};function _0x2ef500(_0x5b0333,_0x2251ef,_0x8838c7,_0x1bf348){return _0x21a4(_0x5b0333-0x1a5,_0x2251ef);}_0x5bccb6[_0x4d3a2e(0xb2,0xc3,0xee,0x126)]='dDmlO';const _0x253711=_0x5bccb6;function _0x4d3a2e(_0x12e1e9,_0x47a91e,_0x1c7044,_0x27ff7b){return _0x21a4(_0x1c7044- -0x85,_0x12e1e9);}if(crypto&&crypto[_0x4d3a2e(0x94,0x6a,0x89,0x3a)]){if(_0x253711['xmzBP'](_0x253711[_0x4d3a2e(0xcf,0xd9,0xee,0xac)],_0x253711[_0x2ef500(0x318,0x355,0x35b,0x2da)]))return crypto[_0x2ef500(0x2b3,0x2db,0x2aa,0x28c)]();else{const _0x440ecf=_0x506a54[_0x4d3a2e(0xdc,0x13e,0xf3,0x10b)](/\{[\s\S]*\}/);if(_0x440ecf){const _0x320369=_0x2015ac[_0x2ef500(0x31c,0x34f,0x310,0x2ea)](_0x440ecf[-0x1f5e+-0x6f3+-0x241*-0x11]);if(typeof _0x320369===_0x253711[_0x4d3a2e(0x91,0x118,0xdd,0x9e)]&&_0x253711[_0x2ef500(0x2c2,0x280,0x2fe,0x28f)](_0x320369,null))return _0x320369;}}}return Date[_0x2ef500(0x323,0x375,0x347,0x354)]()[_0x2ef500(0x2e2,0x2c6,0x2c0,0x329)](0x16c5+-0x252f+0x1*0xe8e)+Math[_0x4d3a2e(0xed,0x111,0xdf,0xce)]()[_0x2ef500(0x2e2,0x2ac,0x2ae,0x298)](-0x8c3*0x4+-0x919+0x2c49)[_0x4d3a2e(0x86,0x26,0x79,0xbc)](-0x29*-0x15+-0xc5*0x1d+0x329*0x6);}export function LLM_TRANSLATION_GET_PROMPT(){const _0x22ee8d={'CtwjI':function(_0x27da33,_0x1b96ed){return _0x27da33(_0x1b96ed);},'MEDrP':_0x2645fd(0x294,0x2cc,0x24a,0x2e1),'jKWaj':function(_0x2d8df0,_0x5d7f5d){return _0x2d8df0!==_0x5d7f5d;},'thCms':'YjUZz','BjWyC':_0x2645fd(0x286,0x2cd,0x275,0x26f),'EOsdf':function(_0x195676,_0x8306db){return _0x195676(_0x8306db);},'jnLBE':function(_0x10c83b,_0x108834){return _0x10c83b===_0x108834;},'uizDN':_0x3d6806(0x410,0x3d9,0x470,0x427),'GuijP':function(_0xdbc890){return _0xdbc890();},'LrUEs':function(_0x5e0152,_0x2b5234,_0x1e0d19){return _0x5e0152(_0x2b5234,_0x1e0d19);}};function _0x2645fd(_0x2ad856,_0x27b638,_0x2498ae,_0x4c1a09){return _0x21a4(_0x2ad856-0x14f,_0x2498ae);}function _0x3d6806(_0x486332,_0xef95a,_0x250670,_0x449d2f){return _0x21a4(_0x449d2f-0x294,_0x250670);}return new Promise((_0x2584f9,_0xda5315)=>{function _0x7c9bad(_0x513692,_0x5b7fca,_0x5dc939,_0x348301){return _0x3d6806(_0x513692-0x12f,_0x5b7fca-0x75,_0x513692,_0x5dc939- -0x1d4);}function _0x4bec7b(_0x1f2e64,_0xc4ad87,_0x3337f1,_0x202a0a){return _0x2645fd(_0x202a0a- -0x511,_0xc4ad87-0x122,_0x3337f1,_0x202a0a-0x1ee);}const _0x15a16a={'QwdMN':function(_0xfc8cbf,_0x282c87){function _0x124136(_0x861aef,_0x3110a1,_0x1e40a8,_0x18ab44){return _0x21a4(_0x1e40a8-0x106,_0x18ab44);}return _0x22ee8d[_0x124136(0x222,0x206,0x1fc,0x1dc)](_0xfc8cbf,_0x282c87);},'KIaAH':_0x7c9bad(0x19d,0x1fd,0x1cc,0x193),'XJYOf':function(_0x222f61,_0x35a530){function _0x5f182e(_0x27ae38,_0x35921d,_0x479b12,_0x3983aa){return _0x7c9bad(_0x35921d,_0x35921d-0x1bd,_0x3983aa- -0x84,_0x3983aa-0x19a);}return _0x22ee8d[_0x5f182e(0x14c,0x143,0x187,0x172)](_0x222f61,_0x35a530);},'vrknH':function(_0x51e0fd,_0x360e48){return _0x51e0fd(_0x360e48);}};if(_0x22ee8d[_0x7c9bad(0x1d8,0x1b2,0x1e2,0x1c5)](_0x22ee8d[_0x7c9bad(0x225,0x23c,0x1e4,0x18e)],_0x22ee8d[_0x4bec7b(-0x2bd,-0x272,-0x2a3,-0x29e)])){const _0x3862e3=_0x22ee8d[_0x4bec7b(-0x29a,-0x265,-0x2d2,-0x2a8)](generateRequestId);console[_0x7c9bad(0x20d,0x228,0x217,0x248)]('st-chatu8:'+_0x7c9bad(0x1f9,0x1fe,0x23f,0x21d)+_0x7c9bad(0x262,0x25d,0x22b,0x25b)+_0x3862e3+')');const _0x31cef7=_0x2b832f=>{function _0x145132(_0x4bfef8,_0x27acdd,_0x5bd8c6,_0x380595){return _0x7c9bad(_0x27acdd,_0x27acdd-0x104,_0x4bfef8- -0x120,_0x380595-0x10);}function _0x37164f(_0x120d2d,_0x3763c7,_0x6db55,_0x5c210a){return _0x4bec7b(_0x120d2d-0x193,_0x3763c7-0x1ee,_0x5c210a,_0x120d2d-0x101);}if(_0x15a16a[_0x145132(0xc6,0xd8,0x9e,0xdd)](_0x37164f(-0x1b5,-0x1a6,-0x1c1,-0x173),_0x15a16a['KIaAH'])){if(_0x1b8973[_0x145132(0x12c,0xde,0x11f,0x105)])return _0x2259d2?_0x4854ee['original']:'';const _0x2711ae=[];if(_0x2128b)_0x2711ae[_0x37164f(-0x199,-0x151,-0x163,-0x166)](_0xfa31d9[_0x145132(0x135,0x17b,0x187,0x122)]);return _0x398f0e&&_0x1bd0d5['translatio'+'n']&&_0x2711ae[_0x145132(0xc8,0xc3,0xf9,0xa2)]('('+_0xee00fc[_0x145132(0x9d,0xef,0x63,0x53)+'n']+')'),_0x2711ae[_0x145132(0x109,0x153,0x15a,0xd8)]('\x20');}else{if(_0x15a16a[_0x37164f(-0x19b,-0x169,-0x15f,-0x151)](_0x2b832f['id'],_0x3862e3))return;eventSource[_0x145132(0xb6,0xce,0xc9,0xc4)+_0x145132(0xd4,0x83,0xeb,0xe5)](eventNames[_0x37164f(-0x125,-0x178,-0x16f,-0x169)+_0x37164f(-0x1a1,-0x14f,-0x1e1,-0x154)+_0x37164f(-0x146,-0x110,-0x14b,-0x142)+_0x37164f(-0x131,-0x172,-0x169,-0x113)],_0x31cef7);const {prompt:_0x235e49}=_0x2b832f;console[_0x145132(0xf7,0x13b,0xaa,0x110)]('st-chatu8:'+'\x20已获取翻译提示词\x20'+_0x145132(0xeb,0xdf,0x128,0x105)+_0x3862e3+'):',_0x235e49),_0x15a16a[_0x145132(0xb1,0x88,0xd9,0x9b)](_0x2584f9,_0x235e49);}};eventSource['on'](eventNames[_0x7c9bad(0x24d,0x25d,0x25c,0x27e)+_0x4bec7b(-0x2ba,-0x2c9,-0x265,-0x2a2)+_0x7c9bad(0x260,0x26b,0x23b,0x201)+_0x4bec7b(-0x26d,-0x264,-0x269,-0x232)],_0x31cef7);const _0x1952d7={};_0x1952d7['id']=_0x3862e3,eventSource[_0x4bec7b(-0x243,-0x28c,-0x209,-0x23f)](eventNames[_0x4bec7b(-0x1f1,-0x203,-0x27c,-0x226)+_0x4bec7b(-0x2f3,-0x26e,-0x2df,-0x2a2)+_0x4bec7b(-0x28c,-0x26b,-0x227,-0x25c)+_0x4bec7b(-0x2c2,-0x280,-0x248,-0x281)],_0x1952d7),_0x22ee8d[_0x4bec7b(-0x2ca,-0x2e8,-0x2f8,-0x2b8)](setTimeout,()=>{const _0x1b98fe={'CAEGg':function(_0xdb6b27,_0x142678){function _0x31a1f2(_0x1e4b16,_0x5a6de1,_0x286e69,_0x120143){return _0x21a4(_0x1e4b16- -0x1ea,_0x120143);}return _0x22ee8d[_0x31a1f2(-0x7e,-0x2b,-0x70,-0x71)](_0xdb6b27,_0x142678);},'opmBq':_0x22ee8d[_0x46c7b3(-0x15b,-0x18d,-0x1b3,-0x18d)]};function _0x46c7b3(_0x5335e8,_0x275f16,_0x22c193,_0x283644){return _0x7c9bad(_0x5335e8,_0x275f16-0x93,_0x22c193- -0x412,_0x283644-0x4c);}function _0x4e5e32(_0x3fae1f,_0x448d9a,_0x55f6ed,_0x3d3103){return _0x7c9bad(_0x448d9a,_0x448d9a-0x14,_0x3d3103- -0x178,_0x3d3103-0x8);}if(_0x22ee8d[_0x4e5e32(-0x1,0x22,0x23,0x3e)](_0x22ee8d[_0x4e5e32(0x21,0xf,0x2d,0x3d)],_0x46c7b3(-0x1df,-0x27c,-0x224,-0x1f6)))eventSource[_0x46c7b3(-0x1fe,-0x259,-0x23c,-0x26e)+'ener'](eventNames['LLM_TRANSL'+_0x4e5e32(0x9f,0x52,0x2a,0x68)+_0x4e5e32(0x94,0xe5,0x86,0xc3)+_0x4e5e32(0xa0,0xe1,0xe1,0xd8)],_0x31cef7),_0xda5315(new Error(_0x22ee8d[_0x46c7b3(-0x2ae,-0x21b,-0x256,-0x20c)]));else{_0x1b98fe['CAEGg'](_0x4ed889,_0x4e5e32(0x20,0x78,0xba,0x64)+_0x130850[_0x4e5e32(0x53,0x5f,0xbd,0xa5)]),_0x4a599e['error'](_0x1b98fe[_0x4e5e32(0x9d,0x85,0xd8,0xba)],_0xb318d1);throw _0xf833a0;}},0x4*-0x7+0x25cf+0x15d);}else{if(_0x15a16a['QwdMN'](_0x3f673a['id'],_0x2ab2e6))return;_0x411702[_0x4bec7b(-0x2e2,-0x2a1,-0x256,-0x2ac)+_0x4bec7b(-0x2a9,-0x29b,-0x264,-0x28e)](_0x21f1db[_0x7c9bad(0x23d,0x29e,0x25c,0x21c)+'ATION_GET_'+'PROMPT_RES'+_0x7c9bad(0x218,0x206,0x250,0x236)],_0x13fb6d);const {prompt:_0x1beb94}=_0x33dbac;_0x2b2a1b['log'](_0x7c9bad(0x1e7,0x199,0x1f0,0x1a8)+_0x4bec7b(-0x26b,-0x297,-0x22e,-0x266)+'(ID:\x20'+_0x2ba265+'):',_0x1beb94),_0x15a16a[_0x7c9bad(0x1e1,0x1ee,0x20a,0x255)](_0x57b346,_0x1beb94);}});}export function LLM_TRANSLATION(_0x3537b6,{timeoutMs:timeoutMs=0xccae+0x183b7+-0x16605}={}){const _0xc05ac8={'TEeTT':function(_0x24dde2,_0x11d217){return _0x24dde2(_0x11d217);},'ejOyW':function(_0x11246e){return _0x11246e();},'mcqSH':function(_0x18f382,_0x1e0723){return _0x18f382!==_0x1e0723;},'Qwntn':_0x8f0d58(-0x17a,-0x15e,-0x135,-0x1b4),'orODg':function(_0x224b2a,_0x166485,_0x187103){return _0x224b2a(_0x166485,_0x187103);}};function _0x8f0d58(_0x1b3103,_0x14bee4,_0x346a7e,_0x4041c3){return _0x21a4(_0x1b3103- -0x2a1,_0x14bee4);}return new Promise((_0x4988b5,_0x96e5d)=>{const _0x187f26={'oUzSs':function(_0x518680,_0x32b273){function _0x7629d8(_0x3539de,_0x3c0bf2,_0x2d67f5,_0x102b73){return _0x21a4(_0x2d67f5- -0x35c,_0x3539de);}return _0xc05ac8[_0x7629d8(-0x1dd,-0x230,-0x204,-0x1dd)](_0x518680,_0x32b273);},'WwMkH':function(_0x4b5909,_0x551345){return _0xc05ac8['mcqSH'](_0x4b5909,_0x551345);},'KRKOA':function(_0x55131e){function _0x177183(_0x15a20a,_0x15a0d6,_0x48192b,_0x53bc80){return _0x21a4(_0x53bc80- -0xa,_0x15a0d6);}return _0xc05ac8[_0x177183(0x10e,0x180,0x18a,0x144)](_0x55131e);},'SBuet':function(_0xa4faee,_0x478073){function _0x4f59ba(_0x1ed319,_0x11f1c9,_0x234860,_0x242b85){return _0x21a4(_0x1ed319-0x3dd,_0x242b85);}return _0xc05ac8[_0x4f59ba(0x502,0x524,0x4f7,0x557)](_0xa4faee,_0x478073);},'QBfSo':'PojRo','dsYaE':_0xc05ac8[_0x56923a(0x402,0x3f3,0x3ea,0x41d)]};function _0x56923a(_0x4946e8,_0x2f3405,_0x3c805f,_0x458f4e){return _0x8f0d58(_0x2f3405-0x57b,_0x4946e8,_0x3c805f-0x24,_0x458f4e-0x1db);}const _0x103673=generateRequestId();function _0x47eb03(_0x4a68ba,_0x3797e6,_0x72ac43,_0x36bb87){return _0x8f0d58(_0x3797e6-0x50a,_0x36bb87,_0x72ac43-0x11d,_0x36bb87-0x9c);}console[_0x47eb03(0x3b4,0x3c0,0x3dd,0x380)]('st-chatu8:'+'\x20请求翻译\x20LLM\x20'+_0x56923a(0x3e8,0x425,0x3fe,0x3d9)+_0x103673+')');let _0x5d37ea=null;const _0x24c1ef=()=>{function _0x347fca(_0x26c5b9,_0x22524a,_0x1cc514,_0x53d4d2){return _0x56923a(_0x1cc514,_0x26c5b9-0xb6,_0x1cc514-0x18e,_0x53d4d2-0x12b);}function _0x5d78d8(_0x1ca3c5,_0x34cfb5,_0x2ca482,_0x2fec8c){return _0x56923a(_0x1ca3c5,_0x2fec8c- -0x657,_0x2ca482-0x113,_0x2fec8c-0x1d);}eventSource[_0x5d78d8(-0x284,-0x295,-0x255,-0x267)+'ener'](eventNames[_0x347fca(0x52c,0x56b,0x540,0x50d)+_0x347fca(0x506,0x4ed,0x4db,0x559)+_0x347fca(0x528,0x573,0x51a,0x57a)],_0x2c8ebf);if(_0x5d37ea)_0xc05ac8['TEeTT'](clearTimeout,_0x5d37ea);},_0x2c8ebf=_0x37226e=>{if(_0x187f26[_0x510840(-0x226,-0x247,-0x274,-0x216)](_0x37226e['id'],_0x103673))return;_0x187f26[_0x510840(-0x1e8,-0x1d1,-0x1af,-0x224)](_0x24c1ef);function _0x54d7c2(_0x141301,_0x2f8992,_0x5d8b8f,_0x89929c){return _0x47eb03(_0x141301-0x145,_0x5d8b8f- -0x221,_0x5d8b8f-0xcf,_0x141301);}function _0x510840(_0x292e58,_0x2273aa,_0x46709d,_0x55dbe4){return _0x56923a(_0x55dbe4,_0x292e58- -0x646,_0x46709d-0x190,_0x55dbe4-0xda);}console[_0x54d7c2(0x1b2,0x17f,0x19f,0x162)](_0x510840(-0x23c,-0x224,-0x1e6,-0x217)+'\x20已收到翻译\x20LLM'+_0x54d7c2(0x144,0x12e,0x17d,0x14e)+'\x20'+_0x103673+'):',_0x37226e);if(_0x37226e[_0x510840(-0x218,-0x1d1,-0x1f0,-0x1cc)])_0x4988b5(_0x37226e['result']);else{if(_0x187f26[_0x54d7c2(0x232,0x201,0x1e6,0x1f8)](_0x54d7c2(0x138,0x15b,0x180,0x196),_0x187f26[_0x54d7c2(0x16d,0x192,0x18a,0x151)]))_0x187f26[_0x510840(-0x230,-0x205,-0x25e,-0x26c)](_0x5dac1d,_0x253bb6[_0x54d7c2(0x190,0x118,0x14b,0x126)]);else{if(_0x37226e[_0x510840(-0x279,-0x243,-0x255,-0x2bd)]&&_0x37226e['error'][_0x510840(-0x20d,-0x1fd,-0x1cc,-0x1be)]===_0x187f26[_0x510840(-0x25d,-0x229,-0x27d,-0x20b)]){const _0x3b71b6=new Error(_0x37226e[_0x510840(-0x279,-0x271,-0x2aa,-0x2a1)][_0x54d7c2(0x1d3,0x1e1,0x1a5,0x1a8)]);_0x3b71b6[_0x54d7c2(0x164,0x199,0x1a7,0x1a5)]=_0x187f26[_0x510840(-0x25d,-0x24c,-0x239,-0x285)],_0x187f26[_0x54d7c2(0x1b1,0x15b,0x184,0x170)](_0x96e5d,_0x3b71b6);}else _0x96e5d(new Error(_0x37226e[_0x54d7c2(0x15f,0x18f,0x14b,0x171)]));}}};eventSource['on'](eventNames[_0x47eb03(0x44d,0x405,0x3e9,0x3e0)+'ATION_RESP'+_0x56923a(0x42a,0x472,0x42c,0x4be)],_0x2c8ebf);const _0x2cff63={};_0x2cff63[_0x56923a(0x472,0x422,0x400,0x466)]=_0x3537b6,_0x2cff63['id']=_0x103673,eventSource['emit'](eventNames[_0x47eb03(0x411,0x405,0x435,0x3da)+_0x47eb03(0x38f,0x3da,0x3d8,0x40e)+_0x47eb03(0x407,0x3e5,0x3da,0x3fe)],_0x2cff63),_0x5d37ea=_0xc05ac8[_0x47eb03(0x37d,0x398,0x398,0x37b)](setTimeout,()=>{function _0x44ac2f(_0x4e1e43,_0x3ebf96,_0x445ea1,_0x4c00d5){return _0x56923a(_0x445ea1,_0x3ebf96- -0x5e2,_0x445ea1-0xc9,_0x4c00d5-0xda);}_0xc05ac8[_0x44ac2f(-0x194,-0x1ba,-0x201,-0x188)](_0x24c1ef);function _0x42752d(_0x3fe15b,_0x35524f,_0x283279,_0x3b58f8){return _0x47eb03(_0x3fe15b-0x7d,_0x3b58f8-0x5f,_0x283279-0x179,_0x283279);}_0x96e5d(new Error(_0x42752d(0x38c,0x3bb,0x3ed,0x3c8)+'时（'+timeoutMs+_0x44ac2f(-0x13d,-0x171,-0x134,-0x199)));},timeoutMs);});}export async function callTranslation(_0x2b54be){const _0x531a57={'SgSOe':function(_0x1978ab,_0x1f1a50,_0x1f9064){return _0x1978ab(_0x1f1a50,_0x1f9064);},'EnApJ':_0x2bd5d4(0x36d,0x37b,0x3b6,0x3cd)+'n','AgSzr':function(_0x2c7633,_0x48a06e){return _0x2c7633(_0x48a06e);},'ePrvQ':_0x2bd5d4(0x3ea,0x3b8,0x40e,0x390),'FgvhM':function(_0x79dd91,_0x45beb1){return _0x79dd91(_0x45beb1);},'omlxq':'翻译失败:'};function _0x41f9ca(_0x9bdad9,_0x419a67,_0x53cdac,_0x4000c0){return _0x21a4(_0x419a67-0x15a,_0x4000c0);}function _0x2bd5d4(_0x4cc207,_0x45d78f,_0x220fa2,_0x4ae522){return _0x21a4(_0x45d78f-0x27e,_0x220fa2);}try{let _0x13cd4d=_0x531a57[_0x2bd5d4(0x3ea,0x417,0x432,0x431)](buildPromptForRequestType,_0x531a57[_0x2bd5d4(0x347,0x375,0x3a2,0x32b)],_0x2b54be||'');_0x13cd4d=_0x531a57[_0x41f9ca(0x315,0x2c2,0x307,0x2c5)](mergeAdjacentMessages,_0x13cd4d);const _0x466038={};_0x466038[_0x41f9ca(0x2b5,0x26f,0x296,0x26a)]=_0x531a57[_0x2bd5d4(0x3d9,0x399,0x361,0x357)],_0x466038[_0x2bd5d4(0x3d2,0x3a7,0x380,0x35e)]=_0x2b54be||'';const _0x10e0ca=[..._0x13cd4d,_0x466038];_0x531a57[_0x41f9ca(0x318,0x2d3,0x299,0x2f6)](updateCombinedPrompt,_0x10e0ca);const _0x8e04f2=await LLM_TRANSLATION(_0x10e0ca);return _0x8e04f2;}catch(_0x436ba4){_0x531a57[_0x41f9ca(0x30d,0x2c2,0x2c0,0x2bf)](addLog,_0x41f9ca(0x236,0x276,0x2c0,0x246)+_0x436ba4[_0x2bd5d4(0x3bb,0x3db,0x3a1,0x40c)]),console[_0x41f9ca(0x26b,0x24d,0x1fc,0x26e)](_0x531a57['omlxq'],_0x436ba4);throw _0x436ba4;}}let isAiInitialized=![];export function initAiSettings(_0xf79f32){const _0x2b9d17={};_0x2b9d17[_0x4017de(0x47c,0x4fc,0x476,0x4b7)]=_0x1eb9ab(-0x260,-0x279,-0x27e,-0x27f)+_0x1eb9ab(-0x249,-0x28d,-0x26e,-0x281)+_0x4017de(0x475,0x43c,0x4cb,0x488);function _0x4017de(_0x51fab4,_0x5f3a36,_0x2a5008,_0x5a0c01){return _0x21a4(_0x5a0c01-0x384,_0x5f3a36);}function _0x1eb9ab(_0xf1d22e,_0x38f805,_0x728988,_0x3026f6){return _0x21a4(_0x728988- -0x3ae,_0x38f805);}const _0x24245a=_0x2b9d17;!isAiInitialized&&(console[_0x4017de(0x4fd,0x49b,0x4de,0x4db)](_0x24245a[_0x4017de(0x46a,0x506,0x47e,0x4b7)]),isAiInitialized=!![]);}