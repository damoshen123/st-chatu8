(function(_0x55f191,_0x1fb99b){const _0x53c90b=_0x55f191();function _0x23c889(_0x5a48dd,_0xe1a344,_0x3e15fa,_0x3e5179){return _0x4d95(_0x3e15fa- -0xb,_0xe1a344);}function _0x5211c6(_0x1e13af,_0xaad92,_0x4dcc09,_0x173bd8){return _0x4d95(_0x1e13af- -0x1e2,_0x4dcc09);}while(!![]){try{const _0x3f62b8=-parseInt(_0x5211c6(-0xbf,-0x65,-0x7d,-0x114))/(-0x19c3+0x119d+0x827)*(-parseInt(_0x5211c6(-0xc4,-0x7e,-0x101,-0xc1))/(0x39d+0x6e*-0x23+-0xb6f*-0x1))+-parseInt(_0x5211c6(-0x106,-0xad,-0x10d,-0x146))/(-0x1*-0x2113+0x765*-0x3+-0xae1)+-parseInt(_0x23c889(0xf7,0x173,0x12e,0xdd))/(0x19d1+-0x1f*0x97+0x1*-0x784)+-parseInt(_0x23c889(0xea,0x15d,0x115,0x160))/(-0x1*-0xef5+-0x244a+-0xaad*-0x2)+parseInt(_0x5211c6(-0x11f,-0xe1,-0x122,-0x13a))/(-0xb*0x1eb+0x1006+0x3*0x1b3)+parseInt(_0x5211c6(-0x157,-0x18c,-0x105,-0x132))/(-0x653+0x636+0x24)*(-parseInt(_0x5211c6(-0xc1,-0x93,-0xd7,-0x7f))/(0x219a+-0x13c7*-0x1+-0x3559*0x1))+-parseInt(_0x23c889(0x111,0xc7,0xfc,0x10b))/(0x157f+-0x31+0x2d*-0x79)*(-parseInt(_0x23c889(0x10f,0x12d,0xe0,0xe6))/(-0x240a+0x1*0x837+0x1bdd));if(_0x3f62b8===_0x1fb99b)break;else _0x53c90b['push'](_0x53c90b['shift']());}catch(_0xe572ad){_0x53c90b['push'](_0x53c90b['shift']());}}}(_0x31df,0x23cad+-0x1*0x14c862+0x1f76c1));const _0x1ab2d4=(function(){const _0x225c82={};_0x225c82[_0x149920(0x482,0x43b,0x454,0x42d)]=function(_0x2aeab1,_0x2c170f){return _0x2aeab1===_0x2c170f;};function _0x149920(_0x470395,_0x8339e6,_0x521cee,_0x3491e7){return _0x4d95(_0x8339e6-0x33e,_0x3491e7);}const _0x58d451=_0x225c82;let _0x55b257=!![];return function(_0x54ee10,_0x184c98){function _0x2b4599(_0x1c2895,_0x874e36,_0x523164,_0x56e86c){return _0x149920(_0x1c2895-0x13a,_0x523164- -0x63d,_0x523164-0x19b,_0x874e36);}function _0x2ff465(_0x264030,_0xe44fbf,_0x2b7952,_0x1545ee){return _0x149920(_0x264030-0xd7,_0x2b7952- -0x4a6,_0x2b7952-0x92,_0xe44fbf);}if(_0x58d451[_0x2b4599(-0x204,-0x201,-0x202,-0x1af)](_0x2ff465(-0x68,-0x39,-0x53,-0x16),_0x2ff465(-0x1e,-0x7d,-0x53,-0x16))){const _0x58d96c=_0x55b257?function(){function _0x4c3833(_0x9e9ee3,_0x1f83ab,_0x3b01d5,_0x3e7a48){return _0x2ff465(_0x9e9ee3-0x18c,_0x1f83ab,_0x3e7a48- -0x27a,_0x3e7a48-0xe7);}if(_0x184c98){const _0x488b8b=_0x184c98[_0x4c3833(-0x331,-0x306,-0x36e,-0x349)](_0x54ee10,arguments);return _0x184c98=null,_0x488b8b;}}:function(){};return _0x55b257=![],_0x58d96c;}else _0x2ebd71+=_0xa11a47;};}()),_0xd9254d=_0x1ab2d4(this,function(){const _0x318ffe={};_0x318ffe[_0x441453(0x44,0x34,0x84,0x32)]=_0x2f35ed(0x221,0x271,0x29b,0x252)+'+$';function _0x441453(_0x352ea6,_0x374192,_0x3fedb9,_0xfa5aee){return _0x4d95(_0x374192- -0xa4,_0x3fedb9);}function _0x2f35ed(_0x43db8c,_0x174aea,_0x3a5cab,_0x5932a3){return _0x4d95(_0x174aea-0x1cc,_0x43db8c);}const _0x552388=_0x318ffe;return _0xd9254d[_0x441453(-0x4e,0x6,0x3e,0x1f)]()['search'](_0x2f35ed(0x269,0x271,0x227,0x2ad)+'+$')['toString']()[_0x441453(-0x2d,-0x1e,-0x21,-0x5c)+'r'](_0xd9254d)[_0x2f35ed(0x305,0x2b1,0x2b7,0x290)](_0x552388[_0x2f35ed(0x289,0x2a4,0x273,0x287)]);});_0xd9254d();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function _0x4d95(_0x1138ff,_0x4a9567){_0x1138ff=_0x1138ff-(-0x6f*-0x7+-0x75e+-0x26d*-0x2);const _0x563c10=_0x31df();let _0x2bbf47=_0x563c10[_0x1138ff];if(_0x4d95['YNqyxP']===undefined){var _0x39af43=function(_0x8ffa84){const _0xfa6d84='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x213a09='',_0x3a411c='',_0x471c47=_0x213a09+_0x39af43;for(let _0x50f39d=-0x9a4*0x2+-0x1*-0x1e83+0x19*-0x73,_0x282384,_0x58360b,_0x2481e4=0x231+0x16e*-0x11+0x161d*0x1;_0x58360b=_0x8ffa84['charAt'](_0x2481e4++);~_0x58360b&&(_0x282384=_0x50f39d%(0x13*-0x1e3+-0x2132+-0x3*-0x1705)?_0x282384*(0x289+0x2280+-0x24c9)+_0x58360b:_0x58360b,_0x50f39d++%(-0x168b+-0xf*0x233+0x378c))?_0x213a09+=_0x471c47['charCodeAt'](_0x2481e4+(-0x112+-0x98f*0x3+0x1dc9))-(0x2*0x5d1+0x185b+0x1*-0x23f3)!==0x9e4+0x3fb*-0x5+0xe9*0xb?String['fromCharCode'](0x1c2*-0xf+0x469*0x7+-0x382&_0x282384>>(-(-0x15*0xa+-0x17*-0x1b1+-0x3*0xcb1)*_0x50f39d&0x1c95*-0x1+-0x43*-0x73+-0x17e)):_0x50f39d:-0x37*-0x47+-0x235d+-0x2c*-0x75){_0x58360b=_0xfa6d84['indexOf'](_0x58360b);}for(let _0x174ba3=0x1d2d+-0x134f*0x1+-0x9de,_0x3bf0a4=_0x213a09['length'];_0x174ba3<_0x3bf0a4;_0x174ba3++){_0x3a411c+='%'+('00'+_0x213a09['charCodeAt'](_0x174ba3)['toString'](-0x1*0x4bc+0x924+-0x458))['slice'](-(0x4d*0x3b+-0x1*0x5e8+-0xbd5));}return decodeURIComponent(_0x3a411c);};_0x4d95['dxjQgt']=_0x39af43,_0x4d95['SijGUt']={},_0x4d95['YNqyxP']=!![];}const _0x282b94=_0x563c10[0x8d2*-0x3+-0x83*-0xb+0x14d5],_0x5a26fb=_0x1138ff+_0x282b94,_0x7af7d4=_0x4d95['SijGUt'][_0x5a26fb];if(!_0x7af7d4){const _0x5e9fd7=function(_0x47f948){this['vrrydM']=_0x47f948,this['jWvsGN']=[-0x2*-0x1157+-0x22ca+0x1d,-0x1ed3+0x1*0xad4+0x1*0x13ff,0x4*0x394+-0x1193+0x343],this['ctwgpk']=function(){return'newState';},this['ShTvzi']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['lglJZU']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5e9fd7['prototype']['ashTin']=function(){const _0x33befa=new RegExp(this['ShTvzi']+this['lglJZU']),_0x588fe8=_0x33befa['test'](this['ctwgpk']['toString']())?--this['jWvsGN'][0x2213+0x38d+-0x1*0x259f]:--this['jWvsGN'][-0xc9a+0x23fb+-0x5f*0x3f];return this['ekfMNw'](_0x588fe8);},_0x5e9fd7['prototype']['ekfMNw']=function(_0x5263ac){if(!Boolean(~_0x5263ac))return _0x5263ac;return this['DnPoLX'](this['vrrydM']);},_0x5e9fd7['prototype']['DnPoLX']=function(_0x2f8a26){for(let _0x3b6d5c=0x1*-0x1df7+0xb*0x7a+0x18b9,_0x58dca7=this['jWvsGN']['length'];_0x3b6d5c<_0x58dca7;_0x3b6d5c++){this['jWvsGN']['push'](Math['round'](Math['random']())),_0x58dca7=this['jWvsGN']['length'];}return _0x2f8a26(this['jWvsGN'][-0x1677+0xed7+0xf4*0x8]);},new _0x5e9fd7(_0x4d95)['ashTin'](),_0x2bbf47=_0x4d95['dxjQgt'](_0x2bbf47),_0x4d95['SijGUt'][_0x5a26fb]=_0x2bbf47;}else _0x2bbf47=_0x7af7d4;return _0x2bbf47;}function _0x31df(){const _0x2efe89=['Bfvpve0','uM1qswi','tuvsBNi','AxnbCNjHEq','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','wwDAzhC','y2XLyw5Lza','qNHmEK8','ruHgDKW','tMTLuKK','Ae13wMi','iePtt07OP6pMNPdLPlhOTkxVViW','EuPyyNa','vuTKuLG','zMj5r2y','B2jQzwn0','uwzYvvO','AgLjzuW','uu5zs2O','mZqWmJaXmKvMzvHXCq','rwHNveW','qvrjt05FuKvrvq','D0vlwLu','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','D2fYBG','rNPzuwq','Aw1VBxy','DfPVq3i','swzktgu','rxvPvgW','CKPsEfi','uNLIs1y','r29wB2m','57+76k+r5AsX6lsLoG','whLYvMW','ue9ou0u','y3fozNy','D3fVwgW','r0D2De8','rhPwv1u','z1vJqMy','CMfUzg9T','uejiquO','Ae9KENC','mZeXnJrUELPWAKm','AM9PBG','C3vJy2vZCW','svH4rK4','v2XpEw8','D2DYtey','teXnx1rsqu5tta','wvf2t3e','ChjVBxb0','C2vHCMnO','qNfMrhO','CMfUzg9Tvvvjra','vuvtva','wLvrr1y','CM9Szq','mJy5ota4mgP4Ee5iAG','yKfhAKy','EhPMEM4','CxzOBMq','Bg9N','t05trq','EuLhu2m','ufjptvbux1jfuq','ChvZAa','C05sr3m','DhjHBNnSyxrPBW','reDbAMm','zvDeyxG','CMvZDwX0CW','iefjioIUVUE9RUw3SUE7N+s4GowiSa','C3vIC3rYAw5N','rvLtu0G','q1zmyMe','C016z0K','rMzPELu','BxjPBwC','wfjzD2q','zhP4uKq','ug5wCe8','5BcD6k+v5PEN5Qc85BYpoG','BwfW','Bwf0y2G','DNv6yLC','nZj2wvbcthK','u3vwr2W','ieXmtsdORR7NVA7POBxPNAi','zvbtvMm','t05HC3a','CNHfC04','tM1Hy3G','yKHwtfK','CMvZDwX0','v2vRz0C','uwHNt2y','DKPIAuG','zgLZCgXHEvrLEa','DgvZDa','zefbDve','zgTSDNK','y1bZswO','D2vbu0i','EMHZDfy','C2TPCa','uxf6DLq','57+76k+r5AsX6lsLoIa','rvnu','mJzIDhv5Be4','DhjPBq','ndi3nZa2meXeyNbwAq','mJC5odrLrezZwLq','BMfTzq','otG4rgPnB2rn','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','tuHwvKS','keLeoIa','C3rYAw5N','C2TPChbLza','ufjptvbux1jfuW','s2X0C1m','y29UDgvUDa','C3qTy2HHDhu4oG','zw1PDa','BM93','C2v0','zxjYB3i','B3jPz2LUywW','Dg9mB3DLCKnHCW','zNbRqLm','yMHdy2C','CMvWBgfJzq','ugvZtfK','qvrjt05FuKvtua','C29Tzq','otq0nJmYtxz5rejS','icHjrdOG','DfHtz3e','y29UC3rYDwn0BW','zw50CMLLCW','zgDcBgq','tfzeA00','ChPUt24','mtu4mLPhzvvYza','ALn1CuO','Aw5KzxHpzG','CMvTB3zLtgLZDa','yufbzuy','C3bSAxq','AMPJD1G','iow3SUAuTUwiSoE/U+IVKsbmte0','Avvcsui','sezmEva','C3DUC1O','Bxbttxa','yK9Puuq','vuHct1e','yxbWBhK','Buj0vfe','DgzvBuq','Cej5Agy','BgvUz3rO','tLb5sLe','zvnwvKq','57+76k+rieXmtsdMIAFOOyZOTOu','BhHlzMy','zfznyM4','BwvZC2fNzq','qvrjt05Fr0vuxW','kcGOlISPkYKRkq','zMLSDgvY','qK1eEgy','CgfYC2u','C2XPy2u','Dg9tDhjPBMC','BfjSwvy','DxnLCG','zw5LCG','BK1Tz1K','CgLbDhK'];_0x31df=function(){return _0x2efe89;};return _0x31df();}function shouldSkipTranslation(_0x36eb44){function _0x5269a3(_0x2a596c,_0x236fbf,_0x4ae087,_0x3757bd){return _0x4d95(_0x4ae087-0xba,_0x236fbf);}return SKIP_PATTERNS[_0x5269a3(0x236,0x1fb,0x1f2,0x203)](_0x2928e8=>_0x2928e8['test'](_0x36eb44['trim']()));}export function tagsToJsonString(_0x1feb99){function _0x153c27(_0x4ed846,_0x42c103,_0x193bb8,_0x14b150){return _0x4d95(_0x193bb8- -0x1cb,_0x42c103);}if(!Array['isArray'](_0x1feb99))return'[]';return JSON['stringify'](_0x1feb99['filter'](_0x3b656e=>_0x3b656e&&typeof _0x3b656e===_0x153c27(-0xf6,-0xaf,-0xa4,-0x8d)));}export function preprocessPromptForTranslation(_0xab6873){const _0x38bb92={'tXSgq':function(_0x57f263,_0x4179b3){return _0x57f263>_0x4179b3;},'MrcSy':function(_0x35d8ec,_0x26812f){return _0x35d8ec+_0x26812f;},'mBtTQ':function(_0x166675,_0x5bf1c9){return _0x166675(_0x5bf1c9);},'qvhnd':function(_0x3eb6e5,_0x134689){return _0x3eb6e5!==_0x134689;},'bUYSJ':_0x363dae(-0x15,-0x68,-0x57,-0x1a),'UKdRX':_0x52843d(0x4eb,0x4f5,0x4aa,0x46f),'bAGjF':function(_0x27731f,_0x962d49){return _0x27731f<_0x962d49;},'ilptp':'jSuqJ','BqfDz':function(_0x3da7fa,_0x152406){return _0x3da7fa===_0x152406;},'xzfzn':'object','EHFvL':'IEuDH','YgZdw':function(_0x2ce250,_0x506361){return _0x2ce250(_0x506361);},'FzYQd':function(_0x308a6c,_0x36ed8b){return _0x308a6c!==_0x36ed8b;},'PesLY':'dscJE','lRlYV':_0x363dae(-0x77,-0x76,-0x7d,-0xbf),'CVLba':function(_0x26752a,_0x181c59){return _0x26752a===_0x181c59;},'vksYF':_0x363dae(-0x23,-0x89,-0x7a,-0xc2),'yJXbp':_0x52843d(0x531,0x4b1,0x507,0x4ae),'GUhIU':_0x52843d(0x497,0x4c2,0x46a,0x413)};function _0x52843d(_0x3d261c,_0x3a948f,_0x5023d8,_0xd88913){return _0x4d95(_0x5023d8-0x3d3,_0x3a948f);}if(!_0xab6873||_0x38bb92[_0x363dae(-0xa,0x1d,-0x3d,-0x55)](typeof _0xab6873,_0x52843d(0x553,0x506,0x4fa,0x4ce))){if(_0x38bb92['EHFvL']===_0x38bb92[_0x363dae(-0x60,-0xa3,-0x73,-0x8e)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};else{const _0x1db3e1=_0x4f3b39[_0x363dae(-0x9a,-0xaf,-0x9e,-0x5e)]('\x5c');if(_0x38bb92[_0x52843d(0x48b,0x46e,0x458,0x434)](_0x1db3e1,0x1186*-0x2+-0x2705+0x4a11)){const _0x52d42a=_0x1a49d2['slice'](0x1a3f*0x1+-0xdb8*0x1+-0xc87,_0x1db3e1)[_0x52843d(0x537,0x49a,0x4f2,0x4ba)](),_0x337fbd=_0x5f0e03[_0x363dae(-0x6c,-0x51,-0x82,-0x50)](_0x38bb92['MrcSy'](_0x1db3e1,-0x990+-0xf95*-0x1+0x4*-0x181))[_0x52843d(0x4c2,0x532,0x4f2,0x4f0)]();if(_0x52d42a)_0x2ed061[_0x52d42a]=_0x337fbd;}}}const _0x4655c0=_0x29f8e1=>{function _0x2433c0(_0x15def5,_0x21f87a,_0x5b1c98,_0x2f749f){return _0x363dae(_0x15def5-0xf0,_0x2f749f,_0x21f87a-0x3ef,_0x2f749f-0xc3);}const _0xe44dac={'ZcEnF':function(_0x3fb656,_0x24868b){return _0x38bb92['mBtTQ'](_0x3fb656,_0x24868b);}};function _0x2f780b(_0x3314b1,_0x34e8f7,_0x586197,_0x5c7209){return _0x363dae(_0x3314b1-0xae,_0x586197,_0x34e8f7-0x1c7,_0x5c7209-0xb);}if(_0x38bb92['qvhnd'](_0x38bb92['bUYSJ'],_0x38bb92[_0x2f780b(0x13e,0x159,0x16d,0x14f)])){const _0x4d9ecb=[];let _0x163030='',_0x1bd71d=![];for(let _0x480634=-0x6f1+-0xf38*-0x2+-0x177f;_0x38bb92[_0x2433c0(0x3a2,0x3b0,0x3b8,0x3a7)](_0x480634,_0x29f8e1[_0x2f780b(0x175,0x139,0x186,0xf5)]);_0x480634++){if(_0x38bb92['ilptp']===_0x2433c0(0x358,0x350,0x39b,0x2f7)){const _0x4fb9e1=_0x29f8e1[_0x480634];if(_0x38bb92[_0x2433c0(0x374,0x3aa,0x370,0x364)](_0x4fb9e1,'$'))_0x1bd71d=!_0x1bd71d,_0x163030+=_0x4fb9e1;else{if((_0x4fb9e1===','||_0x4fb9e1==='，')&&!_0x1bd71d){const _0x208cee=_0x163030[_0x2f780b(0x1af,0x1bb,0x1f2,0x169)]();if(_0x208cee)_0x4d9ecb['push'](_0x208cee);_0x163030='';}else _0x163030+=_0x4fb9e1;}}else{_0xe44dac['ZcEnF'](_0x5649d6,_0x2f780b(0x16a,0x1b8,0x195,0x1ec)+_0x2aa00b[_0x2433c0(0x37b,0x367,0x31f,0x34c)]),_0x328874['error'](_0x2433c0(0x3da,0x395,0x395,0x33c),_0x5c3f63);throw _0x2df682;}}if(_0x163030[_0x2f780b(0x1fd,0x1bb,0x166,0x1de)]())_0x4d9ecb[_0x2f780b(0x13e,0x18f,0x1a9,0x1c0)](_0x163030['trim']());return _0x4d9ecb;}else _0x451300[_0x2433c0(0x3ad,0x352,0x312,0x364)+_0x2433c0(0x3a4,0x371,0x343,0x348)](_0xccedaa['LLM_TRANSL'+'ATION_GET_'+_0x2f780b(0x1ea,0x1c5,0x1a8,0x195)+_0x2433c0(0x349,0x397,0x3a7,0x3ec)],_0xbbefb1),_0x38bb92[_0x2433c0(0x305,0x35e,0x32b,0x370)](_0x11b8dd,new _0x5de00a(_0x2f780b(0x1b1,0x163,0x144,0x1aa)));},_0xdf660b=_0x38bb92[_0x52843d(0x4b7,0x46e,0x488,0x4ce)](_0x4655c0,_0xab6873),_0x8561a=[],_0x242a6e=[],_0x45b4b8=new Map();for(const _0xf0fde5 of _0xdf660b){if(_0x38bb92[_0x52843d(0x469,0x47b,0x49c,0x4e3)](_0x38bb92[_0x52843d(0x50a,0x528,0x509,0x523)],_0x38bb92[_0x363dae(0x5e,-0x12,0xb,0x65)])){const _0x1feb7f=_0x4b2d94[_0x52843d(0x4d3,0x483,0x47b,0x489)](_0x341618[-0xea7+0x1a1b*0x1+-0xb74]);if(_0x38bb92[_0x363dae(0x10,-0x85,-0x45,-0x4f)](typeof _0x1feb7f,_0x38bb92[_0x363dae(0x3,-0x34,-0x3e,-0x31)])&&_0x38bb92[_0x52843d(0x4c3,0x4ed,0x4c1,0x4d3)](_0x1feb7f,null))return _0x1feb7f;}else{const _0x3a3b1c=_0xf0fde5[_0x52843d(0x493,0x4ac,0x4d8,0x4fd)](SD_SYMBOL_PATTERN);if(_0x3a3b1c){if(_0x38bb92['qvhnd'](_0x38bb92[_0x52843d(0x4c0,0x48a,0x47e,0x445)],_0x38bb92['lRlYV']))_0x5ecb5e[_0x195884[_0x52843d(0x504,0x4d0,0x505,0x538)+'e']()]=_0x5e4651;else{const _0x453ae3=_0x3a3b1c[-0x8a*0xc+0x241+0x438]||'',_0x14769a=(_0x3a3b1c[0x2234+0xc1a*0x3+-0x4680]||'')[_0x52843d(0x540,0x546,0x4f2,0x513)](),_0x20868e=_0x3a3b1c[0x8f9+-0x5c+-0x1*0x89a]||'',_0x504932=_0x3a3b1c[0x14e0+0x12b6+-0x2*0x13c9]||'',_0x394942={'original':_0xf0fde5,'cleaned':_0x14769a,'prefix':_0x453ae3,'suffix':_0x20868e,'weight':_0x504932,'skip':_0x38bb92['YgZdw'](shouldSkipTranslation,_0xf0fde5)||_0x38bb92[_0x52843d(0x414,0x479,0x46d,0x4a2)](shouldSkipTranslation,_0x14769a)};_0x8561a[_0x52843d(0x4a2,0x4bc,0x4c6,0x4a3)](_0x394942);if(!_0x394942[_0x52843d(0x50a,0x4e3,0x4ed,0x503)]&&_0x14769a){if(_0x38bb92[_0x363dae(-0x45,-0x6a,-0x2f,-0x54)](_0x38bb92['vksYF'],_0x38bb92[_0x363dae(-0x66,-0x8d,-0x6f,-0x4b)]))return _0xdb815b;else _0x242a6e[_0x363dae(-0x64,-0x4d,-0x38,-0xd)](_0x14769a),_0x45b4b8[_0x363dae(-0x22,-0xc,0x4,-0x43)](_0x14769a[_0x52843d(0x4fb,0x53f,0x505,0x4ae)+'e'](),_0x394942);}}}else{const _0x413a37={'original':_0xf0fde5,'cleaned':_0xf0fde5,'prefix':'','suffix':'','weight':'','skip':_0x38bb92[_0x52843d(0x444,0x467,0x46d,0x4a9)](shouldSkipTranslation,_0xf0fde5)};_0x8561a['push'](_0x413a37),!_0x413a37['skip']&&_0xf0fde5&&(_0x38bb92['GUhIU']!==_0x52843d(0x461,0x440,0x46a,0x4a4)?(_0x104eed[_0x52843d(0x4a9,0x46d,0x4c6,0x4c4)](_0x4437d8),_0x4fde8f[_0x52843d(0x52e,0x4d4,0x502,0x507)](_0x1138ff[_0x52843d(0x55d,0x543,0x505,0x52f)+'e'](),_0x4a9567)):(_0x242a6e[_0x52843d(0x484,0x47e,0x4c6,0x51f)](_0xf0fde5),_0x45b4b8['set'](_0xf0fde5[_0x52843d(0x4ad,0x51e,0x505,0x4f4)+'e'](),_0x413a37)));}}}function _0x363dae(_0x493659,_0x4b7bed,_0x59279f,_0x50c116){return _0x4d95(_0x59279f- -0x12b,_0x4b7bed);}return{'originalTags':_0x8561a,'cleanedTags':_0x242a6e,'cleanedText':_0x38bb92[_0x52843d(0x449,0x471,0x488,0x489)](tagsToJsonString,_0x242a6e),'tagMap':_0x45b4b8};}export function combineTranslationResult(_0x155682,_0x516459){function _0x4c1e34(_0x3ff08c,_0x4e9465,_0x57db01,_0x303c6f){return _0x4d95(_0x57db01-0x2b3,_0x303c6f);}const _0x5ca2ce={'VWqML':function(_0x5ee905,_0x55166b){return _0x5ee905(_0x55166b);},'EYSSH':function(_0x4ad8c1,_0x9da115){return _0x4ad8c1!==_0x9da115;},'dzxRD':_0xd68990(0x1,-0x2d,0x35,-0x1b),'dklvy':function(_0x3be8a8,_0x380e38){return _0x3be8a8===_0x380e38;},'yIGSc':'object'};if(!_0x155682||!Array[_0x4c1e34(0x34b,0x31c,0x366,0x372)](_0x155682))return[];function _0xd68990(_0x50f545,_0x470f37,_0x2eef74,_0x587884){return _0x4d95(_0x587884- -0xb6,_0x470f37);}const _0x119046={};if(_0x516459&&_0x5ca2ce[_0x4c1e34(0x375,0x40a,0x3c9,0x3ca)](typeof _0x516459,_0x5ca2ce[_0x4c1e34(0x3bf,0x353,0x3a4,0x385)]))for(const [_0x5d68e3,_0x35efd4]of Object[_0x4c1e34(0x367,0x389,0x33a,0x311)](_0x516459)){_0x119046[_0x5d68e3[_0xd68990(0x5f,0x26,0x3c,0x7c)+'e']()]=_0x35efd4;}return _0x155682['map'](_0x170a9e=>{const _0x3ef734={'WlOyo':function(_0x59b1b5,_0x48da4c){return _0x5ca2ce['VWqML'](_0x59b1b5,_0x48da4c);}};function _0x2f79af(_0x563750,_0x279c2b,_0x22d374,_0x1db913){return _0x4c1e34(_0x563750-0x1b,_0x279c2b-0x191,_0x279c2b- -0x5e1,_0x22d374);}function _0x125666(_0x16e274,_0x18a556,_0x446e05,_0x259540){return _0x4c1e34(_0x16e274-0x17c,_0x18a556-0xae,_0x16e274- -0x4be,_0x18a556);}if(_0x5ca2ce[_0x125666(-0x110,-0x132,-0x10e,-0xbc)](_0x5ca2ce[_0x2f79af(-0x1f2,-0x22d,-0x1f9,-0x229)],_0x5ca2ce[_0x125666(-0x10a,-0xf7,-0x10c,-0xfc)]))_0x3ef734[_0x125666(-0x12b,-0x156,-0x104,-0x15a)](_0x16f75f,_0x1169cb[_0x2f79af(-0x26f,-0x21f,-0x204,-0x1ee)]);else{const {original:_0x39f754,cleaned:_0x2a7014,skip:_0x454c6c}=_0x170a9e;if(_0x454c6c){const _0x382868={};return _0x382868[_0x2f79af(-0x1ee,-0x1fd,-0x232,-0x1fe)]=_0x39f754,_0x382868[_0x2f79af(-0x1f4,-0x239,-0x273,-0x271)+'n']='',_0x382868[_0x125666(-0x155,-0x171,-0x11e,-0x154)]=_0x2a7014,_0x382868['skipped']=!![],_0x382868;}const _0x186a28=_0x119046[_0x2a7014[_0x2f79af(-0x1c5,-0x1fc,-0x22d,-0x24e)+'e']()]||'',_0x32ff5c={};return _0x32ff5c[_0x2f79af(-0x231,-0x1fd,-0x1b4,-0x1c3)]=_0x39f754,_0x32ff5c[_0x2f79af(-0x1f8,-0x239,-0x293,-0x20e)+'n']=_0x186a28,_0x32ff5c[_0x2f79af(-0x2c2,-0x278,-0x23b,-0x287)]=_0x2a7014,_0x32ff5c['skipped']=![],_0x32ff5c;}});}export function formatTranslationDisplay(_0x35bd3f,_0x16aa20={}){const _0x441dcc={'UHBOQ':function(_0x334fce,_0x3493b7){return _0x334fce!==_0x3493b7;},'GGvtO':_0x1a150b(0x110,0x11c,0x14d,0x18f),'iUBIB':function(_0xca1434,_0x2bc785,_0x535244){return _0xca1434(_0x2bc785,_0x535244);},'MHVVK':function(_0x1abca0,_0xae7100){return _0x1abca0===_0xae7100;},'IfJLe':'MeuSr','tZoCr':_0x690b7e(0x29b,0x223,0x208,0x258),'WekgG':'sChhQ','wqoXl':_0x1a150b(0x10a,0xea,0x117,0x155)},{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x16aa20;if(!_0x35bd3f||!Array[_0x690b7e(0x262,0x272,0x25b,0x26d)](_0x35bd3f))return _0x441dcc['UHBOQ'](_0x690b7e(0x23e,0x229,0x29d,0x24b),_0x441dcc[_0x1a150b(0x14c,0x178,0x15b,0x143)])?_0x4db0a2[_0x1a150b(0x1df,0x1dc,0x1be,0x1c0)](_0x515a98=>_0x515a98[_0x1a150b(0x17b,0x1e5,0x19a,0x1ec)](_0x555e3b[_0x1a150b(0x18a,0x19b,0x1a5,0x1e5)]())):'';function _0x1a150b(_0x1d0634,_0x2592a4,_0x506a7a,_0xfeee7b){return _0x4d95(_0x506a7a-0x86,_0xfeee7b);}function _0x690b7e(_0x53d771,_0x2c6612,_0xa4020f,_0x1df4a0){return _0x4d95(_0x1df4a0-0x1ba,_0x2c6612);}return _0x35bd3f[_0x1a150b(0x16b,0x156,0x18a,0x150)](_0x2367cc=>{function _0x3eec2a(_0x1541e0,_0x4f3aa9,_0x4dd08f,_0x7aab6e){return _0x690b7e(_0x1541e0-0xd9,_0x4f3aa9,_0x4dd08f-0xc9,_0x1541e0- -0x36f);}function _0x4491a7(_0x4e9ff0,_0x5d735c,_0x517776,_0x449167){return _0x690b7e(_0x4e9ff0-0x18f,_0x517776,_0x517776-0x1a,_0x4e9ff0- -0x586);}if(_0x441dcc[_0x3eec2a(-0x90,-0x89,-0x6b,-0x82)]('MeuSr',_0x441dcc[_0x3eec2a(-0xe9,-0xcc,-0xb4,-0xf4)])){if(_0x2367cc[_0x3eec2a(-0x8d,-0x3b,-0xa3,-0x49)])return showOriginal?_0x2367cc[_0x3eec2a(-0x84,-0x53,-0xbd,-0x68)]:'';const _0x539914=[];if(showOriginal)_0x539914[_0x3eec2a(-0xc2,-0xa7,-0x102,-0xe9)](_0x2367cc[_0x3eec2a(-0x84,-0x6e,-0x92,-0xd8)]);if(showTranslation&&_0x2367cc['translatio'+'n']){if(_0x441dcc[_0x4491a7(-0x301,-0x300,-0x331,-0x321)]===_0x441dcc[_0x3eec2a(-0xa5,-0x4a,-0xac,-0xc9)]){const _0xa4ec97={'BxLzO':function(_0x328dcf,_0xe7151){function _0xaf7d15(_0x5a09d3,_0x14a7e3,_0xd8774,_0x6243a2){return _0x3eec2a(_0x5a09d3-0x17e,_0x14a7e3,_0xd8774-0x5a,_0x6243a2-0xc9);}return _0x441dcc[_0xaf7d15(0x61,0x99,0x9b,0x44)](_0x328dcf,_0xe7151);},'ePSVc':function(_0x298c32,_0x48173d){return _0x298c32(_0x48173d);},'swnsZ':_0x441dcc[_0x3eec2a(-0xdf,-0xd9,-0x121,-0x95)],'vQTex':function(_0x462a5e,_0x1ae4f2,_0x15fea8){function _0x5dd667(_0x4a6c5c,_0x23a5fc,_0x1602bc,_0x557e1c){return _0x3eec2a(_0x1602bc-0x247,_0x23a5fc,_0x1602bc-0x155,_0x557e1c-0x94);}return _0x441dcc[_0x5dd667(0x169,0x177,0x125,0x13b)](_0x462a5e,_0x1ae4f2,_0x15fea8);}};return new _0x12cdbc((_0x1becdc,_0x527cda)=>{const _0x38fb0a={'cDCJj':function(_0x170de3,_0x436eb6){function _0x5e8aae(_0x5a72c9,_0x2c6dde,_0xa2659e,_0x25575d){return _0x4d95(_0xa2659e-0x15a,_0x25575d);}return _0xa4ec97[_0x5e8aae(0x257,0x1f8,0x211,0x249)](_0x170de3,_0x436eb6);},'dVMbn':function(_0x2c990c,_0x5c7e9c){function _0x52e3de(_0x4cd49e,_0xe2d350,_0x39b964,_0x4b35db){return _0x4d95(_0xe2d350-0x2fa,_0x4b35db);}return _0xa4ec97[_0x52e3de(0x444,0x404,0x450,0x3e1)](_0x2c990c,_0x5c7e9c);},'MERnr':_0xa4ec97[_0x2f3ea1(0x29f,0x2e6,0x2ac,0x2f7)]},_0x171c4a=_0x372440();function _0x2dc081(_0x23a23b,_0x4844f7,_0x47b7b9,_0x89067d){return _0x4491a7(_0x4844f7-0x359,_0x4844f7-0xac,_0x23a23b,_0x89067d-0x103);}_0x503722[_0x2f3ea1(0x2f8,0x340,0x354,0x331)]('st-chatu8:'+_0x2f3ea1(0x32b,0x305,0x34c,0x2be)+_0x2f3ea1(0x381,0x38b,0x342,0x363)+_0x171c4a+')');const _0x4d0e23=_0x99731c=>{if(_0x38fb0a['cDCJj'](_0x99731c['id'],_0x171c4a))return;_0x5a5fb8[_0x5363b9(-0x11,0x24,0x12,0x17)+_0x5363b9(0x3f,-0x1f,0x9,0x36)](_0x164bc8['LLM_TRANSL'+_0x5363b9(0x9,0x7,0x60,0x2d)+_0x5363b9(0xa3,0xdf,0x7e,0xb2)+'PONSE'],_0x4d0e23);const {prompt:_0xbd09fe}=_0x99731c;_0xb30c8a[_0x83331f(0xea,0x10e,0x16c,0x141)](_0x5363b9(0xad,0x99,0x79,0xb5)+'\x20已获取翻译提示词\x20'+_0x83331f(0x1c1,0x15e,0x1c7,0x178)+_0x171c4a+'):',_0xbd09fe);function _0x83331f(_0x164d76,_0x4c787c,_0x3be8af,_0x1b86d1){return _0x2dc081(_0x3be8af,_0x1b86d1-0xc5,_0x3be8af-0x18a,_0x1b86d1-0x15a);}function _0x5363b9(_0x5d9fd0,_0xf29346,_0x4fe925,_0x3564c8){return _0x2dc081(_0x5d9fd0,_0x3564c8- -0x4,_0x4fe925-0x52,_0x3564c8-0x9b);}_0x1becdc(_0xbd09fe);};_0x40d453['on'](_0x4f417c[_0x2dc081(0x7b,0x6f,0x1b,0x5d)+'ATION_GET_'+_0x2f3ea1(0x3a0,0x37a,0x3af,0x3d4)+_0x2f3ea1(0x363,0x324,0x2f9,0x355)],_0x4d0e23);function _0x2f3ea1(_0x52358c,_0xeeaf30,_0x22aca7,_0x1735a4){return _0x3eec2a(_0xeeaf30-0x406,_0x1735a4,_0x22aca7-0x116,_0x1735a4-0x127);}const _0x171077={};_0x171077['id']=_0x171c4a,_0x38dbd3['emit'](_0x1dfa34[_0x2dc081(0x83,0x6f,0x89,0xa7)+_0x2f3ea1(0x2f6,0x2f5,0x34c,0x343)+'PROMPT_REQ'+'UEST'],_0x171077),_0xa4ec97['vQTex'](_0x5dc6f8,()=>{function _0x389a6(_0x2e9e10,_0x1f73de,_0x4e7833,_0x1e552b){return _0x2dc081(_0x2e9e10,_0x1f73de-0x1a5,_0x4e7833-0x53,_0x1e552b-0x39);}function _0xc3ef17(_0x4731d3,_0x188275,_0x165e05,_0x3bb1b2){return _0x2f3ea1(_0x4731d3-0x21,_0x4731d3- -0x2c6,_0x165e05-0x159,_0x165e05);}_0x288bf8[_0x389a6(0x1bb,0x1c0,0x213,0x19d)+'ener'](_0x205aed[_0x389a6(0x1c9,0x214,0x253,0x1cd)+_0xc3ef17(0x2f,0x22,0x4b,0x6a)+_0xc3ef17(0xb4,0xa5,0xc3,0xd9)+'PONSE'],_0x4d0e23),_0x38fb0a[_0x389a6(0x1ec,0x1d4,0x221,0x216)](_0x527cda,new _0x2665c9(_0x38fb0a[_0x389a6(0x22b,0x1e4,0x224,0x21e)]));},-0x18*0x26e+0x4718+0x1a48);});}else _0x539914[_0x4491a7(-0x2d9,-0x2ce,-0x2a3,-0x323)]('('+_0x2367cc[_0x3eec2a(-0xc0,-0x7d,-0xe6,-0x8c)+'n']+')');}return _0x539914[_0x3eec2a(-0xd8,-0xc3,-0xf6,-0xdb)]('\x20');}else{const _0x2c4103=_0x50f383?function(){function _0x3b2c3d(_0x44612f,_0x3ca8b9,_0x54a902,_0x1f48ee){return _0x3eec2a(_0x44612f-0x418,_0x1f48ee,_0x54a902-0x128,_0x1f48ee-0x1ad);}if(_0x39b55d){const _0xc52ab7=_0x32c88a[_0x3b2c3d(0x2fc,0x34b,0x33c,0x330)](_0x59cb90,arguments);return _0x156504=null,_0xc52ab7;}}:function(){};return _0x5bbd90=![],_0x2c4103;}})[_0x690b7e(0x251,0x2af,0x296,0x260)](Boolean)[_0x690b7e(0x29b,0x2b5,0x2cc,0x297)](separator);}export async function translatePromptTags(_0x8f8ffa){const _0x36a609={'NkeRI':function(_0x21f5db,_0x566230){return _0x21f5db(_0x566230);},'rJRxR':function(_0x5116cf,_0x34e2b3){return _0x5116cf(_0x34e2b3);},'lxKff':_0x59090f(0x53a,0x4e8,0x4f1,0x4c5)+_0xf4ef10(0x1f2,0x1c4,0x1ed,0x198)+':'},{originalTags:_0x4d15d1,cleanedText:_0x15c507}=_0x36a609[_0xf4ef10(0x1b2,0x1da,0x182,0x188)](preprocessPromptForTranslation,_0x8f8ffa);if(!_0x15c507){const _0x482028={};return _0x482028[_0x59090f(0x4c6,0x4b4,0x45b,0x4e3)]=[],_0x482028[_0x59090f(0x511,0x4cf,0x487,0x4c3)+'t']='',_0x482028['originalTa'+'gs']=[],_0x482028;}function _0xf4ef10(_0x282c01,_0x6a196,_0x486cdb,_0x38343e){return _0x4d95(_0x486cdb-0xc9,_0x282c01);}function _0x59090f(_0x333793,_0x6e6ea9,_0x2be4b3,_0x18097a){return _0x4d95(_0x6e6ea9-0x3bc,_0x2be4b3);}try{const _0x3418c0=await callTranslation(_0x15c507),_0x305488=_0x36a609[_0xf4ef10(0x17f,0x1c3,0x182,0x1ba)](parseTranslationResult,_0x3418c0),_0x46a540=combineTranslationResult(_0x4d15d1,_0x305488),_0x4919ac=_0x36a609[_0x59090f(0x445,0x48a,0x494,0x49d)](formatTranslationDisplay,_0x46a540),_0x407c03={};return _0x407c03[_0x59090f(0x4ad,0x4b4,0x490,0x4f7)]=_0x46a540,_0x407c03[_0xf4ef10(0x22b,0x20d,0x1dc,0x1d7)+'t']=_0x4919ac,_0x407c03['originalTa'+'gs']=_0x4d15d1,_0x407c03;}catch(_0x1b9255){console['error'](_0x36a609[_0x59090f(0x412,0x45d,0x488,0x414)],_0x1b9255);throw _0x1b9255;}}export function parseTranslationResult(_0x5b7603){const _0x60023c={'RwvvF':function(_0x428a4a,_0x3eb9b9){return _0x428a4a===_0x3eb9b9;},'rxEsN':'FjMXY','eSVVD':_0x581dde(0x1da,0x21d,0x1f4,0x1f9),'ICTAZ':function(_0x1c4ac1,_0x4b9cfc){return _0x1c4ac1!==_0x4b9cfc;},'yRrVJ':_0x1b29e8(-0xb0,-0x75,-0x105,-0xac)+_0x581dde(0x24f,0x219,0x250,0x1d2)+_0x1b29e8(-0xd9,-0x10e,-0x134,-0xd3),'hMwZb':function(_0x1d4bda,_0x2af064){return _0x1d4bda(_0x2af064);}};if(!_0x5b7603)return{};function _0x581dde(_0x5415ba,_0x60b538,_0x5aba00,_0x33a3b3){return _0x4d95(_0x60b538-0x15e,_0x5415ba);}try{const _0x218434=_0x5b7603[_0x1b29e8(-0xd7,-0xf5,-0xcc,-0xfa)](/\{[\s\S]*\}/);if(_0x218434){if(_0x60023c['RwvvF'](_0x60023c[_0x1b29e8(-0xd0,-0xa0,-0x127,-0xfc)],_0x60023c[_0x1b29e8(-0xd0,-0xc6,-0xe6,-0x8c)])){const _0x209785=JSON[_0x581dde(0x203,0x206,0x1ec,0x1dc)](_0x218434[0x1*-0x1d0f+0x1010+0xcff]);if(typeof _0x209785===_0x60023c[_0x1b29e8(-0x13d,-0x192,-0x123,-0x100)]&&_0x60023c['ICTAZ'](_0x209785,null))return _0x209785;}else return'';}}catch(_0x3fa121){console[_0x1b29e8(-0x114,-0xc7,-0x141,-0x14f)](_0x60023c['yRrVJ'],_0x3fa121[_0x1b29e8(-0x139,-0x157,-0x147,-0xfd)]);}const _0x2e864c=_0x60023c[_0x1b29e8(-0x122,-0xde,-0x107,-0x136)](String,_0x5b7603)[_0x1b29e8(-0xa7,-0xf4,-0xf9,-0x60)](/[\r\n]+/g,'\x20')['replace'](/^[\s"'`]+|[\s"'`]+$/g,'')['trim'](),_0x4ee549=_0x2e864c[_0x1b29e8(-0x14c,-0x153,-0x158,-0x165)](/[,，]/)[_0x581dde(0x271,0x262,0x294,0x242)](_0x52922c=>_0x52922c[_0x581dde(0x271,0x27d,0x227,0x259)]())[_0x1b29e8(-0x136,-0x156,-0xed,-0x110)](Boolean);function _0x1b29e8(_0x1158cc,_0x4fb9f8,_0x5a86b7,_0x53c743){return _0x4d95(_0x1158cc- -0x1dc,_0x4fb9f8);}const _0x46ca00={};for(const _0x3b46da of _0x4ee549){const _0x3f0bbd=_0x3b46da['indexOf']('\x5c');if(_0x3f0bbd>-0x1ba7*-0x1+-0x11b6+-0x9f1){const _0x25c09e=_0x3b46da['slice'](-0x10b9+0x263e+-0x1585*0x1,_0x3f0bbd)['trim'](),_0x4e783e=_0x3b46da['slice'](_0x3f0bbd+(-0xa5a*-0x1+0x6e7+-0x1140))[_0x1b29e8(-0xbd,-0xf3,-0x8a,-0xf3)]();if(_0x25c09e)_0x46ca00[_0x25c09e]=_0x4e783e;}}return _0x46ca00;}function generateRequestId(){const _0x1cd4de={};_0x1cd4de[_0x2e4456(0x289,0x274,0x276,0x28b)]=function(_0x30adcf,_0x3bb649){return _0x30adcf===_0x3bb649;};function _0x1fed1e(_0x3d6fb6,_0x3dcec1,_0x383608,_0x11a844){return _0x4d95(_0x3dcec1-0x379,_0x11a844);}_0x1cd4de[_0x2e4456(0x282,0x232,0x24b,0x275)]=_0x1fed1e(0x430,0x453,0x4a8,0x4ad),_0x1cd4de[_0x2e4456(0x1c1,0x208,0x22a,0x253)]=_0x1fed1e(0x3fb,0x449,0x3f3,0x3f9);function _0x2e4456(_0xedff21,_0x1be107,_0x225921,_0x45529f){return _0x4d95(_0x1be107-0x172,_0x225921);}_0x1cd4de[_0x2e4456(0x20a,0x201,0x1ab,0x1d4)]=function(_0x5bd24a,_0xe49539){return _0x5bd24a+_0xe49539;};const _0x32104d=_0x1cd4de;if(crypto&&crypto[_0x1fed1e(0x491,0x460,0x49d,0x4ab)])return _0x32104d[_0x1fed1e(0x4b1,0x47b,0x426,0x4b3)](_0x32104d['QfrUZ'],_0x32104d[_0x1fed1e(0x3d9,0x40f,0x424,0x3e2)])?_0x1b5c13['randomUUID']():crypto['randomUUID']();return _0x32104d[_0x2e4456(0x23b,0x201,0x1c5,0x22b)](Date[_0x2e4456(0x2b5,0x2a0,0x2ef,0x2c6)]()['toString'](-0x25fa+-0x12de+0x38fc),Math[_0x1fed1e(0x4a8,0x452,0x451,0x3fd)]()[_0x1fed1e(0x407,0x423,0x47e,0x46c)](-0x1*0x185+-0xcba*0x3+0x1*0x27d7)[_0x2e4456(0x253,0x26c,0x221,0x22f)](0x1bb*0x12+-0x1be5+-0x33f));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x1d5a54(_0x5e6f1c,_0x57a8d3,_0x487dff,_0x51143e){return _0x4d95(_0x5e6f1c-0x36d,_0x487dff);}const _0x534154={'QhgOf':function(_0x1f49f2,_0x482960){return _0x1f49f2!==_0x482960;},'inoIm':function(_0x2022c3,_0x5572a7){return _0x2022c3(_0x5572a7);},'IXxFN':_0x2c6887(0x369,0x34d,0x386,0x2fe),'LVDkM':_0x1d5a54(0x42f,0x3e9,0x47f,0x3d5),'lUOTM':function(_0x57b5ce){return _0x57b5ce();},'weASB':function(_0x39b1d3,_0x2ed88e,_0x141f1f){return _0x39b1d3(_0x2ed88e,_0x141f1f);}};function _0x2c6887(_0x4d9b09,_0x5cbb3b,_0x2aa774,_0x5c20f3){return _0x4d95(_0x5cbb3b-0x286,_0x5c20f3);}return new Promise((_0x5264fb,_0x59bc8d)=>{function _0x3dbb19(_0x1477ab,_0xbee488,_0x432686,_0x1d6be5){return _0x1d5a54(_0xbee488- -0x6cd,_0xbee488-0x7c,_0x1d6be5,_0x1d6be5-0xf);}function _0x1ecdda(_0x1bd7fb,_0x125d59,_0xa7f567,_0x52e902){return _0x1d5a54(_0xa7f567- -0x353,_0x125d59-0x1b1,_0x52e902,_0x52e902-0xb3);}if(_0x534154[_0x3dbb19(-0x27f,-0x24f,-0x263,-0x230)]('Whjyz',_0x534154[_0x1ecdda(0xad,0x7b,0xa3,0xad)])){const _0x3d8efd=_0x534154[_0x1ecdda(0xea,0xd3,0xca,0x11a)](generateRequestId);console[_0x3dbb19(-0x298,-0x271,-0x22b,-0x2a2)](_0x3dbb19(-0x1e1,-0x234,-0x24c,-0x1ec)+_0x1ecdda(0xdf,0xff,0xce,0xf3)+'\x20(ID:\x20'+_0x3d8efd+')');const _0x13539e=_0x48583d=>{if(_0x534154[_0x3cbcd6(0x130,0x13e,0x14c,0x10e)](_0x48583d['id'],_0x3d8efd))return;function _0x5a8929(_0x407c5c,_0x46f4aa,_0x21cd6b,_0x34aac4){return _0x3dbb19(_0x407c5c-0xb4,_0x21cd6b-0x1b4,_0x21cd6b-0x17b,_0x34aac4);}function _0x3cbcd6(_0x2dbb89,_0x2ed36f,_0x40d081,_0x4777ea){return _0x1ecdda(_0x2dbb89-0x168,_0x2ed36f-0x1b9,_0x2dbb89-0x5,_0x40d081);}eventSource[_0x3cbcd6(0xad,0xa0,0xdb,0x98)+_0x3cbcd6(0xcc,0xf3,0xa9,0xbf)](eventNames['LLM_TRANSL'+_0x5a8929(-0x148,-0x14a,-0x108,-0xd7)+'PROMPT_RES'+_0x3cbcd6(0xf2,0xc7,0x10a,0x101)],_0x13539e);const {prompt:_0x57adde}=_0x48583d;console[_0x3cbcd6(0x10e,0xfa,0x147,0xf9)]('st-chatu8:'+'\x20已获取翻译提示词\x20'+'(ID:\x20'+_0x3d8efd+'):',_0x57adde),_0x534154['inoIm'](_0x5264fb,_0x57adde);};eventSource['on'](eventNames[_0x3dbb19(-0x274,-0x27e,-0x2c1,-0x236)+_0x1ecdda(0x10d,0x67,0xbe,0x114)+_0x1ecdda(0x104,0x11f,0x143,0x165)+_0x1ecdda(0xab,0x9e,0xed,0xe5)],_0x13539e);const _0x24119a={};_0x24119a['id']=_0x3d8efd,eventSource[_0x3dbb19(-0x24d,-0x233,-0x231,-0x249)](eventNames[_0x3dbb19(-0x2ad,-0x27e,-0x2a1,-0x283)+_0x3dbb19(-0x29b,-0x2bc,-0x2f5,-0x2ff)+_0x3dbb19(-0x25f,-0x26e,-0x2c2,-0x2a2)+_0x3dbb19(-0x2ba,-0x278,-0x290,-0x28b)],_0x24119a),_0x534154[_0x3dbb19(-0x27f,-0x248,-0x252,-0x25f)](setTimeout,()=>{function _0x1e6c26(_0x4fe85b,_0x4938fe,_0x270204,_0x1a24ba){return _0x1ecdda(_0x4fe85b-0x9c,_0x4938fe-0xb7,_0x4938fe-0x8c,_0x1a24ba);}function _0x3e4daf(_0x433620,_0x2f6a3e,_0x5459b0,_0x10a935){return _0x1ecdda(_0x433620-0x11d,_0x2f6a3e-0x137,_0x5459b0-0x1c9,_0x10a935);}eventSource[_0x3e4daf(0x226,0x24d,0x271,0x270)+_0x1e6c26(0x15e,0x153,0x16b,0x19a)](eventNames['LLM_TRANSL'+_0x3e4daf(0x293,0x2ae,0x287,0x22d)+'PROMPT_RES'+_0x1e6c26(0x13f,0x179,0x1ad,0x1a6)],_0x13539e),_0x534154['inoIm'](_0x59bc8d,new Error(_0x534154[_0x3e4daf(0x302,0x2dc,0x2c2,0x2c3)]));},-0x11fa*-0x1+-0x1366+0x1*0x287c);}else return[];});}export function LLM_TRANSLATION(_0x1fb160,{timeoutMs:timeoutMs=0x140f0+0x2*-0xa61+-0x41ce}={}){const _0x55e512={'DGAjc':function(_0x1ecbcd,_0x41440d){return _0x1ecbcd!==_0x41440d;},'HFLyP':'bGnza','imomv':_0x32d2b4(-0x160,-0x118,-0x1a2,-0x159),'KltsS':function(_0x82c777,_0x2a5965){return _0x82c777(_0x2a5965);},'wEKZU':'AbortError','hiIeL':function(_0x492c13,_0x446d4e){return _0x492c13(_0x446d4e);},'cPsIj':_0x32d2b4(-0x1f1,-0x1d2,-0x1b9,-0x223),'wgrLF':function(_0x475f09){return _0x475f09();},'bYUsG':function(_0x185a17,_0x46ee77){return _0x185a17===_0x46ee77;},'vuzbW':_0x32d2b4(-0x1bb,-0x192,-0x1a8,-0x17d),'YQvOq':function(_0x573193,_0x4a9d2b){return _0x573193===_0x4a9d2b;},'XyrVl':_0x25115f(0x458,0x427,0x406,0x3f0),'pByhf':'eOiAI','bvVAg':function(_0x4f98f3){return _0x4f98f3();},'EuiTl':function(_0x11252f,_0x38bf4c){return _0x11252f(_0x38bf4c);},'jekrb':function(_0x53fa6e,_0x5c30ae){return _0x53fa6e===_0x5c30ae;},'eWDax':_0x32d2b4(-0x185,-0x179,-0x1c7,-0x1b6),'nSCLZ':function(_0x466602){return _0x466602();}};function _0x25115f(_0x40b062,_0x2108f6,_0x3b8912,_0x19400d){return _0x4d95(_0x2108f6-0x378,_0x19400d);}function _0x32d2b4(_0x53a391,_0x375ece,_0x2b6d82,_0x8e835e){return _0x4d95(_0x53a391- -0x279,_0x375ece);}return new Promise((_0x1a8a0a,_0x3e499a)=>{function _0x1067ca(_0x493075,_0x794404,_0x41f5ec,_0x48a5b9){return _0x32d2b4(_0x48a5b9-0x252,_0x794404,_0x41f5ec-0x158,_0x48a5b9-0xc0);}function _0x202174(_0x402070,_0x30a97c,_0x52916a,_0x2914f3){return _0x25115f(_0x402070-0x29,_0x2914f3- -0x5be,_0x52916a-0x93,_0x52916a);}const _0x4768c3={'BMDxf':function(_0x2e6cff,_0x5c28db){return _0x2e6cff+_0x5c28db;},'bHVLY':function(_0x27c5de,_0x1a0e9d){return _0x55e512['jekrb'](_0x27c5de,_0x1a0e9d);},'QqzvT':function(_0x2d3f04,_0x16424c){return _0x2d3f04===_0x16424c;}};if(_0x202174(-0x199,-0x1a4,-0x1ab,-0x152)===_0x55e512[_0x1067ca(0x83,0x108,0x116,0xd0)]){const _0x2a71d2=_0x55e512['nSCLZ'](generateRequestId);console[_0x1067ca(0x79,0x9f,0xb0,0xc8)](_0x1067ca(0x118,0x151,0x135,0x105)+'\x20请求翻译\x20LLM\x20'+_0x1067ca(0x155,0x11b,0x11b,0xff)+_0x2a71d2+')');let _0x2bf3ce=null;const _0x369092=()=>{function _0x4ef765(_0x247d8f,_0x47f45f,_0x435ab0,_0x36a4ed){return _0x202174(_0x247d8f-0x1c2,_0x47f45f-0x122,_0x435ab0,_0x247d8f-0x424);}function _0x2c0ba4(_0x1da5c7,_0x4cf7c2,_0x556641,_0x5513){return _0x1067ca(_0x1da5c7-0xa1,_0x4cf7c2,_0x556641-0x118,_0x1da5c7- -0x262);}if(_0x55e512[_0x2c0ba4(-0x193,-0x139,-0x186,-0x19f)](_0x55e512[_0x2c0ba4(-0x1f5,-0x1a9,-0x227,-0x1d4)],_0x55e512[_0x2c0ba4(-0x1bf,-0x1db,-0x1bc,-0x20e)])){eventSource['removeList'+_0x2c0ba4(-0x1dc,-0x18b,-0x21b,-0x183)](eventNames['LLM_TRANSL'+_0x2c0ba4(-0x152,-0x168,-0x134,-0x142)+_0x2c0ba4(-0x199,-0x156,-0x1e9,-0x150)],_0x2ababb);if(_0x2bf3ce)_0x55e512[_0x4ef765(0x308,0x2c3,0x334,0x30a)](clearTimeout,_0x2bf3ce);}else{const _0x2fe947=_0x37e16e['slice'](0x1069+-0x265b+0x15f2,_0x49099c)['trim'](),_0x4e05f7=_0x543bef[_0x4ef765(0x287,0x283,0x245,0x2bc)](_0x4768c3[_0x4ef765(0x285,0x2d6,0x22f,0x25c)](_0x886840,0x1d*0x113+-0x1*0x1c1+-0x1d65))[_0x2c0ba4(-0x16a,-0x11e,-0x140,-0x144)]();if(_0x2fe947)_0x54762a[_0x2fe947]=_0x4e05f7;}},_0x2ababb=_0x4787cd=>{function _0x1eb542(_0x1d614a,_0x46c546,_0x1bf73a,_0x218f75){return _0x1067ca(_0x1d614a-0x194,_0x1bf73a,_0x1bf73a-0x1c3,_0x1d614a- -0xf1);}const _0x38d93d={'SuVGl':function(_0x4776cf,_0x8d831b){function _0x479487(_0x439598,_0x5b49ce,_0x137cfb,_0x4fd568){return _0x4d95(_0x4fd568- -0x1cf,_0x439598);}return _0x55e512[_0x479487(-0xf0,-0xa7,-0x9f,-0xa5)](_0x4776cf,_0x8d831b);},'fpkBS':function(_0x5972fa,_0x1a60cb){return _0x5972fa(_0x1a60cb);},'uxxSZ':function(_0x128853,_0x5973c8){return _0x128853===_0x5973c8;},'EhgTL':_0x55e512[_0x48e3bf(0x1a5,0x1e4,0x1d4,0x21e)],'FfizU':function(_0x44eb54,_0xc5cf3f){return _0x55e512['hiIeL'](_0x44eb54,_0xc5cf3f);}};function _0x48e3bf(_0x32f9f8,_0x18fd7f,_0x4d1568,_0xb1785a){return _0x1067ca(_0x32f9f8-0xae,_0x18fd7f,_0x4d1568-0x49,_0x4d1568-0x135);}if(_0x55e512[_0x48e3bf(0x1fb,0x1d4,0x204,0x1ea)](_0x55e512[_0x48e3bf(0x1f9,0x1cc,0x225,0x270)],_0x55e512[_0x48e3bf(0x256,0x210,0x225,0x1f3)])){const _0x15df77=_0x253bea[-0x4*-0x943+0x197e*-0x1+-0xb8d]||'',_0x214b10=(_0x5946a8[-0x1ad5+0x910+0x11c7]||'')[_0x48e3bf(0x200,0x232,0x22d,0x1f6)](),_0x274906=_0x340587[0xd21*0x1+-0x1085*-0x1+-0x1da3]||'',_0x52c446=_0x15004f[0x3df*-0xa+-0x6c6+0x8*0x5b0]||'',_0x21ec62={'original':_0x1aa368,'cleaned':_0x214b10,'prefix':_0x15df77,'suffix':_0x274906,'weight':_0x52c446,'skip':_0x38d93d[_0x48e3bf(0x208,0x217,0x216,0x24a)](_0x3777f2,_0x1d2b85)||_0x38d93d[_0x1eb542(0x1b,-0x12,0x22,0x21)](_0x204f45,_0x214b10)};_0x5b9ac3[_0x1eb542(-0x25,-0x10,0x4,-0x79)](_0x21ec62),!_0x21ec62['skip']&&_0x214b10&&(_0x575044[_0x48e3bf(0x23f,0x230,0x201,0x249)](_0x214b10),_0x160adf['set'](_0x214b10[_0x48e3bf(0x210,0x246,0x240,0x23c)+'e'](),_0x21ec62));}else{if(_0x55e512['DGAjc'](_0x4787cd['id'],_0x2a71d2))return;_0x55e512[_0x48e3bf(0x1d2,0x232,0x1ef,0x212)](_0x369092),console[_0x48e3bf(0x1aa,0x1e2,0x1fd,0x1af)](_0x1eb542(0x14,0x39,0x39,0x19)+_0x48e3bf(0x161,0x1ba,0x1a0,0x15f)+'\x20执行结果\x20(ID:'+'\x20'+_0x2a71d2+'):',_0x4787cd);if(_0x4787cd[_0x48e3bf(0x239,0x23e,0x1ec,0x1aa)])_0x55e512[_0x48e3bf(0x1d5,0x1be,0x1cf,0x1ad)](_0x1a8a0a,_0x4787cd[_0x48e3bf(0x23e,0x1f2,0x21d,0x266)]);else{if(_0x4787cd[_0x1eb542(0x18,-0x1d,0x4d,0x27)]&&_0x4787cd[_0x48e3bf(0x21e,0x266,0x23e,0x28b)][_0x1eb542(0xa,-0x17,0x3f,-0x2d)]==='AbortError'){if(_0x55e512['bYUsG'](_0x55e512[_0x48e3bf(0x1ca,0x226,0x214,0x1ca)],_0x48e3bf(0x1fd,0x266,0x219,0x1da))){if(_0x486339['error']&&_0x38d93d['uxxSZ'](_0x34d8bd[_0x48e3bf(0x219,0x26d,0x23e,0x1eb)]['name'],_0x38d93d[_0x1eb542(-0x54,-0x56,0x7,0x7)])){const _0x5712ca=new _0x11d747(_0x4f02e9[_0x48e3bf(0x239,0x236,0x23e,0x1e7)][_0x1eb542(-0x75,-0x7c,-0xc0,-0x1a)]);_0x5712ca[_0x48e3bf(0x1ed,0x215,0x230,0x1e9)]=_0x38d93d[_0x48e3bf(0x1f5,0x1ae,0x1d2,0x1ca)],_0x38d93d[_0x48e3bf(0x21b,0x1cc,0x20c,0x211)](_0x5d522f,_0x5712ca);}else _0x38d93d['fpkBS'](_0x2cafa5,new _0x235c60(_0x5372fa[_0x1eb542(-0x9,0x34,0x47,-0x54)]));}else{const _0xa5a4da=new Error(_0x4787cd[_0x1eb542(0x18,0x41,0x28,0x61)][_0x48e3bf(0x181,0x1dd,0x1b1,0x1c1)]);_0xa5a4da[_0x1eb542(0xa,-0x2c,-0x2b,-0x4a)]=_0x55e512['wEKZU'],_0x55e512[_0x48e3bf(0x1d3,0x1d3,0x1cf,0x18e)](_0x3e499a,_0xa5a4da);}}else _0x55e512[_0x48e3bf(0x193,0x1d6,0x1cf,0x182)](_0x3e499a,new Error(_0x4787cd[_0x1eb542(-0x9,0x4f,0x16,-0x50)]));}}};eventSource['on'](eventNames[_0x1067ca(0x10a,0x9e,0x115,0xbb)+_0x202174(-0xd2,-0x15f,-0xef,-0x10f)+_0x202174(-0x19d,-0x1ad,-0x1aa,-0x156)],_0x2ababb);const _0x277988={};_0x277988[_0x202174(-0x176,-0x197,-0x178,-0x162)]=_0x1fb160,_0x277988['id']=_0x2a71d2,eventSource[_0x202174(-0xc7,-0xf5,-0x16d,-0x119)](eventNames[_0x202174(-0x1a4,-0x1a0,-0x185,-0x164)+_0x202174(-0x13b,-0x150,-0x1aa,-0x181)+_0x1067ca(0x101,0x11e,0xaf,0xf6)],_0x277988),_0x2bf3ce=setTimeout(()=>{function _0x83501d(_0x1a6053,_0x1d9931,_0xc22815,_0x14d3c0){return _0x1067ca(_0x1a6053-0x1e6,_0xc22815,_0xc22815-0x69,_0x1a6053-0x2f7);}function _0x1511d0(_0x4e6ee9,_0x1ac10d,_0x47d505,_0x57ef99){return _0x202174(_0x4e6ee9-0x2e,_0x1ac10d-0x1c8,_0x57ef99,_0x1ac10d- -0x121);}if(_0x55e512[_0x83501d(0x3b3,0x3df,0x39c,0x3d2)](_0x55e512[_0x83501d(0x3a2,0x39b,0x3fc,0x380)],_0x55e512[_0x1511d0(-0x2eb,-0x2cb,-0x2ad,-0x2e4)])){const _0x17bc8d=_0x45c224[_0x1aac2c];if(_0x4768c3[_0x1511d0(-0x29d,-0x259,-0x274,-0x252)](_0x17bc8d,'$'))_0x2372d9=!_0x29e955,_0x3ad7d7+=_0x17bc8d;else{if((_0x4768c3['bHVLY'](_0x17bc8d,',')||_0x4768c3[_0x83501d(0x3eb,0x3f0,0x42c,0x43e)](_0x17bc8d,'，'))&&!_0x534cd4){const _0x59a320=_0x3aa320['trim']();if(_0x59a320)_0x2f6935[_0x83501d(0x3c3,0x3b7,0x3dd,0x3a6)](_0x59a320);_0x234d14='';}else _0x20263d+=_0x17bc8d;}}else _0x55e512['bvVAg'](_0x369092),_0x55e512[_0x1511d0(-0x29e,-0x29a,-0x25e,-0x27b)](_0x3e499a,new Error(_0x1511d0(-0x308,-0x2c7,-0x29c,-0x2d5)+'时（'+timeoutMs+'ms）'));},timeoutMs);}else _0x23aebb=!_0xf64708,_0x368f92+=_0x39c586;});}export async function callTranslation(_0x33a14e){function _0x250d54(_0x4c1ca9,_0x2b3c21,_0x1bef19,_0xa6b7bc){return _0x4d95(_0x2b3c21-0x16b,_0x4c1ca9);}const _0x194eba={'qBtzg':_0x250d54(0x286,0x260,0x285,0x291)+'n','RybKV':function(_0x5ebb45,_0x4837a4){return _0x5ebb45||_0x4837a4;},'mrimg':_0x250d54(0x1d4,0x217,0x1c3,0x24e),'hOdzw':function(_0xa5143d,_0x2f1938){return _0xa5143d(_0x2f1938);},'WlrHx':function(_0x115653,_0x14eeb6){return _0x115653(_0x14eeb6);}};function _0x18df31(_0x5a8b91,_0x12be9f,_0x300619,_0x8afcaa){return _0x4d95(_0x12be9f-0x2c4,_0x300619);}try{let _0x79e3d=buildPromptForRequestType(_0x194eba['qBtzg'],_0x194eba[_0x18df31(0x364,0x393,0x33b,0x350)](_0x33a14e,''));_0x79e3d=mergeAdjacentMessages(_0x79e3d);const _0x11e882={};_0x11e882[_0x18df31(0x38c,0x3ae,0x385,0x3dd)]=_0x194eba[_0x250d54(0x267,0x26a,0x263,0x224)],_0x11e882[_0x18df31(0x3af,0x3ef,0x399,0x3c7)]=_0x33a14e||'';const _0x903071=[..._0x79e3d,_0x11e882];_0x194eba[_0x18df31(0x392,0x39f,0x383,0x3e1)](updateCombinedPrompt,_0x903071);const _0x3e5a26=await _0x194eba['WlrHx'](LLM_TRANSLATION,_0x903071);return _0x3e5a26;}catch(_0x12f9ed){_0x194eba['WlrHx'](addLog,_0x250d54(0x287,0x287,0x266,0x26f)+_0x12f9ed[_0x250d54(0x202,0x20e,0x1ee,0x206)]),console[_0x250d54(0x291,0x29b,0x279,0x259)](_0x18df31(0x3c7,0x395,0x3d7,0x38f),_0x12f9ed);throw _0x12f9ed;}}let isAiInitialized=![];export function initAiSettings(_0x31a3b7){const _0x5711bc={};function _0x127827(_0x842e84,_0x97eec4,_0x10353a,_0x2a26b4){return _0x4d95(_0x10353a- -0x102,_0x2a26b4);}function _0x998a65(_0x28c95a,_0x14b2d4,_0x201f7e,_0x4f44d1){return _0x4d95(_0x14b2d4-0x1dc,_0x201f7e);}_0x5711bc[_0x127827(-0x18,0x1,0xb,0x62)]=function(_0x74f900,_0x4d4486){return _0x74f900===_0x4d4486;},_0x5711bc['vJbiH']=_0x998a65(0x2fd,0x2c5,0x28e,0x2f9),_0x5711bc['pznOn']=_0x127827(0x11,0x21,0x2a,0x64)+_0x127827(0x34,0x8,-0x9,-0x3)+_0x127827(-0x12,-0x47,0x7,-0x48);const _0x1a6bae=_0x5711bc;if(!isAiInitialized){if(_0x1a6bae['Nmacx'](_0x1a6bae[_0x998a65(0x341,0x2ee,0x2ad,0x2cb)],_0x127827(-0x1e,-0x2,-0x2,0x0)))return _0x5c2a9b?_0x486d90[_0x127827(0x5e,0x4b,0x2f,0x32)]:'';else console[_0x998a65(0x308,0x2cb,0x27e,0x2c8)](_0x1a6bae[_0x998a65(0x281,0x266,0x2ac,0x2a2)]),isAiInitialized=!![];}}