(function(_0x2a0b80,_0x1526d3){function _0x392381(_0x4362cf,_0x467c95,_0x511ec8,_0x499701){return _0x4ac0(_0x467c95- -0x2e8,_0x511ec8);}const _0x2a158a=_0x2a0b80();function _0x5275da(_0x29a009,_0x4b472e,_0x5361f7,_0x21eed6){return _0x4ac0(_0x21eed6- -0x330,_0x29a009);}while(!![]){try{const _0x1ea6b5=parseInt(_0x392381(-0xe4,-0xb2,-0xa8,-0x8c))/(0x16df+-0x2a5*0x2+-0x1194)+-parseInt(_0x392381(-0x46,-0x7d,-0x39,-0xac))/(-0x2cf+0x19*0x14f+-0x1de6)*(-parseInt(_0x392381(-0x7a,-0xce,-0x9c,-0x98))/(-0x1b28+-0x24ff+-0x56*-0xbf))+parseInt(_0x392381(-0x29,-0x86,-0xb5,-0xb1))/(-0x149*-0x19+0x185*-0x3+-0x1b8e*0x1)*(parseInt(_0x5275da(-0x123,-0x120,-0xcd,-0x11a))/(0x1*0x1d87+-0x6*0x494+-0x105*0x2))+-parseInt(_0x5275da(-0xe3,-0xec,-0x126,-0xcd))/(0x1*-0x1c34+-0x31c*0xa+0x3b52)+-parseInt(_0x5275da(-0xda,-0x178,-0x171,-0x12c))/(-0xd04+0x2375+-0x166a)+parseInt(_0x5275da(-0xbd,-0x152,-0xb2,-0xf9))/(0x45*-0x68+-0x15a2+-0x18d9*-0x2)+parseInt(_0x5275da(-0xc0,-0x108,-0x9e,-0xd0))/(-0x1*0x3ef+0x157*-0x7+0xd59)*(-parseInt(_0x392381(-0x8a,-0xa5,-0x51,-0xa5))/(-0xd2b+-0x77b*-0x2+-0x1c1));if(_0x1ea6b5===_0x1526d3)break;else _0x2a158a['push'](_0x2a158a['shift']());}catch(_0x68c08d){_0x2a158a['push'](_0x2a158a['shift']());}}}(_0x3fc4,-0x90a56+0x2ed23+0x1*0xab791));const _0x16343b=(function(){function _0x59febe(_0x415e20,_0x1144e,_0x48bd30,_0x565f05){return _0x4ac0(_0x1144e- -0x2a3,_0x48bd30);}const _0x1f762a={};_0x1f762a['wJntM']='eWsWN',_0x1f762a['cjtWF']=_0x59febe(-0x2a,-0x44,0x3,-0x27);const _0x3be150=_0x1f762a;let _0x59dc2d=!![];return function(_0xdac78a,_0x74c560){function _0x56cf6d(_0x468622,_0x23ef34,_0x430966,_0x579f94){return _0x59febe(_0x468622-0x1a,_0x430966-0xb9,_0x468622,_0x579f94-0x116);}function _0x37c931(_0x3507ba,_0x502cad,_0x23230f,_0x142a62){return _0x59febe(_0x3507ba-0x1c7,_0x142a62-0x47,_0x502cad,_0x142a62-0x99);}if(_0x3be150[_0x37c931(0x79,0x60,0x1d,0x2f)]!==_0x3be150[_0x37c931(0x54,0x12,0x28,0x31)]){const _0x5e6878=_0x59dc2d?function(){function _0xb83eec(_0x2667a1,_0x8194fb,_0x1fbbbf,_0x394b74){return _0x56cf6d(_0x8194fb,_0x8194fb-0x90,_0x394b74-0x63,_0x394b74-0x11c);}if(_0x74c560){const _0x178358=_0x74c560[_0xb83eec(0x15a,0xc2,0x102,0x117)](_0xdac78a,arguments);return _0x74c560=null,_0x178358;}}:function(){};return _0x59dc2d=![],_0x5e6878;}else{if(_0x331958['skipped'])return _0x468e9d?_0x32b3eb[_0x37c931(0x7,0x2d,0x27,0x23)]:'';const _0x210ed3=[];if(_0x40ce76)_0x210ed3[_0x37c931(-0x67,-0x7c,-0xc2,-0x6a)](_0x4a4d10[_0x37c931(0x4a,-0xc,0x5c,0x23)]);return _0x25e45b&&_0x24fc67[_0x56cf6d(0x1e,0x30,0x2e,-0x6)+'n']&&_0x210ed3[_0x37c931(-0x8b,-0x1e,-0x1c,-0x6a)]('('+_0x42d2d0[_0x37c931(-0x46,-0x1e,-0x8f,-0x44)+'n']+')'),_0x210ed3[_0x37c931(-0x71,-0x7c,0x37,-0x22)]('\x20');}};}()),_0x3591bc=_0x16343b(this,function(){function _0x196a3c(_0x59229d,_0x27e4d8,_0x320256,_0x420b2c){return _0x4ac0(_0x59229d-0x167,_0x320256);}const _0x328e7d={};_0x328e7d[_0x406d69(0x121,0x152,0x102,0xd8)]=_0x196a3c(0x3d9,0x3b0,0x3bf,0x3a5)+'+$';const _0x48aceb=_0x328e7d;function _0x406d69(_0x24b2e5,_0x52e090,_0x48f004,_0x367315){return _0x4ac0(_0x48f004- -0x14b,_0x52e090);}return _0x3591bc['toString']()[_0x406d69(0x83,0xa2,0xc8,0xfe)]('(((.+)+)+)'+'+$')[_0x196a3c(0x354,0x33c,0x34e,0x367)]()[_0x196a3c(0x353,0x313,0x365,0x370)+'r'](_0x3591bc)['search'](_0x48aceb['SYPtx']);});_0x3591bc();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x42326e){function _0x24832c(_0x573baf,_0x128b5a,_0x28549a,_0x510a34){return _0x4ac0(_0x510a34- -0x38e,_0x573baf);}function _0x1b7f8c(_0x1701ad,_0x5cbeb2,_0x2ea518,_0x216e20){return _0x4ac0(_0x5cbeb2-0xb6,_0x2ea518);}return SKIP_PATTERNS[_0x24832c(-0xe3,-0xb1,-0x109,-0x10d)](_0x4cddd1=>_0x4cddd1[_0x1b7f8c(0x292,0x2b4,0x27d,0x2f2)](_0x42326e[_0x1b7f8c(0x35d,0x30e,0x356,0x339)]()));}function _0x3fc4(){const _0x13c703=['uxfIs0K','qKHgyNK','teXnx1rsqu5tta','vgrouMS','y090CuK','mtbNz29jsLe','tvnXDeS','vfbjENi','D2jwAwm','tfv1BMe','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','reXkD1i','B0LcyK4','uNrsqvu','CuLJreu','u1LqDhG','B0fsEMm','veHszNq','quzLqxq','57+76k+rieXmtsdMIAFOOyZOTOu','CMvZDwX0CW','z3HIC2G','r2PTENe','wvnouLi','B2Trre0','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','DhjPBq','C2TPCa','A0DlBxi','uhftBMK','BwT3tKG','CMfUzg9Tvvvjra','DufXvuy','we1Lrey','ndeXodCWnLDqww1rzW','C3qTy2HHDhu4oG','nejZzuvzEa','ntqZmdeYv0fMt0fo','CMLStNm','t05trq','C2TPChbLza','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','BKjty0e','C3bSAxq','A2DZvxG','nZK2mduWEvL5AfLr','CKrYCfC','DMLRr2C','vxPiswW','zgLZCgXHEvrLEa','zLvxwKq','C3rYAw5N','kcGOlISPkYKRkq','suPjuee','zgn6BMK','BxpVViK','DvrxwKm','wwTeAe0','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','DxnLCG','vNreDeW','ioAjP+IHJoE7K+AENcaOsuq6','sNbNqK4','qwjVCNrfCNjVCG','vuLMCxC','B3jPz2LUywW','Eef0r3y','C29Tzq','Aw5KzxHpzG','ufjptvbux1jfuW','shfhv00','Bwf0y2G','uxLeDuG','BhHgCwi','shLywwO','wfnwz0O','r0nrDLe','D0PUDe0','t2rVyKK','y2P0v0y','y2XLyw5Lza','CMvWBgfJzq','zNHJEhe','Bg9N','ieXmtsdORR7NVA7POBxPNAi','tvjXtKK','ChjVBxb0','ELPiv1C','v1nsChe','ruf5y1i','zw1PDa','ioIVT+AXGUE/U+IVKsbmte0G','A2PSy0y','uw53qNO','zw50CMLLCW','D2fYBG','yxbWBhK','v0nrrui','C3vJy2vZCW','wNnkBKC','C2v0','D25esha','BgTwvwq','qxjkAKq','y29UC3rYDwn0BW','Dg9tDhjPBMC','uuL6uLm','BgvUz3rO','B2jQzwn0','zxjYB3i','ChvZAa','vuvtva','zwjOv1C','BMfTzq','AMLzsgC','Dvj1D3C','zunYrgC','CvjbB1K','B0fxzhu','zNjhuu8','rvnu','vuLQEuO','DgvZDa','uKL5Cwy','zMLSDgvY','AuzWsKe','CwPoyuG','C0XSBxO','mJqXnde2n3H3qMrktq','Dg9mB3DLCKnHCW','vxbYBee','yKHNCxi','EeDWq0O','qvrjt05FuKvrvq','rMfHzwq','zK5tyLi','t3D0B3y','uKHOy28','vLrZz00','C3vIC3rYAw5N','vhHLA0C','ywTmzwm','ufjptvbux1jfuq','C2vHCMnO','yLnwyKm','C2XPy2u','mJeYmZuZnwnkrKLfwG','A0nNqxi','DhjHBNnSyxrPBW','sMXHzhi','m2jYAhHtvG','CMvZDwX0','iePtt07OP6pMNPdLPlhOTkxVViW','AxnbCNjHEq','AKXHwgu','qvrjt05Fr0vuxW','iow3SUAuTUwiSoE/U+IVKsbmte0','5BcD6k+v5PEN5Qc85BYpoG','r0zSC1m','tvndzhe','tvDZzxa','qvrjt05FuKvtua','DgT0txq','keLeoIa','B3jPz2LUywXuyq','EeDAAuO','57+76k+r5AsX6lsLoIa','CMrMr3m','ue9ou0u','iefjioIUVUE9RUw3SUE7N+s4GowiSa','t0jjB3q','wMzgsgS','vuPezeW','CuHhr3y','DhnXrMm','57+76k+r5AsX6lsLoG','zw5LCG','icHjrdOG','mtyZodmZzNzMA3r5','mty2ndKXmKn1ANbVBq','CMvTB3zLtgLZDa','BwfW','AM9PBG','BwvZC2fNzq','sefgquq','C3rYAw5NAwz5'];_0x3fc4=function(){return _0x13c703;};return _0x3fc4();}export function tagsToJsonString(_0x30b36c){function _0x18d55c(_0xbce9f,_0x1ea698,_0x34e386,_0x3db06e){return _0x4ac0(_0xbce9f-0x2,_0x1ea698);}function _0x37dd6f(_0x2783e7,_0x59490a,_0x35049f,_0x23a3a7){return _0x4ac0(_0x23a3a7- -0x2a0,_0x35049f);}if(!Array['isArray'](_0x30b36c))return'[]';return JSON[_0x37dd6f(-0xbd,-0x57,-0x4c,-0x63)](_0x30b36c[_0x37dd6f(-0x92,-0xb8,-0xc3,-0xa0)](_0x15cad5=>_0x15cad5&&typeof _0x15cad5===_0x37dd6f(0x12,-0x8a,0x25,-0x2f)));}export function preprocessPromptForTranslation(_0x443f09){const _0x2b6f7b={'WCQEB':function(_0x51368f,_0x16c6e4){return _0x51368f<_0x16c6e4;},'UIjyJ':function(_0x649cfc,_0xfbdfe1){return _0x649cfc===_0xfbdfe1;},'OMyYn':function(_0x1f80a8,_0x5eeb71){return _0x1f80a8===_0x5eeb71;},'okQDM':function(_0x335c41,_0xd63861){return _0x335c41+_0xd63861;},'iFpJA':function(_0x4860df,_0x58b34e){return _0x4860df!==_0x58b34e;},'yMYtK':_0x7c16a9(0x191,0x111,0x14b,0x118),'kgsUx':_0x7c16a9(0xce,0x12a,0x116,0x137),'fNSbR':_0x7c16a9(0x1a1,0x1b3,0x164,0x178),'HyXYj':function(_0x29d4b7,_0x293121){return _0x29d4b7(_0x293121);},'SibAO':_0x33f894(-0x12,-0x31,0x18,-0x2),'OdobI':_0x33f894(0x82,0x50,-0x18,0x31),'MSCdq':function(_0x5517ca,_0x3734ed){return _0x5517ca!==_0x3734ed;},'ebhWW':_0x7c16a9(0xf7,0xb2,0xe1,0xb1),'VtDtL':function(_0x6fc6e,_0x5bf1ac){return _0x6fc6e(_0x5bf1ac);}};function _0x7c16a9(_0x5c6256,_0x3aa174,_0x4059af,_0x2bfece){return _0x4ac0(_0x4059af- -0x126,_0x2bfece);}if(!_0x443f09||_0x2b6f7b[_0x33f894(-0x2a,0x38,-0x12,-0x18)](typeof _0x443f09,_0x2b6f7b['yMYtK'])){if(_0x2b6f7b[_0x33f894(0x2c,0x1a,0x9d,0x51)]!==_0x2b6f7b[_0x7c16a9(0x8c,0x113,0xe5,0xa9)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};else{const _0x56bba3=_0x4d4809[_0x33f894(0x5a,0xf,0x48,0x3f)]();if(_0x56bba3)_0x4d5663['push'](_0x56bba3);_0x4caa5a='';}}const _0x4c205a=_0x5ede25=>{function _0x1a0d3a(_0x370eea,_0x5d9a79,_0x57d383,_0x3b22b3){return _0x33f894(_0x370eea,_0x5d9a79-0xa4,_0x57d383-0x1c6,_0x57d383-0x5db);}const _0x44bd6d=[];let _0x1e1053='',_0x4b2824=![];for(let _0x50d137=0xb9f+0x1834+-0x3fb*0x9;_0x2b6f7b[_0x550442(0x544,0x598,0x588,0x57b)](_0x50d137,_0x5ede25[_0x550442(0x4e7,0x51f,0x4d8,0x4e6)]);_0x50d137++){const _0x5287c4=_0x5ede25[_0x50d137];if(_0x2b6f7b['UIjyJ'](_0x5287c4,'$'))_0x4b2824=!_0x4b2824,_0x1e1053+=_0x5287c4;else{if((_0x2b6f7b['OMyYn'](_0x5287c4,',')||_0x2b6f7b[_0x1a0d3a(0x61c,0x5d8,0x5bf,0x5fa)](_0x5287c4,'，'))&&!_0x4b2824){const _0x13b5bd=_0x1e1053[_0x550442(0x517,0x573,0x541,0x55e)]();if(_0x13b5bd)_0x44bd6d[_0x1a0d3a(0x573,0x57d,0x5b4,0x5e3)](_0x13b5bd);_0x1e1053='';}else _0x1e1053+=_0x5287c4;}}if(_0x1e1053[_0x550442(0x59b,0x4f7,0x541,0x561)]())_0x44bd6d[_0x550442(0x4eb,0x515,0x4db,0x492)](_0x1e1053[_0x550442(0x59e,0x522,0x541,0x55e)]());function _0x550442(_0x4cdfbd,_0x1cff4d,_0xbae77b,_0x5abc49){return _0x33f894(_0x4cdfbd,_0x1cff4d-0x14b,_0xbae77b-0x74,_0xbae77b-0x502);}return _0x44bd6d;},_0x33b662=_0x2b6f7b[_0x33f894(0x26,0xbe,0x8d,0x6f)](_0x4c205a,_0x443f09),_0x7c1848=[],_0x997335=[],_0x1a0531=new Map();function _0x33f894(_0x4ed5a4,_0x4e6f90,_0x1e82de,_0x2622f1){return _0x4ac0(_0x2622f1- -0x219,_0x4ed5a4);}for(const _0x24d97b of _0x33b662){const _0x45d179=_0x24d97b['match'](SD_SYMBOL_PATTERN);if(_0x45d179){if(_0x2b6f7b['iFpJA'](_0x2b6f7b['SibAO'],_0x2b6f7b[_0x33f894(0x5d,0xce,0x28,0x73)])){const _0x39ec26=_0x45d179[-0x1f6*0x1+0xf7d+-0xd86]||'',_0x1d5ad8=(_0x45d179[0x88*-0x2c+0x23b8+-0xc56]||'')['trim'](),_0x313720=_0x45d179[0x1952*0x1+-0x17*0xd+0x19c*-0xf]||'',_0x2895bf=_0x45d179[-0x1*0x267d+-0x14d1+0x3b52]||'',_0x19bb64={'original':_0x24d97b,'cleaned':_0x1d5ad8,'prefix':_0x39ec26,'suffix':_0x313720,'weight':_0x2895bf,'skip':_0x2b6f7b[_0x33f894(0xa6,0x49,0x2f,0x6f)](shouldSkipTranslation,_0x24d97b)||shouldSkipTranslation(_0x1d5ad8)};_0x7c1848['push'](_0x19bb64),!_0x19bb64[_0x7c16a9(0xee,0xf0,0x133,0xd7)]&&_0x1d5ad8&&(_0x997335[_0x33f894(-0x64,0x21,-0x1f,-0x27)](_0x1d5ad8),_0x1a0531[_0x33f894(-0x59,-0x76,-0xc,-0x31)](_0x1d5ad8[_0x33f894(0x12,0x0,-0x2b,-0x14)+'e'](),_0x19bb64));}else{const _0x23e45b=_0x26f558[_0x33f894(0x53,-0x34,-0x5f,-0x4)](0x242b+0x187a+-0xcf*0x4b,_0x19859b)[_0x33f894(0x64,0x4c,0x5d,0x3f)](),_0x2b8f6d=_0x11a6ae['slice'](_0x2b6f7b[_0x33f894(0x81,0x15,0x8,0x3d)](_0x2c4401,0x1*-0x20a1+0xbbc*-0x1+0x2c5e))[_0x7c16a9(0x151,0x11c,0x132,0x122)]();if(_0x23e45b)_0x2c2e83[_0x23e45b]=_0x2b8f6d;}}else{const _0x26bef7={'original':_0x24d97b,'cleaned':_0x24d97b,'prefix':'','suffix':'','weight':'','skip':_0x2b6f7b[_0x33f894(0x84,0x3a,0xab,0x6f)](shouldSkipTranslation,_0x24d97b)};_0x7c1848['push'](_0x26bef7);if(!_0x26bef7['skip']&&_0x24d97b){if(_0x2b6f7b[_0x33f894(0x67,0x3c,-0x35,0xa)](_0x2b6f7b[_0x7c16a9(0x7c,0x110,0xce,0xb1)],_0x7c16a9(0xf3,0x108,0xdc,0xd2)))_0x997335[_0x7c16a9(0xe5,0xc2,0xcc,0xd9)](_0x24d97b),_0x1a0531['set'](_0x24d97b[_0x33f894(0x43,0xb,-0x6f,-0x14)+'e'](),_0x26bef7);else{if(!_0x1efcf6[_0x33f894(-0x4c,-0x2e,-0x24,0x4)](_0x3b45ef))return'[]';return _0x130628['stringify'](_0x3d4f80[_0x7c16a9(0xe2,0xfa,0xda,0x10f)](_0x410c42=>_0x410c42&&typeof _0x410c42===_0x7c16a9(0xf4,0xf6,0x14b,0x138)));}}}}return{'originalTags':_0x7c1848,'cleanedTags':_0x997335,'cleanedText':_0x2b6f7b[_0x7c16a9(0x1ad,0x18f,0x154,0x1a1)](tagsToJsonString,_0x997335),'tagMap':_0x1a0531};}export function combineTranslationResult(_0x32a64c,_0x962c1d){if(!_0x32a64c||!Array['isArray'](_0x32a64c))return[];function _0x25bbaf(_0x486bd2,_0x45316d,_0x27e6a0,_0x5c11e9){return _0x4ac0(_0x5c11e9- -0x5f,_0x45316d);}const _0x369da7={};if(_0x962c1d&&typeof _0x962c1d===_0x1cfe24(0x294,0x285,0x25b,0x294))for(const [_0x22b273,_0x5b7cb4]of Object[_0x1cfe24(0x306,0x331,0x368,0x346)](_0x962c1d)){_0x369da7[_0x22b273['toLowerCas'+'e']()]=_0x5b7cb4;}function _0x1cfe24(_0x4b712f,_0x1ae731,_0x261f43,_0x2bc262){return _0x4ac0(_0x1ae731-0x95,_0x2bc262);}return _0x32a64c[_0x25bbaf(0x1aa,0x1bc,0x1dd,0x1da)](_0x41c720=>{const {original:_0x4ef09c,cleaned:_0x485555,skip:_0x439531}=_0x41c720;if(_0x439531){const _0x1bb228={};return _0x1bb228[_0xd374f3(0xd3,0x10f,0x10e,0x107)]=_0x4ef09c,_0x1bb228[_0x445634(0x1fd,0x1f6,0x251,0x243)+'n']='',_0x1bb228[_0x445634(0x258,0x26c,0x278,0x215)]=_0x485555,_0x1bb228[_0xd374f3(0xba,0xca,0x61,0xee)]=!![],_0x1bb228;}const _0x13e887=_0x369da7[_0x485555[_0xd374f3(0x59,0x86,0x4c,0x14)+'e']()]||'',_0x17732f={};function _0xd374f3(_0x5434c2,_0x3b60ab,_0x24edae,_0xe01320){return _0x1cfe24(_0x5434c2-0x9f,_0x5434c2- -0x241,_0x24edae-0x38,_0x24edae);}function _0x445634(_0x534e41,_0x2c7a0f,_0x529b28,_0x1a0d71){return _0x1cfe24(_0x534e41-0x2d,_0x2c7a0f- -0xb7,_0x529b28-0x11c,_0x1a0d71);}return _0x17732f[_0x445634(0x222,0x25d,0x21a,0x2ac)]=_0x4ef09c,_0x17732f[_0xd374f3(0x6c,0x3c,0x2d,0xbd)+'n']=_0x13e887,_0x17732f[_0x445634(0x2ab,0x26c,0x262,0x26d)]=_0x485555,_0x17732f['skipped']=![],_0x17732f;});}export function formatTranslationDisplay(_0x5d5145,_0x18f6dc={}){const _0x5812fb={};_0x5812fb[_0x311522(0x33a,0x35d,0x33f,0x389)]=function(_0xca41a3,_0x5a1748){return _0xca41a3!==_0x5a1748;},_0x5812fb['GFlsS']='eCrDg',_0x5812fb[_0x22c2e0(-0x31,-0x14,0x1b,0x24)]=function(_0x69b401,_0x165bb4){return _0x69b401===_0x165bb4;},_0x5812fb[_0x22c2e0(-0x39,0xf,0x23,0x36)]=_0x311522(0x323,0x33e,0x335,0x30d),_0x5812fb[_0x311522(0x36f,0x339,0x37b,0x3ab)]=function(_0xd9fca0,_0x1ad992){return _0xd9fca0!==_0x1ad992;},_0x5812fb['UJDdL']=_0x311522(0x337,0x3e3,0x393,0x379);function _0x311522(_0xb983e2,_0x2772b3,_0x42b3a4,_0x245371){return _0x4ac0(_0x42b3a4-0x12f,_0xb983e2);}_0x5812fb[_0x311522(0x357,0x3b9,0x38a,0x359)]='ZwUHi';const _0x29d0a0=_0x5812fb,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x18f6dc;function _0x22c2e0(_0x2e6ec1,_0x3e8cca,_0x1ff7a3,_0x5cf333){return _0x4ac0(_0x3e8cca- -0x222,_0x2e6ec1);}if(!_0x5d5145||!Array[_0x22c2e0(0x22,-0x5,0x38,0x3b)](_0x5d5145))return _0x29d0a0[_0x311522(0x3a3,0x33e,0x37b,0x331)](_0x29d0a0[_0x22c2e0(-0x2b,0xe,-0x37,0x30)],_0x29d0a0[_0x311522(0x3da,0x3ca,0x38a,0x361)])?'':_0x15e24a[_0x311522(0x3b6,0x3be,0x38c,0x360)]();return _0x5d5145[_0x311522(0x379,0x366,0x368,0x311)](_0x2ac7ad=>{function _0x5b26b6(_0x21046e,_0x296d6b,_0x6f40b4,_0x52bb48){return _0x311522(_0x6f40b4,_0x296d6b-0x119,_0x296d6b- -0x150,_0x52bb48-0x1b1);}function _0x3b7737(_0x2a6e67,_0x45d2ab,_0x1e81cb,_0x476fd0){return _0x311522(_0x45d2ab,_0x45d2ab-0x1d4,_0x2a6e67- -0x111,_0x476fd0-0x1cf);}if(_0x29d0a0[_0x3b7737(0x22e,0x239,0x21c,0x27f)](_0x5b26b6(0x21d,0x1d7,0x1c8,0x21b),_0x29d0a0[_0x5b26b6(0x25a,0x201,0x1a4,0x253)]))return'';else{if(_0x2ac7ad[_0x5b26b6(0x22e,0x245,0x27b,0x298)]){if(_0x29d0a0[_0x3b7737(0x22c,0x24e,0x21b,0x280)](_0x29d0a0[_0x5b26b6(0x1c9,0x210,0x26a,0x1f7)],_0x3b7737(0x224,0x1d1,0x1e6,0x1ef)))return showOriginal?_0x2ac7ad[_0x3b7737(0x29d,0x2f4,0x299,0x2f7)]:'';else{if(_0x16866f){const _0x14148b=_0x5e63e7[_0x3b7737(0x2bc,0x283,0x26a,0x2b9)](_0x41ad2b,arguments);return _0x3dd73b=null,_0x14148b;}}}const _0x28abd8=[];if(showOriginal)_0x28abd8['push'](_0x2ac7ad[_0x5b26b6(0x21c,0x25e,0x289,0x234)]);return showTranslation&&_0x2ac7ad['translatio'+'n']&&_0x28abd8[_0x5b26b6(0x1a5,0x1d1,0x20b,0x219)]('('+_0x2ac7ad[_0x3b7737(0x236,0x288,0x1da,0x25e)+'n']+')'),_0x28abd8[_0x3b7737(0x258,0x1ff,0x204,0x28e)]('\x20');}})[_0x311522(0x335,0x307,0x32f,0x342)](Boolean)[_0x22c2e0(-0x28,0x18,0x10,-0x13)](separator);}export async function translatePromptTags(_0x1fff7f){const _0x4971ed={'UIfqw':_0x183444(0x4d6,0x4fa,0x4d9,0x4fa)+_0x3cd4f4(0x2b8,0x2bd,0x298,0x289)+_0x183444(0x507,0x542,0x51f,0x52e),'xGZiJ':function(_0x3230de,_0x14a973){return _0x3230de(_0x14a973);},'RIyqf':function(_0x106238,_0x3951c2){return _0x106238===_0x3951c2;},'MWsep':function(_0x397808,_0x49c0a1){return _0x397808(_0x49c0a1);},'JpgBN':function(_0x50da75,_0x174375){return _0x50da75!==_0x174375;},'LUuna':_0x3cd4f4(0x2e1,0x307,0x2fd,0x2d2),'rdfGs':_0x3cd4f4(0x2ed,0x2f1,0x2fb,0x303)+_0x3cd4f4(0x30d,0x2e7,0x2cb,0x341)+':'},{originalTags:_0x5e13e6,cleanedText:_0x134da2}=_0x4971ed['xGZiJ'](preprocessPromptForTranslation,_0x1fff7f);if(!_0x134da2){if(_0x4971ed[_0x3cd4f4(0x296,0x28f,0x2e4,0x2a4)](_0x3cd4f4(0x2ca,0x2c2,0x309,0x27c),_0x3cd4f4(0x2d9,0x2c2,0x2c9,0x27c))){const _0xd4b1ae={};return _0xd4b1ae[_0x3cd4f4(0x2e2,0x2e2,0x2ef,0x2b9)]=[],_0xd4b1ae[_0x3cd4f4(0x31f,0x2ff,0x350,0x2aa)+'t']='',_0xd4b1ae[_0x3cd4f4(0x28a,0x2b8,0x2ed,0x2b7)+'gs']=[],_0xd4b1ae;}else _0x5b52b3[_0x183444(0x467,0x49b,0x493,0x439)]('('+_0x51bac7[_0x3cd4f4(0x2d9,0x2a8,0x26a,0x2d6)+'n']+')');}function _0x3cd4f4(_0x757396,_0x15e9b7,_0x141a4a,_0x1ff07c){return _0x4ac0(_0x15e9b7-0x90,_0x1ff07c);}function _0x183444(_0x5d4515,_0x16edc,_0x300165,_0x974dbb){return _0x4ac0(_0x5d4515-0x275,_0x300165);}try{const _0x1fd192=await _0x4971ed[_0x183444(0x49e,0x4ab,0x45b,0x455)](callTranslation,_0x134da2),_0x40379c=parseTranslationResult(_0x1fd192),_0x14a1b5=combineTranslationResult(_0x5e13e6,_0x40379c),_0x2c47fc=_0x4971ed[_0x3cd4f4(0x2cc,0x2b4,0x2f6,0x2ed)](formatTranslationDisplay,_0x14a1b5),_0xbac031={};return _0xbac031[_0x183444(0x4c7,0x484,0x4ad,0x4fd)]=_0x14a1b5,_0xbac031[_0x3cd4f4(0x2c0,0x2ff,0x2d5,0x2e1)+'t']=_0x2c47fc,_0xbac031[_0x183444(0x49d,0x45a,0x4f5,0x4d4)+'gs']=_0x5e13e6,_0xbac031;}catch(_0x2b421f){if(_0x4971ed[_0x183444(0x4f1,0x50b,0x54e,0x51e)](_0x4971ed[_0x3cd4f4(0x326,0x2d7,0x2f9,0x2fa)],_0x4971ed[_0x3cd4f4(0x2ec,0x2d7,0x288,0x2b2)]))!_0x41d93c&&(_0x2d7895[_0x183444(0x506,0x4d5,0x504,0x4e2)](_0x4971ed[_0x183444(0x4f3,0x503,0x511,0x534)]),_0x3ae038=!![]);else{console[_0x3cd4f4(0x2b6,0x281,0x2ab,0x284)](_0x4971ed[_0x3cd4f4(0x2eb,0x2bb,0x2bb,0x2bd)],_0x2b421f);throw _0x2b421f;}}}export function parseTranslationResult(_0x4955a7){const _0x2c9ecc={};_0x2c9ecc['oARzc']=function(_0xd84190,_0x4858d5){return _0xd84190===_0x4858d5;},_0x2c9ecc[_0x3ab3da(0x4af,0x537,0x516,0x4e1)]=_0x3ab3da(0x598,0x5a3,0x52f,0x549),_0x2c9ecc[_0x5a13f3(0x30f,0x3b8,0x361,0x327)]=_0x3ab3da(0x5b3,0x503,0x534,0x55b)+_0x3ab3da(0x4dd,0x4c7,0x4ff,0x516)+_0x3ab3da(0x4fa,0x4f7,0x545,0x51b);function _0x3ab3da(_0x5ce6b7,_0x13cede,_0x24fcff,_0x2b6733){return _0x4ac0(_0x2b6733-0x2fa,_0x24fcff);}_0x2c9ecc[_0x3ab3da(0x52a,0x51b,0x547,0x4f5)]=function(_0x448a17,_0x566268){return _0x448a17>_0x566268;};function _0x5a13f3(_0x33f80b,_0xf6fe94,_0x2986c9,_0x1a2e27){return _0x4ac0(_0x2986c9-0xee,_0x1a2e27);}_0x2c9ecc[_0x3ab3da(0x572,0x509,0x529,0x566)]=function(_0x332dc4,_0x1ff42a){return _0x332dc4+_0x1ff42a;};const _0x4f5666=_0x2c9ecc;if(!_0x4955a7)return{};try{const _0x27039a=_0x4955a7[_0x3ab3da(0x564,0x549,0x5d5,0x57f)](/\{[\s\S]*\}/);if(_0x27039a){const _0x8721b0=JSON['parse'](_0x27039a[-0x515*-0x1+0x31f+-0x2a*0x32]);if(_0x4f5666[_0x5a13f3(0x324,0x346,0x33c,0x2e5)](typeof _0x8721b0,_0x5a13f3(0x2d8,0x312,0x2de,0x2d6))&&_0x8721b0!==null)return _0x8721b0;}}catch(_0x2e32b6){if(_0x4f5666[_0x5a13f3(0x304,0x324,0x2d5,0x2f6)]!==_0x4f5666['ZsJnG']){const _0x554967={};return _0x554967[_0x5a13f3(0x3c1,0x392,0x36d,0x33b)]=_0x7cd0af,_0x554967[_0x3ab3da(0x55f,0x4ee,0x54a,0x512)+'n']='',_0x554967[_0x5a13f3(0x397,0x3b1,0x37c,0x36c)]=_0x5a2d88,_0x554967[_0x5a13f3(0x356,0x30f,0x354,0x388)]=!![],_0x554967;}else console['warn'](_0x4f5666[_0x5a13f3(0x34a,0x307,0x361,0x337)],_0x2e32b6[_0x3ab3da(0x4ff,0x525,0x536,0x535)]);}const _0x58e405=String(_0x4955a7)['replace'](/[\r\n]+/g,'\x20')[_0x5a13f3(0x388,0x335,0x37d,0x3cc)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x5a13f3(0x34e,0x346,0x346,0x322)](),_0x1b73a8=_0x58e405[_0x3ab3da(0x5be,0x5ba,0x518,0x563)](/[,，]/)['map'](_0x22cb0c=>_0x22cb0c['trim']())['filter'](Boolean),_0x2b7ed5={};for(const _0x3e82c8 of _0x1b73a8){const _0x593cdd=_0x3e82c8[_0x5a13f3(0x375,0x3a8,0x370,0x39e)]('\x5c');if(_0x4f5666[_0x5a13f3(0x2e8,0x2b1,0x2e9,0x30a)](_0x593cdd,0x57a+-0x120c+0xc92)){const _0x2e77af=_0x3e82c8[_0x5a13f3(0x2ec,0x338,0x303,0x358)](-0x5cf+-0x8e8*-0x1+-0x319,_0x593cdd)[_0x3ab3da(0x4f6,0x4fd,0x543,0x552)](),_0x37d02c=_0x3e82c8[_0x5a13f3(0x2c6,0x2cf,0x303,0x323)](_0x4f5666[_0x5a13f3(0x3b4,0x376,0x35a,0x39e)](_0x593cdd,0x3*-0xa03+-0x22a2+0x40ac))[_0x3ab3da(0x525,0x599,0x5a6,0x552)]();if(_0x2e77af)_0x2b7ed5[_0x2e77af]=_0x37d02c;}}return _0x2b7ed5;}function generateRequestId(){function _0x32ea1b(_0x6c951b,_0xf808a8,_0x4577ed,_0x23c51f){return _0x4ac0(_0x4577ed-0xb4,_0x23c51f);}const _0x5e0c4f={};_0x5e0c4f[_0x32ea1b(0x2ce,0x2af,0x2be,0x2ac)]=function(_0x550241,_0x32bded){return _0x550241+_0x32bded;};const _0x1e7980=_0x5e0c4f;if(crypto&&crypto['randomUUID'])return crypto[_0x32ea1b(0x2f2,0x318,0x311,0x2ce)]();function _0x5a7596(_0x379751,_0x3bec2f,_0x7830dc,_0x512ee6){return _0x4ac0(_0x512ee6-0x53,_0x7830dc);}return _0x1e7980[_0x5a7596(0x20b,0x2ad,0x26b,0x25d)](Date['now']()[_0x5a7596(0x247,0x1e5,0x282,0x240)](-0x13f7*-0x1+-0x1ced*-0x1+-0x3*0x1040),Math['random']()[_0x5a7596(0x258,0x216,0x21e,0x240)](0x122b*-0x1+-0xd*0x22d+0x7*0x6a8)[_0x32ea1b(0x2b3,0x298,0x2c3,0x2f2)](-0x4b7+0x2b*0x1d+-0x26));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x48b467(_0x5ca412,_0x8a9b24,_0x3aedbb,_0xce24f5){return _0x4ac0(_0xce24f5-0x12d,_0x8a9b24);}const _0x1c518f={'QnwBz':function(_0x1a033f,_0x33294b){return _0x1a033f(_0x33294b);},'QqbKI':'EGUTV','oAWdu':function(_0x9478e4,_0x3e1a1a){return _0x9478e4!==_0x3e1a1a;},'xAtGv':function(_0x334c98,_0x68cebe){return _0x334c98!==_0x68cebe;},'qRAoY':'AFLGN','ctBmn':'获取翻译提示词超时','uTWZC':function(_0x536bd5,_0x47a787){return _0x536bd5!==_0x47a787;},'BHFby':_0x48b467(0x382,0x30b,0x36e,0x34b),'tktMt':function(_0x4fe87a){return _0x4fe87a();},'EAycR':function(_0x7d1fb0,_0x2b2130,_0x4c5e77){return _0x7d1fb0(_0x2b2130,_0x4c5e77);}};return new Promise((_0x590c80,_0x355cba)=>{function _0x1c57c4(_0x2d4dc3,_0x33c6e0,_0x9042f6,_0x5d8736){return _0x48b467(_0x2d4dc3-0x1aa,_0x33c6e0,_0x9042f6-0x62,_0x9042f6-0xda);}function _0x231fd7(_0xf7276b,_0x1d7aa6,_0x3d184b,_0x39f824){return _0x48b467(_0xf7276b-0xda,_0x3d184b,_0x3d184b-0x1b3,_0x1d7aa6-0x167);}if(_0x1c518f[_0x1c57c4(0x494,0x4c6,0x47d,0x4c8)](_0x231fd7(0x4c0,0x4b2,0x4dd,0x472),_0x1c518f[_0x1c57c4(0x438,0x498,0x446,0x406)]))_0x1c518f[_0x1c57c4(0x470,0x490,0x4a2,0x49b)](_0x3b3370,_0x137f30[_0x1c57c4(0x3ff,0x3d4,0x422,0x43a)]);else{const _0x12af2f=_0x1c518f[_0x1c57c4(0x3f6,0x3de,0x42d,0x435)](generateRequestId);console[_0x1c57c4(0x4a5,0x45f,0x498,0x488)](_0x1c57c4(0x426,0x47b,0x468,0x44e)+_0x231fd7(0x52e,0x50c,0x4b8,0x541)+_0x1c57c4(0x466,0x40f,0x43c,0x3f6)+_0x12af2f+')');const _0x36b118=_0x396649=>{function _0x558c8d(_0x5e9adf,_0x1c0eea,_0x2c23f9,_0x4f60b3){return _0x231fd7(_0x5e9adf-0xb6,_0x4f60b3- -0x2cc,_0x2c23f9,_0x4f60b3-0x7);}function _0x4efaf2(_0x111c56,_0x118327,_0x499deb,_0x55e5d4){return _0x231fd7(_0x111c56-0x11d,_0x55e5d4- -0x669,_0x111c56,_0x55e5d4-0x3e);}if(_0x1c518f[_0x4efaf2(-0x186,-0x1bc,-0x19f,-0x197)]!==_0x1c518f[_0x4efaf2(-0x143,-0x1d0,-0x15e,-0x197)])for(const [_0x4dd61c,_0x1ef478]of _0x3afe14[_0x4efaf2(-0xf4,-0x102,-0x17a,-0x139)](_0x32a3b3)){_0x3a4757[_0x4dd61c[_0x4efaf2(-0x1f4,-0x18f,-0x196,-0x1d0)+'e']()]=_0x1ef478;}else{if(_0x1c518f[_0x558c8d(0x1fd,0x1b0,0x1e1,0x1c2)](_0x396649['id'],_0x12af2f))return;eventSource['removeList'+_0x558c8d(0x1db,0x1fa,0x20d,0x1fc)](eventNames['LLM_TRANSL'+_0x558c8d(0x23a,0x1b9,0x21a,0x1e7)+_0x4efaf2(-0x131,-0x178,-0x119,-0x152)+_0x558c8d(0x238,0x1fc,0x21c,0x1f4)],_0x36b118);const {prompt:_0x3e83a7}=_0x396649;console['log']('st-chatu8:'+_0x558c8d(0x245,0x23b,0x252,0x22f)+_0x558c8d(0x244,0x1c6,0x1f7,0x1ef)+_0x12af2f+'):',_0x3e83a7),_0x590c80(_0x3e83a7);}};eventSource['on'](eventNames[_0x1c57c4(0x44b,0x49e,0x447,0x421)+_0x231fd7(0x503,0x4b3,0x4b6,0x4fa)+_0x231fd7(0x514,0x517,0x4fd,0x52d)+_0x231fd7(0x50a,0x4c0,0x46a,0x4de)],_0x36b118);const _0x3e296e={};_0x3e296e['id']=_0x12af2f,eventSource[_0x231fd7(0x4e5,0x52c,0x57d,0x4de)](eventNames[_0x231fd7(0x47c,0x4d4,0x490,0x531)+'ATION_GET_'+_0x1c57c4(0x467,0x46b,0x419,0x3f4)+_0x231fd7(0x494,0x487,0x46d,0x42a)],_0x3e296e),_0x1c518f[_0x1c57c4(0x456,0x490,0x49e,0x4bf)](setTimeout,()=>{const _0xd77308={};function _0x47a537(_0x1f30bb,_0xb5d534,_0x460095,_0x1b394d){return _0x1c57c4(_0x1f30bb-0x177,_0x1f30bb,_0xb5d534- -0x57,_0x1b394d-0x159);}_0xd77308[_0x47a537(0x3a6,0x3df,0x439,0x418)]=_0x47a537(0x3a7,0x3f8,0x407,0x439);const _0x572a85=_0xd77308;function _0x50f44a(_0x2ff417,_0x506d9e,_0x3596d3,_0x19f9d2){return _0x1c57c4(_0x2ff417-0x1eb,_0x2ff417,_0x19f9d2- -0x12e,_0x19f9d2-0x160);}_0x1c518f[_0x47a537(0x40f,0x430,0x47c,0x45e)](_0x1c518f[_0x50f44a(0x2e0,0x2ac,0x280,0x2d2)],'AFLGN')?(_0x488585[_0x47a537(0x3b4,0x3e8,0x39f,0x427)+'ener'](_0x1ca8c6[_0x47a537(0x439,0x3f0,0x3ad,0x3ff)+'ATION_GET_'+'PROMPT_RES'+'PONSE'],_0x599ba9),_0x275610(new _0x12952e(_0x572a85['ZfFHk']))):(eventSource[_0x47a537(0x38b,0x3e8,0x3df,0x442)+_0x50f44a(0x333,0x2fa,0x2c2,0x30d)](eventNames['LLM_TRANSL'+_0x50f44a(0x349,0x2d1,0x2eb,0x2f8)+_0x47a537(0x3f0,0x433,0x3f9,0x477)+_0x50f44a(0x2cc,0x345,0x331,0x305)],_0x36b118),_0x355cba(new Error(_0x1c518f['ctBmn'])));},-0x2cc4+-0xe56+0x622a);}});}export function LLM_TRANSLATION(_0x6e60ce,{timeoutMs:timeoutMs=-0x1*-0x11563+0x17a10+-0x1a513}={}){function _0xf95767(_0x40f73,_0x4e07c0,_0xc87d27,_0x386527){return _0x4ac0(_0xc87d27- -0x314,_0x386527);}const _0x3626ff={'TdNRk':function(_0x7d72e5,_0x5b7694){return _0x7d72e5(_0x5b7694);},'psPwf':_0xf95767(-0xf3,-0xfc,-0xe1,-0x8c),'JYcbw':_0xf95767(-0xe4,-0xa4,-0xb3,-0x6e)+'\x20JSON解析失败，'+_0xf95767(-0xe8,-0x11b,-0xf3,-0xd6),'akLec':_0x331178(0x316,0x2ec,0x309,0x2f3),'RtRAU':function(_0x5bf252,_0x2860c1){return _0x5bf252===_0x2860c1;},'QyDuH':_0xf95767(-0xf8,-0xc1,-0xc1,-0xd8),'YSNRR':function(_0x429410,_0xead2b4){return _0x429410(_0xead2b4);},'DLJwR':'GGeqi','fxcxq':'kJLLw','nBScA':_0x331178(0x326,0x31a,0x361,0x2ff),'xGpCJ':function(_0x2eea9f,_0x5abd3a){return _0x2eea9f(_0x5abd3a);},'mkwNH':function(_0x6839f4,_0x3dbebf){return _0x6839f4!==_0x3dbebf;},'Owtov':_0xf95767(-0xf6,-0x121,-0x100,-0xe6),'Gjmzq':function(_0x19611a){return _0x19611a();},'GnEVc':function(_0x31bd79,_0x31931c){return _0x31bd79===_0x31931c;},'XSVgJ':'mrrxm','wbVic':_0xf95767(-0xd6,-0xe0,-0xa0,-0xcb),'cOtqI':function(_0x5a0b0c,_0x29b483,_0x17da80){return _0x5a0b0c(_0x29b483,_0x17da80);}};function _0x331178(_0x3652ba,_0x6e68c9,_0x4153ac,_0x1ad087){return _0x4ac0(_0x3652ba-0xa9,_0x6e68c9);}return new Promise((_0x23c274,_0x17f569)=>{function _0x49cce7(_0x1cfb9a,_0x463dcc,_0x4b2990,_0x39ad33){return _0xf95767(_0x1cfb9a-0x133,_0x463dcc-0x9d,_0x4b2990-0x67b,_0x1cfb9a);}function _0x138a21(_0x5d0d55,_0x1f0598,_0x54de41,_0x187575){return _0x331178(_0x5d0d55- -0xa5,_0x187575,_0x54de41-0xb1,_0x187575-0x1d5);}const _0x3d3c4f={'uAqUF':function(_0x3cecbf,_0x1d484d){return _0x3cecbf(_0x1d484d);},'kGKmr':function(_0x2a9218,_0x189cdd){return _0x2a9218(_0x189cdd);},'TPIzr':function(_0xb9f633,_0x127a2b){function _0x585c33(_0x523db6,_0x3c2cdd,_0x52a293,_0x2cbbff){return _0x4ac0(_0x523db6- -0x378,_0x52a293);}return _0x3626ff[_0x585c33(-0x137,-0x161,-0x18a,-0x193)](_0xb9f633,_0x127a2b);},'uRuww':_0x3626ff['psPwf'],'OBIot':_0x3626ff['JYcbw'],'WuKIy':_0x3626ff[_0x49cce7(0x539,0x565,0x578,0x58c)],'WSRpq':function(_0xc4d249,_0x46d1a1){return _0xc4d249!==_0x46d1a1;},'QIzRS':function(_0x2ee9d4,_0x5a2a2e){function _0x1acde6(_0x1fc6cf,_0x221420,_0x4d69b1,_0x6c808d){return _0x49cce7(_0x6c808d,_0x221420-0x8b,_0x1fc6cf-0x19,_0x6c808d-0x1c1);}return _0x3626ff[_0x1acde6(0x5cb,0x604,0x581,0x59d)](_0x2ee9d4,_0x5a2a2e);},'fUWZD':_0x3626ff[_0x49cce7(0x5dc,0x5ed,0x5ed,0x61c)],'MRqNI':function(_0xc90c3b,_0x23c311){function _0x2c39cb(_0x5635c5,_0x24d88c,_0x714d31,_0xceee8f){return _0x49cce7(_0xceee8f,_0x24d88c-0xad,_0x24d88c- -0x459,_0xceee8f-0x191);}return _0x3626ff[_0x2c39cb(0x126,0x163,0x175,0x1a3)](_0xc90c3b,_0x23c311);},'UzHIl':_0x3626ff[_0x49cce7(0x5f9,0x5b0,0x5b0,0x55d)],'wnDHp':function(_0x10b008,_0x5bdf99){return _0x10b008===_0x5bdf99;},'UhBsS':_0x3626ff[_0x138a21(0x294,0x2d7,0x28f,0x2d3)],'zZHWW':_0x3626ff[_0x49cce7(0x5b4,0x5a5,0x5cf,0x5c1)],'RHhco':function(_0xc74d7f,_0x3055dc){function _0x3ac1fc(_0x18ecd9,_0x19d73a,_0x1921aa,_0x3d76da){return _0x138a21(_0x19d73a-0x397,_0x19d73a-0x59,_0x1921aa-0x15b,_0x3d76da);}return _0x3626ff[_0x3ac1fc(0x570,0x5a3,0x5ef,0x5f8)](_0xc74d7f,_0x3055dc);},'HqGWM':function(_0x1836ba,_0x35a1c2){function _0x51f314(_0x343d51,_0x7be9af,_0x36c0b5,_0x3aee18){return _0x138a21(_0x343d51-0x122,_0x7be9af-0x1b2,_0x36c0b5-0x1f,_0x7be9af);}return _0x3626ff[_0x51f314(0x382,0x38e,0x3c4,0x39a)](_0x1836ba,_0x35a1c2);},'ArJjD':_0x3626ff[_0x49cce7(0x57e,0x53c,0x573,0x5ce)],'lxFqb':_0x49cce7(0x546,0x596,0x580,0x5c5),'jiYHg':function(_0x50da89){function _0x184e81(_0x25820c,_0x2182da,_0x21964f,_0x415e1d){return _0x138a21(_0x2182da-0xa0,_0x2182da-0x1b2,_0x21964f-0x1e,_0x21964f);}return _0x3626ff[_0x184e81(0x332,0x2f8,0x2d7,0x32c)](_0x50da89);}};if(_0x3626ff['GnEVc'](_0x3626ff[_0x138a21(0x28d,0x250,0x2b5,0x290)],_0x3626ff[_0x138a21(0x24a,0x27c,0x1f7,0x23d)])){const _0x4ed279=_0x39fd78?function(){function _0x2480e8(_0x5d6201,_0x549686,_0x464555,_0x1b27b3){return _0x49cce7(_0x549686,_0x549686-0x6,_0x464555- -0x5e5,_0x1b27b3-0x145);}if(_0x4d3f40){const _0x298621=_0x33db2b[_0x2480e8(-0x8,0x6,0x20,0x73)](_0x33c052,arguments);return _0x2078d6=null,_0x298621;}}:function(){};return _0x4c4318=![],_0x4ed279;}else{const _0x36e18c=generateRequestId();console[_0x138a21(0x295,0x280,0x2c2,0x2f2)](_0x138a21(0x265,0x2b9,0x218,0x273)+_0x49cce7(0x62f,0x5c7,0x600,0x5bb)+_0x49cce7(0x5c5,0x53d,0x58e,0x5cb)+_0x36e18c+')');let _0x218e5a=null;const _0x566b74=()=>{function _0x37ffe0(_0x823cf1,_0x528408,_0x135900,_0x18f6f4){return _0x49cce7(_0x135900,_0x528408-0x136,_0x528408- -0x394,_0x18f6f4-0x61);}function _0x3a71b5(_0xf0143f,_0x30ad97,_0x1162bd,_0x427a9f){return _0x49cce7(_0x30ad97,_0x30ad97-0xb2,_0x1162bd- -0x4fb,_0x427a9f-0x9d);}eventSource[_0x37ffe0(0x1c8,0x20b,0x248,0x243)+'ener'](eventNames[_0x37ffe0(0x225,0x213,0x25a,0x1f7)+_0x3a71b5(0x9e,0x9c,0x91,0x75)+_0x3a71b5(0x10c,0x12e,0xd1,0x128)],_0x259e9c);if(_0x218e5a)clearTimeout(_0x218e5a);},_0x259e9c=_0x411f7a=>{function _0x36007b(_0x1fa891,_0x10b62f,_0x43fafb,_0x22efe){return _0x49cce7(_0x1fa891,_0x10b62f-0x1df,_0x43fafb- -0x1d,_0x22efe-0x153);}function _0x3095a2(_0x508383,_0x3a0d4d,_0x93bd4e,_0x193ec4){return _0x138a21(_0x193ec4- -0x129,_0x3a0d4d-0x103,_0x93bd4e-0x2,_0x508383);}if('vikGg'===_0x3d3c4f['WuKIy']){if(_0x3d3c4f[_0x3095a2(0x19b,0x1b5,0x12d,0x171)](_0x411f7a['id'],_0x36e18c))return;_0x566b74(),console['log'](_0x36007b(0x5a4,0x589,0x5ab,0x5d0)+_0x3095a2(0x150,0x12c,0x151,0xfb)+_0x36007b(0x620,0x5c5,0x5c5,0x61d)+'\x20'+_0x36e18c+'):',_0x411f7a);if(_0x411f7a[_0x3095a2(0x1cd,0x142,0x160,0x17b)]){if(_0x3d3c4f[_0x36007b(0x553,0x4de,0x538,0x522)](_0x3d3c4f[_0x36007b(0x5e5,0x60d,0x5ba,0x5df)],_0x3d3c4f['fUWZD']))_0x3d3c4f[_0x36007b(0x5da,0x58c,0x5dd,0x60f)](_0x23c274,_0x411f7a[_0x36007b(0x565,0x558,0x565,0x538)]);else{const _0x4b5640=_0x4d1777[-0x11b2+0x137*0xe+0xb1]||'',_0x371a88=(_0x58ab80[0x3d*-0x89+0x2680+-0x5d9]||'')['trim'](),_0x1c8eb6=_0xa9bf58[-0x2*-0x125f+0x2b0*0xb+-0x1*0x424b]||'',_0x200c75=_0x352c3d[0x12b*0xd+0x2121+0x2*-0x1826]||'',_0x228495={'original':_0x51e5f9,'cleaned':_0x371a88,'prefix':_0x4b5640,'suffix':_0x1c8eb6,'weight':_0x200c75,'skip':_0x3d3c4f[_0x36007b(0x5c0,0x604,0x5a8,0x5bd)](_0x53d61d,_0x40b5d6)||_0x3d3c4f[_0x3095a2(0x13b,0x17d,0x135,0x135)](_0x3d7b3b,_0x371a88)};_0x4e7788[_0x3095a2(0xb2,0xbd,0x113,0xcd)](_0x228495),!_0x228495['skip']&&_0x371a88&&(_0x4e9244[_0x36007b(0x583,0x4f1,0x53c,0x535)](_0x371a88),_0x9df59[_0x3095a2(0xe8,0x7d,0x10d,0xc3)](_0x371a88[_0x3095a2(0xd0,0x115,0xd5,0xe0)+'e'](),_0x228495));}}else{if(_0x3d3c4f[_0x3095a2(0x1ca,0x12b,0x131,0x171)](_0x3d3c4f[_0x3095a2(0x164,0x158,0x168,0x149)],_0x3d3c4f[_0x3095a2(0x14b,0x110,0x149,0x149)])){const _0x31f024=_0x45604d[_0x3095a2(0x13d,0x186,0x132,0x179)](_0x4878e3,arguments);return _0x31c529=null,_0x31f024;}else{if(_0x411f7a[_0x3095a2(0xcb,0x92,0x8d,0xcc)]&&_0x3d3c4f[_0x36007b(0x4fb,0x4ea,0x538,0x4f8)](_0x411f7a[_0x3095a2(0xa8,0x114,0xcc,0xcc)][_0x36007b(0x538,0x523,0x53f,0x56b)],'AbortError')){if(_0x3d3c4f[_0x3095a2(0xe1,0xa2,0x6f,0xc4)](_0x36007b(0x5da,0x579,0x58e,0x5e5),_0x3d3c4f['UhBsS']))_0x1df448(),_0x3d3c4f['TPIzr'](_0x1d9f95,new _0x49769f(_0x36007b(0x56b,0x550,0x59b,0x568)+'时（'+_0x1c78ba+'ms）'));else{const _0x4480fe=new Error(_0x411f7a['error'][_0x3095a2(0xe7,0xfe,0x159,0x116)]);_0x4480fe[_0x3095a2(0xac,0x81,0xcb,0xd0)]=_0x3d3c4f[_0x3095a2(0x119,0x16b,0x13b,0x170)],_0x3d3c4f[_0x3095a2(0xed,0x12b,0x132,0xe8)](_0x17f569,_0x4480fe);}}else{if(_0x3d3c4f[_0x3095a2(0x152,0x15c,0x146,0x15f)](_0x3d3c4f[_0x3095a2(0xd9,0xed,0x11e,0xc6)],_0x3d3c4f[_0x36007b(0x598,0x5e0,0x5d1,0x583)]))_0x3d3c4f[_0x3095a2(0x106,0x101,0x159,0x135)](_0x17f569,new Error(_0x411f7a['result']));else{_0x3d3c4f[_0x3095a2(0xed,0x11a,0x118,0x120)](_0x596d8c,'翻译失败:\x20'+_0x2d47cb['message']),_0x3372cc['error'](_0x3d3c4f[_0x36007b(0x528,0x572,0x541,0x50b)],_0x1f5b4e);throw _0x475ba3;}}}}}else _0x525dac[_0x3095a2(0x1d0,0x143,0x192,0x178)](_0x3d3c4f[_0x3095a2(0x108,0xda,0xeb,0x109)],_0x23c31e['message']);};eventSource['on'](eventNames[_0x138a21(0x244,0x233,0x258,0x24d)+'ATION_RESP'+'ONSE'],_0x259e9c);const _0x555c01={};_0x555c01[_0x49cce7(0x5b9,0x603,0x5fb,0x5ae)]=_0x6e60ce,_0x555c01['id']=_0x36e18c,eventSource[_0x138a21(0x29c,0x292,0x278,0x2aa)](eventNames[_0x49cce7(0x57c,0x55b,0x5a7,0x5fd)+_0x49cce7(0x56a,0x5a4,0x570,0x5c4)+_0x49cce7(0x53c,0x507,0x563,0x5a8)],_0x555c01),_0x218e5a=_0x3626ff[_0x138a21(0x246,0x26a,0x235,0x21b)](setTimeout,()=>{function _0x1c0aea(_0x4123fd,_0x5cac7a,_0x2c630d,_0x2edb44){return _0x49cce7(_0x5cac7a,_0x5cac7a-0x16b,_0x2edb44- -0x473,_0x2edb44-0x1d4);}function _0xac04ad(_0x4d2e06,_0x1bb5ba,_0x7e75eb,_0x5ce52b){return _0x138a21(_0x1bb5ba- -0x140,_0x1bb5ba-0xaa,_0x7e75eb-0x9b,_0x7e75eb);}_0x3d3c4f[_0x1c0aea(0xff,0x134,0xd3,0xea)](_0x566b74),_0x3d3c4f['uAqUF'](_0x17f569,new Error(_0x1c0aea(0x134,0x195,0x12d,0x145)+'时（'+timeoutMs+_0x1c0aea(0x176,0x10e,0x173,0x169)));},timeoutMs);}});}export async function callTranslation(_0x2e9d53){const _0x66a61c={'FXbDy':function(_0xb77712,_0x4a5693,_0x239766){return _0xb77712(_0x4a5693,_0x239766);},'AFeAt':function(_0x1c17e3,_0x25ed54){return _0x1c17e3||_0x25ed54;},'kjlcF':_0x2c5c79(0x27b,0x205,0x228,0x1e3),'lkVUd':function(_0x1ef241,_0x1311a8){return _0x1ef241(_0x1311a8);},'QyUMM':_0x2c5c79(0x1fd,0x210,0x1e2,0x1dd)};function _0x4c84ac(_0x422a7d,_0x5746ea,_0x40aef4,_0x18053c){return _0x4ac0(_0x5746ea- -0x290,_0x40aef4);}function _0x2c5c79(_0x331ae4,_0x5a06df,_0x4532d5,_0x2b784a){return _0x4ac0(_0x4532d5- -0x51,_0x2b784a);}try{let _0x1f0654=_0x66a61c['FXbDy'](buildPromptForRequestType,_0x2c5c79(0x172,0x21c,0x1c7,0x198)+'n',_0x66a61c[_0x4c84ac(-0x4b,-0x40,-0x21,-0x5b)](_0x2e9d53,''));_0x1f0654=mergeAdjacentMessages(_0x1f0654);const _0xced238=[..._0x1f0654,{'role':_0x66a61c[_0x4c84ac(-0xa,0xa,0x2,-0x2e)],'content':_0x66a61c['AFeAt'](_0x2e9d53,'')}];updateCombinedPrompt(_0xced238);const _0x1c8a64=await _0x66a61c[_0x2c5c79(0x198,0x1d6,0x199,0x17f)](LLM_TRANSLATION,_0xced238);return _0x1c8a64;}catch(_0xa43dd){addLog(_0x4c84ac(-0x32,-0x66,-0x30,-0xe)+_0xa43dd[_0x2c5c79(0x23a,0x204,0x1ea,0x1ef)]),console[_0x4c84ac(-0xb7,-0x9f,-0x87,-0x51)](_0x66a61c['QyUMM'],_0xa43dd);throw _0xa43dd;}}let isAiInitialized=![];function _0x4ac0(_0xefb8d1,_0x6446c9){_0xefb8d1=_0xefb8d1-(0x2604+-0x139e+-0x107f);const _0x2711d0=_0x3fc4();let _0x3657d1=_0x2711d0[_0xefb8d1];if(_0x4ac0['TOUXfn']===undefined){var _0x44f250=function(_0x258d0d){const _0x1104dd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4a4f6c='',_0x3a8fed='',_0x2a37b4=_0x4a4f6c+_0x44f250;for(let _0x57b664=0xd2d+0x162c+0x2359*-0x1,_0x55a5d7,_0x506736,_0x371046=-0x81*0x17+-0xba*0x2+0xd0b;_0x506736=_0x258d0d['charAt'](_0x371046++);~_0x506736&&(_0x55a5d7=_0x57b664%(0x1ac8+0x1*0x871+0x2335*-0x1)?_0x55a5d7*(0x1838+-0x14e3*-0x1+-0x1*0x2cdb)+_0x506736:_0x506736,_0x57b664++%(-0x25e9+-0x2449*-0x1+-0x15*-0x14))?_0x4a4f6c+=_0x2a37b4['charCodeAt'](_0x371046+(0xd79*-0x1+-0x1776+0xc53*0x3))-(-0x1105+0x133*-0x1a+-0xe9*-0x35)!==-0x2129+-0x22c2*-0x1+-0x1*0x199?String['fromCharCode'](0x133c+-0x164a+0x1*0x40d&_0x55a5d7>>(-(-0x36e*0xa+0x71*-0x1f+-0x7*-0x6db)*_0x57b664&0x35a*-0x6+-0x268e+0x3ab0)):_0x57b664:-0x17*-0x90+-0x8*-0x97+-0x11a8){_0x506736=_0x1104dd['indexOf'](_0x506736);}for(let _0x1007f9=0x167+0x391*0x1+-0x4f8,_0x442da2=_0x4a4f6c['length'];_0x1007f9<_0x442da2;_0x1007f9++){_0x3a8fed+='%'+('00'+_0x4a4f6c['charCodeAt'](_0x1007f9)['toString'](0x2*0x381+-0x190e+0x121c))['slice'](-(-0x2453+0x2*-0x127b+0x494b));}return decodeURIComponent(_0x3a8fed);};_0x4ac0['nvdKai']=_0x44f250,_0x4ac0['vQcSsp']={},_0x4ac0['TOUXfn']=!![];}const _0x3670cc=_0x2711d0[-0xbd3+0x25a5+-0x19d2],_0x195cc1=_0xefb8d1+_0x3670cc,_0x1e3d30=_0x4ac0['vQcSsp'][_0x195cc1];if(!_0x1e3d30){const _0x57a5f6=function(_0x44c8cb){this['YHBiEA']=_0x44c8cb,this['qBHKGB']=[-0x1*-0x61f+0x7f*0x4a+-0x4*0xab5,0x21e7+0x2*-0x760+-0x1327,0x1*-0xff1+0x148*0x4+0xad1],this['FZgAdt']=function(){return'newState';},this['ZbowTp']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['NtQfUs']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x57a5f6['prototype']['UqBnrF']=function(){const _0x17bf23=new RegExp(this['ZbowTp']+this['NtQfUs']),_0x5f3b86=_0x17bf23['test'](this['FZgAdt']['toString']())?--this['qBHKGB'][0x485*0x7+0x13a3+0x271*-0x15]:--this['qBHKGB'][0x1be*0x11+0xdf2+0x110*-0x29];return this['nmlTbH'](_0x5f3b86);},_0x57a5f6['prototype']['nmlTbH']=function(_0x5e2d88){if(!Boolean(~_0x5e2d88))return _0x5e2d88;return this['hIpHBe'](this['YHBiEA']);},_0x57a5f6['prototype']['hIpHBe']=function(_0x51da79){for(let _0x538c38=0x2691*-0x1+-0x2219+-0x2455*-0x2,_0x50ba63=this['qBHKGB']['length'];_0x538c38<_0x50ba63;_0x538c38++){this['qBHKGB']['push'](Math['round'](Math['random']())),_0x50ba63=this['qBHKGB']['length'];}return _0x51da79(this['qBHKGB'][0x210f+-0x1f*0x94+-0xf23]);},new _0x57a5f6(_0x4ac0)['UqBnrF'](),_0x3657d1=_0x4ac0['nvdKai'](_0x3657d1),_0x4ac0['vQcSsp'][_0x195cc1]=_0x3657d1;}else _0x3657d1=_0x1e3d30;return _0x3657d1;}export function initAiSettings(_0x26e078){const _0x2df9f9={};function _0x420177(_0x3c280e,_0x126e9d,_0x1b6e4a,_0x440818){return _0x4ac0(_0x126e9d- -0x16f,_0x1b6e4a);}_0x2df9f9['sLlmz']=_0x4eb05e(0x4cc,0x471,0x479,0x43a)+_0x4eb05e(0x497,0x43d,0x425,0x495)+_0x420177(0xe1,0x123,0x169,0xf6);const _0xea368a=_0x2df9f9;function _0x4eb05e(_0x342cec,_0x560b1b,_0x498b2b,_0x27f4d6){return _0x4ac0(_0x560b1b-0x210,_0x27f4d6);}!isAiInitialized&&(console[_0x4eb05e(0x47d,0x4a1,0x4ed,0x45c)](_0xea368a[_0x420177(0x66,0x94,0x63,0x6b)]),isAiInitialized=!![]);}