(function(_0x78547a,_0x2338df){const _0xabaab1=_0x78547a();function _0x135a43(_0x1302eb,_0x97a7,_0x203feb,_0x578362){return _0x5d13(_0x578362-0x45,_0x97a7);}function _0x1c3490(_0x28755c,_0x114409,_0x3f93ba,_0x5b3f68){return _0x5d13(_0x114409- -0x25e,_0x5b3f68);}while(!![]){try{const _0x17aa0f=-parseInt(_0x135a43(0x149,0x164,0x15d,0x17a))/(0x3*0x81+-0x637+0x1*0x4b5)*(parseInt(_0x1c3490(-0x14c,-0x15a,-0x173,-0x18b))/(-0x3a2*0x2+0x2ea*0xc+-0x2c5*0xa))+-parseInt(_0x135a43(0x139,0x151,0x17e,0x163))/(0x23f2*0x1+0x723+-0x95*0x4a)*(parseInt(_0x135a43(0x123,0x13a,0xf7,0x13a))/(-0x1*0xa36+-0x374+0xdae))+-parseInt(_0x135a43(0x139,0x154,0x141,0x11b))/(-0x16ff*0x1+0x4*0x18d+0x10d0)+-parseInt(_0x135a43(0x17e,0x18a,0x156,0x142))/(0x1d*-0x1d+0x5*-0x2fd+0x1240)+parseInt(_0x1c3490(-0x164,-0x192,-0x18a,-0x194))/(0xd5b+0x34*0xb+-0xf90)*(parseInt(_0x1c3490(-0x155,-0x123,-0x138,-0xe1))/(-0x17d8*-0x1+0x3d*-0x91+0x1*0xabd))+parseInt(_0x135a43(0x153,0x148,0x11e,0x12c))/(-0x1b8d+0x3d2*-0xa+0x41ca)+-parseInt(_0x1c3490(-0x134,-0x15c,-0x189,-0x1a5))/(0x1abb+-0x2bd*0x2+-0x1537)*(-parseInt(_0x1c3490(-0x158,-0x170,-0x17c,-0x191))/(0xc1c+0x152+0xd63*-0x1));if(_0x17aa0f===_0x2338df)break;else _0xabaab1['push'](_0xabaab1['shift']());}catch(_0x1c3f03){_0xabaab1['push'](_0xabaab1['shift']());}}}(_0x24bd,0x12c06f*-0x1+0x126914+0xaea0d));const _0x275905=(function(){let _0x1f8d21=!![];return function(_0xe370e,_0x3ee330){const _0x198cb3=_0x1f8d21?function(){if(_0x3ee330){const _0x506b33=_0x3ee330['apply'](_0xe370e,arguments);return _0x3ee330=null,_0x506b33;}}:function(){};return _0x1f8d21=![],_0x198cb3;};}()),_0x3c04eb=_0x275905(this,function(){const _0x4d7b46={};function _0x402e81(_0x5c7db5,_0x4cc202,_0x53fa4b,_0x253c1b){return _0x5d13(_0x5c7db5- -0x153,_0x4cc202);}function _0x576eca(_0x2c9049,_0x3664c0,_0x35e99d,_0x52c2b5){return _0x5d13(_0x2c9049- -0x2c2,_0x35e99d);}_0x4d7b46[_0x576eca(-0x1b2,-0x18b,-0x1b8,-0x177)]=_0x576eca(-0x184,-0x1a2,-0x155,-0x183)+'+$';const _0xfde5fe=_0x4d7b46;return _0x3c04eb[_0x402e81(-0x10,-0x4b,0x2d,-0x41)]()[_0x576eca(-0x1d9,-0x1f7,-0x1c0,-0x195)](_0xfde5fe[_0x576eca(-0x1b2,-0x1f0,-0x1f3,-0x172)])[_0x576eca(-0x17f,-0x1a1,-0x15b,-0x1a0)]()[_0x576eca(-0x1ae,-0x186,-0x1f8,-0x1d8)+'r'](_0x3c04eb)[_0x402e81(-0x6a,-0x43,-0x95,-0x71)](_0xfde5fe[_0x576eca(-0x1b2,-0x1ef,-0x198,-0x1cb)]);});_0x3c04eb();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x2451be){function _0x506f83(_0x26426c,_0x35796a,_0x379048,_0xe90911){return _0x5d13(_0xe90911-0x3a2,_0x26426c);}function _0x3e92f0(_0x3c52fe,_0x25f6eb,_0x178d6b,_0x16f5c5){return _0x5d13(_0x178d6b-0x7e,_0x25f6eb);}return SKIP_PATTERNS[_0x506f83(0x4fa,0x4f8,0x497,0x4d1)](_0x1433f0=>_0x1433f0[_0x506f83(0x454,0x45a,0x46e,0x46d)](_0x2451be[_0x506f83(0x4bf,0x475,0x49e,0x483)]()));}export function tagsToJsonString(_0x24531b){function _0x5c96c9(_0x1f53d5,_0x350714,_0x58999e,_0x2cdb5f){return _0x5d13(_0x350714-0xce,_0x58999e);}if(!Array['isArray'](_0x24531b))return'[]';function _0x1f65c8(_0x57933a,_0x219516,_0x1145ca,_0x21474d){return _0x5d13(_0x1145ca- -0x36b,_0x21474d);}return JSON[_0x1f65c8(-0x289,-0x21d,-0x24b,-0x229)](_0x24531b[_0x5c96c9(0x1ed,0x1a9,0x192,0x168)](_0x45f725=>_0x45f725&&typeof _0x45f725===_0x1f65c8(-0x282,-0x292,-0x245,-0x24b)));}export function preprocessPromptForTranslation(_0x4e9294){function _0x231b61(_0x16bd5d,_0x5a20c3,_0x59e615,_0x558eb3){return _0x5d13(_0x5a20c3-0x31,_0x558eb3);}const _0x1eedfd={'aTGRz':_0x231b61(0x144,0x11c,0x107,0xd8),'GaxRq':function(_0x4cf78c,_0x100bed){return _0x4cf78c<_0x100bed;},'isLLs':'OlUZe','ITsiR':function(_0x1f6341,_0x5f0962){return _0x1f6341===_0x5f0962;},'vGMkt':function(_0x24f8a5,_0x1f431b){return _0x24f8a5===_0x1f431b;},'xiLuM':_0x231b61(0x154,0x114,0x109,0x106),'XGhBi':function(_0x4f9ffd,_0x5b83ee){return _0x4f9ffd!==_0x5b83ee;},'CmUIA':function(_0x2511b7,_0x2b1cb6){return _0x2511b7(_0x2b1cb6);},'zjIMV':'string','TxbQm':_0x231b61(0x122,0x14b,0x196,0xfe),'MAglZ':function(_0x40d79a,_0x4d5095){return _0x40d79a===_0x4d5095;},'zJNZk':_0x231b61(0x106,0x13b,0x10f,0x16d),'hqtsD':function(_0x1337b7,_0x4d7dd2){return _0x1337b7(_0x4d7dd2);},'aqZTE':function(_0x23bf0e,_0x4b677a){return _0x23bf0e(_0x4b677a);},'pQKjX':function(_0x21c034,_0x56342e){return _0x21c034===_0x56342e;},'UJRBm':'LRtEk','fjlGh':'qxTUM','FaGOc':'HWpwc'};if(!_0x4e9294||_0x1eedfd[_0x231b61(0x16e,0x165,0x167,0x154)](typeof _0x4e9294,_0x1eedfd[_0xe4e0ce(0x42a,0x479,0x45b,0x499)])){if('bSgKP'===_0x1eedfd[_0x231b61(0x13e,0x172,0x147,0x15b)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};else{_0x252971['removeList'+_0x231b61(0x16e,0x155,0x187,0x168)](_0x311794[_0xe4e0ce(0x471,0x427,0x472,0x496)+_0xe4e0ce(0x478,0x46c,0x451,0x44c)+_0x231b61(0xdc,0x10d,0xdd,0xff)],_0xef30af);if(_0x43ac8a)_0x36fcb3(_0x3313b4);}}const _0x171354=_0x1b2da1=>{function _0x23825f(_0x4748b3,_0x204c61,_0x4dc80e,_0xbb7f4b){return _0x231b61(_0x4748b3-0x23,_0x4748b3- -0x272,_0x4dc80e-0x16a,_0x204c61);}function _0x2521f3(_0x5254dc,_0x4cd9dd,_0x1a91de,_0x3d45c5){return _0x231b61(_0x5254dc-0x1e8,_0x4cd9dd-0x9c,_0x1a91de-0x181,_0x3d45c5);}if(_0x1eedfd[_0x2521f3(0x19a,0x190,0x1a8,0x17b)]!==_0x1eedfd[_0x2521f3(0x157,0x190,0x1c2,0x1d4)]){const _0x113148=_0x64504d?function(){function _0x1447a8(_0x33233a,_0x3e469d,_0x22ec86,_0x27befe){return _0x2521f3(_0x33233a-0x17c,_0x22ec86- -0x103,_0x22ec86-0x87,_0x3e469d);}if(_0x45d290){const _0xab774f=_0x4d51ca[_0x1447a8(0x10d,0x123,0xfc,0xbb)](_0x276e61,arguments);return _0x5262c0=null,_0xab774f;}}:function(){};return _0x41e3d9=![],_0x113148;}else{const _0x59a38f=[];let _0x1f3aed='',_0x5ccec9=![];for(let _0x31b2d2=0x1e85+0x473*0x1+-0x22f8;_0x1eedfd['GaxRq'](_0x31b2d2,_0x1b2da1['length']);_0x31b2d2++){if(_0x1eedfd[_0x2521f3(0x1ce,0x1e9,0x1f5,0x222)]!==_0x1eedfd['isLLs'])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x47bcdf()};else{const _0x4acc43=_0x1b2da1[_0x31b2d2];if(_0x4acc43==='$')_0x5ccec9=!_0x5ccec9,_0x1f3aed+=_0x4acc43;else{if((_0x1eedfd[_0x2521f3(0x18d,0x18f,0x152,0x167)](_0x4acc43,',')||_0x1eedfd['ITsiR'](_0x4acc43,'，'))&&!_0x5ccec9){const _0xb48fa1=_0x1f3aed[_0x23825f(-0x160,-0x161,-0x132,-0x125)]();if(_0xb48fa1)_0x59a38f[_0x23825f(-0x115,-0x131,-0x12d,-0x119)](_0xb48fa1);_0x1f3aed='';}else _0x1f3aed+=_0x4acc43;}}}if(_0x1f3aed[_0x2521f3(0x16e,0x1ae,0x1c4,0x1b0)]())_0x59a38f[_0x2521f3(0x1e2,0x1f9,0x211,0x1d3)](_0x1f3aed[_0x2521f3(0x195,0x1ae,0x1f3,0x168)]());return _0x59a38f;}},_0x3e6640=_0x171354(_0x4e9294),_0x70503b=[],_0x5772cd=[],_0x520f5a=new Map();for(const _0x5bb3ef of _0x3e6640){if(_0xe4e0ce(0x402,0x478,0x447,0x450)===_0xe4e0ce(0x435,0x41c,0x447,0x47b)){const _0x5e2a8c=_0x5bb3ef[_0x231b61(0x18f,0x15c,0x197,0x161)](SD_SYMBOL_PATTERN);if(_0x5e2a8c){if(_0x1eedfd[_0xe4e0ce(0x4e9,0x4ec,0x4a3,0x46b)](_0x1eedfd[_0xe4e0ce(0x45f,0x42b,0x474,0x4bb)],_0x1eedfd[_0x231b61(0x104,0x132,0x129,0x15c)])){const _0x3f0c19=_0x5e2a8c[-0x261c+-0x1318+0x3935]||'',_0x2b7692=(_0x5e2a8c[0x24c*0x3+0x23f2+-0x2ad4]||'')['trim'](),_0x581e7a=_0x5e2a8c[0x1*-0xcc0+0x1d*0x64+0x16f]||'',_0x6a8c7e=_0x5e2a8c[-0xcbe+0xd*0x86+0x5f4]||'',_0x1901f4={'original':_0x5bb3ef,'cleaned':_0x2b7692,'prefix':_0x3f0c19,'suffix':_0x581e7a,'weight':_0x6a8c7e,'skip':_0x1eedfd[_0xe4e0ce(0x47e,0x4cc,0x489,0x43c)](shouldSkipTranslation,_0x5bb3ef)||_0x1eedfd[_0xe4e0ce(0x420,0x461,0x46c,0x444)](shouldSkipTranslation,_0x2b7692)};_0x70503b[_0x231b61(0x191,0x15d,0x179,0x13b)](_0x1901f4);if(!_0x1901f4['skip']&&_0x2b7692){if(_0x1eedfd[_0xe4e0ce(0x483,0x4c8,0x4af,0x4bc)](_0x1eedfd[_0x231b61(0x122,0x15f,0x164,0x18c)],_0x1eedfd['fjlGh']))return _0x1fbccc[_0x231b61(0x13f,0x160,0x115,0x144)](_0x10b9e1=>_0x10b9e1[_0x231b61(0xde,0xfc,0x141,0xf9)](_0x4eabde['trim']()));else _0x5772cd[_0xe4e0ce(0x4ca,0x4ba,0x49f,0x456)](_0x2b7692),_0x520f5a[_0xe4e0ce(0x471,0x475,0x471,0x43a)](_0x2b7692[_0xe4e0ce(0x424,0x414,0x428,0x402)+'e'](),_0x1901f4);}}else{const _0x29d508=_0x5f3860[_0x231b61(0x19e,0x15c,0x180,0x17d)](/\{[\s\S]*\}/);if(_0x29d508){const _0x1dae19=_0x42a3ee[_0x231b61(0xee,0xe8,0x100,0x9d)](_0x29d508[-0x6f6+0x255e+-0x1e68]);if(_0x1eedfd[_0xe4e0ce(0x441,0x46e,0x43d,0x442)](typeof _0x1dae19,_0x1eedfd[_0x231b61(0xde,0x117,0x15c,0xe9)])&&_0x1eedfd[_0x231b61(0x17b,0x165,0x16a,0x140)](_0x1dae19,null))return _0x1dae19;}}}else{const _0x1698e8={'original':_0x5bb3ef,'cleaned':_0x5bb3ef,'prefix':'','suffix':'','weight':'','skip':shouldSkipTranslation(_0x5bb3ef)};_0x70503b[_0xe4e0ce(0x4b7,0x477,0x49f,0x4c4)](_0x1698e8);if(!_0x1698e8[_0x231b61(0xd7,0xf0,0xc2,0xca)]&&_0x5bb3ef){if(_0x1eedfd['XGhBi'](_0x1eedfd['FaGOc'],_0x1eedfd[_0xe4e0ce(0x429,0x46b,0x41f,0x463)])){const _0x1e94c4={};return _0x1e94c4[_0x231b61(0xe6,0xf1,0xa6,0x105)]=[],_0x1e94c4[_0x231b61(0x100,0xee,0xfd,0x103)+'t']='',_0x1e94c4[_0x231b61(0x137,0x14e,0x12c,0x15b)+'gs']=[],_0x1e94c4;}else _0x5772cd[_0x231b61(0x124,0x15d,0x15f,0x16e)](_0x5bb3ef),_0x520f5a['set'](_0x5bb3ef[_0x231b61(0xa7,0xe6,0xcb,0x105)+'e'](),_0x1698e8);}}}else{_0x1eedfd[_0x231b61(0xd8,0xf2,0xcf,0xe2)](_0x1c58d9,_0x231b61(0x108,0xe4,0xd3,0xad)+_0x401a20[_0xe4e0ce(0x49c,0x410,0x457,0x499)]),_0x10082f['error'](_0xe4e0ce(0x487,0x42a,0x43a,0x3f7),_0x378d11);throw _0x4b3b6c;}}function _0xe4e0ce(_0x27c683,_0x4f3824,_0x4e5fe3,_0x20696a){return _0x5d13(_0x4e5fe3-0x373,_0x27c683);}return{'originalTags':_0x70503b,'cleanedTags':_0x5772cd,'cleanedText':_0x1eedfd[_0xe4e0ce(0x41d,0x403,0x434,0x417)](tagsToJsonString,_0x5772cd),'tagMap':_0x520f5a};}export function combineTranslationResult(_0x4c00ae,_0x16f301){const _0x470315={};_0x470315[_0x4b2966(0x1ee,0x199,0x1ef,0x1d2)]=_0x4b2966(0x1af,0x1a1,0x1c9,0x1b9),_0x470315[_0x47dfe1(-0x28b,-0x2cb,-0x2c6,-0x298)]=function(_0x5ac5a0,_0x54d137){return _0x5ac5a0===_0x54d137;},_0x470315[_0x47dfe1(-0x2e4,-0x2b5,-0x2c3,-0x2eb)]=_0x4b2966(0x1b8,0x239,0x208,0x1f0),_0x470315[_0x4b2966(0x158,0x19a,0x173,0x199)]='FkmVZ',_0x470315[_0x47dfe1(-0x317,-0x2f1,-0x2df,-0x333)]=function(_0x5694e7,_0x456ac2){return _0x5694e7===_0x456ac2;},_0x470315[_0x47dfe1(-0x325,-0x2f6,-0x2b9,-0x2e4)]=function(_0x1173dc,_0x3fd1cf){return _0x1173dc===_0x3fd1cf;},_0x470315[_0x47dfe1(-0x29e,-0x2df,-0x2bc,-0x2a3)]=_0x47dfe1(-0x29a,-0x2c1,-0x2a8,-0x297);function _0x4b2966(_0x46bf80,_0x4661cf,_0x55d2ca,_0x53fe57){return _0x5d13(_0x53fe57-0xbf,_0x55d2ca);}const _0x26ebdc=_0x470315;if(!_0x4c00ae||!Array[_0x4b2966(0x1bd,0x203,0x1b1,0x1e0)](_0x4c00ae))return[];const _0x1a169d={};function _0x47dfe1(_0x4a9ece,_0x44a958,_0x209609,_0x36e705){return _0x5d13(_0x44a958- -0x3ce,_0x36e705);}if(_0x16f301&&_0x26ebdc['PXxuD'](typeof _0x16f301,'object')){if(_0x26ebdc['YmVAJ'](_0x26ebdc[_0x4b2966(0x19f,0x174,0x1c4,0x1ae)],_0x26ebdc[_0x47dfe1(-0x311,-0x2df,-0x2ac,-0x31c)]))for(const [_0x2e1a73,_0x57a4cb]of Object['entries'](_0x16f301)){_0x1a169d[_0x2e1a73[_0x4b2966(0x16f,0x194,0x1b3,0x174)+'e']()]=_0x57a4cb;}else return _0x1c0659[_0x4b2966(0x209,0x1f0,0x1f1,0x1c6)]();}return _0x4c00ae[_0x47dfe1(-0x2dc,-0x2e4,-0x30e,-0x2ae)](_0x45616f=>{function _0x46287a(_0xddc0e2,_0x4fa41d,_0x1e26f1,_0x33fbc1){return _0x47dfe1(_0xddc0e2-0x35,_0xddc0e2-0x26a,_0x1e26f1-0x13c,_0x4fa41d);}function _0x4e2bfe(_0xf3d7e0,_0x37b340,_0x36ea44,_0x1c371f){return _0x4b2966(_0xf3d7e0-0x1cc,_0x37b340-0x177,_0x36ea44,_0x1c371f-0x2be);}if(_0x26ebdc[_0x46287a(-0x51,-0xb,-0x30,-0x6e)]!==_0x26ebdc[_0x46287a(-0x51,-0x9c,-0x16,-0x13)]){if(_0x756a9f){const _0x1a4aee=_0x1b835e[_0x46287a(-0x32,-0x67,-0x63,-0x44)](_0x2e1290,arguments);return _0x650e0f=null,_0x1a4aee;}}else{const {original:_0x33c7d9,cleaned:_0x4249d4,skip:_0x9d51f}=_0x45616f;if(_0x9d51f){if(_0x26ebdc['ntytk'](_0x26ebdc[_0x46287a(-0x4b,-0x67,-0x3b,-0x3)],_0x26ebdc['QVSzH']))_0x2d8267(),_0x37e66a(new _0x3393ac(_0x4e2bfe(0x4af,0x444,0x4cf,0x489)+'时（'+_0x265b4e+'ms）'));else{const _0x182183={};return _0x182183['original']=_0x33c7d9,_0x182183['translatio'+'n']='',_0x182183[_0x46287a(-0x5c,-0x1e,-0x2d,-0x59)]=_0x4249d4,_0x182183[_0x46287a(-0x3a,-0x2c,-0x24,-0x42)]=!![],_0x182183;}}const _0x4a833a=_0x1a169d[_0x4249d4[_0x46287a(-0xaf,-0x81,-0x93,-0xd6)+'e']()]||'',_0x4e54aa={};return _0x4e54aa['original']=_0x33c7d9,_0x4e54aa[_0x4e2bfe(0x3fd,0x3f6,0x45c,0x42a)+'n']=_0x4a833a,_0x4e54aa[_0x46287a(-0x5c,-0x93,-0x8f,-0x8d)]=_0x4249d4,_0x4e54aa['skipped']=![],_0x4e54aa;}});}function _0x5d13(_0x11641f,_0x56b2cd){_0x11641f=_0x11641f-(0x6*0x1c5+-0x1632+0xc3f);const _0x2c5c19=_0x24bd();let _0x3b094c=_0x2c5c19[_0x11641f];if(_0x5d13['QEIqBR']===undefined){var _0x339018=function(_0x3b01f7){const _0x2c548e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3e46e6='',_0x19f3ca='',_0x4b43c3=_0x3e46e6+_0x339018;for(let _0x4a5848=0x2530+0x120a+-0x373a,_0x143c7d,_0xf42024,_0x544a1e=0x1d69*0x1+-0x11d1*-0x2+-0x410b;_0xf42024=_0x3b01f7['charAt'](_0x544a1e++);~_0xf42024&&(_0x143c7d=_0x4a5848%(0xc+-0x7*0x4d9+0x21e7)?_0x143c7d*(0xeea+0x1*0x1223+-0x3*0xaef)+_0xf42024:_0xf42024,_0x4a5848++%(0x1c6e+-0x232+-0x1a38))?_0x3e46e6+=_0x4b43c3['charCodeAt'](_0x544a1e+(-0x8e0+0x771+0x179))-(-0x207d+-0x1088+0x310f)!==0x2278+0x1e6+-0x245e?String['fromCharCode'](-0xb7*-0x30+-0x17f*0xb+-0x2*0x86e&_0x143c7d>>(-(-0xd12*0x1+0x24f1+-0x29*0x95)*_0x4a5848&-0x1*-0x1040+0x638+-0xdd*0x1a)):_0x4a5848:0x13b4+0x25b5+-0x45*0xd5){_0xf42024=_0x2c548e['indexOf'](_0xf42024);}for(let _0x4c750b=0x65*-0xe+-0x1df*-0x13+-0x1e07*0x1,_0x6f3048=_0x3e46e6['length'];_0x4c750b<_0x6f3048;_0x4c750b++){_0x19f3ca+='%'+('00'+_0x3e46e6['charCodeAt'](_0x4c750b)['toString'](-0x64d*0x2+0x4f*-0x47+0xa7*0x35))['slice'](-(0x5cf*0x5+-0xde9+-0xf20));}return decodeURIComponent(_0x19f3ca);};_0x5d13['GDCtvy']=_0x339018,_0x5d13['kofdjw']={},_0x5d13['QEIqBR']=!![];}const _0x422640=_0x2c5c19[0xd32*0x2+-0xdf1+-0x1*0xc73],_0x4f644e=_0x11641f+_0x422640,_0x283b40=_0x5d13['kofdjw'][_0x4f644e];if(!_0x283b40){const _0x19cc81=function(_0x25bb64){this['krSyPH']=_0x25bb64,this['FrRaFW']=[-0x18f6+-0x37b+-0xb*-0x296,0x403*0x5+0x1adf+-0x2eee,0x1bee+-0x12a8+-0x1*0x946],this['vRxmeK']=function(){return'newState';},this['dgacDu']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['LaZWQh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x19cc81['prototype']['FdynUs']=function(){const _0x4b76a1=new RegExp(this['dgacDu']+this['LaZWQh']),_0x3331ed=_0x4b76a1['test'](this['vRxmeK']['toString']())?--this['FrRaFW'][-0x1*0x28e+0x2*-0x1319+0x28c1]:--this['FrRaFW'][-0xc3a+-0xb90+0x17ca];return this['XXIyFl'](_0x3331ed);},_0x19cc81['prototype']['XXIyFl']=function(_0x32f406){if(!Boolean(~_0x32f406))return _0x32f406;return this['oDZLZX'](this['krSyPH']);},_0x19cc81['prototype']['oDZLZX']=function(_0x105cb6){for(let _0x500ebc=-0xe05*-0x1+0xe18+0x95f*-0x3,_0x230687=this['FrRaFW']['length'];_0x500ebc<_0x230687;_0x500ebc++){this['FrRaFW']['push'](Math['round'](Math['random']())),_0x230687=this['FrRaFW']['length'];}return _0x105cb6(this['FrRaFW'][0x1409+0x56*0x74+-0x3b01]);},new _0x19cc81(_0x5d13)['FdynUs'](),_0x3b094c=_0x5d13['GDCtvy'](_0x3b094c),_0x5d13['kofdjw'][_0x4f644e]=_0x3b094c;}else _0x3b094c=_0x283b40;return _0x3b094c;}export function formatTranslationDisplay(_0x4e9e0b,_0x2f69e9={}){const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x2f69e9;function _0x4dc04c(_0x362644,_0x572f04,_0x1cd8db,_0x4ffd38){return _0x5d13(_0x572f04- -0x200,_0x1cd8db);}function _0x445a1f(_0x2a3cf0,_0x4aabef,_0xfcbcc2,_0x3042d2){return _0x5d13(_0x2a3cf0-0x1cf,_0xfcbcc2);}if(!_0x4e9e0b||!Array[_0x4dc04c(-0x9e,-0xdf,-0xe4,-0xc8)](_0x4e9e0b))return'';return _0x4e9e0b[_0x445a1f(0x2b9,0x2ee,0x282,0x285)](_0x9a12e6=>{function _0x2034d3(_0x1b3db3,_0x29a97c,_0x161957,_0x3eb5d7){return _0x4dc04c(_0x1b3db3-0x1df,_0x1b3db3-0x131,_0x29a97c,_0x3eb5d7-0x70);}if(_0x9a12e6[_0x299341(-0x12c,-0xf5,-0x115,-0xf2)])return showOriginal?_0x9a12e6[_0x2034d3(0x70,0x78,0x2b,0x68)]:'';function _0x299341(_0x559167,_0x3b7e9d,_0x1b20ca,_0x319177){return _0x4dc04c(_0x559167-0x1f1,_0x3b7e9d- -0x1f,_0x1b20ca,_0x319177-0x103);}const _0x171a77=[];if(showOriginal)_0x171a77[_0x2034d3(0x5d,0x3c,0x87,0x86)](_0x9a12e6[_0x2034d3(0x70,0x4c,0x41,0x98)]);return showTranslation&&_0x9a12e6['translatio'+'n']&&_0x171a77[_0x299341(-0xe6,-0xf3,-0xac,-0x110)]('('+_0x9a12e6[_0x2034d3(-0x22,-0x5d,-0x2c,0x25)+'n']+')'),_0x171a77[_0x299341(-0x151,-0x13a,-0x173,-0x16c)]('\x20');})['filter'](Boolean)[_0x445a1f(0x2b4,0x2ba,0x26a,0x27f)](separator);}export async function translatePromptTags(_0x3a1845){const _0x5d5420={'Vjkkh':function(_0x26e96d,_0x8390de){return _0x26e96d(_0x8390de);},'GzzTu':function(_0x5b95a0,_0x19abaa){return _0x5b95a0===_0x19abaa;},'HqKQl':_0x54c59f(0x463,0x42c,0x41e,0x429),'gugBX':function(_0x5322bb,_0x338c62){return _0x5322bb(_0x338c62);},'PTeWF':function(_0xf15476,_0x1a8bbb,_0x19e619){return _0xf15476(_0x1a8bbb,_0x19e619);},'zDJsX':_0x54c59f(0x486,0x484,0x455,0x4cf)+_0x47a346(-0x2b2,-0x259,-0x227,-0x268)+':'},{originalTags:_0x3f22a4,cleanedText:_0x243117}=_0x5d5420[_0x54c59f(0x46c,0x484,0x43b,0x4ad)](preprocessPromptForTranslation,_0x3a1845);function _0x47a346(_0x28eba1,_0x525828,_0x4e673b,_0x5d4d7a){return _0x5d13(_0x5d4d7a- -0x3a5,_0x28eba1);}function _0x54c59f(_0x5d7fe8,_0x428411,_0x49874e,_0x54a303){return _0x5d13(_0x5d7fe8-0x393,_0x54a303);}if(!_0x243117){const _0x5a449c={};return _0x5a449c['results']=[],_0x5a449c[_0x47a346(-0x2df,-0x310,-0x30d,-0x2e8)+'t']='',_0x5a449c['originalTa'+'gs']=[],_0x5a449c;}try{if(_0x5d5420[_0x47a346(-0x2db,-0x2a6,-0x249,-0x294)](_0x5d5420['HqKQl'],_0x5d5420['HqKQl'])){const _0x3941ad=await _0x5d5420['gugBX'](callTranslation,_0x243117),_0x4eb6ca=_0x5d5420[_0x54c59f(0x480,0x490,0x480,0x47a)](parseTranslationResult,_0x3941ad),_0x524b45=_0x5d5420[_0x47a346(-0x2de,-0x2f6,-0x2b0,-0x2d3)](combineTranslationResult,_0x3f22a4,_0x4eb6ca),_0x273369=formatTranslationDisplay(_0x524b45),_0x396f92={};return _0x396f92[_0x54c59f(0x453,0x445,0x422,0x407)]=_0x524b45,_0x396f92[_0x54c59f(0x450,0x485,0x46d,0x40e)+'t']=_0x273369,_0x396f92[_0x47a346(-0x2cb,-0x272,-0x24c,-0x288)+'gs']=_0x3f22a4,_0x396f92;}else{if(!_0x3746d7[_0x47a346(-0x268,-0x2a6,-0x23a,-0x284)](_0x47fa6a))return'[]';return _0x2f3efc[_0x47a346(-0x2b2,-0x2c0,-0x2a8,-0x285)](_0x2db428[_0x47a346(-0x2e7,-0x2e1,-0x2b5,-0x2ca)](_0x58e1ea=>_0x58e1ea&&typeof _0x58e1ea===_0x47a346(-0x287,-0x263,-0x247,-0x27f)));}}catch(_0x98d810){console[_0x54c59f(0x487,0x4ca,0x4a6,0x45f)](_0x5d5420[_0x54c59f(0x483,0x4b5,0x470,0x457)],_0x98d810);throw _0x98d810;}}export function parseTranslationResult(_0x1b81a8){function _0x543cdc(_0x9b9c71,_0x32f3b3,_0x1bd354,_0xe0531d){return _0x5d13(_0xe0531d- -0x2a3,_0x9b9c71);}function _0x173189(_0x54a346,_0x22177a,_0x3adb91,_0x4cba6e){return _0x5d13(_0x22177a- -0x285,_0x4cba6e);}const _0x907a94={'ouPSs':function(_0x4c153e,_0x1b814e){return _0x4c153e!==_0x1b814e;},'FnQWS':function(_0x2304a9,_0x5bbb7c){return _0x2304a9(_0x5bbb7c);},'nHNxT':'获取翻译提示词超时','rBHns':function(_0x20047c){return _0x20047c();},'hElcw':function(_0xb7f3b2,_0x805958,_0x442bf7){return _0xb7f3b2(_0x805958,_0x442bf7);},'Hhzva':function(_0x461345,_0x4d3637){return _0x461345===_0x4d3637;},'THUVd':_0x173189(-0x173,-0x1bd,-0x1e9,-0x172),'RORgd':function(_0x3c80a3,_0x248aec){return _0x3c80a3===_0x248aec;},'DZKwn':function(_0x130ce8,_0x2d7e93){return _0x130ce8>_0x2d7e93;}};if(!_0x1b81a8)return{};try{const _0x26a684=_0x1b81a8['match'](/\{[\s\S]*\}/);if(_0x26a684){if(_0x907a94[_0x543cdc(-0x1ad,-0x1d2,-0x1d0,-0x1cc)](_0x173189(-0x1b3,-0x1bd,-0x17f,-0x173),_0x907a94[_0x543cdc(-0x1e0,-0x1b1,-0x208,-0x1eb)])){const _0x2851d1=JSON['parse'](_0x26a684[-0x9d4+-0x25ee+0x2fc2]);if(_0x907a94[_0x543cdc(-0x237,-0x22c,-0x1e5,-0x1f5)](typeof _0x2851d1,_0x543cdc(-0x183,-0x1e4,-0x1bc,-0x1c0))&&_0x2851d1!==null)return _0x2851d1;}else{const _0x1f4d7b=_0x907a94[_0x543cdc(-0x23a,-0x216,-0x215,-0x1f2)](_0x5c2ba4);_0x472d94['log'](_0x543cdc(-0x186,-0x198,-0x19e,-0x1b0)+_0x543cdc(-0x1a4,-0x163,-0x17b,-0x18c)+_0x173189(-0x1fe,-0x1b7,-0x1d0,-0x17f)+_0x1f4d7b+')');const _0x40d620=_0x559037=>{if(_0x907a94[_0x274cf3(-0x2df,-0x2a6,-0x2a3,-0x2ae)](_0x559037['id'],_0x1f4d7b))return;function _0x584735(_0x102042,_0x1d18ed,_0x1d6169,_0x4e22be){return _0x173189(_0x102042-0x12f,_0x102042-0x3,_0x1d6169-0xd4,_0x4e22be);}function _0x274cf3(_0xcaca91,_0x549774,_0x431af6,_0x204cc6){return _0x543cdc(_0x549774,_0x549774-0xa1,_0x431af6-0xa2,_0x204cc6- -0xc4);}_0x53c7a5[_0x584735(-0x196,-0x17a,-0x191,-0x193)+_0x584735(-0x15e,-0x180,-0x133,-0x1aa)](_0x25b5f7[_0x274cf3(-0x296,-0x27a,-0x293,-0x268)+_0x274cf3(-0x25c,-0x24d,-0x278,-0x267)+_0x274cf3(-0x258,-0x283,-0x248,-0x261)+_0x274cf3(-0x227,-0x201,-0x225,-0x240)],_0x40d620);const {prompt:_0x2a8780}=_0x559037;_0x3e9cdb['log'](_0x274cf3(-0x26f,-0x2a2,-0x26d,-0x274)+_0x584735(-0x1d3,-0x1aa,-0x212,-0x208)+_0x584735(-0x148,-0x18c,-0x14e,-0x13b)+_0x1f4d7b+'):',_0x2a8780),_0x907a94[_0x584735(-0x1bd,-0x18c,-0x206,-0x191)](_0x7fd20b,_0x2a8780);};_0x3fdf25['on'](_0x3808f7[_0x173189(-0x185,-0x186,-0x1ae,-0x160)+_0x543cdc(-0x194,-0x199,-0x1e1,-0x1a3)+_0x543cdc(-0x199,-0x1bf,-0x1bb,-0x19d)+_0x173189(-0x11d,-0x15e,-0x18c,-0x195)],_0x40d620);const _0x2f4a13={};_0x2f4a13['id']=_0x1f4d7b,_0x9be4f5[_0x173189(-0x17b,-0x17c,-0x16f,-0x14d)](_0x1b1463['LLM_TRANSL'+_0x173189(-0x1bc,-0x185,-0x189,-0x178)+_0x543cdc(-0x139,-0x145,-0x1af,-0x17e)+_0x173189(-0x12d,-0x173,-0x154,-0x17b)],_0x2f4a13),_0x907a94[_0x543cdc(-0x14e,-0x163,-0x1ad,-0x198)](_0x7eb1c,()=>{function _0x3b97ac(_0x26b297,_0x426f1e,_0x1c6e54,_0x1d2ad8){return _0x543cdc(_0x426f1e,_0x426f1e-0x1b4,_0x1c6e54-0x1af,_0x1d2ad8- -0x117);}_0x1793e7[_0x3b97ac(-0x2f1,-0x309,-0x290,-0x2ce)+_0x3b97ac(-0x2dc,-0x2bd,-0x2c9,-0x296)](_0x312049[_0x3b97ac(-0x2fb,-0x293,-0x273,-0x2bb)+_0x5cd5af(-0xb4,-0xd2,-0xd1,-0xbb)+_0x3b97ac(-0x28e,-0x2e0,-0x27b,-0x2b4)+_0x3b97ac(-0x275,-0x2df,-0x278,-0x293)],_0x40d620);function _0x5cd5af(_0x12e5fa,_0x3dd600,_0x21899c,_0x51714b){return _0x173189(_0x12e5fa-0x1a6,_0x51714b-0xca,_0x21899c-0x5,_0x21899c);}_0x47e856(new _0x3d99b6(_0x907a94[_0x3b97ac(-0x28b,-0x2b0,-0x257,-0x284)]));},-0x25f2+-0x1d7*0x2+-0x50b0*-0x1);}}}catch(_0xdbdd47){console[_0x173189(-0x147,-0x18e,-0x1a0,-0x151)](_0x173189(-0x18a,-0x192,-0x169,-0x15a)+_0x543cdc(-0x1d3,-0x1c8,-0x1a9,-0x1a7)+_0x543cdc(-0x1c3,-0x1c4,-0x1a7,-0x1dd),_0xdbdd47[_0x173189(-0x162,-0x1a1,-0x1c1,-0x17e)]);}const _0x507db1=String(_0x1b81a8)['replace'](/[\r\n]+/g,'\x20')[_0x543cdc(-0x1af,-0x1a3,-0x160,-0x195)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x173189(-0x16a,-0x1a4,-0x180,-0x1ef)](),_0x461bd6=_0x507db1[_0x543cdc(-0x199,-0x134,-0x17d,-0x180)](/[,，]/)['map'](_0x2d2b77=>_0x2d2b77[_0x543cdc(-0x199,-0x1bc,-0x1a0,-0x1c2)]())['filter'](Boolean),_0x4ae0a3={};for(const _0x165c0d of _0x461bd6){const _0x33365c=_0x165c0d['indexOf']('\x5c');if(_0x907a94['DZKwn'](_0x33365c,-0x13*-0x10f+0xe8b+-0x1154*0x2)){const _0x13c336=_0x165c0d[_0x173189(-0x1a5,-0x176,-0x16a,-0x182)](0x7*0x4ff+0xd6d*-0x1+0x4*-0x563,_0x33365c)[_0x173189(-0x1a5,-0x1a4,-0x162,-0x1a6)](),_0xd34808=_0x165c0d['slice'](_0x33365c+(-0x1d2*-0xe+-0x1*-0xbfb+-0x2576))['trim']();if(_0x13c336)_0x4ae0a3[_0x13c336]=_0xd34808;}}return _0x4ae0a3;}function generateRequestId(){const _0x58a822={};function _0x181239(_0x19aaff,_0x148b42,_0x2f037e,_0x3f8966){return _0x5d13(_0x2f037e- -0x346,_0x148b42);}_0x58a822['iWmBc']=function(_0xa44d1d,_0x4e8f36){return _0xa44d1d+_0x4e8f36;};const _0x1c8948=_0x58a822;function _0x1c3054(_0x20e56b,_0x46bdb1,_0x15e71c,_0x54656c){return _0x5d13(_0x46bdb1-0x270,_0x20e56b);}if(crypto&&crypto[_0x181239(-0x27b,-0x278,-0x23f,-0x230)])return crypto['randomUUID']();return _0x1c8948[_0x1c3054(0x34f,0x32c,0x309,0x326)](Date[_0x1c3054(0x2f7,0x33f,0x37d,0x350)]()['toString'](0x26a5+-0x25a9*-0x1+0x2615*-0x2),Math[_0x1c3054(0x395,0x362,0x31e,0x321)]()[_0x1c3054(0x3c8,0x3b3,0x3d0,0x385)](-0x1734+-0x1e2+0x193a)['substring'](0x19dc+-0x2173+-0x799*-0x1));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x5f30bb(_0xdd3243,_0x1c7234,_0x29f9f1,_0x49d59d){return _0x5d13(_0x49d59d-0x1e8,_0xdd3243);}const _0x199db5={'NIBWl':function(_0xc4bb7f,_0x473ea0){return _0xc4bb7f!==_0x473ea0;},'NenhN':'VXnks','aeRvc':function(_0x86102c,_0xafa38b){return _0x86102c(_0xafa38b);},'SfqNx':_0x421a4b(-0x2f3,-0x2ac,-0x2c7,-0x2b4),'GYgPC':_0x5f30bb(0x326,0x2e9,0x2cb,0x2e3),'TdyZz':function(_0x412608){return _0x412608();},'PYbaA':function(_0x412223,_0x31b9fb,_0x7f3021){return _0x412223(_0x31b9fb,_0x7f3021);}};function _0x421a4b(_0xa78b4e,_0x55f10d,_0x50d3a6,_0x1a2192){return _0x5d13(_0xa78b4e- -0x3d2,_0x50d3a6);}return new Promise((_0x4bcfc8,_0x460f60)=>{function _0x377dd8(_0x23a8a7,_0x320d0,_0x3afbf5,_0x4231f3){return _0x421a4b(_0x23a8a7-0x2aa,_0x320d0-0x12d,_0x320d0,_0x4231f3-0xc2);}function _0x443c92(_0x59f67e,_0x981df4,_0x52d304,_0x3cfa2f){return _0x5f30bb(_0x52d304,_0x981df4-0x14d,_0x52d304-0x128,_0x3cfa2f-0xc6);}const _0x5613b3={};_0x5613b3[_0x377dd8(-0x23,-0x56,-0x5f,-0xe)]=function(_0x180b1c,_0x4c36b8){return _0x180b1c!==_0x4c36b8;};const _0xaba63f=_0x5613b3;if(_0x199db5[_0x443c92(0x3c4,0x3b9,0x3ed,0x3d0)](_0x443c92(0x3da,0x377,0x3b4,0x3a9),_0x199db5['GYgPC']))_0x2cfb32[_0x377dd8(0x4,0x1d,0x3f,0x3c)]('('+_0xd7ad40[_0x443c92(0x352,0x32f,0x32e,0x35b)+'n']+')');else{const _0xc55493=_0x199db5[_0x443c92(0x419,0x405,0x39d,0x3e6)](generateRequestId);console[_0x377dd8(-0x6e,-0x78,-0x8f,-0x98)](_0x443c92(0x381,0x3a3,0x376,0x3a1)+_0x377dd8(-0x11,0x9,-0x50,-0x17)+_0x443c92(0x397,0x33e,0x33d,0x37c)+_0xc55493+')');const _0x553c8a=_0x903a8c=>{function _0x2142f3(_0x2807af,_0x5c4a6b,_0x476889,_0x250963){return _0x377dd8(_0x250963-0x295,_0x2807af,_0x476889-0x15a,_0x250963-0x7d);}function _0x5cb4bc(_0x423bf4,_0x291f0a,_0x532a7d,_0xb332b8){return _0x377dd8(_0x532a7d- -0x25b,_0xb332b8,_0x532a7d-0x187,_0xb332b8-0x18c);}if(_0x199db5['NIBWl'](_0x199db5[_0x5cb4bc(-0x2c7,-0x2ef,-0x2ae,-0x2af)],'VXnks')){if(_0xaba63f[_0x5cb4bc(-0x266,-0x253,-0x27e,-0x237)](_0x162fa6['id'],_0x262e52))return;_0x50b5f4['removeList'+_0x2142f3(0x2a7,0x271,0x2b3,0x291)](_0x46a277[_0x2142f3(0x2ac,0x242,0x258,0x26c)+_0x2142f3(0x295,0x27a,0x221,0x26d)+_0x5cb4bc(-0x244,-0x2a0,-0x27d,-0x29b)+'PONSE'],_0x2333a2);const {prompt:_0x161d51}=_0x2f85b7;_0x1cc7ef[_0x2142f3(0x23f,0x202,0x22e,0x227)](_0x2142f3(0x21f,0x247,0x218,0x260)+_0x5cb4bc(-0x306,-0x2e0,-0x2d4,-0x2ba)+_0x2142f3(0x287,0x299,0x28b,0x2a7)+_0x27af06+'):',_0x161d51),_0x2570c1(_0x161d51);}else{if(_0x903a8c['id']!==_0xc55493)return;eventSource['removeList'+_0x5cb4bc(-0x24e,-0x284,-0x25f,-0x27f)](eventNames[_0x5cb4bc(-0x265,-0x26a,-0x284,-0x244)+_0x5cb4bc(-0x2c1,-0x248,-0x283,-0x2a9)+_0x2142f3(0x298,0x26d,0x23e,0x273)+_0x5cb4bc(-0x280,-0x2a5,-0x25c,-0x251)],_0x553c8a);const {prompt:_0x1b45e2}=_0x903a8c;console[_0x2142f3(0x20f,0x21f,0x24e,0x227)](_0x2142f3(0x236,0x230,0x2a2,0x260)+_0x2142f3(0x1ee,0x206,0x23f,0x21c)+'(ID:\x20'+_0xc55493+'):',_0x1b45e2),_0x199db5[_0x2142f3(0x23e,0x29a,0x29b,0x288)](_0x4bcfc8,_0x1b45e2);}};eventSource['on'](eventNames[_0x443c92(0x3c5,0x3e6,0x38c,0x3ad)+_0x443c92(0x3c3,0x3f1,0x38e,0x3ae)+_0x377dd8(-0x22,-0x63,0x10,-0x4)+_0x377dd8(-0x1,-0x11,-0x15,-0x48)],_0x553c8a);const _0x5f40c0={};_0x5f40c0['id']=_0xc55493,eventSource[_0x377dd8(-0x1f,-0x54,-0x48,-0x14)](eventNames[_0x443c92(0x381,0x3b7,0x3a8,0x3ad)+_0x377dd8(-0x28,-0x39,-0x2,0x1f)+_0x443c92(0x389,0x3c2,0x3b0,0x3d3)+_0x377dd8(-0x16,-0x2d,0x36,0x1)],_0x5f40c0),_0x199db5[_0x443c92(0x3bb,0x39b,0x3c6,0x3a4)](setTimeout,()=>{eventSource[_0x114330(-0x1e2,-0x1bf,-0x17d,-0x205)+_0x114330(-0x1b7,-0x187,-0x150,-0x186)](eventNames[_0x2dcb25(-0x26,0x1d,-0x7,0x11)+_0x2dcb25(0x44,0x1e,-0x27,-0x8)+'PROMPT_RES'+_0x2dcb25(0x81,0x45,0x6a,0x83)],_0x553c8a);function _0x2dcb25(_0x193946,_0x46dff3,_0x2807e0,_0x71e114){return _0x443c92(_0x193946-0x181,_0x46dff3-0x10c,_0x2807e0,_0x46dff3- -0x390);}function _0x114330(_0x239dd0,_0x2ec8cd,_0x571c24,_0xcd53f4){return _0x377dd8(_0x2ec8cd- -0x183,_0x239dd0,_0x571c24-0x155,_0xcd53f4-0x4e);}_0x199db5[_0x114330(-0x159,-0x190,-0x1d2,-0x145)](_0x460f60,new Error(_0x199db5[_0x2dcb25(-0xc,-0x19,0x11,-0x4f)]));},-0x18b0*-0x2+-0x45d*-0x2+0x985*-0x2);}});}export function LLM_TRANSLATION(_0x490130,{timeoutMs:timeoutMs=-0x3*0x51a+0x3a27*-0x1+0x133d5}={}){const _0x2bf8df={'OfHAs':function(_0x1495b5){return _0x1495b5();},'ZOikL':function(_0x53dd6a,_0x4a60a8){return _0x53dd6a(_0x4a60a8);},'dDXqd':function(_0x40f89a,_0x21d24b){return _0x40f89a!==_0x21d24b;},'gIVLD':function(_0x510e85,_0x5aec47){return _0x510e85===_0x5aec47;},'HsDRa':_0x44050d(-0x14d,-0x122,-0x136,-0x128),'aKDFe':function(_0x2d5110){return _0x2d5110();},'OgFWi':function(_0x47e8d9,_0x4578eb,_0x20a938){return _0x47e8d9(_0x4578eb,_0x20a938);}};function _0x44050d(_0x24c00d,_0x263c23,_0x54fb9e,_0x3baf80){return _0x5d13(_0x24c00d- -0x286,_0x3baf80);}return new Promise((_0x3cfc3d,_0x30189d)=>{const _0x3345f2={'bItMp':function(_0x3139b9,_0x277474){return _0x2bf8df['dDXqd'](_0x3139b9,_0x277474);},'zuvXS':function(_0xe36295){return _0x2bf8df['OfHAs'](_0xe36295);},'LPlel':'kEijl','zzJfI':function(_0x159f0b,_0x538f9a){function _0x31ae15(_0x319fce,_0x1cf3b1,_0x2e776d,_0xe6f44){return _0x5d13(_0x2e776d-0x6b,_0x1cf3b1);}return _0x2bf8df[_0x31ae15(0x15f,0x159,0x19e,0x177)](_0x159f0b,_0x538f9a);},'rZcGY':_0x2bf8df['HsDRa'],'ywmRP':function(_0x21fc8f,_0x3d6def){function _0x232cc1(_0x405895,_0x41b933,_0x44c97c,_0x297eb3){return _0x5d13(_0x44c97c- -0x352,_0x297eb3);}return _0x2bf8df[_0x232cc1(-0x221,-0x26e,-0x22a,-0x26b)](_0x21fc8f,_0x3d6def);}},_0x216954=_0x2bf8df['aKDFe'](generateRequestId);function _0x10b5cf(_0x599daf,_0x2dd7f2,_0x463d94,_0x47f15d){return _0x44050d(_0x2dd7f2-0x647,_0x2dd7f2-0x1d9,_0x463d94-0xd9,_0x599daf);}console['log'](_0x486db5(-0x1fc,-0x1ea,-0x21e,-0x204)+_0x10b5cf(0x520,0x4ea,0x500,0x4ea)+_0x10b5cf(0x4e5,0x4fb,0x547,0x502)+_0x216954+')');let _0x34c4ae=null;const _0x2b1cd6=()=>{eventSource[_0x4d133b(0x43c,0x413,0x417,0x41c)+_0x1a9ea5(0x201,0x1ad,0x1d5,0x1dd)](eventNames[_0x4d133b(0x44f,0x403,0x431,0x416)+_0x4d133b(0x42e,0x409,0x409,0x42d)+_0x4d133b(0x42c,0x43e,0x3e9,0x421)],_0x15fb13);function _0x1a9ea5(_0x330515,_0x2b0a0e,_0x3ddca1,_0x22f277){return _0x486db5(_0x2b0a0e,_0x3ddca1-0x38e,_0x3ddca1-0x8c,_0x22f277-0x167);}function _0x4d133b(_0x326423,_0x1ddb7e,_0x26c5a2,_0x1e8d6a){return _0x486db5(_0x1ddb7e,_0x326423-0x62d,_0x26c5a2-0x48,_0x1e8d6a-0x146);}if(_0x34c4ae)clearTimeout(_0x34c4ae);},_0x15fb13=_0x4a267e=>{if(_0x3345f2['bItMp'](_0x4a267e['id'],_0x216954))return;function _0x1a2361(_0x213a5f,_0x423a2a,_0x4cfda2,_0x5ea5a9){return _0x486db5(_0x4cfda2,_0x423a2a-0x645,_0x4cfda2-0x1ca,_0x5ea5a9-0x1b4);}function _0x5da302(_0xf5bbcf,_0x126fb6,_0x124a61,_0x25ce49){return _0x486db5(_0x126fb6,_0x25ce49-0xae,_0x124a61-0x48,_0x25ce49-0xdb);}_0x3345f2[_0x5da302(-0x1a1,-0x10f,-0x158,-0x15c)](_0x2b1cd6),console['log'](_0x1a2361(0x4a5,0x45b,0x42a,0x48a)+_0x1a2361(0x448,0x460,0x480,0x4ab)+_0x5da302(-0x14e,-0x155,-0x160,-0x14f)+'\x20'+_0x216954+'):',_0x4a267e);if(_0x4a267e['success'])_0x3cfc3d(_0x4a267e[_0x5da302(-0xff,-0x10b,-0x108,-0xf8)]);else{if(_0x3345f2['bItMp']('URNtk',_0x3345f2[_0x5da302(-0x151,-0x150,-0x13a,-0x179)])){if(_0x4a267e['error']&&_0x3345f2[_0x5da302(-0xd0,-0x154,-0x107,-0x117)](_0x4a267e[_0x1a2361(0x47b,0x45c,0x43f,0x463)][_0x5da302(-0xd1,-0x11e,-0x118,-0x11a)],_0x3345f2[_0x5da302(-0x13d,-0x16f,-0x175,-0x15e)])){const _0x2110cf=new Error(_0x4a267e[_0x5da302(-0x122,-0x150,-0x158,-0x13b)][_0x1a2361(0x48c,0x44c,0x413,0x424)]);_0x2110cf[_0x5da302(-0x14b,-0x139,-0xd0,-0x11a)]=_0x3345f2[_0x1a2361(0x429,0x439,0x41e,0x473)],_0x3345f2['ywmRP'](_0x30189d,_0x2110cf);}else _0x30189d(new Error(_0x4a267e['result']));}else{const _0x59e095=_0x2cb545[_0x5da302(-0x11a,-0xfe,-0x130,-0xfd)](_0x25b283,arguments);return _0x5990bb=null,_0x59e095;}}};function _0x486db5(_0x168da2,_0x4edcaa,_0x29e305,_0x19794e){return _0x44050d(_0x4edcaa- -0x57,_0x4edcaa-0x179,_0x29e305-0x7a,_0x168da2);}eventSource['on'](eventNames[_0x486db5(-0x222,-0x1de,-0x222,-0x1f4)+_0x486db5(-0x21b,-0x1ff,-0x207,-0x1b9)+_0x10b5cf(0x4c9,0x49d,0x4d6,0x456)],_0x15fb13);const _0x516e3b={};_0x516e3b[_0x486db5(-0x1e5,-0x19b,-0x152,-0x15a)]=_0x490130,_0x516e3b['id']=_0x216954,eventSource['emit'](eventNames['LLM_TRANSL'+'ATION_REQU'+_0x10b5cf(0x516,0x501,0x4df,0x51a)],_0x516e3b),_0x34c4ae=_0x2bf8df['OgFWi'](setTimeout,()=>{function _0x2bf071(_0x15db23,_0x5e2c07,_0xa1cca,_0x4e11ad){return _0x10b5cf(_0x5e2c07,_0x4e11ad- -0x58f,_0xa1cca-0x33,_0x4e11ad-0x124);}function _0x52c782(_0x3eb7b4,_0x312b6b,_0x4f02bd,_0x44ce86){return _0x10b5cf(_0x44ce86,_0x4f02bd- -0x632,_0x4f02bd-0x1ee,_0x44ce86-0x15f);}_0x2bf8df[_0x52c782(-0x1af,-0x156,-0x180,-0x1af)](_0x2b1cd6),_0x2bf8df[_0x52c782(-0x101,-0x185,-0x149,-0x11a)](_0x30189d,new Error(_0x52c782(-0x19e,-0x12d,-0x165,-0x167)+'时（'+timeoutMs+_0x2bf071(-0xdd,-0x101,-0x10b,-0x11a)));},timeoutMs);});}export async function callTranslation(_0x5804c1){const _0x433709={'bDqhv':_0x3b7c8a(0x1e5,0x21d,0x216,0x200)+'n','dkvuC':function(_0x43339f,_0x10db71){return _0x43339f||_0x10db71;},'BoBbd':function(_0x42df12,_0x5e5c0a){return _0x42df12(_0x5e5c0a);},'LsCXI':_0xa40939(0x95,0xc0,0xdc,0xac),'HuFeq':function(_0x2103ce,_0x2dfcf7){return _0x2103ce||_0x2dfcf7;},'pkhXZ':function(_0x45cdf9,_0x321113){return _0x45cdf9(_0x321113);},'RWvAN':function(_0x10758f,_0x19605c){return _0x10758f(_0x19605c);},'okNDs':_0x3b7c8a(0x1ff,0x24b,0x1e0,0x1c2)};function _0xa40939(_0x1fca73,_0x56c632,_0x55cffd,_0x1d39dc){return _0x5d13(_0x1fca73- -0x38,_0x56c632);}function _0x3b7c8a(_0x563d64,_0x3e28b4,_0x2ca89c,_0x3c6b49){return _0x5d13(_0x563d64-0x138,_0x2ca89c);}try{let _0x19966d=buildPromptForRequestType(_0x433709[_0x3b7c8a(0x1f3,0x20c,0x1a7,0x1b9)],_0x433709['dkvuC'](_0x5804c1,''));_0x19966d=_0x433709[_0xa40939(0x8c,0x9e,0xd1,0x9b)](mergeAdjacentMessages,_0x19966d);const _0x5a971e=[..._0x19966d,{'role':_0x433709['LsCXI'],'content':_0x433709['HuFeq'](_0x5804c1,'')}];_0x433709[_0xa40939(0x8c,0xb7,0xd1,0x6e)](updateCombinedPrompt,_0x5a971e);const _0x4d1bc8=await _0x433709['pkhXZ'](LLM_TRANSLATION,_0x5a971e);return _0x4d1bc8;}catch(_0x2fa5d4){_0x433709[_0xa40939(0xaa,0xbd,0xa5,0xbe)](addLog,_0xa40939(0x7b,0x65,0xbc,0x43)+_0x2fa5d4[_0xa40939(0xac,0x70,0x67,0xa6)]),console[_0xa40939(0xbc,0x77,0xb2,0x90)](_0x433709['okNDs'],_0x2fa5d4);throw _0x2fa5d4;}}let isAiInitialized=![];export function initAiSettings(_0x1d2c3e){const _0x221bd2={};_0x221bd2[_0x19af14(0x389,0x3d2,0x3e0,0x3a1)]=function(_0x401d06,_0x150bb3){return _0x401d06>_0x150bb3;};function _0x19af14(_0x35e9b3,_0x43a39f,_0x383152,_0x42f2b8){return _0x5d13(_0x43a39f-0x314,_0x383152);}function _0x388ae8(_0x157b04,_0x1a0a02,_0x4d5db0,_0x24199f){return _0x5d13(_0x1a0a02-0x176,_0x157b04);}_0x221bd2[_0x19af14(0x43b,0x441,0x485,0x428)]=function(_0x52f4e,_0x53804e){return _0x52f4e+_0x53804e;},_0x221bd2['RImtA']=function(_0x423cd4,_0x4cd994){return _0x423cd4===_0x4cd994;},_0x221bd2[_0x19af14(0x37a,0x3bf,0x3c5,0x3c4)]='maxyY';const _0x924ce6=_0x221bd2;if(!isAiInitialized){if(_0x924ce6[_0x19af14(0x39a,0x3c6,0x3df,0x3b0)](_0x924ce6[_0x19af14(0x3a5,0x3bf,0x3c0,0x3e6)],_0x924ce6[_0x19af14(0x3d6,0x3bf,0x3b3,0x3af)]))console['log']('st-chatu8:'+_0x19af14(0x3a7,0x3c4,0x3f8,0x3e5)+_0x19af14(0x431,0x433,0x42d,0x480)),isAiInitialized=!![];else{const _0x5ac0f6=_0x5d3cec['indexOf']('\x5c');if(_0x924ce6[_0x19af14(0x40e,0x3d2,0x387,0x3a6)](_0x5ac0f6,0x164a+0x1*-0x262d+0xfe3)){const _0x4a2c5c=_0x4cfdb2[_0x388ae8(0x2a4,0x285,0x271,0x2b6)](0x9*0x32c+0x6eb+-0x1*0x2377,_0x5ac0f6)['trim'](),_0x169216=_0x48c6f7[_0x19af14(0x3f0,0x423,0x453,0x454)](_0x924ce6[_0x19af14(0x476,0x441,0x43f,0x417)](_0x5ac0f6,0x2*-0xbf1+-0x1eb9+0x1b4e*0x2))[_0x19af14(0x3dc,0x3f5,0x3f8,0x428)]();if(_0x4a2c5c)_0x3866f4[_0x4a2c5c]=_0x169216;}}}}function _0x24bd(){const _0xa22b2d=['qLjzrwW','vuPsqM0','C29Tzq','tufNBfO','A0XfzKi','yxbWBhK','z0Lwteq','weDOqMK','nZqXotm3De1fvMLA','BKHoEfq','CMvZDwX0','vgr5wNO','qwjVCNrfCNjVCG','keLeoIa','odC1otjXtxjwu0q','CfflALG','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','kcGOlISPkYKRkq','B3jPz2LUywW','rvnu','vhHIuw0','ChjVBxb0','Dg9tDhjPBMC','ELr3q1C','rMfht2m','DhjHBNnSyxrPBW','uK9sz2q','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','iefjioIUVUE9RUw3SUE7N+s4GowiSa','CKjiBNm','uKLTDee','57+76k+r5AsX6lsLoIa','BxpVViK','Dg9mB3DLCKnHCW','tfbSzwW','CgfYC2u','veHvvMq','B3vqu3m','Bg9N','yKrXAhy','AvDTqMm','zgLZCgXHEvrLEa','whjQDwi','C2TPCa','CMvZDwX0CW','q21vsue','svrZAvi','yvrhuNO','qM9cyMq','rM5rv1m','5BcD6k+v5PEN5Qc85BYpoG','57+76k+r5AsX6lsLoG','tgLet0m','u2zXtNG','DKDnA3q','DgvZDa','ntmYuwvWCNfc','DxnLCG','icHjrdOG','BM93','zhzMB2O','CLPJr1K','ufrLv0y','ENv2wfm','zwfbr3G','tMvUAe4','mJq1ode0mhbTqKHlvq','sgH6DMe','ww1wquO','vMPRA2G','uvztEKG','zMLSDgvY','t05trq','ufH4Duq','qvrjt05FuKvtua','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','ioAjP+IHJoE7K+AENcaOsuq6','DhjPBq','uLD2qu4','B2jQzwn0','BwvZC2fNzq','AM9PBG','EgLmDu0','mtq5mtyWnLLVzLDZCq','EMPjtvy','C2vHCMnO','BwfW','sfD6B1O','CMvTB3zLtgLZDa','z3vNqLG','mtCYnZG3ntzOvwzTtu4','Chzsuwy','EKrkC1G','t2ziqxm','CMfUzg9T','C3qTy2HHDhu4oG','zxjYB3i','mZe5mZzjB2X4tvG','ufLIyue','D2fYBG','iow3SUAuTUwiSoE/U+IVKsbmte0','yxfAveu','sNz5Che','Ag9bqNq','iePtt07OP6pMNPdLPlhOTkxVViW','mZu2ntyYnNfmCNDpCa','C2v0','teXnx1rsqu5tta','qvrjt05Fr0vuxW','EKPowMS','mtbfCffJzwK','BNr5DgS','mNf6yuHLuq','ALzkCve','ufjptvbux1jfuW','CMfUzg9Tvvvjra','y2XLyw5Lza','zw1PDa','vgXztfa','AevSy3C','57+76k+rieXmtsdMIAFOOyZOTOu','Bgrvquu','CMvWBgfJzq','C2XPy2u','Bw53Euy','r3P6vhu','vuvtva','CLnxAeq','y29UC3rYDwn0BW','BMfTzq','Ahf0C0q','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','ENPkzKK','ue1vvuW','yLnNs1a','ywvsDMm','Axnmthm','B3jPz2LUywXuyq','mtHkCgzNrfq','ieXmtsdORR7NVA7POBxPNAi','C3rYAw5NAwz5','AxnbCNjHEq','tKLcv2W','C3bSAxq','zw5LCG','ufjptvbux1jfuq','C3rYAw5N','ue9ou0u','wK9PA0W','ioIVT+AXGUE/U+IVKsbmte0G','C2TPChbLza','Bwf0y2G','ChvZAa'];_0x24bd=function(){return _0xa22b2d;};return _0x24bd();}