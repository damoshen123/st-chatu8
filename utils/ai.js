(function(_0x2e0c4f,_0xc6ab05){const _0x39498d=_0x2e0c4f();function _0x1537bf(_0x4182e1,_0x4e3a17,_0x581225,_0x116775){return _0x5259(_0x4182e1- -0x3bc,_0x116775);}function _0x453dda(_0x10703c,_0x38d9fd,_0x4a7c97,_0x1ebfce){return _0x5259(_0x1ebfce- -0x22c,_0x38d9fd);}while(!![]){try{const _0x45903a=parseInt(_0x453dda(-0xb9,-0xcd,-0xee,-0x102))/(0x2223+0x1*0x159e+-0x37c0)+parseInt(_0x453dda(-0x1c2,-0x17b,-0x172,-0x17a))/(-0x12c8+0x18cb+-0x1*0x601)*(parseInt(_0x453dda(-0x168,-0x140,-0x128,-0x138))/(0x17ce*-0x1+0x312*0x2+0x11ad))+-parseInt(_0x453dda(-0x12c,-0x11b,-0xeb,-0xf0))/(0x1*0x100b+0x1*-0x1843+-0x22*-0x3e)*(parseInt(_0x453dda(-0xf7,-0x12e,-0x131,-0x10a))/(0x1804+0x1356+-0x2b55))+parseInt(_0x1537bf(-0x28a,-0x28a,-0x2ba,-0x297))/(-0x649+0x21ff+-0x1bb0)*(-parseInt(_0x453dda(-0x158,-0x15c,-0x150,-0x118))/(0xf5a*0x1+0x78e*-0x2+0xb*-0x5))+-parseInt(_0x1537bf(-0x2c0,-0x304,-0x2b7,-0x2b7))/(0x1*0x20ff+0xf30+-0x3027)+-parseInt(_0x1537bf(-0x29b,-0x2ad,-0x2e2,-0x2ab))/(0x8*-0x112+-0x3*0x2f5+0x1178)+-parseInt(_0x453dda(-0xde,-0x10f,-0xe2,-0xef))/(0x1eed+0x2041*0x1+0xa86*-0x6)*(-parseInt(_0x1537bf(-0x2f9,-0x2c9,-0x2b1,-0x2b7))/(0x1*0x2335+-0x2*-0xb7f+-0x1d14*0x2));if(_0x45903a===_0xc6ab05)break;else _0x39498d['push'](_0x39498d['shift']());}catch(_0x362d94){_0x39498d['push'](_0x39498d['shift']());}}}(_0x466e,-0xa7846+-0xb3d*-0x8b+0x11cc79));const _0x4d6745=(function(){let _0x299b6a=!![];return function(_0x31bb44,_0xbb0d5f){const _0x3c71dd=_0x299b6a?function(){function _0xc33dea(_0x98d48e,_0x55f0e7,_0x167be8,_0x38c1f7){return _0x5259(_0x55f0e7-0x2fc,_0x98d48e);}if(_0xbb0d5f){const _0x4630ca=_0xbb0d5f[_0xc33dea(0x40e,0x3ef,0x3d3,0x433)](_0x31bb44,arguments);return _0xbb0d5f=null,_0x4630ca;}}:function(){};return _0x299b6a=![],_0x3c71dd;};}()),_0x3d61e4=_0x4d6745(this,function(){const _0xa3794f={};function _0x348542(_0x6d33ba,_0x3823a2,_0x5089c5,_0x2e690a){return _0x5259(_0x2e690a-0x2cf,_0x5089c5);}_0xa3794f[_0x348542(0x3be,0x3c8,0x3ef,0x3c8)]=_0x348542(0x37f,0x40e,0x3f1,0x3c0)+'+$';const _0x108aff=_0xa3794f;function _0x46e875(_0xc97f0f,_0x2fa1d3,_0x20f647,_0x2f8338){return _0x5259(_0x2fa1d3-0x189,_0x20f647);}return _0x3d61e4[_0x348542(0x404,0x3cf,0x402,0x3c9)]()['search'](_0x108aff[_0x46e875(0x296,0x282,0x25a,0x2b7)])[_0x46e875(0x2ce,0x283,0x254,0x2be)]()[_0x348542(0x459,0x421,0x41d,0x411)+'r'](_0x3d61e4)[_0x348542(0x384,0x380,0x3c3,0x394)](_0x108aff['KLTkM']);});function _0x5259(_0x1a9d74,_0x165c6f){_0x1a9d74=_0x1a9d74-(-0x19ee+0x10f*0x15+0x22a*0x2);const _0xfd60dd=_0x466e();let _0x452100=_0xfd60dd[_0x1a9d74];if(_0x5259['OrpSNY']===undefined){var _0x42ff33=function(_0x139ee5){const _0x4a5e70='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1095a1='',_0x4f1168='',_0x2b37a5=_0x1095a1+_0x42ff33;for(let _0x1ba7b0=0x25c7+-0x39e+0xa5*-0x35,_0x5e87a4,_0x595bcb,_0x4ec7e3=-0x21e2+0x4b8*-0x1+-0x36*-0xb7;_0x595bcb=_0x139ee5['charAt'](_0x4ec7e3++);~_0x595bcb&&(_0x5e87a4=_0x1ba7b0%(-0x1*0x115a+-0x14*-0xe3+-0x5e*0x1)?_0x5e87a4*(0x9c9+0xaa*-0x8+-0x439)+_0x595bcb:_0x595bcb,_0x1ba7b0++%(0x27b+-0x2d*-0x4e+-0x102d))?_0x1095a1+=_0x2b37a5['charCodeAt'](_0x4ec7e3+(0x1*-0x1399+-0xe1c+0x21bf))-(-0x1*0xe8d+0x2458+0x1*-0x15c1)!==-0x608+-0x4b7+0xabf?String['fromCharCode'](0xbc7+-0x2325+0x185d&_0x5e87a4>>(-(0x1*-0x2359+-0x2314+0x466f)*_0x1ba7b0&-0xc80+0x587+-0x9*-0xc7)):_0x1ba7b0:0x1*0x1a92+-0xe90+-0x2*0x601){_0x595bcb=_0x4a5e70['indexOf'](_0x595bcb);}for(let _0x2133cb=-0x37*-0xa6+0x1237*0x1+-0x35e1,_0x3a9738=_0x1095a1['length'];_0x2133cb<_0x3a9738;_0x2133cb++){_0x4f1168+='%'+('00'+_0x1095a1['charCodeAt'](_0x2133cb)['toString'](-0x1816*0x1+0x4*0x718+-0x43a))['slice'](-(0xaca+0x14*0xe+0x2*-0x5f0));}return decodeURIComponent(_0x4f1168);};_0x5259['EMiLKR']=_0x42ff33,_0x5259['uHDrSb']={},_0x5259['OrpSNY']=!![];}const _0x525ee7=_0xfd60dd[0x98a+-0x1ed2+0x1c6*0xc],_0x22eb56=_0x1a9d74+_0x525ee7,_0x4b850f=_0x5259['uHDrSb'][_0x22eb56];if(!_0x4b850f){const _0x499a9f=function(_0x4079ba){this['ZiVBET']=_0x4079ba,this['vpMFKJ']=[0x1bcb+-0x73d+0x148d*-0x1,0x2*-0xa31+0x4*0x448+0x342,-0xc*0x2c5+-0x128*0x1d+0x4*0x10b1],this['xFVBni']=function(){return'newState';},this['XaCQrq']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['edQJKX']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x499a9f['prototype']['cDGTjA']=function(){const _0x57f11e=new RegExp(this['XaCQrq']+this['edQJKX']),_0x3b9a48=_0x57f11e['test'](this['xFVBni']['toString']())?--this['vpMFKJ'][0x23d8+0xdf1+-0x31c8]:--this['vpMFKJ'][0x16b0+-0x706*0x2+-0x8a4];return this['xNjXVi'](_0x3b9a48);},_0x499a9f['prototype']['xNjXVi']=function(_0x2729d2){if(!Boolean(~_0x2729d2))return _0x2729d2;return this['IgHLnI'](this['ZiVBET']);},_0x499a9f['prototype']['IgHLnI']=function(_0x58e602){for(let _0x45f5e3=-0xfd3*-0x1+-0x241*-0x2+-0x411*0x5,_0x8b034c=this['vpMFKJ']['length'];_0x45f5e3<_0x8b034c;_0x45f5e3++){this['vpMFKJ']['push'](Math['round'](Math['random']())),_0x8b034c=this['vpMFKJ']['length'];}return _0x58e602(this['vpMFKJ'][-0x49*0x3+-0x57*0x46+-0x3*-0x837]);},new _0x499a9f(_0x5259)['cDGTjA'](),_0x452100=_0x5259['EMiLKR'](_0x452100),_0x5259['uHDrSb'][_0x22eb56]=_0x452100;}else _0x452100=_0x4b850f;return _0x452100;}_0x3d61e4();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';function _0x466e(){const _0x335170=['zw5LCG','C2vHCMnO','rhzUrKe','ue9ou0u','C2v0','rKfUv0O','EvvHsee','AxnbCNjHEq','sMPLzxG','y3vcuuO','qxnXtve','BwvZC2fNzq','Bhrgzvi','B3jPz2LUywXuyq','t2TZveK','CNnIz28','t05trq','rw1lvM8','DhjPBq','C3vJy2vZCW','57+76k+r5AsX6lsLoIa','t01nuNK','rM9ctMO','CMvZDwX0','rvDQz2G','vxnSy0m','BM93','AMLRBuK','C2XPy2u','zw1PDa','CMvZDwX0CW','DerNuM4','DgvZDa','icHjrdOG','iefjioIUVUE9RUw3SUE7N+s4GowiSa','qvvprfu','q2Hlweu','zMTvBwS','wvrxwuO','Dg9mB3DLCKnHCW','y3D4zhC','zgLZCgXHEvrLEa','ugrwDhO','Berfrhe','zffxrxG','kcGOlISPkYKRkq','qvrjt05FuKvtua','yxbWBhK','ndu0nxvoA2TYyq','Bg9N','CKXNANi','tvfyAfu','ufjptvbux1jfuq','s0XuA00','Dg9tDhjPBMC','C3vIC3rYAw5N','mtG3nZGYngrMAeHXEG','ioAjP+IHJoE7K+AENcaOsuq6','vuPss2u','zxjYB3i','u2jiu2e','uurft20','DNnQzwm','C29Tzq','qvrjt05FuKvrvq','uM5ru1q','wuHSuNG','vuTeq0K','Afnov04','57+76k+r5AsX6lsLoG','vgnlCee','q0TtAe0','BwrPD3G','ioIVT+AXGUE/U+IVKsbmte0G','uLzPDLC','ieXmtsdORR7NVA7POBxPNAi','57+76k+rieXmtsdMIAFOOyZOTOu','v3f5zKy','qvrjt05Fr0vuxW','t0ndtNC','n3b4Bvb4AG','tgfsExm','C3PTAKe','tufHzKW','zuzdtKi','CgfYC2u','zhzsuLm','wuTxChG','u0L3thm','C2TPCa','y0Xpt3a','B2jQzwn0','iow3SUAuTUwiSoE/U+IVKsbmte0','nJi4otGXmLverxHsrW','mJe2otu1mgXIAfzAyG','z3boAum','C3qTy2HHDhu4oG','CuDeEfq','yKvdugm','rvnu','zMXMzxu','BwfW','mtqWnte2mMPLzuDYCG','thP2zMy','qw5esem','ChvZAa','zLbwzKi','C0TZwKG','r2nwvee','BhrWCMC','mZC1nta0nLb5CuLhCW','C3rYAw5NAwz5','BMfTzq','zfztu0G','zMLSDgvY','C2Djuvu','qwjVCNrfCNjVCG','EuXAruy','ALnNEgu','sfrsBem','mtjbu3ftrMO','nZuZnZu1mhHHzK9rDG','5BcD6k+v5PEN5Qc85BYpoG','txjPv3O','C3rYAw5N','D2fYBG','y29UC3rYDwn0BW','CKjuC1y','D2TUBKy','Cg5sC2G','zw50CMLLCW','B3jPz2LUywW','ugTdtgq','D1nxB1a','s255zfa','ufjptvbux1jfuW','vM1hu20','zundwK0','r0jer1G','uwHzwe0','y2LzreO','BxpVViK','CMvTB3zLtgLZDa','CMvWBgfJzq','mta5nfbty3rXva','DhjHBNnSyxrPBW','AM9PBG','C0rtueq','q3bUswO','rw5Ay1m','y2XLyw5Lza','r2vjtwi','AKfXzwG','Bwf0y2G','tgLKENa','CMfUzg9T','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','wfDoswm','teXnx1rsqu5tta','BgvUz3rO','C2TPChbLza','mJjzug1srwm'];_0x466e=function(){return _0x335170;};return _0x466e();}import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x129af7){function _0x35c753(_0x1d2b05,_0x315156,_0x5b0aa5,_0x24ab99){return _0x5259(_0x1d2b05-0x1f2,_0x24ab99);}function _0x37c7eb(_0x3329ee,_0x4de8d4,_0x3ec6d3,_0x2830fd){return _0x5259(_0x4de8d4-0xd5,_0x3329ee);}return SKIP_PATTERNS[_0x37c7eb(0x189,0x1d8,0x1a8,0x1df)](_0x3f2fad=>_0x3f2fad[_0x37c7eb(0x1a1,0x1b9,0x18b,0x1bd)](_0x129af7['trim']()));}export function tagsToJsonString(_0x5f4027){if(!Array[_0x204de5(0x315,0x2d4,0x2eb,0x2d9)](_0x5f4027))return'[]';function _0x204de5(_0x30d789,_0x2ef778,_0x1e8a2d,_0x49431a){return _0x5259(_0x30d789-0x24a,_0x2ef778);}function _0x3283f8(_0x32919d,_0x3f6c6e,_0x290e81,_0xbe687a){return _0x5259(_0x32919d-0x196,_0x3f6c6e);}return JSON[_0x204de5(0x37d,0x357,0x363,0x342)](_0x5f4027[_0x204de5(0x380,0x343,0x3ae,0x36e)](_0x46a60f=>_0x46a60f&&typeof _0x46a60f===_0x204de5(0x38a,0x3ad,0x385,0x3d0)));}export function preprocessPromptForTranslation(_0xab413b){const _0x53a947={'RnQST':function(_0x2480ed,_0x3232b1){return _0x2480ed<_0x3232b1;},'eCCZM':function(_0x45bd79,_0x4c0a05){return _0x45bd79===_0x4c0a05;},'Jjeex':function(_0xdd41d,_0x13ffb1){return _0xdd41d!==_0x13ffb1;},'MriWz':_0xc8efb0(-0x19a,-0x1d4,-0x197,-0x1ec),'dVSSH':'nyZgA','ltFeR':function(_0x3f0222,_0xa72610){return _0x3f0222!==_0xa72610;},'MQXhU':_0xc8efb0(-0x1ce,-0x18a,-0x17a,-0x1a4),'OMMRy':_0xc8efb0(-0x18f,-0x153,-0x160,-0x18c),'YTWYJ':function(_0x880523,_0x55ef2e){return _0x880523(_0x55ef2e);},'CpnIj':function(_0x258fec,_0x156c8a){return _0x258fec(_0x156c8a);},'FoBNj':function(_0x47b264,_0x2afe28){return _0x47b264!==_0x2afe28;},'ChKXE':_0xc8efb0(-0x18e,-0x19a,-0x151,-0x1c3),'fPVfB':_0x1c2f13(0x1f6,0x1cc,0x1fa,0x204),'Ffdek':_0x1c2f13(0x278,0x24c,0x248,0x24b),'tDgRn':function(_0x9e7863,_0x3069ac){return _0x9e7863(_0x3069ac);}};if(!_0xab413b||_0x53a947[_0xc8efb0(-0x159,-0x1aa,-0x171,-0x1c1)](typeof _0xab413b,_0x1c2f13(0x2aa,0x2c0,0x299,0x2d5)))return _0x53a947[_0x1c2f13(0x207,0x244,0x229,0x255)](_0x53a947[_0x1c2f13(0x288,0x218,0x250,0x26f)],_0x53a947[_0xc8efb0(-0x1e3,-0x19d,-0x17a,-0x151)])?{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()}:_0x3237ab;const _0x3983ae=_0x51cead=>{function _0x4fc1d0(_0x241997,_0x36ac9c,_0xaa121d,_0x264e08){return _0x1c2f13(_0x241997-0xa9,_0x241997,_0x36ac9c- -0x281,_0x264e08-0xc4);}function _0x176484(_0x5bd947,_0x1f74bd,_0x196629,_0x32ece0){return _0x1c2f13(_0x5bd947-0xc8,_0x5bd947,_0x196629-0x1b4,_0x32ece0-0x97);}const _0xd38639=[];let _0xe2a674='',_0x2aff26=![];for(let _0x5938eb=0x2181*0x1+0x806+-0x1*0x2987;_0x53a947[_0x4fc1d0(0x24,-0x23,-0x51,-0x45)](_0x5938eb,_0x51cead[_0x4fc1d0(-0x3e,-0x67,-0x1e,-0x64)]);_0x5938eb++){const _0x57248c=_0x51cead[_0x5938eb];if(_0x57248c==='$')_0x2aff26=!_0x2aff26,_0xe2a674+=_0x57248c;else{if((_0x53a947[_0x4fc1d0(-0x87,-0x7d,-0xb0,-0x8d)](_0x57248c,',')||_0x53a947[_0x176484(0x408,0x390,0x3b8,0x3c7)](_0x57248c,'，'))&&!_0x2aff26){const _0x580eca=_0xe2a674[_0x4fc1d0(-0x8d,-0x52,-0x30,-0x6d)]();if(_0x580eca)_0xd38639['push'](_0x580eca);_0xe2a674='';}else{if(_0x53a947[_0x176484(0x39b,0x40f,0x3d9,0x3c0)](_0x53a947[_0x176484(0x44e,0x439,0x44c,0x485)],_0x53a947[_0x176484(0x462,0x45c,0x442,0x47e)]))_0xe2a674+=_0x57248c;else{const _0x16d169=_0x318e69['indexOf']('\x5c');if(_0x16d169>0xb08*-0x1+0x6b*-0x3d+0x2487){const _0x13d63d=_0x34d2f5['slice'](-0x142f+-0x1*0x6f2+0x1b21,_0x16d169)[_0x176484(0x41e,0x3cd,0x3e3,0x3eb)](),_0x394fcb=_0x3f3ed7['slice'](_0x16d169+(-0x344+0x24a9*-0x1+0x27ee))[_0x4fc1d0(-0x67,-0x52,-0x79,-0x4f)]();if(_0x13d63d)_0x537bb9[_0x13d63d]=_0x394fcb;}}}}}if(_0xe2a674[_0x176484(0x3a6,0x418,0x3e3,0x39f)]())_0xd38639[_0x176484(0x42c,0x483,0x43a,0x403)](_0xe2a674[_0x176484(0x3dd,0x39c,0x3e3,0x420)]());return _0xd38639;},_0x30c9da=_0x53a947[_0xc8efb0(-0x1cf,-0x18c,-0x181,-0x1d6)](_0x3983ae,_0xab413b),_0x7b97e8=[];function _0x1c2f13(_0xacfbad,_0x597a43,_0x43af79,_0x6c4286){return _0x5259(_0x43af79-0x159,_0x597a43);}const _0x596a2d=[];function _0xc8efb0(_0x198a5c,_0x2118b2,_0x4e8ad9,_0x4724e5){return _0x5259(_0x2118b2- -0x276,_0x4724e5);}const _0x21696b=new Map();for(const _0x517c78 of _0x30c9da){const _0x4cf158=_0x517c78[_0x1c2f13(0x22a,0x1f4,0x214,0x230)](SD_SYMBOL_PATTERN);if(_0x4cf158){const _0x550ce1=_0x4cf158[0x2c0+-0x24f7+0x2238]||'',_0xef1a4=(_0x4cf158[-0x104+-0x196a+0x1a70]||'')['trim'](),_0x48d7c2=_0x4cf158[0x16ab+-0x7*0x2fb+-0x1cb]||'',_0x32eb61=_0x4cf158[0x1f09+0x82a+-0x7*0x599]||'',_0x361330={'original':_0x517c78,'cleaned':_0xef1a4,'prefix':_0x550ce1,'suffix':_0x48d7c2,'weight':_0x32eb61,'skip':_0x53a947[_0xc8efb0(-0x16f,-0x1c0,-0x206,-0x1df)](shouldSkipTranslation,_0x517c78)||_0x53a947[_0x1c2f13(0x1ee,0x1dd,0x20f,0x221)](shouldSkipTranslation,_0xef1a4)};_0x7b97e8[_0x1c2f13(0x247,0x238,0x286,0x28e)](_0x361330);if(!_0x361330[_0x1c2f13(0x25e,0x249,0x276,0x248)]&&_0xef1a4){if(_0x53a947[_0xc8efb0(-0x1e3,-0x19c,-0x1ed,-0x18c)](_0x53a947[_0xc8efb0(-0x156,-0x18e,-0x1a3,-0x160)],_0x53a947[_0x1c2f13(0x2a2,0x2b2,0x287,0x289)]))_0x596a2d['push'](_0xef1a4),_0x21696b['set'](_0xef1a4[_0x1c2f13(0x274,0x224,0x244,0x271)+'e'](),_0x361330);else return'';}}else{if(_0x1c2f13(0x221,0x208,0x248,0x256)!==_0x53a947['Ffdek'])for(const [_0x15e7c8,_0x407352]of _0x9e7386[_0x1c2f13(0x1f6,0x1eb,0x1fd,0x219)](_0x22d7b7)){_0x336787[_0x15e7c8[_0xc8efb0(-0x190,-0x18b,-0x14c,-0x1ad)+'e']()]=_0x407352;}else{const _0x1139f3={'original':_0x517c78,'cleaned':_0x517c78,'prefix':'','suffix':'','weight':'','skip':shouldSkipTranslation(_0x517c78)};_0x7b97e8[_0xc8efb0(-0x155,-0x149,-0x114,-0x152)](_0x1139f3),!_0x1139f3[_0xc8efb0(-0x131,-0x159,-0x158,-0x1a1)]&&_0x517c78&&(_0x596a2d[_0x1c2f13(0x273,0x276,0x286,0x2b0)](_0x517c78),_0x21696b['set'](_0x517c78[_0x1c2f13(0x207,0x270,0x244,0x235)+'e'](),_0x1139f3));}}}return{'originalTags':_0x7b97e8,'cleanedTags':_0x596a2d,'cleanedText':_0x53a947[_0x1c2f13(0x207,0x26f,0x23c,0x210)](tagsToJsonString,_0x596a2d),'tagMap':_0x21696b};}export function combineTranslationResult(_0x465a28,_0x6f1f75){const _0x44ac1b={};function _0x578cc4(_0x5a1cb4,_0x4c1268,_0x4252c6,_0x591c24){return _0x5259(_0x4c1268- -0x1b2,_0x4252c6);}function _0x19a8ab(_0x10de52,_0x1cb4f6,_0x1deafd,_0x2ba56f){return _0x5259(_0x2ba56f-0x221,_0x10de52);}_0x44ac1b[_0x578cc4(-0xc4,-0x9a,-0xe6,-0xc9)]='翻译失败:',_0x44ac1b[_0x578cc4(-0xdd,-0x105,-0xb7,-0x14e)]='object',_0x44ac1b[_0x578cc4(-0x76,-0x86,-0x41,-0xd0)]=function(_0x481b0c,_0x51fa46){return _0x481b0c!==_0x51fa46;},_0x44ac1b[_0x578cc4(-0x72,-0xab,-0xf8,-0x61)]='etRky';const _0x383b81=_0x44ac1b;if(!_0x465a28||!Array[_0x578cc4(-0x10a,-0xe7,-0x119,-0xad)](_0x465a28))return[];const _0x29fe76={};if(_0x6f1f75&&typeof _0x6f1f75===_0x383b81[_0x578cc4(-0x12f,-0x105,-0xd4,-0x149)])for(const [_0x574f50,_0x3c3e9f]of Object['entries'](_0x6f1f75)){if(_0x383b81[_0x578cc4(-0x73,-0x86,-0x87,-0x4a)]('vCydz',_0x383b81[_0x19a8ab(0x36d,0x2e3,0x2dd,0x328)]))_0x29fe76[_0x574f50[_0x578cc4(-0xe9,-0xc7,-0xeb,-0xc9)+'e']()]=_0x3c3e9f;else{_0x5de16e(_0x578cc4(-0xaf,-0xda,-0xd3,-0xe3)+_0x546aa3[_0x19a8ab(0x312,0x2ca,0x2d5,0x2f0)]),_0x480699[_0x578cc4(-0xa7,-0xb3,-0x79,-0x9e)](_0x383b81['eFCNB'],_0x247628);throw _0x534e9b;}}return _0x465a28[_0x578cc4(-0x49,-0x89,-0x8a,-0xb3)](_0x44146d=>{const {original:_0xc1457,cleaned:_0x5b9271,skip:_0x15cdad}=_0x44146d;if(_0x15cdad){const _0x2a5926={};return _0x2a5926[_0x1c665b(-0x302,-0x30d,-0x2d4,-0x28e)]=_0xc1457,_0x2a5926[_0x1c665b(-0x2ed,-0x2d2,-0x2c6,-0x275)+'n']='',_0x2a5926[_0xf1a6a9(-0x66,-0x5c,-0x50,-0x70)]=_0x5b9271,_0x2a5926[_0x1c665b(-0x29f,-0x2df,-0x2b7,-0x2d7)]=!![],_0x2a5926;}const _0x140a3b=_0x29fe76[_0x5b9271[_0x1c665b(-0x2bc,-0x267,-0x28e,-0x251)+'e']()]||'',_0x46df83={};function _0x1c665b(_0x4eeb77,_0x44d045,_0x683a50,_0x33d156){return _0x19a8ab(_0x44d045,_0x44d045-0xb6,_0x683a50-0x4f,_0x683a50- -0x59a);}_0x46df83[_0xf1a6a9(-0xaf,-0x6f,-0x67,-0x3c)]=_0xc1457;function _0xf1a6a9(_0x410206,_0x5ac4c5,_0x5aecb5,_0x28d592){return _0x578cc4(_0x410206-0xb6,_0x5ac4c5-0x9e,_0x410206,_0x28d592-0x39);}return _0x46df83[_0x1c665b(-0x2a7,-0x2c3,-0x2c6,-0x2f2)+'n']=_0x140a3b,_0x46df83['cleaned']=_0x5b9271,_0x46df83[_0x1c665b(-0x2aa,-0x286,-0x2b7,-0x294)]=![],_0x46df83;});}export function formatTranslationDisplay(_0x4a6282,_0x3e6018={}){const _0x15895b={};_0x15895b['BZIIa']=function(_0x15e23c,_0x313f2e){return _0x15e23c!==_0x313f2e;},_0x15895b['HTRlC']='KtAnb';function _0x1c98c8(_0x53a27f,_0x44c4be,_0x30292b,_0x5dba81){return _0x5259(_0x44c4be- -0x5e,_0x53a27f);}_0x15895b[_0x1c98c8(0x54,0x48,0x85,0x3f)]=_0x1c98c8(0xa9,0x61,0xa8,0x65);const _0x15d3a5=_0x15895b;function _0x220a28(_0x3f83d4,_0x46e0d5,_0x4c73e3,_0x507068){return _0x5259(_0x507068-0x2b,_0x3f83d4);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x3e6018;if(!_0x4a6282||!Array[_0x1c98c8(0x50,0x6d,0x94,0x37)](_0x4a6282))return'';return _0x4a6282[_0x220a28(0x194,0x171,0x126,0x154)](_0xf553c0=>{if(_0xf553c0[_0x2ef5b3(0x2a9,0x2a4,0x27a,0x28b)])return showOriginal?_0xf553c0['original']:'';const _0x3bc816=[];if(showOriginal)_0x3bc816[_0x2ef5b3(0x2af,0x315,0x2e5,0x2ba)](_0xf553c0[_0x2ef5b3(0x29f,0x238,0x25d,0x25f)]);function _0x2ef5b3(_0x2a9478,_0x12e98e,_0x585f2c,_0x314689){return _0x1c98c8(_0x314689,_0x585f2c-0x216,_0x585f2c-0x14e,_0x314689-0x1a2);}showTranslation&&_0xf553c0[_0x2ef5b3(0x2af,0x2ba,0x26b,0x21e)+'n']&&(_0x15d3a5['BZIIa'](_0x15d3a5[_0x5b9b7c(0x3c0,0x3f8,0x3b8,0x3e3)],_0x15d3a5[_0x5b9b7c(0x32b,0x31e,0x335,0x30e)])?_0x3bc816[_0x5b9b7c(0x3b2,0x3a2,0x383,0x3ef)]('('+_0xf553c0[_0x5b9b7c(0x338,0x383,0x362,0x2f4)+'n']+')'):_0x38afd0+=_0x25f3b9);function _0x5b9b7c(_0x5420e1,_0x386d4b,_0x10a4e8,_0x417ac5){return _0x1c98c8(_0x417ac5,_0x5420e1-0x2e3,_0x10a4e8-0x132,_0x417ac5-0x146);}return _0x3bc816[_0x2ef5b3(0x22c,0x222,0x26c,0x23d)]('\x20');})[_0x220a28(0x198,0x129,0x180,0x161)](Boolean)['join'](separator);}export async function translatePromptTags(_0x246088){function _0x37309a(_0x1e748a,_0x381f83,_0x3ccc2e,_0x42fd63){return _0x5259(_0x42fd63- -0x25a,_0x3ccc2e);}const _0x3cf27d={'KnydP':function(_0x201b7c,_0x2253e7){return _0x201b7c(_0x2253e7);},'Lzvff':function(_0x20677b,_0x369040,_0x44ede8){return _0x20677b(_0x369040,_0x44ede8);},'LaRys':function(_0x91f60c,_0x240e1f){return _0x91f60c===_0x240e1f;},'PdVtz':_0x4ede82(0x3b4,0x3df,0x3c9,0x419),'tAjLC':'DFyGH'};function _0x4ede82(_0x2eb512,_0x1753eb,_0x2fcfcc,_0x45992b){return _0x5259(_0x1753eb-0x2c3,_0x2eb512);}const {originalTags:_0x507fba,cleanedText:_0x56e972}=_0x3cf27d[_0x4ede82(0x34c,0x36b,0x365,0x366)](preprocessPromptForTranslation,_0x246088);if(!_0x56e972){const _0x13dcdb={};return _0x13dcdb[_0x37309a(-0x170,-0x1a0,-0x1bd,-0x178)]=[],_0x13dcdb[_0x4ede82(0x3e7,0x3b0,0x367,0x361)+'t']='',_0x13dcdb[_0x4ede82(0x39a,0x394,0x38d,0x3b1)+'gs']=[],_0x13dcdb;}try{const _0x1f96b3=await callTranslation(_0x56e972),_0x36b473=parseTranslationResult(_0x1f96b3),_0x55764e=_0x3cf27d[_0x4ede82(0x42f,0x3ee,0x3c1,0x437)](combineTranslationResult,_0x507fba,_0x36b473),_0x5ca637=_0x3cf27d[_0x37309a(-0x1a2,-0x1e2,-0x1cc,-0x1b2)](formatTranslationDisplay,_0x55764e),_0x327803={};return _0x327803['results']=_0x55764e,_0x327803['displayTex'+'t']=_0x5ca637,_0x327803[_0x37309a(-0x1cd,-0x154,-0x177,-0x189)+'gs']=_0x507fba,_0x327803;}catch(_0x5dbb53){if(_0x3cf27d[_0x4ede82(0x3e8,0x3d8,0x400,0x38e)](_0x3cf27d[_0x4ede82(0x3fc,0x3b1,0x3bd,0x3f9)],_0x3cf27d['tAjLC']))return _0x36758d?_0x233fe8['original']:'';else{console[_0x4ede82(0x3f0,0x3c2,0x3a7,0x3b2)]('st-chatu8:'+'\x20翻译提示词标签失败'+':',_0x5dbb53);throw _0x5dbb53;}}}export function parseTranslationResult(_0x690ac9){const _0x43aaa4={'hSNWN':function(_0x3332e6,_0x1041ad){return _0x3332e6===_0x1041ad;},'Lidzp':_0x2ca61c(0x398,0x34a,0x374,0x35b),'dQWEx':function(_0x1bd04d,_0x4ea54f){return _0x1bd04d(_0x4ea54f);},'VmGSm':'VSxYQ','bECPc':_0x2ca61c(0x307,0x331,0x373,0x33a),'UpXmR':function(_0x17b00a,_0x13942c){return _0x17b00a!==_0x13942c;},'nhFAL':function(_0x1ea413,_0x1cf96f){return _0x1ea413!==_0x1cf96f;},'dvRRS':_0x2ca61c(0x31b,0x2e0,0x30a,0x2de),'UslcC':_0x8c1265(0x33f,0x2ea,0x307,0x332)+'\x20JSON解析失败，'+_0x8c1265(0x356,0x2de,0x321,0x31a),'EmKVo':function(_0xb3590c,_0x60b82d){return _0xb3590c>_0x60b82d;},'sDSPD':function(_0x2a850e,_0x4bb2a8){return _0x2a850e===_0x4bb2a8;},'WqyfF':'uMLQi'};if(!_0x690ac9)return{};try{const _0x408a16=_0x690ac9[_0x8c1265(0x29e,0x253,0x29e,0x2b2)](/\{[\s\S]*\}/);if(_0x408a16){if(_0x43aaa4[_0x2ca61c(0x2a4,0x2bc,0x27d,0x27c)]!==_0x43aaa4[_0x8c1265(0x299,0x2ba,0x28d,0x25b)])!_0x3ea197&&(_0x3af450[_0x8c1265(0x2c3,0x2c7,0x2d8,0x302)](_0x2ca61c(0x32b,0x336,0x354,0x381)+_0x8c1265(0x2a9,0x297,0x2c9,0x290)+_0x8c1265(0x316,0x31c,0x2f2,0x31b)),_0x5b4aed=!![]);else{const _0x5e9201=JSON[_0x2ca61c(0x2f3,0x32b,0x333,0x352)](_0x408a16[0x5*-0x29+0x1a55+-0x4*0x662]);if(_0x43aaa4['hSNWN'](typeof _0x5e9201,_0x43aaa4[_0x8c1265(0x303,0x318,0x309,0x354)])&&_0x43aaa4['UpXmR'](_0x5e9201,null)){if(_0x43aaa4['nhFAL'](_0x43aaa4[_0x8c1265(0x348,0x2ec,0x2fd,0x2e1)],_0x8c1265(0x2e0,0x275,0x2b1,0x293))){if(_0x1f5ddf[_0x8c1265(0x2c5,0x309,0x2e2,0x2ee)]&&_0x43aaa4[_0x8c1265(0x326,0x312,0x2eb,0x327)](_0x855be4['error'][_0x2ca61c(0x33f,0x346,0x305,0x2f8)],_0x43aaa4[_0x2ca61c(0x290,0x2ce,0x314,0x2f2)])){const _0x50b47a=new _0x5f128b(_0x44db7e[_0x2ca61c(0x302,0x311,0x2e1,0x358)]['message']);_0x50b47a[_0x2ca61c(0x32a,0x346,0x331,0x36d)]=_0x43aaa4['Lidzp'],_0x43aaa4[_0x8c1265(0x28c,0x31d,0x2d3,0x2d7)](_0x577851,_0x50b47a);}else _0x399b3d(new _0x43c8cb(_0x54d6ed[_0x8c1265(0x2a6,0x30f,0x2be,0x2c8)]));}else return _0x5e9201;}}}}catch(_0x54508a){console[_0x2ca61c(0x344,0x353,0x377,0x3a4)](_0x43aaa4[_0x8c1265(0x296,0x27f,0x2c0,0x2f3)],_0x54508a[_0x2ca61c(0x2cb,0x2e1,0x32c,0x2b7)]);}const _0x2207be=_0x43aaa4[_0x2ca61c(0x350,0x302,0x32d,0x2e8)](String,_0x690ac9)['replace'](/[\r\n]+/g,'\x20')[_0x2ca61c(0x281,0x2c3,0x290,0x2c9)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x2ca61c(0x2bf,0x2e8,0x2f9,0x2d9)]();function _0x8c1265(_0x105f7e,_0xaba5fa,_0x2f03a1,_0x45df09){return _0x5259(_0x2f03a1-0x1e3,_0xaba5fa);}const _0x27ebec=_0x2207be['split'](/[,，]/)[_0x2ca61c(0x2fe,0x33b,0x338,0x2eb)](_0x2af1d0=>_0x2af1d0[_0x8c1265(0x308,0x283,0x2b9,0x26a)]())[_0x2ca61c(0x36b,0x348,0x37e,0x391)](Boolean),_0x3466e6={};for(const _0x3e3e13 of _0x27ebec){const _0x1c0a46=_0x3e3e13['indexOf']('\x5c');if(_0x43aaa4[_0x8c1265(0x27d,0x27e,0x2b8,0x2ea)](_0x1c0a46,-0x1d0f*-0x1+0x1717*0x1+0xf*-0x37a)){if(_0x43aaa4[_0x2ca61c(0x2f3,0x2c7,0x2c8,0x29b)](_0x43aaa4[_0x2ca61c(0x354,0x323,0x34b,0x317)],_0x43aaa4['WqyfF'])){const _0x1367a1=_0x3e3e13[_0x8c1265(0x275,0x2d1,0x2c3,0x2d0)](-0x1e9e+-0x2078+0x3f16,_0x1c0a46)[_0x2ca61c(0x323,0x2e8,0x2f7,0x305)](),_0x3ab797=_0x3e3e13[_0x8c1265(0x2fd,0x27d,0x2c3,0x2de)](_0x1c0a46+(-0xc6d*-0x3+-0xd67+-0x9*0x2a7))[_0x8c1265(0x280,0x2de,0x2b9,0x28b)]();if(_0x1367a1)_0x3466e6[_0x1367a1]=_0x3ab797;}else _0x357bdd[_0x8c1265(0x306,0x311,0x310,0x2e7)](_0x55750f),_0x3dcb4e[_0x2ca61c(0x2af,0x2da,0x2c3,0x2cf)](_0x4b94e4['toLowerCas'+'e'](),_0x165a27);}}function _0x2ca61c(_0x362ae6,_0x4e153c,_0x58cf05,_0x1b8979){return _0x5259(_0x4e153c-0x212,_0x362ae6);}return _0x3466e6;}function generateRequestId(){function _0x162eef(_0x3b1b84,_0x2279b0,_0x46d3e7,_0x535615){return _0x5259(_0x535615- -0x153,_0x46d3e7);}const _0x5a63d5={};_0x5a63d5['YKWpx']=function(_0xae88ab,_0x48e574){return _0xae88ab+_0x48e574;};const _0x65793b=_0x5a63d5;function _0x1eaf37(_0x404ff3,_0x3609a9,_0x1ea437,_0x2f11e1){return _0x5259(_0x2f11e1-0x3cb,_0x404ff3);}if(crypto&&crypto['randomUUID'])return crypto['randomUUID']();return _0x65793b[_0x1eaf37(0x4f3,0x52d,0x4ac,0x4e6)](Date[_0x162eef(-0x3b,-0xa0,-0x97,-0x75)]()[_0x1eaf37(0x4ba,0x4dc,0x4e5,0x4c5)](-0x1*-0x9d6+0x4*-0x9a6+0x1ce6),Math[_0x162eef(-0x90,-0x89,-0xe4,-0x96)]()['toString'](-0x48c*0x4+-0x163e*-0x1+-0x3ea)[_0x162eef(-0x1c,-0x3f,-0x64,-0x58)](-0x929+-0x1a17+0x2342*0x1));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x90ad8b={'sgIQU':function(_0x4045d7,_0x325c9c){return _0x4045d7===_0x325c9c;},'fkUmk':function(_0x3e918c,_0x1cadb0){return _0x3e918c!==_0x1cadb0;},'yUaHA':'rJkJg','GcVTA':_0x3e44c1(-0x1d9,-0x18c,-0x1d8,-0x20f),'yLZEF':function(_0x1ec6dc,_0x7e11ae,_0x541411){return _0x1ec6dc(_0x7e11ae,_0x541411);}};function _0x3e44c1(_0x1ac20e,_0x5b3fbc,_0xd16ec7,_0x547ecd){return _0x5259(_0xd16ec7- -0x29e,_0x547ecd);}return new Promise((_0xe04039,_0x11e5c7)=>{function _0x49ff4c(_0x1c55eb,_0x47cacd,_0x3923c3,_0x50b5a8){return _0x3e44c1(_0x1c55eb-0x5c,_0x47cacd-0xf9,_0x47cacd- -0x74,_0x50b5a8);}function _0x53cd57(_0x5f1d6f,_0x28172d,_0x59222a,_0x286f85){return _0x3e44c1(_0x5f1d6f-0x5f,_0x28172d-0x1c0,_0x59222a-0x17d,_0x28172d);}const _0x4a311e={'vsjec':function(_0x10bcdd,_0x385dae){return _0x10bcdd(_0x385dae);}};if(_0x90ad8b[_0x53cd57(-0x26,-0x72,-0x38,0xf)](_0x90ad8b[_0x49ff4c(-0x22f,-0x248,-0x21c,-0x27d)],_0x90ad8b[_0x49ff4c(-0x199,-0x1e2,-0x1d9,-0x19e)])){const _0x200aaf=generateRequestId();console[_0x49ff4c(-0x241,-0x21d,-0x264,-0x245)]('st-chatu8:'+'\x20请求获取翻译提示词'+_0x49ff4c(-0x227,-0x22d,-0x224,-0x24d)+_0x200aaf+')');const _0x2d41eb=_0x512887=>{if(_0x512887['id']!==_0x200aaf)return;eventSource[_0x420933(-0x227,-0x22b,-0x1e5,-0x1fc)+_0xe7c8c9(0x1f3,0x167,0x1de,0x1a3)](eventNames[_0x420933(-0x217,-0x1e8,-0x222,-0x218)+'ATION_GET_'+_0xe7c8c9(0x1c6,0x177,0x1a9,0x188)+_0x420933(-0x210,-0x1e6,-0x20a,-0x223)],_0x2d41eb);const {prompt:_0x394760}=_0x512887;function _0xe7c8c9(_0xd504c7,_0xbee2d9,_0x1cb2df,_0xd3054c){return _0x53cd57(_0xd504c7-0x1ce,_0xbee2d9,_0xd3054c-0x200,_0xd3054c-0x184);}console[_0xe7c8c9(0x1e2,0x1e5,0x1a6,0x1d4)](_0x420933(-0x1b3,-0x1e0,-0x168,-0x17d)+'\x20已获取翻译提示词\x20'+'(ID:\x20'+_0x200aaf+'):',_0x394760);function _0x420933(_0xecdfa0,_0x5c5002,_0x56ef6e,_0x13009a){return _0x49ff4c(_0xecdfa0-0x2,_0xecdfa0-0x3b,_0x56ef6e-0x188,_0x56ef6e);}_0x4a311e[_0x420933(-0x1d5,-0x1f6,-0x221,-0x224)](_0xe04039,_0x394760);};eventSource['on'](eventNames[_0x49ff4c(-0x282,-0x252,-0x238,-0x222)+_0x49ff4c(-0x1cb,-0x200,-0x1de,-0x23a)+'PROMPT_RES'+'PONSE'],_0x2d41eb);const _0x546e76={};_0x546e76['id']=_0x200aaf,eventSource[_0x53cd57(-0x76,-0x14,-0x40,-0x2c)](eventNames[_0x49ff4c(-0x252,-0x252,-0x27b,-0x25d)+_0x53cd57(0x1e,0x3d,-0xf,0x3)+_0x49ff4c(-0x22e,-0x21a,-0x25c,-0x242)+'UEST'],_0x546e76),_0x90ad8b[_0x53cd57(0x33,0x1f,0x18,0x55)](setTimeout,()=>{function _0x87a3bc(_0x3c7c5a,_0x1e79ac,_0x3223d4,_0x1c94b4){return _0x49ff4c(_0x3c7c5a-0x87,_0x1c94b4-0x323,_0x3223d4-0x1e5,_0x1e79ac);}function _0xb9702b(_0x57c0f8,_0x4cdf81,_0x37f49c,_0x5b1d22){return _0x53cd57(_0x57c0f8-0x1cc,_0x5b1d22,_0x4cdf81- -0x19e,_0x5b1d22-0x2f);}eventSource['removeList'+'ener'](eventNames[_0x87a3bc(0x9a,0xc1,0xa5,0xd1)+'ATION_GET_'+_0x87a3bc(0x103,0xfa,0x104,0xba)+_0x87a3bc(0x89,0x90,0x121,0xd8)],_0x2d41eb),_0x11e5c7(new Error(_0x87a3bc(0xda,0x109,0xb1,0xcf)));},-0x20*-0xb9+0x2461+-0x1*0x1471);}else{const _0x1011af=_0x1692b2[_0x49ff4c(-0x20d,-0x1f9,-0x1c3,-0x20b)](_0x26c519[-0x23a6+-0x1*-0x4c0+0x1ee6]);if(_0x90ad8b[_0x53cd57(-0x2a,0x63,0x16,0x3)](typeof _0x1011af,_0x53cd57(-0x36,-0x53,-0x2,-0x25))&&_0x90ad8b[_0x49ff4c(-0x237,-0x229,-0x24b,-0x225)](_0x1011af,null))return _0x1011af;}});}export function LLM_TRANSLATION(_0x27bd62,{timeoutMs:timeoutMs=-0x118f7+0x1*-0x56eb+0x1*0x25a42}={}){function _0x26bb9e(_0x4c04ef,_0x30b1b4,_0x250816,_0x412abe){return _0x5259(_0x30b1b4- -0x9e,_0x4c04ef);}const _0x345c94={'mdiwx':function(_0x2c7098){return _0x2c7098();},'ciYDJ':function(_0xf4b60,_0x3af28c){return _0xf4b60!==_0x3af28c;},'cLOOp':_0x26bb9e(0x2b,0x79,0x9b,0x54),'wSWoP':'VfjyF','YHlRx':_0x26bb9e(0x46,0x2b,0x7,0x36),'jikmI':_0x26bb9e(0xcd,0x9a,0x6e,0x49),'szmjA':function(_0x479b14,_0x20525a){return _0x479b14(_0x20525a);},'qGDxT':function(_0x29b529,_0x2b223e){return _0x29b529===_0x2b223e;},'EnZcS':_0x26bb9e(0xd1,0x93,0xe2,0xb1),'AUODU':function(_0x457ad0,_0x5e28c8){return _0x457ad0(_0x5e28c8);},'rLgjr':function(_0x23e303,_0x4c1c29){return _0x23e303===_0x4c1c29;},'QDEOm':_0x4217de(-0xdd,-0xf8,-0xb5,-0xfe),'GeIMb':function(_0x54901b){return _0x54901b();}};function _0x4217de(_0x3a2b5c,_0x14c2ef,_0x3aee59,_0x5c1f1a){return _0x5259(_0x3a2b5c- -0x1e7,_0x14c2ef);}return new Promise((_0x4ac6d7,_0x360262)=>{const _0x2b210a={'GrMhj':function(_0xdfbb45,_0x5a22ee){function _0x53c774(_0x1e8950,_0x57688f,_0x555b20,_0x324971){return _0x5259(_0x57688f-0x361,_0x1e8950);}return _0x345c94[_0x53c774(0x474,0x457,0x447,0x471)](_0xdfbb45,_0x5a22ee);},'jSgxe':_0x345c94[_0x4e7671(0x133,0xc4,0x137,0x115)],'WhYmS':function(_0x42a91e){function _0x21760a(_0x200648,_0xed5ffc,_0x197ce6,_0x127413){return _0x4e7671(_0x200648-0x2b,_0x200648,_0x197ce6-0x1e3,_0xed5ffc-0x157);}return _0x345c94[_0x21760a(0x212,0x224,0x205,0x1e6)](_0x42a91e);},'SbHSa':function(_0x3fa600,_0x5ae55f){return _0x3fa600(_0x5ae55f);}},_0x5be1c8=_0x345c94[_0x4e7671(0xbf,0xbe,0x10e,0xcd)](generateRequestId);console[_0x107335(0xe0,0xb9,0xdd,0xe9)](_0x4e7671(0xec,0x179,0x115,0x138)+_0x107335(0xf8,0xe3,0x110,0xab)+'(ID:\x20'+_0x5be1c8+')');function _0x4e7671(_0x496e99,_0x2f6c0b,_0x14abf8,_0x325dba){return _0x26bb9e(_0x2f6c0b,_0x325dba-0xb2,_0x14abf8-0x15d,_0x325dba-0xed);}let _0x2ed14b=null;const _0x16b1b1=()=>{function _0x13718e(_0x38599c,_0x481496,_0x4d8848,_0x57d9e9){return _0x4e7671(_0x38599c-0x145,_0x38599c,_0x4d8848-0x1b2,_0x4d8848- -0x19a);}eventSource['removeList'+_0x13718e(-0x10d,-0x10c,-0xc2,-0xd3)](eventNames[_0x2ef6c0(-0x1f1,-0x255,-0x23a,-0x21e)+_0x13718e(-0x61,-0xe5,-0x94,-0x8a)+_0x13718e(-0x102,-0x7e,-0xb2,-0x84)],_0x39d88e);function _0x2ef6c0(_0x5677ce,_0x5d1682,_0x26f987,_0x2f8ada){return _0x4e7671(_0x5677ce-0x72,_0x5677ce,_0x26f987-0xe5,_0x26f987- -0x30e);}if(_0x2ed14b)clearTimeout(_0x2ed14b);},_0x39d88e=_0x30ce30=>{function _0x19a74f(_0x45c74d,_0x3da65c,_0x3b8532,_0x3eccb7){return _0x4e7671(_0x45c74d-0x159,_0x3b8532,_0x3b8532-0x13d,_0x3da65c- -0xfc);}function _0x1ce409(_0x165dbd,_0x39b68f,_0x499b60,_0x592d89){return _0x107335(_0x592d89-0xb8,_0x39b68f-0x7a,_0x499b60-0x63,_0x499b60);}const _0x2fd3a9={'JdrKP':function(_0x338e7b){return _0x345c94['mdiwx'](_0x338e7b);},'rsbgo':function(_0x58f3d9,_0x3c2955){return _0x58f3d9(_0x3c2955);}};if(_0x345c94[_0x19a74f(-0x16,-0x3a,0x7,0xf)](_0x345c94[_0x1ce409(0x1b5,0x200,0x1f9,0x1c1)],_0x1ce409(0x1b1,0x195,0x1b6,0x175))){if(_0x30ce30['id']!==_0x5be1c8)return;_0x345c94[_0x1ce409(0x1e9,0x184,0x1af,0x1af)](_0x16b1b1),console[_0x19a74f(0x2b,0xd,0x28,-0x29)](_0x19a74f(0x1a,0x3c,0x5e,0x88)+_0x1ce409(0x199,0x1bb,0x1c5,0x1c3)+_0x19a74f(0x3f,0x15,0x1b,-0x22)+'\x20'+_0x5be1c8+'):',_0x30ce30);if(_0x30ce30[_0x1ce409(0x141,0x145,0x1b4,0x17a)])_0x4ac6d7(_0x30ce30[_0x1ce409(0x18e,0x16e,0x19e,0x17e)]);else{if(_0x30ce30[_0x19a74f(0x3c,0x17,-0x27,0x29)]&&_0x30ce30[_0x1ce409(0x173,0x1a2,0x18c,0x1a2)][_0x1ce409(0x189,0x1bb,0x1af,0x1d7)]===_0x1ce409(0x1df,0x1d2,0x1f9,0x1db)){if(_0x345c94[_0x19a74f(-0x52,-0x41,-0x60,0x0)]===_0x345c94[_0x1ce409(0x191,0x1ab,0x1d5,0x1a9)]){const _0x2b6a6e=_0x1ed7a7?function(){function _0x22704f(_0x5acced,_0x4e8593,_0x187464,_0x2ccea0){return _0x19a74f(_0x5acced-0x1e6,_0x2ccea0-0x460,_0x5acced,_0x2ccea0-0x114);}if(_0x1ab023){const _0xf414ab=_0x2933ed[_0x22704f(0x47b,0x43c,0x467,0x46b)](_0x46c103,arguments);return _0x58e387=null,_0xf414ab;}}:function(){};return _0x30b5c7=![],_0x2b6a6e;}else{const _0x11005f=new Error(_0x30ce30[_0x19a74f(0x3d,0x17,0x20,0x40)][_0x1ce409(0x1aa,0x151,0x16c,0x172)]);_0x11005f['name']=_0x345c94[_0x19a74f(0x40,-0x9,-0x3d,-0x1b)],_0x345c94[_0x19a74f(0x62,0x2e,-0x7,0x55)](_0x360262,_0x11005f);}}else _0x345c94[_0x1ce409(0x202,0x211,0x1e3,0x1c8)]('OjZUD',_0x345c94[_0x19a74f(-0x2a,-0x31,-0x4c,-0x2c)])?(_0x2fd3a9['JdrKP'](_0x41c713),_0x2fd3a9[_0x19a74f(-0x2c,-0x15,-0x30,-0x37)](_0x29d7c5,new _0x3e7db0('翻译\x20LLM\x20执行超'+'时（'+_0x4b5a32+_0x1ce409(0x195,0x12f,0x1a0,0x152)))):_0x345c94[_0x19a74f(-0x2f,-0x1,-0x17,-0x16)](_0x360262,new Error(_0x30ce30[_0x1ce409(0x16a,0x13d,0x1af,0x17e)]));}}else{if(!_0x196b89[_0x1ce409(0x146,0x129,0x12c,0x16e)](_0x23f040))return'[]';return _0x206ea5['stringify'](_0x366f5a[_0x19a74f(0x61,0x4e,0x13,0xc)](_0x5ee728=>_0x5ee728&&typeof _0x5ee728===_0x19a74f(0x11,0x58,0x32,0x7f)));}};eventSource['on'](eventNames[_0x107335(0xab,0xe3,0x5f,0xcc)+_0x4e7671(0xb8,0x12d,0x13e,0x106)+_0x107335(0xbf,0xe9,0xe8,0xe3)],_0x39d88e);const _0x1a64a8={};function _0x107335(_0x29e35e,_0x2d910c,_0xf5efb6,_0x48fc97){return _0x26bb9e(_0x48fc97,_0x29e35e-0x89,_0xf5efb6-0x59,_0x48fc97-0x1e9);}_0x1a64a8['prompt']=_0x27bd62,_0x1a64a8['id']=_0x5be1c8,eventSource['emit'](eventNames['LLM_TRANSL'+_0x107335(0xef,0xef,0xf1,0xbf)+_0x107335(0x112,0x14d,0xd0,0x15a)],_0x1a64a8),_0x2ed14b=setTimeout(()=>{function _0x11ec8a(_0x16716b,_0x59f365,_0x380900,_0x108f7d){return _0x4e7671(_0x16716b-0xb4,_0x108f7d,_0x380900-0xcb,_0x59f365-0x1e6);}function _0x32205c(_0x3f95fe,_0x557191,_0x42245a,_0x4da802){return _0x107335(_0x4da802- -0x376,_0x557191-0x1ad,_0x42245a-0x17b,_0x42245a);}if(_0x2b210a['GrMhj'](_0x2b210a[_0x32205c(-0x272,-0x262,-0x24b,-0x251)],'TcKpA'))_0x2b210a['WhYmS'](_0x16b1b1),_0x2b210a[_0x11ec8a(0x32c,0x2fa,0x302,0x2f4)](_0x360262,new Error(_0x11ec8a(0x2fd,0x30a,0x351,0x2d9)+'时（'+timeoutMs+_0x32205c(-0x2ea,-0x30a,-0x292,-0x2dc)));else{const _0x2c9f5d=_0x5ea8d6[_0x32205c(-0x267,-0x26b,-0x301,-0x2b5)]();if(_0x2c9f5d)_0x16d01b[_0x11ec8a(0x373,0x327,0x314,0x2e7)](_0x2c9f5d);_0x449690='';}},timeoutMs);});}export async function callTranslation(_0x1ca1d8){function _0x839178(_0x592ff3,_0x212fd2,_0x14bf44,_0x26f19b){return _0x5259(_0x14bf44- -0x14f,_0x26f19b);}const _0x589edd={'HhPuc':function(_0x23d223,_0x2c6d64){return _0x23d223!==_0x2c6d64;},'sKsZH':function(_0x195ba1,_0x491303){return _0x195ba1!==_0x491303;},'ZdnXc':_0x839178(-0x5e,-0xa9,-0x82,-0xb6),'RVivW':_0x839178(-0x56,-0x73,-0x51,-0x2b),'AooMh':function(_0x4d1fd5,_0x21b060,_0x23a950){return _0x4d1fd5(_0x21b060,_0x23a950);},'CKShM':_0x839178(-0x89,-0xdc,-0x9c,-0x7d)+'n','OCCNw':function(_0x13d564,_0x1f0b66){return _0x13d564(_0x1f0b66);},'aBJjl':'user','jAqeh':function(_0x24524e,_0x39855e){return _0x24524e||_0x39855e;},'pnRsh':function(_0x1d4b71,_0x340c69){return _0x1d4b71(_0x340c69);},'GBDGX':_0x839178(-0x33,-0x6a,-0x46,-0x21)};function _0xa1b3e(_0x45ce70,_0x21868f,_0x3d60e0,_0x22fea9){return _0x5259(_0x22fea9-0xc6,_0x21868f);}try{if(_0x589edd[_0xa1b3e(0x1b6,0x1c1,0x1ac,0x1f5)](_0x589edd['ZdnXc'],_0x589edd[_0x839178(-0x56,-0x6,-0x41,-0x7e)])){let _0x32acd7=_0x589edd['AooMh'](buildPromptForRequestType,_0x589edd[_0xa1b3e(0x202,0x211,0x1b5,0x1d1)],_0x1ca1d8||'');_0x32acd7=_0x589edd[_0xa1b3e(0x192,0x1dd,0x1c9,0x1d9)](mergeAdjacentMessages,_0x32acd7);const _0xe1dec8=[..._0x32acd7,{'role':_0x589edd['aBJjl'],'content':_0x589edd[_0x839178(-0xc8,-0x8b,-0x95,-0x78)](_0x1ca1d8,'')}];_0x589edd['OCCNw'](updateCombinedPrompt,_0xe1dec8);const _0x42a119=await _0x589edd[_0x839178(-0x5c,0x1,-0x3c,-0x1c)](LLM_TRANSLATION,_0xe1dec8);return _0x42a119;}else{if(_0x589edd['HhPuc'](_0x1645e9['id'],_0x3df0a1))return;_0xb644ae[_0x839178(-0x52,-0xed,-0x9f,-0x78)+_0xa1b3e(0x159,0x17b,0x1ad,0x18a)](_0x2f6701[_0xa1b3e(0x190,0x146,0x1ba,0x186)+'ATION_GET_'+_0x839178(-0x7c,-0x7e,-0xa6,-0x73)+_0x839178(-0xbe,-0xa6,-0x88,-0x79)],_0x1b3de5);const {prompt:_0x155b6b}=_0x5f2cca;_0x554f08['log'](_0xa1b3e(0x1bf,0x1b1,0x21b,0x1ea)+'\x20已获取翻译提示词\x20'+'(ID:\x20'+_0x597125+'):',_0x155b6b),_0x481186(_0x155b6b);}}catch(_0x548c9d){_0x589edd[_0x839178(-0xd8,-0x96,-0xac,-0xc1)](addLog,_0xa1b3e(0x1b5,0x170,0x1d0,0x19e)+_0x548c9d['message']),console[_0xa1b3e(0x17a,0x1f8,0x1e7,0x1c5)](_0x589edd[_0x839178(-0x6f,-0xe6,-0xa3,-0x83)],_0x548c9d);throw _0x548c9d;}}let isAiInitialized=![];export function initAiSettings(_0x51c244){function _0x29f990(_0x25b9f6,_0x1a4aac,_0x170c15,_0x3421d8){return _0x5259(_0x25b9f6-0x252,_0x3421d8);}const _0x30d4e3={};_0x30d4e3[_0x29f990(0x37a,0x352,0x3b7,0x358)]=_0x29f990(0x376,0x36a,0x39c,0x390)+_0xb2097a(-0x261,-0x213,-0x215,-0x1d7)+_0xb2097a(-0x1bd,-0x1ea,-0x21e,-0x1c4);const _0x4edecc=_0x30d4e3;function _0xb2097a(_0x4d9e3e,_0x3c36a4,_0x266374,_0x4ea91b){return _0x5259(_0x3c36a4- -0x2f9,_0x4ea91b);}!isAiInitialized&&(console[_0xb2097a(-0x1e1,-0x204,-0x1dd,-0x1c1)](_0x4edecc[_0xb2097a(-0x1c2,-0x1d1,-0x21f,-0x19f)]),isAiInitialized=!![]);}