(function(_0x2acb12,_0x290d13){function _0x361ab3(_0x98afc5,_0x4205d7,_0x12847f,_0x491c3c){return _0x170a(_0x4205d7-0x59,_0x12847f);}function _0xe519ae(_0x28cff6,_0x4e3cdc,_0x463533,_0x3f6d6a){return _0x170a(_0x3f6d6a- -0x61,_0x4e3cdc);}const _0x14fdcb=_0x2acb12();while(!![]){try{const _0x15be56=-parseInt(_0xe519ae(0x1f6,0x19f,0x20d,0x1e5))/(-0x105*-0x3+0xf06+0x34*-0x59)*(-parseInt(_0x361ab3(0x2c7,0x2ba,0x272,0x2a3))/(0x1*-0x2099+0x68e+0x1a0d))+parseInt(_0x361ab3(0x213,0x243,0x221,0x270))/(0x206b+0x2193+-0x41fb)+-parseInt(_0xe519ae(0x275,0x230,0x250,0x22e))/(-0x149a+0x18aa+-0x40c)+parseInt(_0x361ab3(0x2dd,0x2c9,0x30b,0x2bb))/(0x2de+0x1a73+0xfa*-0x1e)*(-parseInt(_0xe519ae(0x26d,0x25f,0x24c,0x22a))/(-0x1*0x16ad+0x1aa1+0x1*-0x3ee))+parseInt(_0x361ab3(0x2f7,0x2d4,0x2f0,0x2d6))/(0x7f8*0x4+-0x14e6+-0xaf3)+parseInt(_0x361ab3(0x291,0x279,0x221,0x253))/(0x1b1*0x5+0xd*0x233+-0x2504)+-parseInt(_0xe519ae(0x15f,0x15a,0x14c,0x1a1))/(0x16e5*0x1+0x1aba+-0x241*0x16)*(-parseInt(_0xe519ae(0x19e,0x1dd,0x1bd,0x1cf))/(-0x22+-0xd4f+-0x1ed*-0x7));if(_0x15be56===_0x290d13)break;else _0x14fdcb['push'](_0x14fdcb['shift']());}catch(_0x36ed7d){_0x14fdcb['push'](_0x14fdcb['shift']());}}}(_0x3ee1,-0x31684*-0x1+-0xbdae3+0x12b93b));const _0x4756d5=(function(){function _0x274152(_0x2e0b28,_0x341351,_0x161022,_0x490c95){return _0x170a(_0x341351- -0x256,_0x161022);}const _0x2e556b={'kwixt':function(_0x4ad7fc,_0x5b4539){return _0x4ad7fc!==_0x5b4539;},'ZCnkO':_0x274152(-0x40,0x4,-0x31,-0x1e),'oSgiH':'iCsCW','CRKVJ':function(_0xbcd373,_0x3740c0){return _0xbcd373(_0x3740c0);}};let _0x112cc0=!![];return function(_0x364856,_0x515fff){const _0x123df0={'StdKu':function(_0x2d15d5,_0x356a2d){return _0x2e556b['CRKVJ'](_0x2d15d5,_0x356a2d);}},_0x311dc5=_0x112cc0?function(){function _0x26776c(_0x402b4b,_0x3d02af,_0x3720be,_0x1f42f6){return _0x170a(_0x3d02af- -0x79,_0x3720be);}function _0xa383e2(_0x1337db,_0x4373f5,_0x18ae11,_0x16f3e8){return _0x170a(_0x18ae11- -0x284,_0x4373f5);}if(_0x515fff){if(_0x2e556b[_0xa383e2(-0x91,-0xb6,-0x89,-0xbd)](_0x2e556b['ZCnkO'],_0x2e556b[_0xa383e2(-0x3c,0x48,-0xa,0x3e)])){const _0xba0fa1=_0x515fff['apply'](_0x364856,arguments);return _0x515fff=null,_0xba0fa1;}else _0x123df0[_0xa383e2(-0x3f,-0x7c,-0x2f,0x1d)](_0x4bfc5f,new _0x5a4a30(_0x2ee3c0[_0x26776c(0x258,0x215,0x1db,0x200)]));}}:function(){};return _0x112cc0=![],_0x311dc5;};}()),_0x18fd9b=_0x4756d5(this,function(){const _0x24fd56={};_0x24fd56[_0x3fcde5(0x433,0x44b,0x40d,0x404)]='(((.+)+)+)'+'+$';const _0x3a393a=_0x24fd56;function _0x3fcde5(_0x196a4d,_0x459ad1,_0x43a20b,_0x57ff57){return _0x170a(_0x196a4d-0x1be,_0x459ad1);}function _0xd14e14(_0xd18b58,_0x42a61e,_0x32ca03,_0x55117a){return _0x170a(_0xd18b58- -0x7f,_0x32ca03);}return _0x18fd9b['toString']()['search'](_0x3a393a[_0x3fcde5(0x433,0x41a,0x48b,0x442)])[_0xd14e14(0x1eb,0x201,0x241,0x212)]()[_0x3fcde5(0x3ce,0x424,0x3cb,0x400)+'r'](_0x18fd9b)[_0xd14e14(0x1b2,0x1af,0x1f1,0x1bf)](_0x3a393a['WOMho']);});_0x18fd9b();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';function _0x170a(_0x41386c,_0x5cdb0e){_0x41386c=_0x41386c-(-0xec1*-0x1+0x3*-0x417+-0x9a);const _0x2b2434=_0x3ee1();let _0xb678ba=_0x2b2434[_0x41386c];if(_0x170a['gOYDxp']===undefined){var _0x17db49=function(_0x53d42b){const _0x2ff9a8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x20391e='',_0x540ef4='',_0x4612dc=_0x20391e+_0x17db49;for(let _0x57d75b=0x1d0d+0x1b56+-0x1*0x3863,_0x4785c0,_0x187694,_0x1fdbd3=0x26bd+0x32b*-0x5+-0x7a2*0x3;_0x187694=_0x53d42b['charAt'](_0x1fdbd3++);~_0x187694&&(_0x4785c0=_0x57d75b%(-0xc6e*0x1+0xa7e*0x2+0x445*-0x2)?_0x4785c0*(-0xa59+-0x76a+0x1203)+_0x187694:_0x187694,_0x57d75b++%(-0x2*0x79f+-0x147a*-0x1+-0x538))?_0x20391e+=_0x4612dc['charCodeAt'](_0x1fdbd3+(-0x1515+0xdd*0x18+0x67))-(-0x201*-0x6+0x4*-0x209+-0x29*0x18)!==0x5c4+0x281+0x1*-0x845?String['fromCharCode'](-0x1*0xb43+-0x6*0x66b+0x6*0x876&_0x4785c0>>(-(0x1ed0+0xc25*0x1+0x3*-0xe51)*_0x57d75b&-0xbc4+-0x14fd+-0x20c7*-0x1)):_0x57d75b:-0x1*0xddb+-0x103e+0x1e19){_0x187694=_0x2ff9a8['indexOf'](_0x187694);}for(let _0x3c63d9=0x1ed*0x7+-0xd7e+-0x1*-0x3,_0x3da585=_0x20391e['length'];_0x3c63d9<_0x3da585;_0x3c63d9++){_0x540ef4+='%'+('00'+_0x20391e['charCodeAt'](_0x3c63d9)['toString'](-0x1db2+0x1043+0xd7f))['slice'](-(0x1aa3+-0x16f6*0x1+-0x3ab*0x1));}return decodeURIComponent(_0x540ef4);};_0x170a['NfVEGh']=_0x17db49,_0x170a['jPxuGw']={},_0x170a['gOYDxp']=!![];}const _0x47860d=_0x2b2434[-0x108a*-0x1+-0x866+-0x824],_0x435866=_0x41386c+_0x47860d,_0x168b25=_0x170a['jPxuGw'][_0x435866];if(!_0x168b25){const _0x273183=function(_0x128098){this['OQNzal']=_0x128098,this['aofeDU']=[-0xcc5+0x7*-0x3ac+0x267a,-0x45f*0x2+0x4c1*0x7+0xb*-0x23b,0x8*0x30+0x12ce+-0xa27*0x2],this['oyHnNc']=function(){return'newState';},this['JDULgh']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['YeQOrr']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x273183['prototype']['xlVtbE']=function(){const _0x510a28=new RegExp(this['JDULgh']+this['YeQOrr']),_0xd53fd0=_0x510a28['test'](this['oyHnNc']['toString']())?--this['aofeDU'][-0x9c1*-0x2+-0x12d8+-0x1*0xa9]:--this['aofeDU'][-0x8*-0x14c+-0x1*0x1104+0x6a4];return this['lCJXtB'](_0xd53fd0);},_0x273183['prototype']['lCJXtB']=function(_0x5b8a1a){if(!Boolean(~_0x5b8a1a))return _0x5b8a1a;return this['YEIrLt'](this['OQNzal']);},_0x273183['prototype']['YEIrLt']=function(_0x55733f){for(let _0x6e384=-0x1*0x1c73+0x14b2+0x5*0x18d,_0x5a410c=this['aofeDU']['length'];_0x6e384<_0x5a410c;_0x6e384++){this['aofeDU']['push'](Math['round'](Math['random']())),_0x5a410c=this['aofeDU']['length'];}return _0x55733f(this['aofeDU'][0x2051+0xdb1+-0x2e02]);},new _0x273183(_0x170a)['xlVtbE'](),_0xb678ba=_0x170a['NfVEGh'](_0xb678ba),_0x170a['jPxuGw'][_0x435866]=_0xb678ba;}else _0xb678ba=_0x168b25;return _0xb678ba;}import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x1747d6){function _0x5406c5(_0x1a5a06,_0x1c0c5e,_0xbc7928,_0x2382a5){return _0x170a(_0x1a5a06- -0x3b,_0x2382a5);}function _0x2325ed(_0x5a49bc,_0x760b23,_0x4d725f,_0xf9a53f){return _0x170a(_0x760b23- -0x2ce,_0xf9a53f);}return SKIP_PATTERNS[_0x5406c5(0x1a7,0x16a,0x1af,0x1fc)](_0x23055a=>_0x23055a[_0x5406c5(0x1fc,0x1e8,0x1a8,0x255)](_0x1747d6['trim']()));}export function tagsToJsonString(_0xae0d14){function _0x42af52(_0x1e5ccf,_0x2c9482,_0x379fe2,_0x14646f){return _0x170a(_0x2c9482- -0x18a,_0x379fe2);}if(!Array[_0x42af52(0xd0,0x76,0x70,0x96)](_0xae0d14))return'[]';function _0x2d6f18(_0x5b476e,_0x41c83f,_0x5223cf,_0x1cd85a){return _0x170a(_0x5b476e-0x2dd,_0x1cd85a);}return JSON[_0x42af52(0x137,0x106,0x150,0x121)](_0xae0d14[_0x42af52(0x87,0x9c,0x82,0x7c)](_0x1ae3f8=>_0x1ae3f8&&typeof _0x1ae3f8===_0x42af52(0x96,0x70,0x20,0x33)));}export function preprocessPromptForTranslation(_0x1befb2){function _0x4c9628(_0x5f4f6f,_0x30c75b,_0x5237a6,_0x359d82){return _0x170a(_0x5f4f6f- -0x108,_0x30c75b);}const _0x182600={'OOOjJ':_0xce2d4d(0x2d2,0x291,0x31e,0x307)+_0xce2d4d(0x291,0x2d7,0x251,0x2b8)+_0xce2d4d(0x27f,0x2a0,0x248,0x23e),'lsPSo':function(_0xa192f4,_0x1bbe26){return _0xa192f4===_0x1bbe26;},'KJZDL':_0x4c9628(0x157,0x12e,0x15d,0x1ab),'EDsFw':function(_0x42bfa5,_0x4d92f2){return _0x42bfa5!==_0x4d92f2;},'XJlik':_0xce2d4d(0x2b3,0x306,0x2db,0x2e9),'UdnSr':function(_0x75d204,_0x4ed4d5){return _0x75d204<_0x4ed4d5;},'WSzTD':function(_0x45c9ce,_0x1e4fb0){return _0x45c9ce===_0x1e4fb0;},'rPzLD':function(_0x39e655,_0x38e184){return _0x39e655!==_0x38e184;},'wTdrt':_0x4c9628(0xf2,0xd8,0xc1,0x147),'bizFn':_0xce2d4d(0x273,0x275,0x2b3,0x297),'ITWOQ':function(_0x1fe1ee,_0x5823d5){return _0x1fe1ee(_0x5823d5);},'mlpVl':'GkOYg','DBWAW':function(_0x673c22,_0x291689){return _0x673c22(_0x291689);},'wnyTX':function(_0x6fc811,_0x25b62e){return _0x6fc811(_0x25b62e);},'nmmSH':function(_0x2d616c,_0x345475){return _0x2d616c(_0x345475);},'NbQQA':function(_0x388e44,_0x482d76){return _0x388e44===_0x482d76;},'SYOdS':_0x4c9628(0xdf,0xec,0xd6,0x86)};if(!_0x1befb2||_0x182600[_0x4c9628(0x184,0x1bb,0x1b4,0x137)](typeof _0x1befb2,_0x182600['wTdrt'])){if(_0x182600[_0x4c9628(0x16b,0x161,0x1b6,0x172)]===_0x4c9628(0x109,0x12b,0xe4,0xbe)){const _0x2db317={};return _0x2db317[_0x4c9628(0xfd,0xfe,0x115,0x133)]=[],_0x2db317[_0xce2d4d(0x2a9,0x27c,0x26c,0x295)+'t']='',_0x2db317[_0xce2d4d(0x2a3,0x2db,0x277,0x25e)+'gs']=[],_0x2db317;}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};}const _0x2988ee=_0x4964b5=>{function _0x539ef7(_0xfc467,_0x1aab1a,_0x1fd668,_0x3755a6){return _0xce2d4d(_0x3755a6- -0x25e,_0x1aab1a-0x125,_0x1fd668-0x18d,_0x1fd668);}function _0x18f716(_0x283d72,_0x2bf0bf,_0x4179b7,_0x248c15){return _0xce2d4d(_0x2bf0bf-0x2a8,_0x2bf0bf-0x11,_0x4179b7-0xfc,_0x283d72);}if(_0x182600['EDsFw'](_0x182600['XJlik'],_0x182600[_0x539ef7(0xca,0xec,0x8c,0x93)]))_0x4e6bdf['log'](_0x182600['OOOjJ']),_0x299ade=!![];else{const _0x595e9c=[];let _0x4b9fcc='',_0x86a479=![];for(let _0x1398d4=-0x1e91+0x1*0x139+0x9c8*0x3;_0x182600[_0x539ef7(0xa1,0xad,0x51,0x5f)](_0x1398d4,_0x4964b5[_0x18f716(0x4f1,0x549,0x527,0x4f7)]);_0x1398d4++){const _0x2deee1=_0x4964b5[_0x1398d4];if(_0x182600['lsPSo'](_0x2deee1,'$'))_0x86a479=!_0x86a479,_0x4b9fcc+=_0x2deee1;else{if((_0x182600['WSzTD'](_0x2deee1,',')||_0x2deee1==='，')&&!_0x86a479){if(_0x182600[_0x539ef7(0x85,0x5c,0xea,0x92)](_0x539ef7(-0x1b,0x2a,0x4e,-0x9),_0x539ef7(0x66,0xf,0xa2,0x5a))){const _0xb4566a=_0x4b9fcc[_0x18f716(0x502,0x553,0x521,0x54e)]();if(_0xb4566a)_0x595e9c['push'](_0xb4566a);_0x4b9fcc='';}else{const _0x503e2c=_0x6580a8['match'](/\{[\s\S]*\}/);if(_0x503e2c){const _0x43c720=_0x542a61[_0x18f716(0x52f,0x4f4,0x548,0x50e)](_0x503e2c[-0x4d*-0x50+-0x1e21+-0x611*-0x1]);if(_0x182600[_0x539ef7(0x24,0x57,0x26,0x59)](typeof _0x43c720,_0x182600[_0x539ef7(0x23,0x22,0x6,0x5)])&&_0x43c720!==null)return _0x43c720;}}}else _0x4b9fcc+=_0x2deee1;}}if(_0x4b9fcc['trim']())_0x595e9c[_0x18f716(0x5cf,0x58b,0x53a,0x579)](_0x4b9fcc[_0x539ef7(0x20,0x70,0x5a,0x4d)]());return _0x595e9c;}},_0x4311a4=_0x182600[_0x4c9628(0x122,0x155,0x171,0xfa)](_0x2988ee,_0x1befb2),_0x351766=[];function _0xce2d4d(_0x359e12,_0x5730ce,_0x2b30c0,_0x22d36c){return _0x170a(_0x359e12-0x64,_0x22d36c);}const _0x1cb80c=[],_0x52fdf7=new Map();for(const _0x3632a4 of _0x4311a4){const _0x3a6e60=_0x3632a4[_0xce2d4d(0x2d8,0x2a1,0x316,0x2ab)](SD_SYMBOL_PATTERN);if(_0x3a6e60){if(_0x182600[_0xce2d4d(0x2f7,0x310,0x2c2,0x30a)]!==_0x182600[_0x4c9628(0x18b,0x151,0x13d,0x1d4)])_0x2c2314[_0xce2d4d(0x2e3,0x2fb,0x2f2,0x322)](_0x1bec54),_0x622027[_0x4c9628(0xea,0xd0,0xbf,0xda)](_0x41386c[_0xce2d4d(0x293,0x2da,0x261,0x2a3)+'e'](),_0x5cdb0e);else{const _0x5b61e8=_0x3a6e60[0x14a+-0x1f9e*0x1+0x1e55]||'',_0x3b934f=(_0x3a6e60[0x6d1*0x1+0x1*-0x26d6+-0x2007*-0x1]||'')[_0xce2d4d(0x2ab,0x2d0,0x2dd,0x29d)](),_0x401a1f=_0x3a6e60[0x1*0xe3b+-0x4e5*-0x3+0x7*-0x421]||'',_0x2078fe=_0x3a6e60[-0x1*0x13c4+0x216e+-0xda6]||'',_0x236779={'original':_0x3632a4,'cleaned':_0x3b934f,'prefix':_0x5b61e8,'suffix':_0x401a1f,'weight':_0x2078fe,'skip':_0x182600[_0xce2d4d(0x298,0x246,0x294,0x24c)](shouldSkipTranslation,_0x3632a4)||_0x182600['wnyTX'](shouldSkipTranslation,_0x3b934f)};_0x351766[_0xce2d4d(0x2e3,0x32d,0x2b5,0x2e5)](_0x236779),!_0x236779['skip']&&_0x3b934f&&(_0x1cb80c[_0x4c9628(0x177,0x168,0x177,0x185)](_0x3b934f),_0x52fdf7[_0x4c9628(0xea,0xee,0x122,0xc9)](_0x3b934f[_0x4c9628(0x127,0x16e,0x135,0x167)+'e'](),_0x236779));}}else{const _0x4bfccf={'original':_0x3632a4,'cleaned':_0x3632a4,'prefix':'','suffix':'','weight':'','skip':_0x182600[_0xce2d4d(0x281,0x267,0x254,0x2c4)](shouldSkipTranslation,_0x3632a4)};_0x351766[_0x4c9628(0x177,0x15e,0x184,0x15d)](_0x4bfccf);if(!_0x4bfccf[_0xce2d4d(0x286,0x233,0x29d,0x27a)]&&_0x3632a4){if(_0x182600[_0x4c9628(0x17d,0x1d5,0x18e,0x170)](_0x182600[_0xce2d4d(0x2c2,0x2fd,0x2a6,0x28f)],_0x182600[_0xce2d4d(0x2c2,0x280,0x29e,0x2e3)]))_0x1cb80c[_0xce2d4d(0x2e3,0x2d2,0x2ac,0x2a5)](_0x3632a4),_0x52fdf7[_0x4c9628(0xea,0x10c,0xfa,0x143)](_0x3632a4[_0x4c9628(0x127,0x12d,0x109,0x11f)+'e'](),_0x4bfccf);else{const {original:_0x889855,cleaned:_0x3cd48f,skip:_0x40aa89}=_0x264a9e;if(_0x40aa89){const _0x8df18a={};return _0x8df18a[_0xce2d4d(0x2eb,0x2cf,0x33b,0x2ba)]=_0x889855,_0x8df18a['translatio'+'n']='',_0x8df18a[_0x4c9628(0x15d,0x170,0x12e,0x14b)]=_0x3cd48f,_0x8df18a[_0xce2d4d(0x2e5,0x296,0x2fd,0x2ea)]=!![],_0x8df18a;}const _0x3b3ef0=_0x199d90[_0x3cd48f[_0xce2d4d(0x293,0x27f,0x2df,0x276)+'e']()]||'',_0x1878e4={};return _0x1878e4['original']=_0x889855,_0x1878e4['translatio'+'n']=_0x3b3ef0,_0x1878e4['cleaned']=_0x3cd48f,_0x1878e4[_0x4c9628(0x179,0x143,0x165,0x1ac)]=![],_0x1878e4;}}}}return{'originalTags':_0x351766,'cleanedTags':_0x1cb80c,'cleanedText':_0x182600[_0xce2d4d(0x281,0x274,0x2bb,0x2af)](tagsToJsonString,_0x1cb80c),'tagMap':_0x52fdf7};}export function combineTranslationResult(_0x4d61dd,_0x3d0a6d){function _0x5a8835(_0x203f7a,_0x4c3820,_0x39af9c,_0x3fb826){return _0x170a(_0x39af9c-0x1a6,_0x3fb826);}const _0x47b5b7={'PvVZR':function(_0xacf875,_0x14fce8){return _0xacf875(_0x14fce8);},'qyxCo':function(_0x3817f2,_0x5f17e8){return _0x3817f2!==_0x5f17e8;},'jJzFO':function(_0x5ec994,_0x1447c2){return _0x5ec994===_0x1447c2;},'whzMg':'WKlgq','VWCNf':_0x5a8835(0x3f1,0x3ef,0x3f7,0x3cc),'xFsRP':function(_0x2cf62c,_0x35700d){return _0x2cf62c===_0x35700d;},'MJnBX':_0x5a8835(0x3d2,0x3aa,0x3cf,0x3b9),'QctNm':function(_0x4115f6,_0xc006cd){return _0x4115f6===_0xc006cd;}};if(!_0x4d61dd||!Array['isArray'](_0x4d61dd)){if(_0x47b5b7['xFsRP']('hFMbk',_0x47b5b7[_0x4bbfe7(0x5b9,0x632,0x5eb,0x5ce)]))_0x47b5b7[_0x5a8835(0x3b0,0x3c5,0x3e2,0x3bb)](_0x210f3f,_0x17dafb[_0x4bbfe7(0x5ff,0x5da,0x5f6,0x5d1)]);else return[];}function _0x4bbfe7(_0x864a95,_0x2b2f06,_0x571cc1,_0x235c06){return _0x170a(_0x571cc1-0x368,_0x2b2f06);}const _0x1347a8={};if(_0x3d0a6d&&_0x47b5b7[_0x5a8835(0x3d3,0x3b4,0x40e,0x426)](typeof _0x3d0a6d,_0x4bbfe7(0x5b6,0x59a,0x5c7,0x58f)))for(const [_0x5897c2,_0x3f1492]of Object[_0x4bbfe7(0x607,0x608,0x5cc,0x604)](_0x3d0a6d)){_0x1347a8[_0x5897c2['toLowerCas'+'e']()]=_0x3f1492;}return _0x4d61dd[_0x4bbfe7(0x5a2,0x5c7,0x584,0x55a)](_0xb462db=>{function _0x5d73c9(_0x1b6573,_0x4977e7,_0x268f1a,_0x218ad8){return _0x5a8835(_0x1b6573-0x4b,_0x4977e7-0x20,_0x1b6573-0x16d,_0x268f1a);}function _0x12cae1(_0x38db5f,_0x15f5df,_0x41d3fc,_0x234cbc){return _0x4bbfe7(_0x38db5f-0x1bb,_0x38db5f,_0x41d3fc- -0x268,_0x234cbc-0x152);}if(_0x47b5b7[_0x12cae1(0x2d1,0x2fb,0x327,0x307)](_0x47b5b7[_0x5d73c9(0x58a,0x5bc,0x5cc,0x553)],_0x47b5b7[_0x5d73c9(0x51f,0x500,0x518,0x564)])){if(_0x47b5b7[_0x12cae1(0x2b0,0x2f9,0x2ef,0x331)](_0x1abb7f['id'],_0x8f0fb5))return;_0x4e095a[_0x12cae1(0x2b9,0x339,0x2e5,0x2a4)+_0x12cae1(0x2b1,0x2f6,0x2fd,0x2bf)](_0xceca03[_0x5d73c9(0x561,0x575,0x53c,0x55f)+_0x5d73c9(0x573,0x5b1,0x5cc,0x5c5)+_0x5d73c9(0x4fe,0x4bc,0x4da,0x4f4)+_0x12cae1(0x382,0x393,0x371,0x39c)],_0x4c0cf4);const {prompt:_0x9f0dc8}=_0x3dda53;_0x4b1ca7[_0x5d73c9(0x51a,0x510,0x508,0x4c0)](_0x5d73c9(0x581,0x58d,0x584,0x58d)+_0x5d73c9(0x575,0x57d,0x55a,0x52a)+'(ID:\x20'+_0xa5be40+'):',_0x9f0dc8),_0x47b5b7[_0x5d73c9(0x54f,0x50c,0x56d,0x578)](_0x82903e,_0x9f0dc8);}else{const {original:_0x412197,cleaned:_0x584b04,skip:_0x282373}=_0xb462db;if(_0x282373){const _0x5c3507={};return _0x5c3507['original']=_0x412197,_0x5c3507[_0x12cae1(0x378,0x383,0x36c,0x36f)+'n']='',_0x5c3507['cleaned']=_0x584b04,_0x5c3507[_0x12cae1(0x3db,0x33f,0x381,0x335)]=!![],_0x5c3507;}const _0x4d407d=_0x1347a8[_0x584b04[_0x5d73c9(0x542,0x567,0x4ec,0x51d)+'e']()]||'',_0xf254bc={};return _0xf254bc[_0x12cae1(0x345,0x387,0x387,0x373)]=_0x412197,_0xf254bc[_0x5d73c9(0x57f,0x5a4,0x59b,0x537)+'n']=_0x4d407d,_0xf254bc[_0x12cae1(0x326,0x365,0x365,0x358)]=_0x584b04,_0xf254bc[_0x5d73c9(0x594,0x59d,0x5e2,0x597)]=![],_0xf254bc;}});}export function formatTranslationDisplay(_0x2cd1f1,_0x3d6035={}){const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x3d6035;function _0x2acdec(_0x35fc41,_0x3bf217,_0x322494,_0x147bba){return _0x170a(_0x147bba-0x1,_0x322494);}function _0xeef7cc(_0x1bb0e4,_0x255de4,_0x4f192d,_0x43a94a){return _0x170a(_0x4f192d-0x30b,_0x43a94a);}if(!_0x2cd1f1||!Array[_0x2acdec(0x1bc,0x1e1,0x1bb,0x201)](_0x2cd1f1))return'';return _0x2cd1f1[_0xeef7cc(0x55c,0x55e,0x527,0x4e1)](_0x351cac=>{function _0x2a43f3(_0xa171b0,_0x50670d,_0x2e42b4,_0x2e8bec){return _0x2acdec(_0xa171b0-0x158,_0x50670d-0x83,_0x2e8bec,_0x2e42b4-0x3f);}if(_0x351cac['skipped'])return showOriginal?_0x351cac[_0x2a43f3(0x2ac,0x2e3,0x2c7,0x2a0)]:'';const _0x167aa1=[];if(showOriginal)_0x167aa1[_0x1629ba(0x5b,0x1c,0x57,0x65)](_0x351cac['original']);function _0x1629ba(_0x4f93c5,_0x554801,_0x1cdab1,_0x14279a){return _0x2acdec(_0x4f93c5-0x18e,_0x554801-0x35,_0x554801,_0x1cdab1- -0x229);}return showTranslation&&_0x351cac['translatio'+'n']&&_0x167aa1[_0x2a43f3(0x2b4,0x292,0x2bf,0x2a9)]('('+_0x351cac['translatio'+'n']+')'),_0x167aa1[_0x2a43f3(0x2c0,0x223,0x26c,0x24e)]('\x20');})[_0x2acdec(0x207,0x268,0x275,0x227)](Boolean)[_0xeef7cc(0x530,0x559,0x537,0x577)](separator);}export async function translatePromptTags(_0x2250a8){const _0x41dc2f={'ICzhs':function(_0x2bcb8d,_0xc44fdb){return _0x2bcb8d(_0xc44fdb);},'btQxr':function(_0xba049a,_0x256104){return _0xba049a!==_0x256104;},'cdhtw':'qXUUS','LXWxE':function(_0x487494,_0x5a44da){return _0x487494===_0x5a44da;},'ICCVT':_0x49060b(0x385,0x3ad,0x34c,0x38e),'NuVIR':_0x3bfd9a(0x323,0x37b,0x328,0x347),'pPuRL':function(_0x153b18,_0x56c7e7){return _0x153b18(_0x56c7e7);},'vxegp':function(_0x1fd143,_0x239265){return _0x1fd143(_0x239265);},'SyrGc':function(_0xf2963d,_0x433ed2,_0x54bac1){return _0xf2963d(_0x433ed2,_0x54bac1);},'slNWF':function(_0x4087b3,_0x5e22dc){return _0x4087b3(_0x5e22dc);},'USFVB':_0x3bfd9a(0x395,0x3dc,0x3b4,0x415)+_0x3bfd9a(0x3f2,0x3a7,0x382,0x3a7)+':'};function _0x49060b(_0x109cd,_0x42677a,_0x5ed41f,_0xf52d8){return _0x170a(_0x109cd-0x153,_0xf52d8);}function _0x3bfd9a(_0x32cbcd,_0x594320,_0x1b6f9e,_0x36f61c){return _0x170a(_0x594320-0x16e,_0x32cbcd);}const {originalTags:_0x33027c,cleanedText:_0x3b7f4a}=_0x41dc2f[_0x49060b(0x348,0x399,0x38f,0x374)](preprocessPromptForTranslation,_0x2250a8);if(!_0x3b7f4a){if(_0x41dc2f[_0x49060b(0x367,0x31f,0x33e,0x30d)](_0x3bfd9a(0x376,0x362,0x30d,0x387),_0x41dc2f[_0x49060b(0x365,0x323,0x382,0x35b)]))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x5752d2()};else{const _0x20f274={};return _0x20f274[_0x49060b(0x358,0x3ab,0x34b,0x327)]=[],_0x20f274[_0x3bfd9a(0x3dd,0x3b3,0x3ee,0x38d)+'t']='',_0x20f274['originalTa'+'gs']=[],_0x20f274;}}try{if(_0x41dc2f['LXWxE'](_0x41dc2f[_0x49060b(0x38b,0x3d0,0x358,0x3e0)],_0x41dc2f[_0x3bfd9a(0x370,0x3be,0x373,0x369)]))return _0x110f92;else{const _0x16f9cb=await _0x41dc2f['pPuRL'](callTranslation,_0x3b7f4a),_0x5ed907=_0x41dc2f['vxegp'](parseTranslationResult,_0x16f9cb),_0x508a39=_0x41dc2f[_0x49060b(0x37b,0x361,0x39b,0x3d3)](combineTranslationResult,_0x33027c,_0x5ed907),_0x7e2ccf=_0x41dc2f[_0x49060b(0x361,0x3b3,0x34b,0x369)](formatTranslationDisplay,_0x508a39),_0x484ed2={};return _0x484ed2['results']=_0x508a39,_0x484ed2[_0x3bfd9a(0x363,0x3b3,0x38b,0x39e)+'t']=_0x7e2ccf,_0x484ed2[_0x3bfd9a(0x3c4,0x3ad,0x3e9,0x3f5)+'gs']=_0x33027c,_0x484ed2;}}catch(_0x12e3ec){console[_0x3bfd9a(0x35e,0x35a,0x31f,0x329)](_0x41dc2f[_0x3bfd9a(0x3c3,0x3f8,0x412,0x3f4)],_0x12e3ec);throw _0x12e3ec;}}function _0x3ee1(){const _0x268db2=['sLDAB3e','CMnkvwW','tMTOvhq','zMLSDgvY','AKP6rK8','u3LYr2m','z3vyvee','svrxt1e','AwTXA3C','AM9PBG','iefjioIUVUE9RUw3SUE7N+s4GowiSa','v2XNENK','Dg9mB3DLCKnHCW','mJeYmJGZmgr5vfDzqq','C2vHCMnO','tfzpuwi','5BcD6k+v5PEN5Qc85BYpoG','rejxqvC','EwPqBKO','A1D3z1C','DgvZDa','sundvLq','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','CMfUzg9Tvvvjra','ENnNvLi','uhzwwLi','BgvUz3rO','t05trq','B3jPz2LUywXuyq','ALfTrhq','Bhv0z3y','DM1lvwm','vKjoAhi','ANHXqKC','zgLZCgXHEvrLEa','mKPmvKDntW','DhjPBq','B21Ytva','rvffyxi','q1nHC3G','CgjeEue','iePtt07OP6pMNPdLPlhOTkxVViW','DxnLCG','teXnx1rsqu5tta','wMveCum','tNvwsvi','AhvlAvO','thHLrfa','Bhnqu28','txftAMq','u3rKs3u','D05ssxu','r2XRz0e','v3fNt0W','vwrUu3i','revJq3a','sfD2vei','sNj5yLK','seXVBhq','u1Lpzfm','B2jQzwn0','qvrjt05Fr0vuxW','mJaXotm4D0Xgz3n3','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','qwjVCNrfCNjVCG','zw50CMLLCW','y2XLyw5Lza','tvHqCvq','q3fSs1y','uwn0tM0','iow3SUAuTUwiSoE/U+IVKsbmte0','Dg9tDhjPBMC','yMXtt1m','DhjHBNnSyxrPBW','qNDbrMu','C3qTy2HHDhu4oG','57+76k+r5AsX6lsLoIa','mtuXnZv5tMTkwve','ue9ou0u','BMfTzq','yML6rM4','Bwf0y2G','v09nAg8','CMfUzg9T','D2H6twC','rvnu','twLVA3e','B1nNAuG','mJu1odGWohz2vMfVDG','57+76k+r5AsX6lsLoG','DfLiEhG','A1fLzLq','ChvZAa','BxpVViK','C2TPChbLza','qvrjt05FuKvtua','tuPUqLG','D2fYBG','tMjruue','rLLzrwy','B3jPz2LUywW','r1PPBLy','BgvZvg4','vvngvKi','mtC0nNzguujHrW','CLb6teq','wePSAwS','CMvZDwX0','mti3ntK2nef2zNjxuW','C3rYAw5NAwz5','uhvYv20','C3vIC3rYAw5N','BwXWvMW','BwvZC2fNzq','C29Tzq','vuvtva','uNnTC3u','CMvTB3zLtgLZDa','u1DMELq','EvzLtxq','CgfYC2u','ChjVBxb0','mtuXndm0sK1YuLPL','ufjptvbux1jfuW','zxjYB3i','r1jKD3C','C3bSAxq','CxL4q28','zw1PDa','y2vwEMO','C2v0','BM93','CvHvvvm','sun6Ahm','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','rKzQwK8','ioAjP+IHJoE7K+AENcaOsuq6','t2nRs3e','C3rYAw5N','A3DPEhq','C3vJy2vZCW','zw5LCG','CxfRz3G','s0PAreW','AxnbCNjHEq','uLzwA1K','mJDxEeXlteu','yKHTufm','rKL1sem','CMvZDwX0CW','wuvTvfG','Bg9N','Ehzuvei','C2XPy2u','C3vqy2G','D3vlrKO','vLDdtMy','qKn6svi','C2Xov0y','u2fLB1a','y29UC3rYDwn0BW','zfLqCLu','y2rODhC','reX5ru4','yNrrEhi','y2Dor1C','sMTzvey','ufjptvbux1jfuq','uevxr2i','uLntzfa','wNfMt2K','ieXmtsdORR7NVA7POBxPNAi','BwfW','BM1Tu0G','vLvlqu8','tKXSt2C','ndC5otaWmgj4CuTRuG','uM54DxK','C2TPCa'];_0x3ee1=function(){return _0x268db2;};return _0x3ee1();}export function parseTranslationResult(_0x1915c7){const _0x3bf364={'JWZoq':function(_0x3cbd97,_0x441bfe){return _0x3cbd97===_0x441bfe;},'wNRIu':_0x2427d3(-0x3d,-0x28,-0x6c,-0x5f),'yjPnJ':_0x126e59(0x48e,0x4e3,0x509,0x50b),'GZinV':function(_0x18e84b,_0x2b0633){return _0x18e84b!==_0x2b0633;},'ABrLe':'st-chatu8:'+'\x20JSON解析失败，'+_0x126e59(0x4e0,0x4b7,0x4e1,0x4a1),'Rnxuy':function(_0x1fe7a9,_0x35ed7a){return _0x1fe7a9(_0x35ed7a);},'CqlKV':function(_0x730940,_0x35ac08){return _0x730940>_0x35ac08;},'QZhSX':function(_0x475d60,_0x4ee155){return _0x475d60+_0x4ee155;}};if(!_0x1915c7)return{};try{if(_0x3bf364[_0x2427d3(0x15,-0x1d,-0x4c,-0x35)](_0x3bf364[_0x2427d3(-0x4b,-0xc,0x1c,-0x2)],_0x3bf364[_0x126e59(0x511,0x4da,0x4ff,0x4ab)])){const _0x387262=_0x1915c7[_0x2427d3(0x38,0x6d,0x3a,0x1c)](/\{[\s\S]*\}/);if(_0x387262){const _0xc7b7e0=JSON[_0x126e59(0x416,0x46c,0x4c2,0x43d)](_0x387262[-0x839+-0x6d*-0x2a+-0x9a9]);if(_0x3bf364['JWZoq'](typeof _0xc7b7e0,_0x3bf364[_0x2427d3(0x24,0x24,-0x6b,-0x23)])&&_0x3bf364[_0x2427d3(0x54,0x3e,0x75,0x30)](_0xc7b7e0,null))return _0xc7b7e0;}}else{const _0x106143=_0x27d80c[_0x2af69e];if(_0x3bf364[_0x126e59(0x47d,0x4a7,0x4d0,0x4d4)](_0x106143,'$'))_0xb7161f=!_0x438978,_0x111592+=_0x106143;else{if((_0x3bf364['JWZoq'](_0x106143,',')||_0x3bf364[_0x126e59(0x4ff,0x4a7,0x4ee,0x4a5)](_0x106143,'，'))&&!_0x52d162){const _0x5c3925=_0x2bdec4[_0x2427d3(-0x3a,-0x22,-0xe,-0x11)]();if(_0x5c3925)_0x192f29['push'](_0x5c3925);_0x503381='';}else _0x13aa7b+=_0x106143;}}}catch(_0xd80d27){console[_0x126e59(0x4dc,0x508,0x4cc,0x508)](_0x3bf364['ABrLe'],_0xd80d27[_0x2427d3(0x57,0x1e,0xc,0x3c)]);}const _0x933795=_0x3bf364[_0x2427d3(-0x2b,-0x8e,-0x68,-0x37)](String,_0x1915c7)['replace'](/[\r\n]+/g,'\x20')['replace'](/^[\s"'`]+|[\s"'`]+$/g,'')['trim'](),_0x2fd081=_0x933795[_0x126e59(0x46b,0x472,0x448,0x484)](/[,，]/)[_0x126e59(0x45d,0x4a0,0x483,0x4af)](_0x11c076=>_0x11c076[_0x2427d3(0x11,-0x13,-0x8,-0x11)]())[_0x2427d3(-0x3,-0xc,-0x64,-0x32)](Boolean),_0x81bcab={};for(const _0x1c59a0 of _0x2fd081){const _0x963d46=_0x1c59a0['indexOf']('\x5c');if(_0x3bf364[_0x126e59(0x4d1,0x4eb,0x4bb,0x499)](_0x963d46,0x1ebe+-0x2575*0x1+0x6b7)){const _0x57a25e=_0x1c59a0[_0x126e59(0x441,0x48d,0x4e5,0x458)](0x6e*-0x52+-0x1*-0x1559+-0x1*-0xde3,_0x963d46)[_0x2427d3(-0x17,0x46,-0x7,-0x11)](),_0x7e9cec=_0x1c59a0['slice'](_0x3bf364['QZhSX'](_0x963d46,0x17c1*0x1+-0x17e4+0x24))['trim']();if(_0x57a25e)_0x81bcab[_0x57a25e]=_0x7e9cec;}}function _0x2427d3(_0x2712ef,_0x48700d,_0x536b87,_0x35ace2){return _0x170a(_0x35ace2- -0x258,_0x536b87);}function _0x126e59(_0x408197,_0x1f9e69,_0x2430c9,_0x5d906c){return _0x170a(_0x1f9e69-0x284,_0x5d906c);}return _0x81bcab;}function generateRequestId(){const _0x5739df={};_0x5739df[_0x3656d7(0x517,0x552,0x55c,0x5a0)]=function(_0x32fa02,_0x42451d){return _0x32fa02+_0x42451d;};function _0x3656d7(_0x3ee3d1,_0x19dafd,_0x17a8e0,_0x306c79){return _0x170a(_0x17a8e0-0x356,_0x19dafd);}function _0x496812(_0x2b14f3,_0x40f4e5,_0x425b60,_0xbee2b1){return _0x170a(_0x2b14f3-0x49,_0xbee2b1);}const _0x2c6f64=_0x5739df;if(crypto&&crypto['randomUUID'])return crypto['randomUUID']();return _0x2c6f64[_0x496812(0x24f,0x221,0x200,0x284)](Date['now']()[_0x3656d7(0x5ba,0x5a8,0x5c0,0x600)](0x523*0x5+-0xaae*0x2+-0x42f),Math[_0x3656d7(0x5e8,0x5ce,0x5cc,0x57a)]()[_0x3656d7(0x5cc,0x5b2,0x5c0,0x5f4)](0x645+-0xd53+0x732)[_0x496812(0x2db,0x2f5,0x2c0,0x298)](-0x1af9+-0x199f+-0x1a4d*-0x2));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x28b92a={'bHmPS':function(_0x4c5c23,_0x56f845){return _0x4c5c23!==_0x56f845;},'wuKFJ':function(_0x94412,_0x5060a1){return _0x94412(_0x5060a1);},'gNvTB':'WsEAm','LxeDP':function(_0xba8ee0,_0x3e3a02){return _0xba8ee0===_0x3e3a02;},'PEWGb':_0x498532(0x2dd,0x325,0x31e,0x300),'GRdww':function(_0x474c80,_0xc58a9c,_0x1534b9){return _0x474c80(_0xc58a9c,_0x1534b9);}};function _0x498532(_0x4fde9a,_0x233de7,_0x507e2a,_0x1f289c){return _0x170a(_0x507e2a-0x104,_0x4fde9a);}return new Promise((_0x885cbf,_0x2110a0)=>{function _0x3358dd(_0x2f3ffd,_0xe4c582,_0x52e5c6,_0xc07f81){return _0x498532(_0xe4c582,_0xe4c582-0x1e7,_0x2f3ffd- -0xb9,_0xc07f81-0xbf);}const _0x5b77de={'MXPqT':function(_0x2922d9,_0x54d7d8){function _0x1855a8(_0x4dc312,_0x4830c1,_0x392f7c,_0x1cff87){return _0x170a(_0x4830c1- -0x152,_0x392f7c);}return _0x28b92a[_0x1855a8(0xb1,0xb1,0x9e,0xc7)](_0x2922d9,_0x54d7d8);},'FFjZO':_0x28b92a['gNvTB'],'kKTbI':function(_0x5c9a18,_0x4701f3){return _0x5c9a18(_0x4701f3);}};function _0x5c2a4b(_0x1370a4,_0x48e1ed,_0x49baca,_0x4fb413){return _0x498532(_0x48e1ed,_0x48e1ed-0x11b,_0x49baca- -0x10a,_0x4fb413-0x5e);}if(_0x28b92a[_0x5c2a4b(0x25c,0x28f,0x24c,0x278)](_0x28b92a[_0x5c2a4b(0x1ca,0x20e,0x212,0x23d)],_0x3358dd(0x270,0x26a,0x234,0x224)))_0x2570bd=!_0x5abe8b,_0x1ad6d+=_0x946125;else{const _0x5b4bef=generateRequestId();console[_0x5c2a4b(0x203,0x1f7,0x201,0x241)](_0x5c2a4b(0x235,0x230,0x268,0x29a)+_0x5c2a4b(0x212,0x20f,0x1f0,0x1fe)+'\x20(ID:\x20'+_0x5b4bef+')');const _0x4907fe=_0x3b4c8b=>{function _0x2346be(_0x32cc80,_0x1b148c,_0x304d4a,_0x3784e9){return _0x5c2a4b(_0x32cc80-0x100,_0x1b148c,_0x304d4a- -0x2c,_0x3784e9-0x11c);}if(_0x28b92a['bHmPS'](_0x3b4c8b['id'],_0x5b4bef))return;eventSource[_0x2346be(0x1cb,0x1a7,0x1b3,0x1b9)+_0x2346be(0x1a4,0x17c,0x1cb,0x18e)](eventNames[_0x2772f0(0x619,0x64c,0x612,0x5f8)+_0x2772f0(0x62a,0x608,0x624,0x5f2)+'PROMPT_RES'+'PONSE'],_0x4907fe);const {prompt:_0x5a0c13}=_0x3b4c8b;console['log'](_0x2772f0(0x64d,0x66b,0x632,0x644)+_0x2346be(0x1f6,0x1fb,0x230,0x203)+'(ID:\x20'+_0x5b4bef+'):',_0x5a0c13);function _0x2772f0(_0x5b2229,_0x4e7105,_0x2145b2,_0x2ba1d4){return _0x5c2a4b(_0x5b2229-0xf2,_0x2ba1d4,_0x2145b2-0x3ca,_0x2ba1d4-0x13f);}_0x28b92a[_0x2346be(0x1e8,0x1de,0x1d9,0x21f)](_0x885cbf,_0x5a0c13);};eventSource['on'](eventNames[_0x3358dd(0x299,0x294,0x2b6,0x25b)+_0x5c2a4b(0x235,0x247,0x25a,0x223)+'PROMPT_RES'+_0x3358dd(0x2bc,0x2dc,0x309,0x265)],_0x4907fe);const _0x444e3c={};_0x444e3c['id']=_0x5b4bef,eventSource[_0x5c2a4b(0x1f9,0x1b9,0x1ea,0x200)](eventNames[_0x3358dd(0x299,0x23f,0x251,0x2ea)+_0x5c2a4b(0x298,0x280,0x25a,0x216)+_0x5c2a4b(0x1db,0x24d,0x211,0x207)+_0x3358dd(0x22e,0x232,0x24a,0x267)],_0x444e3c),_0x28b92a[_0x3358dd(0x238,0x256,0x1f3,0x1f9)](setTimeout,()=>{function _0x294a12(_0xf3a360,_0x130c2b,_0x26b9f9,_0x813a77){return _0x3358dd(_0x813a77- -0x202,_0xf3a360,_0x26b9f9-0x41,_0x813a77-0x10e);}function _0x178e0a(_0x30c5b5,_0x39fef7,_0x1a4033,_0x11eb92){return _0x5c2a4b(_0x30c5b5-0x7a,_0x39fef7,_0x1a4033-0x2ec,_0x11eb92-0x165);}if(_0x5b77de[_0x178e0a(0x4fc,0x506,0x54c,0x59f)](_0x5b77de[_0x294a12(0x20,0x80,0x30,0x40)],'WsEAm')){_0x4cc84b[_0x294a12(0x34,0x6e,0x64,0x35)](_0x294a12(0xd7,0xe5,0xcc,0xb7)+'\x20翻译提示词标签失败'+':',_0x147517);throw _0x367a16;}else eventSource[_0x178e0a(0x51c,0x50e,0x4cb,0x517)+'ener'](eventNames[_0x294a12(0xce,0x6b,0x89,0x97)+_0x294a12(0x97,0x6c,0xa5,0xa9)+'PROMPT_RES'+'PONSE'],_0x4907fe),_0x5b77de['kKTbI'](_0x2110a0,new Error('获取翻译提示词超时'));},-0x8*0x17f+-0x2*-0x1799+-0x3d6*-0x1);}});}export function LLM_TRANSLATION(_0x3f7654,{timeoutMs:timeoutMs=0x1b279+-0x193a3*0x1+-0x65c5*-0x2}={}){function _0x23b731(_0x52c880,_0x53a708,_0x5c823e,_0x3c4a19){return _0x170a(_0x3c4a19-0x115,_0x5c823e);}function _0x482f80(_0x3cbf66,_0x42b2b7,_0x4883f9,_0x136694){return _0x170a(_0x42b2b7-0x32,_0x136694);}const _0xc13c19={'BwAFe':'(((.+)+)+)'+'+$','PurWm':_0x482f80(0x2c6,0x272,0x23f,0x2ad),'suPch':function(_0x26b665){return _0x26b665();},'JrybY':function(_0x16eceb,_0x2b4f7d){return _0x16eceb(_0x2b4f7d);},'NLlOg':_0x23b731(0x3ac,0x3bf,0x32e,0x378),'HLolt':function(_0x40c4e3,_0x1464ab){return _0x40c4e3!==_0x1464ab;},'VUKAO':_0x23b731(0x378,0x30c,0x2f9,0x350),'qqkgx':_0x23b731(0x34c,0x2c1,0x30d,0x316),'GBpjU':'drJoG','frXAZ':_0x23b731(0x312,0x33b,0x339,0x32b),'rSqvY':function(_0x2d0757){return _0x2d0757();}};return new Promise((_0x19a6ba,_0x5d891e)=>{const _0x20030a={'rcJUl':_0xc13c19[_0xbb013(0x5b5,0x5be,0x604,0x60b)],'pbDyA':function(_0x423b7e,_0x56e1ef){return _0x423b7e(_0x56e1ef);},'HbmUs':function(_0x55f9d9,_0x524f6a){function _0x35acb8(_0xd5b74b,_0x3e2af3,_0xec4eb2,_0x39328c){return _0xbb013(_0xd5b74b- -0x3b7,_0x3e2af3-0x10,_0xec4eb2-0x31,_0x3e2af3);}return _0xc13c19[_0x35acb8(0x23c,0x245,0x28d,0x21c)](_0x55f9d9,_0x524f6a);},'Rsmsu':function(_0x453146){function _0x29443c(_0x1a66d7,_0x13821d,_0x1ff261,_0x153c3e){return _0xbb013(_0x153c3e- -0x63a,_0x13821d-0xb2,_0x1ff261-0x10a,_0x1ff261);}return _0xc13c19[_0x29443c(-0x81,-0x96,-0xa5,-0x9a)](_0x453146);},'DLyEN':function(_0x2d3d5a,_0x4dd4fa){return _0x2d3d5a===_0x4dd4fa;},'ZZPqK':_0xc13c19[_0x1cb23d(0x2d4,0x319,0x322,0x2f2)],'aOxFi':_0xc13c19[_0x1cb23d(0x2d2,0x2f9,0x2b5,0x2c1)],'RSSdP':function(_0x5073ee,_0x4bfb97){return _0x5073ee!==_0x4bfb97;},'HWvTB':_0xbb013(0x61c,0x605,0x64e,0x5fd),'WqgOL':_0xc13c19['GBpjU'],'omrMP':_0xc13c19['frXAZ']},_0x1b3bbd=_0xc13c19['rSqvY'](generateRequestId);console[_0xbb013(0x59d,0x554,0x583,0x5e9)]('st-chatu8:'+'\x20请求翻译\x20LLM\x20'+'(ID:\x20'+_0x1b3bbd+')');let _0x506d33=null;const _0x471435=()=>{function _0x55b828(_0x427476,_0x53d62f,_0x4f232e,_0x3ce389){return _0x1cb23d(_0x427476-0x1ed,_0x4f232e- -0x3d6,_0x4f232e-0x196,_0x427476);}eventSource['removeList'+_0x2ddde8(0x3d6,0x3ed,0x441,0x3a0)](eventNames['LLM_TRANSL'+_0x55b828(-0x57,-0x67,-0x59,-0x57)+'ONSE'],_0x140f79);function _0x2ddde8(_0x5bb89a,_0x3ffc85,_0x13038f,_0x196156){return _0x1cb23d(_0x5bb89a-0x5,_0x3ffc85-0xf5,_0x13038f-0x91,_0x13038f);}if(_0x506d33)clearTimeout(_0x506d33);};function _0xbb013(_0x300ea9,_0x3fd03d,_0x45cde2,_0x302611){return _0x23b731(_0x300ea9-0xb2,_0x3fd03d-0x1ea,_0x302611,_0x300ea9-0x281);}const _0x140f79=_0xf8d0b2=>{function _0x5a7935(_0x56c21c,_0x1752d2,_0x45103c,_0x2fa739){return _0xbb013(_0x1752d2- -0x222,_0x1752d2-0x1f,_0x45103c-0x124,_0x2fa739);}if(_0x20030a['HbmUs'](_0xf8d0b2['id'],_0x1b3bbd))return;_0x20030a[_0x156e13(0x5ae,0x5b3,0x59b,0x5ad)](_0x471435);function _0x156e13(_0x3cdd0f,_0x4e92b0,_0x19d0a4,_0x351079){return _0x1cb23d(_0x3cdd0f-0x1f3,_0x351079-0x2ce,_0x19d0a4-0xff,_0x3cdd0f);}console[_0x5a7935(0x3d4,0x37b,0x38f,0x363)](_0x156e13(0x5fb,0x5e3,0x614,0x637)+_0x5a7935(0x404,0x3dd,0x3ab,0x3d5)+_0x156e13(0x584,0x571,0x588,0x5c1)+'\x20'+_0x1b3bbd+'):',_0xf8d0b2);if(_0xf8d0b2[_0x156e13(0x5cf,0x5ac,0x5e8,0x5c5)]){if(_0x20030a[_0x156e13(0x612,0x5fa,0x5ae,0x5dc)](_0x20030a['ZZPqK'],_0x20030a['aOxFi']))return[];else _0x20030a[_0x156e13(0x62e,0x62d,0x621,0x614)](_0x19a6ba,_0xf8d0b2[_0x156e13(0x63a,0x68c,0x614,0x657)]);}else{if(_0x20030a[_0x156e13(0x5e2,0x5fe,0x5f3,0x5e2)](_0x20030a[_0x5a7935(0x3e8,0x3cf,0x393,0x37a)],_0x5a7935(0x3f5,0x3ed,0x3b1,0x3eb))){if(_0xf8d0b2[_0x5a7935(0x3a1,0x360,0x347,0x36e)]&&_0xf8d0b2['error'][_0x5a7935(0x3a0,0x3e6,0x41b,0x43f)]==='AbortError'){if(_0x20030a[_0x5a7935(0x406,0x3cc,0x384,0x3de)]!==_0x20030a[_0x5a7935(0x3fb,0x3cc,0x3ee,0x3b1)])_0x3abd04[_0x5ae8b1[_0x5a7935(0x3e5,0x3a3,0x35f,0x37f)+'e']()]=_0x16e163;else{const _0x1eabd2=new Error(_0xf8d0b2[_0x156e13(0x5fa,0x5d4,0x579,0x5b5)]['message']);_0x1eabd2['name']=_0x20030a['rcJUl'],_0x20030a[_0x156e13(0x5eb,0x62a,0x652,0x614)](_0x5d891e,_0x1eabd2);}}else{if(_0x20030a[_0x156e13(0x5dc,0x662,0x63d,0x611)]!=='UnjKE')_0x5d891e(new Error(_0xf8d0b2[_0x5a7935(0x446,0x402,0x44a,0x3b0)]));else{const _0x34e734=new _0x50c70f(_0x57811d['error'][_0x156e13(0x61f,0x68f,0x690,0x65d)]);_0x34e734[_0x5a7935(0x411,0x3e6,0x3ac,0x414)]=_0x20030a[_0x156e13(0x640,0x59c,0x5ad,0x5ed)],_0x20030a[_0x5a7935(0x3ac,0x3bf,0x3d5,0x3ac)](_0x4f5d77,_0x34e734);}}}else return'';}};eventSource['on'](eventNames['LLM_TRANSL'+_0x1cb23d(0x39d,0x37d,0x3c4,0x3a5)+_0xbb013(0x5d4,0x5ff,0x5ac,0x591)],_0x140f79);const _0x1290d9={};_0x1290d9[_0x1cb23d(0x2b2,0x2e4,0x2e1,0x2a5)]=_0x3f7654,_0x1290d9['id']=_0x1b3bbd;function _0x1cb23d(_0x37abc1,_0x467791,_0x181e6b,_0x21e310){return _0x23b731(_0x37abc1-0x1bd,_0x467791-0x74,_0x21e310,_0x467791- -0x1a);}eventSource[_0x1cb23d(0x311,0x2eb,0x298,0x33d)](eventNames[_0x1cb23d(0x3a0,0x349,0x395,0x2f9)+'ATION_REQU'+_0x1cb23d(0x37c,0x373,0x391,0x3aa)],_0x1290d9),_0x506d33=setTimeout(()=>{const _0x5d1552={};_0x5d1552[_0x276850(0x17d,0x1a8,0x1c8,0x151)]=_0xc13c19[_0x486b46(-0x1b,-0x65,-0x88,-0x58)];function _0x486b46(_0x45c49d,_0x5de6dc,_0xca7041,_0x20e621){return _0xbb013(_0x5de6dc- -0x668,_0x5de6dc-0x2c,_0xca7041-0x77,_0x20e621);}function _0x276850(_0x3611b7,_0x46e717,_0x16ebff,_0x4075e9){return _0x1cb23d(_0x3611b7-0xd,_0x46e717- -0x189,_0x16ebff-0x6a,_0x3611b7);}const _0x329957=_0x5d1552;if(_0xc13c19[_0x276850(0x1ad,0x203,0x1cc,0x22b)]!==_0xc13c19[_0x486b46(-0x85,-0x41,-0x53,-0x74)])return _0x32be69['toString']()[_0x486b46(-0x90,-0xa1,-0x8c,-0x4b)](BxzBov['kWwgW'])[_0x276850(0x21a,0x1dc,0x1ab,0x1f5)]()[_0x486b46(-0x10e,-0xc2,-0x77,-0xcc)+'r'](_0x271ec8)['search'](BxzBov[_0x276850(0x1fd,0x1a8,0x1c8,0x17a)]);else _0xc13c19['suPch'](_0x471435),_0xc13c19[_0x276850(0x1bf,0x1ce,0x1ce,0x1b7)](_0x5d891e,new Error('翻译\x20LLM\x20执行超'+'时（'+timeoutMs+_0x486b46(-0x70,-0x52,-0x8d,-0x57)));},timeoutMs);});}export async function callTranslation(_0x22d209){function _0x3976bb(_0x296ff5,_0x5b1338,_0x2b8f84,_0x462f1b){return _0x170a(_0x462f1b- -0x36e,_0x296ff5);}function _0x13852a(_0x465f9b,_0xa3c0fc,_0x545402,_0xd2e127){return _0x170a(_0x545402- -0x23e,_0x465f9b);}const _0x34fae0={'kQefT':_0x3976bb(-0xbf,-0x104,-0x162,-0x10b),'Wlgzy':function(_0xecf7f6,_0x51239b){return _0xecf7f6(_0x51239b);},'AklAm':function(_0x1f9424,_0x36d346){return _0x1f9424+_0x36d346;},'EQEar':function(_0x1811de,_0x5e497a){return _0x1811de!==_0x5e497a;},'SWfzT':_0x13852a(0x25,-0x34,0x3,0x42),'jxqBG':_0x13852a(0x23,-0x18,0x3f,0xb),'OykWc':function(_0x1c57ba,_0x34976e,_0x4dc59e){return _0x1c57ba(_0x34976e,_0x4dc59e);},'blSOS':_0x3976bb(-0x101,-0xbc,-0x149,-0x102)+'n','emQzs':function(_0xfeaea1,_0x1f5bd6){return _0xfeaea1||_0x1f5bd6;},'BQwMP':function(_0x20c6a0,_0x13cfc8){return _0x20c6a0(_0x13cfc8);},'ikqkw':function(_0x33c3b8,_0x2682d2){return _0x33c3b8||_0x2682d2;},'lesTn':_0x3976bb(-0x113,-0x10a,-0x10f,-0x117),'FIuHC':function(_0x13725b,_0x2d1eae){return _0x13725b(_0x2d1eae);}};try{if(_0x34fae0[_0x13852a(0x39,-0x19,0xb,0x4a)](_0x34fae0[_0x13852a(-0x3d,-0x62,-0x58,-0xa2)],_0x34fae0[_0x13852a(-0x6,-0x25,0x6,0x7)])){let _0x3a9a5d=_0x34fae0['OykWc'](buildPromptForRequestType,_0x34fae0[_0x3976bb(-0x10b,-0x138,-0x11e,-0x103)],_0x34fae0['emQzs'](_0x22d209,''));_0x3a9a5d=_0x34fae0['BQwMP'](mergeAdjacentMessages,_0x3a9a5d);const _0x3c58ad=[..._0x3a9a5d,{'role':_0x3976bb(-0x16b,-0xcd,-0x174,-0x121),'content':_0x34fae0[_0x13852a(-0xb,-0x21,-0x13,0x0)](_0x22d209,'')}];_0x34fae0[_0x3976bb(-0x127,-0x176,-0x188,-0x140)](updateCombinedPrompt,_0x3c58ad);const _0x1e87e8=await _0x34fae0['Wlgzy'](LLM_TRANSLATION,_0x3c58ad);return _0x1e87e8;}else{if(_0x442706[_0x3976bb(-0x135,-0x185,-0x1d2,-0x182)]&&_0x2afb64[_0x3976bb(-0x14e,-0x197,-0x12b,-0x182)]['name']===_0x34fae0[_0x13852a(0x18,0x4d,0x40,0x3b)]){const _0x2b74fe=new _0x38e0f6(_0x274c17['error']['message']);_0x2b74fe[_0x3976bb(-0x112,-0x14f,-0x13f,-0xfc)]=_0x34fae0[_0x3976bb(-0xe1,-0x134,-0x127,-0xf0)],_0x32df25(_0x2b74fe);}else _0x34fae0['Wlgzy'](_0x50be13,new _0x573287(_0x446975[_0x13852a(0x47,-0xa,0x50,0x83)]));}}catch(_0x404823){if(_0x34fae0['lesTn']===_0x34fae0[_0x13852a(0x4e,0x64,0x4b,0x70)]){_0x34fae0[_0x13852a(0x13,0x1e,-0x3a,-0x54)](addLog,_0x13852a(0x73,0x8a,0x31,0x24)+_0x404823[_0x3976bb(-0xdf,-0x85,-0x81,-0xda)]),console[_0x13852a(-0x98,-0x4e,-0x52,-0x7e)](_0x3976bb(-0x138,-0x12b,-0x105,-0xf2),_0x404823);throw _0x404823;}else{if(_0xffd16d&&_0x5cb578[_0x13852a(0x1c,0x30,-0x4,-0x5c)])return _0x2f4acc['randomUUID']();return _0x34fae0['AklAm'](_0x3aa1ef[_0x3976bb(-0x18f,-0x18b,-0x17e,-0x17b)]()[_0x3976bb(-0xb1,-0x138,-0x11d,-0x104)](-0x1419+-0x2*-0x822+0x3f9),_0x2faafd[_0x3976bb(-0x12d,-0xf2,-0xd2,-0xf8)]()['toString'](0x166d*-0x1+0xd96+0x1*0x8fb)['substring'](-0x24f8+0x221*0xc+0xb6e));}}}let isAiInitialized=![];export function initAiSettings(_0x59d6b6){function _0x413833(_0x318dbf,_0x2e5a36,_0x51130c,_0x5b7355){return _0x170a(_0x318dbf- -0x243,_0x2e5a36);}const _0x3868ad={};_0x3868ad['CSasx']='st-chatu8:'+_0xafb3d9(-0xda,-0xab,-0xd4,-0x95)+_0x413833(-0x10,-0x54,-0x47,0x1a),_0x3868ad[_0x413833(0x0,0xe,-0x15,0x29)]=_0x413833(-0x3b,-0x50,-0x11,-0x14),_0x3868ad[_0x413833(-0x1,-0x4d,-0x33,0x12)]=_0xafb3d9(-0xa2,-0xbf,-0xd3,-0xcc);const _0x49bab6=_0x3868ad;function _0xafb3d9(_0x568c07,_0x40e238,_0x1d007a,_0x254bff){return _0x170a(_0x254bff- -0x2e1,_0x40e238);}!isAiInitialized&&(_0x49bab6[_0x413833(0x0,0x29,0x1c,0x44)]!==_0x49bab6[_0x413833(-0x1,-0x49,-0x1d,-0x18)]?(console[_0xafb3d9(-0x127,-0xed,-0xd4,-0xda)]('st-chatu8:'+_0x413833(-0x16,-0x28,-0xe,-0x55)+_0x413833(-0x28,-0x4b,-0x39,-0x2a)),isAiInitialized=!![]):_0x20b291[_0xafb3d9(-0x83,-0x8b,-0xac,-0x5d)](_0x49bab6[_0x413833(0x7,0x1f,0x1c,-0x50)],_0x411f7d['message']));}