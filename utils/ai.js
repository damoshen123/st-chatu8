(function(_0xbf5d71,_0x758556){const _0x5b53af=_0xbf5d71();function _0x3cf0e8(_0x51a5d8,_0x537a6d,_0x1f6d52,_0x36416c){return _0x3126(_0x51a5d8- -0xad,_0x537a6d);}function _0x5a2ade(_0x5b7100,_0x428d6e,_0x29e2cc,_0x1ecb02){return _0x3126(_0x1ecb02-0x2b9,_0x428d6e);}while(!![]){try{const _0xc158f8=-parseInt(_0x3cf0e8(0xe4,0xce,0x13d,0x96))/(-0x983+-0x9a4+0x1328)*(parseInt(_0x3cf0e8(0xdf,0xcf,0x129,0xa8))/(0x2408+-0x1*-0x529+0x1*-0x292f))+-parseInt(_0x3cf0e8(0xd4,0xe3,0x127,0xa9))/(-0x1b1b+-0xc6*0x8+0x62*0x57)+parseInt(_0x3cf0e8(0xe9,0x12c,0x11a,0xc6))/(-0x7*-0x377+0xb5*0x1d+-0xa6*0x45)*(parseInt(_0x5a2ade(0x430,0x437,0x496,0x467))/(-0x1e*-0x38+-0x1b72+0x1*0x14e7))+-parseInt(_0x3cf0e8(0xaf,0x64,0x60,0xbd))/(-0x43*-0x52+-0x3b*0x92+0x2*0x61b)+-parseInt(_0x5a2ade(0x3ca,0x3e3,0x480,0x426))/(0x1*-0xb8d+0x86*-0xd+0x1262)+-parseInt(_0x5a2ade(0x453,0x4aa,0x45f,0x4a1))/(-0x7fd*-0x4+0x255*0xb+-0x3993*0x1)*(parseInt(_0x3cf0e8(0xbe,0xb0,0xc8,0x6b))/(-0x2b*0x5d+-0x7e1+-0x1789*-0x1))+-parseInt(_0x3cf0e8(0xc4,0x106,0xfb,0x95))/(0xf*0x1d6+0x1283+-0x1*0x2e03)*(-parseInt(_0x5a2ade(0x421,0x471,0x47e,0x428))/(0x1*-0x1b47+0xd0+0x1a82));if(_0xc158f8===_0x758556)break;else _0x5b53af['push'](_0x5b53af['shift']());}catch(_0x18befe){_0x5b53af['push'](_0x5b53af['shift']());}}}(_0x3c82,0x1ac*0x1a6+0xf3c9+-0x54e9));const _0x4af158=(function(){const _0x222ce6={};function _0x586009(_0x36eec0,_0x343754,_0x5460b2,_0x4457da){return _0x3126(_0x4457da-0x334,_0x36eec0);}function _0x478b45(_0x4101c4,_0x1b4960,_0x3dcbd0,_0x4a5e49){return _0x3126(_0x4101c4-0x2be,_0x4a5e49);}_0x222ce6['VbCPp']=_0x586009(0x503,0x4a0,0x531,0x4f9),_0x222ce6[_0x478b45(0x43e,0x3fc,0x473,0x3fc)]=function(_0x85e0bf,_0x1f931c){return _0x85e0bf!==_0x1f931c;},_0x222ce6['kroua']=_0x586009(0x4e4,0x4fe,0x52f,0x4dc);const _0x245df8=_0x222ce6;let _0x289a55=!![];return function(_0x51fc1c,_0x4ba589){function _0x33d4bb(_0x22f071,_0x54a5b8,_0x48d876,_0x2e9748){return _0x586009(_0x54a5b8,_0x54a5b8-0x5a,_0x48d876-0x40,_0x2e9748- -0x59d);}function _0x3d4b2a(_0xd2c956,_0x23e040,_0x5beb50,_0x2cb171){return _0x478b45(_0xd2c956- -0x1e9,_0x23e040-0x168,_0x5beb50-0x91,_0x5beb50);}if(_0x245df8['bntbh'](_0x3d4b2a(0x27d,0x238,0x225,0x2d0),_0x245df8[_0x3d4b2a(0x274,0x26c,0x250,0x249)]))_0xb86a55[_0x3d4b2a(0x262,0x24a,0x281,0x255)+'ener'](_0x3b96f0['LLM_TRANSL'+'ATION_GET_'+_0x3d4b2a(0x260,0x24d,0x280,0x2a7)+'PONSE'],_0x31246e),_0x57c5ad(new _0x36c9c2(_0x245df8['VbCPp']));else{const _0x25d6e1=_0x289a55?function(){function _0x3132b3(_0x1b4dc2,_0x1e4bb8,_0x5ae8b1,_0x1bbf7f){return _0x3d4b2a(_0x1b4dc2- -0x1af,_0x1e4bb8-0x195,_0x5ae8b1,_0x1bbf7f-0x29);}if(_0x4ba589){const _0x2df74a=_0x4ba589[_0x3132b3(0xcd,0xe5,0xb5,0x10f)](_0x51fc1c,arguments);return _0x4ba589=null,_0x2df74a;}}:function(){};return _0x289a55=![],_0x25d6e1;}};}()),_0x41f21f=_0x4af158(this,function(){const _0x1237d9={};function _0x11563d(_0x31b49e,_0x157794,_0x5629ac,_0x13512d){return _0x3126(_0x31b49e-0xdd,_0x5629ac);}_0x1237d9[_0x24b4c8(-0x233,-0x1f5,-0x201,-0x205)]=_0x11563d(0x230,0x203,0x233,0x1dd)+'+$';function _0x24b4c8(_0x38e9a6,_0x46ea41,_0x3247b8,_0x144545){return _0x3126(_0x46ea41- -0x36b,_0x3247b8);}const _0x4531dd=_0x1237d9;return _0x41f21f['toString']()[_0x11563d(0x29e,0x2a0,0x2f4,0x286)](_0x24b4c8(-0x1e6,-0x218,-0x1e1,-0x25c)+'+$')[_0x24b4c8(-0x192,-0x1ae,-0x192,-0x1d3)]()[_0x11563d(0x259,0x220,0x2a6,0x21e)+'r'](_0x41f21f)[_0x11563d(0x29e,0x258,0x26e,0x2fa)](_0x4531dd['gOGsv']);});_0x41f21f();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';function _0x3126(_0x195c05,_0x1fbd5e){_0x195c05=_0x195c05-(-0x7b0+0xbd*-0x2b+0x1*0x28a7);const _0x47762e=_0x3c82();let _0x4c8d86=_0x47762e[_0x195c05];if(_0x3126['BjuLmj']===undefined){var _0x165822=function(_0x10e958){const _0x10afeb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x25fe63='',_0xcc2f4a='',_0x4e0d76=_0x25fe63+_0x165822;for(let _0x2ebb76=0x4*-0x5e9+-0x26*0x2+0x10*0x17f,_0x1608ea,_0x198ae8,_0x9d5f4d=-0x26b4+0x12d3+-0x13e1*-0x1;_0x198ae8=_0x10e958['charAt'](_0x9d5f4d++);~_0x198ae8&&(_0x1608ea=_0x2ebb76%(0x1*0x1fde+-0x24a1*-0x1+-0x447b*0x1)?_0x1608ea*(0x5*-0x351+-0x12bb*0x2+0x3*0x1219)+_0x198ae8:_0x198ae8,_0x2ebb76++%(-0x2188+0x23f*-0x1+0x23cb*0x1))?_0x25fe63+=_0x4e0d76['charCodeAt'](_0x9d5f4d+(-0x1865+-0x1*-0x212b+-0x8bc))-(-0x390+0x8*0x3f5+-0x1c0e)!==0xa6e*-0x2+0x1*0x9bd+0xb1f?String['fromCharCode'](-0x7*-0x251+0xd82+-0x1cba&_0x1608ea>>(-(0x1532+-0x21b2*-0x1+-0x32*0x119)*_0x2ebb76&-0x3d*-0x2f+-0x23f0+0x18c3)):_0x2ebb76:0x2496+-0x869*-0x4+0x463a*-0x1){_0x198ae8=_0x10afeb['indexOf'](_0x198ae8);}for(let _0x54f616=0x723*0x5+0x316*-0xa+0x5f*-0xd,_0x5f3382=_0x25fe63['length'];_0x54f616<_0x5f3382;_0x54f616++){_0xcc2f4a+='%'+('00'+_0x25fe63['charCodeAt'](_0x54f616)['toString'](0x19fb+-0x7cf+-0x121c))['slice'](-(0x1*-0x1d53+0x20b*-0x2+-0x91*-0x3b));}return decodeURIComponent(_0xcc2f4a);};_0x3126['sfwNtT']=_0x165822,_0x3126['CSnqtv']={},_0x3126['BjuLmj']=!![];}const _0x54ebb2=_0x47762e[-0x2*0x458+-0x64b+0x5*0x2ff],_0x28695c=_0x195c05+_0x54ebb2,_0x1ebaa1=_0x3126['CSnqtv'][_0x28695c];if(!_0x1ebaa1){const _0x225272=function(_0x4bb48d){this['uQsMRh']=_0x4bb48d,this['yxOWEr']=[-0xe7c+0x74*0x1a+0x3f*0xb,-0x22d5+-0x1*-0x147d+-0x18*-0x99,-0x2cd+0x1575+-0x6*0x31c],this['CbmpCW']=function(){return'newState';},this['DVFJhB']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['SPQLWv']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x225272['prototype']['GTawwA']=function(){const _0x534950=new RegExp(this['DVFJhB']+this['SPQLWv']),_0x3fd5a3=_0x534950['test'](this['CbmpCW']['toString']())?--this['yxOWEr'][0x79e+0x996+-0x1133]:--this['yxOWEr'][-0x1831+0x4f3*0x2+-0xe4b*-0x1];return this['JXKMLw'](_0x3fd5a3);},_0x225272['prototype']['JXKMLw']=function(_0x879129){if(!Boolean(~_0x879129))return _0x879129;return this['RhFxrD'](this['uQsMRh']);},_0x225272['prototype']['RhFxrD']=function(_0x4e6fbe){for(let _0x3851b0=0x95*0xa+0x1*-0x270e+0x213c,_0x5e36d4=this['yxOWEr']['length'];_0x3851b0<_0x5e36d4;_0x3851b0++){this['yxOWEr']['push'](Math['round'](Math['random']())),_0x5e36d4=this['yxOWEr']['length'];}return _0x4e6fbe(this['yxOWEr'][-0x1392*-0x1+-0x1611+-0x1*-0x27f]);},new _0x225272(_0x3126)['GTawwA'](),_0x4c8d86=_0x3126['sfwNtT'](_0x4c8d86),_0x3126['CSnqtv'][_0x28695c]=_0x4c8d86;}else _0x4c8d86=_0x1ebaa1;return _0x4c8d86;}import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x13b195){function _0x2d8b1a(_0x5bb6b3,_0x5d1417,_0x2a807d,_0x4e0eda){return _0x3126(_0x2a807d- -0x2f0,_0x5d1417);}function _0x52aad0(_0x39a2ef,_0x112ff3,_0x3c7784,_0x47a333){return _0x3126(_0x3c7784- -0xa0,_0x112ff3);}return SKIP_PATTERNS[_0x52aad0(0x12a,0x11d,0x137,0xf8)](_0x4d9294=>_0x4d9294[_0x52aad0(0x12b,0xc5,0x109,0x10f)](_0x13b195[_0x2d8b1a(-0x19b,-0x151,-0x17d,-0x15f)]()));}export function tagsToJsonString(_0x53e960){if(!Array[_0x339c29(0xc6,0xcd,0x11f,0x122)](_0x53e960))return'[]';function _0x339c29(_0x276dcf,_0x30ae15,_0x528250,_0x593fb1){return _0x3126(_0x30ae15- -0xea,_0x528250);}function _0x3d90d1(_0x559acb,_0x24b42f,_0x2c44cf,_0x4ec1ae){return _0x3126(_0x24b42f- -0x3e,_0x559acb);}return JSON[_0x339c29(0x78,0xb0,0x8a,0x73)](_0x53e960['filter'](_0xc5c3d1=>_0xc5c3d1&&typeof _0xc5c3d1===_0x3d90d1(0x194,0x156,0x19a,0x195)));}function _0x3c82(){const _0x3b7bd4=['CwzJrKC','t0vdwNu','wuHZreW','C3vIC3rYAw5N','BMfTzq','C29Tzq','Bg9N','CgzVqxm','B2jQzwn0','DM9AtNO','tLvfEfK','twLbzNi','s1fitve','Dg50qvC','r2vwrM4','ioIVT+AXGUE/U+IVKsbmte0G','57+76k+r5AsX6lsLoG','wg9Zt0K','BwHkEwS','wuPwsMK','t1LUtwu','BwvZC2fNzq','mJqYng1xvurKsG','wK5cEMG','zeznzxC','BM93','s3r6zKK','ANzqv3y','t05trq','q1fMs0O','uwvpsw8','wgnJs3K','teXnx1rsqu5tta','q0XhuKy','Ae5IELK','y3fwD1e','rejouLC','qvrjt05FuKvtua','ieXmtsdORR7NVA7POBxPNAi','wMzduLO','tvzwDgS','C2v0','DurqDvG','ufjptvbux1jfuq','yNbKr3m','zMLSDgvY','zMDrAei','BgvUz3rO','tfLlBum','wKTMuvy','q3n3y1i','vefQA2q','qvrjt05FuKvrvq','zw5LCG','ExPWzwO','B3jPz2LUywW','rgztrwK','kcGOlISPkYKRkq','C2nnAxG','yLbbqwC','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','C3bSAxq','B3jPz2LUywXuyq','icHjrdOG','y0DUBuq','t2LZuuS','mJe2ntC4nhPHrhL4ua','A05Su0y','BxzOBfK','5BcD6k+v5PEN5Qc85BYpoG','DxnLCG','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','CMfUzg9T','r1Dzuu0','A1rJs1q','CMvZDwX0CW','C2XPy2u','wMjPrxK','ugrmtNO','AM9PBG','thjsDwe','ntq5AMnKDND2','quLTChq','mtuYodm3m0TqCuD4sq','yK96q2i','mtf0zNvLsxC','sLPAAfm','mti1odu4otbby2ntr2e','qvrjt05Fr0vuxW','DhjPBq','r0z6tgK','Evf4yw8','z09hC3y','wxrsy0K','rvnHyNO','A3D2Dva','yMPRC2y','57+76k+rieXmtsdMIAFOOyZOTOu','y29UC3rYDwn0BW','tLLurNy','ugH3yK4','zxjYB3i','yM50yMG','mti0nJm4oxvPBMPRtW','C2TPChbLza','zMTWwui','DhjHBNnSyxrPBW','vuvtva','B2Hpqva','wNnXwKu','Afjzqvm','BKXkz3K','CMvZDwX0','ufjptvbux1jfuW','ntm1mZu0zvPWsxL5','CMvTB3zLtgLZDa','CgfYC2u','BwfW','Aw5KzxHpzG','mwnZDLHkEq','Bw5Iq2C','CMvWBgfJzq','C3rYAw5N','zgLZCgXHEvrLEa','ne9kALboDa','rLfpvNy','BxpVViK','r2LJEfi','C3rYAw5NAwz5','C2TPCa','iow3SUAuTUwiSoE/U+IVKsbmte0','ChjVBxb0','zNDQsKi','A3jVDwe','ChvZAa','t29Nthe','Bwf0y2G','vvzdwfK','ue9ou0u','vMT5B3m','zevrAw0','yxbWBhK','veHsELu','DgvZDa','wKr4yvG','t3nPEwm','y3nnDhy','uur6zfC','mtiXodeYnu1XEezesW','Dg9mB3DLCKnHCW','yu1SsKO','keLeoIa','EKjUrLC','qwjVCNrfCNjVCG','zw50CMLLCW','C3qTy2HHDhu4oG','EKvuDMi','AxnbCNjHEq','iePtt07OP6pMNPdLPlhOTkxVViW','57+76k+r5AsX6lsLoIa','tfPKBu8','CMfUzg9Tvvvjra','zw1PDa','Dg9tDhjPBMC','Cu1dCfm','t29wD24','BgHmv0K','C2vHCMnO','vgfwDfK','sLvQCgC','yxPyzha','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','y2XLyw5Lza','z1DyyvO','BNPcwvO','zfrQChm','ioAjP+IHJoE7K+AENcaOsuq6','D2j4txK','C3vJy2vZCW','iefjioIUVUE9RUw3SUE7N+s4GowiSa','sePYBuG','DeDIwxK','v0fID2e','r2r2ufC'];_0x3c82=function(){return _0x3b7bd4;};return _0x3c82();}export function preprocessPromptForTranslation(_0x3cee22){function _0x3d507f(_0x4c09b4,_0x1f39c7,_0x107ac1,_0x5f42c9){return _0x3126(_0x107ac1-0xa1,_0x1f39c7);}const _0x5810fd={'CQfKJ':_0x3d507f(0x204,0x1ec,0x1f4,0x1db)+'+$','EtIxA':_0x3d507f(0x1fa,0x28d,0x254,0x22a),'hRYAS':function(_0x3c1a32,_0x5cbfad){return _0x3c1a32===_0x5cbfad;},'ESabz':_0x3f7384(0x2f7,0x29f,0x2d1,0x29a),'fkpYB':_0x3d507f(0x1b7,0x1da,0x1eb,0x1f2),'HJrmH':function(_0x3e3982,_0x5653ea){return _0x3e3982===_0x5653ea;},'ftDoz':_0x3f7384(0x35c,0x32c,0x35b,0x398),'SsHxW':function(_0x2b5978,_0x1630e3){return _0x2b5978===_0x1630e3;},'JUjpg':_0x3d507f(0x20e,0x230,0x227,0x20e),'YHsDL':function(_0x4c7c42,_0x4b5409){return _0x4c7c42(_0x4b5409);},'OoVwn':function(_0x5a453e,_0x58e87f){return _0x5a453e!==_0x58e87f;},'WkBXi':_0x3d507f(0x27c,0x1f9,0x235,0x1f0),'DBNRW':'qtorf','fwjJB':function(_0x107e79,_0x12f6ae){return _0x107e79(_0x12f6ae);},'kTcKT':'TtsXM'};if(!_0x3cee22||_0x5810fd[_0x3d507f(0x20e,0x22b,0x260,0x2a7)](typeof _0x3cee22,_0x5810fd['WkBXi']))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0x542cc4=_0x37c358=>{function _0x34f861(_0x2e34aa,_0x5346ad,_0x2c4ee5,_0x22e897){return _0x3d507f(_0x2e34aa-0x2a,_0x2e34aa,_0x22e897-0xa9,_0x22e897-0x107);}function _0x26855b(_0x1b578c,_0x707566,_0x45cd40,_0x45778c){return _0x3d507f(_0x1b578c-0xa5,_0x707566,_0x1b578c-0x11f,_0x45778c-0xa0);}if(_0x5810fd[_0x34f861(0x314,0x323,0x311,0x2d2)](_0x5810fd[_0x34f861(0x316,0x2e4,0x2e4,0x2c2)],_0x5810fd[_0x26855b(0x343,0x31b,0x39c,0x316)]))return _0xb4ce28[_0x26855b(0x37d,0x35f,0x378,0x35b)]()[_0x26855b(0x381,0x34e,0x37a,0x357)](gczfqd[_0x26855b(0x3af,0x39d,0x3d2,0x3a5)])[_0x26855b(0x37d,0x3c9,0x326,0x382)]()[_0x26855b(0x33c,0x303,0x33a,0x2f7)+'r'](_0x163ac7)[_0x34f861(0x2e7,0x2b9,0x2c9,0x30b)](gczfqd[_0x26855b(0x3af,0x3a9,0x3c9,0x39b)]);else{const _0x3afe52=[];let _0x4a3d51='',_0x45b6b8=![];for(let _0x4b16e8=-0x1*0x2177+0xcef+0x1488;_0x4b16e8<_0x37c358[_0x34f861(0x2e4,0x2cb,0x25e,0x293)];_0x4b16e8++){const _0x2721ab=_0x37c358[_0x4b16e8];if(_0x5810fd[_0x26855b(0x348,0x2fe,0x31e,0x2f5)](_0x2721ab,'$'))_0x45b6b8=!_0x45b6b8,_0x4a3d51+=_0x2721ab;else{if((_0x5810fd[_0x34f861(0x31a,0x364,0x34c,0x318)](_0x2721ab,',')||_0x2721ab==='，')&&!_0x45b6b8){if(_0x34f861(0x29e,0x268,0x2d2,0x286)===_0x5810fd['ftDoz']){const _0x5ed4e4={};return _0x5ed4e4[_0x26855b(0x311,0x352,0x315,0x2ed)]=_0x37ef19,_0x5ed4e4['translatio'+'n']='',_0x5ed4e4[_0x34f861(0x2ba,0x31a,0x304,0x310)]=_0x38bfc3,_0x5ed4e4['skipped']=!![],_0x5ed4e4;}else{const _0x23d329=_0x4a3d51[_0x34f861(0x2ef,0x28a,0x2d0,0x2bd)]();if(_0x23d329)_0x3afe52['push'](_0x23d329);_0x4a3d51='';}}else{if(_0x5810fd['SsHxW'](_0x5810fd[_0x34f861(0x2f0,0x354,0x2f8,0x30d)],_0x34f861(0x2e4,0x28d,0x284,0x2d0)))_0x4a3d51+=_0x2721ab;else{const _0x322c82=new _0x380f89(_0x3bd5f0[_0x26855b(0x33f,0x349,0x354,0x2e3)][_0x34f861(0x346,0x2e5,0x348,0x331)]);_0x322c82[_0x26855b(0x396,0x397,0x3b8,0x3dc)]=_0x5810fd['EtIxA'],_0x3d3486(_0x322c82);}}}}if(_0x4a3d51[_0x34f861(0x2a7,0x289,0x271,0x2bd)]())_0x3afe52[_0x34f861(0x2ae,0x321,0x2b7,0x2ea)](_0x4a3d51[_0x34f861(0x2ba,0x2f5,0x2fd,0x2bd)]());return _0x3afe52;}};function _0x3f7384(_0xbcd664,_0x2e69b6,_0x4103ee,_0x206c6d){return _0x3126(_0x4103ee-0x177,_0x206c6d);}const _0x20ef6d=_0x5810fd[_0x3d507f(0x2a3,0x260,0x275,0x2a9)](_0x542cc4,_0x3cee22),_0x5bcfc5=[],_0x3eb22e=[],_0xb9ce44=new Map();for(const _0x540c9d of _0x20ef6d){if(_0x5810fd[_0x3f7384(0x31e,0x342,0x336,0x34e)](_0x5810fd[_0x3d507f(0x21c,0x189,0x1df,0x1d9)],_0x5810fd[_0x3f7384(0x2e0,0x285,0x2b5,0x29d)])){const _0x4cbfb7=_0x231c5a[-0x3*0x685+0x24f3+-0x1163]||'',_0x2cea2d=(_0x1f1cac[0x11c2+0x36b*0xa+0x22*-0x187]||'')[_0x3f7384(0x2e8,0x2fb,0x2ea,0x297)](),_0x1b1931=_0x402857[0x4*0x3ae+-0x2012+0x115d]||'',_0x62889a=_0x234eec[0x1ee7+0x1afa+-0x39dd]||'',_0x2a15fa={'original':_0x38fc2f,'cleaned':_0x2cea2d,'prefix':_0x4cbfb7,'suffix':_0x1b1931,'weight':_0x62889a,'skip':_0x5810fd[_0x3f7384(0x36b,0x35f,0x34b,0x303)](_0x3b6382,_0x2f8571)||_0x7c0767(_0x2cea2d)};_0x9249e5[_0x3d507f(0x1ff,0x22f,0x241,0x241)](_0x2a15fa),!_0x2a15fa[_0x3f7384(0x316,0x302,0x312,0x356)]&&_0x2cea2d&&(_0x16990b['push'](_0x2cea2d),_0x39536c[_0x3f7384(0x301,0x267,0x2ba,0x288)](_0x2cea2d[_0x3f7384(0x31a,0x32b,0x326,0x35b)+'e'](),_0x2a15fa));}else{const _0x2d7a8c=_0x540c9d[_0x3d507f(0x210,0x262,0x243,0x1ea)](SD_SYMBOL_PATTERN);if(_0x2d7a8c){const _0x4b9c8e=_0x2d7a8c[-0x937+-0x11dd*0x2+0x2cf2]||'',_0x42ee25=(_0x2d7a8c[-0x115*-0x2+-0xa3*-0x2f+-0x2015]||'')[_0x3f7384(0x2ca,0x318,0x2ea,0x296)](),_0xa45a04=_0x2d7a8c[-0x41*0x13+0x2095+-0x1bbf]||'',_0x1e6436=_0x2d7a8c[-0x21f1+-0x6d6+-0x3b*-0xb1]||'',_0x447300={'original':_0x540c9d,'cleaned':_0x42ee25,'prefix':_0x4b9c8e,'suffix':_0xa45a04,'weight':_0x1e6436,'skip':shouldSkipTranslation(_0x540c9d)||_0x5810fd[_0x3f7384(0x2f9,0x2ee,0x315,0x2ef)](shouldSkipTranslation,_0x42ee25)};_0x5bcfc5[_0x3f7384(0x30c,0x2c7,0x317,0x2e9)](_0x447300),!_0x447300[_0x3d507f(0x23c,0x253,0x23c,0x23c)]&&_0x42ee25&&(_0x3eb22e[_0x3f7384(0x350,0x321,0x317,0x2eb)](_0x42ee25),_0xb9ce44[_0x3f7384(0x25f,0x2c6,0x2ba,0x2ad)](_0x42ee25[_0x3d507f(0x20a,0x21f,0x250,0x212)+'e'](),_0x447300));}else{if(_0x5810fd['kTcKT']===_0x5810fd[_0x3d507f(0x229,0x1c1,0x205,0x1a9)]){const _0x40bd1f={'original':_0x540c9d,'cleaned':_0x540c9d,'prefix':'','suffix':'','weight':'','skip':_0x5810fd[_0x3f7384(0x2e3,0x371,0x315,0x33c)](shouldSkipTranslation,_0x540c9d)};_0x5bcfc5[_0x3f7384(0x2ff,0x32d,0x317,0x2d6)](_0x40bd1f),!_0x40bd1f[_0x3f7384(0x307,0x333,0x312,0x2f5)]&&_0x540c9d&&(_0x3eb22e[_0x3f7384(0x334,0x343,0x317,0x369)](_0x540c9d),_0xb9ce44['set'](_0x540c9d[_0x3f7384(0x357,0x2dc,0x326,0x361)+'e'](),_0x40bd1f));}else _0x456864[_0x4f83d9[_0x3f7384(0x2ff,0x2ec,0x326,0x37f)+'e']()]=_0x3a810e;}}}return{'originalTags':_0x5bcfc5,'cleanedTags':_0x3eb22e,'cleanedText':_0x5810fd[_0x3d507f(0x25f,0x268,0x23f,0x21b)](tagsToJsonString,_0x3eb22e),'tagMap':_0xb9ce44};}export function combineTranslationResult(_0x1a3229,_0x998ac0){const _0x4a9b6b={};_0x4a9b6b[_0x1bd119(0x18,-0x3f,-0x89,-0x9a)]=function(_0x10e24f,_0x47db49){return _0x10e24f!==_0x47db49;},_0x4a9b6b[_0x1bd119(0x16,-0x1a,0x0,0x22)]=function(_0x388326,_0x2ff3e8){return _0x388326===_0x2ff3e8;},_0x4a9b6b[_0x227a5a(0x493,0x53e,0x4e3,0x492)]='sLQdL';function _0x227a5a(_0x1a156b,_0x392aef,_0xde1918,_0x52d359){return _0x3126(_0xde1918-0x339,_0x392aef);}_0x4a9b6b['DfSEi']=function(_0x354edc,_0x50be14){return _0x354edc===_0x50be14;},_0x4a9b6b[_0x1bd119(0x9d,0x56,0x35,0x89)]=_0x227a5a(0x491,0x47e,0x481,0x456);function _0x1bd119(_0x211396,_0x192e80,_0x5107f2,_0x484873){return _0x3126(_0x192e80- -0x18f,_0x484873);}_0x4a9b6b[_0x227a5a(0x499,0x543,0x4ef,0x4bb)]=_0x1bd119(0x8,0x4b,0x46,0x70),_0x4a9b6b[_0x1bd119(-0x46,-0x16,-0x46,-0x70)]=function(_0x559c7d,_0x589cf8){return _0x559c7d!==_0x589cf8;},_0x4a9b6b[_0x1bd119(-0x11,-0x25,0x2e,-0x6b)]=_0x227a5a(0x4d7,0x4c0,0x4a1,0x4bc),_0x4a9b6b[_0x1bd119(-0x5f,-0x56,-0x6f,-0x5b)]=_0x227a5a(0x52e,0x54a,0x51f,0x4d4);const _0x300805=_0x4a9b6b;if(!_0x1a3229||!Array[_0x227a5a(0x4c0,0x530,0x4f0,0x51d)](_0x1a3229))return _0x300805[_0x1bd119(0x6,-0x3d,-0x92,0x6)](_0x300805[_0x1bd119(0xa3,0x56,0x11,0x82)],_0x300805[_0x227a5a(0x526,0x4e1,0x51e,0x4e8)])?[]:[];const _0xd829cd={};if(_0x998ac0&&_0x300805[_0x1bd119(-0x1b,-0x1a,-0x11,-0x30)](typeof _0x998ac0,_0x300805[_0x227a5a(0x4b3,0x4a0,0x4ef,0x495)])){if(_0x300805['yzpej'](_0x1bd119(-0x70,-0x15,-0x5d,-0x9),'SCGTZ'))for(const [_0x32f072,_0xbd493d]of Object[_0x1bd119(0x45,0x25,0x12,0x5e)](_0x998ac0)){if(_0x300805[_0x1bd119(-0x16,-0x16,0x27,-0x65)](_0x300805[_0x1bd119(0x3,-0x25,-0x6d,-0x5f)],_0x300805[_0x1bd119(-0x15,-0x56,-0x17,-0x82)]))_0xd829cd[_0x32f072[_0x1bd119(0x14,0x20,0x2d,0x6c)+'e']()]=_0xbd493d;else{if(_0x300805['yzpej'](_0x3c4503['id'],_0x4dbeb0))return;_0x590650['removeList'+_0x227a5a(0x431,0x463,0x488,0x465)](_0xe6c7ba['LLM_TRANSL'+'ATION_GET_'+_0x227a5a(0x4d1,0x4b8,0x4c4,0x480)+_0x1bd119(0x34,0x15,0x6d,0x6a)],_0x17ed5);const {prompt:_0x8ffd24}=_0x561e21;_0x5147f8[_0x1bd119(0x7c,0x49,0x8c,0x14)]('st-chatu8:'+'\x20已获取翻译提示词\x20'+_0x1bd119(-0x22,0x22,0x1e,0x25)+_0x4a041a+'):',_0x8ffd24),_0x7be528(_0x8ffd24);}}else{const _0x1e6577={'original':_0x10e958,'cleaned':_0x10afeb,'prefix':'','suffix':'','weight':'','skip':_0x25fe63(_0xcc2f4a)};_0x4e0d76[_0x1bd119(0x3c,0x11,0x10,-0x2a)](_0x1e6577),!_0x1e6577[_0x227a5a(0x504,0x4cd,0x4d4,0x494)]&&_0x2ebb76&&(_0x5f3382[_0x1bd119(0x2a,0x11,-0x26,0x5d)](_0x225272),_0x4bb48d[_0x227a5a(0x482,0x475,0x47c,0x4aa)](_0x534950[_0x1bd119(0x61,0x20,-0x17,-0x24)+'e'](),_0x1e6577));}}return _0x1a3229[_0x227a5a(0x4d7,0x501,0x4c8,0x4ed)](_0x1aa46a=>{const {original:_0x4e6e14,cleaned:_0x1e7e2b,skip:_0x437bb7}=_0x1aa46a;if(_0x437bb7){if(_0x300805[_0x266883(0x492,0x439,0x4a5,0x437)]('sLQdL',_0x300805[_0x266883(0x4c7,0x4c2,0x4be,0x46c)])){const _0x26553b={};return _0x26553b['original']=_0x4e6e14,_0x26553b['translatio'+'n']='',_0x26553b['cleaned']=_0x1e7e2b,_0x26553b['skipped']=!![],_0x26553b;}else{const _0xb94a=_0x237f0e[_0x300d81(0x481,0x45e,0x4c2,0x4da)]();if(_0xb94a)_0x35e309[_0x266883(0x4bd,0x4f2,0x503,0x46a)](_0xb94a);_0x38eabf='';}}const _0x5747df=_0xd829cd[_0x1e7e2b[_0x300d81(0x4bd,0x4cc,0x4e6,0x4e9)+'e']()]||'',_0x5d2501={};_0x5d2501[_0x266883(0x46e,0x440,0x490,0x46f)]=_0x4e6e14;function _0x266883(_0x2c4931,_0x28bf23,_0x485711,_0x110a12){return _0x227a5a(_0x2c4931-0xfd,_0x485711,_0x2c4931- -0x1c,_0x110a12-0x66);}_0x5d2501[_0x266883(0x4a1,0x44c,0x483,0x484)+'n']=_0x5747df,_0x5d2501['cleaned']=_0x1e7e2b,_0x5d2501[_0x300d81(0x490,0x441,0x45c,0x4e0)]=![];function _0x300d81(_0x2be21f,_0x47a926,_0x5b22aa,_0xb4c7e7){return _0x1bd119(_0x2be21f-0x8c,_0x2be21f-0x49d,_0x5b22aa-0x72,_0x5b22aa);}return _0x5d2501;});}export function formatTranslationDisplay(_0x3daeb8,_0x498725={}){const _0x2a32b8={};_0x2a32b8['mvhlY']=_0x113667(0x56d,0x583,0x544,0x4ef)+'\x20AI\x20设置已统一到'+_0x5e2f06(0x3b0,0x3bb,0x368,0x37d),_0x2a32b8['tntAW']=function(_0x8907cc,_0x1629a9){return _0x8907cc===_0x1629a9;},_0x2a32b8[_0x113667(0x57d,0x541,0x578,0x529)]=_0x5e2f06(0x3b5,0x3e7,0x3dc,0x38e);function _0x5e2f06(_0x2a1608,_0x591a94,_0x3c41c5,_0x2637ec){return _0x3126(_0x591a94-0x27b,_0x2a1608);}const _0x49b312=_0x2a32b8,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x498725;function _0x113667(_0x2e012a,_0x52752b,_0x181be5,_0x3e3938){return _0x3126(_0x181be5-0x38f,_0x52752b);}if(!_0x3daeb8||!Array[_0x5e2f06(0x489,0x432,0x43a,0x3f9)](_0x3daeb8))return'';return _0x3daeb8[_0x5e2f06(0x410,0x40a,0x44c,0x3dc)](_0x2883b7=>{const _0x426b03={};_0x426b03[_0xcad875(0x331,0x2e4,0x2d9,0x347)]=_0x49b312[_0x327fc0(0x1a0,0x1af,0x199,0x176)];function _0xcad875(_0xe0c205,_0xf1faa9,_0x732e1f,_0x5ef088){return _0x5e2f06(_0x5ef088,_0xe0c205- -0x111,_0x732e1f-0xfd,_0x5ef088-0x175);}const _0x397cc0=_0x426b03;if(_0x2883b7[_0x327fc0(0x199,0x174,0x1b4,0x19a)])return showOriginal?_0x2883b7[_0x327fc0(0x16d,0x195,0x190,0x169)]:'';const _0x584e01=[];function _0x327fc0(_0x4856cb,_0x139593,_0x4854eb,_0x41b08f){return _0x5e2f06(_0x4856cb,_0x41b08f- -0x263,_0x4854eb-0x1e9,_0x41b08f-0xf4);}if(showOriginal)_0x584e01['push'](_0x2883b7[_0xcad875(0x2bb,0x29a,0x281,0x2a5)]);return showTranslation&&_0x2883b7['translatio'+'n']&&(_0x49b312[_0xcad875(0x349,0x2fb,0x386,0x366)](_0xcad875(0x2d6,0x298,0x2e6,0x2ce),_0x49b312[_0x327fc0(0x211,0x25b,0x242,0x201)])?_0x584e01['push']('('+_0x2883b7['translatio'+'n']+')'):!_0x5ba145&&(_0x41a7b3['log'](_0x397cc0[_0xcad875(0x331,0x358,0x2fd,0x32b)]),_0xaffb4c=!![])),_0x584e01['join']('\x20');})[_0x113667(0x499,0x50d,0x4d6,0x4a5)](Boolean)[_0x113667(0x4f0,0x50b,0x4f8,0x4aa)](separator);}export async function translatePromptTags(_0x45ad08){const _0x55a153={'TaVtY':function(_0x24d71d,_0x12a6cf){return _0x24d71d(_0x12a6cf);},'GWYQM':function(_0x4068c2,_0x119ac1){return _0x4068c2(_0x119ac1);},'GFzLi':function(_0x17fdf3,_0x2726d5,_0xf3e277){return _0x17fdf3(_0x2726d5,_0xf3e277);},'lhLWI':_0x1bf7b4(0xfe,0x13b,0x149,0xf8)+_0x1b2b46(-0x1c4,-0x1d1,-0x1ee,-0x19a)+':'},{originalTags:_0x2d5718,cleanedText:_0x475892}=_0x55a153['TaVtY'](preprocessPromptForTranslation,_0x45ad08);if(!_0x475892){const _0xef0214={};return _0xef0214[_0x1b2b46(-0x1b6,-0x1e2,-0x1e0,-0x18b)]=[],_0xef0214[_0x1bf7b4(0xde,0x93,0xee,0x119)+'t']='',_0xef0214['originalTa'+'gs']=[],_0xef0214;}function _0x1b2b46(_0x285125,_0x2dfffd,_0x9f6194,_0x318fb7){return _0x3126(_0x318fb7- -0x2f0,_0x9f6194);}function _0x1bf7b4(_0x544b3b,_0x42e0fe,_0x5adfbf,_0x47e905){return _0x3126(_0x544b3b- -0xb7,_0x5adfbf);}try{const _0x1cff77=await callTranslation(_0x475892),_0x1d9490=_0x55a153[_0x1bf7b4(0xac,0x52,0x80,0x6d)](parseTranslationResult,_0x1cff77),_0x35ddbc=_0x55a153[_0x1bf7b4(0xbd,0xb5,0xbb,0xd0)](combineTranslationResult,_0x2d5718,_0x1d9490),_0x3102a5=_0x55a153[_0x1b2b46(-0x188,-0xd6,-0x169,-0x12e)](formatTranslationDisplay,_0x35ddbc),_0x3b2b4d={};return _0x3b2b4d[_0x1bf7b4(0xae,0xd4,0xd4,0x7b)]=_0x35ddbc,_0x3b2b4d['displayTex'+'t']=_0x3102a5,_0x3b2b4d['originalTa'+'gs']=_0x2d5718,_0x3b2b4d;}catch(_0x2a9af4){console[_0x1b2b46(-0x121,-0x12d,-0x193,-0x171)](_0x55a153[_0x1b2b46(-0xf8,-0x126,-0x174,-0x130)],_0x2a9af4);throw _0x2a9af4;}}export function parseTranslationResult(_0x2b8d7f){const _0x1d11f1={'FQOVv':function(_0x128e8a,_0x1e5bc2){return _0x128e8a===_0x1e5bc2;},'bOzCb':_0x4918a5(0x2e1,0x2e5,0x2ee,0x2e8),'voZNz':function(_0x1c1a49,_0xbabd47){return _0x1c1a49!==_0xbabd47;},'NUExY':'Cyinp','KtzfI':'st-chatu8:'+_0x4918a5(0x2f4,0x2c3,0x2bb,0x26d)+_0x30dcf8(0xa0,0x10,0x5c,0x67),'ZbiEy':function(_0xf32327,_0x192b89){return _0xf32327(_0x192b89);},'tvdxc':_0x30dcf8(0x15,0x82,0x26,0x4e),'WAbwa':function(_0x46f7b0,_0x13b2cd){return _0x46f7b0>_0x13b2cd;},'scMix':_0x4918a5(0x239,0x24c,0x293,0x23b),'Osiyc':function(_0x5d6318,_0x6f3f8a){return _0x5d6318+_0x6f3f8a;}};function _0x30dcf8(_0x12538f,_0x19e577,_0x5994e8,_0x39fd48){return _0x3126(_0x39fd48- -0xf8,_0x19e577);}if(!_0x2b8d7f)return{};try{const _0x31bb70=_0x2b8d7f['match'](/\{[\s\S]*\}/);if(_0x31bb70){const _0x39052b=JSON[_0x4918a5(0x2e7,0x299,0x296,0x26d)](_0x31bb70[-0x1*-0x1cd+0x1*-0x1ecb+0x1cfe]);if(typeof _0x39052b===_0x1d11f1[_0x4918a5(0x2b8,0x279,0x2a1,0x2d2)]&&_0x1d11f1[_0x4918a5(0x2e0,0x2e6,0x28e,0x316)](_0x39052b,null)){if(_0x1d11f1[_0x30dcf8(0x99,0xee,0xd3,0xe3)](_0x1d11f1[_0x30dcf8(0xee,0x133,0xd9,0xe4)],_0x1d11f1[_0x30dcf8(0x123,0x13b,0x11c,0xe4)]))_0x4b3111+=_0x501426;else return _0x39052b;}}}catch(_0xe732f5){console['warn'](_0x1d11f1[_0x4918a5(0x32f,0x2f7,0x30d,0x2be)],_0xe732f5['message']);}const _0x357b7b=_0x1d11f1[_0x4918a5(0x27c,0x272,0x25d,0x2c5)](String,_0x2b8d7f)[_0x4918a5(0x2d8,0x29e,0x26c,0x2cf)](/[\r\n]+/g,'\x20')['replace'](/^[\s"'`]+|[\s"'`]+$/g,'')['trim'](),_0xb8dca7=_0x357b7b[_0x4918a5(0x215,0x262,0x28f,0x27b)](/[,，]/)[_0x4918a5(0x24f,0x29a,0x29a,0x2cd)](_0x31ca8f=>_0x31ca8f[_0x30dcf8(0x3c,0x58,0x8b,0x7b)]())['filter'](Boolean),_0x16bbe6={};function _0x4918a5(_0x218ee7,_0xa6fcfc,_0x2854c6,_0x24f136){return _0x3126(_0xa6fcfc-0x10b,_0x218ee7);}for(const _0x2a708a of _0xb8dca7){if(_0x1d11f1[_0x30dcf8(0xf2,0x6d,0x5d,0x9f)](_0x1d11f1['tvdxc'],'bpdGs')){const _0x3e5c79=_0x2a708a[_0x4918a5(0x24f,0x29b,0x29e,0x298)]('\x5c');if(_0x1d11f1[_0x4918a5(0x2ce,0x2db,0x2be,0x314)](_0x3e5c79,0x23e0+0xf67+-0x3347)){if(_0x1d11f1[_0x4918a5(0x293,0x2e6,0x30f,0x2b8)](_0x1d11f1[_0x30dcf8(0x7e,0x17,0x6c,0x5c)],_0x1d11f1[_0x4918a5(0x229,0x25f,0x23a,0x25b)])){const _0x149317=_0x4ba902[_0x30dcf8(0x81,0x91,0xc3,0xaa)](/\{[\s\S]*\}/);if(_0x149317){const _0x63f452=_0x29fbfa['parse'](_0x149317[-0x62d+0x608+0x25]);if(_0x1d11f1[_0x4918a5(0x2af,0x2a2,0x28f,0x2c5)](typeof _0x63f452,_0x1d11f1[_0x4918a5(0x227,0x279,0x257,0x232)])&&_0x1d11f1['voZNz'](_0x63f452,null))return _0x63f452;}}else{const _0xa9428c=_0x2a708a[_0x4918a5(0x279,0x271,0x23d,0x272)](0x1*-0x1555+-0x1*-0x1ef4+-0x99f,_0x3e5c79)[_0x4918a5(0x2c5,0x27e,0x29d,0x259)](),_0x516cc8=_0x2a708a['slice'](_0x1d11f1[_0x4918a5(0x30a,0x2b6,0x2c2,0x30e)](_0x3e5c79,0xfbf*0x2+-0x19cb+-0x5b2))[_0x4918a5(0x2ce,0x27e,0x26b,0x290)]();if(_0xa9428c)_0x16bbe6[_0xa9428c]=_0x516cc8;}}}else _0x4f3201[_0x4918a5(0x304,0x2ab,0x2be,0x305)]('('+_0x3bf202['translatio'+'n']+')');}return _0x16bbe6;}function generateRequestId(){const _0x21880f={};function _0x34c5a7(_0x5d088c,_0x3da065,_0x1946cc,_0x3645fe){return _0x3126(_0x5d088c- -0x186,_0x3da065);}_0x21880f[_0x443493(0xa8,0x7f,0x4e,0x4b)]=function(_0x357484,_0x1f4289){return _0x357484+_0x1f4289;};const _0x17b495=_0x21880f;function _0x443493(_0x467077,_0x3774db,_0x2e05d7,_0x84ccd3){return _0x3126(_0x2e05d7- -0x10d,_0x84ccd3);}if(crypto&&crypto[_0x443493(0xd5,0xa4,0xae,0xe8)])return crypto[_0x443493(0x58,0x89,0xae,0xf8)]();return _0x17b495[_0x443493(0x8e,0x2b,0x4e,0x58)](Date[_0x443493(0xb6,0x125,0xde,0x12c)]()[_0x34c5a7(0x37,0x41,0x72,0x11)](0xaf7+0x1d88+-0x285b),Math[_0x443493(0x56,0xa2,0x55,0x1e)]()[_0x34c5a7(0x37,-0xf,0x8c,-0x15)](0x1571*0x1+-0xd37+-0x1*0x816)[_0x34c5a7(0x4f,0x4a,0x8f,0x17)](0x5e2+-0x1f03*0x1+0x1923));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x4e353e={'MiAfr':function(_0x2b41cb,_0x577e40){return _0x2b41cb!==_0x577e40;},'YtRcI':_0x2484cc(-0x29,-0x55,-0x19,-0x30),'KQHMQ':function(_0x5c0dc6,_0x2d871a){return _0x5c0dc6!==_0x2d871a;},'UVCXY':function(_0x4532a8,_0x382e1e){return _0x4532a8(_0x382e1e);},'dFMew':_0x2484cc(-0x7d,-0xaf,-0x6d,-0xb7),'uDPuX':function(_0xc84d2a,_0x44f817,_0x404900){return _0xc84d2a(_0x44f817,_0x404900);}};function _0x5070ac(_0x1ffe38,_0x149249,_0x4b10e3,_0x3d0e78){return _0x3126(_0x149249-0x359,_0x4b10e3);}function _0x2484cc(_0x211ff5,_0x551c3a,_0x4e0504,_0x11c108){return _0x3126(_0x4e0504- -0x1ea,_0x211ff5);}return new Promise((_0x2f7851,_0x2072b0)=>{function _0x19f31a(_0x185d88,_0x23a8ab,_0x29218e,_0x1d8749){return _0x2484cc(_0x23a8ab,_0x23a8ab-0x1a7,_0x185d88-0x281,_0x1d8749-0xa8);}function _0x47f76d(_0x4f9299,_0x17e408,_0x5bd37a,_0x3b6f76){return _0x5070ac(_0x4f9299-0xcc,_0x5bd37a- -0x460,_0x3b6f76,_0x3b6f76-0x56);}if(_0x4e353e[_0x19f31a(0x274,0x260,0x2c0,0x281)](_0x4e353e[_0x47f76d(0xa0,0xd5,0xe3,0xab)],_0x19f31a(0x23d,0x282,0x223,0x264))){const _0x225a02=generateRequestId();console['log'](_0x47f76d(0x87,0xbd,0xae,0xb9)+_0x47f76d(0x9c,0xad,0x5a,0x8)+_0x19f31a(0x1f0,0x1a2,0x224,0x1a7)+_0x225a02+')');const _0x3197a0=_0x6cf5d7=>{function _0x3e56a6(_0x1e6aff,_0x1a6daa,_0x2346f7,_0x5a722b){return _0x47f76d(_0x1e6aff-0xfa,_0x1a6daa-0x2f,_0x1a6daa-0x76,_0x5a722b);}function _0x2b7a20(_0x570318,_0x3e0d8f,_0x18b6aa,_0x1bfb08){return _0x47f76d(_0x570318-0x19e,_0x3e0d8f-0x140,_0x18b6aa-0x190,_0x1bfb08);}if(_0x4e353e[_0x2b7a20(0x22f,0x2a9,0x266,0x242)](_0x2b7a20(0x284,0x1f4,0x247,0x1fc),_0x4e353e[_0x2b7a20(0x1e8,0x248,0x200,0x214)])){if(_0x4e353e[_0x2b7a20(0x210,0x247,0x267,0x2a3)](_0x6cf5d7['id'],_0x225a02))return;eventSource[_0x2b7a20(0x259,0x20c,0x216,0x227)+_0x2b7a20(0x1e4,0x188,0x1d8,0x1e1)](eventNames[_0x2b7a20(0x1fb,0x209,0x1c3,0x20e)+_0x2b7a20(0x222,0x1e0,0x1fb,0x1c1)+'PROMPT_RES'+_0x2b7a20(0x264,0x27d,0x22d,0x232)],_0x3197a0);const {prompt:_0x3da97f}=_0x6cf5d7;console[_0x2b7a20(0x216,0x265,0x261,0x2af)](_0x2b7a20(0x1f2,0x240,0x23e,0x286)+'\x20已获取翻译提示词\x20'+'(ID:\x20'+_0x225a02+'):',_0x3da97f),_0x4e353e[_0x3e56a6(0xea,0x112,0xc5,0x110)](_0x2f7851,_0x3da97f);}else{if(!_0x20d2c9['isArray'](_0xe2c3de))return'[]';return _0x498f4e[_0x2b7a20(0x1c8,0x276,0x223,0x1e1)](_0x58d0fc[_0x3e56a6(0x88,0xb6,0x6e,0xa1)](_0x32ad77=>_0x32ad77&&typeof _0x32ad77===_0x2b7a20(0x278,0x276,0x21d,0x25e)));}};eventSource['on'](eventNames[_0x19f31a(0x1d1,0x22b,0x1ac,0x21d)+'ATION_GET_'+_0x19f31a(0x222,0x25d,0x258,0x241)+_0x47f76d(0xd9,0x4d,0x9d,0xbb)],_0x3197a0);const _0x33dd47={};_0x33dd47['id']=_0x225a02,eventSource[_0x47f76d(0x62,0x83,0xb5,0xe6)](eventNames[_0x19f31a(0x1d1,0x1ad,0x182,0x181)+_0x47f76d(0x2e,0xa9,0x6b,0x4f)+_0x47f76d(0x2f,0x17,0x3e,0x6)+_0x19f31a(0x21c,0x257,0x20d,0x24f)],_0x33dd47),_0x4e353e[_0x47f76d(0x89,0x41,0x3d,0x9)](setTimeout,()=>{function _0x494d06(_0x5c2276,_0x29c573,_0x55d962,_0xfc7ae9){return _0x47f76d(_0x5c2276-0x6b,_0x29c573-0xec,_0x55d962-0x4a5,_0x29c573);}function _0x326147(_0x4693db,_0x30bd2a,_0x1b40b9,_0x55d193){return _0x47f76d(_0x4693db-0xbb,_0x30bd2a-0x1bd,_0x4693db-0x25d,_0x55d193);}eventSource[_0x326147(0x2e3,0x2dc,0x2b0,0x2e7)+'ener'](eventNames[_0x494d06(0x504,0x506,0x4d8,0x4a2)+_0x494d06(0x525,0x4e7,0x510,0x504)+_0x494d06(0x581,0x525,0x529,0x520)+'PONSE'],_0x3197a0),_0x2072b0(new Error(_0x494d06(0x51c,0x536,0x563,0x531)));},-0x153e+-0x1*0x146f+0x50bd);}else return _0xae62ba?_0x21ba2b[_0x47f76d(0x11,0x62,0x4a,0x3)]:'';});}export function LLM_TRANSLATION(_0xc451d3,{timeoutMs:timeoutMs=-0x1564b+0x4f3+0x23bb8}={}){function _0x310fa6(_0x1ccf97,_0x5c86b8,_0x2d30fd,_0x5aa528){return _0x3126(_0x1ccf97- -0x1e1,_0x5aa528);}function _0x42882a(_0x2ef72d,_0x493afa,_0x13f76e,_0x1e8a37){return _0x3126(_0x493afa- -0x2a8,_0x2ef72d);}const _0x512e95={'GicxR':_0x310fa6(-0x2c,0x2e,-0x12,0x5)+_0x310fa6(-0x14,-0x13,-0x19,0x29)+_0x42882a(-0x196,-0x168,-0x1a1,-0x131),'Vkyos':function(_0x3d59c3,_0x4c74c3){return _0x3d59c3===_0x4c74c3;},'MWxst':_0x42882a(-0x12d,-0xee,-0x9e,-0x13e),'aMlJJ':'sZAXB','mnbCg':function(_0x592688){return _0x592688();},'QeOIo':function(_0x594093,_0x540cf3){return _0x594093!==_0x540cf3;},'CswcR':_0x310fa6(-0xa6,-0xe8,-0xa7,-0x5b),'PhwbN':function(_0x23603b,_0x13f05a){return _0x23603b(_0x13f05a);},'OogLq':_0x42882a(-0xe0,-0xf5,-0x99,-0x9e),'iIMLB':_0x42882a(-0xdb,-0xd9,-0x117,-0x10f),'pfoAs':_0x42882a(-0x12f,-0xf6,-0x136,-0x12e),'ZsqZE':function(_0x12d4c0,_0x28bced){return _0x12d4c0(_0x28bced);},'eSEjR':function(_0x3fb769,_0x591488){return _0x3fb769(_0x591488);},'wbxMy':'翻译失败:'};return new Promise((_0x15cc57,_0xb56f7c)=>{const _0x2ed09a={'XosOI':_0x1bb502(0x28d,0x2e3,0x238,0x246),'ABxBA':function(_0x1ae420,_0x12596a){return _0x1ae420(_0x12596a);},'jvPWv':function(_0x54f9ec,_0x44bd1c){return _0x512e95['eSEjR'](_0x54f9ec,_0x44bd1c);},'qfcFG':_0x512e95[_0x1bb502(0x2ab,0x2a0,0x299,0x2af)]},_0xd6a606=_0x512e95[_0x1bb502(0x272,0x2ab,0x297,0x22c)](generateRequestId);console[_0x9ae5c2(0x2d8,0x304,0x255,0x2b0)]('st-chatu8:'+_0x1bb502(0x2c1,0x265,0x308,0x310)+_0x9ae5c2(0x24e,0x240,0x2e3,0x289)+_0xd6a606+')');let _0x5de9c1=null;const _0x3fc21d=()=>{function _0x361af1(_0x5c8878,_0x1f2b14,_0xb4831,_0x2fb54a){return _0x9ae5c2(_0x5c8878-0x1b4,_0x1f2b14-0xb0,_0x1f2b14,_0x2fb54a- -0x1d4);}function _0x3c5383(_0x2ab5a5,_0xf5633c,_0x4bbf59,_0x5793e6){return _0x9ae5c2(_0x2ab5a5-0x1a3,_0xf5633c-0x1c9,_0xf5633c,_0x2ab5a5- -0x47f);}if(_0x2ed09a[_0x361af1(0xcf,0xa1,0xf7,0xe7)]!==_0x2ed09a['XosOI'])_0x45c0c9[_0x361af1(0xff,0x68,0xfb,0xa4)](_0x121cc4),_0x371ba5[_0x3c5383(-0x264,-0x289,-0x280,-0x27a)](_0x179463[_0x3c5383(-0x1f8,-0x1da,-0x1a7,-0x1e9)+'e'](),_0x14e8e1);else{eventSource[_0x3c5383(-0x21a,-0x23b,-0x21e,-0x257)+'ener'](eventNames[_0x3c5383(-0x26d,-0x2b6,-0x2c7,-0x249)+_0x3c5383(-0x268,-0x22e,-0x24d,-0x29b)+_0x361af1(0xf9,0x131,0xca,0xf2)],_0x3ab4d6);if(_0x5de9c1)_0x2ed09a['ABxBA'](clearTimeout,_0x5de9c1);}},_0x3ab4d6=_0x1f4bad=>{const _0x2a7cdd={};function _0x3595d3(_0x5bad0b,_0x574062,_0x35c524,_0x5bbd52){return _0x9ae5c2(_0x5bad0b-0xd9,_0x574062-0xba,_0x574062,_0x5bbd52- -0x147);}_0x2a7cdd[_0x3595d3(0xe8,0xa3,0x141,0xee)]=_0x512e95[_0x3595d3(0x11d,0x172,0xed,0x12a)];const _0x57799b=_0x2a7cdd;function _0x36e7af(_0x4c15d9,_0x15a5a0,_0x537cc0,_0x544861){return _0x1bb502(_0x15a5a0- -0xe6,_0x537cc0,_0x537cc0-0x9e,_0x544861-0xc2);}if(_0x512e95[_0x3595d3(0x158,0x184,0x173,0x136)](_0x512e95['MWxst'],_0x512e95[_0x36e7af(0x153,0x1aa,0x1a3,0x168)])){_0x2ed09a[_0x3595d3(0x15a,0x17e,0x191,0x17e)](_0x2efc9c,_0x3595d3(0x16f,0x155,0x1a0,0x14a)+_0x2dbbaf[_0x36e7af(0x1f6,0x1e1,0x1df,0x210)]),_0x349d79[_0x36e7af(0x186,0x179,0x158,0x1bf)](_0x2ed09a[_0x36e7af(0x19b,0x1cc,0x18a,0x1fb)],_0x49c6b7);throw _0x12ace3;}else{if(_0x1f4bad['id']!==_0xd6a606)return;_0x512e95['mnbCg'](_0x3fc21d),console['log']('st-chatu8:'+_0x36e7af(0x14d,0x196,0x1dc,0x150)+_0x36e7af(0x18e,0x1c4,0x1b1,0x1d7)+'\x20'+_0xd6a606+'):',_0x1f4bad);if(_0x1f4bad[_0x3595d3(0x165,0x18d,0x166,0x15d)]){if(_0x512e95[_0x36e7af(0xf4,0x132,0x14b,0x136)](_0x512e95[_0x3595d3(0xb7,0x102,0xac,0xdd)],_0x3595d3(0x9a,0x8b,0x92,0xcc))){const _0x218391={};return _0x218391[_0x36e7af(0x132,0x15f,0x143,0x145)]=[],_0x218391[_0x3595d3(0xfa,0x11a,0x17d,0x126)+'t']='',_0x218391[_0x3595d3(0x101,0x91,0xed,0xe9)+'gs']=[],_0x218391;}else _0x512e95[_0x36e7af(0x129,0x178,0x19b,0x11f)](_0x15cc57,_0x1f4bad[_0x36e7af(0x1a0,0x184,0x14e,0x13b)]);}else{if(_0x1f4bad[_0x3595d3(0xe5,0x151,0x110,0x110)]&&_0x512e95['Vkyos'](_0x1f4bad[_0x3595d3(0x10f,0x113,0x149,0x110)]['name'],_0x512e95[_0x36e7af(0x162,0x19b,0x195,0x1a0)])){const _0x3f400a=new Error(_0x1f4bad[_0x3595d3(0x145,0xc1,0x12b,0x110)][_0x36e7af(0x1a2,0x1e1,0x1d3,0x1d2)]);_0x3f400a[_0x36e7af(0x1e2,0x1d0,0x1ce,0x1fb)]=_0x36e7af(0x1e6,0x1ad,0x1d8,0x1e9),_0x512e95[_0x36e7af(0x14e,0x178,0x17d,0x1b7)](_0xb56f7c,_0x3f400a);}else _0x512e95['iIMLB']!==_0x512e95[_0x3595d3(0x142,0x193,0x128,0x16a)]?_0x512e95[_0x36e7af(0x198,0x181,0x144,0x1a6)](_0xb56f7c,new Error(_0x1f4bad[_0x36e7af(0x145,0x184,0x18b,0x18a)])):(_0x2eec92[_0x36e7af(0x1dd,0x1d2,0x17d,0x1a9)](_0x57799b[_0x3595d3(0x10d,0xe6,0xac,0xee)]),_0x11029d=!![]);}}};function _0x1bb502(_0x25172c,_0x178279,_0x4fde8f,_0x3c76cc){return _0x310fa6(_0x25172c-0x2c1,_0x178279-0x177,_0x4fde8f-0xa5,_0x178279);}eventSource['on'](eventNames[_0x1bb502(0x21a,0x262,0x1e0,0x22c)+_0x1bb502(0x21f,0x1d1,0x247,0x248)+'ONSE'],_0x3ab4d6);const _0x5e8e7f={};_0x5e8e7f[_0x9ae5c2(0x2b9,0x233,0x275,0x275)]=_0xc451d3,_0x5e8e7f['id']=_0xd6a606,eventSource[_0x1bb502(0x29c,0x27b,0x2e9,0x2e3)](eventNames[_0x1bb502(0x21a,0x264,0x24f,0x1e5)+_0x1bb502(0x22e,0x1f2,0x249,0x27e)+'EST'],_0x5e8e7f);function _0x9ae5c2(_0x344b34,_0x4e8e68,_0x8d3286,_0x5bd77e){return _0x310fa6(_0x5bd77e-0x2b9,_0x4e8e68-0xb5,_0x8d3286-0x14,_0x8d3286);}_0x5de9c1=setTimeout(()=>{function _0x5414b5(_0x52c2b3,_0x2a1877,_0x1b7c52,_0x434167){return _0x1bb502(_0x1b7c52- -0x393,_0x2a1877,_0x1b7c52-0x61,_0x434167-0x132);}function _0x33c236(_0x137f81,_0x15ece9,_0x4d4763,_0x17b80a){return _0x9ae5c2(_0x137f81-0x1bf,_0x15ece9-0x137,_0x17b80a,_0x4d4763- -0x24a);}_0x512e95[_0x5414b5(-0xec,-0xfb,-0x121,-0xf2)](_0x3fc21d),_0x512e95[_0x5414b5(-0x13c,-0x175,-0x135,-0xfe)](_0xb56f7c,new Error(_0x5414b5(-0x189,-0x119,-0x138,-0x125)+'时（'+timeoutMs+_0x5414b5(-0x133,-0xd1,-0x11b,-0x15c)));},timeoutMs);});}export async function callTranslation(_0x51cead){function _0x319f63(_0x277ec6,_0x139624,_0xf082a4,_0x23da4f){return _0x3126(_0x277ec6-0x189,_0x23da4f);}const _0x5be01c={'cqVwQ':function(_0x5d7d5b,_0x475eab){return _0x5d7d5b===_0x475eab;},'nLJgy':function(_0x496f9d,_0x3d6879){return _0x496f9d===_0x3d6879;},'GeVFn':function(_0x4f5216,_0x5616b5){return _0x4f5216!==_0x5616b5;},'azXdp':'bZfDP','csMtv':_0x26a947(-0x261,-0x1d0,-0x22a,-0x1fd),'OnIPH':_0x26a947(-0x220,-0x206,-0x1f1,-0x233)+'n','bPAAg':function(_0x1f53a2,_0x5528cd){return _0x1f53a2||_0x5528cd;},'MVVtk':function(_0x3a4d04,_0xe58ca0){return _0x3a4d04(_0xe58ca0);},'OECZu':_0x319f63(0x2e9,0x2bf,0x2a6,0x2b3),'ONPUJ':function(_0x4b700a,_0x31ee3d){return _0x4b700a(_0x31ee3d);},'TAjkd':_0x319f63(0x351,0x37d,0x31b,0x2f6),'dTjps':_0x319f63(0x36b,0x3a5,0x347,0x315)};function _0x26a947(_0x56ab19,_0xbbdfe4,_0x5c9a32,_0x194fc6){return _0x3126(_0x5c9a32- -0x375,_0x56ab19);}try{if(_0x5be01c[_0x319f63(0x369,0x374,0x36b,0x3a4)](_0x5be01c[_0x319f63(0x34d,0x329,0x359,0x367)],_0x5be01c[_0x319f63(0x335,0x2ef,0x38a,0x33f)])){let _0x2ce228=buildPromptForRequestType(_0x5be01c['OnIPH'],_0x5be01c[_0x26a947(-0x1e8,-0x261,-0x220,-0x234)](_0x51cead,''));_0x2ce228=_0x5be01c[_0x26a947(-0x23f,-0x1f6,-0x233,-0x272)](mergeAdjacentMessages,_0x2ce228);const _0x227906=[..._0x2ce228,{'role':_0x5be01c[_0x319f63(0x35c,0x320,0x338,0x341)],'content':_0x5be01c[_0x26a947(-0x1de,-0x1ee,-0x220,-0x1eb)](_0x51cead,'')}];_0x5be01c[_0x319f63(0x2cb,0x2fe,0x2ae,0x2db)](updateCombinedPrompt,_0x227906);const _0x526877=await _0x5be01c['ONPUJ'](LLM_TRANSLATION,_0x227906);return _0x526877;}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x5a16e4()};}catch(_0x32dc03){if(_0x319f63(0x2f9,0x2ea,0x339,0x2ca)!==_0x5be01c[_0x319f63(0x2d6,0x29d,0x2cc,0x29d)]){_0x5be01c[_0x26a947(-0x251,-0x278,-0x233,-0x20b)](addLog,_0x26a947(-0x179,-0x1e2,-0x1bc,-0x1f8)+_0x32dc03[_0x319f63(0x370,0x3ca,0x3a0,0x354)]),console['error'](_0x5be01c[_0x319f63(0x352,0x392,0x34f,0x347)],_0x32dc03);throw _0x32dc03;}else{const _0x4d85dc=_0xe8a18[_0x5725f8];if(_0x5be01c[_0x26a947(-0x280,-0x283,-0x238,-0x27a)](_0x4d85dc,'$'))_0x53b2ec=!_0x5ad80a,_0x4e293a+=_0x4d85dc;else{if((_0x5be01c[_0x319f63(0x312,0x322,0x330,0x2da)](_0x4d85dc,',')||_0x4d85dc==='，')&&!_0x5b3d41){const _0x10bc6d=_0x4f6622[_0x26a947(-0x1af,-0x242,-0x202,-0x1de)]();if(_0x10bc6d)_0x2627f8[_0x319f63(0x329,0x2e5,0x2d2,0x31f)](_0x10bc6d);_0x7f78b0='';}else _0x2e232e+=_0x4d85dc;}}}}let isAiInitialized=![];export function initAiSettings(_0x1898a2){function _0x54fa38(_0x51d2f0,_0x12e898,_0x328667,_0x2c8e53){return _0x3126(_0x12e898-0x372,_0x2c8e53);}function _0x18f6a6(_0x282c85,_0x598dd3,_0x25cbf0,_0x5b753){return _0x3126(_0x5b753- -0x302,_0x25cbf0);}!isAiInitialized&&(console['log']('st-chatu8:'+_0x18f6a6(-0x13a,-0x18a,-0x132,-0x135)+_0x54fa38(0x4d6,0x4b2,0x499,0x4c8)),isAiInitialized=!![]);}