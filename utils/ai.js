function _0x5019(_0x12365f,_0x2005e6){_0x12365f=_0x12365f-(-0xcbd+0x119*0x13+-0x62d);const _0x3289b4=_0x48aa();let _0x549b4d=_0x3289b4[_0x12365f];if(_0x5019['NjMZFj']===undefined){var _0x2366e3=function(_0x32c2b9){const _0x57d2eb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3dce06='',_0x2598e6='',_0xc384dc=_0x3dce06+_0x2366e3;for(let _0x782c55=-0x135*-0x16+0xd*0x11b+-0x28ed,_0x4011aa,_0x50b742,_0x5aacb6=-0x2ad*0xb+-0x13*-0x98+0x1227;_0x50b742=_0x32c2b9['charAt'](_0x5aacb6++);~_0x50b742&&(_0x4011aa=_0x782c55%(-0x1f0d+-0x5fc+0x250d)?_0x4011aa*(0x2*-0xf32+-0x7*-0x10c+0x10*0x175)+_0x50b742:_0x50b742,_0x782c55++%(-0x21c0+-0xe*-0x48+0x1dd4))?_0x3dce06+=_0xc384dc['charCodeAt'](_0x5aacb6+(0x1d28+-0x1c*-0xd7+-0x2*0x1a51))-(-0x25a6+0x237b+0x235)!==0x58*0x5c+-0x1f37+-0x69?String['fromCharCode'](-0x7f*0x1b+0x1a42+-0xbde&_0x4011aa>>(-(0x1c2f+0x1a25+-0x3652)*_0x782c55&0x16c*-0x10+0x1f36+-0x870)):_0x782c55:0x1c2d*-0x1+-0x443*-0x5+0x6de){_0x50b742=_0x57d2eb['indexOf'](_0x50b742);}for(let _0x5d302d=0x2678+0x327+-0x299f*0x1,_0x56b5dd=_0x3dce06['length'];_0x5d302d<_0x56b5dd;_0x5d302d++){_0x2598e6+='%'+('00'+_0x3dce06['charCodeAt'](_0x5d302d)['toString'](0x1573+0xfd9*-0x1+0x2c5*-0x2))['slice'](-(-0x1553*-0x1+0x7*-0x2ba+-0x23b));}return decodeURIComponent(_0x2598e6);};_0x5019['PzxNIH']=_0x2366e3,_0x5019['aMvSgl']={},_0x5019['NjMZFj']=!![];}const _0x324cfa=_0x3289b4[0x226e+0x11fb+0x3469*-0x1],_0x13a1d1=_0x12365f+_0x324cfa,_0x1a1366=_0x5019['aMvSgl'][_0x13a1d1];if(!_0x1a1366){const _0x58839a=function(_0x24f2c4){this['bLfdCy']=_0x24f2c4,this['tCPBiT']=[0xe9f+0x1b16+-0x29b4,0x71f+-0x1b41+-0x1422*-0x1,-0x1ffa+-0x13*-0x7+-0x1*-0x1f75],this['eKvMKK']=function(){return'newState';},this['apfing']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bGNEqx']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x58839a['prototype']['NxKXaj']=function(){const _0x370673=new RegExp(this['apfing']+this['bGNEqx']),_0x42bb0a=_0x370673['test'](this['eKvMKK']['toString']())?--this['tCPBiT'][-0x553+-0x2426+-0x1*-0x297a]:--this['tCPBiT'][0x4a*-0x7f+-0x1f62+-0x4418*-0x1];return this['yTGGVf'](_0x42bb0a);},_0x58839a['prototype']['yTGGVf']=function(_0x3a6c41){if(!Boolean(~_0x3a6c41))return _0x3a6c41;return this['velIth'](this['bLfdCy']);},_0x58839a['prototype']['velIth']=function(_0x3369d3){for(let _0x4cab8b=0x1*-0xede+-0x9af+0x188d,_0x3625d6=this['tCPBiT']['length'];_0x4cab8b<_0x3625d6;_0x4cab8b++){this['tCPBiT']['push'](Math['round'](Math['random']())),_0x3625d6=this['tCPBiT']['length'];}return _0x3369d3(this['tCPBiT'][-0x19ce*0x1+0x1d63*-0x1+0xc7*0x47]);},new _0x58839a(_0x5019)['NxKXaj'](),_0x549b4d=_0x5019['PzxNIH'](_0x549b4d),_0x5019['aMvSgl'][_0x13a1d1]=_0x549b4d;}else _0x549b4d=_0x1a1366;return _0x549b4d;}(function(_0x8b8a2,_0x218aa2){function _0x5b8398(_0x9e038f,_0x335671,_0x5e1a67,_0x2cb565){return _0x5019(_0x9e038f- -0x225,_0x335671);}const _0x5dd7a5=_0x8b8a2();function _0xa7816e(_0x230e4b,_0x5c09f3,_0x2e181e,_0x4f8d86){return _0x5019(_0x4f8d86-0x284,_0x2e181e);}while(!![]){try{const _0x4c2abb=parseInt(_0xa7816e(0x440,0x46d,0x469,0x47e))/(-0x4c7+0xa73+0x5ab*-0x1)*(parseInt(_0xa7816e(0x4a7,0x4c9,0x481,0x4c2))/(-0x24c3+-0x2*0xd2b+0x3f1b))+-parseInt(_0x5b8398(0xd,0x1d,0x3c,0x21))/(-0x1*-0xbcf+0x1696+-0x2262)+-parseInt(_0x5b8398(0x3a,0x14,0x5a,0x3f))/(0x22df+0xbbf*-0x1+0x171c*-0x1)*(parseInt(_0xa7816e(0x4fe,0x4b2,0x504,0x4c8))/(0x131f*-0x1+-0x1*0x1cdf+0x3003))+-parseInt(_0x5b8398(-0xc,-0x25,0x30,-0x52))/(-0x73*-0x7+-0x1249*-0x2+-0x27b1)*(parseInt(_0x5b8398(0x4a,0x89,0x17,0x6f))/(-0x263b+0x82*0x1d+0x1788))+-parseInt(_0x5b8398(-0x27,-0x12,0x5,-0x11))/(-0xafd*-0x2+0xdf4+-0x23e6)*(parseInt(_0xa7816e(0x4c1,0x4c1,0x481,0x48a))/(-0x2609+-0x4dd*0x3+0x34a9))+-parseInt(_0x5b8398(0x25,-0x1c,0x1e,0x12))/(0xbc6+-0x6f3*0x1+-0x4c9)+-parseInt(_0xa7816e(0x4fd,0x4b8,0x4ab,0x4d7))/(0x2e*-0x8e+-0x158a+0x1*0x2f19)*(-parseInt(_0xa7816e(0x481,0x466,0x478,0x4a8))/(0x26d+0xf*0x281+0x3*-0xd50));if(_0x4c2abb===_0x218aa2)break;else _0x5dd7a5['push'](_0x5dd7a5['shift']());}catch(_0x51d705){_0x5dd7a5['push'](_0x5dd7a5['shift']());}}}(_0x48aa,-0x2169*0x2c+0x7aea*-0x1d+0x1defc5));const _0x4a64fd=(function(){const _0x3343a3={};_0x3343a3[_0x50d23f(-0x17a,-0x14e,-0x114,-0x15d)]=function(_0x5ce398,_0x5456a5){return _0x5ce398===_0x5456a5;},_0x3343a3[_0x50d23f(-0x1da,-0x1a3,-0x155,-0x1a1)]='qoKWq';function _0x938f1f(_0x39afef,_0x3fd2bf,_0x187273,_0x5a4e56){return _0x5019(_0x5a4e56-0x21e,_0x39afef);}_0x3343a3['qppol']=function(_0x23a219,_0x5513ea){return _0x23a219!==_0x5513ea;};function _0x50d23f(_0x35f2d3,_0x24363e,_0xdd581d,_0x1774cb){return _0x5019(_0x1774cb- -0x395,_0xdd581d);}_0x3343a3[_0x50d23f(-0x13e,-0x10e,-0xe4,-0x11d)]=_0x50d23f(-0x159,-0xd8,-0x11c,-0x114);const _0x4fa756=_0x3343a3;let _0x450325=!![];return function(_0x259444,_0x30f9db){function _0x2cd3e1(_0x3766f7,_0x7ecc90,_0xb8b68f,_0x2a0083){return _0x50d23f(_0x3766f7-0x148,_0x7ecc90-0x29,_0x3766f7,_0x7ecc90-0x6fc);}function _0x4219ea(_0x21b3be,_0x32b23f,_0x228a71,_0x5cf896){return _0x938f1f(_0x5cf896,_0x32b23f-0x13c,_0x228a71-0x5d,_0x32b23f- -0x595);}if(_0x4fa756[_0x4219ea(-0x135,-0x174,-0x142,-0x1ab)](_0x4fa756[_0x2cd3e1(0x625,0x5df,0x624,0x5b3)],_0x4fa756[_0x4219ea(-0x10b,-0xff,-0xbc,-0x100)])){const _0x382c6e=_0x1e6fa7?function(){function _0x57a104(_0x4ae9e4,_0x40a6a4,_0x470737,_0x2d9dd7){return _0x4219ea(_0x4ae9e4-0x14,_0x4ae9e4-0xd1,_0x470737-0xd6,_0x2d9dd7);}if(_0xa98983){const _0x27f397=_0x4ce453[_0x57a104(-0x7b,-0x87,-0x7a,-0x53)](_0x20f4ad,arguments);return _0x31c1de=null,_0x27f397;}}:function(){};return _0x67f8b1=![],_0x382c6e;}else{const _0x5a95c9=_0x450325?function(){function _0x57899c(_0x32924a,_0x348dea,_0x296184,_0x35f1e1){return _0x2cd3e1(_0x296184,_0x348dea- -0x27c,_0x296184-0x1f0,_0x35f1e1-0x1ca);}function _0x5c2399(_0x42dc31,_0x225908,_0x135d91,_0x58a5a9){return _0x2cd3e1(_0x58a5a9,_0x42dc31- -0x53c,_0x135d91-0x6b,_0x58a5a9-0x81);}if(_0x4fa756['FqTrN'](_0x57899c(0x38e,0x357,0x34f,0x330),_0x4fa756[_0x57899c(0x30a,0x2df,0x300,0x32a)])){if(_0x30f9db){const _0x27d5d8=_0x30f9db['apply'](_0x259444,arguments);return _0x30f9db=null,_0x27d5d8;}}else _0x9ac775[_0x5c2399(0x42,0x68,0x70,0x57)](_0x356380),_0x26b962[_0x57899c(0x317,0x33f,0x31b,0x371)](_0x542aa1[_0x5c2399(0xaa,0xb0,0x83,0xde)+'e'](),_0x1bded6);}:function(){};return _0x450325=![],_0x5a95c9;}};}()),_0x367764=_0x4a64fd(this,function(){const _0x1488eb={};function _0x51126e(_0x3e8d9f,_0x1c912e,_0x5535a4,_0x250dc8){return _0x5019(_0x5535a4- -0x239,_0x3e8d9f);}_0x1488eb[_0x51126e(0x9,0x6d,0x1e,0x58)]=_0x51126e(-0x5c,-0x10,-0x1d,0x28)+'+$';const _0x408373=_0x1488eb;function _0x1a3362(_0x1d4c19,_0x1803c0,_0x2f84fe,_0x4e53e5){return _0x5019(_0x2f84fe- -0x7c,_0x1d4c19);}return _0x367764[_0x1a3362(0x251,0x201,0x204,0x206)]()[_0x1a3362(0x16d,0x15a,0x19e,0x158)](_0x408373[_0x51126e(0x3a,0xd,0x1e,0x5a)])['toString']()[_0x1a3362(0x1de,0x1d2,0x1bd,0x1d0)+'r'](_0x367764)[_0x1a3362(0x1d3,0x175,0x19e,0x178)](_0x408373[_0x1a3362(0x201,0x20d,0x1db,0x1eb)]);});_0x367764();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x335c17){function _0x2c4ec8(_0x595603,_0x3f8b1b,_0x20d273,_0x17d462){return _0x5019(_0x20d273-0x169,_0x17d462);}return SKIP_PATTERNS[_0x2c4ec8(0x3d4,0x3e8,0x3aa,0x361)](_0x50a9e1=>_0x50a9e1['test'](_0x335c17['trim']()));}export function tagsToJsonString(_0x3fc7d0){function _0x450829(_0x3cf5f0,_0x204b2f,_0x12078a,_0x17f7cb){return _0x5019(_0x17f7cb- -0x2a6,_0x12078a);}if(!Array[_0x37980a(0x5cb,0x5e1,0x5ee,0x5bd)](_0x3fc7d0))return'[]';function _0x37980a(_0x254abb,_0x3e39ef,_0x4f05ee,_0x1e56e8){return _0x5019(_0x3e39ef-0x39e,_0x254abb);}return JSON[_0x37980a(0x5c4,0x5d4,0x5e2,0x5f9)](_0x3fc7d0[_0x37980a(0x557,0x5a3,0x5a9,0x5bd)](_0x4f8a76=>_0x4f8a76&&typeof _0x4f8a76==='string'));}export function preprocessPromptForTranslation(_0x408054){const _0x1ee9c5={'VAYvX':function(_0x98f23f,_0x90963){return _0x98f23f(_0x90963);},'NTxBg':function(_0x319135,_0x316178){return _0x319135(_0x316178);},'rpoko':_0x31bec9(0x2ac,0x2ac,0x2f0,0x2c0),'kqcKX':function(_0x208cd2,_0x46b6fc){return _0x208cd2===_0x46b6fc;},'WBOxT':function(_0x36d491,_0x266c76){return _0x36d491===_0x266c76;},'SHMvt':function(_0x1bb0bc,_0x2f8a81){return _0x1bb0bc===_0x2f8a81;},'zCsjW':'dmcuK','lLOsf':_0x31bec9(0x25e,0x29d,0x2df,0x28c),'WgNDJ':_0x31bec9(0x2e9,0x2f2,0x2f7,0x2a9),'OCSKv':function(_0x4a4e84,_0x4d517d){return _0x4a4e84(_0x4d517d);},'IKsam':function(_0x3004f6,_0xe1ad11){return _0x3004f6(_0xe1ad11);}};if(!_0x408054||typeof _0x408054!==_0x1ee9c5[_0x211ddb(-0x13f,-0x11a,-0x105,-0xf6)])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0xa57ae=_0x148281=>{function _0x2805b7(_0x26c880,_0x4e0c81,_0x2ce8ad,_0x2cadb4){return _0x211ddb(_0x2cadb4-0x611,_0x4e0c81-0x10f,_0x26c880,_0x2cadb4-0x121);}function _0x4330e5(_0x25ea21,_0x2da16e,_0x4ae107,_0x24b99c){return _0x211ddb(_0x24b99c- -0x7b,_0x2da16e-0xee,_0x2da16e,_0x24b99c-0x158);}if(_0x4330e5(-0x19b,-0x190,-0x1c1,-0x1b1)===_0x1ee9c5[_0x4330e5(-0x22a,-0x1a0,-0x1b2,-0x1dc)]){const _0x1ec62b=[];let _0x2b6d29='',_0x55054c=![];for(let _0x41200a=0x20f9+0x11*-0x211+0x228;_0x41200a<_0x148281['length'];_0x41200a++){const _0x119b3a=_0x148281[_0x41200a];if(_0x1ee9c5[_0x4330e5(-0x19e,-0x1da,-0x19b,-0x1a9)](_0x119b3a,'$'))_0x55054c=!_0x55054c,_0x2b6d29+=_0x119b3a;else{if((_0x119b3a===','||_0x1ee9c5[_0x4330e5(-0x1ec,-0x20d,-0x23b,-0x1f1)](_0x119b3a,'，'))&&!_0x55054c){if(_0x1ee9c5[_0x4330e5(-0x18c,-0x184,-0x184,-0x16e)](_0x1ee9c5[_0x2805b7(0x505,0x4c0,0x540,0x4f5)],_0x1ee9c5[_0x4330e5(-0x1cf,-0x1d6,-0x1a4,-0x1da)])){const _0x56680d=_0x527158[0xc51*-0x3+-0x1e85+-0x2ef*-0x17]||'',_0x3f800d=(_0x42be8d[0x98+-0x44f*-0x3+-0xd83]||'')[_0x2805b7(0x4a7,0x4d4,0x44f,0x495)](),_0x1f349f=_0x29d5cf[-0x626+-0x5e7*0x6+0x2993]||'',_0x555ee8=_0x366853[0x87*0x19+-0x6d3+-0x658]||'',_0x164c39={'original':_0x5e80d7,'cleaned':_0x3f800d,'prefix':_0x56680d,'suffix':_0x1f349f,'weight':_0x555ee8,'skip':_0x1ee9c5[_0x2805b7(0x4fc,0x4cc,0x51a,0x517)](_0x1d8b11,_0x23de02)||_0x1ee9c5[_0x4330e5(-0x20e,-0x207,-0x1eb,-0x1dd)](_0x5d8b13,_0x3f800d)};_0x3218f5[_0x2805b7(0x4f5,0x499,0x477,0x4bb)](_0x164c39),!_0x164c39[_0x2805b7(0x510,0x4e0,0x4f2,0x505)]&&_0x3f800d&&(_0x103210['push'](_0x3f800d),_0xbd1c73[_0x4330e5(-0x1bb,-0x151,-0x165,-0x194)](_0x3f800d[_0x4330e5(-0x1ab,-0x19d,-0x191,-0x169)+'e'](),_0x164c39));}else{const _0x34e345=_0x2b6d29[_0x2805b7(0x462,0x448,0x4df,0x495)]();if(_0x34e345)_0x1ec62b[_0x2805b7(0x47a,0x4cf,0x502,0x4bb)](_0x34e345);_0x2b6d29='';}}else _0x2b6d29+=_0x119b3a;}}if(_0x2b6d29['trim']())_0x1ec62b[_0x2805b7(0x4a8,0x475,0x4e8,0x4bb)](_0x2b6d29[_0x4330e5(-0x1f4,-0x1c1,-0x1ea,-0x1f7)]());return _0x1ec62b;}else{const _0x28446e={};return _0x28446e['results']=[],_0x28446e[_0x2805b7(0x4b8,0x473,0x4cb,0x4ab)+'t']='',_0x28446e[_0x4330e5(-0x156,-0x154,-0x14d,-0x160)+'gs']=[],_0x28446e;}},_0x46e8d8=_0x1ee9c5[_0x31bec9(0x252,0x280,0x295,0x261)](_0xa57ae,_0x408054);function _0x31bec9(_0x385844,_0x1bf0da,_0x1463d8,_0x2f434c){return _0x5019(_0x1bf0da-0x75,_0x385844);}const _0x5112ea=[],_0x412b60=[];function _0x211ddb(_0x3ff151,_0xb07746,_0x4cdae7,_0x26dc1c){return _0x5019(_0x3ff151- -0x36d,_0x4cdae7);}const _0xbd3959=new Map();for(const _0x7edd4f of _0x46e8d8){const _0x3cd030=_0x7edd4f[_0x211ddb(-0x112,-0x116,-0xd4,-0x106)](SD_SYMBOL_PATTERN);if(_0x3cd030){const _0x36091c=_0x3cd030[0xc31+0x1100+-0x1d3*0x10]||'',_0xb76a89=(_0x3cd030[0x1*-0x1f74+0x1*0x33b+0x1c3b]||'')[_0x31bec9(0x2b3,0x266,0x233,0x284)](),_0x111715=_0x3cd030[-0x24cf+0x3*-0x47+0x25a7]||'',_0x393ee0=_0x3cd030[-0xe78*0x2+0x1*-0x1e8f+-0x37*-0x115]||'',_0x5dee3d={'original':_0x7edd4f,'cleaned':_0xb76a89,'prefix':_0x36091c,'suffix':_0x111715,'weight':_0x393ee0,'skip':shouldSkipTranslation(_0x7edd4f)||_0x1ee9c5[_0x31bec9(0x2b0,0x268,0x25e,0x228)](shouldSkipTranslation,_0xb76a89)};_0x5112ea['push'](_0x5dee3d),!_0x5dee3d[_0x31bec9(0x2cb,0x2d6,0x314,0x28e)]&&_0xb76a89&&(_0x412b60['push'](_0xb76a89),_0xbd3959[_0x31bec9(0x2af,0x2c9,0x309,0x2fb)](_0xb76a89[_0x31bec9(0x2ac,0x2f4,0x31a,0x2ef)+'e'](),_0x5dee3d));}else{const _0x3b7f59={'original':_0x7edd4f,'cleaned':_0x7edd4f,'prefix':'','suffix':'','weight':'','skip':_0x1ee9c5[_0x31bec9(0x279,0x28d,0x287,0x2db)](shouldSkipTranslation,_0x7edd4f)};_0x5112ea[_0x31bec9(0x2c1,0x28c,0x28f,0x24c)](_0x3b7f59),!_0x3b7f59[_0x211ddb(-0x10c,-0x10b,-0xca,-0x124)]&&_0x7edd4f&&(_0x412b60['push'](_0x7edd4f),_0xbd3959[_0x211ddb(-0x119,-0x118,-0x103,-0x10f)](_0x7edd4f[_0x211ddb(-0xee,-0xa3,-0x11b,-0xac)+'e'](),_0x3b7f59));}}return{'originalTags':_0x5112ea,'cleanedTags':_0x412b60,'cleanedText':tagsToJsonString(_0x412b60),'tagMap':_0xbd3959};}export function combineTranslationResult(_0x39ef45,_0x5e8667){const _0x27538d={};_0x27538d[_0x2ab4db(-0x5f,-0xad,-0x7b,-0xbe)]=function(_0x4e4a53,_0x4097d6){return _0x4e4a53===_0x4097d6;};function _0x54f94a(_0x5dc617,_0x40aa8b,_0x188347,_0x567197){return _0x5019(_0x40aa8b-0x255,_0x567197);}function _0x2ab4db(_0x3eb3ed,_0x49f6d2,_0x259c9f,_0x5b7d9d){return _0x5019(_0x49f6d2- -0x2ce,_0x5b7d9d);}_0x27538d[_0x54f94a(0x4d5,0x4a5,0x4e9,0x4b8)]=_0x54f94a(0x4a4,0x4cb,0x4b5,0x4b0),_0x27538d['eMriM']=function(_0x19b42e,_0x38e2ad){return _0x19b42e===_0x38e2ad;},_0x27538d['RNyAC']=_0x54f94a(0x4dd,0x4d7,0x4ac,0x509);const _0x2b6d26=_0x27538d;if(!_0x39ef45||!Array[_0x54f94a(0x472,0x498,0x4af,0x47f)](_0x39ef45)){if(_0x2b6d26['eYmoh'](_0x2b6d26['sIpjJ'],_0x2b6d26[_0x2ab4db(-0x7f,-0x7e,-0xc5,-0x8f)]))return[];else _0x40b5f2(_0x35dbef[_0x54f94a(0x4d7,0x4c5,0x480,0x477)]);}const _0x5bd94e={};if(_0x5e8667&&_0x2b6d26[_0x2ab4db(-0x47,-0x87,-0x8e,-0x78)](typeof _0x5e8667,_0x2b6d26[_0x54f94a(0x47f,0x4cc,0x4d9,0x518)]))for(const [_0x45ccf6,_0x599e61]of Object[_0x2ab4db(-0x24,-0x41,-0x2f,-0x1d)](_0x5e8667)){_0x5bd94e[_0x45ccf6[_0x54f94a(0x4d1,0x4d4,0x4c0,0x4c5)+'e']()]=_0x599e61;}return _0x39ef45[_0x2ab4db(-0xc2,-0xa2,-0x84,-0x7d)](_0x2d67dd=>{function _0x5874a0(_0x25d10c,_0x354213,_0x7a410d,_0x14a3e0){return _0x2ab4db(_0x25d10c-0xe2,_0x25d10c-0xf7,_0x7a410d-0x7e,_0x14a3e0);}const {original:_0xa4c356,cleaned:_0x491245,skip:_0xffdefa}=_0x2d67dd;if(_0xffdefa){const _0x48291c={};return _0x48291c[_0x5874a0(0x58,0x54,0x29,0x39)]=_0xa4c356,_0x48291c[_0x56111c(0x343,0x2f9,0x312,0x2fc)+'n']='',_0x48291c[_0x5874a0(0x96,0x87,0x78,0xc7)]=_0x491245,_0x48291c[_0x5874a0(0x36,0x83,0x56,0x34)]=!![],_0x48291c;}const _0x2991ed=_0x5bd94e[_0x491245[_0x5874a0(0xa8,0x6a,0xb2,0xcc)+'e']()]||'',_0x4ea108={};_0x4ea108['original']=_0xa4c356,_0x4ea108[_0x56111c(0x331,0x2d9,0x312,0x35c)+'n']=_0x2991ed;function _0x56111c(_0x5704c9,_0x32fce2,_0x3ec187,_0x363175){return _0x54f94a(_0x5704c9-0x119,_0x3ec187- -0x1aa,_0x3ec187-0x90,_0x363175);}return _0x4ea108['cleaned']=_0x491245,_0x4ea108[_0x5874a0(0x36,0x3f,0x5b,0x7f)]=![],_0x4ea108;});}export function formatTranslationDisplay(_0x29a54a,_0x50b91d={}){function _0x4dc103(_0x909042,_0x1b4342,_0x2dec31,_0x41d991){return _0x5019(_0x1b4342- -0x33f,_0x2dec31);}const _0x5cc360={'ZAWof':function(_0x38a815){return _0x38a815();},'QaYRv':'UvUyQ'};function _0x4f75c0(_0x2688f1,_0x4a31c1,_0xb3109e,_0x1809dd){return _0x5019(_0xb3109e- -0x249,_0x4a31c1);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x50b91d;if(!_0x29a54a||!Array[_0x4f75c0(-0x7,0x2b,-0x6,0x2a)](_0x29a54a))return'';return _0x29a54a['map'](_0x321509=>{if(_0x321509[_0x37e13d(0xde,0xa7,0xb7,0xc5)]){if(_0x5cc360[_0x37e13d(0x10b,0xc5,0xe6,0xd5)]!==_0x5cc360[_0x142dde(0x26a,0x245,0x261,0x24c)])_0x5cc360[_0x37e13d(0x7d,0xb7,0xcc,0xce)](_0x45c86c),_0x26fb1c(new _0x1cc20e(_0x142dde(0x1ff,0x26a,0x236,0x201)+'时（'+_0x5b9071+_0x37e13d(0xc3,0xb3,0x102,0x11b)));else return showOriginal?_0x321509[_0x37e13d(0x100,0x9e,0xd9,0xc3)]:'';}function _0x37e13d(_0x39aa33,_0x52891a,_0x35185b,_0x507037){return _0x4f75c0(_0x39aa33-0x106,_0x39aa33,_0x35185b-0xf3,_0x507037-0x1e4);}const _0x5acf2a=[];if(showOriginal)_0x5acf2a['push'](_0x321509[_0x142dde(0x27e,0x20c,0x254,0x294)]);function _0x142dde(_0x300ebf,_0x55f890,_0xb0c678,_0x4756c6){return _0x4f75c0(_0x300ebf-0xef,_0x55f890,_0xb0c678-0x26e,_0x4756c6-0x1a1);}return showTranslation&&_0x321509[_0x142dde(0x2cb,0x252,0x28c,0x249)+'n']&&_0x5acf2a['push']('('+_0x321509[_0x142dde(0x29a,0x256,0x28c,0x254)+'n']+')'),_0x5acf2a['join']('\x20');})[_0x4dc103(-0xff,-0x13a,-0x127,-0x12b)](Boolean)['join'](separator);}export async function translatePromptTags(_0x32ce66){const _0x18eca3={'dyhnl':function(_0x3d756e,_0x530dd6){return _0x3d756e(_0x530dd6);},'EryPJ':_0x257d25(0xec,0xd5,0x105,0xe6),'rExgW':function(_0x18e2af){return _0x18e2af();},'flBmR':function(_0x2bbba3,_0x27f410){return _0x2bbba3===_0x27f410;},'upQFh':_0x5d1309(0x5ac,0x5a7,0x5b2,0x5d0),'omJqQ':function(_0x9c767b,_0x545692){return _0x9c767b(_0x545692);},'ZQRBR':function(_0x1d8f32,_0x4706c5,_0x14a984){return _0x1d8f32(_0x4706c5,_0x14a984);},'yWVUZ':function(_0x262e7f,_0xc63d43){return _0x262e7f(_0xc63d43);},'PFskJ':'skOBm','HcOPk':'AjKIj','eGdAf':_0x257d25(0x95,0xde,0xbe,0xaf)+_0x5d1309(0x67b,0x648,0x636,0x62c)+':'},{originalTags:_0x29b735,cleanedText:_0x434ede}=preprocessPromptForTranslation(_0x32ce66);function _0x5d1309(_0x43d550,_0x5475c0,_0x324615,_0xd0bf5a){return _0x5019(_0xd0bf5a-0x3cc,_0x43d550);}function _0x257d25(_0x3b231d,_0x2c4a21,_0x5e5229,_0x1fc8fd){return _0x5019(_0x1fc8fd- -0x170,_0x5e5229);}if(!_0x434ede){const _0x516810={};return _0x516810[_0x5d1309(0x634,0x60d,0x647,0x62f)]=[],_0x516810[_0x5d1309(0x60b,0x5ac,0x5b0,0x5d3)+'t']='',_0x516810[_0x5d1309(0x63d,0x6a1,0x637,0x654)+'gs']=[],_0x516810;}try{if(_0x18eca3['flBmR'](_0x18eca3['upQFh'],'GYtrw')){const _0x40a1f9=await _0x18eca3[_0x5d1309(0x640,0x5fe,0x613,0x64a)](callTranslation,_0x434ede),_0x3f749e=parseTranslationResult(_0x40a1f9),_0x39fecd=_0x18eca3[_0x257d25(0x128,0xc3,0xdd,0xf6)](combineTranslationResult,_0x29b735,_0x3f749e),_0xff4610=_0x18eca3['yWVUZ'](formatTranslationDisplay,_0x39fecd),_0x33a06d={};return _0x33a06d[_0x5d1309(0x5f8,0x677,0x652,0x62f)]=_0x39fecd,_0x33a06d['displayTex'+'t']=_0xff4610,_0x33a06d['originalTa'+'gs']=_0x29b735,_0x33a06d;}else{const _0x23b525=_0x22c29e[_0x5d1309(0x5aa,0x59a,0x59a,0x5bd)]();if(_0x23b525)_0x69e865[_0x257d25(0xcb,0x8e,0x5d,0xa7)](_0x23b525);_0x354f2c='';}}catch(_0x383a26){if(_0x18eca3[_0x5d1309(0x5c7,0x654,0x640,0x614)](_0x18eca3[_0x5d1309(0x5e3,0x62d,0x5f5,0x631)],_0x18eca3['HcOPk'])){const _0x251d1b={'iDRnS':function(_0x2aced9,_0x1ac2b0){return _0x2aced9(_0x1ac2b0);},'VCyYc':_0x18eca3[_0x257d25(0xdb,0xab,0xaf,0xca)]},_0x465c55=_0x18eca3[_0x257d25(0x149,0xea,0xe5,0xfa)](_0x5dc350);_0x2a8c4c[_0x5d1309(0x60b,0x5a8,0x5f6,0x5ea)]('st-chatu8:'+'\x20请求获取翻译提示词'+_0x5d1309(0x661,0x63c,0x623,0x62a)+_0x465c55+')');const _0x36b74b=_0x522681=>{if(_0x522681['id']!==_0x465c55)return;_0x21ef5e[_0xd1b30d(0x11b,0x11c,0x116,0x11f)+'ener'](_0x46199e[_0xd1b30d(0x1a6,0x196,0x16e,0x1ba)+_0xd1b30d(0x1af,0x165,0x18b,0x193)+_0x17d17c(0x255,0x270,0x228,0x2a7)+_0xd1b30d(0x151,0x108,0xb9,0x112)],_0x36b74b);function _0x17d17c(_0x5bb3b1,_0x5beb46,_0x1f8aa7,_0x26ed1b){return _0x5d1309(_0x1f8aa7,_0x5beb46-0x1b6,_0x1f8aa7-0x40,_0x5beb46- -0x386);}function _0xd1b30d(_0x5eed5a,_0x4e3cee,_0x574aa3,_0x50ff2f){return _0x5d1309(_0x5eed5a,_0x4e3cee-0x35,_0x574aa3-0xc6,_0x4e3cee- -0x4c0);}const {prompt:_0x1f07f6}=_0x522681;_0xb61df8[_0xd1b30d(0xf1,0x12a,0x10b,0x134)](_0x17d17c(0x216,0x265,0x230,0x2b2)+_0xd1b30d(0x117,0x15a,0x15b,0x177)+_0x17d17c(0x25a,0x2a3,0x2c8,0x279)+_0x465c55+'):',_0x1f07f6),_0x18eca3[_0x17d17c(0x26e,0x243,0x26e,0x247)](_0x23cca3,_0x1f07f6);};_0x4b4c61['on'](_0xfcc072[_0x5d1309(0x667,0x624,0x63f,0x656)+_0x257d25(0x133,0xa1,0xd3,0xe9)+'PROMPT_RES'+'PONSE'],_0x36b74b);const _0x4e94a0={};_0x4e94a0['id']=_0x465c55,_0x48fbb8[_0x257d25(0x10c,0x87,0xe9,0xd0)](_0x309ffc['LLM_TRANSL'+_0x5d1309(0x613,0x673,0x632,0x625)+_0x5d1309(0x5dc,0x5f6,0x5b9,0x5cd)+_0x257d25(0x66,0x8a,0x81,0xad)],_0x4e94a0),_0x4b17c3(()=>{function _0x17c26d(_0x98f182,_0x5ec11f,_0x4e4ad8,_0x552fff){return _0x257d25(_0x98f182-0x5d,_0x5ec11f-0x140,_0x552fff,_0x5ec11f-0x151);}function _0x410e46(_0x38400c,_0x4291d4,_0x55889a,_0x94386c){return _0x5d1309(_0x38400c,_0x4291d4-0xb7,_0x55889a-0x13b,_0x94386c- -0x4d1);}_0x3f50c7['removeList'+_0x410e46(0x161,0x19f,0x17a,0x164)](_0x18091f[_0x410e46(0x1b9,0x15b,0x156,0x185)+'ATION_GET_'+_0x17c26d(0x1c3,0x20b,0x208,0x1f4)+_0x410e46(0x141,0xfb,0x12a,0xf7)],_0x36b74b),_0x251d1b['iDRnS'](_0x2ea192,new _0x262411(_0x251d1b['VCyYc']));},-0x1b*0x175+0x1761+-0x1*-0x3706);}else{console[_0x257d25(0x115,0x11d,0x11a,0x102)](_0x18eca3[_0x5d1309(0x609,0x5cb,0x62b,0x60e)],_0x383a26);throw _0x383a26;}}}export function parseTranslationResult(_0x297e2b){const _0x18b0fc={'VDScd':_0x4ea5a9(0x2ee,0x2c7,0x31e,0x2c7)+'+$','umEGE':function(_0x1a388a,_0x3d0adb){return _0x1a388a!==_0x3d0adb;},'NbFNf':_0x2dbc80(0x5c6,0x5cc,0x5d6,0x581),'vmzXS':function(_0x2b69b3,_0x1041e9){return _0x2b69b3===_0x1041e9;},'LxjTH':_0x2dbc80(0x5cc,0x5a6,0x5bb,0x5ce),'bMSvH':function(_0x43d218,_0x4b2339){return _0x43d218!==_0x4b2339;},'DTYRC':_0x2dbc80(0x53c,0x569,0x53a,0x540),'dFaUo':_0x2dbc80(0x569,0x584,0x58a,0x5a0)+_0x2dbc80(0x55c,0x592,0x576,0x554)+_0x4ea5a9(0x2cd,0x2d1,0x30d,0x2ef),'iWiuc':function(_0x439692,_0x39c473){return _0x439692(_0x39c473);},'KDfru':function(_0xa5af91,_0x3ff22d){return _0xa5af91>_0x3ff22d;},'ysRti':function(_0x2c5419,_0x1c0cb6){return _0x2c5419+_0x1c0cb6;}};if(!_0x297e2b)return{};try{const _0x52977a=_0x297e2b['match'](/\{[\s\S]*\}/);if(_0x52977a){if(_0x18b0fc['umEGE'](_0x4ea5a9(0x35e,0x368,0x37f,0x35b),_0x18b0fc['NbFNf'])){const _0x1b1913=JSON['parse'](_0x52977a[0x47d*-0x1+0x9*-0xfb+0x30*0x47]);if(_0x18b0fc[_0x4ea5a9(0x33d,0x363,0x361,0x30c)](typeof _0x1b1913,_0x18b0fc[_0x4ea5a9(0x355,0x367,0x306,0x391)])&&_0x18b0fc[_0x4ea5a9(0x2c8,0x2f8,0x29e,0x30b)](_0x1b1913,null))return _0x18b0fc['bMSvH'](_0x4ea5a9(0x2c4,0x2c3,0x2e2,0x2f8),_0x18b0fc[_0x2dbc80(0x56a,0x55d,0x5b2,0x554)])?_0x305d7:_0x1b1913;}else return _0x26c27d[_0x4ea5a9(0x352,0x329,0x31c,0x359)]()[_0x4ea5a9(0x2ec,0x2c8,0x2e8,0x2df)](xElnnI[_0x4ea5a9(0x2e8,0x2a5,0x2a0,0x2a5)])[_0x2dbc80(0x5ca,0x604,0x5d5,0x5ce)]()[_0x4ea5a9(0x30b,0x318,0x303,0x319)+'r'](_0x108d0b)[_0x2dbc80(0x564,0x533,0x571,0x5a0)](xElnnI[_0x2dbc80(0x560,0x55f,0x579,0x587)]);}}catch(_0x12891e){console[_0x4ea5a9(0x31e,0x326,0x2fb,0x32c)](_0x18b0fc['dFaUo'],_0x12891e[_0x4ea5a9(0x2e1,0x2cf,0x2a8,0x30f)]);}function _0x4ea5a9(_0x338cf8,_0x4c891f,_0x4fe4bc,_0x21dc3b){return _0x5019(_0x338cf8-0xd2,_0x4c891f);}function _0x2dbc80(_0x276d00,_0x374a19,_0x2936cf,_0x128727){return _0x5019(_0x276d00-0x34a,_0x128727);}const _0x87e352=_0x18b0fc[_0x2dbc80(0x5ac,0x56d,0x5c3,0x574)](String,_0x297e2b)[_0x2dbc80(0x565,0x5ac,0x54d,0x5ad)](/[\r\n]+/g,'\x20')['replace'](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x4ea5a9(0x2c3,0x284,0x2b2,0x298)](),_0x126ef2=_0x87e352[_0x2dbc80(0x5be,0x605,0x5c5,0x5e9)](/[,，]/)[_0x2dbc80(0x576,0x574,0x57e,0x575)](_0x153659=>_0x153659[_0x2dbc80(0x53b,0x57d,0x50b,0x510)]())[_0x2dbc80(0x54f,0x502,0x549,0x566)](Boolean),_0x40c58e={};for(const _0xbf65d2 of _0x126ef2){const _0x34e4b9=_0xbf65d2[_0x2dbc80(0x5d0,0x5d4,0x59d,0x582)]('\x5c');if(_0x18b0fc[_0x4ea5a9(0x336,0x372,0x301,0x2eb)](_0x34e4b9,-0x1114+-0xcf7+0x1e0b)){const _0x38a7ab=_0xbf65d2[_0x2dbc80(0x5d5,0x598,0x5ff,0x5db)](0x1*0xfd9+-0x1515*0x1+-0x5*-0x10c,_0x34e4b9)['trim'](),_0x88c277=_0xbf65d2['slice'](_0x18b0fc[_0x4ea5a9(0x2d4,0x2eb,0x2a0,0x2fc)](_0x34e4b9,-0x1b22+0x1a6f+0xb4))[_0x4ea5a9(0x2c3,0x30a,0x293,0x2e9)]();if(_0x38a7ab)_0x40c58e[_0x38a7ab]=_0x88c277;}}return _0x40c58e;}function generateRequestId(){function _0x4908a0(_0x296a10,_0x2ee09e,_0x28914e,_0x1c9bf1){return _0x5019(_0x1c9bf1-0x395,_0x2ee09e);}function _0x29798a(_0x3aaee2,_0x558da,_0x5b6e28,_0x57ec52){return _0x5019(_0x558da-0x142,_0x5b6e28);}const _0x103d01={};_0x103d01['ACzwc']=function(_0x286033,_0x211165){return _0x286033+_0x211165;};const _0x12fd9b=_0x103d01;if(crypto&&crypto[_0x29798a(0x35e,0x34a,0x34b,0x318)])return crypto[_0x4908a0(0x5b6,0x58e,0x54f,0x59d)]();return _0x12fd9b[_0x29798a(0x3af,0x372,0x398,0x32d)](Date['now']()[_0x29798a(0x375,0x3c2,0x40f,0x383)](-0x1*-0x17ae+0x2*0x836+-0x27f6),Math[_0x4908a0(0x57b,0x5a8,0x567,0x5aa)]()[_0x29798a(0x39d,0x3c2,0x3ba,0x3c2)](0x3*-0x259+-0x9*-0xca+0x15)['substring'](-0x127f+0xe29*-0x1+-0x1*-0x20aa));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x14a6d1={'SushN':function(_0x244f06,_0x1ffca0){return _0x244f06!==_0x1ffca0;},'Booln':_0x41eff9(0x42c,0x4aa,0x46b,0x4a3),'aAYMy':function(_0x536685,_0x50e086){return _0x536685(_0x50e086);},'ZRkMm':function(_0x2d8bc9,_0x109edb){return _0x2d8bc9!==_0x109edb;},'UEMLO':_0x3f5d78(0x2fe,0x338,0x2cd,0x2bb),'Kadmk':function(_0x188789){return _0x188789();}};function _0x41eff9(_0x1d4e75,_0x2eaf94,_0x4a7e43,_0xc6ae3){return _0x5019(_0x4a7e43-0x1f0,_0x1d4e75);}function _0x3f5d78(_0x2bf735,_0x287644,_0x3f94bb,_0x3f9026){return _0x5019(_0x2bf735-0xb8,_0x3f94bb);}return new Promise((_0x54eb76,_0x693806)=>{const _0x5d3d78={'ReQGf':function(_0x565b3c,_0x30dfbd){function _0x5a7dd6(_0x391ae7,_0x2f07a9,_0x262e39,_0x259a2a){return _0x5019(_0x2f07a9-0x3f,_0x262e39);}return _0x14a6d1[_0x5a7dd6(0x24a,0x23e,0x27e,0x281)](_0x565b3c,_0x30dfbd);},'bFFhQ':function(_0x76d51d,_0xbe82bb){function _0x31ba5c(_0x528dc8,_0xdb402f,_0x215b4c,_0x2f5cc6){return _0x5019(_0x528dc8- -0x199,_0x2f5cc6);}return _0x14a6d1[_0x31ba5c(0xbc,0xeb,0xcd,0x92)](_0x76d51d,_0xbe82bb);}};function _0x4c7dc9(_0xf0d86,_0x49cb18,_0x2e1573,_0x3bb3c2){return _0x41eff9(_0x3bb3c2,_0x49cb18-0x56,_0x49cb18- -0x4c2,_0x3bb3c2-0x1a4);}function _0x2ce62c(_0x49ff8e,_0xbd151e,_0x5ccbd7,_0x10f52f){return _0x41eff9(_0x10f52f,_0xbd151e-0x1c2,_0x49ff8e- -0x271,_0x10f52f-0x67);}if(_0x14a6d1['SushN'](_0x14a6d1['UEMLO'],_0x14a6d1[_0x4c7dc9(-0xc1,-0x76,-0x89,-0xb6)]))return'';else{const _0x5dc062=_0x14a6d1[_0x4c7dc9(-0xab,-0xab,-0xb5,-0xd6)](generateRequestId);console[_0x2ce62c(0x19d,0x158,0x17b,0x1a2)](_0x4c7dc9(-0xbf,-0xb3,-0x91,-0xd7)+_0x2ce62c(0x1ca,0x1ae,0x202,0x1f1)+'\x20(ID:\x20'+_0x5dc062+')');const _0x6f121a=_0x1ecafc=>{function _0x2e0b26(_0x15edfe,_0x5d8a0b,_0x53ce17,_0x1d171a){return _0x2ce62c(_0x5d8a0b-0x456,_0x5d8a0b-0x3,_0x53ce17-0x1e3,_0x1d171a);}if(_0x5d3d78['ReQGf'](_0x1ecafc['id'],_0x5dc062))return;function _0x39a9f9(_0xcfab75,_0x390982,_0xe2f1bf,_0xac783){return _0x2ce62c(_0x390982-0x36a,_0x390982-0x1a3,_0xe2f1bf-0xb5,_0xe2f1bf);}eventSource['removeList'+_0x2e0b26(0x624,0x63e,0x61a,0x609)](eventNames['LLM_TRANSL'+_0x39a9f9(0x51c,0x542,0x51e,0x565)+_0x2e0b26(0x5f5,0x5ff,0x5e0,0x604)+_0x39a9f9(0x4c2,0x4e5,0x4be,0x4e2)],_0x6f121a);const {prompt:_0x532952}=_0x1ecafc;console['log'](_0x2e0b26(0x630,0x5f4,0x5e9,0x627)+'\x20已获取翻译提示词\x20'+_0x39a9f9(0x51a,0x546,0x52c,0x546)+_0x5dc062+'):',_0x532952),_0x5d3d78['bFFhQ'](_0x54eb76,_0x532952);};eventSource['on'](eventNames[_0x4c7dc9(-0xb,-0x48,-0x83,-0x1a)+_0x4c7dc9(-0xbd,-0x79,-0x34,-0xc6)+'PROMPT_RES'+_0x4c7dc9(-0xa9,-0xd6,-0xcb,-0xf7)],_0x6f121a);const _0x7e97dd={};_0x7e97dd['id']=_0x5dc062,eventSource[_0x2ce62c(0x1bf,0x1cd,0x1f6,0x19f)](eventNames['LLM_TRANSL'+_0x2ce62c(0x1d8,0x189,0x21f,0x226)+_0x4c7dc9(-0xfc,-0xd1,-0xb4,-0xbb)+_0x4c7dc9(-0x8e,-0xb5,-0xad,-0xf0)],_0x7e97dd),setTimeout(()=>{function _0x50e667(_0x429453,_0x24f32d,_0x4cce05,_0x361e50){return _0x4c7dc9(_0x429453-0xca,_0x24f32d-0x521,_0x4cce05-0xa9,_0x429453);}function _0x4078fa(_0x1ff5fb,_0x1835fe,_0x172c02,_0x598558){return _0x2ce62c(_0x598558-0x2e2,_0x1835fe-0x90,_0x172c02-0x44,_0x1835fe);}if(_0x14a6d1[_0x4078fa(0x46f,0x458,0x428,0x46a)](_0x50e667(0x480,0x4ca,0x4d6,0x4de),_0x14a6d1[_0x4078fa(0x504,0x4a8,0x4d8,0x4da)])){const _0x18ab27=_0x1fd297[_0x4078fa(0x48c,0x4be,0x479,0x48c)](_0xd4d737,arguments);return _0x564934=null,_0x18ab27;}else eventSource[_0x4078fa(0x462,0x454,0x47e,0x471)+_0x4078fa(0x4c2,0x4b8,0x4f8,0x4ca)](eventNames['LLM_TRANSL'+_0x4078fa(0x4af,0x4cb,0x4a0,0x4ba)+_0x50e667(0x478,0x479,0x475,0x461)+_0x4078fa(0x46b,0x49b,0x41d,0x45d)],_0x6f121a),_0x14a6d1[_0x50e667(0x4ae,0x4a4,0x49a,0x4ed)](_0x693806,new Error('获取翻译提示词超时'));},0x18e5+0xcc2+0x169);}});}export function LLM_TRANSLATION(_0xcadc63,{timeoutMs:timeoutMs=-0xbdf+0x6e*0x166+-0x5c6b*-0x1}={}){const _0x566614={'IPGBI':function(_0x4cdebd,_0x15e2d4){return _0x4cdebd(_0x15e2d4);},'kvCXs':function(_0x32b87b,_0x22ecf3){return _0x32b87b!==_0x22ecf3;},'UZtAC':_0x4fe956(-0x11d,-0x140,-0x11e,-0x10a),'idKlN':function(_0x4e8a3f,_0x6a8fff,_0x313f68){return _0x4e8a3f(_0x6a8fff,_0x313f68);}};function _0x4fe956(_0x4a96b3,_0x4c848,_0x7127a7,_0x32c6ae){return _0x5019(_0x4a96b3- -0x331,_0x32c6ae);}return new Promise((_0x45eb5d,_0x11a7eb)=>{const _0x19f93d={'XYlbc':function(_0x28cc33,_0x3f83ef){function _0xdb83d(_0x35ddff,_0x5980ee,_0x4e3617,_0x576f79){return _0x5019(_0x35ddff-0x230,_0x4e3617);}return _0x566614[_0xdb83d(0x429,0x43c,0x431,0x42f)](_0x28cc33,_0x3f83ef);},'aNRiK':function(_0x24aa61,_0x560680){function _0x7dff9e(_0x1a86da,_0x450bb4,_0x545db3,_0x4629ba){return _0x5019(_0x545db3- -0x30a,_0x4629ba);}return _0x566614[_0x7dff9e(-0x105,-0xe8,-0xd9,-0xfc)](_0x24aa61,_0x560680);},'hpDtk':function(_0x14bf6b){return _0x14bf6b();},'AfVPV':function(_0xf3a9cd,_0x5b2730){return _0xf3a9cd===_0x5b2730;},'sBeGB':_0x566614[_0x37d843(0x5d2,0x5f1,0x5de,0x5e3)],'Etvai':function(_0x52c86b){return _0x52c86b();}};function _0x37d843(_0xd886eb,_0xfbeea4,_0x3d7c73,_0x1e92a5){return _0x4fe956(_0x1e92a5-0x6e1,_0xfbeea4-0x125,_0x3d7c73-0xe2,_0xd886eb);}const _0x1dccc3=generateRequestId();console[_0x37d843(0x60e,0x5cf,0x5f6,0x5ce)](_0x3cc61d(-0xa6,-0xe9,-0x10b,-0xd2)+_0x3cc61d(-0x136,-0xcf,-0xeb,-0xfc)+_0x37d843(0x62e,0x5dc,0x5c5,0x60d)+_0x1dccc3+')');function _0x3cc61d(_0x4f9167,_0x58ee13,_0x12eba8,_0x5e0fab){return _0x4fe956(_0x5e0fab-0x40,_0x58ee13-0x10b,_0x12eba8-0x16b,_0x12eba8);}let _0x18a07e=null;const _0x1de201=()=>{function _0x346457(_0x415ef6,_0x1c1d34,_0x1adc17,_0x5e52bf){return _0x3cc61d(_0x415ef6-0x123,_0x1c1d34-0x15f,_0x1adc17,_0x1c1d34-0xca);}function _0x3f0cbe(_0x3f6193,_0x622e8d,_0x1cbf63,_0x11c3ad){return _0x37d843(_0x622e8d,_0x622e8d-0xbd,_0x1cbf63-0x1b6,_0x11c3ad- -0x66e);}if(_0x3f0cbe(-0x2a,-0xa3,-0x62,-0x75)===_0x3f0cbe(-0x25,-0x58,-0x5d,-0x71)){if(_0x15789a){const _0x2b3cb8=_0x51d261[_0x346457(0x29,0x4,-0x48,0x46)](_0x1faaf4,arguments);return _0x30dbcb=null,_0x2b3cb8;}}else{eventSource[_0x346457(0x2b,-0x17,0xd,0x38)+_0x3f0cbe(-0x64,-0x30,-0x87,-0x55)](eventNames[_0x3f0cbe(-0x53,-0x74,-0x2,-0x34)+_0x3f0cbe(-0x2d,0x6,-0x85,-0x39)+_0x346457(0x5,-0x27,-0x59,-0x62)],_0x56d6c7);if(_0x18a07e)_0x19f93d[_0x346457(-0x60,-0x2f,0x1b,-0x5c)](clearTimeout,_0x18a07e);}},_0x56d6c7=_0x9af422=>{function _0x3c9c9a(_0x58bb48,_0x4311d7,_0x4333f4,_0x5ababe){return _0x3cc61d(_0x58bb48-0x1e3,_0x4311d7-0xfe,_0x4311d7,_0x4333f4-0x5ae);}if(_0x19f93d[_0x22c54d(0xdd,0xe1,0xf8,0xff)](_0x9af422['id'],_0x1dccc3))return;_0x19f93d[_0x3c9c9a(0x50c,0x532,0x4e6,0x51e)](_0x1de201);function _0x22c54d(_0x32f5ce,_0x519ed2,_0xc3dba4,_0x4c9061){return _0x3cc61d(_0x32f5ce-0x104,_0x519ed2-0x146,_0x4c9061,_0xc3dba4-0x1c3);}console[_0x22c54d(0xbd,0x122,0xf0,0xac)](_0x3c9c9a(0x48f,0x4ea,0x4dc,0x50b)+_0x22c54d(0x163,0x15d,0x117,0x135)+_0x3c9c9a(0x55d,0x54e,0x52b,0x572)+'\x20'+_0x1dccc3+'):',_0x9af422);if(_0x9af422[_0x3c9c9a(0x4fa,0x4e4,0x4f8,0x518)])_0x45eb5d(_0x9af422['result']);else{if(_0x9af422[_0x3c9c9a(0x53e,0x4ef,0x52f,0x534)]&&_0x19f93d[_0x22c54d(0x15b,0x12a,0x160,0x127)](_0x9af422[_0x3c9c9a(0x4f0,0x51e,0x52f,0x53a)][_0x3c9c9a(0x50e,0x512,0x4e0,0x501)],_0x22c54d(0xce,0xb5,0xe6,0xb5))){const _0x9fe9ea=new Error(_0x9af422[_0x3c9c9a(0x506,0x524,0x52f,0x51f)][_0x3c9c9a(0x4f7,0x4e2,0x4cc,0x510)]);_0x9fe9ea[_0x3c9c9a(0x498,0x504,0x4e0,0x4d4)]=_0x19f93d[_0x22c54d(0x164,0xfb,0x143,0x113)],_0x11a7eb(_0x9fe9ea);}else _0x19f93d['XYlbc'](_0x11a7eb,new Error(_0x9af422[_0x22c54d(0x114,0x12d,0x142,0x120)]));}};eventSource['on'](eventNames[_0x37d843(0x628,0x660,0x67c,0x63a)+'ATION_RESP'+_0x37d843(0x566,0x58f,0x5e5,0x5b0)],_0x56d6c7);const _0x5d1c5e={};_0x5d1c5e['prompt']=_0xcadc63,_0x5d1c5e['id']=_0x1dccc3,eventSource[_0x3cc61d(-0x91,-0xd8,-0xab,-0xb1)](eventNames[_0x37d843(0x610,0x640,0x64b,0x63a)+_0x37d843(0x61c,0x628,0x5c5,0x602)+_0x3cc61d(-0xb5,-0x103,-0x96,-0xbd)],_0x5d1c5e),_0x18a07e=_0x566614['idKlN'](setTimeout,()=>{_0x19f93d[_0x19a2be(0x2ab,0x2c3,0x2fc,0x2b4)](_0x1de201);function _0x55762a(_0xa4c90,_0x2f6b34,_0xab2036,_0x24409c){return _0x37d843(_0xa4c90,_0x2f6b34-0x161,_0xab2036-0x1f2,_0x24409c- -0x6c7);}function _0x19a2be(_0x5a963c,_0x497ec1,_0x487b5a,_0x3c2966){return _0x3cc61d(_0x5a963c-0x49,_0x497ec1-0xc9,_0x3c2966,_0x497ec1-0x35a);}_0x19f93d['XYlbc'](_0x11a7eb,new Error(_0x55762a(-0xc0,-0x138,-0xe2,-0x106)+'时（'+timeoutMs+_0x55762a(-0xaa,-0x74,-0x94,-0xbf)));},timeoutMs);});}export async function callTranslation(_0x435438){function _0x26fd0f(_0x32159b,_0x5135de,_0x1b332b,_0x81a64f){return _0x5019(_0x5135de-0x348,_0x81a64f);}function _0x46ee9d(_0x425fc5,_0x5e2401,_0x72517b,_0x4dc9b7){return _0x5019(_0x5e2401- -0x84,_0x72517b);}const _0x584494={'jiwSo':function(_0x278e0b,_0x302817,_0xdddf8e){return _0x278e0b(_0x302817,_0xdddf8e);},'WHWXI':_0x46ee9d(0x210,0x1e3,0x1e7,0x227)+'n','CrvwX':function(_0x54175b,_0x3e4e5f){return _0x54175b||_0x3e4e5f;},'UlqXi':function(_0xf7dd8b,_0x165df6){return _0xf7dd8b(_0x165df6);},'liJdu':function(_0x16bd39,_0x380984){return _0x16bd39(_0x380984);},'qvfPD':function(_0x27432a,_0x259072){return _0x27432a(_0x259072);},'Ysmwm':_0x46ee9d(0x1cc,0x1a9,0x172,0x1f2)};try{let _0x2f63bc=_0x584494['jiwSo'](buildPromptForRequestType,_0x584494[_0x46ee9d(0x1b8,0x1cb,0x1bc,0x1d1)],_0x584494[_0x26fd0f(0x567,0x5b0,0x56e,0x573)](_0x435438,''));_0x2f63bc=_0x584494[_0x46ee9d(0x16d,0x1b1,0x1f7,0x190)](mergeAdjacentMessages,_0x2f63bc);const _0x267dbc={};_0x267dbc[_0x26fd0f(0x55d,0x552,0x573,0x55f)]='user',_0x267dbc[_0x46ee9d(0x171,0x1b9,0x1ea,0x182)]=_0x435438||'';const _0x55273d=[..._0x2f63bc,_0x267dbc];_0x584494['liJdu'](updateCombinedPrompt,_0x55273d);const _0x263520=await _0x584494[_0x26fd0f(0x59f,0x5bd,0x5b0,0x57a)](LLM_TRANSLATION,_0x55273d);return _0x263520;}catch(_0x480d83){_0x584494['liJdu'](addLog,_0x46ee9d(0x16f,0x1a1,0x1c2,0x1d8)+_0x480d83[_0x46ee9d(0x1c0,0x18b,0x15b,0x15d)]),console[_0x46ee9d(0x1ce,0x1ee,0x204,0x1a0)](_0x584494[_0x26fd0f(0x609,0x5cf,0x59e,0x5b4)],_0x480d83);throw _0x480d83;}}let isAiInitialized=![];function _0x48aa(){const _0x184d63=['C29Tzq','zuDKqwy','AxnbCNjHEq','mtiWA1rQqvHr','iow3SUAuTUwiSoE/U+IVKsbmte0','Du9Ivhy','zu1YAu0','zMXcBvi','v1DxEw0','mZC3nJmXmgj5A1vJBG','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','D2fYBG','vuXYtfO','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','v0HxweK','C0LWAKO','EKnZALC','qvrjt05FuKvrvq','mJe4otbKuKPpALu','C2v0','yufztxK','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','yKTRthK','BxpVViK','qvrjt05Fr0vuxW','rxr2ywK','Bwf0y2G','vuvnte8','keLeoIa','icHjrdOG','mtG0mdy0CenSv0zV','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','C2TPCa','AvDPDwm','CMvZDwX0CW','s0rMCNu','uezZA0O','wLfsqLi','DhjHBNnSyxrPBW','q3j2D1G','zw5LCG','CKv4z1C','DM16wfm','Cw9lv3e','y2XLyw5Lza','ioAjP+IHJoE7K+AENcaOsuq6','nZDTy0jgrM0','CMvZDwX0','C0jLr0i','zxjYB3i','vKfzDLG','C3bSAxq','CxzMueq','EvD3wLO','uK55qum','y3vcu1a','qM9VBg4','u0HnDNq','rM56Bei','D0zcv0m','C3rYAw5N','B21kCve','Dg9mB3DLCKnHCW','Dg9tDhjPBMC','qvzot0W','B2jQzwn0','thHQveG','ieXmtsdORR7NVA7POBxPNAi','qvrjt05FuKvtua','Aw5KzxHpzG','wxnTD20','B3jPz2LUywXuyq','q0foq2W','teXnx1rsqu5tta','C2XPy2u','qwrABwe','zw50CMLLCW','qwzwufy','DhjPBq','ALjdy2K','t0nts3y','whrcvgu','ioIVT+AXGUE/U+IVKsbmte0G','Dw1fr0u','v0jpEfq','wfLSyMm','svbhqKK','mta4ndmXEejkyM5H','5BcD6k+v5PEN5Qc85BYpoG','ue9ou0u','zhLOBMW','nJK2s1boCfDx','wLjRtw0','t05trq','ufjptvbux1jfuq','ExnsDgK','CxbWB2W','r1L0CNC','zMLSDgvY','oti2mZDLquDZAKO','zgLZCgXHEvrLEa','CMfUzg9Tvvvjra','u3vZAe4','CM9Szq','tLr4qMC','CNbVA28','C2TPChbLza','BeXpC2y','BwvZC2fNzq','CMvTB3zLtgLZDa','57+76k+rieXmtsdMIAFOOyZOTOu','iePtt07OP6pMNPdLPlhOTkxVViW','DufgzeC','qwjVCNrfCNjVCG','CMfUzg9T','vKrty2q','ChvZAa','suTZyw0','ndy2nZGYsuvkC1Pv','C2vHCMnO','CMvWBgfJzq','kcGOlISPkYKRkq','vuvtva','Bg9N','C3qTy2HHDhu4oG','rfrzuKm','zvLTB2G','wKfxB2y','BMfTzq','mJy5nZzKqLzhALO','57+76k+r5AsX6lsLoIa','yu5sAuS','s2fKBwS','D3rAvg4','AhbeDgS','ufjptvbux1jfuW','yxbWBhK','BwfW','57+76k+r5AsX6lsLoG','v2DoreO','B3jPz2LUywW','qun6D2m','A3zdwhm','mZaWmJy3nMnhtffzuG','vvP0qum','rvnu','vwXXwgK','C3rYAw5NAwz5','DeHyswW','rNfuCK4','y29UC3rYDwn0BW','rxj5ueO','C3vJy2vZCW','uwfzuNy','y29UDgvUDa','oe13A1fjDW','A3fJs1G','zw1PDa'];_0x48aa=function(){return _0x184d63;};return _0x48aa();}export function initAiSettings(_0x4017b5){const _0x31472f={};_0x31472f['rUBlv']=_0x2005c9(-0x191,-0x120,-0x14c,-0x143);function _0x2005c9(_0x1a091c,_0x139de7,_0x24d2da,_0x41958f){return _0x5019(_0x41958f- -0x3cc,_0x24d2da);}function _0x461cf4(_0x1d874b,_0x503526,_0x238592,_0x1e1160){return _0x5019(_0x1d874b- -0x3c1,_0x1e1160);}_0x31472f[_0x461cf4(-0x1ae,-0x19d,-0x1d2,-0x174)]=_0x461cf4(-0x1a2,-0x1d2,-0x1bb,-0x195)+'\x20AI\x20设置已统一到'+_0x2005c9(-0x18a,-0x14f,-0x13e,-0x148);const _0x226cd7=_0x31472f;if(!isAiInitialized){if('CANCl'===_0x226cd7['rUBlv'])console[_0x461cf4(-0x1a3,-0x18d,-0x169,-0x17a)](_0x226cd7[_0x2005c9(-0x200,-0x1bd,-0x1b9,-0x1b9)]),isAiInitialized=!![];else for(const [_0x1c053f,_0x41f0c6]of _0x5cc550[_0x2005c9(-0x127,-0x128,-0x16b,-0x13f)](_0xc5318b)){_0x3b36c8[_0x1c053f['toLowerCas'+'e']()]=_0x41f0c6;}}}