(function(_0x2f0bad,_0x27f678){const _0x49fd64=_0x2f0bad();function _0xab3c4e(_0x57a2f7,_0xa85ba1,_0x5237d6,_0x2904f0){return _0x2bd9(_0x57a2f7- -0x13b,_0x2904f0);}function _0x4b952c(_0x2ed218,_0x1cba42,_0x26f938,_0x3e249d){return _0x2bd9(_0x26f938-0x108,_0x1cba42);}while(!![]){try{const _0x59a939=-parseInt(_0xab3c4e(0x15f,0x144,0x1ab,0x18d))/(-0x16bd+-0x3d9+-0x1*-0x1a97)+-parseInt(_0xab3c4e(0x10c,0x121,0xc2,0x120))/(0x12d5+-0x134f+0x7c)*(parseInt(_0x4b952c(0x363,0x37c,0x37d,0x35f))/(-0xf39+-0xe44*0x2+0x2bc4))+parseInt(_0x4b952c(0x340,0x3ba,0x38c,0x3d4))/(0x1022+-0x1f*0x111+0x10f1)+-parseInt(_0xab3c4e(0xe7,0xbe,0x109,0x123))/(0x1c41+0x1517+-0x57b*0x9)*(parseInt(_0x4b952c(0x329,0x31a,0x324,0x302))/(-0x863+0x1837*0x1+-0xfce))+-parseInt(_0xab3c4e(0x105,0x128,0xd9,0x14f))/(0x7f1+-0x22a3+0x1ab9)+-parseInt(_0xab3c4e(0x12b,0x15e,0x138,0xec))/(0x1e7*-0xb+0xcae+0x847)+parseInt(_0x4b952c(0x35c,0x31d,0x312,0x2d3))/(0x1055+0x1*-0x18c3+0xc5*0xb)*(parseInt(_0xab3c4e(0xec,0xdd,0xea,0xef))/(-0xe2*0xe+0x1*-0xa67+0x16cd*0x1));if(_0x59a939===_0x27f678)break;else _0x49fd64['push'](_0x49fd64['shift']());}catch(_0x122cce){_0x49fd64['push'](_0x49fd64['shift']());}}}(_0x52f7,-0x6f*-0x778+-0xb6f*-0x94+0x40d3*-0x7));const _0x255180=(function(){function _0x2e1d2a(_0xdcf69,_0x60b470,_0xdc12ae,_0x5e469){return _0x2bd9(_0x60b470- -0x15,_0xdcf69);}const _0x36e146={};_0x36e146['mbqXa']=function(_0x5bdee7,_0x5f241d){return _0x5bdee7===_0x5f241d;},_0x36e146[_0x2e1d2a(0x20f,0x21e,0x210,0x226)]='WIflt';const _0x15c091=_0x36e146;let _0x5bd208=!![];return function(_0x3f8909,_0x14fb8c){function _0x4f4e4c(_0x2184cd,_0x31012d,_0x11045f,_0x1e7bf1){return _0x2e1d2a(_0x31012d,_0x11045f- -0xba,_0x11045f-0x1b2,_0x1e7bf1-0x1e4);}function _0x1fb7af(_0x65d8fe,_0x1365ef,_0x13368b,_0x3f1866){return _0x2e1d2a(_0x65d8fe,_0x1365ef-0x3c0,_0x13368b-0x49,_0x3f1866-0x18f);}if(_0x15c091['mbqXa'](_0x4f4e4c(0x160,0x149,0x192,0x1de),_0x15c091['rEfvO'])){const _0x45d86c=_0x5bd208?function(){if(_0x14fb8c){const _0x567f82=_0x14fb8c['apply'](_0x3f8909,arguments);return _0x14fb8c=null,_0x567f82;}}:function(){};return _0x5bd208=![],_0x45d86c;}else{const _0x545c3a={};return _0x545c3a[_0x1fb7af(0x5f4,0x601,0x5c0,0x5e2)]=[],_0x545c3a[_0x1fb7af(0x617,0x638,0x601,0x5fa)+'t']='',_0x545c3a[_0x1fb7af(0x609,0x5b7,0x589,0x5b1)+'gs']=[],_0x545c3a;}};}()),_0x132f8f=_0x255180(this,function(){function _0x269fde(_0x5010da,_0xde087a,_0x1fcdd3,_0x244083){return _0x2bd9(_0x244083-0x31e,_0x1fcdd3);}const _0x5d0a49={};_0x5d0a49[_0xad667a(0x1b5,0x20a,0x1ba,0x16f)]=_0xad667a(0x164,0x108,0x153,0x162)+'+$';function _0xad667a(_0x357e3a,_0x1ffba4,_0xfd240c,_0x396010){return _0x2bd9(_0xfd240c- -0xa5,_0x357e3a);}const _0xc260d1=_0x5d0a49;return _0x132f8f[_0xad667a(0x1d7,0x17b,0x1a3,0x1dc)]()['search'](_0xc260d1[_0xad667a(0x175,0x1d6,0x1ba,0x182)])['toString']()[_0x269fde(0x5b8,0x59a,0x567,0x5ac)+'r'](_0x132f8f)[_0xad667a(0x1ee,0x1c8,0x1b3,0x1a4)](_0xc260d1[_0xad667a(0x1ef,0x18c,0x1ba,0x1bb)]);});_0x132f8f();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0xe6af56){function _0x33b141(_0x42b459,_0x380698,_0x3a94b9,_0x3c3a01){return _0x2bd9(_0x42b459-0x3c7,_0x3c3a01);}function _0x958250(_0x2f4520,_0x182ea6,_0x18b9de,_0x5d836d){return _0x2bd9(_0x182ea6-0x260,_0x18b9de);}return SKIP_PATTERNS[_0x958250(0x4c7,0x490,0x4df,0x46a)](_0x5f24ae=>_0x5f24ae[_0x958250(0x497,0x4ca,0x504,0x4a0)](_0xe6af56[_0x958250(0x4d0,0x4a6,0x49a,0x4ba)]()));}export function tagsToJsonString(_0x2cef4b){if(!Array[_0x86f84a(0xb8,0x89,0x99,0x3f)](_0x2cef4b))return'[]';function _0x5e0382(_0x1225b3,_0x54f08b,_0x49fd4a,_0x4965ec){return _0x2bd9(_0x4965ec-0x283,_0x1225b3);}function _0x86f84a(_0x2f0d6f,_0x1393cb,_0x264173,_0xcc4845){return _0x2bd9(_0x1393cb- -0x1f8,_0x2f0d6f);}return JSON[_0x5e0382(0x452,0x4e8,0x475,0x4a6)](_0x2cef4b[_0x5e0382(0x47a,0x4a0,0x46e,0x4b8)](_0x2494da=>_0x2494da&&typeof _0x2494da===_0x5e0382(0x508,0x566,0x535,0x513)));}function _0x2bd9(_0x8ea7df,_0x262ccb){_0x8ea7df=_0x8ea7df-(-0x20e6+-0x240e+0x46e6);const _0x44f137=_0x52f7();let _0x3f508e=_0x44f137[_0x8ea7df];if(_0x2bd9['rlLtPT']===undefined){var _0x44c4fa=function(_0x2467d7){const _0x3791f9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4f8465='',_0xfe4acb='',_0x355d6b=_0x4f8465+_0x44c4fa;for(let _0x1966a8=-0x1*-0x1ce7+-0x325+-0x19c2,_0x241da3,_0x1766a0,_0x2e48ef=-0x20b9*-0x1+0x2314+-0x43cd;_0x1766a0=_0x2467d7['charAt'](_0x2e48ef++);~_0x1766a0&&(_0x241da3=_0x1966a8%(-0x1*-0x1be6+-0x26e5+0xb03)?_0x241da3*(0x1*0x699+0x4*-0x22f+0x263)+_0x1766a0:_0x1766a0,_0x1966a8++%(0xc5+0x20f2+-0x21b3))?_0x4f8465+=_0x355d6b['charCodeAt'](_0x2e48ef+(-0x7*0x421+0xea2*0x1+0xe4f))-(0x2f3+0xb1c+-0xe05)!==-0x1*0x1733+-0x2*0xc75+-0x71*-0x6d?String['fromCharCode'](0x1*-0xadf+-0x2471+0x304f&_0x241da3>>(-(-0x2252*0x1+-0x32+0x3d6*0x9)*_0x1966a8&-0x1113+-0x21f1+0x1985*0x2)):_0x1966a8:0x3c9+-0x13b3+0x123*0xe){_0x1766a0=_0x3791f9['indexOf'](_0x1766a0);}for(let _0x4f87b5=-0xc27*-0x3+-0x1*0x42+-0x2433,_0x3935fb=_0x4f8465['length'];_0x4f87b5<_0x3935fb;_0x4f87b5++){_0xfe4acb+='%'+('00'+_0x4f8465['charCodeAt'](_0x4f87b5)['toString'](-0x1*-0x621+0x1*0x1d95+-0x23a6))['slice'](-(-0x1*0x135a+0xb*0x32f+-0xfa9));}return decodeURIComponent(_0xfe4acb);};_0x2bd9['KvjqEO']=_0x44c4fa,_0x2bd9['RcZrOX']={},_0x2bd9['rlLtPT']=!![];}const _0x16ef4b=_0x44f137[0x2573+-0x18cb+0x12*-0xb4],_0x94c6d=_0x8ea7df+_0x16ef4b,_0x417cc2=_0x2bd9['RcZrOX'][_0x94c6d];if(!_0x417cc2){const _0x173041=function(_0x183afd){this['BskjgO']=_0x183afd,this['fLWBdG']=[-0xe30+-0x22c3+0x30f4,-0x8*0x5+-0x1682+0x16aa,0x2009+-0x1*-0x1895+-0x389e],this['FUEViq']=function(){return'newState';},this['BoixGD']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['cMxoli']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x173041['prototype']['CwhSXm']=function(){const _0x32baf5=new RegExp(this['BoixGD']+this['cMxoli']),_0x45c390=_0x32baf5['test'](this['FUEViq']['toString']())?--this['fLWBdG'][0x1cd+-0x91+-0x3f*0x5]:--this['fLWBdG'][0xda*0x8+0x1216+-0x18e6];return this['cjekbo'](_0x45c390);},_0x173041['prototype']['cjekbo']=function(_0x3c0258){if(!Boolean(~_0x3c0258))return _0x3c0258;return this['vgnabZ'](this['BskjgO']);},_0x173041['prototype']['vgnabZ']=function(_0x89170f){for(let _0x546739=-0x239*-0x8+-0x67*0x4f+0xe01,_0x14edca=this['fLWBdG']['length'];_0x546739<_0x14edca;_0x546739++){this['fLWBdG']['push'](Math['round'](Math['random']())),_0x14edca=this['fLWBdG']['length'];}return _0x89170f(this['fLWBdG'][0x838+0x3*0xbd5+0x2bb7*-0x1]);},new _0x173041(_0x2bd9)['CwhSXm'](),_0x3f508e=_0x2bd9['KvjqEO'](_0x3f508e),_0x2bd9['RcZrOX'][_0x94c6d]=_0x3f508e;}else _0x3f508e=_0x417cc2;return _0x3f508e;}export function preprocessPromptForTranslation(_0x351fb4){const _0x4f23c6={'nKypW':function(_0x3b12e5,_0x5b2a59){return _0x3b12e5<_0x5b2a59;},'RyesC':function(_0x343b49,_0x17ffff){return _0x343b49===_0x17ffff;},'sLovI':function(_0x32e6e7,_0x294ffc){return _0x32e6e7===_0x294ffc;},'TXcwO':function(_0x587a23,_0x10c64c){return _0x587a23===_0x10c64c;},'TUBJU':_0x53d53e(-0x69,0x24,-0x19,-0x2a),'myogD':_0x53d53e(-0x26,-0x71,-0x35,-0x44),'Lkuhj':_0x51d497(0x192,0x1bf,0x17e,0x185),'kHntx':function(_0x21e2d6,_0x57c615){return _0x21e2d6!==_0x57c615;},'xwVVY':function(_0x5f463d,_0x41cbc9){return _0x5f463d(_0x41cbc9);},'jYWzJ':_0x51d497(0x1dc,0x1dd,0x188,0x1b7),'nVcMK':function(_0x30f56e){return _0x30f56e();},'VYtqy':function(_0x1d07e3,_0x2ba90f){return _0x1d07e3(_0x2ba90f);},'glDpK':function(_0xf563ca,_0x56c771){return _0xf563ca!==_0x56c771;},'kjfjM':_0x53d53e(0x92,0x5c,0x18,0x3d),'bRSKt':_0x53d53e(0x6f,0x49,-0x18,0x39),'FtYYO':'jGjsm','lLagm':_0x51d497(0x1ad,0x1d9,0x191,0x18f),'Aqwgd':'BVKJU','byOfP':function(_0x3adba8,_0x472155){return _0x3adba8(_0x472155);},'ompOt':_0x51d497(0x1aa,0x1a0,0x185,0x18b),'nyQhq':function(_0x180872,_0xf2481b){return _0x180872(_0xf2481b);}};if(!_0x351fb4||_0x4f23c6['glDpK'](typeof _0x351fb4,_0x4f23c6['kjfjM'])){if(_0x4f23c6[_0x53d53e(0x3c,0x4d,0x6,0x0)](_0x4f23c6[_0x51d497(0x204,0x1ac,0x1e0,0x1f4)],_0x4f23c6[_0x51d497(0x209,0x255,0x20b,0x203)]))_0x14bd84[_0x5521d6[_0x53d53e(-0x57,-0x15,0x15,-0x7)+'e']()]=_0x17a839;else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};}const _0x1d1d46=_0x336c8b=>{function _0x497786(_0x329792,_0x143bd9,_0x453793,_0x5f10c4){return _0x51d497(_0x143bd9,_0x143bd9-0x32,_0x453793-0x11b,_0x5f10c4- -0x276);}const _0x543a15=[];let _0x1d9458='',_0x48fc81=![];for(let _0x50859d=0xca0*-0x1+0x1979*0x1+-0x1*0xcd9;_0x4f23c6[_0x4d569c(0x2f1,0x261,0x2a7,0x2b8)](_0x50859d,_0x336c8b[_0x497786(-0xf9,-0x10c,-0x97,-0xba)]);_0x50859d++){const _0x4eab3c=_0x336c8b[_0x50859d];if(_0x4f23c6[_0x4d569c(0x28a,0x238,0x27d,0x2c5)](_0x4eab3c,'$'))_0x48fc81=!_0x48fc81,_0x1d9458+=_0x4eab3c;else{if((_0x4eab3c===','||_0x4f23c6[_0x4d569c(0x2ca,0x265,0x27f,0x2b6)](_0x4eab3c,'，'))&&!_0x48fc81){if(_0x4f23c6[_0x4d569c(0x221,0x272,0x23e,0x1fa)](_0x4f23c6[_0x497786(-0x31,-0x88,-0x98,-0x4c)],_0x497786(-0xa1,-0x78,-0xa2,-0xa0)))return[];else{const _0x12ce66=_0x1d9458['trim']();if(_0x12ce66)_0x543a15['push'](_0x12ce66);_0x1d9458='';}}else{if(_0x4f23c6[_0x4d569c(0x27e,0x233,0x25c,0x278)]!==_0x4f23c6['Lkuhj'])_0x1d9458+=_0x4eab3c;else{const _0x35f635={};return _0x35f635[_0x497786(-0xdf,-0x118,-0x121,-0xe5)]=_0xc3cf11,_0x35f635[_0x4d569c(0x24a,0x220,0x261,0x224)+'n']='',_0x35f635[_0x497786(-0xc2,-0x12b,-0x104,-0xe3)]=_0x245426,_0x35f635['skipped']=!![],_0x35f635;}}}}function _0x4d569c(_0x5a906c,_0x40bf84,_0x22eebb,_0x4da055){return _0x53d53e(_0x5a906c-0xfb,_0x4da055,_0x22eebb-0x192,_0x22eebb-0x27d);}if(_0x1d9458[_0x4d569c(0x288,0x21d,0x270,0x224)]())_0x543a15[_0x4d569c(0x2f5,0x2e1,0x2a3,0x2be)](_0x1d9458[_0x4d569c(0x229,0x21c,0x270,0x29e)]());return _0x543a15;},_0x490be9=_0x4f23c6[_0x51d497(0x26a,0x234,0x20c,0x228)](_0x1d1d46,_0x351fb4),_0x37d4de=[];function _0x51d497(_0x27b333,_0x104db1,_0xb16a9,_0x33779f){return _0x2bd9(_0x33779f- -0x6f,_0x27b333);}const _0x51da57=[],_0x410b8c=new Map();for(const _0x4beb76 of _0x490be9){const _0x517ec0=_0x4beb76[_0x53d53e(-0x13,0x47,0xa,0x37)](SD_SYMBOL_PATTERN);if(_0x517ec0){if(_0x4f23c6[_0x53d53e(-0x46,0x3,-0x12,0x2)](_0x4f23c6[_0x53d53e(-0x16,-0x56,-0xa1,-0x4d)],_0x4f23c6[_0x53d53e(0x5f,0x9,-0x26,0x21)])){const _0x21c1ce={};_0x21c1ce[_0x51d497(0x1d3,0x1bb,0x1b3,0x1aa)]=_0x4f23c6['jYWzJ'];const _0x4b2661=_0x21c1ce,_0x282626=_0x4f23c6[_0x51d497(0x181,0x1d3,0x1fc,0x1d4)](_0x2a9fbe);_0x3a7360[_0x53d53e(-0x3,0x7e,0xc,0x3f)](_0x53d53e(0x49,0x33,0x1f,0x3e)+_0x51d497(0x1aa,0x1fb,0x212,0x1bf)+_0x51d497(0x224,0x233,0x1d6,0x225)+_0x282626+')');const _0x5bbd06=_0x33a42a=>{if(_0x4f23c6[_0x1e81df(0x185,0x1a4,0x15e,0x16f)](_0x33a42a['id'],_0x282626))return;function _0x487d7b(_0x578335,_0x52f862,_0x232496,_0x252658){return _0x51d497(_0x578335,_0x52f862-0xd3,_0x232496-0x1aa,_0x52f862-0x431);}function _0x1e81df(_0x5e5c52,_0x127e72,_0x2cd98f,_0x662fb8){return _0x51d497(_0x5e5c52,_0x127e72-0x113,_0x2cd98f-0x114,_0x2cd98f- -0x97);}_0x3dbc35['removeList'+_0x1e81df(0x159,0x101,0x130,0xfd)](_0x14ab77['LLM_TRANSL'+_0x487d7b(0x625,0x629,0x611,0x5dd)+_0x487d7b(0x5d6,0x5e7,0x5c1,0x5be)+_0x487d7b(0x5f4,0x62b,0x662,0x605)],_0x5bbd06);const {prompt:_0x275cd5}=_0x33a42a;_0xf0f931[_0x1e81df(0x1d5,0x17d,0x18c,0x1b8)](_0x1e81df(0x167,0x151,0x18b,0x16f)+_0x487d7b(0x64a,0x64a,0x65a,0x647)+_0x1e81df(0x108,0x184,0x13b,0x180)+_0x282626+'):',_0x275cd5),_0x4f23c6[_0x487d7b(0x631,0x659,0x6a7,0x635)](_0x40d243,_0x275cd5);};_0xd9c44a['on'](_0x19c65b[_0x53d53e(0x7a,0x2d,0x8c,0x42)+_0x51d497(0x1c0,0x1d9,0x1a9,0x1f8)+_0x51d497(0x1f7,0x1b2,0x1a0,0x1b6)+_0x53d53e(0x22,0x10,0x36,0x16)],_0x5bbd06);const _0x56929b={};_0x56929b['id']=_0x282626,_0x1b41ae[_0x53d53e(-0xe,-0x2e,-0x1,0x1)](_0x40aeb6['LLM_TRANSL'+_0x51d497(0x1d2,0x220,0x237,0x1f8)+_0x53d53e(0x3,0x50,0x26,0xd)+_0x53d53e(-0x17,-0x1c,-0x1,0x38)],_0x56929b),_0x55aa33(()=>{_0x4abcf3[_0x532e61(0x5a,0xa2,0xb3,0xa0)+'ener'](_0x1fa032[_0x532e61(0x138,0x126,0xd7,0x168)+'ATION_GET_'+'PROMPT_RES'+'PONSE'],_0x5bbd06);function _0x532e61(_0x4c06b5,_0x54b161,_0x39391e,_0x400d1a){return _0x53d53e(_0x4c06b5-0x118,_0x400d1a,_0x39391e-0x163,_0x54b161-0xe4);}function _0x5c6189(_0x44e7b7,_0x514605,_0x1dcd24,_0x27d823){return _0x53d53e(_0x44e7b7-0x8d,_0x27d823,_0x1dcd24-0x17,_0x44e7b7-0x445);}_0x3f0aab(new _0x20311(_0x4b2661[_0x5c6189(0x40b,0x43a,0x438,0x403)]));},-0x6*-0x90f+-0x1843*-0x1+-0x278d);}else{const _0x33cf0e=_0x517ec0[0x101d+-0x1e7a+-0x6*-0x265]||'',_0x594567=(_0x517ec0[-0x1*-0x1ade+-0x217+0x1*-0x18c5]||'')[_0x53d53e(-0xd,0xc,-0x21,-0xd)](),_0x39ee5e=_0x517ec0[0x16f6*0x1+-0x13f*-0x17+-0x24*0x16f]||'',_0x344aa8=_0x517ec0[-0x873+0xd*-0x169+0x1acc]||'',_0x2ac9a1={'original':_0x4beb76,'cleaned':_0x594567,'prefix':_0x33cf0e,'suffix':_0x39ee5e,'weight':_0x344aa8,'skip':shouldSkipTranslation(_0x4beb76)||_0x4f23c6[_0x53d53e(0x29,0x6,0x74,0x30)](shouldSkipTranslation,_0x594567)};_0x37d4de[_0x51d497(0x1f1,0x21d,0x255,0x20a)](_0x2ac9a1),!_0x2ac9a1['skip']&&_0x594567&&(_0x51da57[_0x51d497(0x252,0x1e0,0x1fb,0x20a)](_0x594567),_0x410b8c[_0x51d497(0x219,0x20c,0x221,0x216)](_0x594567[_0x53d53e(-0x43,0x33,0x24,-0x7)+'e'](),_0x2ac9a1));}}else{if(_0x4f23c6[_0x53d53e(0x2e,-0x20,0x30,0x2c)](_0x53d53e(-0x9c,-0x68,-0x4c,-0x59),_0x4f23c6[_0x51d497(0x20a,0x202,0x1a9,0x1e3)])){if(_0x4f23c6[_0x53d53e(-0x28,0x2c,0xf,0x11)](_0x10042e['id'],_0x4c3738))return;_0x74ef21[_0x53d53e(-0x6e,-0x59,0x1,-0x42)+_0x51d497(0x1f2,0x213,0x192,0x1c7)](_0x508d83['LLM_TRANSL'+_0x53d53e(-0x3,0xa,0x5e,0x14)+_0x53d53e(-0x36,-0x68,-0x6b,-0x2e)+_0x53d53e(-0x26,0x60,0x5c,0x16)],_0x143206);const {prompt:_0x8937a9}=_0x55dd86;_0x108545['log'](_0x51d497(0x22f,0x1ef,0x226,0x222)+'\x20已获取翻译提示词\x20'+'(ID:\x20'+_0x512b85+'):',_0x8937a9),_0x4f23c6['VYtqy'](_0x1f932c,_0x8937a9);}else{const _0x2045d3={'original':_0x4beb76,'cleaned':_0x4beb76,'prefix':'','suffix':'','weight':'','skip':_0x4f23c6[_0x53d53e(-0x11,0x5,0x36,0x30)](shouldSkipTranslation,_0x4beb76)};_0x37d4de[_0x53d53e(0x59,0x2,-0x4,0x26)](_0x2045d3),!_0x2045d3[_0x53d53e(0x1d,-0x74,-0x10,-0x34)]&&_0x4beb76&&(_0x51da57[_0x51d497(0x232,0x1ed,0x217,0x20a)](_0x4beb76),_0x410b8c['set'](_0x4beb76[_0x53d53e(-0x2d,-0x29,0x46,-0x7)+'e'](),_0x2045d3));}}}function _0x53d53e(_0x2fc6df,_0x3af8db,_0x40a424,_0x151824){return _0x2bd9(_0x151824- -0x253,_0x3af8db);}return{'originalTags':_0x37d4de,'cleanedTags':_0x51da57,'cleanedText':_0x4f23c6['nyQhq'](tagsToJsonString,_0x51da57),'tagMap':_0x410b8c};}export function combineTranslationResult(_0x9f3300,_0x5ed629){const _0x279134={};_0x279134[_0x280681(0xfe,0xdc,0x12c,0x118)]=function(_0x48197b,_0x5e04e1){return _0x48197b===_0x5e04e1;},_0x279134['IfVUy']=_0x81678d(0x149,0x13c,0x13b,0x143),_0x279134[_0x81678d(0x157,0x1b8,0x1bf,0x181)]=_0x280681(0x152,0x137,0xcf,0x10f);const _0x2167e9=_0x279134;function _0x280681(_0x566ca7,_0x57088f,_0x422143,_0x1499b9){return _0x2bd9(_0x1499b9- -0x159,_0x566ca7);}if(!_0x9f3300||!Array['isArray'](_0x9f3300))return[];const _0x12feed={};function _0x81678d(_0x5d8b4b,_0x1dd188,_0x1956be,_0x46df66){return _0x2bd9(_0x46df66- -0xba,_0x1956be);}if(_0x5ed629&&_0x2167e9[_0x280681(0x143,0xe0,0x14a,0x118)](typeof _0x5ed629,'object'))for(const [_0x2b8d7b,_0x1d631c]of Object[_0x280681(0xb1,0x107,0xd7,0xc4)](_0x5ed629)){_0x2167e9[_0x280681(0x130,0x95,0xac,0xe2)]===_0x81678d(0x17d,0x159,0x1a9,0x1ae)?_0x12feed[_0x2b8d7b['toLowerCas'+'e']()]=_0x1d631c:_0x13e1ca['push']('('+_0x3cf916['translatio'+'n']+')');}return _0x9f3300['map'](_0x4ab03f=>{const {original:_0x1d1dec,cleaned:_0x31f30a,skip:_0x2da233}=_0x4ab03f;if(_0x2da233){if(_0x2167e9[_0x617b53(0x4b1,0x4df,0x4fb,0x4ab)](_0x2167e9[_0x5be027(0x2ed,0x2bb,0x2c8,0x2ab)],_0x5be027(0x250,0x205,0x26c,0x23b))){const _0x4e960c={};return _0x4e960c[_0x617b53(0x477,0x3ec,0x412,0x43a)]=_0x1d1dec,_0x4e960c['translatio'+'n']='',_0x4e960c['cleaned']=_0x31f30a,_0x4e960c[_0x5be027(0x270,0x211,0x225,0x258)]=!![],_0x4e960c;}else return _0x2af990[_0x5be027(0x2b6,0x264,0x295,0x26e)](_0x556154=>_0x556154[_0x617b53(0x4ed,0x469,0x4c1,0x4a4)](_0x5cd01d[_0x617b53(0x497,0x4d4,0x4c0,0x480)]()));}const _0x5b86ed=_0x12feed[_0x31f30a['toLowerCas'+'e']()]||'',_0x1bd741={};function _0x5be027(_0x255550,_0x199e28,_0x4ffb21,_0x5bd79b){return _0x280681(_0x199e28,_0x199e28-0x17b,_0x4ffb21-0x38,_0x5bd79b-0x197);}_0x1bd741[_0x5be027(0x213,0x265,0x21f,0x23e)]=_0x1d1dec;function _0x617b53(_0x26a29b,_0x4b981d,_0xccefbd,_0x3c5672){return _0x81678d(_0x26a29b-0x85,_0x4b981d-0x21,_0xccefbd,_0x3c5672-0x2f4);}return _0x1bd741['translatio'+'n']=_0x5b86ed,_0x1bd741[_0x5be027(0x259,0x253,0x215,0x240)]=_0x31f30a,_0x1bd741[_0x617b53(0x42f,0x480,0x46d,0x454)]=![],_0x1bd741;});}export function formatTranslationDisplay(_0x31395d,_0x2e9217={}){function _0x5bc89c(_0x5f4b77,_0x5a8f38,_0x13caa2,_0x52f6fc){return _0x2bd9(_0x52f6fc- -0x179,_0x5a8f38);}const _0x448782={};_0x448782[_0x3107e0(-0x146,-0xe0,-0xd7,-0x114)]=function(_0x42204d,_0x5d10f9){return _0x42204d!==_0x5d10f9;},_0x448782[_0x3107e0(-0x10d,-0x113,-0x113,-0x15c)]=_0x3107e0(-0x115,-0x168,-0x183,-0x136),_0x448782[_0x5bc89c(0xd1,0xf3,0xc5,0xb1)]='RxFif',_0x448782[_0x3107e0(-0xdf,-0xdb,-0xc4,-0xd9)]=_0x5bc89c(0x123,0x162,0xf1,0x10e);const _0x3a662c=_0x448782,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x2e9217;if(!_0x31395d||!Array['isArray'](_0x31395d))return'';function _0x3107e0(_0x43ac1b,_0x4ddfbc,_0xf5d3a1,_0x3de5fa){return _0x2bd9(_0x3de5fa- -0x351,_0x43ac1b);}return _0x31395d[_0x3107e0(-0x187,-0x15e,-0x138,-0x14d)](_0x1b93fc=>{if(_0x1b93fc[_0x8af6a9(0x20b,0x225,0x1ba,0x252)]){if(_0x3a662c[_0x8af6a9(0x22e,0x204,0x1ee,0x271)](_0x8af6a9(0x20c,0x213,0x1cc,0x237),_0x3a662c[_0x5931b9(0x148,0x184,0x1a2,0x176)]))_0x4f32f2(new _0x5cbe92(_0x10208e[_0x8af6a9(0x267,0x28f,0x229,0x252)]));else return showOriginal?_0x1b93fc['original']:'';}function _0x5931b9(_0x291de3,_0x4b3ec7,_0x4d4276,_0x342338){return _0x5bc89c(_0x291de3-0x66,_0x4d4276,_0x4d4276-0x140,_0x4b3ec7-0x108);}function _0x8af6a9(_0x4ea31a,_0x503b63,_0x2cb173,_0x25c928){return _0x5bc89c(_0x4ea31a-0x8c,_0x25c928,_0x2cb173-0x45,_0x4ea31a-0x16a);}const _0x1ec526=[];if(showOriginal)_0x1ec526['push'](_0x1b93fc[_0x8af6a9(0x1f1,0x227,0x1c3,0x23a)]);if(showTranslation&&_0x1b93fc['translatio'+'n']){if(_0x3a662c[_0x8af6a9(0x22e,0x207,0x226,0x214)](_0x3a662c[_0x5931b9(0x18d,0x1b9,0x1ff,0x1a7)],_0x3a662c[_0x5931b9(0x23e,0x207,0x1cc,0x1f6)]))_0x1ec526['push']('('+_0x1b93fc[_0x8af6a9(0x228,0x1dc,0x1fa,0x216)+'n']+')');else return'';}return _0x1ec526['join']('\x20');})['filter'](Boolean)['join'](separator);}export async function translatePromptTags(_0x349d7e){const _0x5c4eaa={'vWAeI':function(_0x2d1971,_0x31ade8){return _0x2d1971===_0x31ade8;},'FJnqU':function(_0x339255,_0x5b56f4){return _0x339255===_0x5b56f4;},'QWZmD':function(_0x568d96,_0xb77e0c){return _0x568d96(_0xb77e0c);},'eLhXz':function(_0x3eb4da,_0x3ffba6){return _0x3eb4da!==_0x3ffba6;},'jRUMi':'zvQOh','JUBNw':_0x478a12(0x5e4,0x61f,0x632,0x632),'kOoyC':function(_0x9f55ca,_0x355302){return _0x9f55ca(_0x355302);}};function _0x268568(_0x3cb00b,_0x14d21e,_0xa52bf9,_0x537f13){return _0x2bd9(_0x14d21e- -0x317,_0x3cb00b);}const {originalTags:_0x11dcae,cleanedText:_0x591c5c}=_0x5c4eaa[_0x268568(-0xec,-0xbb,-0x98,-0x9c)](preprocessPromptForTranslation,_0x349d7e);function _0x478a12(_0x4c4b95,_0x479664,_0x49a71c,_0x385d0d){return _0x2bd9(_0x385d0d-0x3b0,_0x479664);}if(!_0x591c5c){const _0x5914e0={};return _0x5914e0['results']=[],_0x5914e0[_0x268568(-0x7a,-0x8a,-0x85,-0x41)+'t']='',_0x5914e0[_0x478a12(0x5af,0x5cd,0x60c,0x5bc)+'gs']=[],_0x5914e0;}try{if(_0x5c4eaa[_0x268568(-0x116,-0x125,-0x10d,-0x157)](_0x5c4eaa[_0x268568(-0x11d,-0x11e,-0xde,-0x13e)],_0x5c4eaa[_0x478a12(0x5e5,0x5c7,0x631,0x5fb)])){const _0x57ad17=await callTranslation(_0x591c5c),_0x45e39b=_0x5c4eaa[_0x478a12(0x584,0x5d6,0x5c0,0x5c3)](parseTranslationResult,_0x57ad17),_0x21ea5b=combineTranslationResult(_0x11dcae,_0x45e39b),_0x7610f3=_0x5c4eaa[_0x268568(-0xb1,-0xbb,-0xb7,-0xb0)](formatTranslationDisplay,_0x21ea5b),_0x3f011e={};return _0x3f011e['results']=_0x21ea5b,_0x3f011e['displayTex'+'t']=_0x7610f3,_0x3f011e[_0x268568(-0x135,-0x10b,-0x140,-0x10c)+'gs']=_0x11dcae,_0x3f011e;}else{const _0x24402c=_0x550280[_0x2e59ac];if(_0x5c4eaa[_0x478a12(0x587,0x5c5,0x58a,0x5a7)](_0x24402c,'$'))_0x1811f9=!_0x5a6e71,_0x56d31f+=_0x24402c;else{if((_0x5c4eaa[_0x268568(-0xcd,-0x120,-0x12c,-0x140)](_0x24402c,',')||_0x5c4eaa[_0x268568(-0x111,-0x124,-0xee,-0x169)](_0x24402c,'，'))&&!_0x4ca8b1){const _0x54aa50=_0x277af2[_0x268568(-0xd3,-0xd1,-0x123,-0x9c)]();if(_0x54aa50)_0x379382[_0x268568(-0x55,-0x9e,-0xbc,-0x67)](_0x54aa50);_0x404083='';}else _0x2bdb9f+=_0x24402c;}}}catch(_0x11a12d){console['error'](_0x268568(-0x74,-0x86,-0x71,-0x53)+'\x20翻译提示词标签失败'+':',_0x11a12d);throw _0x11a12d;}}export function parseTranslationResult(_0x213767){const _0x329eb0={'dTeLu':function(_0x33abad,_0x50a836){return _0x33abad(_0x50a836);},'oOnur':function(_0x1b3f3d,_0xa97425){return _0x1b3f3d(_0xa97425);},'bDIXw':function(_0x33814b,_0x18504b){return _0x33814b===_0x18504b;},'xtwTv':function(_0x324d6c,_0x1292e6){return _0x324d6c!==_0x1292e6;},'CbLMn':'COZCN','CBpvc':_0x52f3ba(0x33a,0x2f9,0x387,0x370)+_0x35b504(0x147,0x119,0x118,0xd1)+_0x52f3ba(0x323,0x36b,0x2ee,0x336),'KSSKC':function(_0xac6472,_0x3ae2b5){return _0xac6472!==_0x3ae2b5;},'NBWnN':_0x52f3ba(0x2fa,0x2ed,0x2a6,0x32a),'WHajR':_0x52f3ba(0x307,0x338,0x2d1,0x2de),'kqKbR':function(_0x41885b,_0x11cdcb){return _0x41885b>_0x11cdcb;},'YBkYs':function(_0x45d779,_0x41312b){return _0x45d779+_0x41312b;}};if(!_0x213767)return{};try{const _0x25638a=_0x213767[_0x52f3ba(0x333,0x37a,0x36f,0x379)](/\{[\s\S]*\}/);if(_0x25638a){const _0x5e5963=JSON[_0x35b504(0x115,0xe4,0xd2,0x9a)](_0x25638a[0x10b6+-0x3*-0xac7+-0x5*0x9cf]);if(_0x329eb0['bDIXw'](typeof _0x5e5963,_0x35b504(0x141,0x14d,0x13a,0x138))&&_0x329eb0[_0x52f3ba(0x2e7,0x2bb,0x2f6,0x31e)](_0x5e5963,null)){if(_0x329eb0['bDIXw'](_0x35b504(0x124,0x140,0xff,0xfd),_0x329eb0['CbLMn']))return _0x5e5963;else{const _0x39be6e=_0x4daf9d[0xb80+0x72c+0x12ab*-0x1]||'',_0x3637a6=(_0x2a1efe[-0xc1+0x179e+-0x16db]||'')[_0x52f3ba(0x2ef,0x306,0x2f5,0x2e4)](),_0x5d5370=_0xf6c91a[0x19e3+0x600+-0x1fe0]||'',_0x2f9999=_0x456385[0x2*-0x10a2+-0x88*0x3+0x22e0]||'',_0x1b2e4b={'original':_0x8e4bba,'cleaned':_0x3637a6,'prefix':_0x39be6e,'suffix':_0x5d5370,'weight':_0x2f9999,'skip':_0x329eb0[_0x52f3ba(0x2cd,0x2c0,0x297,0x308)](_0x4eafb2,_0x165092)||_0x329eb0['oOnur'](_0x453b29,_0x3637a6)};_0x14ced7['push'](_0x1b2e4b),!_0x1b2e4b[_0x35b504(0x108,0xd6,0xfd,0x10f)]&&_0x3637a6&&(_0x5b035a[_0x35b504(0xfb,0x130,0x12f,0x170)](_0x3637a6),_0x1cbfe6[_0x52f3ba(0x32e,0x327,0x375,0x349)](_0x3637a6[_0x52f3ba(0x2f5,0x2cb,0x2a5,0x2f5)+'e'](),_0x1b2e4b));}}}}catch(_0x48411e){console[_0x35b504(0x7b,0xcd,0xd0,0x9a)](_0x329eb0[_0x35b504(0x12c,0xef,0xc0,0x11c)],_0x48411e['message']);}const _0x3ee4c5=_0x329eb0[_0x35b504(0xef,0xdb,0xe3,0xb0)](String,_0x213767)[_0x35b504(0x10c,0x111,0x11c,0xcd)](/[\r\n]+/g,'\x20')[_0x35b504(0xf2,0x111,0xfc,0x136)](/^[\s"'`]+|[\s"'`]+$/g,'')['trim']();function _0x52f3ba(_0x3a35bc,_0x12c9ff,_0x2b1b98,_0x4c3bbd){return _0x2bd9(_0x3a35bc-0xa9,_0x12c9ff);}const _0x3ab91e=_0x3ee4c5[_0x52f3ba(0x2ed,0x31f,0x2b2,0x302)](/[,，]/)['map'](_0x2fca8f=>_0x2fca8f[_0x52f3ba(0x2ef,0x329,0x2e5,0x32c)]())['filter'](Boolean),_0x27ee50={};function _0x35b504(_0x24f9b1,_0x1f6f2b,_0x38687a,_0x24adbe){return _0x2bd9(_0x1f6f2b- -0x149,_0x38687a);}for(const _0x4ccdcb of _0x3ab91e){if(_0x329eb0[_0x52f3ba(0x2f7,0x321,0x2bd,0x2bc)](_0x329eb0['NBWnN'],_0x329eb0[_0x35b504(0xdb,0xdf,0x113,0xd8)])){const _0x1df058=_0x4ccdcb[_0x52f3ba(0x2f3,0x2cb,0x2d5,0x2cc)]('\x5c');if(_0x329eb0[_0x52f3ba(0x2e5,0x2d9,0x311,0x303)](_0x1df058,-0xe91+-0x1*-0x2309+-0x1478)){const _0x4de3d7=_0x4ccdcb[_0x35b504(0x110,0xd5,0x123,0xc2)](-0xbef+0x626+0x5c9,_0x1df058)[_0x35b504(0xe1,0xfd,0x140,0x14b)](),_0x35ff23=_0x4ccdcb[_0x35b504(0x11f,0xd5,0x9c,0xa7)](_0x329eb0[_0x52f3ba(0x2a5,0x2f6,0x2fa,0x2ea)](_0x1df058,0x12ba+0x117c+0x2c9*-0xd))[_0x35b504(0xc3,0xfd,0xb8,0xaf)]();if(_0x4de3d7)_0x27ee50[_0x4de3d7]=_0x35ff23;}}else _0x14523d+=_0x5cb47e;}return _0x27ee50;}function _0x52f7(){const _0x5470b2=['ChjVBxb0','A09VEum','vfHJD08','t2zbEvO','D2fYBG','B1zWsu0','s3j5swu','Dgvztwi','C2TPChbLza','EufoyuK','mZu2odiWCfDhyvns','zw50CMLLCW','C2XPy2u','C2TPCa','ioIVT+AXGUE/U+IVKsbmte0G','CMfUzg9T','odvZsMXYCM4','C3rYAw5NAwz5','zfrLthu','ufjptvbux1jfuW','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','ndmWntG1nZbUs1H5BwS','v0HHALi','EwXZq1e','BMT6uNy','BgvUz3rO','CMfUzg9Tvvvjra','CgfYC2u','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','qwjVCNrfCNjVCG','C29Tzq','z2rMDK4','BxLVz0q','CKvMDK8','57+76k+rieXmtsdMIAFOOyZOTOu','zMLSDgvY','zw5LCG','DhjHBNnSyxrPBW','q0jWDMm','zuLMz0u','57+76k+r5AsX6lsLoG','u1DKrKi','A3flyLi','rLnXENO','Ehr3vhy','qvrjt05FuKvtua','ndy5nJGXofbAwez0wa','keLeoIa','Au5SC1K','BLzJtuS','C3bSAxq','whrdsey','DhjPBq','mtu1mZq2mfDRtefSza','Dg9tDhjPBMC','Bg50uMS','Aw5KzxHpzG','sLvctNC','Dg9mB3DLCKnHCW','vuT1Dxu','s1nts0m','BwvZC2fNzq','ieXmtsdORR7NVA7POBxPNAi','rKvsvvi','B21Wt3q','uNLLC0m','zw1PDa','C0XVDKK','CMvZDwX0CW','zxjYB3i','C2vHCMnO','AMzdugC','CMvWBgfJzq','t05trq','uvDABuq','z2fVy2K','zKLqBwe','tffwAgG','ufjptvbux1jfuq','v0LMBhq','iePtt07OP6pMNPdLPlhOTkxVViW','yLjts3q','A0HUDhG','q0z4zxy','nZiZndCYogDXALHuyW','qvrjt05Fr0vuxW','DwjPEe4','ue9ou0u','DgvZDa','wMHjA1O','suXVu24','swzwvxK','tuz5rxq','u3vby28','zevlrNe','uNjiww4','rNrzwu8','q2jpq1C','qxf3z2q','m3jTsxnQCW','CMvZDwX0','BMfTzq','r0HOBLy','ChvZAa','5BcD6k+v5PEN5Qc85BYpoG','CM9Szq','zwLsBe4','BKT5CfC','C3vIC3rYAw5N','z2XeCeS','iow3SUAuTUwiSoE/U+IVKsbmte0','AxnbCNjHEq','vxHRrNy','yNLpzLa','ndKXmKzZrfrXwq','C2v0','DKvLBxq','qxfVBem','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','q09Aq04','Bwf0y2G','vuvtva','DM5vC2u','zgLZCgXHEvrLEa','y29UC3rYDwn0BW','tMfzsgK','C3rYAw5N','C3qTy2HHDhu4oG','Bg9N','AwLtEwW','icHjrdOG','teXnx1rsqu5tta','B2jQzwn0','EhDwvLK','uhjArwq','vfvcsLu','nde0nZG3rMzsrfPJ','zuXOwhO','rKPUCvu','sfbKrKG','DuXlEM0','DxnLCG','DLDbzuK','kcGOlISPkYKRkq','ALjvtwK','uhrqENu','AeTIAvK','wujRwxm','s2ziqLy','uerewKW','57+76k+r5AsX6lsLoIa','B3jPz2LUywW','C3vJy2vZCW','y2XLyw5Lza','ufnRBfG','BwfW','BM93','BeXHz20','Cg1ZvMi','BxpVViK','r29TCLK','oxzuq0zytG','y29UDgvUDa','B3jPz2LUywXuyq','BMjIvKm','ioAjP+IHJoE7K+AENcaOsuq6','tM51DMq','vwryBxi','CMvTB3zLtgLZDa'];_0x52f7=function(){return _0x5470b2;};return _0x52f7();}function generateRequestId(){const _0xbd6f71={};_0xbd6f71[_0x43aa03(0x60f,0x602,0x5f0,0x60e)]=function(_0x14767d,_0x19f25e){return _0x14767d+_0x19f25e;};const _0x481ecb=_0xbd6f71;function _0x43aa03(_0x47b742,_0x29bbd5,_0x53ee05,_0x4f9a8c){return _0x2bd9(_0x53ee05-0x3a3,_0x47b742);}function _0x4f39cf(_0x431e6d,_0x5e6088,_0x36ebf9,_0x3b41b3){return _0x2bd9(_0x5e6088-0x1ff,_0x431e6d);}if(crypto&&crypto[_0x43aa03(0x618,0x592,0x5cf,0x5bc)])return crypto['randomUUID']();return _0x481ecb[_0x43aa03(0x629,0x620,0x5f0,0x5fe)](Date[_0x4f39cf(0x449,0x404,0x446,0x446)]()['toString'](-0x274+-0x118e+-0x1*-0x1426),Math[_0x43aa03(0x5dd,0x570,0x5c4,0x5f5)]()[_0x4f39cf(0x46e,0x447,0x492,0x49b)](0x1*0xb06+-0x2*0x103f+0x159c)[_0x43aa03(0x614,0x62e,0x621,0x5d5)](-0xc6+0x170b+-0x8b*0x29));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x2ec06b(_0x2987e5,_0x4f46cc,_0x1f15a2,_0x2494e7){return _0x2bd9(_0x4f46cc- -0x1,_0x1f15a2);}const _0x406317={'GomrY':function(_0x30ae70,_0xf233f0){return _0x30ae70(_0xf233f0);},'MFyEt':_0x2ec06b(0x257,0x239,0x24a,0x265),'gaoci':function(_0x1bd7e2,_0x5a6ffc){return _0x1bd7e2!==_0x5a6ffc;},'nbbVC':_0x2ec06b(0x230,0x26e,0x283,0x242),'iiSyl':function(_0x3cb521){return _0x3cb521();}};function _0x54f928(_0x58785a,_0x1be0bd,_0x451759,_0x273e8a){return _0x2bd9(_0x1be0bd- -0x17d,_0x58785a);}return new Promise((_0x2d16ef,_0xf44444)=>{function _0x57cf86(_0x4a8f5d,_0xb42a42,_0x1f02b7,_0x571e24){return _0x2ec06b(_0x4a8f5d-0x12f,_0xb42a42-0x269,_0x4a8f5d,_0x571e24-0x146);}const _0x573ce5={'ZhIkZ':function(_0x546f8a,_0x53657c){return _0x546f8a(_0x53657c);}};function _0x3b3fcb(_0x496282,_0x49cc64,_0x5b80e0,_0x1a3805){return _0x2ec06b(_0x496282-0xaf,_0x5b80e0- -0x2ec,_0x496282,_0x1a3805-0x56);}if(_0x406317[_0x3b3fcb(-0x7a,-0x8d,-0x90,-0x9c)](_0x406317[_0x3b3fcb(-0x123,-0x133,-0xe0,-0xee)],_0x406317[_0x57cf86(0x458,0x475,0x4b2,0x42d)])){_0x406317[_0x3b3fcb(-0x116,-0x108,-0xe4,-0xcf)](_0x198b40,_0x57cf86(0x45c,0x467,0x442,0x43b)+_0x5c2ada['message']),_0x50e74c['error'](_0x406317[_0x57cf86(0x4b3,0x4d6,0x49a,0x51f)],_0x339617);throw _0x14545e;}else{const _0x1b32cd=_0x406317[_0x57cf86(0x4f1,0x4fb,0x4ff,0x4bd)](generateRequestId);console[_0x57cf86(0x534,0x4fa,0x4e6,0x51d)](_0x3b3fcb(-0x56,-0x1a,-0x5c,-0x8b)+_0x57cf86(0x454,0x496,0x479,0x441)+'\x20(ID:\x20'+_0x1b32cd+')');const _0x1775d6=_0x3871e7=>{if(_0x3871e7['id']!==_0x1b32cd)return;function _0x35d5b1(_0x253eac,_0x3eae96,_0x2cf7b0,_0x331b8e){return _0x57cf86(_0x3eae96,_0x2cf7b0- -0x2cb,_0x2cf7b0-0x1a3,_0x331b8e-0x1ad);}function _0x4d2f00(_0x1f2e95,_0x20d1ec,_0xbe9022,_0x194a23){return _0x57cf86(_0xbe9022,_0x194a23- -0x2dc,_0xbe9022-0x66,_0x194a23-0x1a5);}eventSource[_0x35d5b1(0x1ac,0x1c3,0x1ae,0x1d7)+_0x4d2f00(0x1dc,0x17d,0x1a1,0x1c2)](eventNames['LLM_TRANSL'+_0x35d5b1(0x255,0x23d,0x204,0x247)+_0x4d2f00(0x193,0x1d9,0x173,0x1b1)+_0x35d5b1(0x1d2,0x1de,0x206,0x1df)],_0x1775d6);const {prompt:_0x35be61}=_0x3871e7;console[_0x35d5b1(0x252,0x200,0x22f,0x256)]('st-chatu8:'+'\x20已获取翻译提示词\x20'+_0x35d5b1(0x217,0x22d,0x1de,0x219)+_0x1b32cd+'):',_0x35be61),_0x2d16ef(_0x35be61);};eventSource['on'](eventNames[_0x57cf86(0x4b8,0x4fd,0x4ba,0x4b4)+_0x57cf86(0x505,0x4cf,0x47f,0x489)+_0x3b3fcb(-0xde,-0xe6,-0xc8,-0x99)+_0x3b3fcb(-0xcf,-0x35,-0x84,-0x7c)],_0x1775d6);const _0x54fa06={};_0x54fa06['id']=_0x1b32cd,eventSource[_0x3b3fcb(-0xd2,-0x60,-0x99,-0xe0)](eventNames[_0x3b3fcb(-0x6a,-0x8e,-0x58,-0x13)+_0x57cf86(0x489,0x4cf,0x505,0x51f)+'PROMPT_REQ'+_0x57cf86(0x518,0x4f3,0x537,0x4a9)],_0x54fa06),setTimeout(()=>{eventSource[_0x75259a(-0x8f,-0x39,-0x6c,-0x27)+_0x4029fc(0x4bb,0x49a,0x4e3,0x4cb)](eventNames[_0x75259a(-0x2e,0x16,0x18,0x46)+_0x75259a(0x20,-0x35,-0x16,-0x1d)+_0x75259a(-0x50,-0x7f,-0x58,-0x28)+_0x4029fc(0x4ee,0x4fe,0x4f8,0x4c5)],_0x1775d6);function _0x4029fc(_0x1db2f0,_0x43595a,_0x20e85e,_0x439a97){return _0x57cf86(_0x43595a,_0x1db2f0-0x1d,_0x20e85e-0x14c,_0x439a97-0x188);}function _0x75259a(_0x569166,_0x55f64c,_0x2c53ef,_0x4e9ee1){return _0x3b3fcb(_0x569166,_0x55f64c-0x116,_0x2c53ef-0x70,_0x4e9ee1-0x7f);}_0x573ce5[_0x75259a(0x2e,-0x14,-0x12,0x1)](_0xf44444,new Error(_0x75259a(-0x99,-0xa9,-0x57,-0x34)));},0x1*0xdad+0x9*-0x408+0x3dab*0x1);}});}export function LLM_TRANSLATION(_0x2711d4,{timeoutMs:timeoutMs=0x1*-0x5a20+-0x1378*0x13+-0x2b668*-0x1}={}){const _0x4aa8ee={'CbOCW':function(_0x40e492,_0x4c9b70){return _0x40e492===_0x4c9b70;},'PSklX':'eoqHZ','PrZEd':_0x184da6(0x20f,0x1d8,0x23f,0x1f9),'aogzA':function(_0x25789a,_0x4be354){return _0x25789a(_0x4be354);},'oVpIM':function(_0x338c97,_0xd3288f){return _0x338c97(_0xd3288f);},'qebqm':function(_0x4a83fc){return _0x4a83fc();},'ILoSn':_0x184da6(0x237,0x272,0x288,0x202),'dEKFq':function(_0x13f9d2){return _0x13f9d2();}};function _0x2a7d78(_0x470a89,_0x2a6c3c,_0x4f97fc,_0x2311d1){return _0x2bd9(_0x470a89-0x1b6,_0x2311d1);}function _0x184da6(_0x39a50b,_0x3351e1,_0x4eeb18,_0x27eb72){return _0x2bd9(_0x39a50b-0x8,_0x3351e1);}return new Promise((_0xaf43b4,_0x4c16d5)=>{function _0x28d600(_0x5c70fe,_0x4745f3,_0x23a32d,_0x1a3453){return _0x184da6(_0x4745f3-0x7c,_0x1a3453,_0x23a32d-0x7c,_0x1a3453-0x18);}const _0x4a5b79={'eIfgE':function(_0x8504c,_0x517602){function _0x16314c(_0x1a43c6,_0x3e04de,_0x1539a4,_0x157454){return _0x2bd9(_0x157454-0xae,_0x3e04de);}return _0x4aa8ee[_0x16314c(0x2f2,0x2e6,0x28c,0x2c5)](_0x8504c,_0x517602);},'LOYNn':function(_0x2469ce){return _0x4aa8ee['qebqm'](_0x2469ce);},'UdXmr':_0x4aa8ee[_0x1c9198(0x558,0x54f,0x50d,0x53f)],'FEvFb':function(_0x929c1c,_0x2066fb){return _0x929c1c(_0x2066fb);}},_0x51eab5=_0x4aa8ee[_0x1c9198(0x57d,0x50f,0x594,0x543)](generateRequestId);console['log'](_0x28d600(0x34a,0x315,0x2e1,0x2e7)+_0x1c9198(0x4a7,0x4ff,0x512,0x4f3)+_0x1c9198(0x52b,0x532,0x55c,0x514)+_0x51eab5+')');let _0xca0e2d=null;const _0x447497=()=>{function _0x5d4e54(_0x189c66,_0x31c650,_0x5ebef0,_0x117ad5){return _0x1c9198(_0x117ad5,_0x31c650-0x172,_0x5ebef0-0x9c,_0x31c650-0x49);}eventSource['removeList'+_0x5d4e54(0x573,0x552,0x519,0x558)](eventNames[_0x5d4e54(0x563,0x5b1,0x5c9,0x5c0)+_0x5d4e54(0x527,0x55b,0x5ac,0x517)+'ONSE'],_0x54c004);function _0x407e77(_0x451f91,_0x34b88f,_0x54fd9f,_0x4f5c2d){return _0x1c9198(_0x451f91,_0x34b88f-0x107,_0x54fd9f-0x7c,_0x4f5c2d- -0x190);}if(_0xca0e2d)_0x4a5b79[_0x5d4e54(0x590,0x555,0x569,0x512)](clearTimeout,_0xca0e2d);},_0x54c004=_0x1ecf9f=>{if(_0x1ecf9f['id']!==_0x51eab5)return;_0x4a5b79['LOYNn'](_0x447497);function _0x4bc8c1(_0xd68105,_0x957000,_0x5aefd0,_0xd2711c){return _0x28d600(_0xd68105-0x23,_0x957000- -0x3d8,_0x5aefd0-0x42,_0x5aefd0);}console[_0x4bc8c1(-0xed,-0xc2,-0x7d,-0x73)]('st-chatu8:'+_0x1b3c4b(0x72,0x8b,0x9b,0x78)+_0x4bc8c1(-0x163,-0x146,-0x163,-0x192)+'\x20'+_0x51eab5+'):',_0x1ecf9f);function _0x1b3c4b(_0x22e439,_0x36d9b3,_0x1beddc,_0x588617){return _0x1c9198(_0x22e439,_0x36d9b3-0x1d6,_0x1beddc-0xea,_0x588617- -0x4db);}if(_0x1ecf9f[_0x4bc8c1(-0x14e,-0x153,-0x14e,-0x178)])_0xaf43b4(_0x1ecf9f['result']);else{if(_0x1ecf9f[_0x4bc8c1(-0x132,-0xfd,-0xc4,-0xf7)]&&_0x1ecf9f[_0x4bc8c1(-0x107,-0xfd,-0xc0,-0xe6)][_0x1b3c4b(0x44,0x66,0x2c,0x6f)]===_0x4a5b79['UdXmr']){const _0x20a7fb=new Error(_0x1ecf9f[_0x1b3c4b(0x8,0x30,0xa1,0x4f)][_0x1b3c4b(0x65,0x2,0x8f,0x47)]);_0x20a7fb[_0x4bc8c1(-0xad,-0xdd,-0xc5,-0x128)]=_0x4a5b79[_0x1b3c4b(-0x14,-0x5,0x8,0x8)],_0x4a5b79['FEvFb'](_0x4c16d5,_0x20a7fb);}else _0x4c16d5(new Error(_0x1ecf9f['result']));}};eventSource['on'](eventNames[_0x1c9198(0x544,0x525,0x535,0x568)+'ATION_RESP'+_0x28d600(0x321,0x2df,0x2c6,0x2dc)],_0x54c004);const _0x19634f={};_0x19634f[_0x28d600(0x2a9,0x296,0x2da,0x2bf)]=_0x2711d4,_0x19634f['id']=_0x51eab5,eventSource[_0x28d600(0x29f,0x2d8,0x302,0x2c6)](eventNames[_0x1c9198(0x538,0x59f,0x5a9,0x568)+'ATION_REQU'+'EST'],_0x19634f);function _0x1c9198(_0x2e4c52,_0x2f6e36,_0x5cecd2,_0x5557dd){return _0x184da6(_0x5557dd-0x2cb,_0x2e4c52,_0x5cecd2-0x1dc,_0x5557dd-0xbf);}_0xca0e2d=setTimeout(()=>{function _0x23d05b(_0x287314,_0x333e39,_0x3d9d3a,_0x14b7b7){return _0x28d600(_0x287314-0xd3,_0x333e39-0x36,_0x3d9d3a-0xc7,_0x14b7b7);}function _0x89f629(_0x46e319,_0x310ba9,_0x2e7a12,_0x148dc5){return _0x1c9198(_0x46e319,_0x310ba9-0x112,_0x2e7a12-0x1df,_0x310ba9- -0x2f);}if(_0x4aa8ee[_0x23d05b(0x312,0x32d,0x323,0x330)](_0x4aa8ee[_0x89f629(0x498,0x4a7,0x495,0x470)],_0x4aa8ee[_0x23d05b(0x322,0x352,0x31f,0x319)])){if(_0x1ed8f1&&_0xe4ca2a[_0x89f629(0x490,0x4d0,0x4ab,0x4a6)])return _0x21daad['randomUUID']();return _0x1c1ea6[_0x89f629(0x46d,0x4a9,0x4be,0x4eb)]()[_0x89f629(0x4ba,0x4ec,0x4c7,0x4ba)](-0xca*-0x13+0x1099+-0x1*0x1f73)+_0x1c2564[_0x89f629(0x484,0x4c5,0x4b0,0x50e)]()[_0x23d05b(0x336,0x302,0x2ed,0x2c4)](-0x1c86+-0x1940+0x35ea)[_0x23d05b(0x34d,0x338,0x353,0x34d)](-0x9ab+-0x1*0x14f+0xafc);}else _0x447497(),_0x4aa8ee['aogzA'](_0x4c16d5,new Error(_0x23d05b(0x2f8,0x2ee,0x2ae,0x2a2)+'时（'+timeoutMs+_0x89f629(0x4c5,0x4ac,0x46b,0x49d)));},timeoutMs);});}export async function callTranslation(_0x300647){function _0x3ce320(_0x5be394,_0x1a40a6,_0x5db927,_0x12b363){return _0x2bd9(_0x1a40a6-0x2a7,_0x5db927);}const _0x19a014={'vEemt':_0x224a9e(0x453,0x43d,0x458,0x449),'eiRlN':function(_0x25e7e3,_0x32eb1c){return _0x25e7e3(_0x32eb1c);},'lntRk':function(_0x137a89,_0x64ec02,_0x29cd24){return _0x137a89(_0x64ec02,_0x29cd24);},'qzfHp':'translatio'+'n','gdfvN':function(_0x490945,_0x46e445){return _0x490945||_0x46e445;},'OfAyZ':function(_0x1b086a,_0x32950d){return _0x1b086a(_0x32950d);},'hKbiY':function(_0x397094,_0x3e0247){return _0x397094(_0x3e0247);},'iNlsY':function(_0x2aad8d,_0x5ab176){return _0x2aad8d!==_0x5ab176;},'NaYHi':_0x224a9e(0x47d,0x482,0x478,0x4c0),'CFxev':function(_0x440fdf,_0x456b82){return _0x440fdf(_0x456b82);},'KryIe':_0x224a9e(0x45e,0x43c,0x49c,0x476)};function _0x224a9e(_0x3d1fe7,_0x2f79d9,_0x36c3ca,_0x11734a){return _0x2bd9(_0x3d1fe7-0x224,_0x36c3ca);}try{let _0x537948=_0x19a014[_0x3ce320(0x4f5,0x4f0,0x4ad,0x522)](buildPromptForRequestType,_0x19a014['qzfHp'],_0x19a014[_0x224a9e(0x455,0x49f,0x44c,0x44a)](_0x300647,''));_0x537948=_0x19a014[_0x3ce320(0x4e7,0x523,0x55e,0x570)](mergeAdjacentMessages,_0x537948);const _0x385c17={};_0x385c17[_0x3ce320(0x560,0x522,0x51c,0x558)]=_0x3ce320(0x4c8,0x49d,0x48c,0x457),_0x385c17[_0x224a9e(0x42f,0x42c,0x433,0x431)]=_0x300647||'';const _0x7ddbbf=[..._0x537948,_0x385c17];_0x19a014[_0x3ce320(0x498,0x4bc,0x505,0x4e6)](updateCombinedPrompt,_0x7ddbbf);const _0x100138=await _0x19a014[_0x3ce320(0x4bf,0x4a2,0x4ad,0x4c6)](LLM_TRANSLATION,_0x7ddbbf);return _0x100138;}catch(_0x3e77ba){if(_0x19a014[_0x3ce320(0x4ab,0x4e9,0x4b5,0x4bd)](_0x19a014['NaYHi'],_0x19a014[_0x3ce320(0x581,0x536,0x56c,0x570)])){const _0x361e07=new _0x4267d1(_0x289c44[_0x224a9e(0x47b,0x495,0x498,0x4a3)][_0x224a9e(0x473,0x432,0x485,0x480)]);_0x361e07[_0x3ce320(0x4f7,0x51e,0x549,0x50d)]=_0x19a014[_0x3ce320(0x514,0x52d,0x56e,0x4f0)],_0x19a014[_0x3ce320(0x52d,0x523,0x525,0x4d8)](_0x16880e,_0x361e07);}else{_0x19a014[_0x3ce320(0x4e8,0x50c,0x551,0x51b)](addLog,'翻译失败:\x20'+_0x3e77ba[_0x3ce320(0x4d0,0x4f6,0x4fc,0x4ee)]),console['error'](_0x19a014[_0x3ce320(0x4f0,0x4bf,0x47d,0x4ef)],_0x3e77ba);throw _0x3e77ba;}}}let isAiInitialized=![];export function initAiSettings(_0x229f4e){function _0xa014ae(_0x2dbe69,_0x43647b,_0x1d6d9b,_0x147591){return _0x2bd9(_0x1d6d9b-0x3d3,_0x147591);}function _0x2ac788(_0x34914a,_0x22c824,_0x32387c,_0x279b3d){return _0x2bd9(_0x34914a- -0x217,_0x22c824);}!isAiInitialized&&(console[_0x2ac788(0x7b,0x51,0x4a,0xb9)](_0x2ac788(0x7a,0x80,0x74,0x7c)+'\x20AI\x20设置已统一到'+_0x2ac788(0x39,0x25,0x5d,0x71)),isAiInitialized=!![]);}