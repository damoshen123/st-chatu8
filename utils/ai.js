function _0xc304(_0x324c41,_0x216733){_0x324c41=_0x324c41-(0x9a+0x618+-0x4ea);const _0x10081e=_0x306f();let _0x9a34e8=_0x10081e[_0x324c41];if(_0xc304['YCBuRV']===undefined){var _0x2cc8f8=function(_0xb3a210){const _0x543795='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2fcbd3='',_0x1d4447='',_0x3515cf=_0x2fcbd3+_0x2cc8f8;for(let _0x5b4638=0x1*0x9d+-0x1d16+0x1c79,_0x3a9f6d,_0x2eb49a,_0x348229=0x20b0+0x13be+-0x346e;_0x2eb49a=_0xb3a210['charAt'](_0x348229++);~_0x2eb49a&&(_0x3a9f6d=_0x5b4638%(-0x1981+0xe80+-0xd*-0xd9)?_0x3a9f6d*(-0x2104*0x1+0x820*0x1+0xc92*0x2)+_0x2eb49a:_0x2eb49a,_0x5b4638++%(0x604+0x1bca+0x6c2*-0x5))?_0x2fcbd3+=_0x3515cf['charCodeAt'](_0x348229+(0x74f*0x3+-0x208c+0xaa9))-(-0x14f3+0xbcf+0x92e)!==0x12e0+-0x133+-0x19*0xb5?String['fromCharCode'](-0x15ce*0x1+-0x11+0x16de&_0x3a9f6d>>(-(0x2472+-0xb*-0x7b+-0x1*0x29b9)*_0x5b4638&-0x265*-0x4+-0xce5+0xab*0x5)):_0x5b4638:-0x1*-0x20fd+-0x2*-0xc25+0x155*-0x2b){_0x2eb49a=_0x543795['indexOf'](_0x2eb49a);}for(let _0x42610e=0x1f8c+0x6c1+-0x264d,_0x4cbcaa=_0x2fcbd3['length'];_0x42610e<_0x4cbcaa;_0x42610e++){_0x1d4447+='%'+('00'+_0x2fcbd3['charCodeAt'](_0x42610e)['toString'](-0x1567+0x1c71+-0x6fa*0x1))['slice'](-(0x759+0x3fa*0x7+-0x232d));}return decodeURIComponent(_0x1d4447);};_0xc304['LaEOMV']=_0x2cc8f8,_0xc304['FZaimF']={},_0xc304['YCBuRV']=!![];}const _0x53d107=_0x10081e[0x8ce+-0x7c*0xb+-0x1*0x37a],_0x4fc502=_0x324c41+_0x53d107,_0x30f184=_0xc304['FZaimF'][_0x4fc502];if(!_0x30f184){const _0x33975c=function(_0x64afb4){this['HHLsID']=_0x64afb4,this['nGaQDP']=[-0x446+-0x502*0x4+0x184f,0xb57+0x32*0x9+-0xd19,0x11ca+-0x3*0x45b+-0x193*0x3],this['xZbVxO']=function(){return'newState';},this['kprUpW']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['seCFnT']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x33975c['prototype']['wgdVcO']=function(){const _0x44cb1d=new RegExp(this['kprUpW']+this['seCFnT']),_0x1482e0=_0x44cb1d['test'](this['xZbVxO']['toString']())?--this['nGaQDP'][0x804+0x220+-0xa23]:--this['nGaQDP'][0x2*-0xda6+0x55*-0x13+0x219b];return this['MEPrDN'](_0x1482e0);},_0x33975c['prototype']['MEPrDN']=function(_0xbf820f){if(!Boolean(~_0xbf820f))return _0xbf820f;return this['OrIsMS'](this['HHLsID']);},_0x33975c['prototype']['OrIsMS']=function(_0x506597){for(let _0x16fd86=0x1d*0x2a+0x12c+0xfd*-0x6,_0x6cfaf7=this['nGaQDP']['length'];_0x16fd86<_0x6cfaf7;_0x16fd86++){this['nGaQDP']['push'](Math['round'](Math['random']())),_0x6cfaf7=this['nGaQDP']['length'];}return _0x506597(this['nGaQDP'][-0x1713+-0x5*-0x6e6+-0x1*0xb6b]);},new _0x33975c(_0xc304)['wgdVcO'](),_0x9a34e8=_0xc304['LaEOMV'](_0x9a34e8),_0xc304['FZaimF'][_0x4fc502]=_0x9a34e8;}else _0x9a34e8=_0x30f184;return _0x9a34e8;}(function(_0x2d8cf0,_0x346060){function _0x3ce6be(_0x17cee0,_0x13c2a9,_0x2a4725,_0x54158b){return _0xc304(_0x2a4725-0x311,_0x17cee0);}function _0x55802d(_0x2670ab,_0x42a25b,_0x143be3,_0x5831d7){return _0xc304(_0x2670ab-0x3b7,_0x143be3);}const _0x886e20=_0x2d8cf0();while(!![]){try{const _0x452bbb=-parseInt(_0x3ce6be(0x4e6,0x4dd,0x508,0x501))/(0x885+-0x139b+0xb17)+parseInt(_0x3ce6be(0x57b,0x4e4,0x521,0x577))/(0x126+0x1b1*0x7+-0xcfb)+parseInt(_0x3ce6be(0x5a6,0x5b1,0x587,0x57c))/(0x1db*-0x4+0xe8*0x29+-0x1db9)*(-parseInt(_0x3ce6be(0x4f1,0x4dc,0x501,0x50d))/(-0x10e2+0xad2+0x614))+parseInt(_0x3ce6be(0x571,0x529,0x585,0x5df))/(-0x2e*-0x8b+0x2483+0x2*-0x1ebc)*(parseInt(_0x3ce6be(0x4eb,0x4fc,0x50a,0x557))/(0x8ec+0x2e*0x43+0x43*-0x50))+-parseInt(_0x3ce6be(0x4eb,0x49e,0x4fc,0x4b4))/(-0x172a+-0xd0*0x1b+-0x2d21*-0x1)*(-parseInt(_0x55802d(0x614,0x635,0x5ca,0x64f))/(0x1515+-0x223*-0xc+-0x1*0x2eb1))+-parseInt(_0x3ce6be(0x570,0x571,0x550,0x538))/(0x1*-0x1cf7+-0xc*0x150+0x2cc0)+parseInt(_0x55802d(0x586,0x5bc,0x53f,0x5e1))/(0x1*0x26f3+-0x15*-0x180+-0x203*0x23)*(parseInt(_0x3ce6be(0x4df,0x502,0x4e5,0x4b2))/(0xac7+0x40*0x40+0x1abc*-0x1));if(_0x452bbb===_0x346060)break;else _0x886e20['push'](_0x886e20['shift']());}catch(_0x3ed856){_0x886e20['push'](_0x886e20['shift']());}}}(_0x306f,0x11adc+0xb2528+-0x382*0x122));const _0x14c783=(function(){let _0x149e61=!![];return function(_0x51be12,_0x4fd390){const _0x5b1adc=_0x149e61?function(){function _0x54f17e(_0x352df6,_0xa594cf,_0x292e57,_0x4b2c13){return _0xc304(_0x352df6- -0x2cb,_0x292e57);}if(_0x4fd390){const _0x43ea19=_0x4fd390[_0x54f17e(-0x4a,-0x1d,-0x1d,-0x64)](_0x51be12,arguments);return _0x4fd390=null,_0x43ea19;}}:function(){};return _0x149e61=![],_0x5b1adc;};}()),_0x159a68=_0x14c783(this,function(){function _0x394125(_0x92700d,_0x34f5ce,_0x56b799,_0x2b6b7b){return _0xc304(_0x2b6b7b- -0x1c1,_0x34f5ce);}const _0xad6ead={};function _0x4ce4f9(_0x2a169d,_0x1341d4,_0x3bc5e2,_0xb94988){return _0xc304(_0x1341d4-0x1ec,_0xb94988);}_0xad6ead[_0x394125(0x9d,0xf4,0xc5,0x9d)]=_0x394125(0xa5,0xa9,0x19,0x59)+'+$';const _0x414932=_0xad6ead;return _0x159a68[_0x4ce4f9(0x492,0x437,0x418,0x414)]()[_0x394125(0xd,-0x2a,0x64,0x28)](_0x394125(0x1f,0x3d,0x1d,0x59)+'+$')[_0x4ce4f9(0x471,0x437,0x3da,0x3fb)]()[_0x394125(-0xc,0x54,0x49,0x1f)+'r'](_0x159a68)['search'](_0x414932['eGHAz']);});_0x159a68();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;function _0x306f(){const _0x5de485=['ELvhwMC','yxbWBhK','sMvJwuy','wwf2wwi','BgvUz3rO','DunJDgy','rvH0t1m','t05trq','tg5MBgC','CMvWBgfJzq','qvrjt05Fr0vuxW','C01xEuW','mtbwExnKuwK','rvnu','sg15Due','t2f3vu8','tNfAzwi','ntm5nZKWouTfrvDkra','q3rcB2K','vuvtva','C2v0','B3jPz2LUywW','AM9PBG','zfbxB3u','ChjVBxb0','C3rYAw5NAwz5','C3qTy2HHDhu4oG','5BcD6k+v5PEN5Qc85BYpoG','Eu52B2S','y29UC3rYDwn0BW','BxrUs2G','DLHIu0i','A3jrs0K','BMfTzq','AMncD3i','CMfUzg9Tvvvjra','BNHOAKW','wKrpugq','C2vHCMnO','ufjptvbux1jfuq','mJHtEenSA2G','C2TPCa','DhjPBq','wMPzEgG','r2D1CgO','mJiYoejeAfHQqW','CMvZDwX0CW','EvLRugK','D1LtC2K','wfLvzhi','CMvZDwX0','DgvZDa','mJq1nZK3rMrZzw1x','CNLZu0m','nLPuA2fOCW','zKTmDKu','zLPtDvC','zw50CMLLCW','yxjnCu0','A2rcqNO','rMXgzeO','Bwf0y2G','vhHcthi','C3vIC3rYAw5N','uMzMqMC','AxLHD3G','uNPQAgK','A25WuKK','C3bSAxq','qK1bv2G','CM5OuhG','vgvdr1C','AezRshq','zNHiDLu','rfjUuMK','B3jPz2LUywXuyq','AKnXrNu','mtG2ndC4BejjC0Hs','qMXOAMm','teHpvK4','ioIVT+AXGUE/U+IVKsbmte0G','BxpVViK','Dg9mB3DLCKnHCW','rNLAwKG','icHjrdOG','zgTYy1i','CgfYC2u','kcGOlISPkYKRkq','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','ENj6rvy','CwjHELm','C2TPChbLza','tu56s08','C3rYAw5N','57+76k+rieXmtsdMIAFOOyZOTOu','CLb2DLa','t050vKS','wNDZAfq','qw5wCMO','t2XJzvG','qwniCxq','z3LVz2C','yMDKywO','B2jQzwn0','rwX5Eum','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','CMvTB3zLtgLZDa','AvDjywu','qwjVCNrfCNjVCG','zxjYB3i','wxPsC0K','DxnLCG','uhHQA2i','ieXmtsdORR7NVA7POBxPNAi','BwfW','u0vSC08','r29lA08','qvrjt05FuKvtua','57+76k+r5AsX6lsLoG','iePtt07OP6pMNPdLPlhOTkxVViW','ChvZAa','rNHRqvi','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','r3vqAeq','ndy4ndi0oeXJuvjYyG','uKLACfG','BgLvDwC','s0PmCKK','ufjptvbux1jfuW','C3vJy2vZCW','tw5myuG','AffNBLu','zgLZCgXHEvrLEa','C29Tzq','DLLwzKq','sNfyB3K','Dg9tDhjPBMC','BfHvwLy','BwvZC2fNzq','q3bwvva','CgPcvu0','sgzpC0y','Aw5KzxHpzG','zKrpCgG','ue9ou0u','zhbQEMy','EfbRA3i','Du1KyxK','wu1pqK8','vLfTC1O','BgTcwxO','zMLSDgvY','D0Perue','DeDMr3a','mZC0mdbWzK1PALq','zuDiqxO','iow3SUAuTUwiSoE/U+IVKsbmte0','CNDIvLO','iefjioIUVUE9RUw3SUE7N+s4GowiSa','AhLivKO','ioAjP+IHJoE7K+AENcaOsuq6','keLeoIa','C2XPy2u','svD6q2S','zw1PDa','sMLZzvu','q1jKD3q','rgv0twu','q0jwDvC','D2fYBG','AxnbCNjHEq','Bg9N','y2XLyw5Lza','vNDvA1y','suTgwgm','s0DPBge','zw5LCG','ndm5nJe5mgfgDLDvta','y1rcu0C','otmZBePeswnW','CxPAvhu','teXnx1rsqu5tta','AgnpB2K','Dej0z2q','DhjHBNnSyxrPBW','B1vwDui','s0f1qNO','q0vgCNm','DeLJA3a'];_0x306f=function(){return _0x5de485;};return _0x306f();}const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x23a622){function _0x507e39(_0x585899,_0x49434b,_0x2dae31,_0x4f7d34){return _0xc304(_0x585899-0x374,_0x49434b);}function _0x7c52df(_0x857c58,_0x24f142,_0x5d1a69,_0xacac14){return _0xc304(_0xacac14-0x164,_0x857c58);}return SKIP_PATTERNS[_0x7c52df(0x369,0x39c,0x407,0x3ac)](_0x4f2c11=>_0x4f2c11[_0x7c52df(0x390,0x339,0x31b,0x35a)](_0x23a622[_0x507e39(0x561,0x594,0x5b6,0x503)]()));}export function tagsToJsonString(_0x3dafc2){if(!Array[_0x5d328a(0x365,0x359,0x364,0x3a2)](_0x3dafc2))return'[]';function _0x2e8ed9(_0x6d1157,_0x336b28,_0xb2f985,_0x1101ec){return _0xc304(_0x6d1157- -0x101,_0x336b28);}function _0x5d328a(_0x3ea102,_0x452ae0,_0x535c53,_0x510e7b){return _0xc304(_0x3ea102-0xf8,_0x510e7b);}return JSON[_0x5d328a(0x2d4,0x30d,0x2df,0x2ca)](_0x3dafc2[_0x2e8ed9(0x159,0x12b,0x11f,0x11a)](_0x62b50=>_0x62b50&&typeof _0x62b50===_0x2e8ed9(0x11f,0xee,0xda,0x163)));}export function preprocessPromptForTranslation(_0x1ef184){const _0xa3345f={'GVsFZ':function(_0x53d530,_0x18d7f1){return _0x53d530(_0x18d7f1);},'nxhjL':'object','XYUdr':function(_0x361e80,_0x556fe2){return _0x361e80!==_0x556fe2;},'ZwshT':function(_0x22702a,_0x537c51){return _0x22702a===_0x537c51;},'FxkAR':_0xfceddb(0x188,0xf4,0x12b,0x13a),'fxHvU':function(_0x346a1f,_0xd54773){return _0x346a1f<_0xd54773;},'RIZpX':function(_0xd86368,_0x320b07){return _0xd86368===_0x320b07;},'EXtOS':_0xfceddb(0x199,0xfd,0x16c,0x13f),'tBtgd':'UoSxi','Rzjhi':_0xfceddb(0x13e,0x119,0x1b4,0x166),'NqZeb':_0xfceddb(0x14b,0xad,0x141,0x108),'KGila':function(_0x246fbe,_0x47e94c){return _0x246fbe!==_0x47e94c;},'rnhPx':_0xfceddb(0x188,0x18c,0x140,0x136),'lkBYz':function(_0x16e660,_0x45132e){return _0x16e660(_0x45132e);},'hyHVJ':function(_0x53b247,_0x3b5ada){return _0x53b247===_0x3b5ada;},'Lnflg':_0x55c287(0xa2,0x6a,0xe7,0xb5),'dPWou':function(_0x30b031,_0x7a451d){return _0x30b031(_0x7a451d);},'IKFXc':function(_0x3600b4,_0x106518){return _0x3600b4===_0x106518;},'sMWyL':'bwTxG'};if(!_0x1ef184||_0xa3345f[_0x55c287(0x63,0x3a,0x35,0x3c)](typeof _0x1ef184,_0xa3345f[_0xfceddb(0x99,0xdf,0x68,0xbb)])){if(_0xa3345f[_0x55c287(0xe1,0xc3,0x10a,0xe8)](_0xa3345f['rnhPx'],_0xa3345f[_0x55c287(0x78,0x51,0xad,0x2a)])){const _0x17aabe=new _0x43d0e(_0x5cd68f[_0xfceddb(0x11c,0xbe,0xd4,0x118)]['message']);_0x17aabe['name']='AbortError',_0xa3345f['GVsFZ'](_0x2d33b8,_0x17aabe);}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};}function _0xfceddb(_0x5ea1a8,_0xc9f4ed,_0x5a954d,_0x229c97){return _0xc304(_0x229c97- -0x118,_0xc9f4ed);}function _0x55c287(_0x4e6aa3,_0x177e18,_0x177fc2,_0x1d05ac){return _0xc304(_0x4e6aa3- -0x191,_0x177fc2);}const _0x8d20f5=_0x24e3e3=>{function _0x22a592(_0x3e87e6,_0x2e2c30,_0x334a6b,_0x1ae42a){return _0xfceddb(_0x3e87e6-0x199,_0x2e2c30,_0x334a6b-0x71,_0x334a6b- -0xbf);}function _0x1447e9(_0x39aa32,_0x476966,_0x4a83dc,_0x58b0a0){return _0x55c287(_0x4a83dc- -0x157,_0x476966-0x19f,_0x58b0a0,_0x58b0a0-0x108);}const _0x3ca33a={'gyogg':_0xa3345f[_0x1447e9(-0xea,-0xe0,-0x101,-0x15c)],'aMRDu':function(_0x174338,_0x88a7c1){function _0x27835b(_0x534f60,_0x11ec43,_0x1c142d,_0x3e7fac){return _0x1447e9(_0x534f60-0xaf,_0x11ec43-0xa8,_0x11ec43- -0xb3,_0x3e7fac);}return _0xa3345f[_0x27835b(-0x195,-0x1a7,-0x201,-0x18c)](_0x174338,_0x88a7c1);}};if(_0xa3345f[_0x1447e9(-0x81,-0xf2,-0xc4,-0x109)](_0xa3345f[_0x22a592(0x83,0x91,0x65,0xbd)],_0xa3345f[_0x1447e9(-0xb9,-0xb7,-0xac,-0xae)])){const _0x105a6e=[];let _0x400d66='',_0x3d84e1=![];for(let _0x1f485a=-0xb*0x350+-0x1*-0x95f+-0x1b11*-0x1;_0xa3345f[_0x1447e9(-0xcf,-0xb6,-0xdc,-0x89)](_0x1f485a,_0x24e3e3[_0x22a592(0x79,0x98,0xad,0x7c)]);_0x1f485a++){const _0x276f6d=_0x24e3e3[_0x1f485a];if(_0xa3345f[_0x1447e9(-0x66,-0xff,-0xa8,-0xbb)](_0x276f6d,'$'))_0xa3345f[_0x1447e9(-0x12b,-0xc9,-0x11f,-0x113)]!==_0xa3345f[_0x22a592(0xf4,0x68,0xa3,0xcd)]?(_0x3d84e1=!_0x3d84e1,_0x400d66+=_0x276f6d):(_0x159517=!_0x544b84,_0xf04bd1+=_0xddea40);else{if((_0xa3345f[_0x1447e9(-0xf2,-0x6b,-0xa8,-0x60)](_0x276f6d,',')||_0xa3345f[_0x22a592(0x49,0x38,0x4d,0x36)](_0x276f6d,'，'))&&!_0x3d84e1){if(_0xa3345f[_0x1447e9(-0x10b,-0x10f,-0xf4,-0x113)](_0x1447e9(-0x5e,-0x54,-0x6a,-0x6f),_0xa3345f[_0x1447e9(-0xbd,-0x119,-0xe3,-0xa8)])){const _0x569b39=_0x447aea[_0x22a592(0x3e,0x1c,0x42,-0x1c)](_0x30c089[0x2e*0x25+-0x2153+0x1aad]);if(typeof _0x569b39===_0x3ca33a[_0x1447e9(-0x102,-0x9c,-0xc0,-0xaf)]&&_0x3ca33a['aMRDu'](_0x569b39,null))return _0x569b39;}else{const _0x184804=_0x400d66[_0x22a592(0x2a,0x2e,0x16,0x20)]();if(_0x184804)_0x105a6e[_0x22a592(0x5d,0x48,0x64,0x63)](_0x184804);_0x400d66='';}}else _0x400d66+=_0x276f6d;}}if(_0x400d66['trim']())_0x105a6e[_0x1447e9(-0xce,-0xde,-0xad,-0xa5)](_0x400d66[_0x22a592(0x73,-0x47,0x16,-0x26)]());return _0x105a6e;}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x57f3b4()};},_0x7d094f=_0xa3345f[_0xfceddb(0x131,0x187,0x194,0x141)](_0x8d20f5,_0x1ef184),_0x4fe3c3=[],_0x16fd95=[],_0x23eaaa=new Map();for(const _0x121a99 of _0x7d094f){if(_0xa3345f[_0xfceddb(0x152,0x18a,0xf4,0x14a)](_0xa3345f[_0x55c287(0x3a,0x7,-0x1e,0x48)],_0xa3345f[_0xfceddb(0xe1,0x8f,0x7b,0xb3)])){const _0xfb000e=_0x121a99[_0x55c287(0x6f,0x17,0x69,0xcb)](SD_SYMBOL_PATTERN);if(_0xfb000e){const _0x19900e=_0xfb000e[0xb9*0x13+0x1b1e+0x146c*-0x2]||'',_0x3e5c27=(_0xfb000e[0x62c+-0x3b5+-0x275*0x1]||'')[_0x55c287(0x5c,0x12,0xb9,0x1e)](),_0x20867f=_0xfb000e[0x669*0x4+-0x1a32+-0x91*-0x1]||'',_0x3ad818=_0xfb000e[0x1*-0x10d8+0x7e1*-0x2+0x2*0x104f]||'',_0x1737b9={'original':_0x121a99,'cleaned':_0x3e5c27,'prefix':_0x19900e,'suffix':_0x20867f,'weight':_0x3ad818,'skip':shouldSkipTranslation(_0x121a99)||_0xa3345f[_0xfceddb(0x9d,0xec,0xc0,0xc2)](shouldSkipTranslation,_0x3e5c27)};_0x4fe3c3[_0x55c287(0xaa,0xef,0xa1,0xa0)](_0x1737b9),!_0x1737b9['skip']&&_0x3e5c27&&(_0x16fd95[_0xfceddb(0xe2,0xff,0x117,0x123)](_0x3e5c27),_0x23eaaa[_0x55c287(0x46,0x30,0x6d,0x4c)](_0x3e5c27[_0xfceddb(0x103,0x10e,0xa0,0xfd)+'e'](),_0x1737b9));}else{if(_0xa3345f[_0x55c287(0xe0,0xb0,0xa1,0x94)](_0xa3345f[_0xfceddb(0xe0,0xee,0xec,0xb6)],_0xa3345f[_0x55c287(0x3d,0x1f,0x7d,0x81)])){const _0x4dcb01={'original':_0x121a99,'cleaned':_0x121a99,'prefix':'','suffix':'','weight':'','skip':_0xa3345f[_0xfceddb(0xa7,0xcb,0x78,0xc2)](shouldSkipTranslation,_0x121a99)};_0x4fe3c3[_0xfceddb(0xd1,0x138,0x16a,0x123)](_0x4dcb01),!_0x4dcb01[_0x55c287(0x5b,0xa4,0x4d,0x15)]&&_0x121a99&&(_0x16fd95[_0x55c287(0xaa,0xc7,0xfb,0x107)](_0x121a99),_0x23eaaa[_0xfceddb(0xca,0x105,0xec,0xbf)](_0x121a99[_0xfceddb(0xae,0x13c,0xec,0xfd)+'e'](),_0x4dcb01));}else return _0xf27d17;}}else{if(!_0x1ff2d7['isArray'](_0x4aa10a))return'[]';return _0x11ec9d[_0xfceddb(0xba,0x7b,0xe2,0xc4)](_0x1ecb5c['filter'](_0x62f9b4=>_0x62f9b4&&typeof _0x62f9b4===_0xfceddb(0x114,0x164,0xab,0x108)));}}return{'originalTags':_0x4fe3c3,'cleanedTags':_0x16fd95,'cleanedText':tagsToJsonString(_0x16fd95),'tagMap':_0x23eaaa};}export function combineTranslationResult(_0xcb3f47,_0x196e9e){const _0x37d40f={'fKLvE':function(_0x169367,_0x356458){return _0x169367(_0x356458);},'mtnKh':function(_0x3a762d,_0x2d10a0){return _0x3a762d!==_0x2d10a0;},'iyawx':'YuQDY','Ggupj':_0x43fc38(-0x3,-0x60,0x42,-0x3f),'vYVfD':_0x43fc38(-0x24,-0x47,0x9,-0x22),'Blhjc':function(_0x59cc2f,_0x303e38){return _0x59cc2f===_0x303e38;},'GuPhD':_0x43fc38(-0x43,-0x1a,-0x6b,-0x6c),'BJFYa':function(_0x38c3df,_0x54fa4d){return _0x38c3df===_0x54fa4d;}};if(!_0xcb3f47||!Array[_0xc61b85(0x474,0x427,0x46c,0x441)](_0xcb3f47)){if(_0x37d40f[_0xc61b85(0x3c4,0x3ac,0x3eb,0x3e5)](_0x37d40f[_0x43fc38(-0x3c,0xf,-0x90,-0x32)],_0x43fc38(-0x49,-0x8c,-0xf,-0x6b))){const _0x1ea04d=_0x390250[-0x247a+0x10ec+0x138f]||'',_0x3470d1=(_0x4c8668[0x253a+-0x2e7+-0x2251*0x1]||'')['trim'](),_0x3dd68c=_0x24710e[0x3a3*-0x7+0x1*-0x5e5+-0x25*-0xd9]||'',_0x4a0c8f=_0x357e50[0x1c17+-0x2*0x458+-0x1363]||'',_0x5b5214={'original':_0x311ecb,'cleaned':_0x3470d1,'prefix':_0x1ea04d,'suffix':_0x3dd68c,'weight':_0x4a0c8f,'skip':_0x56554c(_0x44bf65)||_0x37d40f[_0xc61b85(0x41e,0x421,0x422,0x3ce)](_0x19bd56,_0x3470d1)};_0x3a043b['push'](_0x5b5214),!_0x5b5214[_0xc61b85(0x39d,0x3fb,0x3af,0x3c0)]&&_0x3470d1&&(_0x59c914[_0x43fc38(-0x3f,-0x3f,0x3,-0x91)](_0x3470d1),_0x18bbbd[_0x43fc38(-0xa3,-0xb3,-0xb8,-0x95)](_0x3470d1[_0x43fc38(-0x65,-0xc0,-0xaf,-0x14)+'e'](),_0x5b5214));}else return[];}function _0xc61b85(_0x5038a9,_0x1ea717,_0x1a278b,_0x119e92){return _0xc304(_0x119e92-0x1d4,_0x1ea717);}const _0x5c7237={};if(_0x196e9e&&_0x37d40f['BJFYa'](typeof _0x196e9e,_0x43fc38(-0x50,-0x23,-0x11,-0x14)))for(const [_0x23074c,_0x12832d]of Object['entries'](_0x196e9e)){_0x5c7237[_0x23074c[_0xc61b85(0x404,0x3a9,0x3a1,0x3e9)+'e']()]=_0x12832d;}function _0x43fc38(_0x51e6e6,_0x44ca65,_0x3d83c8,_0x13430b){return _0xc304(_0x51e6e6- -0x27a,_0x44ca65);}return _0xcb3f47['map'](_0x14ecec=>{function _0x547e24(_0x11f8bb,_0x4e387d,_0x2e8bff,_0x32c625){return _0xc61b85(_0x11f8bb-0x1ea,_0x32c625,_0x2e8bff-0x2a,_0x4e387d- -0x17c);}function _0x4d91fc(_0x58a4b1,_0xcc76b6,_0xce9826,_0x4968d4){return _0x43fc38(_0xce9826- -0x16d,_0x58a4b1,_0xce9826-0xf5,_0x4968d4-0x66);}if(_0x37d40f[_0x547e24(0x26c,0x239,0x281,0x292)](_0x37d40f[_0x547e24(0x23c,0x25c,0x2b3,0x263)],_0x37d40f[_0x547e24(0x269,0x247,0x291,0x26f)])){const {original:_0x36a6ae,cleaned:_0xeba0ee,skip:_0x2f8eec}=_0x14ecec;if(_0x2f8eec){if(_0x37d40f[_0x547e24(0x27f,0x239,0x1ee,0x278)]('uMday',_0x37d40f[_0x547e24(0x29f,0x2a1,0x270,0x2e5)]))return _0x5c2c03[_0x547e24(0x274,0x2a0,0x2e8,0x2fd)](_0x2010ce=>_0x2010ce[_0x547e24(0x295,0x24e,0x1fe,0x244)](_0x2e1835[_0x4d91fc(-0x1d8,-0x245,-0x1fa,-0x23a)]()));else{const _0x58271d={};return _0x58271d[_0x4d91fc(-0x1da,-0x1e9,-0x20f,-0x1bc)]=_0x36a6ae,_0x58271d[_0x4d91fc(-0x15a,-0x166,-0x16c,-0x113)+'n']='',_0x58271d['cleaned']=_0xeba0ee,_0x58271d[_0x547e24(0x217,0x276,0x2ae,0x21e)]=!![],_0x58271d;}}const _0x2dc06b=_0x5c7237[_0xeba0ee[_0x547e24(0x24c,0x26d,0x28e,0x275)+'e']()]||'',_0x48d37f={};return _0x48d37f['original']=_0x36a6ae,_0x48d37f[_0x4d91fc(-0x125,-0x164,-0x16c,-0x19c)+'n']=_0x2dc06b,_0x48d37f['cleaned']=_0xeba0ee,_0x48d37f[_0x4d91fc(-0x188,-0x178,-0x1c9,-0x1e8)]=![],_0x48d37f;}else return _0x3a5456?_0x320bb0['original']:'';});}export function formatTranslationDisplay(_0x2a75a9,_0x1a57a0={}){const _0x5e4bbb={'nMkzX':function(_0x2a153c,_0x5912ca){return _0x2a153c(_0x5912ca);},'pjBUM':function(_0x49986c,_0x52c0e9,_0xeeff7b){return _0x49986c(_0x52c0e9,_0xeeff7b);},'qyGZA':function(_0x5e8709,_0xd2453a){return _0x5e8709===_0xd2453a;},'TxBLr':'VvQHd','JqXoy':function(_0x3b7ca2,_0x3705a8){return _0x3b7ca2===_0x3705a8;},'liUug':_0x45c66e(-0xff,-0xb1,-0xa5,-0x93),'TeCGW':function(_0x136444,_0x38d922){return _0x136444===_0x38d922;},'ONtVK':_0x45c66e(-0x7b,-0x1f,-0x23,0x1c)},{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x1a57a0;function _0x45c66e(_0x318df8,_0x2e54d9,_0x4c0e25,_0x57b8e2){return _0xc304(_0x4c0e25- -0x28d,_0x57b8e2);}function _0x116965(_0xe73010,_0x5e485d,_0x3959cb,_0xa895bb){return _0xc304(_0xe73010-0x82,_0x5e485d);}if(!_0x2a75a9||!Array[_0x116965(0x2ef,0x31c,0x30a,0x2a1)](_0x2a75a9))return'';return _0x2a75a9[_0x45c66e(-0x53,-0x5,-0x58,-0x6)](_0x358a02=>{function _0x3d8776(_0x2d79fb,_0x1c7ad5,_0x5a7103,_0x3a40de){return _0x116965(_0x2d79fb- -0x1a1,_0x1c7ad5,_0x5a7103-0x1ea,_0x3a40de-0x8b);}function _0x53f778(_0x47dc87,_0x45df48,_0x4bd941,_0x23f22c){return _0x45c66e(_0x47dc87-0x162,_0x45df48-0x1cf,_0x47dc87-0x77,_0x23f22c);}if(_0x5e4bbb['qyGZA'](_0x5e4bbb[_0x53f778(-0x15,-0x36,-0x2f,0x40)],_0x5e4bbb['TxBLr'])){if(_0x358a02[_0x3d8776(0xff,0xf4,0xa0,0xc5)])return _0x5e4bbb[_0x3d8776(0x12b,0x186,0x174,0xf3)](_0x5e4bbb[_0x53f778(0x2b,0x1e,0x49,-0x2d)],_0x5e4bbb[_0x53f778(0x2b,0x34,0x50,0x32)])?showOriginal?_0x358a02['original']:'':_0x591d33[_0x3d8776(0xc7,0xc4,0xa0,0x8d)]();const _0x1083ec=[];if(showOriginal)_0x1083ec['push'](_0x358a02[_0x3d8776(0xb9,0x118,0x95,0x9d)]);if(showTranslation&&_0x358a02[_0x53f778(0x65,0x57,0x50,0xab)+'n']){if(_0x5e4bbb[_0x3d8776(0xeb,0x103,0xad,0xdc)](_0x5e4bbb[_0x3d8776(0x104,0xb1,0x163,0xdd)],_0x5e4bbb[_0x3d8776(0x104,0xd9,0x12e,0xde)]))_0x1083ec[_0x3d8776(0x11c,0x137,0x147,0x163)]('('+_0x358a02[_0x53f778(0x65,0x1d,0xd,0x8d)+'n']+')');else{const _0x5add01={'hFkHt':function(_0x2b5347,_0x2c5b88){return _0x5e4bbb['nMkzX'](_0x2b5347,_0x2c5b88);},'FlFdJ':_0x53f778(0x16,0x8,-0x27,-0x16),'MnLaH':function(_0x3faabf,_0x5d9de5,_0x2967d1){function _0xc51069(_0x21263d,_0x530b27,_0x451b35,_0x57221f){return _0x53f778(_0x530b27-0x527,_0x530b27-0x188,_0x451b35-0xff,_0x57221f);}return _0x5e4bbb[_0xc51069(0x541,0x560,0x55d,0x593)](_0x3faabf,_0x5d9de5,_0x2967d1);}};return new _0x1fb586((_0x43be8e,_0x2aead1)=>{const _0x2a6ac0={'lXUZV':function(_0x4a0330,_0xe6e82e){function _0x7f7e56(_0x325b8a,_0x147e2a,_0x59f8c2,_0xd7ec9f){return _0xc304(_0x59f8c2-0x3e4,_0xd7ec9f);}return _0x5add01[_0x7f7e56(0x62f,0x60c,0x5ef,0x5c7)](_0x4a0330,_0xe6e82e);},'bgdaj':_0x5add01[_0x48b02c(-0x1d2,-0x206,-0x224,-0x224)]},_0xfe77e9=_0x235ce8();_0x47b694[_0x48b02c(-0x163,-0x18e,-0x12c,-0x1bb)](_0x3e8685(0xf7,0x6b,0xac,0xdb)+_0x48b02c(-0x1b6,-0x18f,-0x188,-0x1f4)+_0x3e8685(0xce,0x126,0xe6,0x9c)+_0xfe77e9+')');const _0x1750cd=_0x3a7746=>{if(_0x3a7746['id']!==_0xfe77e9)return;function _0x3819f4(_0x3c256e,_0x546c15,_0x41b70f,_0x4c3fa6){return _0x3e8685(_0x3c256e-0x2f,_0x3c256e,_0x546c15-0x4c5,_0x4c3fa6-0x31);}function _0x32db94(_0x26474c,_0x1bff8e,_0x5987e3,_0x10e6a2){return _0x3e8685(_0x26474c-0x14d,_0x26474c,_0x5987e3- -0x255,_0x10e6a2-0x40);}_0x36f640[_0x32db94(-0x17c,-0x12c,-0x159,-0x159)+_0x32db94(-0x143,-0x137,-0x113,-0x11a)](_0x1347f4[_0x3819f4(0x66a,0x60c,0x62a,0x642)+_0x32db94(-0x1cd,-0x19e,-0x1b9,-0x16c)+_0x3819f4(0x629,0x5d7,0x60a,0x5ba)+_0x32db94(-0x13e,-0x153,-0x133,-0x14f)],_0x1750cd);const {prompt:_0xee6608}=_0x3a7746;_0x381204[_0x32db94(-0x16c,-0x127,-0x118,-0xd1)](_0x32db94(-0x1cc,-0x1a4,-0x1a9,-0x15a)+'\x20已获取翻译提示词\x20'+_0x32db94(-0x13d,-0xcf,-0x122,-0x179)+_0xfe77e9+'):',_0xee6608),_0x5add01[_0x3819f4(0x558,0x59f,0x553,0x5d2)](_0x43be8e,_0xee6608);};_0x5da2fa['on'](_0x55cd77[_0x3e8685(0x112,0x123,0x147,0x10c)+_0x48b02c(-0x204,-0x1f5,-0x23d,-0x22d)+_0x3e8685(0xeb,0x11e,0x112,0x14c)+_0x48b02c(-0x17e,-0x13c,-0x140,-0x1bd)],_0x1750cd);const _0x329689={};function _0x48b02c(_0x203b76,_0x49e85d,_0x41a288,_0xc9c280){return _0x53f778(_0x203b76- -0x1bb,_0x49e85d-0x141,_0x41a288-0xae,_0xc9c280);}_0x329689['id']=_0xfe77e9;function _0x3e8685(_0x30c947,_0x42cc64,_0x3e35b5,_0x373fb1){return _0x3d8776(_0x3e35b5- -0x12,_0x42cc64,_0x3e35b5-0x1c0,_0x373fb1-0x13b);}_0x28c142[_0x3e8685(0xf8,0x17a,0x136,0x117)](_0xdd2d3a[_0x3e8685(0xea,0x12a,0x147,0x17e)+_0x3e8685(0x74,0xdc,0x9c,0x81)+_0x3e8685(0xfa,0x88,0xb9,0x7c)+_0x3e8685(0x84,0x8d,0xa5,0x8c)],_0x329689),_0x5add01[_0x3e8685(0x150,0x160,0x114,0xe1)](_0x22feca,()=>{_0x1eb6d9[_0x4a62a7(-0x106,-0x13c,-0x12b,-0x103)+_0x4a62a7(-0x94,-0x69,-0xd2,-0xbd)](_0x5b31aa['LLM_TRANSL'+_0x4a62a7(-0x147,-0x11d,-0x17f,-0x163)+_0x42f218(0x509,0x551,0x556,0x506)+'PONSE'],_0x1750cd);function _0x42f218(_0x4f6894,_0x327f8e,_0x506065,_0x4603cb){return _0x48b02c(_0x327f8e-0x6df,_0x327f8e-0x2a,_0x506065-0x1a8,_0x506065);}function _0x4a62a7(_0xdfb5f1,_0x5d7ba4,_0x55b0da,_0x4f6a78){return _0x48b02c(_0x4f6a78-0xa1,_0x5d7ba4-0x9b,_0x55b0da-0x1f0,_0x55b0da);}_0x2a6ac0[_0x42f218(0x5ae,0x55a,0x555,0x54b)](_0x2aead1,new _0x430d13(_0x2a6ac0[_0x42f218(0x4ec,0x537,0x560,0x4fd)]));},-0x3ccc+0x406e+0x5*0x716);});}}return _0x1083ec[_0x3d8776(0xba,0xfb,0xe9,0xd2)]('\x20');}else _0x28d4d1[_0x3d8776(0x10e,0xb3,0x11a,0xe8)+_0x53f778(0x5d,0x71,0xb7,0xa5)](_0x14ff43[_0x53f778(0x62,0x9d,0x55,0xbb)+_0x3d8776(0xae,0xe6,0xf4,0x98)+_0x3d8776(0x124,0x134,0x169,0x135)+_0x53f778(0x3d,-0x17,0x4d,0x22)],_0x33799e),_0x48a79b(new _0x3efd8e('获取翻译提示词超时'));})['filter'](Boolean)[_0x45c66e(-0x8e,-0xf4,-0xb4,-0xb3)](separator);}export async function translatePromptTags(_0xa1e94b){const _0x46600a={'CRdwt':function(_0x3a216f,_0x1db339){return _0x3a216f(_0x1db339);},'yNvok':function(_0x49f0e7,_0x1d2895,_0xd4f46e){return _0x49f0e7(_0x1d2895,_0xd4f46e);},'LsHAq':function(_0xa979f0,_0x2cca0c){return _0xa979f0(_0x2cca0c);},'cTBSG':'st-chatu8:'+'\x20翻译提示词标签失败'+':'},{originalTags:_0x1babaa,cleanedText:_0x530faa}=_0x46600a[_0xcc6bce(0x4b1,0x47e,0x453,0x4f6)](preprocessPromptForTranslation,_0xa1e94b);function _0xcc6bce(_0x337e08,_0x676ae0,_0x20c878,_0x36a4d5){return _0xc304(_0x337e08-0x248,_0x36a4d5);}if(!_0x530faa){const _0x22a7d4={};return _0x22a7d4[_0xcc6bce(0x439,0x3e7,0x405,0x438)]=[],_0x22a7d4[_0x33c908(0xb2,0x85,0x84,0x60)+'t']='',_0x22a7d4[_0xcc6bce(0x456,0x489,0x489,0x436)+'gs']=[],_0x22a7d4;}function _0x33c908(_0x130dc4,_0x58c482,_0x33e317,_0x4f9eb2){return _0xc304(_0x4f9eb2- -0x1e7,_0x130dc4);}try{const _0x229972=await callTranslation(_0x530faa),_0x14a4ba=_0x46600a[_0x33c908(0x63,0x2f,0x28,0x82)](parseTranslationResult,_0x229972),_0x347cb5=_0x46600a[_0xcc6bce(0x427,0x415,0x447,0x400)](combineTranslationResult,_0x1babaa,_0x14a4ba),_0xc17be2=_0x46600a['LsHAq'](formatTranslationDisplay,_0x347cb5),_0x4fe53e={};return _0x4fe53e[_0xcc6bce(0x439,0x43d,0x401,0x47a)]=_0x347cb5,_0x4fe53e[_0xcc6bce(0x48f,0x4dc,0x4da,0x4bb)+'t']=_0xc17be2,_0x4fe53e[_0xcc6bce(0x456,0x47c,0x48a,0x4b1)+'gs']=_0x1babaa,_0x4fe53e;}catch(_0x2df90e){console[_0xcc6bce(0x478,0x4b9,0x4c8,0x47b)](_0x46600a[_0xcc6bce(0x4bd,0x496,0x48d,0x501)],_0x2df90e);throw _0x2df90e;}}export function parseTranslationResult(_0x2e67ea){const _0x4b6f9e={'LcTHq':function(_0x2615ef,_0xd3712a){return _0x2615ef(_0xd3712a);},'zrzEV':function(_0x5ba6f1,_0x1f1f66){return _0x5ba6f1!==_0x1f1f66;},'CtBoi':_0x3735b3(0x2c1,0x2db,0x29b,0x2db),'LHOVN':_0x3735b3(0x2ea,0x2ed,0x2dd,0x2be),'qbazS':function(_0x3fc5b5,_0x3cdff5){return _0x3fc5b5===_0x3cdff5;},'IWzCk':_0x2a6b2b(-0x16f,-0x173,-0x141,-0x114),'jcBwr':function(_0x361665,_0xf57c96){return _0x361665===_0xf57c96;},'rysSC':function(_0x16f45d,_0x5366f3){return _0x16f45d(_0x5366f3);},'ElyyC':function(_0x5b0149,_0x5475de){return _0x5b0149>_0x5475de;}};if(!_0x2e67ea)return{};try{if(_0x4b6f9e['zrzEV'](_0x4b6f9e[_0x3735b3(0x2a4,0x26e,0x29a,0x221)],_0x4b6f9e[_0x2a6b2b(-0x1ad,-0x18b,-0x188,-0x18a)])){const _0x78821a=_0x2e67ea['match'](/\{[\s\S]*\}/);if(_0x78821a){const _0x30e3ee=JSON[_0x2a6b2b(-0x186,-0x184,-0x176,-0x1e1)](_0x78821a[0x2564*0x1+0x24dd+-0x4a41]);if(_0x4b6f9e[_0x2a6b2b(-0x197,-0x180,-0x122,-0x1ce)](typeof _0x30e3ee,_0x4b6f9e[_0x3735b3(0x30f,0x2ff,0x34e,0x2d7)])&&_0x4b6f9e[_0x3735b3(0x2ef,0x2b5,0x2bc,0x303)](_0x30e3ee,null))return _0x30e3ee;}}else{const _0x322867={};return _0x322867[_0x3735b3(0x26a,0x271,0x252,0x26f)]=_0x321fed,_0x322867[_0x3735b3(0x372,0x314,0x319,0x302)+'n']='',_0x322867[_0x3735b3(0x2d7,0x308,0x350,0x2f0)]=_0x18ed24,_0x322867[_0x3735b3(0x2ca,0x2b7,0x2f5,0x290)]=!![],_0x322867;}}catch(_0x2433aa){_0x4b6f9e[_0x3735b3(0x279,0x27e,0x2dd,0x255)](_0x3735b3(0x2ab,0x2f9,0x2b9,0x30a),'SoxPQ')?_0x4b6f9e['LcTHq'](_0x3b0853,new _0xd905ad(_0x23224d[_0x3735b3(0x29d,0x28e,0x2a5,0x26d)])):console[_0x3735b3(0x307,0x305,0x2e2,0x2b3)]('st-chatu8:'+_0x2a6b2b(-0x10d,-0x163,-0x15c,-0x187)+_0x3735b3(0x292,0x277,0x287,0x229),_0x2433aa[_0x2a6b2b(-0x112,-0x150,-0x16d,-0x122)]);}const _0x371482=_0x4b6f9e[_0x2a6b2b(-0x1c1,-0x1a5,-0x1d7,-0x1a3)](String,_0x2e67ea)[_0x3735b3(0x27b,0x265,0x20a,0x296)](/[\r\n]+/g,'\x20')[_0x2a6b2b(-0x1cc,-0x1d1,-0x1fa,-0x229)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x3735b3(0x265,0x286,0x255,0x24b)](),_0x4b7525=_0x371482[_0x3735b3(0x2f6,0x2a0,0x290,0x274)](/[,，]/)[_0x2a6b2b(-0x129,-0x168,-0x13b,-0x1c4)](_0x325693=>_0x325693[_0x3735b3(0x244,0x286,0x23e,0x290)]())['filter'](Boolean);function _0x3735b3(_0x48afe6,_0x1d9c50,_0x520332,_0x533d81){return _0xc304(_0x1d9c50-0x99,_0x520332);}function _0x2a6b2b(_0x481191,_0x19ce09,_0x8b485e,_0x174603){return _0xc304(_0x19ce09- -0x39d,_0x481191);}const _0x46f411={};for(const _0x55762f of _0x4b7525){const _0x169eb8=_0x55762f[_0x2a6b2b(-0x145,-0x14c,-0x186,-0x112)]('\x5c');if(_0x4b6f9e[_0x3735b3(0x297,0x2c4,0x2d2,0x2c4)](_0x169eb8,0x20d*-0x3+-0xa45+0x106c)){const _0x4005b8=_0x55762f[_0x2a6b2b(-0x16c,-0x138,-0x140,-0x16e)](-0xa80+0x19a7+-0x9*0x1af,_0x169eb8)['trim'](),_0x2cb0a1=_0x55762f[_0x3735b3(0x2d4,0x2fe,0x329,0x2be)](_0x169eb8+(-0x194b+-0x289*-0x2+0x143a))[_0x2a6b2b(-0x1a3,-0x1b0,-0x1ff,-0x1f5)]();if(_0x4005b8)_0x46f411[_0x4005b8]=_0x2cb0a1;}}return _0x46f411;}function generateRequestId(){const _0x529724={};_0x529724[_0x512281(0x1db,0x1ce,0x1a9,0x20b)]=function(_0x26a62b,_0xab731a){return _0x26a62b+_0xab731a;};function _0x2bd9d7(_0x2beba2,_0x5014a4,_0x357990,_0x8bd1f5){return _0xc304(_0x2beba2-0x19e,_0x357990);}const _0x5e73d2=_0x529724;if(crypto&&crypto[_0x2bd9d7(0x384,0x360,0x370,0x326)])return crypto['randomUUID']();function _0x512281(_0x4366a8,_0x5f57d0,_0x966b6c,_0x21bb0a){return _0xc304(_0x5f57d0- -0x57,_0x21bb0a);}return _0x5e73d2[_0x512281(0x211,0x1ce,0x189,0x226)](Date['now']()[_0x512281(0x243,0x1f4,0x1d7,0x1da)](-0x2*0x74+0x2544+0x26*-0xf4),Math['random']()['toString'](0x2284+0x791+0x1*-0x29f1)[_0x2bd9d7(0x3a0,0x3af,0x344,0x3d3)](0xa47+0x226c*-0x1+0x1827));}export function LLM_TRANSLATION_GET_PROMPT(){const _0x40acc8={'YavYb':function(_0x43676c,_0x203704){return _0x43676c===_0x203704;},'DRnRi':function(_0x72de16,_0x5993d5){return _0x72de16(_0x5993d5);},'krQKI':function(_0x2694a2){return _0x2694a2();}};return new Promise((_0x5466c9,_0x19a054)=>{const _0x538ec4={'uCctf':function(_0x1e7137,_0x588a95){return _0x1e7137===_0x588a95;},'TQFpA':_0x578f02(0x1a9,0x201,0x21b,0x22a),'OawUO':function(_0x36c38b,_0x3e4327){return _0x36c38b!==_0x3e4327;},'dkrcR':function(_0x3d7ae7,_0x1137f2){return _0x3d7ae7(_0x1137f2);},'MNzKO':function(_0x140ee6,_0x4f7e0a){function _0x266bab(_0x465dda,_0x197fa9,_0x322903,_0xe29206){return _0x578f02(_0x322903,_0x465dda- -0x3cd,_0x322903-0x18,_0xe29206-0x1dc);}return _0x40acc8[_0x266bab(-0x12b,-0xd1,-0x131,-0x166)](_0x140ee6,_0x4f7e0a);},'FyZZH':_0x578f02(0x2d0,0x298,0x2cd,0x2b1),'iWIae':function(_0x503a74,_0xbbc43e){function _0x3b6ed1(_0x1dc926,_0xf8923,_0x496841,_0x40d638){return _0x578f02(_0x40d638,_0xf8923- -0x3f1,_0x496841-0x4c,_0x40d638-0x1d);}return _0x40acc8[_0x3b6ed1(-0x1df,-0x1c5,-0x202,-0x1bb)](_0x503a74,_0xbbc43e);},'uprWX':'获取翻译提示词超时'},_0x49165b=_0x40acc8[_0x578f02(0x245,0x202,0x1e9,0x246)](generateRequestId);console['log'](_0x578f02(0x1eb,0x1fc,0x1b9,0x1ff)+_0x4dcaf1(0x3d6,0x3bd,0x3a2,0x3b6)+'\x20(ID:\x20'+_0x49165b+')');const _0x588c7d=_0xd14a77=>{function _0x24761f(_0x4ad78c,_0x61b1a5,_0x25a548,_0x1dc1dc){return _0x578f02(_0x1dc1dc,_0x25a548- -0x12d,_0x25a548-0xc2,_0x1dc1dc-0x1f0);}function _0x7c6eeb(_0x39376b,_0x1a7e2c,_0x5ca62f,_0x2428eb){return _0x578f02(_0x5ca62f,_0x39376b- -0x2b7,_0x5ca62f-0x1ae,_0x2428eb-0x1cc);}if(_0x538ec4[_0x7c6eeb(-0xd0,-0x113,-0x78,-0xe6)](_0x538ec4['TQFpA'],'vXbSB')){if(_0x538ec4[_0x7c6eeb(-0xc6,-0xe1,-0xae,-0x11c)](_0xd14a77['id'],_0x49165b))return;eventSource[_0x24761f(0x17d,0x13e,0x11f,0xd7)+_0x24761f(0x16f,0x1b9,0x165,0x1bb)](eventNames[_0x7c6eeb(-0x20,0x38,-0x69,-0x29)+_0x7c6eeb(-0xcb,-0xbb,-0x8a,-0xca)+_0x24761f(0x106,0x105,0x135,0x18b)+'PONSE'],_0x588c7d);const {prompt:_0xc078bd}=_0xd14a77;console[_0x24761f(0x12b,0x1bf,0x160,0x167)](_0x7c6eeb(-0xbb,-0x98,-0x7e,-0xa5)+_0x24761f(0x15f,0xf8,0x12f,0x136)+_0x7c6eeb(-0x34,0x5,-0x4c,-0x59)+_0x49165b+'):',_0xc078bd),_0x538ec4[_0x7c6eeb(-0x80,-0x61,-0x55,-0x25)](_0x5466c9,_0xc078bd);}else for(const [_0x39bab0,_0x46a8bc]of _0x2037f5[_0x24761f(0x138,0xa0,0xee,0x120)](_0x81450e)){_0x3d569f[_0x39bab0[_0x7c6eeb(-0x83,-0x56,-0x8f,-0xa8)+'e']()]=_0x46a8bc;}};function _0x578f02(_0x27c098,_0x51598c,_0x305acf,_0x4fbd26){return _0xc304(_0x51598c-0x1f,_0x27c098);}eventSource['on'](eventNames[_0x4dcaf1(0x45c,0x3ff,0x447,0x413)+_0x4dcaf1(0x396,0x3ac,0x3a5,0x368)+_0x578f02(0x231,0x262,0x2be,0x224)+_0x578f02(0x24d,0x272,0x23c,0x2a8)],_0x588c7d);const _0x578500={};function _0x4dcaf1(_0x528ca0,_0x177b7f,_0x229dd2,_0x5a55c6){return _0xc304(_0x5a55c6-0x19b,_0x229dd2);}_0x578500['id']=_0x49165b,eventSource['emit'](eventNames[_0x578f02(0x2b7,0x297,0x2b9,0x2ea)+'ATION_GET_'+_0x4dcaf1(0x3d7,0x35f,0x3a9,0x385)+_0x4dcaf1(0x3ab,0x387,0x3c3,0x371)],_0x578500),setTimeout(()=>{function _0x2b0d04(_0x31a9e4,_0x4ec1c5,_0x3b5ff1,_0x473341){return _0x4dcaf1(_0x31a9e4-0xb2,_0x4ec1c5-0x194,_0x4ec1c5,_0x3b5ff1- -0x2d5);}function _0xcf9bf4(_0x341ee2,_0x583a3a,_0x5532b0,_0x45103a){return _0x4dcaf1(_0x341ee2-0xc2,_0x583a3a-0x13e,_0x45103a,_0x583a3a-0x1);}if(_0x538ec4[_0x2b0d04(0x142,0x10b,0xe5,0xaa)](_0x538ec4[_0xcf9bf4(0x360,0x3b2,0x36c,0x3f1)],_0xcf9bf4(0x3e3,0x3d2,0x3d2,0x3ad))){const _0x22af34={};return _0x22af34[_0xcf9bf4(0x33b,0x38d,0x34a,0x369)]=[],_0x22af34[_0x2b0d04(0xfe,0x13c,0x10d,0xb2)+'t']='',_0x22af34['originalTa'+'gs']=[],_0x22af34;}else eventSource[_0xcf9bf4(0x400,0x3c9,0x3e0,0x372)+_0x2b0d04(0xdb,0x158,0x139,0xfa)](eventNames['LLM_TRANSL'+_0x2b0d04(0x52,0x44,0x93,0x4a)+_0x2b0d04(0x168,0xad,0x109,0x14b)+'PONSE'],_0x588c7d),_0x538ec4[_0xcf9bf4(0x3cd,0x3ca,0x3c6,0x3cf)](_0x19a054,new Error(_0x538ec4['uprWX']));},-0x4954*0x1+0x389b+-0x1*-0x37c9);});}export function LLM_TRANSLATION(_0x551173,{timeoutMs:timeoutMs=-0x125e0+-0x17*0x79f+-0x2ee7*-0xf}={}){function _0x2ea351(_0x3288ca,_0x145a9a,_0x4f9ec8,_0x6fbb59){return _0xc304(_0x145a9a-0x2a,_0x6fbb59);}function _0x35efad(_0x2d4f30,_0x3764d7,_0xf7b781,_0x2de23e){return _0xc304(_0xf7b781-0x2ad,_0x2de23e);}const _0x2e9a0f={'rPvvP':_0x2ea351(0x1bc,0x1fb,0x203,0x1f5),'FroIS':function(_0x40f610,_0x1e7776){return _0x40f610(_0x1e7776);},'kdBBz':function(_0x12b994,_0x9ff866){return _0x12b994===_0x9ff866;},'zUGZg':'AbortError','ZjYxh':_0x2ea351(0x209,0x239,0x244,0x26e),'tGfGp':function(_0x325be4,_0x12d644){return _0x325be4(_0x12d644);},'AcHqt':_0x35efad(0x56d,0x588,0x52a,0x535),'wJDEA':function(_0xd48923,_0x63b8b1){return _0xd48923(_0x63b8b1);},'xPkkr':function(_0x4a6eba){return _0x4a6eba();},'TFjCd':function(_0x34af60,_0x29c62a){return _0x34af60(_0x29c62a);},'wYSsi':function(_0x5a2d77,_0x3909da){return _0x5a2d77!==_0x3909da;},'AzQtQ':'GXpxg','GKmqR':_0x2ea351(0x288,0x250,0x1f9,0x2ab),'BMAWh':function(_0x5af939,_0x6f8b67,_0x19a0e1){return _0x5af939(_0x6f8b67,_0x19a0e1);}};return new Promise((_0xbcfde8,_0x50addb)=>{function _0x5b5e35(_0x2c8be3,_0x1ee95e,_0x1ca6c7,_0x6315e){return _0x35efad(_0x2c8be3-0x29,_0x1ee95e-0x12f,_0x6315e- -0xbc,_0x1ee95e);}const _0x5e5d79={'fnAns':function(_0x5c5ed3,_0x545407){return _0x2e9a0f['wJDEA'](_0x5c5ed3,_0x545407);}};function _0x18db5a(_0x1edbc8,_0x4ea3b0,_0x3ce228,_0x363761){return _0x35efad(_0x1edbc8-0xc1,_0x4ea3b0-0x11e,_0x363761- -0x4bb,_0x4ea3b0);}if(_0x2e9a0f[_0x5b5e35(0x3e9,0x3b9,0x416,0x3e4)](_0x2e9a0f['AzQtQ'],_0x2e9a0f['GKmqR'])){const _0x211cb5=_0x2e9a0f[_0x5b5e35(0x407,0x49d,0x475,0x446)](generateRequestId);console[_0x18db5a(0x2e,0x22,0x5d,0x60)](_0x18db5a(-0x61,-0x2a,-0x5d,-0x31)+_0x5b5e35(0x3af,0x454,0x3a8,0x404)+_0x18db5a(0x3b,0x79,0x7a,0x56)+_0x211cb5+')');let _0x5d6f4e=null;const _0x598eb5=()=>{function _0x5d7e32(_0x23d996,_0x142273,_0x319b6e,_0x5ac641){return _0x18db5a(_0x23d996-0x1c7,_0x142273,_0x319b6e-0x19f,_0x5ac641-0x5a);}eventSource[_0x5d7e32(0xa1,0xb3,0x8f,0x79)+_0x48e523(0x7e,0x8f,0xc5,0xb7)](eventNames[_0x5d7e32(0xb3,0xb1,0xb5,0xc4)+_0x5d7e32(0xa6,0xb5,0x2d,0x84)+_0x5d7e32(-0x37,0x6d,0x5b,0x16)],_0xe0ca4a);function _0x48e523(_0x2af330,_0x17b42a,_0x4a2202,_0xbf1242){return _0x18db5a(_0x2af330-0x1c0,_0x2af330,_0x4a2202-0x148,_0xbf1242-0x52);}if(_0x5d6f4e)_0x5e5d79['fnAns'](clearTimeout,_0x5d6f4e);},_0xe0ca4a=_0x1b1d38=>{const _0x48137e={};_0x48137e[_0x446ce2(0x4f1,0x57d,0x53b,0x541)]=_0x446ce2(0x566,0x4db,0x51d,0x541)+_0x446ce2(0x5ea,0x5da,0x5a1,0x5d0)+'\x20LLM\x20设置页面';const _0x24b09b=_0x48137e;if(_0x1b1d38['id']!==_0x211cb5)return;function _0x446ce2(_0x40fcda,_0x1c860f,_0x1d4508,_0x26b16e){return _0x5b5e35(_0x40fcda-0x1ec,_0x40fcda,_0x1d4508-0x1f2,_0x1d4508-0x14f);}function _0x5e44fd(_0x5d4926,_0x4f6db0,_0xb2b17b,_0x10ea0a){return _0x5b5e35(_0x5d4926-0x1ad,_0xb2b17b,_0xb2b17b-0x2e,_0x4f6db0-0x12e);}_0x598eb5(),console[_0x5e44fd(0x52f,0x58d,0x58b,0x570)](_0x446ce2(0x4d8,0x51e,0x51d,0x53c)+_0x5e44fd(0x530,0x57e,0x529,0x54e)+_0x5e44fd(0x53f,0x582,0x540,0x5ad)+'\x20'+_0x211cb5+'):',_0x1b1d38);if(_0x1b1d38[_0x5e44fd(0x531,0x563,0x510,0x534)]){if(_0x5e44fd(0x586,0x587,0x5db,0x5df)!==_0x2e9a0f[_0x5e44fd(0x509,0x541,0x596,0x53c)])_0x2e9a0f['FroIS'](_0xbcfde8,_0x1b1d38['result']);else{const _0x2530c2=_0x17eb39?function(){if(_0x4b063a){const _0x53efb8=_0x533cb1['apply'](_0x370831,arguments);return _0x519b9a=null,_0x53efb8;}}:function(){};return _0x4f5928=![],_0x2530c2;}}else{if(_0x1b1d38[_0x5e44fd(0x57c,0x54f,0x541,0x57d)]&&_0x2e9a0f['kdBBz'](_0x1b1d38['error'][_0x5e44fd(0x560,0x503,0x4f9,0x510)],_0x2e9a0f[_0x5e44fd(0x5f9,0x59f,0x5a2,0x57f)])){if(_0x2e9a0f[_0x446ce2(0x54e,0x574,0x53e,0x583)](_0x2e9a0f['ZjYxh'],_0x2e9a0f[_0x446ce2(0x51b,0x4f1,0x52e,0x532)])){const _0x837e20=new Error(_0x1b1d38[_0x5e44fd(0x518,0x54f,0x517,0x59e)][_0x5e44fd(0x52d,0x56c,0x54f,0x547)]);_0x837e20['name']=_0x446ce2(0x5a2,0x5c9,0x56f,0x5ba),_0x2e9a0f[_0x5e44fd(0x5ce,0x57b,0x551,0x54c)](_0x50addb,_0x837e20);}else _0x34d55d[_0x446ce2(0x5f6,0x54f,0x5ae,0x5ea)](_0x24b09b[_0x5e44fd(0x53c,0x51a,0x54c,0x509)]),_0x4230de=!![];}else{if(_0x2e9a0f['AcHqt']===_0x2e9a0f[_0x446ce2(0x51d,0x51b,0x567,0x526)])_0x2e9a0f[_0x446ce2(0x5af,0x5cd,0x59b,0x5b9)](_0x50addb,new Error(_0x1b1d38['result']));else{if(_0x10fbf6[_0x446ce2(0x58e,0x58b,0x55e,0x52e)])return _0x1feb47?_0x279bd7[_0x5e44fd(0x4c8,0x4f7,0x528,0x524)]:'';const _0x3457b8=[];if(_0x2b4371)_0x3457b8['push'](_0x4296fc['original']);return _0x4334c7&&_0x4bd7a7[_0x446ce2(0x5e7,0x5b1,0x5bb,0x5ee)+'n']&&_0x3457b8[_0x446ce2(0x51f,0x55c,0x57b,0x595)]('('+_0x3aab8f[_0x5e44fd(0x5f0,0x59a,0x55a,0x542)+'n']+')'),_0x3457b8['join']('\x20');}}}};eventSource['on'](eventNames['LLM_TRANSL'+_0x18db5a(-0x34,0x82,0x53,0x2a)+_0x18db5a(-0x8,0x1,-0x9d,-0x44)],_0xe0ca4a);const _0x2d1cb3={};_0x2d1cb3[_0x5b5e35(0x3e2,0x39c,0x3ec,0x3cc)]=_0x551173,_0x2d1cb3['id']=_0x211cb5,eventSource[_0x5b5e35(0x405,0x43f,0x427,0x458)](eventNames[_0x18db5a(0x89,0x59,0xc1,0x6a)+'ATION_REQU'+_0x5b5e35(0x3aa,0x388,0x40c,0x3c1)],_0x2d1cb3),_0x5d6f4e=_0x2e9a0f[_0x5b5e35(0x3b8,0x3af,0x42f,0x3f9)](setTimeout,()=>{function _0x429c78(_0x340f65,_0x9340af,_0xd6cb48,_0x3c009c){return _0x5b5e35(_0x340f65-0x154,_0x340f65,_0xd6cb48-0xb4,_0x3c009c- -0xba);}_0x2e9a0f[_0x11950b(0x26c,0x25e,0x20e,0x21c)](_0x598eb5);function _0x11950b(_0x20e069,_0x2a8ca8,_0x2e0ade,_0x4495e3){return _0x5b5e35(_0x20e069-0x19b,_0x2e0ade,_0x2e0ade-0x129,_0x2a8ca8- -0x1e8);}_0x2e9a0f['TFjCd'](_0x50addb,new Error(_0x11950b(0x276,0x22a,0x25b,0x242)+'时（'+timeoutMs+_0x11950b(0x234,0x21d,0x227,0x1df)));},timeoutMs);}else{if(_0x57b64a){const _0x1b8cc1=_0x161f26['apply'](_0x3e1a2a,arguments);return _0x79e67a=null,_0x1b8cc1;}}});}export async function callTranslation(_0x362015){function _0x56d609(_0x9ff8eb,_0x27276f,_0x5e8c9d,_0x2f7547){return _0xc304(_0x5e8c9d- -0x34,_0x27276f);}function _0xe0c500(_0x4b0ed8,_0x339a8e,_0x36376c,_0x536f6d){return _0xc304(_0x4b0ed8-0x3c6,_0x339a8e);}const _0xef0281={'oUVuB':function(_0x20a4c0,_0x2a86ef,_0x695ec2){return _0x20a4c0(_0x2a86ef,_0x695ec2);},'HfOsF':_0xe0c500(0x641,0x68c,0x68b,0x65c)+'n','knpRI':function(_0x518dba,_0x53c837){return _0x518dba||_0x53c837;},'hQgnU':function(_0x52b81c,_0x5d014d){return _0x52b81c(_0x5d014d);},'tIckp':_0xe0c500(0x5f8,0x5be,0x642,0x5eb)};try{let _0x293d6e=_0xef0281[_0xe0c500(0x642,0x68f,0x64c,0x668)](buildPromptForRequestType,_0xef0281[_0x56d609(0x211,0x231,0x21c,0x277)],_0xef0281[_0xe0c500(0x5cc,0x621,0x61e,0x57c)](_0x362015,''));_0x293d6e=_0xef0281[_0xe0c500(0x60c,0x5d7,0x5d2,0x5b3)](mergeAdjacentMessages,_0x293d6e);const _0xb9008b=[..._0x293d6e,{'role':_0xef0281[_0x56d609(0x295,0x219,0x24b,0x290)],'content':_0xef0281[_0xe0c500(0x5cc,0x5bc,0x5a9,0x5ca)](_0x362015,'')}];_0xef0281[_0xe0c500(0x60c,0x652,0x5d4,0x5b4)](updateCombinedPrompt,_0xb9008b);const _0x58d0be=await _0xef0281[_0xe0c500(0x60c,0x5ff,0x5e9,0x5e4)](LLM_TRANSLATION,_0xb9008b);return _0x58d0be;}catch(_0x2aff94){addLog('翻译失败:\x20'+_0x2aff94[_0xe0c500(0x613,0x60c,0x63e,0x648)]),console[_0xe0c500(0x5f6,0x613,0x61c,0x607)](_0xe0c500(0x5ff,0x5fc,0x5f9,0x65d),_0x2aff94);throw _0x2aff94;}}let isAiInitialized=![];export function initAiSettings(_0x3f7bcd){function _0x11e685(_0x5767e0,_0x287a8a,_0x1eaa20,_0x4e4bf6){return _0xc304(_0x5767e0- -0x25f,_0x4e4bf6);}const _0x3c5b5a={'arMqM':_0x2afca1(0x3da,0x3a9,0x39c,0x3c6),'VQmsZ':function(_0x4c8c3e,_0x20ad20){return _0x4c8c3e(_0x20ad20);},'RffBg':function(_0x44c59d,_0xb468d4){return _0x44c59d(_0xb468d4);},'VwUkV':function(_0x593c57,_0x556217){return _0x593c57===_0x556217;},'JecYF':_0x2afca1(0x39d,0x36b,0x39d,0x3bd),'CBVuW':_0x2afca1(0x388,0x35c,0x39d,0x375)+_0x2afca1(0x40c,0x429,0x403,0x3f4)+_0x11e685(-0x2b,-0x51,-0x42,-0x1a)};function _0x2afca1(_0x1adfca,_0x4407d9,_0x565eec,_0x1854da){return _0xc304(_0x1adfca-0x1ab,_0x4407d9);}if(!isAiInitialized){if(_0x3c5b5a[_0x2afca1(0x41b,0x3fa,0x3fd,0x3f6)](_0x3c5b5a[_0x2afca1(0x42d,0x47c,0x459,0x44e)],_0x3c5b5a[_0x11e685(0x23,0x44,0x7a,-0x24)]))console[_0x11e685(0xf,-0x1c,0x24,-0xd)](_0x3c5b5a[_0x2afca1(0x416,0x3d3,0x45c,0x40c)]),isAiInitialized=!![];else{if(_0xe7a85['error']&&_0x3b4c9a['error'][_0x2afca1(0x38f,0x355,0x353,0x35e)]===_0x3c5b5a[_0x11e685(-0x62,-0x1e,-0x7f,-0x6a)]){const _0x3dd43c=new _0x9fd9b1(_0x4f3888[_0x11e685(-0x2f,-0x34,0x29,-0x19)]['message']);_0x3dd43c['name']=_0x3c5b5a[_0x2afca1(0x3a8,0x3b8,0x3c4,0x38f)],_0x3c5b5a[_0x11e685(-0x7,-0x54,-0x4a,-0x42)](_0x1f38c3,_0x3dd43c);}else _0x3c5b5a[_0x2afca1(0x3ae,0x359,0x3aa,0x39a)](_0x2b563e,new _0x5a413e(_0x3581d9[_0x11e685(-0x6a,-0x89,-0x7f,-0xb6)]));}}}