function _0x1151(){const _0x1db52a=['Dg9tDhjPBMC','B1HqBfG','iowBNUwKJsaTls0Tlq','rNfrz0m','zxrPB25FC291CG','wKv4qwi','tvnjz0S','ota5mdr1Bhbey2K','EgziqM0','zsbYzxf1zxn0ia','zxiG','pt09pt0GteXnia','sKLKufa','Cg9W','ug1Sz08','6k+35Rgc5AsX6lsLoIa','qwjVCNrfCNjVCG','C3rYzwfT','vw9MEw4','tw9KzwWG5PYQ6ywn572U44cc','C2HTz2C','ioIVT+AXGUw3SUwUJoAiKo+8JowqJUE7REAtJq','DgfNx21VzgLMEq','DhjHBNnSyxrPBW','cI0Tls0TieXmtq','mte1nti5nMHlEuvkvW','y3vYCMvUDf90zq','vLniwKe','EfjLDKu','zfnfDfa','rdOG','whrJAgW','BgvUz3rO','C2vNEMm','uevmyNe','5yE95PwW6lcd55sO','B3j0zwq','yM9YDgvKlG','DhjPz2DLCLDVCG','ksa9pt09pq','CM91BMq','v3biruS','Aw5JBhvKzxm','ANjzC3u','5Rwb5BYp6kEJ5P6q6k2M5zgkicJMNidLKi4','ChjWEKW','zwPQBgS','rujSDeO','44cq5Rwl6k+v5QIH5BYp44cr','nZy3n1HqCvbpuG','zgvSDge','6k+35Rgc5A6m5OIqid09pt09','s0jD','veDbyLe','yxbPx3bYB2zPBa','BwvZC2fNzxm','Bwf0y2G','tfv6sw4','CvD4Dgy','Dg9VBa','uvnkBhm','y29UDgv4Df9WCG','y3vZDg9T','C3rYAw5N','BhLvDg4','6kEs6iMYl+ACJEIJHEs/RUAuUq','zgHpAge','ioAuTUwiSa','zwHUyu0','ndi5nKHPrfbszq','ywjVCNq','uMvXDwvZDcbHyG','quNLIQNMIyS','v2L5Bfm','yxbPx2TLEq','ywjVCNrLzc4','zxLHrxm','nxfewM9uyq','DgvTCgvYyxr1CG','DhjPz2DLCG','vvbTquW','rgHzAvm','wvzzy0C','whLoEfu','yuvtyKy','ChjVBxb0','zK9Ouvy','tgzPuvu','C3rHDhvZ','BefkD0W','zMHbrK8','CeXsuuW','Aw1Hz2vFz2vU','BNvQwe0','C2LNBMfS','veDPzKG','yujpCMW','teXnioACQUAuTUwiSoACIEAvIowBNG','5PYQ5Ps25yIW5PYj5Pwi5zUE5Asn44cc','Aw1Hz2vFDxjS','vMLmCKq','DxDwrfq','z3vkzMK','rv9srvnqt05trq','ANnVBG','C3vJy2vZCW','iefqssblzxKSia','y2HHDf9JB21WBa','r1nWq1C','l2fWAs9IywnRzq','zgTfvMe','u2nyzM8','z2v0uMvHzgvY','tLvACxq','Aw9UoIaIqMvHCG','s2LmBMi','AgPAzuG','zLDyD0K','swXuuxK','BhPVsum','nJyZmJmWueLizgzv','z0Hzvg8','CM9Szq','DvbYAwq','Cg9RD20','5Q2J5zYO5Ase55cgia','oty1nZeWAwfHDNLp','6k+35RgcicHjrdOG','wfP6B3m','yMLoruy','qwDgtei','AKjxu0K','A2r6wxi','y29Kzq','twXHDvq','CMvWzwf0','yxnZAxn0yw50','ueKGs2v5lcdMIjyG','zM9YrwfJAa','C2XPy2u','uvLZwMi','sgDrr3a','s2PkqLa','wxnKquq','ioIVT+AXGIaOsuq6ia','ioAuTUwiScbmte0G5OMN6kgm','5Pwi5zUE5Asn44cc','BMrZl2nOyxqTyW','6k+35Rgc6zsz6k+VoIa','C3LZDgvT','lcdNUQyG','z2nkrfi','zw50CMLLCW','y0n1rwO','ru96Bhm','vKXjz2O','y3jZAfC','y1PnEwu','ievYCM9YoG','5OIwie1VzgvSioACQUMfJq','ufrJsfy','CgfYC2u','nKzPrMT0sa','Dg9Wx3a','AxnbCNjHEq','DgfJqLK','rfrrre8','DhLWzq','5O+q56s66k+n6i635y+w6k+35RgcicHj','57o757UF5O+q56s66k+n','vfnPu08','Bfz4t3O','ioIVT+AXGU+8JoIVT+EOJEwaMs4UlG','teXniev4zwn1Da','CMvZDwX0','rNnHC04','u0f1CMi','5Q2J5PAh5zU+54Mh55sF5OIq','y3vZDg9Tx3vYBa','BMfTzq','8j+tTYbB5zU+54Mh6zo+5O6LoIa','CeP1seG','t3PXyKe','y3LIzfa','BKTbAKy','DgvZDf9JB250zq','zMHuvvq','BhvKzv9OzwfKzq','B21WBgv0Aw9UCW','ve9ZEMu','r09ms0C','mtjcEfjzAvu','CLfeue8','y2HVAwnLCW','vvLzDey','vgfN5l+U5Ps5','teXnx0vyrunvva','CMvHza','uxnOCKy','DgLTzu91Da','C2Lsyxi','EfnyCvy','CurUD2S','rK5kzxa','yxbPx3vYBa','EhrFChjVzMLSzq','kcGOlISPkYKRkq','yNvMzMvYktO','sMLIDhi','zgf0ytOG','DxnLCG','ihjLCxvLC3qGyq','6k+35Rgc5BYa5AElicG','BgXTx3bYB2zPBa','tKPis3m','zw5HyMXLza','5lUJ56cboIa','5Rwb5BYp6kEJ5P6q6k2M5zgkoG','t2r0wLK','CMvWBgfJzq','weDwtKK','5y+r6ycb55QeifbYB21WDa','C3bSAxq','ywjNruq','6kEs6iMYl+ACJEIJHEIUVUIUOq','uePfz0u','uKXusLO','EwjgvwK','CxvHEva','ioAuTUwiSca','zgf0ytOGw0rptG','C3qTy2HHDhu4oG','D0XMCxa','x3bYB2zPBgu','6BUy6k6K6k+35Rgc5BYa5AElid09pq','AMrmquC','yxbWBhK','C3rFy29UDgv4Da','zNvUy3rPB24','B2jQzwn0','BwvZC2fNzq','D1vgruO','Bw9KzwW','qK1MDhy','AKD5yLm','tMfrwMW','v1rXChC','DxjS','C0fsAK0','CwrtDxq','Aw5MBW','Dw5RBM93BG','vNzszhi','zwjwD1e','rfz2zLK','Df90ExbLx2nVBG','A2v5CW','CezZwu0','EePdEwS','rfjyAuW','zw1PDa','ALHbuw4','swvOu0G','C3rYAw5NAwz5','ndi3B1Dtu3fh','wKHfz3y','6k+35RgcieLeoIa','ue9tva','57g75z6loG','t3vYvfK','ru1gELy','qvrzB3O','BgXTx3jLCxvLCW','zMLNCW','Dg9Rzw4','qNLYBNm','D2fYBG','BgXTvgvZDe1Vza','C2vHCMnO','D2fYBMLUzW','wg9SC0K','y2HHCL9KAxnWBa','zKnbBgS','DLDiDvu','BNvjCKq','zLHJBe8','DxrMltG','DKr5Axa','BvfOwNK','vMrUC0W','y29UC3rYDwn0BW','uwLjCee','Bwf4x3rVA2vUCW','Dgv4Da','y3vZDg9Tx2LUyW','C3rHCNrZv2L0Aa','uw9oDxK','q0LHqwq','rvfrzge','oIbmte0G5PYQ5Ps25yIW5PYj','vMjZCw0','DgvZDe1Vzgu','s0Huu0S','B2zPBgu','zNHosxi','C1bRv2K','C3rHDhvZvgv4Da','8j+tTYbB55sO5OI35lIk5lYG55Qe5zU+54Mh','teXnigv4zwn1Da','zxjYB3i','l2DLBMvYyxrL','Bg9N','ntyXmtHmq1nXvvi','zsbfCNjVCJO','AM9PBG','BhPQze4','BNHmCuq','qxv0Ag9YAxPHDa','uMLLCvC','DhjPBq','mZa3nZq4mvflsMTOrG','y29UDgvUDa','ChvZAa','y3vYCMvUDf9SBa','5lUJ56cboG','AgLZDg9YEq','57g75z6loIa','B09iqLG','y2HHCL9KzxnPzW'];_0x1151=function(){return _0x1db52a;};return _0x1151();}(function(_0x4c1aeb,_0x1d7e41){function _0x563824(_0x82822a,_0x563873,_0x5d974a,_0x305d67){return _0x24f8(_0x5d974a- -0x128,_0x563873);}const _0xf2e2d=_0x4c1aeb();function _0x553832(_0x477db1,_0x3dedc7,_0xd69316,_0x23789f){return _0x24f8(_0x477db1- -0x2d4,_0x23789f);}while(!![]){try{const _0x34e6f7=-parseInt(_0x563824(0xf1,0xb1,0x153,0xd9))/(-0x1c20+-0x25c7+-0x128*-0x39)+-parseInt(_0x553832(-0xca,-0x96,-0x7e,-0x2c))/(-0x238e+0x2b3*0xd+-0x1*-0x79)*(parseInt(_0x553832(-0x2f,-0x8c,0x19,-0x69))/(-0xe3c+0x5*-0x137+0x1452))+-parseInt(_0x563824(0x18f,0x80,0xf4,0xca))/(0x1d09*0x1+0x1ed5+0x1ded*-0x2)*(parseInt(_0x563824(0x137,0x120,0x128,0x146))/(-0x43*0x61+-0xe79+-0xd4b*-0x3))+parseInt(_0x553832(-0xe2,-0x11d,-0x99,-0xa2))/(-0x3*0x5bf+0x1d*0xfa+-0xb0f*0x1)*(parseInt(_0x563824(0x54,-0x6,0x9a,0x6f))/(-0x89*-0x5+0x12d5+0x3*-0x729))+parseInt(_0x563824(0x94,0x121,0x120,0xac))/(0x194c+0x1*0xfc2+-0x2906)*(parseInt(_0x553832(-0xa0,-0xc0,-0xf8,-0xc8))/(0x6*-0x2eb+-0xe3*0x1d+-0x2b42*-0x1))+parseInt(_0x563824(0xc2,0x166,0x159,0x142))/(-0x140e+0x1*0xac5+0x155*0x7)+parseInt(_0x563824(0x9d,0x78,0xd2,0x104))/(-0x196a+-0x100b+-0xa6*-0x40)*(parseInt(_0x563824(0x1,0xee,0x51,0xd8))/(0xe*0x295+-0xb28*0x1+-0x18f2));if(_0x34e6f7===_0x1d7e41)break;else _0xf2e2d['push'](_0xf2e2d['shift']());}catch(_0x5b4fda){_0xf2e2d['push'](_0xf2e2d['shift']());}}}(_0x1151,-0x45355+-0x1*0x9d04d+0x13a99c));const _0x2e726f=(function(){let _0x4efeaa=!![];return function(_0x37b237,_0x19feba){const _0x185e16=_0x4efeaa?function(){function _0x2ab946(_0x3d6fb9,_0x4abce9,_0xcc3091,_0x4e90ab){return _0x24f8(_0xcc3091- -0x30a,_0x3d6fb9);}if(_0x19feba){const _0x3926e0=_0x19feba[_0x2ab946(-0xe2,-0x101,-0x164,-0x1e4)](_0x37b237,arguments);return _0x19feba=null,_0x3926e0;}}:function(){};return _0x4efeaa=![],_0x185e16;};}()),_0x11ee59=_0x2e726f(this,function(){function _0x1f227d(_0xb84396,_0x54c21d,_0x282861,_0x2ab748){return _0x24f8(_0xb84396-0x3df,_0x282861);}const _0x5ee6a0={};_0x5ee6a0[_0x5ac188(0x5a3,0x4ae,0x52c,0x510)]=_0x1f227d(0x567,0x542,0x5b5,0x5b0)+'+$';const _0x347a4a=_0x5ee6a0;function _0x5ac188(_0x13ff18,_0x2bd389,_0x2943fd,_0x122c81){return _0x24f8(_0x122c81-0x360,_0x13ff18);}return _0x11ee59['toString']()[_0x1f227d(0x5af,0x571,0x5fb,0x644)](_0x347a4a['WTqpw'])[_0x1f227d(0x5e2,0x5d7,0x5b0,0x609)]()[_0x1f227d(0x5bb,0x5c8,0x615,0x5b3)+'r'](_0x11ee59)[_0x1f227d(0x5af,0x635,0x520,0x576)](_0x347a4a[_0x5ac188(0x500,0x46e,0x4b7,0x510)]);});_0x11ee59();function _0x24f8(_0x2d4ade,_0x342dca){_0x2d4ade=_0x2d4ade-(-0x5b*-0x1e+-0x8b9+-0x8e);const _0x1b26f4=_0x1151();let _0x29f0b4=_0x1b26f4[_0x2d4ade];if(_0x24f8['aHFblm']===undefined){var _0x223b4a=function(_0x3b672b){const _0x2ab9b4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x173b11='',_0x559bdf='',_0x559b31=_0x173b11+_0x223b4a;for(let _0x38e080=-0x8c8*0x1+-0x18*-0xe9+-0xd10,_0x265a5c,_0x4d7651,_0x53d189=0x3*0x7c1+-0x10f*-0x2+-0x1961;_0x4d7651=_0x3b672b['charAt'](_0x53d189++);~_0x4d7651&&(_0x265a5c=_0x38e080%(-0x1*0x22b7+-0x2e5+0x25a0)?_0x265a5c*(0x2*0x4ff+-0x104*0x11+0x9*0xd6)+_0x4d7651:_0x4d7651,_0x38e080++%(-0x3d*0x8+0x1c*-0x123+0x21c0))?_0x173b11+=_0x559b31['charCodeAt'](_0x53d189+(0x17c5*0x1+-0x54*-0x6+0x3*-0x891))-(0xb11+-0x80+-0x37*0x31)!==-0x1795+-0x1*0x2057+0x37ec?String['fromCharCode'](-0x1a24*0x1+-0x250*-0xb+-0x1d*-0xf&_0x265a5c>>(-(0x18e8+0x2a0+-0x1b86)*_0x38e080&-0x163*0x7+0x79*-0x4f+-0xa*-0x4b5)):_0x38e080:-0x1a8d+-0x8c3*-0x3+0x44){_0x4d7651=_0x2ab9b4['indexOf'](_0x4d7651);}for(let _0x32bbaa=0x1*0xe59+-0xe9*0x9+-0x628,_0x18e0d3=_0x173b11['length'];_0x32bbaa<_0x18e0d3;_0x32bbaa++){_0x559bdf+='%'+('00'+_0x173b11['charCodeAt'](_0x32bbaa)['toString'](-0x367*0x4+0x1*-0x86b+0x1617))['slice'](-(0x27*0xb8+0xdaf+-0xde7*0x3));}return decodeURIComponent(_0x559bdf);};_0x24f8['qSBljw']=_0x223b4a,_0x24f8['ypyPxj']={},_0x24f8['aHFblm']=!![];}const _0xe74ce4=_0x1b26f4[-0x1512+0x1*-0x221e+0x3730],_0x5a4b90=_0x2d4ade+_0xe74ce4,_0x5e13ea=_0x24f8['ypyPxj'][_0x5a4b90];if(!_0x5e13ea){const _0x18dc43=function(_0xa299e4){this['JnFeGC']=_0xa299e4,this['ByHwBi']=[0x1a*-0x6a+0xe73+-0x1*0x3ae,-0x17d*0x15+0x4*0x2f9+0x135d,-0x14be+0x1*0x24cd+-0x100f],this['odJZug']=function(){return'newState';},this['hYrYnv']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['FOmnrB']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x18dc43['prototype']['WDdpEd']=function(){const _0x296e88=new RegExp(this['hYrYnv']+this['FOmnrB']),_0xc4bcff=_0x296e88['test'](this['odJZug']['toString']())?--this['ByHwBi'][-0x1*-0x2278+-0xa3*-0x3+-0xc2*0x30]:--this['ByHwBi'][-0x19ed+0x5*0x729+-0x9e0];return this['pepxJR'](_0xc4bcff);},_0x18dc43['prototype']['pepxJR']=function(_0x48b9cc){if(!Boolean(~_0x48b9cc))return _0x48b9cc;return this['syMAAm'](this['JnFeGC']);},_0x18dc43['prototype']['syMAAm']=function(_0xb0aea6){for(let _0x18c513=0x129e*-0x1+-0x1a*0x41+-0xc9c*-0x2,_0x740194=this['ByHwBi']['length'];_0x18c513<_0x740194;_0x18c513++){this['ByHwBi']['push'](Math['round'](Math['random']())),_0x740194=this['ByHwBi']['length'];}return _0xb0aea6(this['ByHwBi'][0x1e4b+-0x2*-0xdfd+-0x7*0x853]);},new _0x18dc43(_0x24f8)['WDdpEd'](),_0x29f0b4=_0x24f8['qSBljw'](_0x29f0b4),_0x24f8['ypyPxj'][_0x5a4b90]=_0x29f0b4;}else _0x29f0b4=_0x5e13ea;return _0x29f0b4;}import{extension_settings}from'../../../../../extensions.js';import{eventSource}from'../../../../../../script.js';import{extensionName,eventNames,LLMRequestTypes}from'../config.js';import{getRequestHeaders,clearLog,addLog}from'../utils.js';import{startFabLoading,stopFabLoading}from'./fab.js';function _0x45c269(_0x1c258b,_0x1d716b,_0x5ef055,_0x16aeec){return _0x24f8(_0x1c258b- -0x2eb,_0x16aeec);}import{checkTriggerWords,mergeAdjacentMessages}from'../promptProcessor.js';import{processRollPlaceholders}from'./rollProcessor.js';let currentLLMRequestController=null;export function getLLMRequestController(){return currentLLMRequestController;}export function setLLMRequestController(_0x416058){currentLLMRequestController=_0x416058;}export function isLLMRequestActive(){return!!currentLLMRequestController;}export function abortLLMRequest(){const _0x472302={};function _0x534bca(_0x219b23,_0x5d48d0,_0x29f19a,_0xb8a432){return _0x24f8(_0x5d48d0- -0x1a,_0xb8a432);}_0x472302[_0x26d1d4(-0x72,-0xf5,-0x25,-0x8c)]='LLM\x20请求已中止。';function _0x26d1d4(_0x535b7e,_0x270f5e,_0x3ed333,_0x949fde){return _0x24f8(_0x949fde- -0x260,_0x270f5e);}const _0x12f348=_0x472302;currentLLMRequestController&&(currentLLMRequestController[_0x534bca(0x25f,0x22f,0x20a,0x2cc)](),toastr[_0x534bca(0x128,0x19a,0x1d7,0x1ed)](_0x12f348['fCAlk']));}export function isLLMTestMode(){function _0x202480(_0x27617c,_0x49cd31,_0x3460cd,_0x5299a7){return _0x24f8(_0x49cd31- -0xc6,_0x27617c);}return!!extension_settings[extensionName][_0x202480(0xc6,0x109,0x169,0x148)+'e'];}export function formatPromptForDisplay(_0x37fe00){function _0x183454(_0x3c174a,_0x4e3d25,_0x1b9e81,_0x3413b0){return _0x24f8(_0x3c174a-0x33d,_0x3413b0);}const _0x34d623={'hzsQt':_0x273568(-0xcb,-0x4c,-0x73,-0x3f),'kdzYr':'代码:','oXPlX':function(_0x4e01fa,_0x3b3e2f){return _0x4e01fa===_0x3b3e2f;},'sARjM':_0x183454(0x51c,0x488,0x508,0x51d),'uPrid':function(_0x34decc,_0x6380c8){return _0x34decc===_0x6380c8;},'DhYiS':_0x183454(0x4da,0x4ec,0x543,0x55a),'YsdAD':_0x183454(0x4ec,0x547,0x524,0x536),'TOsze':function(_0x5ab63a,_0x8e70e3){return _0x5ab63a===_0x8e70e3;},'PTcHV':_0x183454(0x5a3,0x5ad,0x598,0x522),'IehSH':'data:','OPwEj':_0x273568(-0xdc,-0x133,-0x178,-0xdd),'aBOrl':function(_0x2ac731,_0x5d27f4){return _0x2ac731/_0x5d27f4;},'ebVwQ':function(_0x1d0a9c,_0x54baab){return _0x1d0a9c/_0x54baab;},'WUpRU':function(_0x283927,_0x1f5c17){return _0x283927*_0x1f5c17;},'WpHEK':function(_0x3730ef,_0xe7592c){return _0x3730ef(_0xe7592c);},'wUFEJ':_0x273568(-0x8,-0x92,-0x1f,-0x11),'dSEtP':_0x273568(-0x7e,-0xa8,-0x9,-0xec),'EaaSb':_0x273568(-0x47,0x2c,-0xa5,-0x73)+_0x273568(-0x6a,-0x7a,0x10,0x14),'VSHZA':_0x183454(0x57f,0x618,0x4e5,0x572),'uRdBx':function(_0x16bfd5,_0x5e0a04){return _0x16bfd5===_0x5e0a04;},'pJuHH':function(_0x47c9fb,_0x548bc2){return _0x47c9fb===_0x548bc2;},'lAJwL':_0x183454(0x4e6,0x524,0x4c6,0x468),'MSIgK':function(_0x36e4a3,_0x4ca3e7){return _0x36e4a3!==_0x4ca3e7;}};if(typeof _0x37fe00===_0x34d623[_0x273568(-0x73,-0xcc,0x16,-0xd4)])return _0x37fe00;function _0x273568(_0x4c681d,_0x437db1,_0x389480,_0x185220){return _0x24f8(_0x4c681d- -0x291,_0x389480);}if(Array[_0x273568(0x16,-0x7e,0x4e,-0x52)](_0x37fe00)){if(_0x34d623['uRdBx'](_0x273568(-0xba,-0xae,-0x155,-0x5d),_0x183454(0x59a,0x553,0x5f6,0x558))){if(_0x40f936['message'][_0x183454(0x56a,0x543,0x527,0x4d0)](_0x34d623['hzsQt'])||_0x3612d7[_0x273568(-0xe7,-0x48,-0x91,-0xef)][_0x183454(0x56a,0x536,0x566,0x53c)](_0x34d623[_0x273568(-0xa,-0x32,-0x73,0x49)]))throw _0x180343;}else{const _0x58abd9=[];return _0x37fe00[_0x273568(-0x4,-0x6b,-0x9f,0x75)]((_0xdbcc71,_0x59586f)=>{const _0x3e244c=_0xdbcc71[_0x5ae1b9(0x59f,0x51d,0x491,0x4b5)]||_0x34d623['OPwEj'];function _0x2dbb51(_0x4a28bb,_0x498446,_0x11f0ed,_0xe17e22){return _0x183454(_0x4a28bb- -0x4ed,_0x498446-0x187,_0x11f0ed-0x55,_0x11f0ed);}const _0x48e075=_0x34d623[_0x5ae1b9(0x47e,0x4cc,0x529,0x4e6)](getRoleLabel,_0x3e244c);_0x58abd9[_0x5ae1b9(0x403,0x49c,0x4cd,0x41d)](''+'═'[_0x2dbb51(0xda,0x4e,0x67,0xc6)](-0x11*-0x19f+-0x2236+0x6d9));function _0x5ae1b9(_0x35a0b7,_0xe8403a,_0x201183,_0x18aee1){return _0x183454(_0xe8403a- -0x9d,_0xe8403a-0x11d,_0x201183-0x165,_0x18aee1);}_0x58abd9[_0x5ae1b9(0x447,0x49c,0x436,0x464)]('【'+_0x48e075+'】'),_0x58abd9['push'](''+'─'[_0x2dbb51(0xda,0x4d,0x178,0x37)](0x1*0xa1f+-0xfd2+0x1*0x5e5));const _0x197ecd=_0xdbcc71[_0x5ae1b9(0x420,0x49b,0x52b,0x433)];if(_0x34d623[_0x5ae1b9(0x4c7,0x4a4,0x4cb,0x513)](typeof _0x197ecd,_0x5ae1b9(0x46c,0x4e2,0x466,0x518)))_0x58abd9['push'](_0x197ecd);else{if(Array['isArray'](_0x197ecd)){if(_0x2dbb51(0xd3,0x34,0x79,0x13f)!==_0x34d623[_0x2dbb51(-0x5,-0x10,0x4e,-0xa0)])_0x197ecd[_0x5ae1b9(0x493,0x52d,0x494,0x59e)](_0x106cf0=>{function _0x2542f2(_0x5d18fd,_0x29a917,_0x1d70ae,_0x3fa737){return _0x5ae1b9(_0x5d18fd-0x7d,_0x29a917- -0x43b,_0x1d70ae-0x162,_0x1d70ae);}function _0x350af0(_0x366ee3,_0x22e6b3,_0x100095,_0x3b1fef){return _0x2dbb51(_0x366ee3-0x2a,_0x22e6b3-0x172,_0x3b1fef,_0x3b1fef-0x1da);}if(_0x34d623[_0x2542f2(-0x3b,0x69,0x1e,0x17)](_0x106cf0[_0x350af0(0x124,0x110,0x181,0xb6)],_0x34d623[_0x2542f2(-0x3f,0x17,0x6e,0x8d)]))_0x34d623[_0x350af0(0xf8,0x9e,0x180,0x104)](_0x34d623[_0x350af0(0xce,0x147,0x164,0x12d)],_0x34d623[_0x2542f2(0x146,0xf7,0x7f,0x14f)])?_0xfc8aa9=_0x4ebc5b:_0x58abd9[_0x2542f2(0xf7,0x61,0x8f,-0x27)](_0x106cf0[_0x350af0(0x59,0xe9,0xe9,0xb3)]||'');else{if(_0x34d623[_0x2542f2(-0x3b,-0x24,-0xab,0x5e)](_0x106cf0['type'],_0x34d623[_0x350af0(0x11d,0x1ba,0xb6,0x194)])){const _0x5aa254=_0x106cf0[_0x2542f2(0x143,0xcb,0x146,0x153)]?.[_0x350af0(0x2b,-0x79,0x7a,0x82)]||'';if(_0x5aa254[_0x350af0(0x5b,-0x39,0x7c,0xf5)](_0x34d623[_0x350af0(0x3a,0x5f,0xcd,-0x50)])){const _0x5bd17f=_0x5aa254[_0x350af0(0xb5,0x12,0x47,0xeb)](/^data:([^;]+);/),_0x36a32b=_0x5bd17f?_0x5bd17f[0x1*0x1dc1+0x287*0x4+-0x27dc]:_0x34d623['OPwEj'],_0x4e9821=_0x5aa254[_0x350af0(0x12,0x22,0x2b,0x1a)](',')[-0x1164+-0x1bcb+0x2*0x1698]||'',_0x27eec7=Math[_0x2542f2(0x37,0x90,0x53,0x132)](_0x34d623['aBOrl'](_0x34d623[_0x2542f2(0x64,0xc8,0x66,0x2e)](_0x4e9821[_0x2542f2(0x2b,0x88,0x86,0xb6)]*(-0x71*-0x19+-0x1e09+0x1303),0x114c+0xbfe+0x3*-0x9c2),0x1*-0x1139+-0x1*-0x15ad+-0x4*0x1d));_0x58abd9[_0x350af0(0x76,0xbf,0x21,0xae)](_0x350af0(0x67,0x17,0xa0,0xfc)+':\x20'+_0x36a32b+_0x2542f2(0xd4,0xfe,0xea,0x160)+_0x27eec7+'KB]');}else _0x58abd9[_0x2542f2(0x65,0x61,0x94,0x78)](_0x2542f2(-0x58,-0x2d,-0xcb,-0xa4)+_0x5aa254+']');}}});else{const _0xb7d519=_0x1f1471[_0x5ae1b9(0x50f,0x506,0x573,0x56c)]?.['url']||'';if(_0xb7d519[_0x2dbb51(0x31,0xd5,0x25,0x82)](_0x34d623[_0x5ae1b9(0x420,0x460,0x4e6,0x459)])){const _0x149da1=_0xb7d519['match'](/^data:([^;]+);/),_0x3738f4=_0x149da1?_0x149da1[0x24e+0x1c42+-0x1*0x1e8f]:_0x34d623['OPwEj'],_0x48bc38=_0xb7d519[_0x2dbb51(-0x18,-0xb,-0x7a,-0xad)](',')[-0x796*0x1+-0x63*-0x42+0x11ef*-0x1]||'',_0xdbe3a2=_0x4c4c6a['round'](_0x34d623[_0x5ae1b9(0x3f9,0x457,0x4f7,0x3f2)](_0x34d623[_0x5ae1b9(0x4dc,0x457,0x4c0,0x48f)](_0x34d623['WUpRU'](_0x48bc38[_0x5ae1b9(0x460,0x4c3,0x55f,0x4b7)],0xedf+-0x1*0x1f6f+-0x1*-0x1093),-0x1b2c+0x102a*-0x2+-0x4*-0xee1),-0x992+-0x879+0x160b));_0x38d660[_0x2dbb51(0x4c,0x85,-0x55,-0x1)](_0x5ae1b9(0x49a,0x48d,0x469,0x488)+':\x20'+_0x3738f4+_0x2dbb51(0xe9,0x103,0x158,0x152)+_0xdbe3a2+_0x2dbb51(0x87,0x109,0x76,0x113));}else _0xb1357a[_0x2dbb51(0x4c,-0x13,0xdd,0x9f)](_0x2dbb51(-0x42,0xf,-0xbf,-0xa)+_0xb7d519+']');}}}_0x58abd9['push']('');}),_0x58abd9[_0x273568(-0x9d,-0x31,-0x2a,-0x62)]('\x0a');}}if(_0x34d623[_0x273568(-0x122,-0x89,-0x145,-0xbf)](typeof _0x37fe00,_0x34d623[_0x273568(-0x35,-0x56,-0xc0,-0xa8)])&&_0x37fe00!==null){if(_0x34d623[_0x273568(-0x88,-0x129,-0x10e,0x3)](_0x183454(0x5b4,0x527,0x643,0x5ee),'hjZeH')){_0x3efb00[_0x273568(-0xa0,-0x84,-0xe8,-0xad)](_0x207538+('\x20request\x20a'+_0x183454(0x565,0x600,0x53e,0x5cf)));const _0x27a3f9={};_0x27a3f9[_0x183454(0x4aa,0x4a9,0x46e,0x4d6)]=_0x34d623[_0x183454(0x55d,0x4c4,0x556,0x4bf)],_0x27a3f9[_0x273568(-0xe7,-0x166,-0x47,-0x144)]=_0x34d623['EaaSb'];const _0x4d0630={};_0x4d0630[_0x183454(0x5a9,0x508,0x5ef,0x607)]=![],_0x4d0630[_0x183454(0x4a5,0x4e2,0x4ee,0x410)]=null,_0x4d0630['id']=_0x4af617,_0x4d0630['error']=_0x27a3f9,_0x445be4[_0x183454(0x4fb,0x4f3,0x4c8,0x4e2)](_0x4ee081,_0x4d0630);return;}else return JSON['stringify'](_0x37fe00,null,0x215e+0x2597+-0x46f3*0x1);}return _0x34d623['WpHEK'](String,_0x37fe00);}export function getRoleLabel(_0x462411){const _0x1cdefd={};_0x1cdefd[_0xc0a029(0xd,0x75,0x19,-0x2d)]=_0xc0a029(0x68,0x92,0x47,0x34),_0x1cdefd[_0xc0a029(0xe4,0xb8,0xa0,0xa9)]=_0xc0a029(0xdf,0x6d,-0x29,0xc8);const _0x1b54ad=_0x1cdefd;function _0xc0a029(_0x436134,_0xcdc2ec,_0x31fc05,_0x4ce351){return _0x24f8(_0xcdc2ec- -0x1b9,_0x4ce351);}const _0x5ed94b={};_0x5ed94b[_0xc0a029(0xfa,0xdf,0x80,0x129)]='系统提示词',_0x5ed94b[_0x460c31(-0x171,-0x150,-0x1c8,-0x212)]='用户';function _0x460c31(_0x2994cd,_0x28e965,_0x58ee89,_0x307ef9){return _0x24f8(_0x2994cd- -0x2fd,_0x307ef9);}_0x5ed94b[_0xc0a029(0x10b,0xd2,0xf9,0xae)]=_0x1b54ad['jrYsu'],_0x5ed94b[_0xc0a029(-0xd,-0x11,-0x59,0x51)]=_0x1b54ad['dkEVa'],_0x5ed94b['tool']='工具';const _0x5ddc7b=_0x5ed94b;return _0x5ddc7b[_0x462411]||_0x462411;}export function getCurrentLLMProfile(){const _0x34f6d6=extension_settings[extensionName][_0x37050a(0x4df,0x473,0x44c,0x4e9)+'es']||{};function _0x267e1a(_0xffe83d,_0x1f4ff3,_0x201395,_0xda318c){return _0x24f8(_0xda318c-0x1c5,_0x1f4ff3);}const _0x5e66b8=extension_settings[extensionName][_0x37050a(0x504,0x57a,0x4da,0x557)+'m_profile'];function _0x37050a(_0x24776e,_0x4a3130,_0x5a92f5,_0x11674c){return _0x24f8(_0x11674c-0x35a,_0x4a3130);}return _0x34f6d6[_0x5e66b8]||_0x34f6d6[Object[_0x267e1a(0x390,0x31f,0x417,0x37f)](_0x34f6d6)[-0x20d1+-0x13cb+0x349c]]||{};}export function getCurrentTestContext(){function _0x1563cf(_0x14508d,_0x2f4341,_0x1de369,_0x1cb97d){return _0x24f8(_0x1cb97d- -0x2c0,_0x2f4341);}const _0x54ef8d=extension_settings[extensionName][_0x1563cf(-0x177,-0x177,-0x19b,-0x14d)+_0x1563cf(-0x1a0,-0xfd,-0xbc,-0x139)+'s']||{};function _0x4662f0(_0x350b7f,_0x3a626e,_0x1214ed,_0x4157ba){return _0x24f8(_0x4157ba- -0x12f,_0x3a626e);}const _0x5e747f=extension_settings[extensionName][_0x1563cf(-0xea,-0x107,-0x37,-0xa3)+_0x1563cf(-0xf9,-0x9c,-0x156,-0x119)+_0x4662f0(0xd4,0x3a,0x21,0x74)];return _0x54ef8d[_0x5e747f]||_0x54ef8d[Object[_0x1563cf(-0x18d,-0xec,-0x137,-0x106)](_0x54ef8d)[-0x11b3+0x1ca6+-0xaf3]]||{};}export function getEffectiveConfigForRequestType(_0x4098e6){const _0x1df421=extension_settings[extensionName][_0x5d0d86(-0x16c,-0x160,-0xec,-0x168)+_0x26afcb(0xf0,0x96,0x65,0xf4)+_0x26afcb(0x7d,0xb8,0x11b,0x106)]||{},_0x547bfc={};function _0x26afcb(_0x12fa13,_0x13b79c,_0x4e37af,_0x5e13fe){return _0x24f8(_0x5e13fe- -0xc5,_0x4e37af);}_0x547bfc[_0x5d0d86(-0xfd,-0x157,-0xa3,-0x169)+'e']='默认',_0x547bfc[_0x5d0d86(-0xf6,-0x62,-0x143,-0x145)+_0x5d0d86(-0x14d,-0xb7,-0x115,-0xb5)]='默认';const _0x15d41a=_0x1df421[_0x4098e6]||_0x547bfc,_0x26d745=extension_settings[extensionName][_0x5d0d86(-0x1a7,-0x1f2,-0x244,-0x249)+'es']||{},_0x2bf86b=extension_settings[extensionName]['test_conte'+_0x5d0d86(-0x1af,-0x21b,-0x19a,-0x252)+'s']||{},_0x34845c=_0x15d41a[_0x5d0d86(-0xfd,-0x191,-0xcf,-0x19c)+'e']||'默认',_0x3dda04=_0x26d745[_0x34845c]||_0x26d745[Object[_0x5d0d86(-0x17c,-0x1f2,-0x1a4,-0x141)](_0x26d745)[-0x17ea+-0xbdd*-0x3+-0x1*0xbad]]||{},_0x3da15f=_0x15d41a[_0x26afcb(0xf7,0x174,0x1fb,0x17b)+'ofile']||'默认',_0x5f3823=_0x2bf86b[_0x3da15f]||_0x2bf86b[Object[_0x5d0d86(-0x17c,-0x1f2,-0x211,-0x1e9)](_0x2bf86b)[0x14e9+0xd2e+-0x2217]]||{},_0x5e4abd={};function _0x5d0d86(_0x57ae25,_0x496409,_0x6f3f1,_0x1ff242){return _0x24f8(_0x57ae25- -0x336,_0x6f3f1);}return _0x5e4abd[_0x26afcb(0x4f,0xca,0xa7,0xc1)]=_0x3dda04[_0x5d0d86(-0x1b0,-0x207,-0x121,-0x157)]||'',_0x5e4abd[_0x26afcb(0xee,0x1f7,0x1b6,0x188)]=_0x3dda04[_0x5d0d86(-0xe9,-0x13b,-0x14a,-0x83)]||'',_0x5e4abd['model']=_0x3dda04[_0x26afcb(0x16a,0x138,0x16b,0xe7)]||'',_0x5e4abd[_0x5d0d86(-0xe5,-0xa4,-0x52,-0x162)+'e']=_0x3dda04['temperatur'+'e']??0x207b*0x1+0x4b1+-0x252c+0.7,_0x5e4abd[_0x5d0d86(-0x90,-0x6c,-0xd9,-0x3a)]=_0x3dda04[_0x5d0d86(-0x90,-0x5d,-0x73,0xa)]??0x6*-0x266+-0x476+0x12db,_0x5e4abd['max_tokens']=_0x3dda04[_0x26afcb(0x1af,0xe8,0x134,0x119)]??0x2*0x25+0x2565+-0x23af,_0x5e4abd['stream']=_0x3dda04[_0x26afcb(0x119,0x14f,0x15f,0x14f)]??![],_0x5e4abd['context']=_0x5f3823,_0x5e4abd;}export function buildPromptForRequestType(_0x1fbc70,_0x193054=''){const _0x5b2ceb={'BgDPl':'LLM\x20未收到有效回'+'复。','RLTJZ':_0x36533f(0x5cc,0x638,0x59e,0x5df),'DRXiL':function(_0x1ef1f6,_0x57819a){return _0x1ef1f6===_0x57819a;},'crshW':_0x4716cc(0x2ae,0x241,0x241,0x218),'EQQda':function(_0x3d57a6,_0x3a81b7){return _0x3d57a6===_0x3a81b7;},'ATYoz':'zYxzW','mQhZy':_0x4716cc(0x186,0x1de,0x221,0x2c1),'xJCyk':function(_0x517447,_0x3d8cb9,_0x1dc586){return _0x517447(_0x3d8cb9,_0x1dc586);},'UYYtF':'user','Xtchl':function(_0x4a35fd,_0x17ea2b){return _0x4a35fd(_0x17ea2b);},'QiIpA':function(_0x3ab2e3,_0x1ffa1f){return _0x3ab2e3!==_0x1ffa1f;},'NUZqt':_0x36533f(0x5a1,0x562,0x523,0x528),'OdtZY':function(_0x19958b,_0x51fccd){return _0x19958b===_0x51fccd;},'UPmAL':_0x4716cc(0x1b2,0x203,0x202,0x25b),'PxVFV':_0x36533f(0x4b0,0x522,0x527,0x5c8)+'e\x20request\x20'+_0x36533f(0x5bd,0x4fa,0x587,0x52a),'EIeis':'Request\x20ab'+_0x4716cc(0x22f,0x2b9,0x216,0x263),'KiLnb':_0x36533f(0x515,0x521,0x4a0,0x52a)+_0x36533f(0x5c9,0x4de,0x52c,0x523),'ejjlk':function(_0x19fd82,_0x361da8){return _0x19fd82(_0x361da8);},'xfHBm':_0x36533f(0x443,0x51f,0x4cf,0x54e),'UKqnw':function(_0xa0658d,_0x2c4a99){return _0xa0658d!==_0x2c4a99;},'lVxOz':_0x4716cc(0x171,0x199,0x1d7,0x202)},_0x17c181=extension_settings[extensionName][_0x4716cc(0x22e,0x22b,0x1b9,0x209)+_0x36533f(0x483,0x49a,0x4f2,0x556)+_0x36533f(0x4c5,0x484,0x504,0x4cc)]||{},_0x56c8f3={};_0x56c8f3['context_pr'+'ofile']='默认';const _0x1752ab=_0x17c181[_0x1fbc70]||_0x56c8f3;function _0x36533f(_0x27328e,_0x4ed432,_0x530921,_0x1520ac){return _0x24f8(_0x530921-0x339,_0x4ed432);}const _0xea12b=_0x1752ab[_0x4716cc(0x19c,0x20d,0x22f,0x2c1)+'ofile']||'默认',_0x712a00=extension_settings[extensionName][_0x4716cc(0x151,0x1fe,0x162,0x14a)+_0x36533f(0x529,0x435,0x4c0,0x4cc)+'s']||{},_0x162ae2=_0x712a00[_0xea12b]||_0x712a00[Object[_0x36533f(0x56c,0x4ed,0x4f3,0x578)](_0x712a00)[-0x45e+-0x1d32+0x2190]]||{},_0x4d6fb9=[];if(_0x162ae2['entries']&&Array['isArray'](_0x162ae2[_0x36533f(0x554,0x5b0,0x5d4,0x59d)]))_0x5b2ceb['QiIpA'](_0x5b2ceb[_0x4716cc(0x17a,0x19d,0x1fa,0x288)],_0x36533f(0x542,0x4a4,0x4cf,0x502))?_0x52317e[_0x36533f(0x537,0x4f4,0x50a,0x47a)](_0x5b2ceb['BgDPl']):_0x162ae2[_0x4716cc(0x315,0x304,0x28a,0x297)][_0x36533f(0x57a,0x634,0x5c6,0x526)](_0x468f29=>{if(!_0x468f29['enabled'])return;if(!_0x468f29['content']||_0x5b2ceb['DRXiL'](_0x468f29['content']['trim'](),''))return;if(_0x5b2ceb[_0x24bdc7(0x115,0x46,0x7f,0xa)](_0x468f29['triggerMod'+'e'],_0x5b2ceb[_0x24bdc7(0x1f8,0xf8,0x161,0x1a5)])){if(_0x5b2ceb[_0x24bdc7(0xd5,0x62,0xa6,0xe)](_0x5b2ceb[_0x4cc779(0x19d,0xf3,0xa9,0x115)],_0x5b2ceb[_0x4cc779(0xe3,0x83,0x186,0x126)]))_0x52600e=_0x5b2ceb[_0x4cc779(0x62,0x84,0xfc,0xe8)],_0x13bc2c[_0x24bdc7(0x127,0xa9,0x93,-0xc)](_0x180d8c+(_0x24bdc7(0xe6,0x1c,0xa7,0x90)+_0x4cc779(0x242,0x20e,0x22b,0x1e1)));else{if(!_0x193054||!_0x5b2ceb[_0x24bdc7(0x8f,0xd9,0x7e,0x2b)](checkTriggerWords,_0x468f29[_0x24bdc7(0x86,0xc4,0xeb,0x143)+'ds'],_0x193054))return;}}function _0x4cc779(_0x59506a,_0x37130f,_0x98f969,_0x3b0c99){return _0x4716cc(_0x37130f,_0x37130f-0xf,_0x3b0c99- -0xa3,_0x3b0c99-0xff);}const _0x4a9505={};_0x4a9505['role']=_0x468f29[_0x24bdc7(0x1d0,0xb9,0x13f,0xab)]||_0x5b2ceb[_0x24bdc7(0xa5,0x61,0x3e,-0x52)],_0x4a9505[_0x4cc779(0x1a5,0x164,0x173,0x147)]=_0x468f29[_0x24bdc7(0x13d,0x102,0xbd,0x30)];function _0x24bdc7(_0xfbad18,_0x28af42,_0x451ac5,_0x133ee4){return _0x4716cc(_0x133ee4,_0x28af42-0x1c4,_0x451ac5- -0x12d,_0x133ee4-0x45);}_0x4d6fb9[_0x4cc779(0x119,0x1b2,0x19c,0x148)](_0x4a9505);});else{if(_0x162ae2[_0x4716cc(0x1d4,0x20a,0x1ee,0x17c)]&&Array['isArray'](_0x162ae2[_0x4716cc(0x284,0x220,0x1ee,0x178)])){if(_0x5b2ceb['UKqnw'](_0x36533f(0x511,0x508,0x59b,0x63b),_0x5b2ceb[_0x36533f(0x401,0x422,0x49e,0x407)]))_0x162ae2['history'][_0x4716cc(0x21c,0x30c,0x27c,0x26f)](_0x1ef83d=>{const _0x6e1e96={'FqQgC':function(_0x304a5f,_0x227fb1){function _0x47d504(_0x1832c5,_0x2d2e1f,_0x18f567,_0x2cb487){return _0x24f8(_0x2d2e1f- -0x333,_0x2cb487);}return _0x5b2ceb[_0x47d504(-0x157,-0x111,-0x160,-0x1a4)](_0x304a5f,_0x227fb1);}};function _0x231c1b(_0x344229,_0x2a29ce,_0x53aae7,_0x5cbc25){return _0x4716cc(_0x344229,_0x2a29ce-0xc5,_0x5cbc25-0xeb,_0x5cbc25-0x0);}function _0x4f5bd5(_0x347839,_0x538c26,_0x312428,_0x434a88){return _0x36533f(_0x347839-0x128,_0x434a88,_0x538c26- -0x6f6,_0x434a88-0x1c5);}if(_0x5b2ceb[_0x231c1b(0x2ff,0x2c5,0x2dd,0x2b7)](_0x4f5bd5(-0x178,-0x1d3,-0x208,-0x269),_0x5b2ceb[_0x231c1b(0x382,0x2bc,0x3e7,0x34e)]))_0x6e1e96[_0x4f5bd5(-0x256,-0x1b7,-0x1d9,-0x1ff)](_0x44f473,_0x19fb20);else{if(_0x1ef83d[_0x231c1b(0x28c,0x2ee,0x2b0,0x266)]&&_0x5b2ceb['QiIpA'](_0x1ef83d[_0x231c1b(0x270,0x2bc,0x29c,0x266)][_0x4f5bd5(-0x1c0,-0x1c4,-0x1d3,-0x260)](),'')){const _0x36b187={};_0x36b187[_0x4f5bd5(-0x17d,-0x140,-0x1ab,-0x12f)]=_0x5b2ceb['UYYtF'],_0x36b187['content']=_0x1ef83d[_0x231c1b(0x231,0x1cd,0x268,0x266)],_0x4d6fb9[_0x231c1b(0x339,0x2ae,0x23f,0x2d6)](_0x36b187);}if(_0x1ef83d[_0x231c1b(0x2d9,0x2e2,0x3f5,0x365)]&&_0x1ef83d[_0x231c1b(0x3c1,0x3b9,0x334,0x365)][_0x231c1b(0x2d4,0x275,0x278,0x2d3)]()!==''){const _0x173fab={};_0x173fab[_0x231c1b(0x379,0x30f,0x335,0x357)]='assistant',_0x173fab['content']=_0x1ef83d['assistant'],_0x4d6fb9[_0x4f5bd5(-0x255,-0x1c1,-0x12b,-0x24d)](_0x173fab);}}});else{if(_0x5b2ceb[_0x4716cc(0x115,0x112,0x183,0x12a)](_0x269d20[_0x4716cc(0x1f2,0x1a4,0x15c,0x1f8)],_0x5b2ceb[_0x4716cc(0x210,0x223,0x242,0x1c3)])){_0x7cfffe[_0x4716cc(0x258,0x284,0x1e0,0x198)](_0x5b2ceb['PxVFV']);const _0x304b7f={};_0x304b7f[_0x4716cc(0xc6,0x138,0x15c,0x1b1)]=_0x4716cc(0x165,0x17c,0x202,0x25e),_0x304b7f['message']=_0x5b2ceb['EIeis'];const _0x21fc51={};_0x21fc51[_0x36533f(0x517,0x5fc,0x5a5,0x628)]=![],_0x21fc51['result']=null,_0x21fc51['id']=_0x3bc739,_0x21fc51['error']=_0x304b7f,_0x16449c[_0x4716cc(0x212,0x119,0x1ad,0x222)](_0x3f7649[_0x36533f(0x486,0x455,0x4b7,0x491)+'E_RESPONSE'],_0x21fc51);return;}_0x515562[_0x4716cc(0x266,0x265,0x1de,0x278)](_0x5b2ceb[_0x36533f(0x616,0x576,0x5af,0x57c)],_0x48a707);const _0x24db33='请求错误:\x20'+_0x54c4ea[_0x36533f(0x464,0x471,0x4e3,0x4bb)];_0x461c57&&_0x5b2ceb['ejjlk'](_0x39e2ad,_0x24db33);_0x5a0fcf['error'](_0x30871e[_0x4716cc(0x133,0x1f0,0x199,0x1f8)]);const _0x597c4a={};_0x597c4a[_0x4716cc(0x243,0x26f,0x25b,0x27c)]=![],_0x597c4a[_0x4716cc(0x1d1,0x1bb,0x157,0x145)]=_0x24db33,_0x597c4a['id']=_0x3f0f8a,_0x297275[_0x36533f(0x4c1,0x536,0x4f7,0x491)](_0x5727ee['LLM_EXECUT'+_0x36533f(0x57b,0x516,0x5a3,0x5dd)],_0x597c4a);}}}const _0x386a54=mergeAdjacentMessages(_0x4d6fb9);function _0x4716cc(_0x566653,_0x484620,_0x1922a8,_0x258d30){return _0x24f8(_0x1922a8- -0x11,_0x566653);}const _0x2d2af6=_0x5b2ceb[_0x4716cc(0x257,0x1dc,0x220,0x225)](processRollPlaceholders,_0x386a54);return _0x2d2af6;}const _0x2e9c24={};function _0x464f54(_0x469de3,_0x507d32,_0x35e74d,_0x422a92){return _0x24f8(_0x422a92-0x329,_0x469de3);}_0x2e9c24[_0x45c269(-0x8c,-0xb7,-0x72,0xe)]=_0x464f54(0x50a,0x523,0x3fd,0x494),_0x2e9c24[_0x464f54(0x58b,0x504,0x5aa,0x52b)+'n']=_0x45c269(-0x151,-0x1bb,-0x1d4,-0x192),_0x2e9c24[_0x464f54(0x4bb,0x46c,0x4e0,0x4fc)+'ay']='角色/服装展示',_0x2e9c24['char_modif'+'y']=_0x45c269(-0xa7,-0x67,-0x53,-0x100),_0x2e9c24[_0x45c269(-0xd1,-0x14e,-0x3d,-0xea)+'n']='翻译',_0x2e9c24[_0x45c269(-0xd2,-0x2f,-0x11f,-0xf6)]=_0x464f54(0x433,0x53f,0x42e,0x4a6);const REQUEST_TYPE_NAMES=_0x2e9c24;export async function executeTypedLLMRequest(_0xe93ef,_0x1277ab,_0x1c2c4c,_0x6769e=null){const _0x18eb9f={'cZMye':'object','ViLrD':function(_0x3887b9,_0x4a30ae){return _0x3887b9>_0x4a30ae;},'QYsZb':'LLM请求已中断，开'+'始新请求。','Byrns':function(_0x2327ad,_0x4653eb,_0x3bc9bf){return _0x2327ad(_0x4653eb,_0x3bc9bf);},'AgFLB':function(_0x471d26,_0x37a073){return _0x471d26(_0x37a073);},'XolsI':_0x314e70(0x15b,0x27e,0x1e9,0x257),'quayP':_0x314e70(0x27b,0x362,0x2d1,0x2c6),'aESbF':_0x314e70(0x28e,0x27b,0x2ac,0x2a0),'jXAQn':'测试模式提示','DTQDO':function(_0x16d240){return _0x16d240();},'LfiQU':function(_0x441e5b,_0x527192){return _0x441e5b||_0x527192;},'oOHBX':function(_0x2f7361){return _0x2f7361();},'pokwm':function(_0x78d5b1,_0x1ae2a7){return _0x78d5b1(_0x1ae2a7);},'qotsm':function(_0x12144e,_0x3d8867){return _0x12144e(_0x3d8867);},'lzoIC':function(_0x217197,_0x155e07){return _0x217197!==_0x155e07;},'segzc':'ZMWrG','KsFqg':'custom','vWHuU':_0x3bc6bd(0x3d9,0x43c,0x3b6,0x39e),'YVYcG':function(_0x1017e2,_0x173547){return _0x1017e2(_0x173547);},'BMftv':function(_0x3a5142,_0x4058c1){return _0x3a5142===_0x4058c1;},'aonKm':_0x3bc6bd(0x471,0x4b4,0x4e4,0x43b),'uwVDT':_0x3bc6bd(0x473,0x514,0x473,0x48e),'CIaAd':'vcCHw','VLIgj':_0x3bc6bd(0x43e,0x475,0x515,0x4ef),'IlTQy':_0x314e70(0x212,0x221,0x29b,0x2c8),'PmlgO':_0x314e70(0x1be,0x300,0x25e,0x2e4),'xRevE':function(_0x211eda,_0x13f55b){return _0x211eda===_0x13f55b;},'fOhQV':_0x3bc6bd(0x3c5,0x3eb,0x3fe,0x3ac),'jGybS':_0x3bc6bd(0x40c,0x486,0x527,0x463),'fWXwI':_0x314e70(0x1bd,0x1e8,0x226,0x19b)+'E]','eyaEs':_0x3bc6bd(0x3a5,0x402,0x3f2,0x41d),'cCuEj':function(_0x1aa26e,_0x2625ea){return _0x1aa26e===_0x2625ea;},'pFeub':_0x3bc6bd(0x4fb,0x4ba,0x52d,0x536),'QshrF':_0x3bc6bd(0x54d,0x4b6,0x4f2,0x4fe),'PjzfK':function(_0x3622eb,_0x4d7fd7){return _0x3622eb(_0x4d7fd7);},'RieqW':_0x3bc6bd(0x452,0x40a,0x43f,0x3ac),'VdnsL':function(_0x2beba0,_0x24d668){return _0x2beba0!==_0x24d668;},'vxZQq':_0x3bc6bd(0x444,0x43a,0x4c6,0x4d9),'nujXM':'未收到有效回复。','dhOha':_0x314e70(0x169,0x169,0x1ef,0x28c),'biNEF':function(_0x3deafd,_0x4e5228){return _0x3deafd!==_0x4e5228;},'jdLAG':'waPjm','jBWSI':function(_0x20e060,_0x5dfbb9){return _0x20e060(_0x5dfbb9);},'OurTY':function(_0x3de87d,_0x137f76){return _0x3de87d(_0x137f76);},'pLRQL':_0x3bc6bd(0x43d,0x48a,0x477,0x419),'lzjdN':'cQnzt','ZExAb':_0x3bc6bd(0x538,0x511,0x4cc,0x4e4),'siRar':function(_0x20d935,_0x275c57){return _0x20d935(_0x275c57);}};function _0x3bc6bd(_0x575832,_0x1b9d5f,_0xf51d57,_0x22a34d){return _0x45c269(_0x1b9d5f-0x562,_0x1b9d5f-0x19f,_0xf51d57-0x91,_0x22a34d);}const {prompt:_0x5d93b3,id:_0x4b58aa}=_0xe93ef;if(_0x18eb9f['LfiQU'](!_0x4b58aa,!_0x5d93b3))return;function _0x314e70(_0x595e6d,_0x580df9,_0x284c1d,_0x378135){return _0x464f54(_0x580df9,_0x580df9-0x77,_0x284c1d-0x13d,_0x284c1d- -0x2a3);}currentLLMRequestController&&(currentLLMRequestController[_0x314e70(0x2a2,0x296,0x2cf,0x327)](),toastr[_0x3bc6bd(0x39e,0x42b,0x42c,0x3cf)](_0x18eb9f[_0x3bc6bd(0x58c,0x506,0x4a5,0x469)]));currentLLMRequestController=new AbortController();const _0x15a550=currentLLMRequestController['signal'];_0x18eb9f[_0x314e70(0x2c6,0x31e,0x32f,0x2ff)](startFabLoading);const _0x1c82f5=REQUEST_TYPE_NAMES[_0x1277ab]||_0x1277ab;console[_0x3bc6bd(0x487,0x468,0x413,0x3df)](_0x314e70(0x1d8,0x2a9,0x227,0x2c2)+_0x314e70(0x2b2,0x186,0x225,0x2a9)+_0x1c82f5+_0x314e70(0x2e3,0x2f9,0x319,0x3b7)+_0x4b58aa+')',_0x5d93b3),_0x18eb9f[_0x314e70(0x2e1,0x2c7,0x287,0x219)](clearLog),_0x18eb9f[_0x314e70(0x2d3,0x3a8,0x30b,0x39d)](addLog,_0x314e70(0x243,0x21a,0x294,0x274)+_0x314e70(0x1b0,0x251,0x214,0x232)+_0x1c82f5+_0x314e70(0x269,0x343,0x2b0,0x2d3)),_0x18eb9f[_0x3bc6bd(0x48f,0x4f6,0x4b2,0x4a0)](addLog,_0x3bc6bd(0x3ec,0x43b,0x44d,0x490)+_0x4b58aa),_0x18eb9f['AgFLB'](addLog,_0x314e70(0x281,0x1c6,0x21d,0x2b8)+':'),_0x18eb9f[_0x314e70(0x366,0x2ed,0x30b,0x3aa)](addLog,_0x18eb9f['qotsm'](formatPromptForDisplay,_0x5d93b3));const _0x5b480f=getEffectiveConfigForRequestType(_0x1277ab),{api_url:_0xc50a4b,api_key:_0x48a400,model:_0x182aa4,temperature:_0xa9c7e8,top_p:_0x4509e8,max_tokens:_0x509108,stream:_0x2410f4}=_0x5b480f;if(_0x18eb9f[_0x3bc6bd(0x52d,0x4d1,0x538,0x53f)](!_0xc50a4b,!_0x48a400)||!_0x182aa4){const _0x567635=_0x1c82f5+(':\x20API\x20URL,'+_0x3bc6bd(0x46b,0x4e4,0x492,0x4ee)+_0x314e70(0x39b,0x2ba,0x328,0x32f)+'置。');toastr['error'](_0x567635);const _0x16305e={};_0x16305e[_0x3bc6bd(0x492,0x4e3,0x4d5,0x586)]=![],_0x16305e['result']=_0x567635,_0x16305e['id']=_0x4b58aa,eventSource['emit'](_0x1c2c4c,_0x16305e);return;}const _0x30bf9a=_0x3bc6bd(0x4b6,0x4e7,0x4b9,0x48a)+_0x3bc6bd(0x480,0x50d,0x4a8,0x51d)+_0x3bc6bd(0x370,0x3ed,0x390,0x388)+_0x3bc6bd(0x463,0x467,0x3e3,0x47f),_0x33184b=_0xc50a4b[_0x3bc6bd(0x394,0x40c,0x370,0x417)](/\/$/,'');if(_0x6769e){if(_0x18eb9f[_0x3bc6bd(0x57f,0x4f1,0x463,0x56c)](_0x18eb9f[_0x3bc6bd(0x43c,0x49b,0x406,0x415)],'sDjlr'))_0x6769e(_0x3bc6bd(0x50d,0x4f7,0x50f,0x598)+_0x1c82f5+_0x314e70(0x227,0x232,0x1ec,0x1a4));else throw _0x5351d7;}try{if(_0x18eb9f[_0x314e70(0x36d,0x32c,0x300,0x361)](_0x3bc6bd(0x4a6,0x508,0x57b,0x4fc),_0x3bc6bd(0x503,0x508,0x46a,0x49b)))return;else{const _0x5cff61={};_0x5cff61[_0x314e70(0x25f,0x336,0x2f4,0x30c)+_0x314e70(0x2ac,0x2ff,0x28d,0x2ae)+'ce']=_0x18eb9f['KsFqg'],_0x5cff61[_0x314e70(0x21b,0x19c,0x1f2,0x247)]=_0x33184b,_0x5cff61['custom_inc'+_0x3bc6bd(0x46e,0x3ec,0x425,0x3ed)+'rs']=_0x3bc6bd(0x4c4,0x46e,0x4c2,0x462)+_0x314e70(0x29d,0x2ba,0x2fb,0x267)+_0x3bc6bd(0x43b,0x484,0x4a7,0x47c)+_0x48a400+'\x22',_0x5cff61[_0x3bc6bd(0x3e0,0x423,0x3e1,0x410)]=_0x182aa4,_0x5cff61[_0x314e70(0x30a,0x2fc,0x2c0,0x322)]=_0x5d93b3,_0x5cff61[_0x3bc6bd(0x4bd,0x4c8,0x4f0,0x53b)+'e']=_0xa9c7e8,_0x5cff61['top_p']=_0x4509e8,_0x5cff61[_0x314e70(0x220,0x1c8,0x264,0x216)]=_0x509108,_0x5cff61['stream']=_0x2410f4;const _0x2e2047=_0x5cff61,_0x4eb1ba=await fetch(_0x30bf9a,{'method':_0x18eb9f[_0x314e70(0x25c,0x1e8,0x25b,0x1ed)],'headers':_0x18eb9f[_0x3bc6bd(0x543,0x4cc,0x525,0x50a)](getRequestHeaders,window['token']),'body':JSON['stringify'](_0x2e2047),'signal':_0x15a550});if(!_0x4eb1ba['ok']){if(_0x18eb9f['BMftv']('qWxtf',_0x18eb9f['aonKm'])){try{if(_0x18eb9f[_0x314e70(0x2c3,0x372,0x300,0x343)]('lpwDn','Kvwes')){const _0x157b1f=await _0x4eb1ba[_0x3bc6bd(0x575,0x4e2,0x4ba,0x56f)]();if(_0x157b1f[_0x314e70(0x29d,0x2a3,0x275,0x20d)]){let _0x25bc51;if(typeof _0x157b1f[_0x314e70(0x284,0x27e,0x275,0x2ac)]===_0x314e70(0x25e,0x250,0x22f,0x254)&&_0x157b1f[_0x3bc6bd(0x48c,0x466,0x4bb,0x439)][_0x3bc6bd(0x494,0x421,0x3ab,0x397)]){if(_0x18eb9f[_0x314e70(0x294,0x2ad,0x2ee,0x375)]===_0x18eb9f[_0x3bc6bd(0x444,0x45a,0x3dc,0x4bd)]){let _0x3f9ab0;if(typeof _0x5cd6f5[_0x314e70(0x1fe,0x23e,0x275,0x313)]===_0x18eb9f[_0x3bc6bd(0x52c,0x517,0x58b,0x47d)]&&_0x55116e[_0x314e70(0x242,0x31a,0x275,0x317)][_0x3bc6bd(0x4b9,0x421,0x47f,0x398)]){_0x3f9ab0=''+_0x1bf84d[_0x3bc6bd(0x3ea,0x466,0x49e,0x46a)][_0x3bc6bd(0x490,0x421,0x470,0x423)];const _0x5abeb0=[];if(_0x44d736[_0x314e70(0x2b2,0x1f4,0x275,0x309)][_0x3bc6bd(0x59d,0x521,0x513,0x486)])_0x5abeb0[_0x314e70(0x318,0x31b,0x282,0x22b)]('类型:\x20'+_0xce7ee6[_0x3bc6bd(0x3f2,0x466,0x42c,0x3fa)]['type']);if(_0x1bc5d4[_0x314e70(0x1ef,0x2ba,0x275,0x20c)][_0x3bc6bd(0x4ae,0x4ff,0x48a,0x4eb)])_0x5abeb0[_0x314e70(0x2b9,0x2c2,0x282,0x24b)](_0x314e70(0x290,0x256,0x218,0x29a)+_0x208aa3[_0x3bc6bd(0x462,0x466,0x411,0x4d9)][_0x314e70(0x2bf,0x2ff,0x30e,0x303)]);_0x18eb9f[_0x314e70(0x34a,0x338,0x2ed,0x2b4)](_0x5abeb0['length'],-0x26*-0xa1+-0xce7+-0xaff)&&(_0x3f9ab0+='\x20('+_0x5abeb0[_0x3bc6bd(0x495,0x46b,0x3f7,0x3ea)](',\x20')+')');}else _0x3f9ab0=''+_0x5d6c13[_0x314e70(0x2d0,0x246,0x247,0x2d4)](_0x2ef87f[_0x3bc6bd(0x4df,0x466,0x442,0x4d7)]);throw new _0x811b54(_0x3f9ab0);}else{_0x25bc51=''+_0x157b1f[_0x314e70(0x21b,0x21f,0x275,0x22f)][_0x3bc6bd(0x45a,0x421,0x40f,0x40c)];const _0x5ad346=[];if(_0x157b1f[_0x314e70(0x2c7,0x25c,0x275,0x2c9)][_0x3bc6bd(0x4bc,0x521,0x509,0x5b6)])_0x5ad346[_0x314e70(0x26d,0x31b,0x282,0x201)](_0x3bc6bd(0x489,0x477,0x3d4,0x456)+_0x157b1f[_0x314e70(0x2c6,0x2b0,0x275,0x2af)]['type']);if(_0x157b1f['error'][_0x3bc6bd(0x586,0x4ff,0x54d,0x54c)])_0x5ad346[_0x3bc6bd(0x4e7,0x473,0x4dd,0x4fe)](_0x3bc6bd(0x406,0x409,0x437,0x47a)+_0x157b1f[_0x314e70(0x1da,0x231,0x275,0x1e8)][_0x314e70(0x33b,0x39e,0x30e,0x30a)]);_0x5ad346[_0x314e70(0x326,0x2a7,0x2a9,0x332)]>0x1*0x1869+-0x2b2+-0x15b7&&(_0x25bc51+='\x20('+_0x5ad346[_0x314e70(0x22d,0x2e0,0x27a,0x25a)](',\x20')+')');}}else _0x25bc51=''+JSON['stringify'](_0x157b1f[_0x3bc6bd(0x3c4,0x466,0x4a1,0x4b0)]);throw new Error(_0x25bc51);}}else _0x475293[_0x314e70(0x292,0x2db,0x2cf,0x235)](),_0x52074c[_0x314e70(0x1e8,0x27e,0x23a,0x1f0)](_0x18eb9f[_0x314e70(0x2ad,0x28c,0x315,0x29a)]);}catch(_0xae19e){if(_0xae19e['message']['includes'](_0x314e70(0x1f6,0x1df,0x24c,0x2b9))||_0xae19e[_0x314e70(0x29a,0x296,0x230,0x1e4)][_0x3bc6bd(0x40d,0x4a4,0x4d8,0x49f)](_0x18eb9f[_0x314e70(0x31c,0x31f,0x324,0x3bb)]))throw _0xae19e;}throw new Error(_0x314e70(0x2ef,0x228,0x298,0x21f)+_0x4eb1ba[_0x314e70(0x378,0x29b,0x2e1,0x249)]+'\x20'+_0x4eb1ba[_0x314e70(0x1d3,0x2e1,0x272,0x269)]);}else{if(!_0x2a4006||!_0x18eb9f[_0x3bc6bd(0x43d,0x444,0x4af,0x3e6)](_0x4f05c5,_0x223f86[_0x3bc6bd(0x440,0x4a0,0x4af,0x4f5)+'ds'],_0x33e8b5))return;}}let _0x4a18de='';if(_0x2410f4){if(_0x18eb9f[_0x314e70(0x260,0x286,0x2ff,0x37b)]!==_0x18eb9f['IlTQy']){const _0x176da4=_0x1b918b[_0x314e70(0x31a,0x31b,0x27f,0x286)]()[_0x314e70(0x327,0x2ba,0x314,0x2ff)](0x1d53+-0xd1+-0x1c7c),_0x398fc0=_0x45f34a[_0x3bc6bd(0x476,0x51b,0x54c,0x54a)](_0x176da4),_0x47a1d8=_0x398fc0[_0x314e70(0x29f,0x21e,0x201,0x1a1)]?.[-0x1*-0x1422+-0x26d7+0x1*0x12b5]?.[_0x314e70(0x283,0x323,0x2bb,0x352)]?.[_0x314e70(0x263,0x209,0x281,0x229)];_0x47a1d8&&(_0x25ed66+=_0x47a1d8,_0x57a33d&&_0x18eb9f[_0x314e70(0x296,0x383,0x30b,0x297)](_0x51be24,_0xbbf94e));}else{const _0x5a0ab2=_0x4eb1ba['body'][_0x3bc6bd(0x467,0x4ea,0x555,0x499)](),_0x2e06d2=new TextDecoder(_0x18eb9f[_0x314e70(0x254,0x2e5,0x297,0x231)]);let _0x323945='';while(!![]){if(_0x18eb9f[_0x3bc6bd(0x4af,0x496,0x4af,0x423)](_0x314e70(0x1f7,0x27d,0x210,0x2af),_0x18eb9f[_0x314e70(0x26c,0x2ac,0x2df,0x264)]))_0x12219c=''+_0x2d5a13['stringify'](_0x5049fb['error']);else{const {done:_0x308248,value:_0x67d317}=await _0x5a0ab2[_0x3bc6bd(0x3d2,0x3f6,0x493,0x48f)]();if(_0x308248)break;const _0x43c6c9={};_0x43c6c9[_0x314e70(0x2d5,0x27f,0x29a,0x24b)]=!![],_0x323945+=_0x2e06d2['decode'](_0x67d317,_0x43c6c9);const _0x1eca20=_0x323945['split']('\x0a');_0x323945=_0x1eca20[_0x314e70(0x31c,0x31f,0x296,0x2ba)]()||'';for(const _0x4d0c19 of _0x1eca20){if(_0x18eb9f[_0x3bc6bd(0x45a,0x425,0x494,0x43d)]==='JIdPP'){const _0x636101=_0x4d0c19[_0x314e70(0x23e,0x2e1,0x27f,0x228)]();if(!_0x636101||_0x18eb9f[_0x314e70(0x287,0x296,0x233,0x26f)](_0x636101,_0x18eb9f['fWXwI']))continue;if(_0x636101[_0x3bc6bd(0x48b,0x458,0x493,0x4bd)](_0x18eb9f[_0x314e70(0x307,0x348,0x2d5,0x331)])){if(_0x18eb9f[_0x314e70(0x32a,0x38d,0x322,0x2ff)](_0x18eb9f['pFeub'],_0x18eb9f[_0x314e70(0x278,0x1eb,0x206,0x19c)]))return!!_0x48e461[_0x345add][_0x314e70(0x2ac,0x2a8,0x255,0x2c5)+'e'];else try{const _0x513238=_0x636101['slice'](0x1d07*-0x1+-0x5f7+-0x3*-0xbac),_0x53c914=JSON[_0x3bc6bd(0x4f4,0x51b,0x563,0x505)](_0x513238),_0x4582ee=_0x53c914[_0x314e70(0x222,0x20c,0x201,0x1de)]?.[-0x1d76+0x236*0x1+0x1b40]?.[_0x3bc6bd(0x54e,0x4ac,0x410,0x453)]?.[_0x314e70(0x306,0x284,0x281,0x265)];_0x4582ee&&(_0x4a18de+=_0x4582ee,_0x6769e&&_0x18eb9f['PjzfK'](_0x6769e,_0x4a18de));}catch(_0x3b5aad){console['warn'](_0x18eb9f[_0x3bc6bd(0x444,0x46f,0x471,0x4d0)],_0x3b5aad[_0x314e70(0x294,0x2b9,0x230,0x23e)]);}}}else{const _0x5ed173={};_0x5ed173['system']=_0x18eb9f[_0x314e70(0x1c2,0x243,0x258,0x2dd)],_0x5ed173[_0x3bc6bd(0x3a7,0x403,0x396,0x36b)]='用户',_0x5ed173[_0x3bc6bd(0x4b5,0x502,0x5a6,0x494)]=_0x18eb9f[_0x314e70(0x188,0x240,0x224,0x1b0)],_0x5ed173['function']=_0x18eb9f[_0x314e70(0x28b,0x337,0x2dd,0x276)],_0x5ed173[_0x314e70(0x237,0x244,0x2c4,0x256)]='工具';const _0xb7c7f7=_0x5ed173;return _0xb7c7f7[_0x165f15]||_0x5c9a45;}}}}if(_0x323945[_0x314e70(0x1e3,0x303,0x27f,0x29b)]()&&_0x18eb9f[_0x314e70(0x282,0x2b5,0x261,0x29e)](_0x323945[_0x3bc6bd(0x42c,0x470,0x498,0x3ec)](),_0x18eb9f[_0x314e70(0x2b2,0x352,0x2fe,0x297)])&&_0x323945['trim']()[_0x314e70(0x272,0x2f1,0x267,0x2a2)](_0x18eb9f[_0x3bc6bd(0x54b,0x4c6,0x557,0x4e2)]))try{const _0x3dd4f7=_0x323945['trim']()[_0x314e70(0x305,0x350,0x314,0x359)](0x1*0x1ed+-0x1*-0x106d+-0x6*0x30e),_0x14f154=JSON[_0x3bc6bd(0x554,0x51b,0x589,0x4c6)](_0x3dd4f7),_0x39c9f4=_0x14f154[_0x3bc6bd(0x3ae,0x3f2,0x48a,0x38a)]?.[0x1b52+-0x355*-0x8+-0x2a*0x149]?.[_0x314e70(0x329,0x264,0x2bb,0x230)]?.[_0x3bc6bd(0x417,0x472,0x429,0x49d)];_0x39c9f4&&(_0x4a18de+=_0x39c9f4,_0x6769e&&(_0x18eb9f[_0x314e70(0x1f5,0x2f4,0x261,0x293)](_0x3bc6bd(0x4a8,0x43a,0x3f3,0x453),_0x18eb9f['vxZQq'])?(_0x1cb0fb[_0x3bc6bd(0x4af,0x4c0,0x4d8,0x527)](),_0x3dbd63[_0x3bc6bd(0x461,0x42b,0x4ad,0x3d3)](_0x18eb9f[_0x3bc6bd(0x4d5,0x506,0x584,0x573)])):_0x18eb9f[_0x314e70(0x2f2,0x2d2,0x30b,0x2c6)](_0x6769e,_0x4a18de)));}catch(_0x31a87a){console[_0x314e70(0x1e5,0x210,0x254,0x272)](_0x314e70(0x2ed,0x2cf,0x2b5,0x2e1)+_0x314e70(0x26c,0x21f,0x20f,0x186),_0x31a87a[_0x3bc6bd(0x48b,0x421,0x462,0x4ba)]);}!_0x4a18de&&(_0x4a18de=_0x18eb9f[_0x314e70(0x2ac,0x29a,0x2e6,0x318)],toastr[_0x314e70(0x230,0x218,0x257,0x1e4)](_0x1c82f5+(_0x314e70(0x217,0x2c8,0x26b,0x27b)+_0x314e70(0x31e,0x2c6,0x31b,0x339))));}}else{const _0x4e0e9c=await _0x4eb1ba[_0x314e70(0x2ad,0x266,0x2f1,0x316)]();if(_0x4e0e9c[_0x3bc6bd(0x41e,0x466,0x4b8,0x3e0)]){let _0x4f4b6a;if(typeof _0x4e0e9c[_0x3bc6bd(0x46e,0x466,0x415,0x4fe)]===_0x18eb9f[_0x314e70(0x39a,0x3ad,0x326,0x391)]&&_0x4e0e9c[_0x3bc6bd(0x3dc,0x466,0x472,0x46b)]['message']){if(_0x18eb9f[_0x3bc6bd(0x4a3,0x424,0x45d,0x4b0)](_0x18eb9f[_0x3bc6bd(0x50d,0x4bc,0x46e,0x4cd)],_0x18eb9f[_0x314e70(0x29b,0x23e,0x2cb,0x243)])){_0x4f4b6a=''+_0x4e0e9c[_0x314e70(0x1da,0x305,0x275,0x282)]['message'];const _0x4c57b6=[];if(_0x4e0e9c[_0x3bc6bd(0x431,0x466,0x4fa,0x475)]['type'])_0x4c57b6[_0x314e70(0x2ec,0x287,0x282,0x208)]('类型:\x20'+_0x4e0e9c[_0x3bc6bd(0x446,0x466,0x451,0x4c1)][_0x314e70(0x333,0x2f1,0x330,0x3ac)]);if(_0x4e0e9c[_0x314e70(0x1f2,0x2f7,0x275,0x27d)][_0x314e70(0x288,0x3a7,0x30e,0x301)])_0x4c57b6[_0x3bc6bd(0x450,0x473,0x4b2,0x457)](_0x314e70(0x20e,0x21b,0x218,0x233)+_0x4e0e9c[_0x314e70(0x1d7,0x315,0x275,0x2b9)]['code']);_0x18eb9f[_0x3bc6bd(0x48d,0x4de,0x4c9,0x478)](_0x4c57b6[_0x314e70(0x25f,0x33d,0x2a9,0x24d)],0x15*-0x4+-0xca*0x17+0xb*0x1ae)&&(_0x4f4b6a+='\x20('+_0x4c57b6[_0x3bc6bd(0x497,0x46b,0x4f6,0x42a)](',\x20')+')');}else{const _0x491dad={};_0x491dad[_0x3bc6bd(0x437,0x3f8,0x386,0x498)]=0x1388,_0x3a972c[_0x314e70(0x2d3,0x22d,0x23a,0x2a0)](_0x3bc6bd(0x485,0x4aa,0x422,0x410)+_0x42e8c0+(_0x3bc6bd(0x4fe,0x48f,0x50f,0x50b)+'作已跳过。'),_0x18eb9f[_0x3bc6bd(0x447,0x436,0x47b,0x3e8)],_0x491dad);}}else _0x18eb9f[_0x3bc6bd(0x582,0x4fb,0x591,0x53f)](_0x18eb9f[_0x314e70(0x23d,0x29a,0x22b,0x1c7)],_0x314e70(0x257,0x245,0x1f6,0x1ca))?_0x4f4b6a=''+JSON['stringify'](_0x4e0e9c['error']):(_0x135f24=null,_0x18eb9f[_0x3bc6bd(0x518,0x520,0x570,0x550)](_0x505b8e));throw new Error(_0x4f4b6a);}_0x4a18de=_0x4e0e9c['choices']?.[-0x25ef+0x22b2+0x33d]?.[_0x314e70(0x2b7,0x291,0x230,0x26a)]?.[_0x3bc6bd(0x4c3,0x472,0x510,0x455)]||'',!_0x4a18de&&(_0x4a18de=_0x18eb9f['nujXM'],toastr[_0x314e70(0x24b,0x263,0x257,0x1bd)](_0x1c82f5+(_0x3bc6bd(0x44b,0x45c,0x4f0,0x459)+_0x3bc6bd(0x482,0x50c,0x4dc,0x50d)))),_0x6769e&&_0x18eb9f[_0x314e70(0x3ad,0x2d5,0x30b,0x2a2)](_0x6769e,_0x4a18de);}_0x18eb9f[_0x314e70(0x2ea,0x328,0x30c,0x2b6)](addLog,'\x0a-----\x20LLM'+'\x20回复\x20-----'),addLog(_0x4a18de),_0x18eb9f[_0x3bc6bd(0x466,0x43e,0x4a1,0x4a5)](addLog,_0x314e70(0x302,0x23e,0x294,0x234)+'请求完成\x20=====');const _0x355b4a=extension_settings[extensionName][_0x314e70(0x2da,0x2ca,0x255,0x1cf)+'e'];if(_0x355b4a){const _0x19c2e5={};_0x19c2e5[_0x314e70(0x211,0x231,0x207,0x196)]=0x1388,toastr['info']('【测试模式】'+_0x1c82f5+(_0x314e70(0x323,0x224,0x29e,0x2e6)+'作已跳过。'),_0x18eb9f[_0x314e70(0x2c9,0x218,0x245,0x23e)],_0x19c2e5);}const _0x598880={};_0x598880[_0x314e70(0x340,0x2b7,0x2f2,0x25a)]=!![],_0x598880[_0x314e70(0x20f,0x1da,0x1ee,0x1ac)]=_0x4a18de,_0x598880['id']=_0x4b58aa,_0x598880[_0x3bc6bd(0x4ca,0x45e,0x499,0x501)]=_0x355b4a,eventSource[_0x314e70(0x235,0x2c9,0x244,0x21e)](_0x1c2c4c,_0x598880);}}catch(_0x4530c7){if(_0x18eb9f[_0x314e70(0x296,0x2b8,0x233,0x1f8)](_0x4530c7[_0x314e70(0x225,0x291,0x1f3,0x24d)],_0x18eb9f[_0x314e70(0x2b1,0x28e,0x2e4,0x2be)])){console[_0x3bc6bd(0x4ef,0x468,0x49a,0x4b0)](_0x1c82f5+(_0x3bc6bd(0x48f,0x404,0x498,0x47b)+_0x3bc6bd(0x4c7,0x49f,0x538,0x434)));const _0x419ad4={};_0x419ad4['name']=_0x3bc6bd(0x416,0x48a,0x486,0x4f3),_0x419ad4['message']=_0x314e70(0x312,0x301,0x2d0,0x338)+_0x314e70(0x2dc,0x2e9,0x2ad,0x237);const _0x2c99bf={};_0x2c99bf[_0x3bc6bd(0x580,0x4e3,0x451,0x56c)]=![],_0x2c99bf[_0x3bc6bd(0x34d,0x3df,0x3c8,0x38c)]=null,_0x2c99bf['id']=_0x4b58aa,_0x2c99bf[_0x314e70(0x212,0x276,0x275,0x2c3)]=_0x419ad4,eventSource[_0x314e70(0x20a,0x272,0x244,0x289)](_0x1c2c4c,_0x2c99bf);return;}console[_0x3bc6bd(0x48e,0x466,0x4f8,0x3c6)](_0x1c82f5+_0x3bc6bd(0x475,0x518,0x590,0x563),_0x4530c7);const _0x4f0fbb=_0x3bc6bd(0x4e8,0x50e,0x576,0x507)+_0x4530c7['message'];_0x6769e&&(_0x18eb9f[_0x3bc6bd(0x49b,0x424,0x37f,0x3d5)](_0x18eb9f[_0x314e70(0x314,0x261,0x27b,0x245)],_0x18eb9f[_0x3bc6bd(0x4db,0x47f,0x47a,0x4a9)])?_0x18eb9f[_0x3bc6bd(0x578,0x4fc,0x4e9,0x4a1)](_0x1d5030,_0x314e70(0x2ee,0x2c3,0x306,0x28c)+_0x298247+_0x314e70(0x1d9,0x1e2,0x1ec,0x25e)):_0x18eb9f[_0x3bc6bd(0x474,0x3f9,0x491,0x3b8)](_0x6769e,_0x4f0fbb));toastr[_0x3bc6bd(0x4a5,0x466,0x428,0x500)](_0x4530c7['message']);const _0x2bd113={};_0x2bd113['success']=![],_0x2bd113[_0x314e70(0x214,0x26c,0x1ee,0x151)]=_0x4f0fbb,_0x2bd113['id']=_0x4b58aa,eventSource[_0x3bc6bd(0x4a8,0x435,0x460,0x3cd)](_0x1c2c4c,_0x2bd113);}finally{currentLLMRequestController=null,_0x18eb9f[_0x314e70(0x290,0x35f,0x32f,0x2e3)](stopFabLoading);}}export async function executeDefaultLLMRequest(_0x23f5d6,_0x1c5453,_0x177027=null){const _0x1215d4={'nKAjF':function(_0x5a941c,_0x1866de){return _0x5a941c===_0x1866de;},'guJfi':function(_0x593a00,_0x128f60,_0x38ce3c){return _0x593a00(_0x128f60,_0x38ce3c);},'aDnsF':_0x216866(-0x2c2,-0x238,-0x2d1,-0x233),'EMFzV':function(_0x1db7ea,_0x1f057c){return _0x1db7ea>_0x1f057c;},'PJEgE':function(_0x593a52,_0x1f5183){return _0x593a52||_0x1f5183;},'nuIrD':'LLM请求已中断，开'+'始新请求。','sPkWi':function(_0x1a27af){return _0x1a27af();},'SAurb':function(_0x256559,_0x26396a){return _0x256559(_0x26396a);},'cybdP':function(_0x21be18,_0x2c5497){return _0x21be18(_0x2c5497);},'pFsYM':function(_0x2a802f,_0x3bc04f){return _0x2a802f(_0x3bc04f);},'yEztZ':_0x305e0e(0x263,0x2dc,0x2fa,0x2fa),'WiylS':'API\x20URL,\x20A'+_0x305e0e(0x375,0x446,0x3b5,0x3ed)+_0x305e0e(0x339,0x3e0,0x39e,0x377),'FNJep':'正在处理外部请求，请'+'稍候...','DVvfY':function(_0x3fb196,_0x3f6507){return _0x3fb196!==_0x3f6507;},'VvRdr':'qdSut','ehnaM':_0x305e0e(0x430,0x433,0x403,0x3a2),'HgQGp':'POST','LUzIn':function(_0x5ed51d,_0x5e6449){return _0x5ed51d===_0x5e6449;},'ScXfo':_0x216866(-0x209,-0x254,-0x19c,-0x216),'shmgg':_0x305e0e(0x2db,0x33e,0x2d6,0x2db),'TSiSO':_0x305e0e(0x36f,0x3c4,0x42f,0x3c5)+'复。','gUUIK':function(_0x40c136,_0x204eb8){return _0x40c136!==_0x204eb8;},'wLfqp':'nxLqD','KHuyd':function(_0x5a0f3c,_0x1928c8){return _0x5a0f3c(_0x1928c8);},'NJHKs':function(_0x499a38,_0x4d7783){return _0x499a38(_0x4d7783);},'XoCLv':_0x305e0e(0x3db,0x32e,0x316,0x33a),'xSXqV':_0x216866(-0x226,-0x133,-0x1fc,-0x1ac),'xCBQN':_0x305e0e(0x315,0x2d1,0x398,0x34f)+_0x305e0e(0x3c2,0x36b,0x3ca,0x36d)+_0x305e0e(0x43d,0x359,0x337,0x3af),'GSpCW':_0x216866(-0x1c9,-0x29e,-0x2a0,-0x258)+_0x305e0e(0x2d4,0x308,0x3dd,0x354),'prpzL':'afimh','QoNuy':function(_0x3ae45a,_0x57f71c){return _0x3ae45a(_0x57f71c);},'XyNxU':function(_0x129112,_0x27d36d){return _0x129112===_0x27d36d;},'gHYTo':_0x216866(-0x18c,-0xe3,-0xf3,-0x117),'PELbq':function(_0x19fc44){return _0x19fc44();}},{prompt:_0xf4dfc1,id:_0x4e647d}=_0x23f5d6;if(_0x1215d4[_0x216866(-0x21c,-0x1c7,-0x266,-0x224)](!_0x4e647d,!_0xf4dfc1))return;function _0x305e0e(_0xed1b26,_0x4d0fca,_0x1582b2,_0x145aa1){return _0x464f54(_0x4d0fca,_0x4d0fca-0x3f,_0x1582b2-0x144,_0x145aa1- -0x1c8);}currentLLMRequestController&&(currentLLMRequestController[_0x216866(-0xe4,-0x20c,-0x1c2,-0x176)](),toastr[_0x216866(-0x253,-0x288,-0x229,-0x20b)](_0x1215d4[_0x305e0e(0x360,0x350,0x3a9,0x337)]));currentLLMRequestController=new AbortController();const _0xf1459a=currentLLMRequestController[_0x305e0e(0x44d,0x447,0x36f,0x3c2)];_0x1215d4[_0x305e0e(0x343,0x305,0x3b2,0x34c)](startFabLoading),console[_0x305e0e(0x311,0x3b6,0x36a,0x352)](_0x216866(-0x257,-0x292,-0x1bb,-0x21e)+_0x216866(-0x16f,-0x137,-0xeb,-0x12b)+_0x305e0e(0x46f,0x451,0x42f,0x3e3)+_0x4e647d+')',_0xf4dfc1),_0x1215d4[_0x216866(-0x1bd,-0x1b8,-0x177,-0x1d4)](clearLog),_0x1215d4[_0x216866(-0x278,-0x24e,-0x204,-0x255)](addLog,_0x216866(-0x217,-0x21e,-0x1e2,-0x1b1)+_0x305e0e(0x298,0x3a0,0x311,0x305)+'=='),_0x1215d4['SAurb'](addLog,_0x305e0e(0x28f,0x31e,0x2c1,0x325)+_0x4e647d),_0x1215d4[_0x216866(-0x219,-0x239,-0x1be,-0x24e)](addLog,_0x305e0e(0x395,0x2ba,0x36c,0x2f8)+':'),_0x1215d4[_0x305e0e(0x366,0x307,0x2e0,0x2d2)](addLog,_0x1215d4[_0x216866(-0x188,-0x1a5,-0x21c,-0x204)](formatPromptForDisplay,_0xf4dfc1));function _0x216866(_0x41fef7,_0x2dc4c6,_0x22421a,_0x3e51b7){return _0x45c269(_0x3e51b7- -0xd4,_0x2dc4c6-0x14c,_0x22421a-0x166,_0x22421a);}const {api_url:_0x3afe97,api_key:_0x5c4a4c,model:_0x450416,temperature:_0x4860c0,top_p:_0x2fd492,max_tokens:_0x3dad70}=_0x1c5453;if(_0x1215d4['PJEgE'](!_0x3afe97,!_0x5c4a4c)||!_0x450416){if(_0x1215d4[_0x305e0e(0x2d1,0x289,0x32c,0x2d3)](_0x1215d4['yEztZ'],_0x216866(-0x251,-0x198,-0x1e8,-0x226))){const _0x3ced35=_0x1215d4[_0x305e0e(0x3e7,0x3f3,0x3bc,0x3ad)];toastr[_0x216866(-0x1ae,-0x1f7,-0x166,-0x1d0)](_0x3ced35);const _0x586756={};_0x586756[_0x305e0e(0x38d,0x3e0,0x3ad,0x3cd)]=![],_0x586756[_0x305e0e(0x367,0x295,0x2ee,0x2c9)]=_0x3ced35,_0x586756['id']=_0x4e647d,eventSource['emit'](eventNames[_0x216866(-0x220,-0x21a,-0x1db,-0x241)+_0x305e0e(0x39f,0x403,0x399,0x3cb)],_0x586756);return;}else{const _0x3f9c4a=_0x3d31e8['apply'](_0x2f1375,arguments);return _0x1f9c0b=null,_0x3f9c4a;}}const _0x3478ed=_0x216866(-0x10c,-0x1d4,-0xd0,-0x14f)+_0x305e0e(0x477,0x3da,0x450,0x3f7)+'ompletions'+_0x216866(-0x135,-0x176,-0x21a,-0x1cf),_0x359c36=_0x3afe97[_0x305e0e(0x346,0x2b5,0x278,0x2f6)](/\/$/,'');_0x177027&&_0x1215d4[_0x305e0e(0x264,0x248,0x304,0x2d2)](_0x177027,_0x1215d4[_0x216866(-0x2ad,-0x1fb,-0x24b,-0x23a)]);try{if(_0x1215d4[_0x305e0e(0x284,0x27a,0x280,0x319)](_0x216866(-0x1cf,-0x1cc,-0x294,-0x20c),_0x1215d4[_0x305e0e(0x369,0x374,0x317,0x317)])){if(!_0x57a9a4[_0x305e0e(0x2a8,0x283,0x34a,0x2f2)])return;if(!_0x118c45[_0x216866(-0x233,-0x18b,-0x23f,-0x1c4)]||_0x1215d4[_0x305e0e(0x266,0x31f,0x35b,0x2d3)](_0x338046['content']['trim'](),''))return;if(_0x1215d4['nKAjF'](_0x4a4ef1['triggerMod'+'e'],_0x216866(-0x1de,-0xf1,-0x1bf,-0x16d))){if(!_0x4a0a08||!_0x1215d4[_0x216866(-0x157,-0x115,-0x11c,-0x156)](_0x4babc5,_0x9a02f2[_0x216866(-0x19a,-0x1f5,-0x157,-0x196)+'ds'],_0x2f002d))return;}const _0x1e04de={};_0x1e04de['role']=_0x2c9435[_0x216866(-0x15a,-0x10b,-0x15b,-0x142)]||_0x1215d4['aDnsF'],_0x1e04de[_0x216866(-0x221,-0x1c1,-0x132,-0x1c4)]=_0x591e9f[_0x216866(-0x1a0,-0x252,-0x209,-0x1c4)],_0x26bbfa['push'](_0x1e04de);}else{const _0x25778d={};_0x25778d[_0x216866(-0x174,-0x145,-0x10b,-0x151)+_0x216866(-0x25b,-0x17e,-0x11b,-0x1b8)+'ce']=_0x1215d4[_0x216866(-0x17b,-0x101,-0x1e5,-0x178)],_0x25778d['custom_url']=_0x359c36,_0x25778d[_0x216866(-0x199,-0x26d,-0x1d1,-0x1df)+_0x216866(-0x1e2,-0x26c,-0x214,-0x24a)+'rs']='Authorizat'+_0x216866(-0x17d,-0x1d2,-0x1a6,-0x14a)+_0x216866(-0x119,-0x1f9,-0x12e,-0x1b2)+_0x5c4a4c+'\x22',_0x25778d[_0x305e0e(0x39f,0x324,0x375,0x30d)]=_0x450416,_0x25778d[_0x305e0e(0x3b0,0x2f7,0x36a,0x39b)]=_0xf4dfc1,_0x25778d[_0x216866(-0x118,-0x1a8,-0x20d,-0x16e)+'e']=_0x4860c0,_0x25778d['top_p']=_0x2fd492,_0x25778d[_0x216866(-0x1fe,-0x276,-0x1fc,-0x1e1)]=_0x3dad70,_0x25778d['stream']=![];const _0x3c0945=_0x25778d,_0x3e782c=await _0x1215d4['guJfi'](fetch,_0x3478ed,{'method':_0x1215d4[_0x305e0e(0x43d,0x435,0x3f5,0x3f1)],'headers':_0x1215d4[_0x216866(-0x29d,-0x2d4,-0x2a0,-0x24e)](getRequestHeaders,window[_0x216866(-0x27d,-0x1e5,-0x208,-0x1f3)]),'body':JSON[_0x305e0e(0x313,0x2df,0x3a7,0x322)](_0x3c0945),'signal':_0xf1459a}),_0xb622c9=await _0x3e782c[_0x305e0e(0x39b,0x352,0x41d,0x3cc)]();if(_0xb622c9['error']){let _0x16aa73;if(_0x1215d4['LUzIn'](typeof _0xb622c9[_0x305e0e(0x2ce,0x33d,0x2e7,0x350)],_0x1215d4[_0x216866(-0x111,-0xbe,-0xb5,-0x14d)])&&_0xb622c9[_0x216866(-0x1db,-0x1c9,-0x21c,-0x1d0)]['message']){if(_0x1215d4[_0x216866(-0xf8,-0x148,-0x1ed,-0x183)](_0x1215d4[_0x216866(-0x200,-0x125,-0x1b0,-0x1a8)],_0x1215d4['shmgg'])){_0x16aa73=''+_0xb622c9['error']['message'];const _0x318cf7=[];if(_0xb622c9[_0x305e0e(0x319,0x3a7,0x3dc,0x350)][_0x216866(-0x166,-0x1a1,-0xb3,-0x115)])_0x318cf7['push'](_0x216866(-0x1c8,-0x131,-0x23b,-0x1bf)+_0xb622c9[_0x216866(-0x210,-0x195,-0x21c,-0x1d0)][_0x216866(-0xcb,-0xc8,-0x116,-0x115)]);if(_0xb622c9[_0x216866(-0x239,-0x25c,-0x20a,-0x1d0)]['code'])_0x318cf7['push'](_0x216866(-0x18f,-0x20a,-0x270,-0x22d)+_0xb622c9[_0x305e0e(0x300,0x321,0x2fa,0x350)][_0x216866(-0x115,-0x115,-0x199,-0x137)]);_0x1215d4['EMFzV'](_0x318cf7['length'],-0x25b*0x1+-0x773*-0x1+-0x518)&&(_0x16aa73+='\x20('+_0x318cf7['join'](',\x20')+')');}else return!!_0x23d5fd;}else _0x16aa73=''+JSON[_0x305e0e(0x3a0,0x2e3,0x307,0x322)](_0xb622c9[_0x305e0e(0x304,0x2b1,0x316,0x350)]);throw new Error(_0x16aa73);}if(!_0x3e782c['ok'])throw new Error(_0x216866(-0x171,-0x23a,-0x17f,-0x1ad)+_0x3e782c['status']+'\x20'+_0x3e782c['statusText']);const _0x5cee95=_0xb622c9[_0x216866(-0x1b0,-0x24d,-0x231,-0x244)]?.[-0x295*-0x5+0x10f3*-0x1+0x40a*0x1]?.[_0x305e0e(0x2d4,0x286,0x30d,0x30b)]?.['content']||'';!_0x5cee95&&toastr[_0x305e0e(0x317,0x2f7,0x2ca,0x332)](_0x1215d4[_0x216866(-0x244,-0x2d2,-0x226,-0x25b)]);if(_0x177027){if(_0x1215d4['gUUIK'](_0x216866(-0x1e1,-0x1c9,-0x1bd,-0x1c9),_0x1215d4[_0x216866(-0x26b,-0x1c6,-0x1ce,-0x21d)]))return _0xf47e9f;else _0x1215d4['KHuyd'](_0x177027,_0x5cee95);}_0x1215d4['NJHKs'](addLog,_0x216866(-0x154,-0x112,-0x168,-0x1a4)+_0x216866(-0x250,-0x140,-0x1fa,-0x1ba)),addLog(_0x5cee95),_0x1215d4[_0x305e0e(0x2ec,0x375,0x2fd,0x2f1)](addLog,_0x305e0e(0x3ed,0x3ab,0x313,0x36f)+_0x305e0e(0x3bf,0x34b,0x380,0x397));const _0x18402a={};_0x18402a[_0x216866(-0xf3,-0x1d1,-0xfc,-0x153)]=!![],_0x18402a['result']=_0x5cee95,_0x18402a['id']=_0x4e647d,eventSource[_0x216866(-0x296,-0x17d,-0x226,-0x201)](eventNames[_0x305e0e(0x2db,0x30e,0x2c7,0x2df)+_0x216866(-0xd4,-0x136,-0x17e,-0x155)],_0x18402a);}}catch(_0x531db6){if(_0x305e0e(0x43d,0x3b5,0x3f9,0x399)===_0x1215d4['XoCLv'])throw new _0x3c0275('请求失败:\x20'+_0x54a6d3['status']+'\x20'+_0x49f935[_0x216866(-0x201,-0x1c9,-0x199,-0x1d3)]);else{if(_0x1215d4['LUzIn'](_0x531db6[_0x216866(-0x2ec,-0x240,-0x27c,-0x252)],_0x1215d4[_0x216866(-0x23e,-0x211,-0x23b,-0x23c)])){console[_0x216866(-0x204,-0x210,-0x1bd,-0x1ce)](_0x1215d4['xCBQN']);const _0x3e78bb={};_0x3e78bb['name']=_0x216866(-0x19b,-0x1fa,-0x1da,-0x1ac),_0x3e78bb[_0x216866(-0x1df,-0x297,-0x1db,-0x215)]='Request\x20ab'+'orted';const _0x5902da={};_0x5902da['success']=![],_0x5902da[_0x305e0e(0x2a3,0x317,0x303,0x2c9)]=null,_0x5902da['id']=_0x4e647d,_0x5902da['error']=_0x3e78bb,eventSource[_0x305e0e(0x352,0x36d,0x2f1,0x31f)](eventNames[_0x216866(-0x240,-0x1d8,-0x1aa,-0x241)+_0x305e0e(0x34e,0x385,0x3c7,0x3cb)],_0x5902da);return;}console[_0x305e0e(0x2e5,0x2db,0x2c2,0x350)](_0x1215d4[_0x216866(-0x175,-0x1d3,-0x180,-0x150)],_0x531db6);const _0x2c34f6=_0x216866(-0x117,-0x103,-0x155,-0x128)+_0x531db6[_0x305e0e(0x348,0x2a4,0x2b1,0x30b)];if(_0x177027){if(_0x305e0e(0x3d8,0x2ae,0x2ce,0x347)===_0x1215d4[_0x216866(-0x1ef,-0x12a,-0x10d,-0x18f)]){_0x21b316=''+_0x2d4561['error'][_0x216866(-0x278,-0x1de,-0x223,-0x215)];const _0xeb2d68=[];if(_0x1ff9a3[_0x216866(-0x168,-0x13b,-0x1ca,-0x1d0)]['type'])_0xeb2d68[_0x305e0e(0x3b9,0x2cb,0x3b3,0x35d)]('类型:\x20'+_0x1a20f2[_0x216866(-0x1df,-0x1c5,-0x264,-0x1d0)][_0x216866(-0xd8,-0x199,-0x17f,-0x115)]);if(_0x16d52d[_0x216866(-0x15a,-0x207,-0x19d,-0x1d0)][_0x216866(-0x1bc,-0xf4,-0x163,-0x137)])_0xeb2d68[_0x305e0e(0x2ee,0x336,0x334,0x35d)]('代码:\x20'+_0x1255d4['error']['code']);_0x1215d4[_0x216866(-0x290,-0x23d,-0x1aa,-0x1f7)](_0xeb2d68[_0x216866(-0x224,-0x104,-0x23e,-0x19c)],-0x9dd+-0x1f3*-0xb+-0xb94)&&(_0x1fa0a1+='\x20('+_0xeb2d68[_0x305e0e(0x3e7,0x395,0x348,0x355)](',\x20')+')');}else _0x1215d4[_0x216866(-0x1a2,-0x15a,-0x184,-0x1dd)](_0x177027,_0x2c34f6);}toastr[_0x216866(-0x1c3,-0x18f,-0x19c,-0x1d0)](_0x531db6['message']);const _0x1b4194={};_0x1b4194[_0x305e0e(0x3f7,0x3a9,0x3b6,0x3cd)]=![],_0x1b4194[_0x305e0e(0x347,0x26d,0x228,0x2c9)]=_0x2c34f6,_0x1b4194['id']=_0x4e647d,eventSource[_0x305e0e(0x2a9,0x30b,0x386,0x31f)](eventNames[_0x305e0e(0x2f7,0x370,0x348,0x2df)+'E_RESPONSE'],_0x1b4194);}}finally{_0x1215d4[_0x305e0e(0x321,0x3ff,0x327,0x3b7)](_0x1215d4[_0x216866(-0x154,-0x1c9,-0x16b,-0x143)],_0x1215d4[_0x216866(-0x14d,-0x193,-0xbb,-0x143)])?(currentLLMRequestController=null,_0x1215d4[_0x216866(-0x1dd,-0x173,-0x17d,-0x19a)](stopFabLoading)):_0x428a27+='\x20('+_0x440bf7[_0x216866(-0x129,-0x1d5,-0x24c,-0x1cb)](',\x20')+')';}}export function createGetPromptHandler(_0xba0be5,_0x4bcf55){const _0x1fca30={'qDnwk':function(_0x240238,_0x594478){return _0x240238(_0x594478);}};return function(_0x4dfad4){const {id:_0x54cccd}=_0x4dfad4;function _0x28a63c(_0x4d51bb,_0x484022,_0x4af166,_0x1a41e1){return _0x24f8(_0x4d51bb-0x19f,_0x484022);}function _0x5ec1f2(_0x2a733c,_0x560c42,_0x5d6aae,_0x528962){return _0x24f8(_0x2a733c-0x23,_0x560c42);}if(!_0x54cccd)return;const _0x59c9cb=REQUEST_TYPE_NAMES[_0xba0be5]||_0xba0be5;console[_0x5ec1f2(0x214,0x23e,0x1ee,0x22b)](_0x5ec1f2(0x1c4,0x254,0x1ee,0x14f)+_0x28a63c(0x3e5,0x443,0x3c3,0x442)+_0x59c9cb+(_0x5ec1f2(0x2ce,0x252,0x268,0x346)+_0x28a63c(0x3c0,0x38e,0x36f,0x331))+_0x54cccd+')');const _0x481bac=_0x1fca30[_0x5ec1f2(0x1a7,0x1ff,0x16a,0x224)](buildPromptForRequestType,_0xba0be5),_0x2e87e6={};_0x2e87e6[_0x28a63c(0x3f7,0x37f,0x36d,0x445)]=_0x481bac,_0x2e87e6['id']=_0x54cccd,eventSource[_0x28a63c(0x35d,0x38f,0x3a3,0x31b)](_0x4bcf55,_0x2e87e6);};}export function createExecuteHandler(_0x545631,_0x5af00d,_0x14d9da=null){const _0x364e27={'GOLKG':function(_0x59e9c4){return _0x59e9c4();}};return async function(_0x166164){const _0x55da90=_0x14d9da?_0x364e27[_0x208ac3(0x3dd,0x463,0x362,0x344)](_0x14d9da):null;function _0x208ac3(_0x231b9d,_0x4fbce9,_0x4ad3f3,_0x30daa2){return _0x24f8(_0x231b9d-0x265,_0x4ad3f3);}await executeTypedLLMRequest(_0x166164,_0x545631,_0x5af00d,_0x55da90);};}