(function(_0x1e637d,_0x41c1e0){const _0x141a2b=_0x1e637d();function _0x27928a(_0x2fcef3,_0x713ea8,_0x36e7e0,_0x133858){return _0x3542(_0x2fcef3- -0x153,_0x713ea8);}function _0x5d68b3(_0x46a6cc,_0x4a0652,_0x37dbc7,_0x30c613){return _0x3542(_0x37dbc7-0x1d2,_0x46a6cc);}while(!![]){try{const _0x12cb52=parseInt(_0x5d68b3(0x3a7,0x3d1,0x3c9,0x3a5))/(0x1e23+0x131*-0x7+0x7*-0x31d)+parseInt(_0x5d68b3(0x474,0x4a8,0x477,0x3e6))/(-0x1b11+-0xbe3+0x26f6)+-parseInt(_0x27928a(0x82,0xb3,0xf0,0xf9))/(-0x232c+0xc4d+-0x1*-0x16e2)*(-parseInt(_0x27928a(0xb1,0xbb,0x12a,0xe8))/(0xb00*-0x3+-0x180f+0x13*0x301))+-parseInt(_0x5d68b3(0x4ae,0x45f,0x432,0x3cd))/(0x98a+0x2c*-0x7f+0xc4f)*(parseInt(_0x27928a(0x133,0x184,0x9f,0xd0))/(0x1c3d+0x1*-0x1609+-0x62e))+parseInt(_0x5d68b3(0x49a,0x48d,0x4a6,0x50e))/(-0x937+-0x25ea+0x2f28)*(-parseInt(_0x5d68b3(0x49c,0x47f,0x490,0x4e6))/(0xbf6+0x134d+-0x1f3b))+-parseInt(_0x5d68b3(0x453,0x3c8,0x45a,0x432))/(-0x1*-0xc0d+0x19*-0x41+0x5ab*-0x1)+-parseInt(_0x27928a(0x161,0x19e,0xf7,0x108))/(0x21e*0x5+0x1ae8+-0x2574)*(-parseInt(_0x5d68b3(0x4a0,0x3f4,0x438,0x3ca))/(0x1*-0x19fb+-0x4ed*0x3+0x829*0x5));if(_0x12cb52===_0x41c1e0)break;else _0x141a2b['push'](_0x141a2b['shift']());}catch(_0x108b5a){_0x141a2b['push'](_0x141a2b['shift']());}}}(_0xceb5,-0x119722+-0x7e9f0+0x25a94f));const _0x4d4cd5=(function(){const _0xd7d65e={};_0xd7d65e['JcHKQ']=_0x11edee(0x3fd,0x4c2,0x4a0,0x436)+_0x7a8782(0x2c4,0x282,0x340,0x277)+_0x11edee(0x3c9,0x3ad,0x406,0x439)+_0x7a8782(0x32c,0x2fe,0x360,0x2f3),_0xd7d65e[_0x11edee(0x436,0x3e7,0x3e0,0x467)]=function(_0x22d353,_0x5af9dc){return _0x22d353+_0x5af9dc;},_0xd7d65e[_0x11edee(0x450,0x412,0x4c4,0x46c)]=function(_0x355d18,_0x151785){return _0x355d18===_0x151785;},_0xd7d65e[_0x7a8782(0x39c,0x3c0,0x36f,0x420)]=_0x11edee(0x398,0x465,0x38f,0x3f7),_0xd7d65e[_0x7a8782(0x371,0x39e,0x32a,0x377)]=_0x7a8782(0x3b8,0x444,0x40d,0x335);const _0x1b36e8=_0xd7d65e;let _0x193eba=!![];function _0x7a8782(_0x97817b,_0x236de6,_0x468f5f,_0x32dd6e){return _0x3542(_0x97817b-0xe1,_0x468f5f);}function _0x11edee(_0x3b6dfe,_0x288163,_0x1f5d97,_0x3fc244){return _0x3542(_0x3fc244-0x209,_0x3b6dfe);}return function(_0x5c7854,_0x55d3cf){const _0x2b6205={'hkfZa':_0x1b36e8['JcHKQ'],'ycSUt':function(_0x4db483,_0x1820f8){return _0x4db483(_0x1820f8);},'sEkXx':function(_0x52275e,_0x433ec8){function _0x5ed9f1(_0x9fc052,_0x30af49,_0x271e0e,_0x2a06f3){return _0x3542(_0x2a06f3-0x14a,_0x271e0e);}return _0x1b36e8[_0x5ed9f1(0x330,0x40d,0x330,0x3a8)](_0x52275e,_0x433ec8);}};function _0x475481(_0x1c159f,_0x50cec2,_0x20a627,_0x162c7f){return _0x11edee(_0x50cec2,_0x50cec2-0x12d,_0x20a627-0xd3,_0x20a627- -0x3da);}function _0x862d52(_0xbe23b2,_0x241c35,_0x57f7c0,_0x27279b){return _0x7a8782(_0xbe23b2-0x295,_0x241c35-0x1b9,_0x241c35,_0x27279b-0x85);}if(_0x1b36e8[_0x475481(0x4f,0xc1,0x92,0x6a)](_0x1b36e8[_0x862d52(0x631,0x5e3,0x678,0x5d2)],_0x1b36e8['DxYfv']))_0x1c5613[_0x475481(0x143,0xa8,0xc5,0x128)](_0x2b6205[_0x862d52(0x533,0x574,0x567,0x550)],_0x4ccd72),_0x2b6205[_0x862d52(0x614,0x5c0,0x5a4,0x5be)](_0x18274f,_0x2b6205[_0x862d52(0x572,0x5c5,0x4fd,0x5b6)](_0x475481(0xde,0x90,0xc8,0x86),_0x3a0bf4[_0x862d52(0x607,0x652,0x578,0x599)]));else{const _0x26555e=_0x193eba?function(){function _0x1258a9(_0x235809,_0xcb9f2e,_0x26b230,_0xa51658){return _0x475481(_0x235809-0x159,_0xa51658,_0xcb9f2e-0x2af,_0xa51658-0x1ea);}if(_0x55d3cf){const _0x5cd5b5=_0x55d3cf[_0x1258a9(0x290,0x31d,0x342,0x3af)](_0x5c7854,arguments);return _0x55d3cf=null,_0x5cd5b5;}}:function(){};return _0x193eba=![],_0x26555e;}};}()),_0x1c9ae8=_0x4d4cd5(this,function(){const _0x247144={};_0x247144[_0x284ad4(-0x139,-0x14e,-0xdf,-0x131)]=_0x1efae6(-0x54,-0x37,-0x2b,0x1f)+'+$';const _0x5dd8dd=_0x247144;function _0x284ad4(_0x11ea30,_0x8044ea,_0x49a319,_0x40449d){return _0x3542(_0x49a319- -0x34f,_0x11ea30);}function _0x1efae6(_0x48c79f,_0x1767cc,_0x3d839d,_0x16a3cd){return _0x3542(_0x16a3cd- -0x1a5,_0x3d839d);}return _0x1c9ae8['toString']()['search'](_0x5dd8dd[_0x1efae6(0x70,0xdc,0x6c,0xcb)])[_0x284ad4(-0xef,-0xe1,-0x172,-0x1b7)]()[_0x1efae6(0xe6,0xbb,0x6c,0x5d)+'r'](_0x1c9ae8)[_0x284ad4(-0xa8,-0x4c,-0xc3,-0xbe)]('(((.+)+)+)'+'+$');});_0x1c9ae8();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';function _0xceb5(){const _0x46cd06=['C3rVCMvezwXLDa','ie5VDMvSquKGqW','AhPys0m','i2nVBwz5DwKTAq','qKDOuMS','yMXVy2S','t09SC04','Dxrrs0C','CxvLCNLtzwXLyW','Cu1Yqwu','Df9UB3zLBgfP','CMv2B2TLt2jQzq','AeHyExG','y2XPy2S','i25VDMvSywKTAq','zKLTywDL','rKfvyKm','BMfPm0nOyxjszq','zMLQD1O','vuH1EK8','whrpqMC','l3vWBg9Hzc9PBq','z2v0rwXLBwvUDa','sLb4wg0','C3bSAxq','zNHVse4','rxjYB3iGChjVyW','igzYB20GB2XKia','sM5msuu','zwXbssbJAgfYia','Aw1Hz2u','Df9UywLFy2HHCG','BMX5','wMv3Aeq','qMXOAvu','shHRBgC','ELzduhu','EeP3z3C','ExvPx3jLzL9PBq','BNz4u0e','uuvzB0G','ywDLlxbYzxzPzq','sKrwExK','i2nVBwz5DwKTCG','yxbWBhK','rgnTweS','BuffrgK','nhWXFdn8mhW1Fa','rNrUyKC','Aw1Hz2vjBNb1Da','DvD6B0e','DNbXzxy','twXnqwe','tMfTzq','vvHfuvG','zMLUza','CMvMigLTywDLoG','v05Oy00','rvzcuNK','Aw1Hz2uVCg5N','tLrKDxe','C3zmy1q','Ae93C04','wgXUDuy','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','ienVBwz5vuKGAq','D092txm','tKjAseW','yM9hBwC','zMXLEa','Aw5SAw5LlwzSzq','v3vpz0K','y2fJAgvFy29TzG','6k+M5OofoIa','vvH3ug0','EfvYBvG','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','mJC1nuD6zLDSuG','DY1JB250ywLUzq','sNfVthO','Bu5vy2K','u2rRvhm','vuvkBxa','mJqYChjPENnL','nhWZFdb8mxWY','BwfNzs1WCMv2Aq','DtGTAw1Hz2uTCa','i25VDMvSywKTCW','qNLjza','zgf0yq','zeLmqKi','zxCTy29UDgfPBG','mhWXFdn8nhWY','CwTeAKq','DwXRuNK','CwrWD3K','zgf0ytPPBwfNzq','Dgv4Da','5lUo57Yt5A2y5yQG6l29q29TzNK','5zMO6l+u5zUE5PwW5O2UoIa','sgzZsxy','BenPDNq','zvr1q2O','CeXtt2y','C3jJ','wfrIug0','AgfYifjLzIbPBq','y29TzNL1As1Yzq','x25VDMvSywK','wgPPDg0','yMXVyG','Dwz0t0m','i2LTywDLsw5WDq','mhWYFdn8mxW0','CM1HDc4','mtK4EeTsu1Dg','zurUzKS','mtmXmJa4mZbtvKrlB0u','x3jLzG','ie5VDMvSquKGvG','zgLZCgXHEq','C2vHCMnO','vMTKzuG','rhnqDNa','qxPrAwm','rhHzzNy','BwvZC2fNzq','DgfYz2v0','D1H4uK4','ChjLDMLLD0LTyq','tg9HzgvKienVBq','zxjYB3i','i25VDMvSywKTCG','z2vFBMfPx2nOyq','5zU+54Mh5Ase55cg5AsX6lsLoIa','5lIk5lYG5AsX6lsLoIa','zwXLy3qTAw1HzW','zw1VDMuTAw1HzW','y29TzNL1AwnHBG','Ewntvxq','sNLLuwG','thzOseW','yxqUifbSzwfZzq','zg1osNm','ANrrtxC','A2fVDhvWAwfU','mtC3ntGYAeniBgTf','CIaUC3qTy2HHDa','DhjPBq','y2zNze8','A1zqvLe','AgTXsuy','BMfPm1zPyMvuCG','yw5ZzMvYsw1HzW','5zUE5PwW5O2UoG','CMvMlwLTywDLlq','Bg9N','tvvnBMS','t09uueC','ELfkt0i','igzYB20Gy2fJAa','nduWmJuWsu9nDu5A','zgLvEg0','AwjLigLTywDLoG','C3rHCNrZv2L0Aa','y2fJAguGzM9YBq','DwTMvMW','yMjSEhK','Ee5HzhO','zxiGlNn0lwnOyq','rKDes20','mtCZmtjHtfr2qxa','z0Pct3G','DgHLig5LDYbMBW','ANnVBG','yMXVyJO','CML0zq','tKjzs2S','we13rva','Bhnkvhy','Bw92zs1JAgfYlq','x25HAv9JAgfYxW','BMfTzq','zwXLy3qTy2HHCG','zwjrreK','C2vYDMvYrMLSzq','vxnTwwO','BgfPx2nOyxjFCG','6zsz6k+V6k+M5OofoG','A2XIEwm','B3bLBKrc','ywDL','s1vQtMu','mta5oxnSsengtG','rwr6CxG','BhrRrwi','ren4zvq','v0jot1y','ELnfsha','zw1VDMuTy2HHCG','rNfMDu8','AufkBLu','Afnhqxi','v29HrLi','sKfsEMy','y2fJAgvFBM92zq','z2vFBM92zwXHAq','nhWZFdb8mNWX','ugvhyNO','AefiuvG','u2Ppuwy','AgTMwMe','CwviDLO','lwj0BG','C3rVCMvszwfKtW','C2XyqMC','z2uY','r213vwK','kcGOlISPkYKRkq','DgLmB2S','yNrU','lxjLzI1PBwfNzq','yxbWzw5K','v3rMCvm','r0fhrKi','Dg9Y','zNLvssbPBwfNzq','zMLSzxm','v1v4tMu','zs1IDg4','vLL0u1m','EvL3tMS','DfvoCuq','EKH6AeC','zefLBvq','mtjhvw9gy1O','rxjYB3iGBg9Hza','uMHADMu','C3rYAw5N','CMvM','y3rvuKW','wMHfvxe','Dwr3suy','Dg9tDhjPBMC','C3r5Bgu','CxfKrMq','zMrnC2m','y3jLyxrLt2jQzq','D2fYBG','zxnZAw5Nie5VDG','C3rVCMvszwfKvW','ssbbueNLNldLNydJGii','sMPAywO','qKTxs20','Bw92zs1PBwfNzq','BMPivKu','ztOG','CMvHzefZrgf0yq','yu9erhe','i25VDMvSywKTyW','u1fIDhC','t056zuK','C2XjuuO','tNPLseO','sKLLs1C','CMvZDwX0','BwfNztO','ww5eteC','r1Lyz2S','mtm5mJmWoxDIuLLUyG','CMfUC2zLCL9PBq','Dhu4lwLTywDLlq','zLneD3G','CwrIwfe','C0vRwhG','CL9Yzwy','BgfJzwHVBgrLCG','ywDLoG','Aw5NignHy2HLza','z0zvBK0','y29UC3rYDwn0BW','suXgAMK','mtqWodG0vufIB2vj','qLD3wfq','v05eAu8','BM9Uzq','zwXbssbPBwfNzq','sw9Mzgi','ihjLlxvWBg9Hza','ALDnB1O','AxnADMO','y1b6ywi','vvjm','AgfYlxjLzI1PBq','BM92zwXHAs1Yzq','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','vKr2txq'];_0xceb5=function(){return _0x46cd06;};return _0xceb5();}import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';function _0x187cb8(_0x20fee0,_0x5c9af2,_0x1366e3,_0xe6653){return _0x3542(_0x5c9af2- -0x2a0,_0x20fee0);}import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x187cb8(-0x174,-0xe9,-0x99,-0x70)+'lai_vibe_t'+_0x187cb8(-0x2c,-0xa8,-0xe5,-0xdc)+_0x187cb8(0x72,0x32,-0x24,0x17),NAI_CHAR_REF_CACHE_KEY=_0x1a7b29(0x509,0x573,0x5aa,0x552)+_0x1a7b29(0x694,0x68a,0x696,0x669)+'ef_image',COMFYUI_REF_CACHE_KEY=_0x1a7b29(0x5cf,0x5ef,0x67b,0x5f6)+_0x187cb8(-0x4b,-0x67,-0x86,-0x1d)+_0x1a7b29(0x6f9,0x682,0x69d,0x66d);let nai3VibeTransferImageMimeType=_0x1a7b29(0x5f6,0x57e,0x5f9,0x5e9);function _0x1a7b29(_0x4ed106,_0x4328ac,_0x94725,_0x1fa9a9){return _0x3542(_0x1fa9a9-0x39b,_0x94725);}let nai3CharRefImageMimeType=_0x1a7b29(0x597,0x5f3,0x663,0x5e9),comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x532a9c){const _0x344480={};_0x344480['pLSOf']=_0x520018(-0x5a,-0xfe,-0x8c,-0x66)+_0x520018(-0x144,-0x1e2,-0x168,-0x1d4),_0x344480['lCivt']=_0xa5ce6e(0x1ed,0x1b2,0x215,0x1c6)+_0x520018(-0x8e,-0x4e,-0xb8,-0xee)+_0xa5ce6e(0x23a,0x2c5,0x287,0x1ac)+_0x520018(-0x43,-0x39,-0x64,-0x71)+_0xa5ce6e(0x1c5,0x1cd,0x137,0x185)+'placeholde'+'r',_0x344480[_0xa5ce6e(0x2a2,0x306,0x255,0x296)]=_0xa5ce6e(0x1dc,0x221,0x1df,0x15c)+_0x520018(-0x17f,-0x136,-0x138,-0x19d)+_0xa5ce6e(0x18b,0x179,0x1fa,0x1d4);function _0xa5ce6e(_0x34776b,_0x3d1c53,_0x33c471,_0x1d65f1){return _0x187cb8(_0x33c471,_0x34776b-0x26c,_0x33c471-0x177,_0x1d65f1-0x141);}_0x344480[_0xa5ce6e(0x26b,0x2fd,0x231,0x28f)]='data:image';function _0x520018(_0x4eaa89,_0x3301be,_0x12b3de,_0x76d878){return _0x187cb8(_0x3301be,_0x12b3de- -0x80,_0x12b3de-0x136,_0x76d878-0x1c);}_0x344480[_0xa5ce6e(0x219,0x1b5,0x1af,0x1ec)]=_0x520018(-0xe7,-0x115,-0x108,-0x10d),_0x344480['Edzqx']=_0x520018(-0x131,-0x94,-0xc7,-0x158)+'x',_0x344480['bblxy']='none',_0x344480[_0xa5ce6e(0x20f,0x299,0x1fd,0x224)]=_0x520018(-0x69,-0x4f,-0xc8,-0x135);const _0x371b59=_0x344480,_0x1b77e1=document[_0xa5ce6e(0x1f5,0x1e8,0x1c0,0x194)+'ById'](_0x371b59[_0x520018(-0x3d,-0x71,-0xa6,-0x20)]),_0x27669a=document[_0x520018(-0xf2,-0x181,-0x105,-0xa8)+_0xa5ce6e(0x197,0x185,0x1ce,0x21d)](_0x371b59[_0xa5ce6e(0x244,0x218,0x289,0x258)]),_0x5dd814=document[_0x520018(-0xa2,-0x8a,-0xf7,-0xf4)+_0x520018(-0x147,-0xf2,-0xb5,-0x124)](_0x371b59[_0xa5ce6e(0x2a2,0x287,0x31f,0x25f)]);if(_0x532a9c&&_0x532a9c[_0xa5ce6e(0x283,0x2d2,0x221,0x2bd)](_0x371b59[_0x520018(-0x48,-0x1,-0x81,0x6)])){_0x1b77e1[_0xa5ce6e(0x247,0x2d5,0x297,0x20f)]=_0x532a9c,_0x1b77e1['style']['display']=_0x371b59[_0x520018(-0xa8,-0x123,-0xd3,-0xd1)],_0x27669a[_0x520018(-0x10e,-0xde,-0x142,-0x16e)]['display']=_0x520018(-0x10e,-0x189,-0x119,-0x194),_0x5dd814[_0xa5ce6e(0x1aa,0x14c,0x1d2,0x196)][_0x520018(-0xd2,-0x79,-0x95,-0x6e)]=_0x371b59[_0x520018(0x31,-0x74,-0x4b,-0x5a)];const _0x23a74e=_0x532a9c[_0x520018(-0x12a,-0x10f,-0xf5,-0x151)](','),_0x1299da=_0x23a74e[-0x1*-0x545+-0x1*0xf17+0x4e9*0x2][_0x520018(-0x6c,-0x6a,-0xf5,-0x96)](':')[-0xac*0x29+0x10b1*0x1+-0x5*-0x22c]['split'](';')[0x20f0+-0x734+0x12*-0x16e];nai3VibeTransferImageMimeType=_0x1299da,window[_0x520018(-0x54,-0x8,-0x75,0x9)+_0x520018(-0x78,0x11,-0x74,0x15)+'e']=_0x23a74e[0x6*-0x4f0+-0x21e+-0x15*-0x183];const _0x512cf4={};_0x512cf4['id']=NAI_VIBE_CACHE_KEY,_0x512cf4[_0x520018(-0x56,-0x61,-0xb4,-0xf5)]=_0x532a9c,dbs[_0x520018(-0xca,-0x1af,-0x13c,-0x139)+_0xa5ce6e(0x28f,0x28c,0x254,0x27b)](_0x512cf4);}else _0x1b77e1[_0x520018(-0xf1,-0x34,-0xa5,-0x12)]='',_0x1b77e1[_0xa5ce6e(0x1aa,0x1d9,0x194,0x212)]['display']=_0x371b59[_0xa5ce6e(0x286,0x2f6,0x212,0x2a4)],_0x27669a[_0xa5ce6e(0x1aa,0x125,0x22e,0x20f)][_0x520018(-0x3d,-0x40,-0x95,-0xde)]=_0x371b59[_0x520018(-0xd8,-0x126,-0xdd,-0xc6)],_0x5dd814[_0xa5ce6e(0x1aa,0x1a8,0x20c,0x224)][_0x520018(-0x10e,-0x17,-0x95,-0x93)]=_0x520018(-0xa8,-0x16f,-0x119,-0xab),window[_0xa5ce6e(0x277,0x2c1,0x254,0x1ed)+_0xa5ce6e(0x278,0x242,0x27c,0x2a3)+'e']=null;}function removeNovelaiImage(){updateNovelaiImagePreview(null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}function _0x3542(_0x537deb,_0x140fd2){_0x537deb=_0x537deb-(0x163a+-0x91a+-0x4f*0x25);const _0x3c56d0=_0xceb5();let _0x3f755c=_0x3c56d0[_0x537deb];if(_0x3542['FfAaox']===undefined){var _0x50867a=function(_0x4a9c4b){const _0x4b7d97='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2b475f='',_0x212a15='',_0x5ba633=_0x2b475f+_0x50867a;for(let _0x51fcd5=0x491+0x154+-0x1f7*0x3,_0x2504e9,_0x5015eb,_0x130aa2=0xb*0x119+0x227d+-0x2e90*0x1;_0x5015eb=_0x4a9c4b['charAt'](_0x130aa2++);~_0x5015eb&&(_0x2504e9=_0x51fcd5%(0x10c1+0x157+-0x1214)?_0x2504e9*(-0x1831+0x32*0x40+0xbf1)+_0x5015eb:_0x5015eb,_0x51fcd5++%(0x2055+0xd1+0x1*-0x2122))?_0x2b475f+=_0x5ba633['charCodeAt'](_0x130aa2+(-0x16d8*-0x1+-0x303*0x2+0x4*-0x432))-(-0x159e+-0x913*-0x2+0x1*0x382)!==-0x19*-0x104+0x2359+0x3cbd*-0x1?String['fromCharCode'](0x187b+-0x7*-0x50b+-0x3ac9*0x1&_0x2504e9>>(-(0x3*0x671+0x13*-0x121+-0x222*-0x1)*_0x51fcd5&0x3cd*0x5+0x3*-0x7e8+0x4bd)):_0x51fcd5:-0x2645*0x1+0x27b*-0xf+0x4b7a){_0x5015eb=_0x4b7d97['indexOf'](_0x5015eb);}for(let _0x36e464=-0x1a03*0x1+0x1425*-0x1+-0x698*-0x7,_0x2a0482=_0x2b475f['length'];_0x36e464<_0x2a0482;_0x36e464++){_0x212a15+='%'+('00'+_0x2b475f['charCodeAt'](_0x36e464)['toString'](0x226c+0x1847+-0x3aa3))['slice'](-(0x1f46+0x868+0x4*-0x9eb));}return decodeURIComponent(_0x212a15);};_0x3542['TxiUig']=_0x50867a,_0x3542['aaXXWh']={},_0x3542['FfAaox']=!![];}const _0x1ea4e9=_0x3c56d0[0x193*-0x1+-0x2ae+-0x16b*-0x3],_0x572082=_0x537deb+_0x1ea4e9,_0x148446=_0x3542['aaXXWh'][_0x572082];if(!_0x148446){const _0x4346a6=function(_0x1a5ce9){this['CReEdt']=_0x1a5ce9,this['qjevEn']=[-0x1*0xf47+0x3f9*-0x9+0xc3*0x43,0x523*-0x5+0x1*-0xd3a+-0x7*-0x58f,0x3*0x699+-0x347+-0x1084],this['oLrpBo']=function(){return'newState';},this['ScqwAF']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['IlTTNL']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4346a6['prototype']['wrgPPL']=function(){const _0x322b0b=new RegExp(this['ScqwAF']+this['IlTTNL']),_0xbb0068=_0x322b0b['test'](this['oLrpBo']['toString']())?--this['qjevEn'][0xde5*0x2+-0xaa8+0x36d*-0x5]:--this['qjevEn'][0x88f+-0x1734+0xea5*0x1];return this['RpjkZe'](_0xbb0068);},_0x4346a6['prototype']['RpjkZe']=function(_0x5395f0){if(!Boolean(~_0x5395f0))return _0x5395f0;return this['gfZLTN'](this['CReEdt']);},_0x4346a6['prototype']['gfZLTN']=function(_0x34b173){for(let _0x21657c=-0x25bb+0x243b+-0x8*-0x30,_0x55ac79=this['qjevEn']['length'];_0x21657c<_0x55ac79;_0x21657c++){this['qjevEn']['push'](Math['round'](Math['random']())),_0x55ac79=this['qjevEn']['length'];}return _0x34b173(this['qjevEn'][-0x1*0x17c9+-0x2627*-0x1+0x6*-0x265]);},new _0x4346a6(_0x3542)['wrgPPL'](),_0x3f755c=_0x3542['TxiUig'](_0x3f755c),_0x3542['aaXXWh'][_0x572082]=_0x3f755c;}else _0x3f755c=_0x148446;return _0x3f755c;}async function handleNovelaiImageUpload(_0x1e52d3){function _0x388ad9(_0x10ce51,_0x87877,_0x610d97,_0x38bdc5){return _0x187cb8(_0x610d97,_0x87877- -0x56,_0x610d97-0x127,_0x38bdc5-0x63);}const _0x1be86a={'zSEHp':function(_0x29a589,_0x1d056f,_0x1b5c77){return _0x29a589(_0x1d056f,_0x1b5c77);},'njHVE':function(_0x298d98,_0x5939b4){return _0x298d98===_0x5939b4;},'XTbPm':_0x2110f2(0x79,0xbc,0x6b,0xe2),'WUxNe':'Error\x20proc'+_0x2110f2(-0x6c,-0x3e,-0xc1,0x36)+_0x388ad9(-0x169,-0xee,-0x174,-0xa5)+':','hAHQX':function(_0x29fc65,_0x54c134){return _0x29fc65(_0x54c134);},'DcmXK':_0x388ad9(0x25,-0x5d,-0x7e,0xf)},_0x4b1c0e=_0x1e52d3['target'][_0x2110f2(-0xdb,-0x54,-0x85,-0x9c)][0x1*-0x114a+0x17d8+-0x68e];function _0x2110f2(_0x313f14,_0x379f09,_0x192f8a,_0x5c2b55){return _0x1a7b29(_0x313f14-0xbb,_0x379f09-0x6b,_0x5c2b55,_0x379f09- -0x5bc);}if(!_0x4b1c0e)return;try{const _0x24675d=await _0x1be86a[_0x388ad9(0x4f,-0x1d,-0x8a,-0x95)](processUploadedImage,_0x4b1c0e,!![]);updateNovelaiImagePreview(_0x24675d);}catch(_0x34831b){_0x1be86a[_0x2110f2(0x13,-0x38,0x10,-0x1f)](_0x388ad9(-0x58,-0x19,0x1e,-0x7e),_0x1be86a[_0x388ad9(-0xd8,-0x7a,-0xd6,-0x84)])?(console['error'](_0x1be86a[_0x388ad9(-0x17f,-0x128,-0x153,-0x93)],_0x34831b),_0x1be86a[_0x388ad9(-0x18f,-0x13b,-0xb7,-0xf3)](alert,_0x1be86a[_0x388ad9(-0x5b,-0xb6,-0xe2,-0xbb)]+_0x34831b[_0x2110f2(-0x18,0x70,0x82,-0x24)])):_0x42a4a8[_0x388ad9(-0xd0,-0xd8,-0x11c,-0xf1)+'ctURL'](_0x4d80c2[_0x388ad9(-0xb5,-0x7b,-0xde,-0xe6)]);}}function updateNovelaiCharRefImagePreview(_0x5a977d){const _0x305f0e={'WuOgI':function(_0x119776){return _0x119776();},'yorfv':_0x4a455c(0x2e6,0x2f4,0x296,0x318)+'ge_nai_cha'+'r_ref','eDnfK':'novelai-re'+'move-char-'+_0x47b5d0(-0x8a,-0xb4,-0xf7,-0xd3)+_0x47b5d0(-0x172,-0x1c8,-0x1a5,-0x1db),'ulkRy':_0x47b5d0(-0xc5,-0x5c,-0x97,-0x63),'JnLIE':function(_0x4aa6a8,_0x44338a){return _0x4aa6a8===_0x44338a;},'mAEDi':_0x47b5d0(-0xe7,-0xde,-0x96,-0x139),'DfNjG':'iiDTz','boGmg':_0x47b5d0(-0xdf,-0x8e,-0x168,-0x54)+'x','kKXUG':function(_0x55cf0e,_0x496a56){return _0x55cf0e!==_0x496a56;},'XCdJe':_0x4a455c(0x1f9,0x22c,0x23f,0x1d6),'fijwZ':_0x47b5d0(-0x17f,-0x18f,-0x123,-0x200),'WoaFR':'flex','UHuzO':_0x4a455c(0x1d3,0x190,0x209,0x1a5)},_0x7eaf1d=document[_0x47b5d0(-0x10f,-0x1a3,-0xb5,-0x18c)+_0x4a455c(0x27a,0x1fa,0x26d,0x2e3)](_0x305f0e['yorfv']),_0xfb2538=document[_0x4a455c(0x1cb,0x220,0x21d,0x1b0)+_0x4a455c(0x202,0x1e8,0x1cd,0x1c1)](_0x4a455c(0x1eb,0x1b7,0x1ef,0x1f3)+_0x4a455c(0x276,0x21a,0x211,0x1d9)+_0x4a455c(0x29f,0x29b,0x23e,0x23c)+_0x47b5d0(-0xd7,-0x4f,-0xec,-0x98)+_0x4a455c(0x2a2,0x314,0x2a8,0x2e5)+_0x47b5d0(-0xcf,-0x157,-0x117,-0x4b)+'laceholder');function _0x47b5d0(_0x3d468d,_0x91a683,_0x2b6231,_0x4e539c){return _0x187cb8(_0x2b6231,_0x3d468d- -0x98,_0x2b6231-0x1ab,_0x4e539c-0x54);}const _0x281da8=document[_0x47b5d0(-0x10f,-0xdd,-0xc4,-0xcd)+_0x47b5d0(-0xcd,-0x66,-0xcb,-0x3b)](_0x305f0e[_0x47b5d0(-0xb1,-0x5f,-0xd2,-0x5c)]);function _0x4a455c(_0x1016b6,_0x543358,_0x5477ec,_0x5e91a5){return _0x1a7b29(_0x1016b6-0x1c2,_0x543358-0x9d,_0x1016b6,_0x5477ec- -0x399);}if(_0x5a977d&&_0x5a977d['startsWith'](_0x305f0e[_0x4a455c(0x21c,0x289,0x273,0x1e6)])){if(_0x305f0e[_0x47b5d0(-0x109,-0xa5,-0x9e,-0xd5)](_0x305f0e[_0x47b5d0(-0xf7,-0x149,-0x72,-0x120)],_0x305f0e['DfNjG']))_0x305f0e[_0x4a455c(0x1ee,0x264,0x25c,0x265)](_0x27a871);else{_0x7eaf1d[_0x47b5d0(-0xbd,-0x135,-0xc9,-0x38)]=_0x5a977d,_0x7eaf1d[_0x47b5d0(-0x15a,-0x144,-0x1c5,-0x14b)][_0x4a455c(0x23a,0x233,0x28d,0x209)]=_0x4a455c(0x205,0x1d8,0x21a,0x267),_0xfb2538[_0x47b5d0(-0x15a,-0xc7,-0x18e,-0x13b)][_0x47b5d0(-0xad,-0xf3,-0x1e,-0x52)]=_0x47b5d0(-0x131,-0xb5,-0x17e,-0x1ba),_0x281da8[_0x4a455c(0x232,0x1e8,0x1e0,0x18a)][_0x47b5d0(-0xad,-0x58,-0xcc,-0x123)]=_0x305f0e[_0x47b5d0(-0xe1,-0x85,-0xf1,-0x78)];const _0x2ae12d=_0x5a977d[_0x4a455c(0x1af,0x27d,0x22d,0x2a3)](','),_0x3cf153=_0x2ae12d[0x1a0f+-0x10f4+-0x91b][_0x4a455c(0x216,0x1ba,0x22d,0x28a)](':')[0x1b19+0xea7+0x1*-0x29bf][_0x4a455c(0x1ce,0x214,0x22d,0x23c)](';')[-0x131e+0x1327*-0x1+0x2645];nai3CharRefImageMimeType=_0x3cf153,window[_0x47b5d0(-0x114,-0x129,-0x12d,-0xcd)+_0x47b5d0(-0x116,-0x132,-0x133,-0x8e)]=_0x2ae12d[-0x114b+0x1*-0xcf4+-0xf20*-0x2];const _0x191ee6={};_0x191ee6['id']=NAI_CHAR_REF_CACHE_KEY,_0x191ee6[_0x4a455c(0x2f1,0x286,0x26e,0x23f)]=_0x5a977d,dbs[_0x4a455c(0x1d2,0x1da,0x1e6,0x193)+_0x47b5d0(-0x75,-0xb5,-0x51,-0x25)](_0x191ee6);}}else{if(_0x305f0e['kKXUG'](_0x305f0e['XCdJe'],_0x305f0e['XCdJe'])){const _0x35784a=_0x592e4c[_0x4a455c(0x28a,0x1d0,0x1f5,0x275)],_0x36ba96={};_0x36ba96[_0x47b5d0(-0xcc,-0xb1,-0x105,-0x13a)]=_0x35784a,_0x36ba96[_0x47b5d0(-0x6c,-0x53,0x13,-0xf1)+_0x4a455c(0x2c8,0x248,0x24a,0x2b1)]=_0x755a4a[_0x47b5d0(-0x6f,-0x73,-0x4e,-0xd5)];const _0x2b6899=_0x36ba96,_0x4e518e={};_0x4e518e['id']=_0x9f4eff,_0x4e518e[_0x47b5d0(-0xcc,-0x5f,-0x8c,-0xf5)]=_0x2b6899,_0x4bf220[_0x4a455c(0x186,0x246,0x1e6,0x203)+'rite'](_0x4e518e);}else{const _0x3c1528=_0x305f0e[_0x47b5d0(-0x113,-0x174,-0x16e,-0x121)]['split']('|');let _0x4f73f8=0x6e1*-0x5+-0x25bc+0x4821*0x1;while(!![]){switch(_0x3c1528[_0x4f73f8++]){case'0':_0xfb2538['style'][_0x47b5d0(-0xad,-0x4c,-0xf6,-0xe7)]=_0x305f0e[_0x4a455c(0x1b8,0x1af,0x1b7,0x191)];continue;case'1':window['nai3CharRe'+_0x47b5d0(-0x116,-0x151,-0x185,-0x16c)]=null;continue;case'2':_0x281da8[_0x47b5d0(-0x15a,-0x12d,-0xe4,-0xf9)][_0x4a455c(0x2f3,0x27e,0x28d,0x246)]=_0x305f0e[_0x4a455c(0x29f,0x1f4,0x228,0x281)];continue;case'3':_0x7eaf1d['style'][_0x4a455c(0x23a,0x2bb,0x28d,0x259)]=_0x305f0e['UHuzO'];continue;case'4':_0x7eaf1d[_0x4a455c(0x30a,0x25b,0x27d,0x2c0)]='';continue;}break;}}}}function removeNovelaiCharRefImage(){function _0x280372(_0x169e0a,_0x26b902,_0xae8671,_0x2b9e3d){return _0x187cb8(_0x169e0a,_0xae8671-0x2bf,_0xae8671-0xb9,_0x2b9e3d-0x6d);}updateNovelaiCharRefImagePreview(null),dbs[_0x280372(0x272,0x25a,0x232,0x1ec)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x177b31){function _0x3d64ee(_0x226359,_0x2c87be,_0xf5f2b6,_0x52f083){return _0x1a7b29(_0x226359-0x64,_0x2c87be-0xdc,_0xf5f2b6,_0x52f083- -0x5d);}function _0xa277d0(_0x5c6bc5,_0x35f40b,_0x2485ae,_0x315030){return _0x1a7b29(_0x5c6bc5-0x8d,_0x35f40b-0x1dc,_0x315030,_0x5c6bc5- -0x52e);}const _0x2dc840={'NTduq':_0xa277d0(0xf1,0x8a,0x143,0x142),'XMwEP':_0x3d64ee(0x5b5,0x51e,0x51b,0x545),'VYOZD':function(_0x31bf30,_0x1d7395){return _0x31bf30!==_0x1d7395;},'QvRRv':_0x3d64ee(0x577,0x4cf,0x545,0x55d),'iATRs':function(_0x112abf,_0x1bc79b){return _0x112abf(_0x1bc79b);},'HfsIv':function(_0xdd6696,_0x583bb1){return _0xdd6696===_0x583bb1;},'aODDq':_0xa277d0(0x94,0xf9,0x86,0x9),'SpYhc':function(_0x589ac9,_0x5f4c4e){return _0x589ac9(_0x5f4c4e);},'OQfSY':function(_0x44cb45,_0x426b21){return _0x44cb45+_0x426b21;},'nvxSA':_0xa277d0(0x106,0x155,0x143,0x130)},_0x46ad11=_0x177b31[_0xa277d0(0xff,0xc9,0x13f,0x17a)][_0xa277d0(0x3a,-0x16,0x8f,0x79)][0x1357+-0x1*-0x262d+0x3984*-0x1];if(!_0x46ad11)return;try{if(_0x2dc840['VYOZD'](_0x2dc840['QvRRv'],_0x2dc840['QvRRv'])){const _0x4047dd=_0x2dc840[_0x3d64ee(0x58a,0x577,0x4ff,0x58d)][_0xa277d0(0x98,0xeb,0xbb,0x37)]('|');let _0x13522f=0x22e3+-0x46c+0xb*-0x2c5;while(!![]){switch(_0x4047dd[_0x13522f++]){case'0':_0x13616f[_0x3d64ee(0x5bb,0x626,0x596,0x5b9)]='';continue;case'1':_0x152390['style'][_0xa277d0(0xf8,0x12c,0x129,0x6d)]=_0xa277d0(0x74,0x7e,0x2d,0x98);continue;case'2':_0x56c72d[_0x3d64ee(0x4db,0x531,0x4c6,0x51c)][_0x3d64ee(0x62d,0x631,0x631,0x5c9)]=_0x2dc840['XMwEP'];continue;case'3':_0x6c8740[_0x3d64ee(0x54a,0x4c5,0x4cd,0x51c)][_0xa277d0(0xf8,0xfa,0x182,0xe3)]=_0x3d64ee(0x5c8,0x627,0x5d9,0x596);continue;case'4':_0x5a5c70[_0x3d64ee(0x503,0x5ec,0x527,0x562)+_0x3d64ee(0x5f2,0x4e5,0x589,0x560)]=null;continue;}break;}}else{const _0x2a40e8=await processUploadedImage(_0x46ad11);_0x2dc840['iATRs'](updateNovelaiCharRefImagePreview,_0x2a40e8);}}catch(_0x56bbed){_0x2dc840[_0xa277d0(0xe4,0x170,0xb2,0x169)](_0xa277d0(0x11d,0xa6,0xab,0x1af),_0x2dc840[_0xa277d0(0x59,0x4f,-0x2f,-0x20)])?(_0x3e9a69['src']='',_0x355251[_0xa277d0(0x4b,0xc0,0x7c,0xc)][_0xa277d0(0xf8,0x96,0x185,0xc2)]=_0x2dc840['XMwEP'],_0x53ed75[_0x3d64ee(0x4fb,0x4fc,0x591,0x51c)][_0xa277d0(0xf8,0x141,0xeb,0x18d)]=_0x3d64ee(0x5ff,0x5d4,0x5bf,0x596),_0x184be4[_0xa277d0(0x4b,0x85,0xd5,0xd9)][_0xa277d0(0xf8,0xde,0xd4,0x12f)]=_0x2dc840[_0x3d64ee(0x5c2,0x62d,0x5da,0x603)],_0x47d82a[_0x3d64ee(0x661,0x5a1,0x566,0x5e9)+_0x3d64ee(0x67d,0x66e,0x5ef,0x5ea)+'e']=null):(console['error'](_0xa277d0(0x9a,0xf0,0x11,0x8)+_0xa277d0(0x50,0x11,0xa8,0x9a)+_0xa277d0(0x9d,0x114,0xca,0x1f)+_0xa277d0(0xb8,0x33,0x46,0x9c),_0x56bbed),_0x2dc840['SpYhc'](alert,_0x2dc840['OQfSY'](_0x2dc840[_0x3d64ee(0x5ad,0x527,0x539,0x578)],_0x56bbed[_0xa277d0(0xfe,0x11a,0x104,0xc6)])));}}function updateComfyUIImagePreview(_0x1c2b35){const _0x56223c={};_0x56223c[_0x124eff(0x468,0x450,0x43c,0x4bd)]=_0x124eff(0x61c,0x5cb,0x519,0x593)+_0x124eff(0x432,0x4a6,0x4be,0x4c1),_0x56223c[_0x3453ba(-0x15f,-0xdc,-0x10e,-0x96)]=_0x124eff(0x50c,0x59c,0x4e2,0x515)+_0x3453ba(-0x60,-0x8b,-0xa7,-0x2e)+_0x3453ba(-0x52,-0x85,-0x7d,-0xca)+'er\x20.st-cha'+_0x3453ba(-0xbb,-0xfa,-0xf6,-0x74)+'placeholde'+'r',_0x56223c[_0x3453ba(-0xf9,-0x117,-0x139,-0x131)]='comfyui-re'+'move-image'+_0x124eff(0x4c0,0x4c4,0x517,0x4be),_0x56223c['dILBB']=_0x3453ba(-0x4f,-0x31,0x3b,0x33),_0x56223c['xJwgw']=function(_0x3fd106,_0x167fba){return _0x3fd106===_0x167fba;},_0x56223c[_0x124eff(0x516,0x54a,0x438,0x4c9)]=_0x3453ba(-0xa2,-0x130,-0x173,-0x13f),_0x56223c['ibniE']=_0x3453ba(-0x12f,-0xdb,-0xc7,-0xe4),_0x56223c[_0x124eff(0x54b,0x52f,0x546,0x5bc)]=_0x3453ba(-0x64,-0xec,-0x16a,-0xb9),_0x56223c[_0x3453ba(-0x58,-0xe7,-0x60,-0x14d)]='inline-fle'+'x',_0x56223c['RhZve']=_0x124eff(0x4d0,0x4df,0x5a7,0x541)+'2';function _0x124eff(_0x363454,_0x5beef3,_0x2ed566,_0x2c73f9){return _0x187cb8(_0x363454,_0x2c73f9-0x59f,_0x2ed566-0x61,_0x2c73f9-0x3a);}_0x56223c[_0x3453ba(-0x1b,-0x7a,-0xf9,-0x1a)]=_0x3453ba(-0x5a,-0x9b,-0xfa,-0xfd);const _0xb0805e=_0x56223c,_0x4170e9=document[_0x3453ba(-0x3c,-0xca,-0x5b,-0xf6)+_0x124eff(0x5de,0x505,0x57f,0x56a)](_0xb0805e[_0x124eff(0x4bb,0x497,0x4e4,0x4bd)]),_0x32d361=document[_0x3453ba(-0xa1,-0xd8,-0x153,-0xb4)+_0x3453ba(-0x145,-0x128,-0x158,-0x145)](_0xb0805e[_0x124eff(0x4b1,0x4f0,0x531,0x516)]),_0x1ff36b=document['getElement'+_0x124eff(0x551,0x520,0x5f0,0x56a)](_0xb0805e[_0x124eff(0x456,0x561,0x543,0x4db)]);function _0x3453ba(_0x5765a7,_0x472a6b,_0x45d031,_0xbdbf98){return _0x1a7b29(_0x5765a7-0x146,_0x472a6b-0x16b,_0xbdbf98,_0x472a6b- -0x68e);}_0x4170e9[_0x3453ba(-0xa,-0x78,-0x1a,-0x3f)]&&_0x4170e9[_0x3453ba(-0x32,-0x78,-0xc8,-0x4)][_0x124eff(0x545,0x5f1,0x62d,0x5b6)](_0xb0805e[_0x3453ba(-0x37,-0x86,-0xfd,-0x5)])&&_0x4170e9[_0x124eff(0x5cf,0x558,0x4ec,0x57a)]!==_0x1c2b35&&URL[_0x124eff(0x4dc,0x512,0x515,0x51d)+_0x3453ba(-0xf5,-0x119,-0xea,-0xdd)](_0x4170e9['src']);if(_0x1c2b35)_0xb0805e[_0x124eff(0x519,0x502,0x577,0x537)](_0x3453ba(-0x197,-0x130,-0xf7,-0x170),_0xb0805e['GAGFB'])?(_0x4170e9[_0x124eff(0x5ca,0x4f2,0x604,0x57a)]=_0x1c2b35,_0x4170e9[_0x124eff(0x53b,0x528,0x549,0x4dd)]['display']=_0xb0805e['ibniE'],_0x32d361[_0x3453ba(-0x11b,-0x115,-0x125,-0x9f)]['display']=_0xb0805e[_0x124eff(0x53b,0x5a8,0x647,0x5bc)],_0x1ff36b[_0x124eff(0x47d,0x4cd,0x564,0x4dd)]['display']=_0xb0805e['isZvj']):_0x2f4d3a[_0x124eff(0x57c,0x53c,0x53c,0x528)+_0x3453ba(-0x5c,-0x88,-0x110,-0x91)](_0x124eff(0x4ef,0x4ff,0x4fd,0x543)+'2')[_0x124eff(0x4c3,0x517,0x530,0x51f)]();else{const _0x4e83ab=_0xb0805e[_0x124eff(0x484,0x526,0x569,0x4d6)][_0x124eff(0x4ac,0x4be,0x4e2,0x52a)]('|');let _0x22423f=-0x1f14*0x1+-0x2b*0x15+0x229b;while(!![]){switch(_0x4e83ab[_0x22423f++]){case'0':_0x1ff36b[_0x3453ba(-0x15e,-0x115,-0x137,-0xdb)][_0x124eff(0x544,0x61a,0x50f,0x58a)]=_0x3453ba(-0xba,-0xec,-0x8d,-0x8f);continue;case'1':_0x4170e9[_0x3453ba(-0xd2,-0x115,-0x154,-0x119)][_0x124eff(0x5f6,0x614,0x4fd,0x58a)]=_0x3453ba(-0x138,-0xec,-0x167,-0x5b);continue;case'2':comfyuiImageObjectURL=null;continue;case'3':_0x32d361[_0x124eff(0x4db,0x535,0x52c,0x4dd)]['display']=_0xb0805e[_0x124eff(0x5d5,0x507,0x5f0,0x578)];continue;case'4':_0x4170e9['src']='';continue;case'5':window[_0x3453ba(-0x92,-0x56,-0x5e,-0x16)+_0x3453ba(-0x3a,-0x4f,-0x58,-0xe0)]=null;continue;}break;}}}function removeComfyUIImage(){const _0x3351e8={'Ijmjc':function(_0xc7d295,_0x43fdc0){return _0xc7d295(_0x43fdc0);}};_0x3351e8['Ijmjc'](updateComfyUIImagePreview,null);function _0x372ebe(_0x407765,_0x109ee2,_0x162e52,_0x59208a){return _0x187cb8(_0x109ee2,_0x407765-0x1da,_0x162e52-0x126,_0x59208a-0x187);}dbs[_0x372ebe(0x14d,0x19a,0x1c3,0x179)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x53370a){const _0x5bd698={'klbyc':function(_0x3027eb,_0x112d79){return _0x3027eb(_0x112d79);},'VYtSS':function(_0x45e3d8,_0x14849a){return _0x45e3d8===_0x14849a;},'ebQDI':_0x1262a6(-0x126,-0xf7,-0x120,-0xe2),'WtfqS':function(_0x315622,_0x2776a9){return _0x315622(_0x2776a9);},'utQKG':_0x37234e(0x54,0xb4,-0xa,-0x8),'FqfuO':function(_0x251799,_0x30a6a2){return _0x251799!==_0x30a6a2;},'diUxm':_0x1262a6(-0x16e,-0xc5,-0xe1,-0x12a),'JqoLz':_0x37234e(0x73,0xce,0xe5,-0x1f),'VDvMt':'请先设置ComfyU'+_0x1262a6(-0xa4,-0x1bc,-0x131,-0xc4),'SjOQf':function(_0x9070ad){return _0x9070ad();},'FEbvV':function(_0x8fbaa7,_0x200643,_0x28bd86){return _0x8fbaa7(_0x200643,_0x28bd86);},'zkQxU':'POST','dmNJs':_0x1262a6(-0x96,-0x105,-0xc3,-0x4b)+_0x1262a6(-0x4b,-0x3f,-0x69,-0x84),'pHwoX':function(_0x10a9d7,_0x106f21){return _0x10a9d7===_0x106f21;},'hzXKC':'WINat','OOlsN':function(_0x78497d,_0x3a1956){return _0x78497d+_0x3a1956;},'Hxklg':_0x37234e(0xbd,0x7b,0x9e,0x53),'Iofdb':function(_0x4f5cd1,_0x46a846){return _0x4f5cd1(_0x46a846);},'WNDiO':_0x1262a6(-0x4c,0x41,-0x47,-0x1b),'NBZHL':function(_0x2de746){return _0x2de746();},'QEYoH':'图片处理或上传时出错'+':\x20','JjZaj':'图片处理或上传时出错'+':','WNhcM':function(_0x76a271){return _0x76a271();}},_0x129e7e=extension_settings[extensionName];function _0x37234e(_0x558fdd,_0x4eb885,_0x1a8cb0,_0x5d3d86){return _0x1a7b29(_0x558fdd-0xdf,_0x4eb885-0xc0,_0x4eb885,_0x558fdd- -0x578);}const _0x46e2bc=_0x53370a[_0x37234e(0xb5,0xba,0x3f,0x60)][_0x1262a6(-0xf5,-0x1c1,-0x149,-0x1a2)][-0x21*-0x10e+-0x9f*0x2b+-0x819];function _0x1262a6(_0x186350,_0x37e209,_0x260eed,_0x1cb64e){return _0x1a7b29(_0x186350-0x4d,_0x37e209-0xa9,_0x1cb64e,_0x260eed- -0x6b1);}if(!_0x46e2bc)return;try{const _0x3c0935=await processUploadedImageToBlob(_0x46e2bc),_0x314573=URL[_0x1262a6(-0x1b0,-0x1c9,-0x135,-0x197)+_0x37234e(-0x3,-0x90,0x67,-0x1b)](_0x3c0935);comfyuiImageObjectURL=_0x314573,_0x5bd698[_0x1262a6(-0x14b,-0x126,-0x14d,-0xe7)](updateComfyUIImagePreview,_0x314573);const _0x348407=new FormData();_0x348407[_0x1262a6(-0x1b3,-0x10b,-0x14e,-0x150)](_0x5bd698[_0x1262a6(-0x105,-0x8f,-0xfc,-0x184)],_0x3c0935,_0x46e2bc[_0x1262a6(0x1b,-0x91,-0x4d,0x3a)]);let _0x251448=_0x129e7e['comfyuiUrl'][_0x37234e(0xca,0x86,0x145,0x3e)]();if(!_0x251448){if(_0x5bd698[_0x1262a6(-0xa6,0x39,-0x3b,0x51)](_0x5bd698[_0x37234e(0xd8,0xab,0xa8,0x92)],_0x5bd698[_0x37234e(0x85,0x5c,0x9e,0x6)])){_0x5bd698[_0x37234e(-0x14,0x51,-0x72,-0x53)](alert,_0x5bd698[_0x37234e(0x35,0xca,0x7,0x86)]),_0x5bd698[_0x1262a6(-0x1c9,-0x133,-0x15a,-0x1b9)](removeComfyUIImage);return;}else _0x5bd698[_0x1262a6(0x15,-0x26,-0x46,-0x94)](_0x54cca3,_0xfc2c7['data']);}const _0x3ff3f1=await _0x5bd698['FEbvV'](fetch,_0x251448+(_0x1262a6(-0x17c,-0x83,-0xee,-0x10b)+_0x37234e(0xf5,0x135,0x95,0x16c)),{'method':_0x5bd698['zkQxU'],'body':_0x348407});if(_0x3ff3f1['ok']){const _0x459ae7=await _0x3ff3f1[_0x37234e(0xe4,0x112,0xf4,0xbc)]();window[_0x37234e(0xc0,0x141,0x126,0xa9)+'kaotupian']=_0x459ae7[_0x37234e(0xec,0xc6,0x59,0xb1)],_0x5bd698['klbyc'](addLog,_0x37234e(0x82,0x7d,0x8d,0xb4)+_0x37234e(0x99,0x9,0xca,0x96)+JSON['stringify'](_0x459ae7)),console['log'](_0x5bd698[_0x1262a6(-0xbf,-0x9,-0x74,-0x44)],_0x459ae7);const _0x540d42=new FileReader();_0x540d42['onloadend']=()=>{function _0xd7b71(_0x28fbcb,_0x130ef9,_0x116e13,_0x36f695){return _0x1262a6(_0x28fbcb-0x15b,_0x130ef9-0x1c,_0x130ef9-0x215,_0x116e13);}function _0x5b6935(_0x119422,_0x43ff9a,_0x4fcaf0,_0x593fe6){return _0x37234e(_0x119422- -0x52,_0x43ff9a,_0x4fcaf0-0x87,_0x593fe6-0xf4);}if(_0x5bd698[_0x5b6935(-0x5f,-0x18,-0x88,-0x3a)](_0xd7b71(0xbf,0xf5,0x8d,0x16c),_0x5bd698[_0x5b6935(0x9c,0xc9,0x101,0x1f)])){const _0x387615=_0x540d42[_0xd7b71(0x97,0xf2,0x147,0xb8)],_0x11bf44={};_0x11bf44['data']=_0x387615,_0x11bf44[_0xd7b71(0x228,0x1cb,0x162,0x20a)+_0xd7b71(0x152,0x147,0x1a5,0x10f)]=_0x459ae7['name'];const _0x30bed4=_0x11bf44,_0x45cd64={};_0x45cd64['id']=COMFYUI_REF_CACHE_KEY,_0x45cd64[_0xd7b71(0x14a,0x16b,0x1db,0xfe)]=_0x30bed4,dbs[_0x5b6935(-0x4b,-0xd8,-0x25,-0x3d)+_0x5b6935(0x94,0xae,0x8d,0xab)](_0x45cd64);}else{const _0xea6a3c=_0x56c823['apply'](_0x36a9b7,arguments);return _0x4eadf5=null,_0xea6a3c;}},_0x540d42[_0x1262a6(-0xa0,-0x140,-0x12b,-0xb8)+_0x1262a6(-0x85,-0xdc,-0x108,-0xb2)](_0x3c0935);}else{if(_0x5bd698['pHwoX'](_0x1262a6(-0x139,-0xd0,-0xdf,-0xc3),_0x5bd698[_0x1262a6(-0xcc,-0x11f,-0x101,-0xba)]))_0x56e968[_0x37234e(0xb9,0x131,0x62,0x12a)]('Error\x20load'+_0x1262a6(-0x83,-0xcd,-0x116,-0xb1)+_0x37234e(0x37,0xba,0x94,-0x1e)+_0x37234e(0xa0,0x31,0x129,0x94)+_0x37234e(0x22,0x1,0xa2,-0x4c),_0x21d3e8);else{const _0x220d60=await _0x3ff3f1[_0x37234e(0x97,0xde,0xa0,0x47)]();_0x5bd698[_0x1262a6(0xb,-0x8,-0x46,0x2d)](alert,_0x5bd698[_0x1262a6(-0x181,-0x16c,-0xfd,-0x14a)](_0x5bd698[_0x1262a6(-0x154,-0x7b,-0xe0,-0xfa)],_0x220d60)),_0x5bd698[_0x37234e(0x2c,0x16,0x2,0x72)](addLog,_0x1262a6(-0x111,-0x144,-0x105,-0x88)+_0x37234e(0x7f,0xb9,0x50,0xaf)+_0x220d60),console[_0x37234e(0xb9,0x38,0xec,0x26)](_0x5bd698[_0x37234e(0x29,0x16,0x63,-0x3d)],_0x220d60),_0x5bd698[_0x1262a6(-0x8b,-0x153,-0xc0,-0xd2)](removeComfyUIImage);}}}catch(_0x390828){alert(_0x5bd698['OOlsN'](_0x5bd698[_0x37234e(0x5e,0xd8,-0xc,0x1a)],_0x390828[_0x37234e(0xb4,0x121,0x2e,0xdc)])),console[_0x37234e(0xb9,0x50,0x38,0xf4)](_0x5bd698[_0x1262a6(-0xb8,-0x194,-0x130,-0xf6)],_0x390828),addLog(_0x37234e(0x34,0x95,0x3d,0xaf)+'详情:\x20'+JSON['stringify'](_0x390828)),_0x5bd698[_0x37234e(0x6f,0x1a,0xf2,0x2a)](removeComfyUIImage);}}async function loadCachedImages(){function _0x30cd8e(_0x3a2934,_0x4e4638,_0x51b702,_0x27e789){return _0x187cb8(_0x4e4638,_0x51b702-0x57a,_0x51b702-0xeb,_0x27e789-0x165);}const _0x3018bb={'MlMAa':_0x5afb94(0xf7,0x7e,0xd5,0xd3)+_0x5afb94(0xa1,0x125,0x13a,0xd7)+_0x30cd8e(0x4da,0x445,0x4d7,0x520),'jtQMw':_0x30cd8e(0x47e,0x488,0x4c7,0x530)+_0x30cd8e(0x464,0x55b,0x4e9,0x4c4)+_0x5afb94(0xc4,0x6f,-0x6,0x7b)+'w-containe'+_0x30cd8e(0x52f,0x59f,0x580,0x560)+'u8-image-p'+_0x30cd8e(0x559,0x55f,0x4d8,0x46f),'XlnuF':'novelai-re'+_0x30cd8e(0x5f0,0x538,0x5a1,0x5f9)+_0x30cd8e(0x5be,0x55d,0x588,0x5b3)+_0x5afb94(-0x48,-0x62,0x65,0x5),'iAJnU':_0x5afb94(0x134,0xdd,0x50,0xb2),'UXwPm':_0x30cd8e(0x471,0x506,0x4f2,0x47d),'ONzeI':'inline-fle'+'x','cfgdO':_0x5afb94(0xfa,0x129,0x7e,0xae),'zHzhG':_0x30cd8e(0x546,0x567,0x4e1,0x511),'UEJmp':_0x30cd8e(0x5a9,0x4c1,0x532,0x50a),'OOTPG':_0x30cd8e(0x563,0x4e2,0x56e,0x5e2)+_0x30cd8e(0x508,0x46e,0x492,0x42c),'JlMqy':_0x5afb94(0x33,0xd6,0x7a,0x60)+_0x30cd8e(0x4f0,0x565,0x542,0x4e9)+'ew-contain'+_0x5afb94(0x8f,0xe7,0xd2,0xfb)+'tu8-image-'+'placeholde'+'r','fdMsc':_0x5afb94(0x4c,0x95,-0x20,0x4f)+_0x5afb94(0x53,0x11,0x7a,0x27)+_0x5afb94(-0x25,-0x92,0x47,-0x2),'ILFji':_0x5afb94(0x8c,0x65,0x21,0xa6),'qVXdT':function(_0x170ebf){return _0x170ebf();},'uWzoA':function(_0x5268c0,_0xca5fcc){return _0x5268c0(_0xca5fcc);},'vpqev':function(_0x450486,_0x226e94){return _0x450486!==_0x226e94;},'Vennu':_0x5afb94(-0x22,-0x5d,0x40,0x31),'wXxRN':_0x5afb94(0xf1,0x13e,0x47,0xb1),'zQJOB':'Error\x20load'+_0x5afb94(-0x2e,0x24,-0x22,0x3f)+_0x5afb94(0xef,0xab,0x53,0xc9)+_0x5afb94(0x165,0xdb,0x7f,0xf5),'jWMoZ':function(_0x8e234d,_0x39cd4e){return _0x8e234d!==_0x39cd4e;},'NzeHJ':'fSDwx','tUNqD':function(_0x459e56,_0x35006a){return _0x459e56===_0x35006a;},'gFUnM':_0x30cd8e(0x4f1,0x4e8,0x4cf,0x45a),'KUjNe':function(_0x490b77,_0x161e79){return _0x490b77(_0x161e79);},'xWRKu':_0x30cd8e(0x518,0x4c5,0x49f,0x508),'gJBOx':_0x30cd8e(0x52a,0x511,0x4f6,0x4aa),'TggXg':_0x5afb94(0x72,-0x78,0x91,0x10),'Xjitm':_0x5afb94(0x22,-0xf,0xf7,0x73),'DsPvp':function(_0x4cec66,_0x115725){return _0x4cec66(_0x115725);},'SdkTs':_0x30cd8e(0x52a,0x4d2,0x4b2,0x422),'slIQJ':_0x5afb94(0x14c,0x6d,0x7e,0xcc),'hxaoF':function(_0x5cf33c,_0x2f9991){return _0x5cf33c(_0x2f9991);},'JPxXm':_0x5afb94(0x157,0x165,0xe4,0xd4)+'fyUI\x20image'+_0x5afb94(0x41,0x67,0x66,0x6d)+_0x5afb94(0xe1,0x17e,0x80,0xf7)+_0x30cd8e(0x5d9,0x4e9,0x57b,0x5e0)+_0x5afb94(-0x4b,0x1c,0x6f,0x49)+'\x20to\x20update'+'\x20cache\x20to\x20'+_0x5afb94(0x12d,0xda,0x101,0xff)+_0x30cd8e(0x545,0x4e6,0x55f,0x575)};await dbs[_0x5afb94(0x182,0x145,0xb4,0x110)]();try{const _0x18cc59=await dbs[_0x5afb94(0x5,0x62,-0x15,-0x1)+'nly'](NAI_VIBE_CACHE_KEY);if(_0x18cc59&&_0x18cc59[_0x30cd8e(0x4b1,0x4f2,0x546,0x559)]){if(_0x3018bb['vpqev'](_0x3018bb['Vennu'],_0x30cd8e(0x498,0x544,0x506,0x4b7)))updateNovelaiImagePreview(_0x18cc59[_0x5afb94(0xd6,0xe5,0x70,0xab)]);else{const _0x374d9b=_0x254245[_0x30cd8e(0x55b,0x574,0x503,0x57e)+_0x30cd8e(0x5ab,0x56d,0x545,0x548)](_0x3018bb[_0x30cd8e(0x491,0x4ff,0x521,0x581)]),_0x4e92df=_0x3b199e[_0x5afb94(0x6c,0x80,0x7d,0x5a)+'tor'](_0x3018bb[_0x5afb94(0xa7,0xfa,0x126,0xe2)]),_0x244cd1=_0x112dc1[_0x5afb94(0xf9,0x16,0xbf,0x68)+_0x30cd8e(0x574,0x5b5,0x545,0x53d)](_0x3018bb[_0x30cd8e(0x4e1,0x549,0x52c,0x4ae)]);if(_0x395a95&&_0x45ff7f['startsWith'](_0x3018bb[_0x5afb94(0x98,0x186,0x1a4,0x11b)])){_0x374d9b[_0x5afb94(0x114,0x146,0x29,0xba)]=_0x4a9c4b,_0x374d9b[_0x30cd8e(0x53f,0x4a4,0x4b8,0x449)][_0x5afb94(0xcf,0x45,0x67,0xca)]=_0x3018bb[_0x5afb94(0x66,0x8e,0x129,0x9c)],_0x4e92df[_0x5afb94(0x8,-0x54,0x51,0x1d)][_0x30cd8e(0x540,0x4ec,0x565,0x535)]=_0x5afb94(-0x21,0x25,-0x9,0x46),_0x244cd1[_0x30cd8e(0x536,0x43a,0x4b8,0x4ff)]['display']=_0x3018bb['ONzeI'];const _0x47c456=_0x4b7d97[_0x5afb94(0x50,0xed,0x9b,0x6a)](','),_0x4a53fb=_0x47c456[0x1f6b+-0x1807+-0x764]['split'](':')[0x93+0x10f7*0x1+-0x1189][_0x30cd8e(0x4d4,0x563,0x505,0x560)](';')[0x1a54+-0x1148+-0x90c];_0x2b475f=_0x4a53fb,_0x212a15[_0x30cd8e(0x51b,0x51e,0x4fe,0x505)+_0x30cd8e(0x587,0x4c5,0x4fc,0x532)]=_0x47c456[-0x1*0xf96+0x29*0x2b+0x22d*0x4];const _0x4ad6cb={};_0x4ad6cb['id']=_0x51fcd5,_0x4ad6cb['data']=_0x2504e9,_0x5ba633[_0x30cd8e(0x4c9,0x4f7,0x4be,0x457)+_0x30cd8e(0x537,0x56c,0x59d,0x5bc)](_0x4ad6cb);}else{const _0x5d7035=_0x3018bb[_0x30cd8e(0x56a,0x539,0x582,0x522)]['split']('|');let _0x362287=-0x2028+0x2b7*0x7+0xd27;while(!![]){switch(_0x5d7035[_0x362287++]){case'0':_0x374d9b[_0x30cd8e(0x527,0x559,0x555,0x552)]='';continue;case'1':_0x374d9b['style'][_0x30cd8e(0x5f3,0x59c,0x565,0x5a9)]=_0x3018bb[_0x5afb94(-0x12,0x7d,-0x7a,0x12)];continue;case'2':_0x5015eb['nai3CharRe'+_0x5afb94(0x7d,0x87,0xf3,0x61)]=null;continue;case'3':_0x4e92df[_0x30cd8e(0x4c8,0x445,0x4b8,0x549)][_0x5afb94(0x149,0xb2,0x6c,0xca)]=_0x3018bb[_0x30cd8e(0x4f5,0x577,0x53f,0x4bb)];continue;case'4':_0x244cd1[_0x30cd8e(0x4ac,0x474,0x4b8,0x536)][_0x30cd8e(0x4ed,0x594,0x565,0x4e4)]=_0x3018bb[_0x30cd8e(0x4b4,0x42b,0x4ad,0x4cf)];continue;}break;}}}}}catch(_0x1d11cf){if(_0x3018bb[_0x5afb94(0x3c,0xe9,-0x2,0x85)](_0x5afb94(0x29,0xd0,0x113,0xb1),_0x3018bb[_0x5afb94(0x163,0x127,0x142,0xd2)])){const _0x317cae=_0x444564['getElement'+'ById'](_0x3018bb[_0x5afb94(0x103,0x110,0xdf,0xf0)]),_0x1bb5cd=_0x5196bc[_0x30cd8e(0x499,0x55d,0x4f5,0x475)+_0x5afb94(0x48,-0x6e,0x5c,0xa)](_0x3018bb['JlMqy']),_0x5e5118=_0x2935c7[_0x5afb94(0x9b,0x6b,0xc7,0x68)+_0x30cd8e(0x567,0x53c,0x545,0x542)](_0x3018bb[_0x30cd8e(0x431,0x478,0x4ba,0x4a3)]);if(_0x46e1ab&&_0x12bd1e[_0x30cd8e(0x5f5,0x5af,0x591,0x538)](_0x3018bb[_0x30cd8e(0x64a,0x61b,0x5b6,0x52e)])){_0x317cae[_0x30cd8e(0x5cc,0x564,0x555,0x568)]=_0xa8e21f,_0x317cae['style'][_0x5afb94(0xf0,0xec,0xfb,0xca)]=_0x3018bb[_0x30cd8e(0x4ff,0x560,0x537,0x4fb)],_0x1bb5cd[_0x5afb94(-0x4d,-0x4d,-0x68,0x1d)][_0x5afb94(0xcd,0xe2,0xc2,0xca)]=_0x3018bb[_0x5afb94(-0x68,0x8d,0x22,0x12)],_0x5e5118[_0x5afb94(0xac,-0x5b,0x4a,0x1d)][_0x30cd8e(0x522,0x55c,0x565,0x54a)]=_0x5afb94(0x117,0x16,0x97,0x98)+'x';const _0x47d281=_0x375ca6[_0x30cd8e(0x520,0x52a,0x505,0x4c5)](','),_0x4f76c7=_0x47d281[-0xe81*-0x2+-0x16d8+-0x62a]['split'](':')[0x559*0x2+0x6f+-0xb20][_0x30cd8e(0x57d,0x4d1,0x505,0x492)](';')[0x1*0x13c6+-0xbb0+0xe6*-0x9];_0x4fa675=_0x4f76c7,_0x13d796[_0x5afb94(0xf2,0x10e,0x14d,0xea)+_0x30cd8e(0x618,0x514,0x586,0x51c)+'e']=_0x47d281[0x765*-0x1+0x13f0+-0xc8a];const _0x3ddefd={};_0x3ddefd['id']=_0x171a89,_0x3ddefd['data']=_0x3fd10a,_0xff06b3[_0x30cd8e(0x523,0x47f,0x4be,0x4a4)+_0x30cd8e(0x598,0x58e,0x59d,0x5e4)](_0x3ddefd);}else{const _0x2db89a=_0x3018bb[_0x5afb94(-0x17,0xc8,0x30,0x42)][_0x30cd8e(0x4a9,0x51d,0x505,0x557)]('|');let _0x4c9973=0x2*-0x56d+0x102d*-0x1+0x1b07;while(!![]){switch(_0x2db89a[_0x4c9973++]){case'0':_0x1bb5cd['style'][_0x30cd8e(0x5ea,0x542,0x565,0x581)]=_0x3018bb[_0x30cd8e(0x4ea,0x583,0x53f,0x4db)];continue;case'1':_0x5e5118[_0x30cd8e(0x4ae,0x4de,0x4b8,0x4ee)][_0x30cd8e(0x4e0,0x57f,0x565,0x5ce)]=_0x3018bb['zHzhG'];continue;case'2':_0x84aea4[_0x5afb94(0x11f,0xbd,0x156,0xea)+'ansferImag'+'e']=null;continue;case'3':_0x317cae['style']['display']='none';continue;case'4':_0x317cae[_0x30cd8e(0x586,0x58b,0x555,0x56b)]='';continue;}break;}}}else console[_0x5afb94(0x89,0x89,0x11d,0xd5)](_0x3018bb[_0x30cd8e(0x5a0,0x51d,0x58c,0x581)],_0x1d11cf);}function _0x5afb94(_0x35c5c8,_0x408783,_0xd16570,_0x253406){return _0x1a7b29(_0x35c5c8-0x116,_0x408783-0xaf,_0x35c5c8,_0x253406- -0x55c);}try{if(_0x3018bb[_0x30cd8e(0x480,0x48e,0x4e5,0x46c)](_0x5afb94(-0x8,-0x41,0xbb,0x39),_0x3018bb[_0x30cd8e(0x4c1,0x488,0x4cb,0x4a8)]))_0x3018bb['qVXdT'](_0x575a77);else{const _0x32e4ef=await dbs[_0x30cd8e(0x526,0x48d,0x49a,0x40d)+_0x30cd8e(0x4ff,0x598,0x50d,0x50f)](NAI_CHAR_REF_CACHE_KEY);_0x32e4ef&&_0x32e4ef['data']&&(_0x3018bb['tUNqD'](_0x5afb94(0x16,-0x1a,0x82,-0xb),_0x3018bb[_0x5afb94(0xcc,-0x42,0x36,0x40)])?_0x3018bb[_0x5afb94(0x2c,0xb9,0x15,0x84)](_0x33994b,_0x1f2e12[_0x5afb94(0xc6,0x82,0x127,0xab)]):_0x3018bb[_0x5afb94(0x8a,0x115,0x18a,0x112)](updateNovelaiCharRefImagePreview,_0x32e4ef[_0x5afb94(0xa0,0x116,0x13a,0xab)]));}}catch(_0x230bf1){if(_0x3018bb['xWRKu']===_0x5afb94(-0x8a,0x5,0x7c,0x4))console[_0x5afb94(0x131,0x14a,0x6a,0xd5)](_0x5afb94(0x2c,-0x52,0x8b,0x15)+_0x30cd8e(0x55c,0x52e,0x4da,0x563)+'\x20NovelAI\x20C'+_0x5afb94(0xbe,0x27,0xe7,0xbc)+_0x5afb94(0x4c,0x6f,0x79,0x3e),_0x230bf1);else{if(_0x411a62){const _0x3d8053=_0x5000ba[_0x5afb94(0xe6,0xfa,0x52,0x7e)](_0x3ae115,arguments);return _0x154d4b=null,_0x3d8053;}}}try{if(_0x5afb94(0x9c,0xa2,0xf6,0xc1)===_0x3018bb[_0x30cd8e(0x567,0x5a8,0x599,0x549)])_0x4766b4(null),_0x35d54a[_0x30cd8e(0x511,0x4d8,0x4ed,0x4a2)+'e'](_0x59b256);else{const _0x43ff83=await dbs[_0x30cd8e(0x4cc,0x426,0x49a,0x49d)+_0x30cd8e(0x495,0x56e,0x50d,0x527)](COMFYUI_REF_CACHE_KEY);if(_0x43ff83&&_0x43ff83[_0x30cd8e(0x560,0x51b,0x546,0x5d1)]&&_0x43ff83[_0x30cd8e(0x5cf,0x50f,0x546,0x5d2)]['data']&&_0x43ff83[_0x5afb94(0x1d,0xd0,0xea,0xab)]['serverFile'+'Name']){if(_0x3018bb[_0x30cd8e(0x46a,0x47f,0x4ac,0x4b5)](_0x3018bb['TggXg'],_0x3018bb[_0x30cd8e(0x556,0x553,0x55a,0x58e)]))_0x3c0c8e[_0x30cd8e(0x545,0x4f0,0x570,0x564)]('Error\x20load'+'ing\x20cached'+'\x20NovelAI\x20V'+_0x5afb94(0x6e,0xee,0x87,0xf5),_0x2368b9);else{const _0x1ea2b6=_0x43ff83[_0x5afb94(0x128,0x49,0xec,0xab)],_0x2f16ed=await fetch(_0x1ea2b6[_0x30cd8e(0x5a8,0x560,0x546,0x5b4)]),_0x202b55=await _0x2f16ed[_0x30cd8e(0x4dd,0x569,0x55b,0x4e6)](),_0x46f69c=URL[_0x5afb94(0x71,0x3a,0x9b,0x20)+_0x30cd8e(0x47a,0x49e,0x4b4,0x4b8)](_0x202b55);_0x3018bb[_0x30cd8e(0x51d,0x58f,0x568,0x5d0)](updateComfyUIImagePreview,_0x46f69c),comfyuiImageObjectURL=_0x46f69c,window[_0x30cd8e(0x4e4,0x4fe,0x577,0x593)+_0x5afb94(0x159,0x147,0x169,0xe3)]=_0x1ea2b6[_0x30cd8e(0x61c,0x57c,0x5a6,0x58c)+_0x5afb94(0x10f,0xbe,0x50,0x87)],_0x3018bb[_0x5afb94(0xf3,0x14f,0x88,0xcd)](addLog,_0x30cd8e(0x559,0x562,0x54f,0x4e3)+'UI图片:\x20'+_0x1ea2b6[_0x5afb94(0x7a,0x10b,0xb4,0x10b)+_0x30cd8e(0x580,0x51e,0x522,0x5a3)]),console[_0x30cd8e(0x558,0x541,0x589,0x5b0)](_0x30cd8e(0x546,0x59e,0x56f,0x54b)+_0x30cd8e(0x50a,0x4ff,0x4a6,0x536)+_0x5afb94(0x159,0xd3,0x138,0xf2)+_0x5afb94(0x51,0x4a,0x10,0x29)+_0x1ea2b6[_0x30cd8e(0x560,0x528,0x5a6,0x516)+_0x30cd8e(0x520,0x546,0x522,0x4fd)]);}}else{if(_0x43ff83&&_0x3018bb[_0x30cd8e(0x50a,0x4ed,0x4ac,0x4f2)](typeof _0x43ff83[_0x30cd8e(0x598,0x5c3,0x546,0x4ff)],_0x3018bb[_0x5afb94(0x80,0x27,0x7e,0xa3)])){if(_0x3018bb['slIQJ']!==_0x3018bb[_0x5afb94(0x8c,0x20,0xb4,0x2f)]){_0xf2fd17[_0x30cd8e(0x54c,0x50a,0x555,0x514)]=_0xf2c65f,_0x4e9591['style'][_0x30cd8e(0x570,0x50c,0x565,0x5cd)]=_0x3018bb['UXwPm'],_0x5e02f8[_0x30cd8e(0x456,0x53c,0x4b8,0x4b1)]['display']=_0x3018bb['zHzhG'],_0x383d04[_0x30cd8e(0x449,0x479,0x4b8,0x471)][_0x30cd8e(0x534,0x59f,0x565,0x569)]=_0x3018bb[_0x30cd8e(0x4a1,0x4cc,0x4c9,0x50b)];const _0x370314=_0x1e1090['split'](','),_0x235225=_0x370314[0xe17+0xcf2+-0x1b09]['split'](':')[0x25*0x2d+-0xdf1+0x17d*0x5]['split'](';')[-0x1*0x2423+0x14b5+-0x32*-0x4f];_0x8f1b5e=_0x235225,_0x1303d1[_0x5afb94(0xf7,0xde,0x38,0x63)+'fImage']=_0x370314[-0x109b+0x1*0x24fb+0x23*-0x95];const _0x12e212={};_0x12e212['id']=_0x23f2ca,_0x12e212['data']=_0x40f327,_0x3a5b04[_0x30cd8e(0x4e2,0x460,0x4be,0x42c)+_0x30cd8e(0x54b,0x61a,0x59d,0x53a)](_0x12e212);}else{const _0x321f82=await _0x3018bb['hxaoF'](fetch,_0x43ff83[_0x30cd8e(0x59b,0x511,0x546,0x516)]),_0x4a90cb=await _0x321f82['blob'](),_0x16e584=URL['createObje'+_0x5afb94(-0xc,-0x15,0x23,0x19)](_0x4a90cb);updateComfyUIImagePreview(_0x16e584),comfyuiImageObjectURL=_0x16e584,console[_0x30cd8e(0x45d,0x537,0x4bc,0x4fe)](_0x3018bb[_0x5afb94(0xdc,-0xc,0x7f,0x69)]);}}}}}catch(_0x22898d){console[_0x5afb94(0x11e,0x143,0x15d,0xd5)](_0x5afb94(0x74,0x8d,-0x1c,0x15)+'ing\x20cached'+_0x5afb94(0x51,0x23,0xe,0x93)+_0x5afb94(0x12,-0x52,0xc,0x33),_0x22898d);}}export function initImageUpload(_0x5f3e4c){function _0x194d5e(_0x551c0e,_0x92adee,_0x18bad9,_0x284666){return _0x187cb8(_0x284666,_0x18bad9-0x254,_0x18bad9-0x15f,_0x284666-0x48);}const _0x38fe2b={'dAemT':function(_0x2f262d){return _0x2f262d();},'hkqIF':_0x17ecd7(0x5f2,0x603,0x605,0x598)+'ge2','wOvMs':_0x194d5e(0x2ea,0x1e4,0x276,0x2b5),'slXBg':_0x17ecd7(0x59e,0x5c8,0x65d,0x605)+'x','jEVch':'none','cPzab':'flex','PijZQ':_0x194d5e(0x1da,0x181,0x1d7,0x1de),'BWwXT':function(_0x4bb306,_0xea0971){return _0x4bb306===_0xea0971;},'qdbXQ':_0x194d5e(0x242,0x20a,0x26d,0x25a),'AzQic':_0x194d5e(0x1ff,0x1d5,0x19b,0x215),'UXEQX':_0x17ecd7(0x545,0x5b3,0x531,0x5cd)+'2','kVPVQ':_0x194d5e(0x134,0x1d6,0x178,0x1b0)+'+$','DWMaC':'LzKPk','lsJTv':function(_0x45b3c8){return _0x45b3c8();},'SjBlI':'#novelai-s'+'elect-imag'+_0x194d5e(0x132,0x15d,0x183,0x10d),'PeGbz':_0x17ecd7(0x591,0x58f,0x606,0x5b5),'Vnkxa':_0x194d5e(0x232,0x2a6,0x24b,0x294)+_0x17ecd7(0x587,0x60b,0x5fa,0x5dc)+_0x17ecd7(0x4cb,0x53e,0x508,0x56e),'OYLTy':_0x194d5e(0x23f,0x22c,0x237,0x277)+_0x17ecd7(0x5e4,0x5a1,0x5d1,0x598)+_0x194d5e(0x256,0x2b6,0x23d,0x29e),'UsmYj':'change','LvhHL':'#novelai-r'+_0x194d5e(0x263,0x2d8,0x28e,0x1fa)+'-ref-image'+_0x194d5e(0x178,0x1e1,0x173,0x106),'qqdFd':'#comfyui-s'+_0x17ecd7(0x618,0x60a,0x624,0x60f)+_0x194d5e(0x216,0xf0,0x183,0x145),'WBNOV':_0x17ecd7(0x621,0x5ad,0x5c8,0x55b)+_0x17ecd7(0x61b,0x60b,0x68a,0x5a7)+'e-btn'};_0x38fe2b[_0x194d5e(0x2fc,0x2fb,0x27a,0x24d)](loadCachedImages),_0x5f3e4c[_0x194d5e(0x1f5,0x271,0x1fe,0x1dc)](_0x38fe2b['SjBlI'])['on'](_0x38fe2b[_0x194d5e(0x1c1,0x1d7,0x16e,0x17c)],()=>{function _0xd6b6e6(_0x29e0bd,_0x290c91,_0x150c7a,_0xf75ceb){return _0x17ecd7(_0x29e0bd-0x62,_0x150c7a- -0x496,_0xf75ceb,_0xf75ceb-0x8c);}function _0x5207d0(_0x4b072c,_0x57c706,_0x362db4,_0x59e294){return _0x17ecd7(_0x4b072c-0x12b,_0x59e294- -0x43e,_0x57c706,_0x59e294-0xb7);}document[_0x5207d0(0xff,0x18a,0xf9,0x15a)+_0xd6b6e6(0x1c8,0x1ca,0x144,0xd0)](_0xd6b6e6(0x107,0x15f,0x11d,0x164)+_0x5207d0(0x126,0x1f2,0x191,0x1b0))[_0x5207d0(0x1c6,0x10b,0x166,0x151)]();}),_0x5f3e4c[_0x194d5e(0x176,0x27d,0x1fe,0x256)](_0x17ecd7(0x5ba,0x5f2,0x624,0x579)+_0x194d5e(0x249,0x156,0x1d1,0x19a))['on']('change',handleNovelaiImageUpload),_0x5f3e4c['find'](_0x38fe2b['Vnkxa'])['on']('click',()=>{function _0x437e16(_0xe73341,_0x1a924a,_0x51b491,_0x5d5a9a){return _0x194d5e(_0xe73341-0x1c2,_0x1a924a-0xf2,_0x51b491- -0x1b8,_0xe73341);}_0x38fe2b[_0x437e16(0x32,-0xc4,-0x30,0x34)](removeNovelaiImage);}),_0x5f3e4c['find'](_0x17ecd7(0x573,0x5d9,0x5dc,0x621)+_0x17ecd7(0x5b2,0x639,0x5dd,0x642)+_0x194d5e(0x1b4,0x1f2,0x17b,0x10a)+_0x17ecd7(0x4d5,0x52e,0x5c3,0x57c))['on'](_0x38fe2b['PeGbz'],()=>{function _0x3c91a2(_0x4d2a67,_0x57ab25,_0xe5e3e1,_0x2ed8bf){return _0x17ecd7(_0x4d2a67-0x109,_0x2ed8bf- -0x2d,_0x57ab25,_0x2ed8bf-0xdc);}function _0x57f3e9(_0xfad261,_0x1b6b9f,_0x16b2bb,_0x17f560){return _0x17ecd7(_0xfad261-0xcb,_0x1b6b9f- -0x3cd,_0xfad261,_0x17f560-0xaf);}document[_0x3c91a2(0x549,0x5e4,0x508,0x56b)+'ById'](_0x3c91a2(0x54e,0x5ee,0x54d,0x586)+_0x57f3e9(0x1d8,0x26a,0x2f9,0x2f2)+_0x57f3e9(0x133,0x17b,0x1a2,0x208))[_0x3c91a2(0x56f,0x4f5,0x5ee,0x562)]();}),_0x5f3e4c[_0x194d5e(0x183,0x1a1,0x1fe,0x25f)](_0x38fe2b['OYLTy'])['on'](_0x38fe2b[_0x194d5e(0x2f5,0x2ca,0x281,0x211)],handleNovelaiCharRefImageUpload);function _0x17ecd7(_0x5d5b0d,_0x59fee2,_0x25c7c5,_0x41cef3){return _0x1a7b29(_0x5d5b0d-0x11e,_0x59fee2-0x7a,_0x25c7c5,_0x59fee2- -0x2c);}_0x5f3e4c[_0x194d5e(0x253,0x213,0x1fe,0x175)](_0x38fe2b[_0x17ecd7(0x5cc,0x60f,0x672,0x6a2)])['on'](_0x38fe2b[_0x17ecd7(0x557,0x529,0x511,0x58e)],()=>{function _0x5a18cc(_0x5372ed,_0x427164,_0x1da3c3,_0x2f8bfe){return _0x17ecd7(_0x5372ed-0x9a,_0x427164- -0x292,_0x2f8bfe,_0x2f8bfe-0x65);}function _0x468ed3(_0x54ed15,_0x202072,_0x3c8409,_0xc9b3ae){return _0x194d5e(_0x54ed15-0xa,_0x202072-0x1a9,_0x202072- -0x25c,_0x54ed15);}if(_0x38fe2b['PijZQ']!==_0x38fe2b['PijZQ']){const _0x3fedea=_0x1748db['getElement'+_0x468ed3(0x54,-0x3d,-0x68,-0x50)](_0x38fe2b[_0x5a18cc(0x360,0x387,0x41b,0x2f5)]),_0x214396=_0x230987[_0x468ed3(-0x3a,-0x8d,-0x71,0x6)+_0x5a18cc(0x2c6,0x2a8,0x315,0x2b1)](_0x5a18cc(0x34f,0x2f3,0x2ec,0x2ea)+_0x5a18cc(0x2ec,0x345,0x2d8,0x31e)+'ew-contain'+'er\x20.st-cha'+_0x5a18cc(0x244,0x2d6,0x33e,0x2f2)+'placeholde'+'r'),_0x29d8ee=_0x31145a[_0x468ed3(-0xbe,-0x7f,-0xfb,-0x68)+_0x5a18cc(0x3a4,0x348,0x2f0,0x300)](_0x468ed3(0x4f,-0x2a,-0x59,-0x1a)+_0x5a18cc(0x33a,0x2c5,0x2f2,0x2f3)+_0x5a18cc(0x254,0x29c,0x31b,0x276));_0x3fedea[_0x468ed3(-0x2e,-0x2d,0x49,0x2c)]&&_0x3fedea[_0x5a18cc(0x3e5,0x358,0x363,0x2fa)]['startsWith'](_0x38fe2b[_0x5a18cc(0x37d,0x332,0x2b1,0x2c5)])&&_0x3fedea[_0x468ed3(-0xaa,-0x2d,0x14,0x29)]!==_0x4ffe80&&_0x4936d4[_0x468ed3(-0x2f,-0x8a,-0xbe,0x5)+_0x5a18cc(0x27b,0x2b7,0x2e7,0x33e)](_0x3fedea[_0x468ed3(-0x77,-0x2d,-0x6f,-0x8b)]),_0x23cd6d?(_0x3fedea['src']=_0x40e6b1,_0x3fedea[_0x468ed3(-0x6d,-0xca,-0x155,-0x125)]['display']=_0x5a18cc(0x387,0x2f5,0x2e9,0x340),_0x214396[_0x468ed3(-0xef,-0xca,-0x148,-0xdb)][_0x5a18cc(0x357,0x368,0x336,0x381)]=_0x468ed3(-0xdd,-0xa1,-0xe0,-0xb4),_0x29d8ee['style'][_0x5a18cc(0x3dd,0x368,0x310,0x3d2)]=_0x38fe2b[_0x468ed3(-0x104,-0xe7,-0x117,-0x80)]):(_0x3fedea[_0x468ed3(0x4c,-0x2d,-0x7e,-0x81)]='',_0x3fedea[_0x5a18cc(0x2e8,0x2bb,0x30b,0x32a)][_0x5a18cc(0x2f0,0x368,0x333,0x310)]=_0x38fe2b['jEVch'],_0x214396['style']['display']=_0x38fe2b[_0x5a18cc(0x2f8,0x2ea,0x32b,0x367)],_0x29d8ee[_0x468ed3(-0x137,-0xca,-0xa8,-0x51)]['display']=_0x38fe2b['jEVch'],_0x2e9562['comfyuican'+_0x5a18cc(0x385,0x381,0x3d4,0x33b)]=null,_0x55bdd1=null);}else removeNovelaiCharRefImage();}),_0x5f3e4c[_0x17ecd7(0x5f2,0x5b9,0x5e7,0x58a)](_0x38fe2b[_0x17ecd7(0x54c,0x54e,0x4f3,0x577)])['on'](_0x38fe2b[_0x194d5e(0x1ed,0x14e,0x16e,0xf3)],()=>{function _0x4550b1(_0x3a0ead,_0xc3cb95,_0xeeb938,_0x5984d3){return _0x194d5e(_0x3a0ead-0xb9,_0xc3cb95-0x85,_0xc3cb95- -0x178,_0xeeb938);}function _0x26b12a(_0x5208be,_0x78f7b6,_0x10c103,_0x55643b){return _0x17ecd7(_0x5208be-0xf5,_0x78f7b6- -0x97,_0x5208be,_0x55643b-0x110);}_0x38fe2b[_0x26b12a(0x569,0x4dd,0x56c,0x45f)](_0x38fe2b[_0x26b12a(0x451,0x4d3,0x528,0x47a)],_0x38fe2b[_0x26b12a(0x590,0x567,0x54e,0x54c)])?(_0x12444c(null),_0x269dfd[_0x4550b1(-0x41,0x4f,0x48,0x36)+'e'](_0x519a79)):document['getElement'+_0x4550b1(0x29,0xa7,0x93,0x73)](_0x38fe2b[_0x26b12a(0x57a,0x521,0x491,0x4d8)])[_0x26b12a(0x56d,0x4f8,0x484,0x550)]();}),_0x5f3e4c['find'](_0x194d5e(0x1ea,0x1d4,0x237,0x262)+'t2')['on'](_0x38fe2b[_0x17ecd7(0x65c,0x63c,0x692,0x5e9)],handleImageUpload2),_0x5f3e4c['find'](_0x38fe2b[_0x194d5e(0x2c2,0x250,0x28c,0x294)])['on'](_0x38fe2b[_0x194d5e(0x134,0x12a,0x16e,0x16f)],()=>{const _0x5390b3={};_0x5390b3[_0x44a504(-0x22,-0x2a,-0xb9,-0x59)]=_0x38fe2b[_0x1d5ea6(0x208,0x268,0x1be,0x234)];function _0x1d5ea6(_0x844077,_0x5d9509,_0x39fce4,_0x571a99){return _0x17ecd7(_0x844077-0x133,_0x844077- -0x410,_0x5d9509,_0x571a99-0x1e9);}function _0x44a504(_0x500dea,_0x55180e,_0x3f82fd,_0x527238){return _0x194d5e(_0x500dea-0x117,_0x55180e-0x5e,_0x55180e- -0x1b9,_0x3f82fd);}const _0x1c37f4=_0x5390b3;if(_0x38fe2b['DWMaC']===_0x1d5ea6(0x223,0x1bd,0x258,0x25f))return _0x154c08[_0x44a504(-0xb8,-0x28,-0x68,0x6)]()['search'](MHaknr[_0x1d5ea6(0x13a,0xbd,0xf4,0x1a5)])[_0x44a504(0x29,-0x28,0x21,-0x7a)]()['constructo'+'r'](_0x5120e9)[_0x44a504(0x101,0x87,-0x5,0x95)](MHaknr['ZhEUq']);else removeComfyUIImage();});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};