(function(_0x20d630,_0x19f296){function _0x303010(_0x1de5dd,_0x385c93,_0x2cbca1,_0x136028){return _0x7e6f(_0x136028-0x214,_0x1de5dd);}const _0x2644b6=_0x20d630();function _0x1d9d0c(_0x4ba91d,_0x17c290,_0x2f3546,_0x4270c0){return _0x7e6f(_0x17c290-0xd2,_0x2f3546);}while(!![]){try{const _0x40b7b2=-parseInt(_0x1d9d0c(0x256,0x258,0x227,0x2dc))/(-0x1a11+-0x1061+-0x2a73*-0x1)+-parseInt(_0x1d9d0c(0x31f,0x31c,0x36b,0x2f8))/(-0x409*-0x8+-0x1*-0x8c4+0x67*-0x66)*(parseInt(_0x1d9d0c(0x29d,0x271,0x1ee,0x26c))/(-0x111+-0x1715+0x1829))+-parseInt(_0x1d9d0c(0x281,0x303,0x315,0x29d))/(0x1*0x87d+-0x1*0x22ed+-0xd3a*-0x2)+parseInt(_0x303010(0x346,0x349,0x41b,0x390))/(-0x7f*-0x1+0x13b*-0x3+0x1*0x337)*(-parseInt(_0x303010(0x39d,0x3dd,0x47a,0x415))/(0x5e+-0x1690+-0xed*-0x18))+parseInt(_0x303010(0x436,0x416,0x3c2,0x42a))/(-0x9*-0x94+-0x44*0x23+-0x41f*-0x1)*(-parseInt(_0x1d9d0c(0x22d,0x293,0x312,0x290))/(0x1*-0x12e9+0x1ed+0x1104))+parseInt(_0x303010(0x392,0x39b,0x31e,0x371))/(-0xc78+0x452*-0x7+0x2abf)*(-parseInt(_0x1d9d0c(0x2f4,0x27c,0x2ec,0x233))/(0x1185+0x947+-0x1ac2))+parseInt(_0x303010(0x470,0x412,0x400,0x468))/(0x732+-0x24e4+0x1dbd)*(parseInt(_0x303010(0x41b,0x471,0x3a8,0x41f))/(-0x2023+0x3b9*0x9+0xd*-0x1a));if(_0x40b7b2===_0x19f296)break;else _0x2644b6['push'](_0x2644b6['shift']());}catch(_0x5c1189){_0x2644b6['push'](_0x2644b6['shift']());}}}(_0x2c2c,-0x24e6c+0x2*0x1b589+0x65bad));const _0x2a1537=(function(){const _0x432820={};_0x432820['gzzjJ']='Error\x20load'+_0xefeda7(0xf8,0x11d,0x12c,0xc8)+'\x20NovelAI\x20C'+'har\x20Ref\x20im'+'age:',_0x432820[_0x28ca89(0x3e3,0x3aa,0x40a,0x431)]=function(_0x6469ca,_0x4ffb7a){return _0x6469ca===_0x4ffb7a;};function _0x28ca89(_0x1c9156,_0x7c5113,_0x2647de,_0x323020){return _0x7e6f(_0x2647de-0x251,_0x1c9156);}function _0xefeda7(_0x330d5d,_0x3cb465,_0x49403b,_0x1922a1){return _0x7e6f(_0x330d5d- -0xb3,_0x1922a1);}_0x432820[_0x28ca89(0x483,0x450,0x469,0x4f4)]=_0xefeda7(0xac,0x92,0xf4,0x11a),_0x432820[_0xefeda7(0x172,0x120,0x1d7,0x1dc)]=_0x28ca89(0x45a,0x3cd,0x450,0x41d),_0x432820[_0x28ca89(0x3ff,0x395,0x3b7,0x348)]='hZzIi';const _0x586fb5=_0x432820;let _0x3e67a9=!![];return function(_0x49cc4e,_0x46fc06){const _0x1895fc={'njcLd':_0x586fb5[_0x4314cc(-0x13c,-0x1d0,-0x199,-0x12e)],'uPLPC':function(_0x34c420,_0x2a6949){function _0x253596(_0x5754dd,_0x12b1c7,_0x67d334,_0x4228bd){return _0x4314cc(_0x67d334,_0x12b1c7-0xf2,_0x5754dd-0x514,_0x4228bd-0x93);}return _0x586fb5[_0x253596(0x382,0x34f,0x40f,0x37c)](_0x34c420,_0x2a6949);},'RZjcn':_0x586fb5['NJONt'],'voiOz':_0x586fb5['KlKto'],'NkRVA':_0x586fb5[_0x3fa17e(0x2d9,0x2d2,0x2a4,0x2b0)]};function _0x3fa17e(_0x20442c,_0x2b2b9b,_0xaac67c,_0x48883c){return _0x28ca89(_0x2b2b9b,_0x2b2b9b-0xe4,_0x20442c- -0xde,_0x48883c-0xe4);}const _0x191259=_0x3e67a9?function(){function _0x5c618a(_0xf2b6bc,_0x3ad161,_0x4ad550,_0x3fcfa3){return _0x3fa17e(_0x4ad550- -0x14c,_0x3fcfa3,_0x4ad550-0xb7,_0x3fcfa3-0x11d);}function _0x5b63d6(_0x46737d,_0x485794,_0x25e9b4,_0x3fa698){return _0x4314cc(_0x46737d,_0x485794-0xaa,_0x25e9b4-0x168,_0x3fa698-0x3f);}if(_0x1895fc[_0x5b63d6(-0x4c,-0x2,-0x81,-0x42)](_0x1895fc[_0x5b63d6(-0x6c,0x37,-0x3,-0x5)],_0x1895fc[_0x5b63d6(-0x17,-0x52,-0x8a,-0xa2)]))_0x5be23f[_0x5c618a(0x21f,0x1fc,0x1b3,0x163)](_0x1895fc['njcLd'],_0x14f7a5);else{if(_0x46fc06){if(_0x1895fc[_0x5c618a(0x2d7,0x26f,0x28e,0x1fe)]===_0x1895fc[_0x5c618a(0x2f3,0x27f,0x28e,0x2b3)]){const _0x2cacd1=_0x46fc06[_0x5b63d6(0x29,0x68,0x37,0x69)](_0x49cc4e,arguments);return _0x46fc06=null,_0x2cacd1;}else{const _0x2e51a9=_0x59d0c1[_0x5c618a(0x20e,0x22b,0x241,0x2ab)](_0x237152,arguments);return _0x36eb57=null,_0x2e51a9;}}}}:function(){};_0x3e67a9=![];function _0x4314cc(_0x2d7f29,_0x373e95,_0x43c540,_0x507ba2){return _0xefeda7(_0x43c540- -0x298,_0x373e95-0xca,_0x43c540-0x1ca,_0x2d7f29);}return _0x191259;};}()),_0x24a561=_0x2a1537(this,function(){function _0x418469(_0x11d820,_0x3f00c4,_0x31af69,_0x4c5610){return _0x7e6f(_0x31af69-0x307,_0x4c5610);}const _0x24c7ce={};function _0x119774(_0x5c3613,_0x38aeac,_0x308825,_0xd13664){return _0x7e6f(_0x308825- -0x1b,_0x5c3613);}_0x24c7ce[_0x119774(0x2b3,0x27c,0x250,0x22c)]=_0x119774(0x123,0x13e,0x1af,0x1d2)+'+$';const _0x3223cd=_0x24c7ce;return _0x24a561[_0x418469(0x3fb,0x46d,0x47c,0x4b8)]()['search'](_0x3223cd[_0x119774(0x28e,0x21e,0x250,0x226)])[_0x119774(0x14f,0x15f,0x15a,0x162)]()[_0x418469(0x494,0x53e,0x4f8,0x4bb)+'r'](_0x24a561)[_0x119774(0x1de,0x183,0x1b2,0x128)](_0x3223cd[_0x418469(0x583,0x584,0x572,0x5fa)]);});_0x24a561();function _0x2c2c(){const _0x47beef=['zwXLy3qTy2HHCG','ndi5BhD2vLLV','tgTbEuS','zxnZAw5Nie5VDG','vvjm','lwj0BG','ywDLlxbYzxzPzq','BgXQt3K','x25HAv9JAgfYxW','AgfYlxjLzI1PBq','sxzbuKy','CvfWtKi','mtbMuxnLzfe','Aw5NignHy2HLza','B05wt2m','Dxbeyvy','EvjHtLi','zgLZCgXHEq','CgXHy2vOB2XKzq','wgTdC3O','z3P6AKO','zffowxy','Aw1Hz2u','yMXVyG','ignHy2HLihrVia','rLn1t0K','C3rVCMvezwXLDa','r1H1rK0','6k+M5OofoIa','Aw5SAw5LlwzSzq','tMfTzq','sMLZChC','zxCTy29UDgfPBG','swXNzee','B3bLBKrc','ofLLwfHNtq','D2fYBG','BLnjCgS','ten2we8','yw5ZzMvYsw1HzW','y29TzNL1AwnHBG','qMnXs3C','Axb4CuG','yNrU','kcGOlISPkYKRkq','i25VDMvSywKTyW','Bw92zs1JAgfYlq','C2vHCMnO','Dgf3Eum','uwrQDe8','zw1VDMuTAw1HzW','twfMtwu','v2Pwzfy','6k+35ywi6k6+572Uq29TzNLv','5zMO6l+u5zUE5PwW5O2UoIa','DMDPqKm','BM92zwXHAs1Yzq','svPJweG','y2fJAgvFBM92zq','zxPtwMO','zNjYANy','tNDVsum','shngy24','v0LAAfm','y2XPy2S','wvHRALO','uLPQy24','vNHOzKG','z2vOufi','CND5AxG','t0PjyNG','Dg9Y','C3rHCNrZv2L0Aa','v2vKyKO','z2v0rwXLBwvUDa','zgf0yq','AwXbDMO','CvP5z1q','BwfNzs1WCMv2Aq','sNvRqwu','ChjLDMLLD0LTyq','C3rYAw5NAwz5','y3nluhG','y29UC3rYDwn0BW','zw1VDMuTy2HHCG','BxnZwNu','sNDkBee','zhbdsha','Aw1Hz2vjBNb1Da','wxLiAe0','ywDL','ihjLlxvWBg9Hza','Bg9N','wKvAv0S','B1rJuhy','ExvPx3jLzL9PBq','AgfYifjLzIbPBq','qLHzBfq','y2fJAguGzM9YBq','mZC1nLfzsLvprG','vLzmvNq','sufSBxq','tLvNrhC','CM1HDc4','ruXQDhG','CxvLCNLtzwXLyW','zwXbssbPBwfNzq','CvDrzMW','rvj2EM0','mJqXmtK0odrHu3j0wNy','z1HUqLO','zMXLEa','wvjvALG','yxbWzw5K','ywDLoG','x25VDMvSywK','C3bSAxq','BMfPm1zPyMvuCG','tg9HzgvKienVBq','DY1JB250ywLUzq','mZu0nJqXDKPYB2He','C2vYDMvYrMLSzq','tKPptNq','zLnnvwy','yxbWBhK','B2zSzfe','i2nVBwz5DwKTCG','rLrhzee','DgfYz2v0','z2uY','CMfUC2zLCL9PBq','tw1pvgy','y3jLyxrLt2jQzq','5lIk5lYG5AsX6lsLoIa','CIaUC3qTy2HHDa','s2XlDg8','zMLUza','ExjpuKS','C2zqqMO','uvjpC0q','Eu5iswq','vKPrEe0','A1D0v2W','C3rVCMvszwfKtW','CwTws3i','6zsz6k+V6k+M5OofoG','C3r5Bgu','nJm0nJrnuwjXBuO','igzYB20GB2XKia','txvNru4','tu1lwKS','uuTLzhq','twDNCey','C0n6tNe','Dhu4lwLTywDLlq','x3jLzG','DNvlA2C','zKLTywDL','wgPkyxq','zNLvssbPBwfNzq','wNjzyLe','weflANG','BuPWCwO','y3rvuKW','qNLjza','vgLyD3i','vLvxvuu','DeTAsuS','qwXUwKW','C3jJ','DhjPBq','v3bSqKi','mte5mtjMqvDXtw8','tgnxCLu','tKn3v3C','AKn4EKu','z2vFBM92zwXHAq','q1PYy04','5zU+54Mh5Ase55cg5AsX6lsLoIa','Df9UywLFy2HHCG','DgHLig5LDYbMBW','AM1IC0m','mtfHtfvyr2e','lxjLzI1PBwfNzq','i25VDMvSywKTCG','wLzfrem','B3jYBva','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','zgfZrfy','Bw92zs1PBwfNzq','thDOvge','BLD2BwS','zwXbssbJAgfYia','i2LTywDLsw5WDq','ie5VDMvSquKGqW','zxiGlNn0lwnOyq','yMXVy2S','zu12Aum','B29eChe','wfHwwfy','5zUE5PwW5O2UoG','tMTsvKe','igzYB20Gy2fJAa','Aw1Hz2uVCg5N','vuNLM77NIyC6ia','ELLdCfi','wKrzA20','Be5ryMW','CgXvANq','sNLms2O','Df9UB3zLBgfP','zs1IDg4','i25VDMvSywKTCW','u3rqrg8','z2vFBMfPx2nOyq','CwPbwgS','EvfOD1e','AgP1rMO','DM9Pt3O','zLbYtgO','CMvMlwLTywDLlq','zMLSzxm','mta2ndK3wNv1ueHA','CMv2B2TLt2jQzq','wMnoqLO','zgf0ytPPBwfNzq','rxjYB3iGBg9Hza','Dvbmuem','BM9Uzq','rhnQDKO','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','CerZvMW','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','wfvABgu','BMX5','twvYy0u','y29TzNL1AvvYBa','5lUo57Yt5A2y5yQG6l29q29TzNK','yxjSwvy','yvjyAui','CeLNyvm','B25SB2fKzw5K','vLHpt0e','ssbbueNLNldLNydJGii','C3rVCMvszwfKvW','BgfPx2nOyxjFCG','Dg9tDhjPBMC','ztOG','Dgv4Da','BMfPm0nOyxjszq','mhWYFdf8m3W0','CMvM','tg5xz0W','nJu1zgvNC1Dj','BwfNztO','tfjtCLq','EefWCuu','sLPUrvq','AejiqNC','zgPsuuK','y2HHBMDL','CMvZDwX0','wLHLuhi','nta4mZi2uhvrtLPv','qNzbBwS','uvf6txK','DgjUsu0','yMXVyJO','l3vWBg9Hzc9PBq','zxjYB3i','CMvMigLTywDLoG','y1f3ANm','BwvZC2fNzq','yMHvuM4','BgfJzwHVBgrLCG','Aff1CKO','ANnVBG','s1LMzxG','i2nVBwz5DwKTAq','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','A2fVDhvWAwfU','vhntyNu','ie5VDMvSquKGvG','CML0zq','BMfTzq','CL9Yzwy','y29TzNL1As1Yzq'];_0x2c2c=function(){return _0x47beef;};return _0x2c2c();}import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY='cache_nove'+'lai_vibe_t'+_0x6a94f3(0x598,0x53b,0x5cf,0x5a9)+_0x13d461(0x147,0x52,0xb6,0xd3),NAI_CHAR_REF_CACHE_KEY=_0x6a94f3(0x550,0x4e1,0x56f,0x4ce)+_0x13d461(0xa1,0x2c,0xcb,0x4f)+'ef_image',COMFYUI_REF_CACHE_KEY='cache_comf'+_0x13d461(0xe7,0x145,0xbb,0xd8)+_0x13d461(0xdb,0x73,0xdf,0xd3);let nai3VibeTransferImageMimeType=_0x6a94f3(0x5e1,0x5a3,0x5f2,0x5d9);function _0x13d461(_0x5204d7,_0x32ed36,_0x1686e9,_0xa5a4c){return _0x7e6f(_0xa5a4c- -0x125,_0x32ed36);}let nai3CharRefImageMimeType='image/png',comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x3b816d){const _0x477424={};_0x477424[_0x1762be(0x38c,0x37d,0x33d,0x2d9)]=_0x31d14b(0x4d6,0x521,0x510,0x4ee)+_0x1762be(0x3ae,0x34e,0x382,0x39d),_0x477424['MmOTf']=_0x1762be(0x2ac,0x34b,0x30a,0x2f9)+_0x31d14b(0x5e0,0x58e,0x545,0x54c)+_0x1762be(0x29b,0x322,0x2d7,0x2ae),_0x477424[_0x31d14b(0x584,0x535,0x501,0x552)]='data:image';function _0x1762be(_0x5d6621,_0x5b7dbf,_0x120c79,_0x50922a){return _0x13d461(_0x5d6621-0x1c7,_0x5d6621,_0x120c79-0x5c,_0x120c79-0x259);}_0x477424[_0x31d14b(0x4b8,0x4f6,0x4ac,0x4f5)]=_0x31d14b(0x41f,0x496,0x45d,0x461),_0x477424[_0x31d14b(0x5b0,0x57f,0x547,0x5e0)]=_0x1762be(0x283,0x309,0x2ef,0x363)+'x',_0x477424[_0x31d14b(0x4f6,0x52e,0x5a6,0x4f3)]=_0x1762be(0x303,0x2f7,0x341,0x38c);const _0x4b48f9=_0x477424,_0x4cd3ce=document[_0x31d14b(0x505,0x51b,0x508,0x4ee)+'ById'](_0x4b48f9[_0x31d14b(0x52e,0x53c,0x4ec,0x500)]),_0xe75029=document['querySelec'+'tor']('#novelai-i'+_0x31d14b(0x4db,0x51f,0x4e5,0x4af)+'ew-contain'+'er\x20.st-cha'+'tu8-image-'+'placeholde'+'r'),_0x372027=document['getElement'+_0x31d14b(0x525,0x575,0x571,0x5b4)](_0x4b48f9[_0x31d14b(0x51f,0x554,0x565,0x585)]);function _0x31d14b(_0x4c5b2f,_0x254fa0,_0x19af44,_0x2e3fcf){return _0x13d461(_0x4c5b2f-0x188,_0x4c5b2f,_0x19af44-0x67,_0x254fa0-0x458);}if(_0x3b816d&&_0x3b816d['startsWith'](_0x4b48f9[_0x1762be(0x37d,0x2eb,0x336,0x2ef)])){_0x4cd3ce['src']=_0x3b816d,_0x4cd3ce[_0x1762be(0x32d,0x2dc,0x364,0x367)][_0x1762be(0x331,0x269,0x2e3,0x2ea)]=_0x1762be(0x344,0x346,0x396,0x3c9),_0xe75029['style']['display']=_0x4b48f9['nSIpk'],_0x372027[_0x1762be(0x30a,0x3cd,0x364,0x35e)]['display']=_0x4b48f9[_0x1762be(0x38b,0x40a,0x380,0x39d)];const _0x36a50f=_0x3b816d[_0x1762be(0x2bf,0x389,0x346,0x2f4)](','),_0x3fbc76=_0x36a50f[-0xf78+-0x222b+0x31a3]['split'](':')[-0x1441+-0x793*-0x2+0x51c]['split'](';')[0x2500+-0x8ba+0x4d*-0x5e];nai3VibeTransferImageMimeType=_0x3fbc76,window['nai3VibeTr'+_0x31d14b(0x4a8,0x4f8,0x4c7,0x4f1)+'e']=_0x36a50f[-0x255f*0x1+0x150*0x9+0x1*0x1990];const _0x810761={};_0x810761['id']=NAI_VIBE_CACHE_KEY,_0x810761['data']=_0x3b816d,dbs[_0x31d14b(0x45e,0x4a6,0x506,0x48a)+_0x1762be(0x2e3,0x34b,0x2ce,0x256)](_0x810761);}else _0x4cd3ce[_0x1762be(0x3fd,0x36a,0x37b,0x3d8)]='',_0x4cd3ce['style'][_0x31d14b(0x478,0x4e2,0x47a,0x4c1)]=_0x4b48f9['nSIpk'],_0xe75029[_0x1762be(0x344,0x390,0x364,0x3a8)][_0x1762be(0x26d,0x353,0x2e3,0x25a)]=_0x4b48f9[_0x31d14b(0x4cc,0x52e,0x59a,0x513)],_0x372027[_0x1762be(0x3b4,0x34a,0x364,0x3b3)]['display']=_0x4b48f9[_0x1762be(0x31d,0x312,0x2f7,0x344)],window[_0x1762be(0x372,0x302,0x347,0x3ab)+'ansferImag'+'e']=null;}function removeNovelaiImage(){const _0x477a7e={'QROsD':function(_0x53dd75,_0x4eb15e){return _0x53dd75(_0x4eb15e);}};_0x477a7e[_0x1e6c4a(0x4b5,0x443,0x414,0x479)](updateNovelaiImagePreview,null);function _0x1e6c4a(_0x227417,_0xf01dda,_0x52e9b3,_0x1d60f9){return _0x13d461(_0x227417-0x127,_0x227417,_0x52e9b3-0x36,_0x1d60f9-0x375);}dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x4467c2){function _0xba813b(_0x4bfd20,_0x125eeb,_0x570883,_0x2719fb){return _0x13d461(_0x4bfd20-0x17a,_0x2719fb,_0x570883-0xdc,_0x4bfd20- -0x280);}const _0x2b484e={'VxhfH':function(_0x363879,_0x4e31ef){return _0x363879(_0x4e31ef);},'MafMe':function(_0x1717c2){return _0x1717c2();},'NUgDw':function(_0x49532b,_0x166524,_0x163c53){return _0x49532b(_0x166524,_0x163c53);},'GBQIn':function(_0x24ae91,_0x1683fb){return _0x24ae91===_0x1683fb;},'xApqE':_0xba813b(-0x223,-0x1a7,-0x2a6,-0x211),'BCiDZ':'Error\x20proc'+_0xba813b(-0x204,-0x216,-0x1c4,-0x186)+_0x587847(0x564,0x517,0x4f6,0x512)+':','keeki':function(_0x55feb3,_0x3eff67){return _0x55feb3+_0x3eff67;},'ZrYbQ':_0xba813b(-0x155,-0x157,-0x1c8,-0xde)},_0x416a18=_0x4467c2[_0x587847(0x564,0x566,0x581,0x528)][_0x587847(0x4dc,0x3eb,0x442,0x466)][0x1*0x175f+-0x590+0x11cf*-0x1];function _0x587847(_0x1aae41,_0x41d6f0,_0x1a57d9,_0x5b8856){return _0x6a94f3(_0x5b8856- -0x6e,_0x41d6f0-0x1a3,_0x41d6f0,_0x5b8856-0xe);}if(!_0x416a18)return;try{const _0x4a90f5=await _0x2b484e[_0x587847(0x544,0x54e,0x55c,0x50e)](processUploadedImage,_0x416a18,!![]);updateNovelaiImagePreview(_0x4a90f5);}catch(_0x10e2e4){if(_0x2b484e['GBQIn'](_0x2b484e[_0xba813b(-0x226,-0x217,-0x249,-0x1cd)],_0x2b484e['xApqE']))console[_0x587847(0x4f4,0x443,0x468,0x496)](_0x2b484e['BCiDZ'],_0x10e2e4),_0x2b484e[_0xba813b(-0x1c4,-0x1b4,-0x1e2,-0x13d)](alert,_0x2b484e['keeki'](_0x2b484e[_0x587847(0x539,0x589,0x503,0x548)],_0x10e2e4['message']));else{_0x2b484e[_0x587847(0x492,0x4b4,0x538,0x4eb)](_0x3f4bf9,_0xba813b(-0x1d2,-0x174,-0x204,-0x14a)+_0x587847(0x4c6,0x493,0x460,0x47c)),_0x2b484e[_0xba813b(-0x1d4,-0x1a4,-0x1e7,-0x15f)](_0x410108);return;}}}function updateNovelaiCharRefImagePreview(_0x2145c0){const _0x5002aa={'VXOOA':'Error\x20proc'+_0x30fe28(0xa1,0xfb,0xca,0x150)+_0x30fe28(0x182,0x1b8,0x1da,0x18a)+_0x4e6768(-0x76,0x14,-0x72,-0xc5),'VJQxM':function(_0x4188ea,_0x5764c2){return _0x4188ea(_0x5764c2);},'ELjtx':_0x4e6768(0x18,-0x5c,-0x34,-0x5f)+'har-ref-im'+_0x4e6768(-0xf,-0xe1,-0x5b,-0xac)+_0x30fe28(0x182,0x16f,0x1a8,0x1e7)+'r\x20.st-chat'+'u8-image-p'+_0x4e6768(-0x64,-0xc0,-0x6e,0x15),'fSMUf':_0x30fe28(0xe8,0x130,0x1a3,0x118)+_0x4e6768(-0x13,-0x27,-0x33,-0x74)+_0x4e6768(-0x44,-0x8c,-0xa4,-0x100)+_0x4e6768(0x3d,0x56,-0x36,0x4e),'ZDYkm':_0x30fe28(0x76,0xba,0x7a,0x124),'ilAvj':function(_0x5c48e4,_0x2b7a3b){return _0x5c48e4===_0x2b7a3b;},'gXnBZ':_0x4e6768(0x8,0xa,0x1e,0x54),'WedbJ':_0x4e6768(-0xe2,-0xc1,-0x53,-0x90),'ExBoV':_0x4e6768(0xbf,0x89,0x63,0x67),'vuKkg':_0x30fe28(0x5e,0xbd,0x133,0xf1),'nNDXB':_0x4e6768(-0x81,-0x73,-0x86,-0x52),'OeBCG':_0x30fe28(0x1e0,0x167,0x17e,0x10a)};function _0x4e6768(_0x330095,_0x3f41de,_0x15652a,_0x1a76ca){return _0x6a94f3(_0x15652a- -0x577,_0x3f41de-0xf9,_0x3f41de,_0x1a76ca-0x7);}const _0x346735=document[_0x30fe28(0x152,0x142,0xea,0xc6)+_0x4e6768(0x33,0x3a,0x43,0x44)](_0x4e6768(-0x94,-0x64,-0x11,-0x9b)+_0x4e6768(0x56,0x85,0x75,0xd4)+_0x4e6768(-0x81,-0x1e,-0x63,0x1e)),_0x4cb396=document[_0x30fe28(0x163,0x161,0x11a,0x184)+'tor'](_0x5002aa[_0x30fe28(0xf4,0x160,0xd4,0x1e0)]),_0x1d170e=document['getElement'+_0x4e6768(0x97,-0x42,0x43,0x7d)](_0x5002aa[_0x30fe28(0x1e5,0x173,0xe8,0x1af)]);function _0x30fe28(_0x4ebccc,_0x140338,_0x2a1709,_0x1959da){return _0x6a94f3(_0x140338- -0x41e,_0x140338-0x1b7,_0x4ebccc,_0x1959da-0xe5);}if(_0x2145c0&&_0x2145c0['startsWith'](_0x5002aa[_0x4e6768(0x69,0x87,0x6d,0x7e)])){if(_0x5002aa[_0x4e6768(-0x1a,-0x8f,-0x15,-0x9b)](_0x5002aa[_0x4e6768(-0xc,0x9a,0xd,0x47)],_0x5002aa[_0x30fe28(0xe3,0x141,0xc0,0x1c4)]))_0x5e5bc1[_0x30fe28(0x94,0xe6,0x69,0x86)](_0x5002aa[_0x30fe28(0x49,0xcb,0x9c,0xb8)],_0xcd9d39),_0x5002aa[_0x4e6768(0xa7,0x9d,0x2c,0x53)](_0x15e5e2,'图片处理失败:\x20'+_0x1436bd[_0x30fe28(0x128,0xe9,0x162,0x149)]);else{_0x346735['src']=_0x2145c0,_0x346735[_0x4e6768(-0x56,-0x13,0x31,0x74)][_0x30fe28(0xfe,0x109,0xcc,0xb4)]=_0x5002aa['ExBoV'],_0x4cb396[_0x4e6768(-0x23,-0x4f,0x31,-0x25)][_0x4e6768(0xa,-0xb1,-0x50,-0x7c)]=_0x5002aa[_0x4e6768(0xa5,0x2d,0x3b,-0x41)],_0x1d170e['style'][_0x4e6768(-0x6b,-0xcd,-0x50,-0x6e)]=_0x4e6768(0x1d,-0x7e,-0x44,0x43)+'x';const _0x1a253c=_0x2145c0[_0x30fe28(0x145,0x16c,0x149,0x1fc)](','),_0x1d60fa=_0x1a253c[-0x1c2b*0x1+-0xb6*0x26+0x372f][_0x30fe28(0xee,0x16c,0x156,0xef)](':')[0xd18+-0x25b2+0x189b][_0x30fe28(0xf4,0x16c,0x1a4,0x1ad)](';')[0x11c0+0x12*-0x20d+0x132a];nai3CharRefImageMimeType=_0x1d60fa,window[_0x4e6768(-0xfc,-0xd9,-0x87,-0xbd)+_0x30fe28(0x148,0x195,0x14a,0x150)]=_0x1a253c[0x1*0xbd1+-0xcf9+0x129];const _0x64f5f4={};_0x64f5f4['id']=NAI_CHAR_REF_CACHE_KEY,_0x64f5f4[_0x30fe28(0x175,0x143,0x102,0x145)]=_0x2145c0,dbs[_0x30fe28(0x121,0xcd,0x129,0xff)+_0x4e6768(-0x9f,-0xbb,-0x65,-0x30)](_0x64f5f4);}}else{const _0x3ee541=_0x5002aa['nNDXB'][_0x4e6768(-0x73,0x27,0x13,0x8f)]('|');let _0x58ac8c=-0x16*0x7f+0x1127*0x1+-0x63d;while(!![]){switch(_0x3ee541[_0x58ac8c++]){case'0':_0x346735[_0x30fe28(0x197,0x1a1,0x1b6,0x151)]='';continue;case'1':_0x4cb396[_0x4e6768(0x1d,-0x21,0x31,0xa9)][_0x30fe28(0xbf,0x109,0xa9,0x149)]=_0x5002aa['OeBCG'];continue;case'2':_0x346735[_0x4e6768(0x4d,-0x51,0x31,-0x7)][_0x30fe28(0x189,0x109,0x10e,0xb2)]=_0x5002aa['vuKkg'];continue;case'3':_0x1d170e[_0x30fe28(0x11f,0x18a,0x10c,0x1c8)]['display']=_0x5002aa['vuKkg'];continue;case'4':window['nai3CharRe'+_0x30fe28(0x133,0x195,0x1db,0x11b)]=null;continue;}break;}}}function _0x7e6f(_0x2c6679,_0x4da523){_0x2c6679=_0x2c6679-(-0x1248+0x673+0xd2e);const _0x27b772=_0x2c2c();let _0x302ca4=_0x27b772[_0x2c6679];if(_0x7e6f['dbHrsD']===undefined){var _0x658960=function(_0x319405){const _0xf9e575='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x390c95='',_0x3b90b9='',_0x249625=_0x390c95+_0x658960;for(let _0x1097b6=-0x2e1+-0x5*0x685+0x237a,_0x339193,_0xba910f,_0x35793c=0xbf5+-0x1ed2+0x12dd;_0xba910f=_0x319405['charAt'](_0x35793c++);~_0xba910f&&(_0x339193=_0x1097b6%(-0x8*-0x247+-0x8d2+-0x4b1*0x2)?_0x339193*(-0x1*-0xcbb+-0x5e+0xc1d*-0x1)+_0xba910f:_0xba910f,_0x1097b6++%(0x4c+0x5b5+-0x5fd))?_0x390c95+=_0x249625['charCodeAt'](_0x35793c+(-0x6a6*-0x3+0x1de*0xf+-0x2fea))-(-0x38*0x92+0x15be+0xa3c)!==-0xf5c+0x1142*0x2+-0x2*0x994?String['fromCharCode'](0x2*0x1015+-0xabd*0x3+0x10c&_0x339193>>(-(-0x2*0x10e2+0x1354*-0x2+0x486e)*_0x1097b6&0x1782+-0x65a+-0x5b6*0x3)):_0x1097b6:0x20e0+-0x17a6+-0x1*0x93a){_0xba910f=_0xf9e575['indexOf'](_0xba910f);}for(let _0xb41db=0x1*-0x16ca+0x3e2*0x5+0x360*0x1,_0x38ae1c=_0x390c95['length'];_0xb41db<_0x38ae1c;_0xb41db++){_0x3b90b9+='%'+('00'+_0x390c95['charCodeAt'](_0xb41db)['toString'](0x7ef+0x10db+0x2*-0xc5d))['slice'](-(-0x22d*-0x9+0x267c+-0xa7*0x59));}return decodeURIComponent(_0x3b90b9);};_0x7e6f['SHDYrP']=_0x658960,_0x7e6f['LSXAiC']={},_0x7e6f['dbHrsD']=!![];}const _0x554dc3=_0x27b772[-0x3*0xa7+-0x10db*-0x2+-0x1fc1],_0x453a73=_0x2c6679+_0x554dc3,_0x220e03=_0x7e6f['LSXAiC'][_0x453a73];if(!_0x220e03){const _0x515742=function(_0x3073c0){this['oUlgin']=_0x3073c0,this['OSJwDt']=[-0x1*0x5a7+-0x27*-0x3b+-0x355,-0x1*-0xed+-0x4f*-0xc+-0x4a1,-0x346+0x125a+-0xf14],this['NLCDrn']=function(){return'newState';},this['NYNrxo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['PHFMly']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x515742['prototype']['Birnwl']=function(){const _0x313b6e=new RegExp(this['NYNrxo']+this['PHFMly']),_0x881003=_0x313b6e['test'](this['NLCDrn']['toString']())?--this['OSJwDt'][0x16aa+-0x2387+0xcde]:--this['OSJwDt'][0x116*0x7+0x15dc*-0x1+0x5*0x2da];return this['ArDDCN'](_0x881003);},_0x515742['prototype']['ArDDCN']=function(_0x27f71c){if(!Boolean(~_0x27f71c))return _0x27f71c;return this['BrNhmS'](this['oUlgin']);},_0x515742['prototype']['BrNhmS']=function(_0x214963){for(let _0x470d3f=0x1a00+0x13ff+-0x19*0x1d7,_0xaf0e0a=this['OSJwDt']['length'];_0x470d3f<_0xaf0e0a;_0x470d3f++){this['OSJwDt']['push'](Math['round'](Math['random']())),_0xaf0e0a=this['OSJwDt']['length'];}return _0x214963(this['OSJwDt'][0x14ad+-0x1fef+-0x106*-0xb]);},new _0x515742(_0x7e6f)['Birnwl'](),_0x302ca4=_0x7e6f['SHDYrP'](_0x302ca4),_0x7e6f['LSXAiC'][_0x453a73]=_0x302ca4;}else _0x302ca4=_0x220e03;return _0x302ca4;}function removeNovelaiCharRefImage(){const _0x481c8a={'arlYV':function(_0x10907e,_0x17b250){return _0x10907e(_0x17b250);}};_0x481c8a[_0x3aff13(0x39b,0x3da,0x40d,0x437)](updateNovelaiCharRefImagePreview,null);function _0x3aff13(_0x473b5b,_0x1b103c,_0x1490b0,_0x11f890){return _0x13d461(_0x473b5b-0x1da,_0x11f890,_0x1490b0-0x175,_0x1490b0-0x3c5);}function _0x286685(_0x372f9e,_0x1997da,_0x1bc02d,_0x1f5009){return _0x6a94f3(_0x1bc02d- -0x40f,_0x1997da-0x2f,_0x1f5009,_0x1f5009-0x17c);}dbs[_0x286685(0x17b,0xea,0x121,0x18a)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x3a1bf6){const _0x663cb5={'cQwjs':_0x33aca8(0x5d,0x27,0x7d,-0x8)+'ge_nai_cha'+_0x33aca8(0xb,-0x60,0x2f,-0x71),'nWvmk':_0x5378bf(0x644,0x664,0x627,0x5b8),'ZXePr':_0x5378bf(0x545,0x4ea,0x560,0x5c7),'XAKjx':_0x33aca8(0x2a,-0x5c,-0x59,-0x7)+'x','PmtCY':'4|1|2|3|0','lljOy':function(_0x3bc18e,_0x3161ee){return _0x3bc18e===_0x3161ee;},'yRaNR':_0x33aca8(0xd3,0xd4,0x123,0xb1),'JwJlA':'UOhaj','dUuBC':function(_0x1a8b5f,_0x1b5584){return _0x1a8b5f(_0x1b5584);},'ERvzm':function(_0xa17e18,_0x1e6345){return _0xa17e18===_0x1e6345;},'frrjv':_0x5378bf(0x60a,0x5ad,0x683,0x681),'uNvMr':'Error\x20proc'+_0x5378bf(0x583,0x5db,0x524,0x5d2)+'elAI\x20char\x20'+_0x5378bf(0x56f,0x56e,0x533,0x4f5),'xgXRz':function(_0xc01482,_0x1b962f){return _0xc01482(_0x1b962f);},'plUjt':function(_0x214f01,_0x2389ef){return _0x214f01+_0x2389ef;},'bhURn':'图片处理失败:\x20'},_0x32d3e6=_0x3a1bf6['target'][_0x5378bf(0x53e,0x5a5,0x4dd,0x4fa)][0x1b1e+0x1*0xcb9+-0x27d7];function _0x5378bf(_0x4e6149,_0x3b89df,_0x3ee8f7,_0x26118b){return _0x13d461(_0x4e6149-0x90,_0x26118b,_0x3ee8f7-0x10b,_0x4e6149-0x507);}function _0x33aca8(_0x3efaa1,_0x4aee05,_0x11decb,_0x458a47){return _0x6a94f3(_0x3efaa1- -0x509,_0x4aee05-0x1ed,_0x11decb,_0x458a47-0x19a);}if(!_0x32d3e6)return;try{if(_0x663cb5[_0x33aca8(0x14,0x51,0x5e,-0x5c)](_0x663cb5[_0x5378bf(0x590,0x511,0x59f,0x55d)],_0x663cb5[_0x5378bf(0x5d6,0x587,0x5cb,0x611)])){const _0x155d6b=_0x658960['getElement'+_0x33aca8(0xb1,0x22,0x13c,0x32)](_0x663cb5[_0x33aca8(-0x3,0x37,0x26,-0x6e)]),_0x5e6dd9=_0x554dc3['querySelec'+'tor']('#novelai-c'+_0x33aca8(0x16,0x6,-0x5,0x73)+'age-previe'+_0x5378bf(0x5f7,0x648,0x5a7,0x610)+_0x33aca8(0x93,0x110,0xf8,0x11d)+'u8-image-p'+_0x5378bf(0x573,0x540,0x5b1,0x5f3)),_0xb4d103=_0x453a73[_0x33aca8(0x57,-0x8,0x0,0x1)+'ById'](_0x33aca8(0x45,0xa2,0xcd,0x33)+_0x5378bf(0x5ae,0x5fe,0x625,0x529)+_0x33aca8(-0x36,0x4f,0x1c,-0x5e)+_0x5378bf(0x5ab,0x61e,0x5fc,0x524));if(_0x220e03&&_0x319405[_0x33aca8(0x55,0xcb,0x65,0x3d)](_0x5378bf(0x542,0x51d,0x5cf,0x59c))){_0x155d6b[_0x33aca8(0xb6,0x7f,0xc7,0x65)]=_0xb41db,_0x155d6b[_0x5378bf(0x612,0x68a,0x5b1,0x64b)][_0x5378bf(0x591,0x606,0x53a,0x53c)]=_0x663cb5[_0x33aca8(0xcc,0xe4,0x155,0xd3)],_0x5e6dd9[_0x5378bf(0x612,0x657,0x625,0x5dc)][_0x5378bf(0x591,0x544,0x55a,0x5db)]=_0x663cb5[_0x5378bf(0x567,0x53f,0x55a,0x4ef)],_0xb4d103['style'][_0x33aca8(0x1e,-0x2b,0x5,0x27)]=_0x663cb5[_0x5378bf(0x621,0x64b,0x5c6,0x62d)];const _0x2d0f2f=_0x38ae1c[_0x5378bf(0x5f4,0x654,0x64b,0x5df)](','),_0x48964b=_0x2d0f2f[-0x1d62*-0x1+0x1*-0x193a+-0x428][_0x5378bf(0x5f4,0x5fc,0x635,0x59b)](':')[-0x1f8a+0x51e*-0x7+0xd79*0x5][_0x33aca8(0x81,0x3d,0x3,0xf6)](';')[0x4f*0x17+0x1e61+-0x171*0x1a];_0x515742=_0x48964b,_0x3073c0[_0x33aca8(-0x19,-0xa2,0x5f,0x5e)+_0x33aca8(0xaa,0xd5,0xdb,0x6b)]=_0x2d0f2f[0xa75*0x1+0x1397+-0x1e0b*0x1];const _0xb189a7={};_0xb189a7['id']=_0x881003,_0xb189a7['data']=_0x27f71c,_0x313b6e[_0x33aca8(-0x1e,-0x9d,-0x1e,0x17)+'rite'](_0xb189a7);}else{const _0x1155af=_0x663cb5['PmtCY'][_0x5378bf(0x5f4,0x672,0x5e6,0x5b0)]('|');let _0x44976d=0x2*-0x11e7+-0x935*-0x1+0x1a99;while(!![]){switch(_0x1155af[_0x44976d++]){case'0':_0x214963[_0x5378bf(0x55a,0x4cb,0x4dd,0x559)+_0x33aca8(0xaa,0x2c,0x7b,0x36)]=null;continue;case'1':_0x155d6b[_0x33aca8(0x9f,0x7d,0xfb,0xe1)]['display']=_0x663cb5['ZXePr'];continue;case'2':_0x5e6dd9[_0x33aca8(0x9f,0x1d,0xd5,0xd6)][_0x33aca8(0x1e,0x68,-0xf,-0x68)]='flex';continue;case'3':_0xb4d103[_0x33aca8(0x9f,0x56,0xd8,0x27)][_0x5378bf(0x591,0x549,0x52a,0x517)]=_0x663cb5[_0x5378bf(0x567,0x559,0x588,0x541)];continue;case'4':_0x155d6b[_0x33aca8(0xb6,0x9c,0xbe,0x92)]='';continue;}break;}}}else{const _0x81445d=await _0x663cb5['dUuBC'](processUploadedImage,_0x32d3e6);_0x663cb5['dUuBC'](updateNovelaiCharRefImagePreview,_0x81445d);}}catch(_0x41c6e7){_0x663cb5[_0x5378bf(0x5ec,0x564,0x583,0x655)](_0x663cb5[_0x5378bf(0x5bc,0x5d1,0x59b,0x57d)],_0x663cb5['frrjv'])?(console[_0x5378bf(0x56e,0x558,0x555,0x592)](_0x663cb5['uNvMr'],_0x41c6e7),_0x663cb5['xgXRz'](alert,_0x663cb5[_0x5378bf(0x650,0x685,0x6c0,0x6c3)](_0x663cb5[_0x5378bf(0x572,0x540,0x4fd,0x59f)],_0x41c6e7[_0x5378bf(0x571,0x4ea,0x5e5,0x590)]))):(_0x3b151c['src']=_0x3ed1b3,_0x228ee1[_0x33aca8(0x9f,0xa4,0xa1,0x110)]['display']=_0x663cb5[_0x5378bf(0x63f,0x61a,0x64c,0x5b0)],_0x2e9460['style']['display']=_0x663cb5[_0x33aca8(-0xc,0x3a,0xd,-0x17)],_0x478177['style'][_0x33aca8(0x1e,0x5,-0x67,0x4f)]=_0x663cb5[_0x33aca8(0xae,0x47,0x3e,0x105)]);}}function updateComfyUIImagePreview(_0x374ebb){function _0x32a066(_0x597973,_0x1b8855,_0x939421,_0x276bad){return _0x6a94f3(_0x1b8855- -0x630,_0x1b8855-0xfe,_0x276bad,_0x276bad-0xbc);}const _0x1055c0={};_0x1055c0[_0x32a066(-0x151,-0x118,-0xdb,-0x187)]=_0x1a3511(0xb7,0x10d,0x8f,0xfe)+'mage-previ'+'ew-contain'+_0x1a3511(0x258,0x1d9,0x167,0x172)+_0x32a066(-0x31,-0x80,-0x17,-0x1c)+_0x32a066(-0xb5,-0x108,-0xd1,-0xbf)+'r',_0x1055c0[_0x32a066(-0x1c,-0x69,-0x94,-0x51)]='comfyui-re'+_0x32a066(0x24,-0x5d,0xb,0xa)+_0x1a3511(0x186,0x11b,0x11c,0x10d),_0x1055c0[_0x1a3511(0x1c3,0x157,0x115,0x136)]=function(_0x374974,_0x133198){return _0x374974!==_0x133198;},_0x1055c0[_0x32a066(-0xa7,-0x105,-0xbd,-0x96)]=function(_0x4224d1,_0x356a59){return _0x4224d1===_0x356a59;};function _0x1a3511(_0x1ad68c,_0x43ef48,_0x56c7a5,_0x31b962){return _0x13d461(_0x1ad68c-0xf7,_0x31b962,_0x56c7a5-0x13a,_0x43ef48-0x9d);}_0x1055c0[_0x1a3511(0x1a0,0x154,0x14a,0xe9)]=_0x32a066(-0x14,-0x4b,0x34,0x11),_0x1055c0[_0x1a3511(0x17a,0x1ab,0x17d,0x16c)]=_0x32a066(-0x47,-0x56,-0x6a,-0x71),_0x1055c0['WjVdV']=_0x1a3511(0x142,0xdb,0x65,0xf1),_0x1055c0[_0x1a3511(0x131,0x1b4,0x167,0x1f0)]=_0x1a3511(0xc6,0x133,0xe9,0x153)+'x',_0x1055c0[_0x32a066(-0x12a,-0xcd,-0x118,-0x145)]=_0x1a3511(0x154,0x185,0x17d,0x134);const _0xda5aff=_0x1055c0,_0x1b4309=document[_0x32a066(-0xb8,-0xd0,-0xad,-0x94)+_0x32a066(-0x30,-0x76,-0x5f,-0xbc)](_0x1a3511(0x121,0x166,0x1e6,0x143)+'ge2'),_0x2e7841=document['querySelec'+_0x32a066(-0x152,-0xd3,-0x15b,-0x12a)](_0xda5aff[_0x1a3511(0x123,0x118,0x145,0x17f)]),_0x267005=document[_0x1a3511(0x16e,0x160,0x13a,0x1a9)+_0x32a066(-0x48,-0x76,-0xe0,-0xb6)](_0xda5aff[_0x32a066(-0x63,-0x69,-0xc7,-0xa8)]);if(_0x1b4309[_0x1a3511(0x21e,0x1bf,0x159,0x1d1)]&&_0x1b4309[_0x1a3511(0x138,0x1bf,0x1b2,0x214)][_0x32a066(-0x139,-0xd2,-0x94,-0xae)](_0x32a066(-0x11a,-0x12e,-0xb3,-0xb1))&&_0xda5aff[_0x32a066(-0xf0,-0xd9,-0x8b,-0x15b)](_0x1b4309['src'],_0x374ebb)){if(_0xda5aff[_0x1a3511(0x12c,0x12b,0xa3,0x12d)](_0xda5aff[_0x32a066(-0x112,-0xdc,-0xb2,-0xf3)],_0xda5aff['HsFcn']))URL[_0x32a066(-0x134,-0x15a,-0x11f,-0x182)+_0x1a3511(0x135,0x1b9,0x187,0x138)](_0x1b4309[_0x32a066(-0xc6,-0x71,-0xa9,-0x86)]);else{const _0x4f3b03=_0x26b69b[_0x1a3511(0xd1,0xfc,0x7f,0xf8)],_0x519112={};_0x519112[_0x32a066(-0x107,-0xcf,-0x6d,-0xce)]=_0x4f3b03,_0x519112[_0x1a3511(0x1fc,0x18f,0x208,0x194)+_0x1a3511(0xff,0x134,0x1a0,0x120)]=_0x320492[_0x1a3511(0xd0,0x113,0x135,0x111)];const _0x67498d=_0x519112,_0x8c575f={};_0x8c575f['id']=_0x3252b5,_0x8c575f[_0x32a066(-0xf5,-0xcf,-0x55,-0x64)]=_0x67498d,_0x2ae7ab[_0x1a3511(0xc5,0xeb,0x131,0x15b)+_0x32a066(-0x118,-0x11e,-0x189,-0xd3)](_0x8c575f);}}_0x374ebb?(_0x1b4309['src']=_0x374ebb,_0x1b4309[_0x1a3511(0x170,0x1a8,0x227,0x22c)][_0x32a066(-0xc5,-0x109,-0xae,-0xe9)]=_0xda5aff[_0x1a3511(0x1e4,0x1ab,0x1bb,0x176)],_0x2e7841[_0x1a3511(0x135,0x1a8,0x1cf,0x1cb)][_0x32a066(-0x187,-0x109,-0x154,-0x8d)]=_0xda5aff[_0x1a3511(0xca,0x14a,0x109,0x1b0)],_0x267005['style'][_0x32a066(-0xf3,-0x109,-0x9f,-0x141)]=_0xda5aff[_0x32a066(-0x20,-0x7c,-0x84,-0xc7)]):(_0x1b4309[_0x32a066(-0x3b,-0x71,-0x28,-0x3b)]='',_0x1b4309[_0x1a3511(0x155,0x1a8,0x148,0x20e)][_0x32a066(-0xb1,-0x109,-0x150,-0x185)]=_0xda5aff[_0x32a066(-0xd6,-0xe6,-0xf4,-0x162)],_0x2e7841[_0x32a066(-0xc8,-0x88,-0x92,-0x65)][_0x32a066(-0xb0,-0x109,-0x173,-0x12d)]=_0xda5aff['qZygT'],_0x267005[_0x32a066(-0x3c,-0x88,-0x4c,-0x6a)][_0x32a066(-0x197,-0x109,-0x186,-0xef)]=_0xda5aff[_0x32a066(-0xd7,-0xe6,-0x57,-0x9e)],window[_0x32a066(-0x16e,-0xf2,-0xa5,-0xf0)+_0x1a3511(0x87,0x10f,0x120,0x114)]=null,comfyuiImageObjectURL=null);}function _0x6a94f3(_0x5ed45f,_0x4038f7,_0x59a8b9,_0x3486de){return _0x7e6f(_0x5ed45f-0x378,_0x59a8b9);}function removeComfyUIImage(){const _0x17b014={'lykfO':function(_0x528563,_0x49f6d9){return _0x528563(_0x49f6d9);}};_0x17b014['lykfO'](updateComfyUIImagePreview,null);function _0x3be98c(_0x130f62,_0x5b1090,_0x2450d5,_0x1f435a){return _0x13d461(_0x130f62-0x194,_0x1f435a,_0x2450d5-0x166,_0x2450d5-0x3cd);}dbs[_0x3be98c(0x49e,0x41b,0x460,0x474)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x2d4d38){const _0x5f5e09={'BvAmk':function(_0x381d62,_0x3d5666){return _0x381d62(_0x3d5666);},'YRUjX':function(_0x354bb4,_0x303e42){return _0x354bb4+_0x303e42;},'eMviC':_0x5703a7(0x424,0x45e,0x3aa,0x461)+':','upDaV':function(_0x2db264){return _0x2db264();},'LRSrT':_0x46b1de(0x392,0x3f4,0x439,0x46d),'StPDo':function(_0x1a300e,_0x1cd675){return _0x1a300e===_0x1cd675;},'XkCsz':_0x5703a7(0x40f,0x44f,0x472,0x45d),'EOsQr':_0x5703a7(0x39e,0x402,0x321,0x3f7)+'I\x20API地址。','dyaSP':function(_0xbfcdde){return _0xbfcdde();},'gehPR':function(_0x214381,_0x4b60d5,_0x21391f){return _0x214381(_0x4b60d5,_0x21391f);},'KYfex':'POST','AlnZL':function(_0x1105d0,_0xffea60){return _0x1105d0(_0xffea60);},'qQpNB':_0x5703a7(0x332,0x30a,0x346,0x2d9)+_0x5703a7(0x431,0x3cb,0x468,0x406),'qkVKr':_0x5703a7(0x3ee,0x417,0x467,0x361),'BcqKw':function(_0x8a5e9,_0x5231e3){return _0x8a5e9(_0x5231e3);},'QQzMy':function(_0x2feb87){return _0x2feb87();},'XXVXV':function(_0x4bb046,_0x2788e){return _0x4bb046!==_0x2788e;},'LnWgL':_0x5703a7(0x400,0x462,0x418,0x42a),'ezSZj':'cfdwW','OJIbx':function(_0xbf4e77,_0x1721a6){return _0xbf4e77(_0x1721a6);},'mlLJC':_0x5703a7(0x424,0x41b,0x3cf,0x3bd)+':\x20','YyHhM':function(_0x47dc1c,_0x3de423){return _0x47dc1c(_0x3de423);}},_0x48cd09=extension_settings[extensionName];function _0x5703a7(_0x839abf,_0x1dffdb,_0x483513,_0x283628){return _0x13d461(_0x839abf-0xab,_0x483513,_0x483513-0x1e7,_0x839abf-0x2f0);}function _0x46b1de(_0x4d7566,_0x6e9bb3,_0x4ef1bf,_0x5b810b){return _0x6a94f3(_0x6e9bb3- -0x138,_0x6e9bb3-0x8e,_0x4d7566,_0x5b810b-0x119);}const _0x22879e=_0x2d4d38[_0x46b1de(0x3d7,0x45e,0x46f,0x48d)][_0x5703a7(0x327,0x3a4,0x382,0x2ed)][-0x1330+0x1e3a+-0xb0a];if(!_0x22879e)return;try{const _0x8e0357=await _0x5f5e09[_0x46b1de(0x3ca,0x3c7,0x352,0x34b)](processUploadedImageToBlob,_0x22879e),_0x84b13c=URL[_0x5703a7(0x3ed,0x3ca,0x446,0x46f)+_0x46b1de(0x3fa,0x481,0x4d8,0x404)](_0x8e0357);comfyuiImageObjectURL=_0x84b13c,_0x5f5e09[_0x5703a7(0x352,0x378,0x2ca,0x358)](updateComfyUIImagePreview,_0x84b13c);const _0x26c793=new FormData();_0x26c793[_0x5703a7(0x3da,0x3c4,0x35e,0x35c)](_0x5f5e09[_0x46b1de(0x385,0x3be,0x3a1,0x3f5)],_0x8e0357,_0x22879e[_0x46b1de(0x3e4,0x3db,0x381,0x402)]);let _0x4e973f=_0x48cd09[_0x46b1de(0x341,0x3ab,0x31d,0x396)][_0x46b1de(0x500,0x488,0x459,0x502)]();if(!_0x4e973f){if(_0x5f5e09[_0x5703a7(0x43e,0x4c9,0x4c9,0x3b2)](_0x5f5e09['XkCsz'],_0x5f5e09[_0x5703a7(0x37c,0x403,0x3d8,0x2f7)])){_0x5f5e09[_0x5703a7(0x352,0x3b5,0x323,0x2fe)](alert,_0x5f5e09['EOsQr']),_0x5f5e09['dyaSP'](removeComfyUIImage);return;}else _0x5f5e09['BvAmk'](_0x409e27,_0x5f5e09['YRUjX']('图片处理或上传时出错'+':\x20',_0x40d763['message'])),_0x43018f[_0x46b1de(0x3e6,0x3cc,0x382,0x358)](_0x5f5e09[_0x5703a7(0x42e,0x42f,0x3f8,0x43f)],_0x13159f),_0x2691ed(_0x5703a7(0x361,0x33d,0x30c,0x3d8)+_0x5703a7(0x385,0x32e,0x391,0x39c)+_0x14fa10[_0x46b1de(0x495,0x42f,0x3d9,0x3a5)](_0x4ca8af)),_0x5f5e09[_0x46b1de(0x479,0x3ed,0x387,0x478)](_0x201dce);}const _0x15f4c8=await _0x5f5e09[_0x5703a7(0x3ad,0x381,0x411,0x40f)](fetch,_0x4e973f+(_0x46b1de(0x421,0x3cb,0x3e6,0x349)+_0x46b1de(0x456,0x438,0x3bd,0x43c)),{'method':_0x5f5e09[_0x46b1de(0x416,0x3d4,0x3ac,0x39a)],'body':_0x26c793});if(_0x15f4c8['ok']){const _0x136825=await _0x15f4c8[_0x5703a7(0x35e,0x3d2,0x3ae,0x3dd)]();window[_0x5703a7(0x391,0x40a,0x3f0,0x420)+_0x5703a7(0x362,0x3ea,0x359,0x32b)]=_0x136825[_0x5703a7(0x366,0x2e6,0x3a3,0x35c)],_0x5f5e09[_0x5703a7(0x411,0x479,0x488,0x426)](addLog,_0x46b1de(0x406,0x3a5,0x34b,0x430)+_0x5703a7(0x39f,0x35f,0x365,0x339)+JSON[_0x5703a7(0x3ba,0x38a,0x3df,0x3c3)](_0x136825)),console['log'](_0x5f5e09[_0x46b1de(0x35d,0x3e9,0x3cc,0x435)],_0x136825);const _0x5633fa=new FileReader();_0x5633fa[_0x5703a7(0x33b,0x361,0x3c7,0x2d4)]=()=>{const _0x3ae2d6=_0x5633fa[_0x36456c(0x1d3,0x1a5,0x241,0x23f)];function _0x327958(_0x816f9a,_0x238c2d,_0x49ca62,_0x153767){return _0x46b1de(_0x816f9a,_0x238c2d- -0x267,_0x49ca62-0x1e6,_0x153767-0xf5);}const _0x2db071={};_0x2db071['data']=_0x3ae2d6,_0x2db071['serverFile'+_0x36456c(0x20b,0x251,0x1f5,0x27e)]=_0x136825[_0x36456c(0x1ea,0x1f1,0x191,0x256)];const _0x49241d=_0x2db071;function _0x36456c(_0x5a13aa,_0x46d133,_0x416532,_0x470e07){return _0x5703a7(_0x5a13aa- -0x17c,_0x46d133-0xa6,_0x46d133,_0x470e07-0x1ea);}const _0x11e5d9={};_0x11e5d9['id']=COMFYUI_REF_CACHE_KEY,_0x11e5d9[_0x327958(0x162,0x1c2,0x1ba,0x18d)]=_0x49241d,dbs['storeReadW'+_0x327958(0x1c1,0x173,0x1c4,0x194)](_0x11e5d9);},_0x5633fa['readAsData'+_0x46b1de(0x464,0x3e2,0x3d8,0x3bc)](_0x8e0357);}else{const _0xbb9f98=await _0x15f4c8[_0x5703a7(0x342,0x352,0x358,0x3a9)]();_0x5f5e09[_0x5703a7(0x411,0x484,0x39e,0x394)](alert,_0x5f5e09[_0x5703a7(0x3d9,0x400,0x3fb,0x359)](_0x5f5e09[_0x46b1de(0x446,0x46e,0x4a0,0x4fc)],_0xbb9f98)),_0x5f5e09[_0x5703a7(0x392,0x3aa,0x3ba,0x3b8)](addLog,_0x46b1de(0x38c,0x3d6,0x36b,0x3ce)+_0x46b1de(0x3dd,0x3fa,0x3fd,0x3a4)+_0xbb9f98),console[_0x5703a7(0x357,0x2f4,0x3d9,0x2d1)](_0x5703a7(0x3fa,0x3a4,0x3a0,0x3bd),_0xbb9f98),_0x5f5e09[_0x46b1de(0x3af,0x3c8,0x442,0x38e)](removeComfyUIImage);}}catch(_0x4bb37f){_0x5f5e09[_0x46b1de(0x432,0x4a5,0x43d,0x481)](_0x5f5e09[_0x46b1de(0x33c,0x3bb,0x3ad,0x39e)],_0x5f5e09[_0x46b1de(0x3ad,0x419,0x450,0x499)])?(_0x5f5e09[_0x5703a7(0x3af,0x428,0x335,0x37c)](alert,_0x5f5e09['mlLJC']+_0x4bb37f[_0x46b1de(0x436,0x3cf,0x37c,0x3c5)]),console[_0x5703a7(0x357,0x39c,0x3b7,0x379)](_0x46b1de(0x441,0x499,0x517,0x4d1)+':',_0x4bb37f),_0x5f5e09[_0x5703a7(0x3c2,0x425,0x3f5,0x422)](addLog,'图片上传失败,\x20错误'+'详情:\x20'+JSON['stringify'](_0x4bb37f)),_0x5f5e09[_0x46b1de(0x3ee,0x3ed,0x466,0x3ff)](removeComfyUIImage)):(_0x164fbd(null),_0x3f4eca['storeDelet'+'e'](_0x2524a6));}}async function loadCachedImages(){const _0x22d0f8={'DzizP':_0x44d0bf(0x3b,0xca,-0x1f,0x5d)+_0x44d0bf(-0x44,0x3d,-0x67,0xd)+_0x44d0bf(-0x40,0x56,0x42,-0x1f),'vgiBC':function(_0x572956){return _0x572956();},'aRXiB':_0x4b3e7f(0x3db,0x44f,0x460,0x45e),'hQurJ':_0x44d0bf(-0x3d,-0x63,-0xbe,-0x36),'FSuOI':_0x44d0bf(0x2b,0x2b,0x72,0x22)+'x','Yqvbd':_0x44d0bf(-0x30,0x2b,-0x5,0x55)+_0x44d0bf(0x2d,0x43,0x36,0x86),'QdjtO':_0x4b3e7f(0x316,0x29e,0x378,0x30e)+_0x4b3e7f(0x3d4,0x3e3,0x447,0x3dd)+_0x4b3e7f(0x31c,0x2b6,0x352,0x2de),'MrPFM':_0x44d0bf(0x6d,-0x85,0x42,-0xf),'IAlmt':function(_0x5b4480,_0x3f2805){return _0x5b4480!==_0x3f2805;},'dpCHp':function(_0x462e52,_0x28b8d4){return _0x462e52!==_0x28b8d4;},'yrORK':_0x4b3e7f(0x347,0x34c,0x3bd,0x30f),'LcWrU':_0x4b3e7f(0x33d,0x3c8,0x30c,0x3ac),'JyLKj':function(_0x182a7f,_0x5ef045){return _0x182a7f(_0x5ef045);},'OqTaz':_0x4b3e7f(0x2d3,0x2e9,0x27d,0x313),'jCxzE':'cpwek','TiXwr':function(_0x4ca9ab,_0x3245c6){return _0x4ca9ab(_0x3245c6);},'WIZhS':function(_0x406fd0,_0x93bbf1){return _0x406fd0===_0x93bbf1;},'JukAe':'kNRUH','DTLsC':function(_0xfe5616,_0x4c2b27){return _0xfe5616(_0x4c2b27);},'XUZle':_0x4b3e7f(0x3d1,0x367,0x390,0x3d8),'OCbOE':_0x4b3e7f(0x2fa,0x2a7,0x327,0x2ae),'pIgaS':function(_0x19812c,_0x3aa696){return _0x19812c(_0x3aa696);},'MercE':_0x44d0bf(0xd8,0x7,0xf0,0x7b)+_0x4b3e7f(0x3b6,0x3c8,0x41b,0x36f)+_0x44d0bf(0xf7,0xc9,0xcf,0x99)+_0x4b3e7f(0x379,0x343,0x346,0x3da)+'at.\x20Please'+_0x44d0bf(0x7e,0x85,0x91,0x60)+'\x20to\x20update'+_0x44d0bf(-0x5d,-0x4a,0x2,0x1d)+_0x4b3e7f(0x3cb,0x363,0x362,0x3ea)+_0x4b3e7f(0x37e,0x3e6,0x34e,0x347),'OsAaO':_0x44d0bf(0x118,0x4c,0x144,0xc3),'tbnIM':_0x4b3e7f(0x2da,0x27c,0x276,0x2e8)+_0x44d0bf(-0x72,-0x5a,-0x16,0x12)+'\x20ComfyUI\x20i'+_0x4b3e7f(0x2f6,0x281,0x2da,0x2c2)};function _0x44d0bf(_0x2cd6ab,_0x19c4ff,_0x295f55,_0x300ea1){return _0x6a94f3(_0x300ea1- -0x511,_0x19c4ff-0x160,_0x19c4ff,_0x300ea1-0x6);}await dbs[_0x4b3e7f(0x339,0x39d,0x3aa,0x30e)]();try{const _0x503a74=await dbs[_0x4b3e7f(0x3a6,0x3a9,0x402,0x42e)+_0x4b3e7f(0x2e2,0x268,0x25b,0x2cc)](NAI_VIBE_CACHE_KEY);_0x503a74&&_0x503a74[_0x44d0bf(0x9f,0x54,-0x26,0x50)]&&(_0x22d0f8[_0x44d0bf(0x63,-0x17,0xde,0x5c)](_0x22d0f8[_0x4b3e7f(0x3a0,0x403,0x31a,0x314)],_0x22d0f8[_0x44d0bf(0xae,0xa8,0xec,0xb2)])?_0x22d0f8[_0x4b3e7f(0x3e8,0x42d,0x42c,0x3e4)](updateNovelaiImagePreview,_0x503a74[_0x4b3e7f(0x362,0x357,0x3e2,0x328)]):_0x20065d[_0x4b3e7f(0x361,0x30c,0x36b,0x37d)+_0x44d0bf(0xd5,0x53,0x49,0xa9)](_0x22d0f8['DzizP'])[_0x4b3e7f(0x357,0x35c,0x32d,0x340)]());}catch(_0x41b73a){_0x22d0f8['OqTaz']!==_0x22d0f8[_0x44d0bf(0x26,0xc0,0x2d,0xb4)]?console[_0x4b3e7f(0x305,0x27f,0x37e,0x340)](_0x44d0bf(-0x20,-0x72,-0x53,-0x38)+_0x44d0bf(-0x3e,-0x54,-0x26,0x12)+_0x4b3e7f(0x312,0x377,0x303,0x2f9)+'ibe\x20image:',_0x41b73a):_0x22d0f8[_0x44d0bf(0x73,0x65,0x7d,0x3c)](_0x15f322);}function _0x4b3e7f(_0x32014e,_0x24ad26,_0x4e981a,_0x36aaca){return _0x13d461(_0x32014e-0x4f,_0x24ad26,_0x4e981a-0x16d,_0x32014e-0x29e);}try{const _0x50d951=await dbs['storeReadO'+_0x4b3e7f(0x2e2,0x36c,0x256,0x269)](NAI_CHAR_REF_CACHE_KEY);_0x50d951&&_0x50d951['data']&&_0x22d0f8[_0x44d0bf(0x130,0x26,0x123,0xaa)](updateNovelaiCharRefImagePreview,_0x50d951[_0x44d0bf(0xaa,-0x21,-0x21,0x50)]);}catch(_0x5f294c){console[_0x44d0bf(0x61,0x42,0x53,-0xd)]('Error\x20load'+_0x44d0bf(-0x6b,-0x4a,-0x1c,0x12)+_0x44d0bf(0x55,0x96,0x131,0xc7)+_0x4b3e7f(0x377,0x380,0x348,0x37a)+_0x44d0bf(0x74,0x5f,0xe3,0x77),_0x5f294c);}try{if(_0x22d0f8[_0x44d0bf(0xa4,-0x5,0xbd,0x44)](_0x22d0f8[_0x4b3e7f(0x366,0x2fc,0x344,0x354)],_0x22d0f8[_0x4b3e7f(0x366,0x2fc,0x35c,0x399)])){const _0x479ae8=await dbs['storeReadO'+_0x44d0bf(0xc,-0xa8,-0x90,-0x30)](COMFYUI_REF_CACHE_KEY);if(_0x479ae8&&_0x479ae8[_0x4b3e7f(0x362,0x31a,0x31b,0x2d3)]&&_0x479ae8[_0x4b3e7f(0x362,0x36d,0x38d,0x2e3)]['data']&&_0x479ae8['data'][_0x4b3e7f(0x390,0x36e,0x37d,0x350)+_0x44d0bf(0x20,0x4d,-0x3c,0x23)]){const _0x54ab5f=_0x479ae8['data'],_0x327005=await _0x22d0f8[_0x4b3e7f(0x3e8,0x454,0x3ad,0x377)](fetch,_0x54ab5f[_0x4b3e7f(0x362,0x39b,0x39a,0x3ae)]),_0x3c89c7=await _0x327005[_0x44d0bf(-0x68,0x71,-0x14,0x1c)](),_0x3069a7=URL[_0x4b3e7f(0x39b,0x3d3,0x3b3,0x35f)+_0x4b3e7f(0x3ba,0x3fa,0x444,0x3c9)](_0x3c89c7);_0x22d0f8[_0x4b3e7f(0x3bc,0x333,0x36a,0x3df)](updateComfyUIImagePreview,_0x3069a7),comfyuiImageObjectURL=_0x3069a7,window[_0x4b3e7f(0x33f,0x375,0x35f,0x384)+_0x4b3e7f(0x310,0x353,0x378,0x351)]=_0x54ab5f['serverFile'+_0x44d0bf(0x95,0x9,-0x51,0x23)],_0x22d0f8['DTLsC'](addLog,_0x44d0bf(-0x9,-0x24,0x4e,-0x2d)+_0x4b3e7f(0x3e3,0x444,0x3f6,0x384)+_0x54ab5f[_0x44d0bf(-0xe,0x3a,0x22,0x7e)+_0x4b3e7f(0x335,0x384,0x385,0x36f)]),console[_0x44d0bf(0x8b,0x7d,0x16,0x61)](_0x44d0bf(0x2a,0x35,0x1d,0x7b)+_0x4b3e7f(0x3b6,0x3c5,0x3ea,0x3fc)+_0x4b3e7f(0x3e1,0x3d5,0x42a,0x442)+_0x4b3e7f(0x2ef,0x30b,0x2b6,0x377)+_0x54ab5f['serverFile'+_0x4b3e7f(0x335,0x391,0x2e1,0x316)]);}else{if(_0x479ae8&&typeof _0x479ae8['data']==='string'){if(_0x22d0f8[_0x4b3e7f(0x2e1,0x343,0x333,0x254)]===_0x22d0f8['OCbOE'])_0x5d5053();else{const _0x5109bc=await _0x22d0f8[_0x4b3e7f(0x3e8,0x39a,0x41d,0x45f)](fetch,_0x479ae8[_0x4b3e7f(0x362,0x30f,0x321,0x31b)]),_0x2bb441=await _0x5109bc['blob'](),_0x18606c=URL[_0x44d0bf(0x66,0x9b,0x77,0x89)+'ctURL'](_0x2bb441);_0x22d0f8[_0x4b3e7f(0x2e8,0x327,0x363,0x26e)](updateComfyUIImagePreview,_0x18606c),comfyuiImageObjectURL=_0x18606c,console[_0x44d0bf(-0x56,0x20,-0x11,0x29)](_0x22d0f8[_0x44d0bf(-0x1d,0x8,0x1d,-0x2f)]);}}}}else{_0x9cd14a[_0x4b3e7f(0x3c0,0x376,0x3cc,0x40a)]=_0x242cd9,_0x28ca97[_0x44d0bf(0x61,0xd3,0x60,0x97)][_0x4b3e7f(0x328,0x2a7,0x2b5,0x2f1)]=_0x22d0f8['aRXiB'],_0x3aa8a4[_0x44d0bf(0x125,0x86,0x92,0x97)][_0x4b3e7f(0x328,0x2ec,0x330,0x2f8)]=_0x22d0f8[_0x44d0bf(0x31,-0x2,0x1f,-0x7)],_0x2ffb3e[_0x4b3e7f(0x3a9,0x42f,0x392,0x3bf)][_0x4b3e7f(0x328,0x2c5,0x2f3,0x380)]=_0x22d0f8[_0x4b3e7f(0x330,0x392,0x32e,0x373)];const _0x2bedcd=_0x2a8f5f[_0x44d0bf(0xba,0x36,0xc4,0x79)](','),_0x2f2458=_0x2bedcd[0x457*-0x5+0x1aa8+-0x4f5][_0x44d0bf(0x70,0x86,0xdf,0x79)](':')[0xcd2+0x2007+-0x29*0x118][_0x4b3e7f(0x38b,0x413,0x393,0x32d)](';')[0x66e+0x25ae+0x75a*-0x6];_0x30b508=_0x2f2458,_0x1b0683['nai3VibeTr'+_0x44d0bf(0x4e,0xa4,0x50,0x2c)+'e']=_0x2bedcd[0x6a3*-0x4+-0x161d+0x30aa];const _0x344c86={};_0x344c86['id']=_0x30d202,_0x344c86[_0x44d0bf(0xad,0x35,0x3b,0x50)]=_0x343561,_0x22f07a[_0x4b3e7f(0x2ec,0x2fc,0x28d,0x30d)+_0x44d0bf(0x74,-0x4a,0x5,0x1)](_0x344c86);}}catch(_0x2f48a7){if(_0x22d0f8['IAlmt'](_0x22d0f8['OsAaO'],_0x4b3e7f(0x3cc,0x350,0x394,0x388)))console[_0x4b3e7f(0x305,0x2f4,0x335,0x2a0)](_0x22d0f8[_0x44d0bf(0x14,0x35,-0x46,-0x10)],_0x2f48a7);else{const _0x5e07b0=_0x19476e['getElement'+_0x44d0bf(0x124,0xc8,0xa6,0xa9)](_0x22d0f8['Yqvbd']),_0x2fbed7=_0x2f5583['querySelec'+_0x44d0bf(0xf,0x64,-0x18,0x4c)](_0x4b3e7f(0x30e,0x2f8,0x386,0x334)+'mage-previ'+_0x4b3e7f(0x337,0x349,0x2eb,0x339)+_0x44d0bf(0x75,0x132,0xbf,0xc8)+_0x44d0bf(0xe3,0x35,0x43,0x9f)+_0x44d0bf(0x75,0xa3,0x71,0x17)+'r'),_0xb50e60=_0x441032[_0x4b3e7f(0x361,0x3d9,0x2d1,0x398)+_0x4b3e7f(0x3bb,0x331,0x379,0x3fa)](_0x22d0f8[_0x44d0bf(-0x1e,-0x2,-0x23,0x36)]);_0x5e07b0[_0x44d0bf(0xb8,0xd6,0x62,0xae)]&&_0x5e07b0['src']['startsWith'](_0x22d0f8['MrPFM'])&&_0x22d0f8[_0x44d0bf(0xd,0x45,0x5d,0x6a)](_0x5e07b0[_0x4b3e7f(0x3c0,0x38e,0x3da,0x42c)],_0x592438)&&_0x13d821[_0x4b3e7f(0x2d7,0x2fb,0x34d,0x365)+_0x44d0bf(0x57,0x3b,0x88,0xa8)](_0x5e07b0[_0x44d0bf(0xe8,0x66,0x73,0xae)]),_0x56640f?(_0x5e07b0[_0x4b3e7f(0x3c0,0x358,0x3ac,0x3c3)]=_0x496e05,_0x5e07b0[_0x4b3e7f(0x3a9,0x357,0x408,0x3ff)]['display']=_0x22d0f8[_0x4b3e7f(0x2e7,0x2c3,0x362,0x30f)],_0x2fbed7[_0x44d0bf(0x74,0x8e,0xe8,0x97)][_0x44d0bf(-0x22,-0xe,-0x37,0x16)]=_0x22d0f8[_0x44d0bf(-0x4c,-0x36,0x5c,-0x7)],_0xb50e60['style'][_0x4b3e7f(0x328,0x349,0x2ac,0x384)]=_0x4b3e7f(0x334,0x32b,0x305,0x33e)+'x'):(_0x5e07b0[_0x44d0bf(0x73,0x4f,0x104,0xae)]='',_0x5e07b0['style'][_0x4b3e7f(0x328,0x331,0x34c,0x2b8)]=_0x22d0f8[_0x4b3e7f(0x30b,0x2f1,0x315,0x338)],_0x2fbed7[_0x4b3e7f(0x3a9,0x367,0x365,0x3b1)][_0x4b3e7f(0x328,0x32c,0x2ed,0x314)]='flex',_0xb50e60['style'][_0x44d0bf(0x97,0xe,0x4a,0x16)]=_0x22d0f8[_0x4b3e7f(0x30b,0x2c9,0x31b,0x36a)],_0x2a4bcb[_0x4b3e7f(0x33f,0x394,0x390,0x2e3)+_0x4b3e7f(0x310,0x399,0x304,0x34f)]=null,_0x4d0f80=null);}}}export function initImageUpload(_0x129c1d){const _0x308fc7={'ipxqH':'imageInput'+_0x11e1dc(0x44f,0x426,0x4b2,0x4f2),'MggpF':function(_0x4a364b,_0xfea12){return _0x4a364b!==_0xfea12;},'IlgdA':_0x11e1dc(0x47d,0x525,0x4bc,0x4d9),'IZcXH':'yxNRu','TsSbu':function(_0x4708cc){return _0x4708cc();},'hTcvQ':_0x11e1dc(0x3c6,0x406,0x404,0x452),'oTcPv':_0x5fe195(-0x197,-0x195,-0x1d8,-0x187)+'x','Jispw':_0x11e1dc(0x544,0x58a,0x516,0x4d0),'ZVEDC':_0x11e1dc(0x41f,0x420,0x497,0x4af)+_0x11e1dc(0x49f,0x4b9,0x447,0x437)+_0x5fe195(-0x150,-0x202,-0x14b,-0x1c8),'IvARF':'Error\x20load'+'ing\x20cached'+'\x20ComfyUI\x20i'+'mage:','dasDV':function(_0x483e98,_0x111407){return _0x483e98===_0x111407;},'rwyix':_0x11e1dc(0x528,0x56e,0x4e6,0x464),'PAzay':_0x5fe195(-0x197,-0xda,-0x14b,-0x116),'JZnET':function(_0x274fcb){return _0x274fcb();},'shHqp':function(_0x1d9ab4){return _0x1d9ab4();},'csKPx':_0x11e1dc(0x4e8,0x4b3,0x513,0x497)+'elect-imag'+_0x11e1dc(0x531,0x58c,0x512,0x55f),'mJpqj':_0x5fe195(-0x159,-0x19f,-0x14c,-0x164),'mssZu':'#imageInpu'+_0x11e1dc(0x4c1,0x528,0x511,0x4d8),'yNHId':_0x11e1dc(0x39d,0x491,0x424,0x48a),'bDrdt':_0x11e1dc(0x499,0x4a6,0x4f7,0x4a8)+'emove-imag'+_0x11e1dc(0x593,0x52c,0x512,0x551),'DsjvJ':_0x11e1dc(0x5a0,0x551,0x513,0x4dc)+_0x5fe195(-0x231,-0x148,-0x1ad,-0x1a4)+_0x11e1dc(0x4c0,0x4b4,0x4f6,0x4b4)+'-btn','hjuFj':_0x11e1dc(0x4ee,0x55e,0x500,0x496)+_0x5fe195(-0x8d,-0x175,-0x139,-0xf1)+_0x11e1dc(0x4c1,0x46a,0x4da,0x505),'sCzNq':_0x11e1dc(0x46b,0x57d,0x4f7,0x46e)+_0x11e1dc(0x447,0x46f,0x493,0x47e)+_0x5fe195(-0xd6,-0xc2,-0x14b,-0xed)+'-btn','tmVbk':'#imageInpu'+'t2','WplBB':_0x5fe195(-0x102,-0x156,-0x105,-0x126)+_0x5fe195(-0x1fe,-0x1ac,-0x202,-0x172)+_0x11e1dc(0x572,0x518,0x512,0x49b)};_0x308fc7['shHqp'](loadCachedImages),_0x129c1d[_0x11e1dc(0x494,0x4d5,0x4c7,0x47e)](_0x308fc7[_0x5fe195(-0x13e,-0x14e,-0x14e,-0x152)])['on'](_0x308fc7['mJpqj'],()=>{function _0x8bc4d3(_0x8e7271,_0x21c08e,_0x5d840f,_0x3d793d){return _0x5fe195(_0x8e7271-0x14d,_0x21c08e-0x1bd,_0x21c08e,_0x3d793d-0x360);}function _0x3b878b(_0xa93ef1,_0x8a9a69,_0x84b5a7,_0x2b32d1){return _0x11e1dc(_0xa93ef1-0x177,_0x8a9a69-0xb,_0x2b32d1- -0x594,_0xa93ef1);}document[_0x8bc4d3(0x213,0x17b,0x232,0x206)+_0x8bc4d3(0x2d1,0x2b7,0x23c,0x260)](_0x308fc7[_0x3b878b(-0x11e,-0x147,-0xcd,-0x12b)])[_0x8bc4d3(0x1bc,0x1b8,0x195,0x1fc)]();}),_0x129c1d[_0x11e1dc(0x488,0x478,0x4c7,0x54e)](_0x308fc7[_0x11e1dc(0x422,0x430,0x494,0x4bf)])['on'](_0x308fc7[_0x5fe195(-0x15e,-0xc1,-0x15b,-0x118)],handleNovelaiImageUpload),_0x129c1d[_0x5fe195(-0xce,-0x139,-0x105,-0x11c)](_0x308fc7['bDrdt'])['on'](_0x308fc7['mJpqj'],()=>{function _0xf1eaa4(_0x32c00e,_0x2aaf05,_0x54f198,_0x56b999){return _0x11e1dc(_0x32c00e-0x1c,_0x2aaf05-0x1c3,_0x32c00e- -0x45,_0x2aaf05);}function _0x5a5ff6(_0x49d32b,_0x412408,_0x4de2b5,_0x32666c){return _0x11e1dc(_0x49d32b-0x1e6,_0x412408-0xd5,_0x32666c- -0x59a,_0x4de2b5);}if(_0x308fc7[_0xf1eaa4(0x492,0x519,0x43d,0x42c)](_0x308fc7[_0xf1eaa4(0x41b,0x44c,0x472,0x47d)],_0x308fc7[_0xf1eaa4(0x433,0x449,0x4a1,0x419)]))_0x308fc7['TsSbu'](removeNovelaiImage);else{const _0x225d7a=_0x2613b9?function(){function _0x16aeec(_0x54cbe2,_0x9fc2c9,_0x126f73,_0x42d764){return _0xf1eaa4(_0x42d764- -0x411,_0x9fc2c9,_0x126f73-0x73,_0x42d764-0x15c);}if(_0x57d899){const _0x47f3b0=_0x5cf6cb[_0x16aeec(0x15,0x9e,0xf1,0x65)](_0x300ceb,arguments);return _0x36a7fd=null,_0x47f3b0;}}:function(){};return _0x2f3d52=![],_0x225d7a;}}),_0x129c1d['find'](_0x308fc7[_0x5fe195(-0x24d,-0x181,-0x253,-0x1de)])['on'](_0x308fc7[_0x5fe195(-0xec,-0xf2,-0x151,-0x102)],()=>{const _0x2d5ad8={};function _0x1e1df0(_0x279714,_0x910f2c,_0x2954e8,_0x3f0ba3){return _0x5fe195(_0x279714-0x67,_0x910f2c-0x3b,_0x279714,_0x910f2c-0x59c);}function _0x16f6d0(_0x59f133,_0x250fd1,_0x43c6ad,_0x1bc915){return _0x5fe195(_0x59f133-0xd9,_0x250fd1-0x44,_0x59f133,_0x1bc915- -0x5a);}_0x2d5ad8[_0x1e1df0(0x4fb,0x48e,0x4b1,0x4ae)]=_0x308fc7['hTcvQ'],_0x2d5ad8[_0x16f6d0(-0x22c,-0x1d8,-0x1e7,-0x1c1)]=_0x308fc7[_0x16f6d0(-0x1a4,-0x17e,-0x1e6,-0x1a0)];const _0x164812=_0x2d5ad8;if(_0x308fc7[_0x16f6d0(-0x106,-0x133,-0x131,-0x166)](_0x16f6d0(-0x169,-0xe6,-0x137,-0x127),_0x308fc7[_0x16f6d0(-0x187,-0x213,-0x1dc,-0x1df)])){_0x560c69[_0x1e1df0(0x4c6,0x4a1,0x4f6,0x470)]=_0x5e91bc,_0xd088f4['style']['display']='block',_0x393daa['style'][_0x16f6d0(-0x16f,-0x271,-0x1fb,-0x1ed)]=_0x164812['MMKZK'],_0x375e49[_0x16f6d0(-0x134,-0x107,-0x1b2,-0x16c)]['display']=_0x164812[_0x16f6d0(-0x16a,-0x18b,-0x1b0,-0x1c1)];const _0x417449=_0x25d6a5[_0x16f6d0(-0x14e,-0x208,-0x195,-0x18a)](','),_0x310fbd=_0x417449[-0x287+-0xb*0x115+0xe6e][_0x1e1df0(0x42b,0x46c,0x423,0x4e9)](':')[-0xc*-0x33d+0x3e2*-0x6+0xf8f*-0x1]['split'](';')[0xf56+0x2c*-0x21+-0x2*0x4d5];_0x5938cb=_0x310fbd,_0x2b08e2[_0x1e1df0(0x3a6,0x3d2,0x37c,0x34e)+_0x1e1df0(0x4ef,0x495,0x438,0x4d2)]=_0x417449[0x26ec+0x353+-0x2a3e];const _0x3e29b0={};_0x3e29b0['id']=_0x2f4085,_0x3e29b0[_0x1e1df0(0x401,0x443,0x4c9,0x4c4)]=_0x1f8674,_0x3dfbc1[_0x16f6d0(-0x19b,-0x19e,-0x2b9,-0x229)+_0x16f6d0(-0x27b,-0x1f7,-0x1e0,-0x202)](_0x3e29b0);}else document[_0x16f6d0(-0x1b6,-0x18a,-0x17d,-0x1b4)+_0x1e1df0(0x4ba,0x49c,0x51a,0x4db)](_0x308fc7[_0x1e1df0(0x435,0x4b1,0x45b,0x43e)])[_0x1e1df0(0x44f,0x438,0x3fe,0x3ae)]();}),_0x129c1d[_0x11e1dc(0x520,0x4d5,0x4c7,0x51e)](_0x308fc7[_0x11e1dc(0x586,0x501,0x518,0x4e6)])['on'](_0x308fc7[_0x11e1dc(0x53b,0x4a3,0x4cb,0x449)],handleNovelaiCharRefImageUpload);function _0x11e1dc(_0x38fa43,_0x2eb711,_0x524f40,_0x397e0d){return _0x13d461(_0x38fa43-0xbe,_0x397e0d,_0x524f40-0x1ea,_0x524f40-0x3c6);}_0x129c1d[_0x11e1dc(0x4ab,0x48c,0x4c7,0x4ee)](_0x308fc7[_0x5fe195(-0x15a,-0x18b,-0xe2,-0x10b)])['on'](_0x5fe195(-0xf1,-0x11e,-0x157,-0x164),()=>{function _0x21822d(_0x5615bd,_0x3efd72,_0x2442fc,_0x2b2741){return _0x5fe195(_0x5615bd-0x1e4,_0x3efd72-0xb3,_0x5615bd,_0x3efd72-0xea);}_0x308fc7[_0x21822d(-0x14f,-0xc0,-0x128,-0xde)](removeNovelaiCharRefImage);}),_0x129c1d[_0x11e1dc(0x520,0x4c6,0x4c7,0x49d)]('#comfyui-s'+'elect-imag'+_0x11e1dc(0x532,0x504,0x512,0x4ae))['on'](_0x308fc7[_0x5fe195(-0xac,-0x126,-0x13d,-0x102)],()=>{const _0x2b04b4={};function _0x2416a6(_0x3fc5aa,_0xc48112,_0x39c0d7,_0x55286a){return _0x11e1dc(_0x3fc5aa-0xe2,_0xc48112-0x105,_0x39c0d7- -0x603,_0xc48112);}function _0x15533e(_0x5a8fba,_0x4c98b4,_0x37f43f,_0x305d58){return _0x11e1dc(_0x5a8fba-0xe1,_0x4c98b4-0x1d2,_0x4c98b4- -0x158,_0x5a8fba);}_0x2b04b4[_0x15533e(0x42d,0x3bf,0x441,0x400)]=_0x308fc7[_0x15533e(0x2cb,0x2f1,0x2ad,0x35a)];const _0x30d237=_0x2b04b4;_0x308fc7[_0x15533e(0x349,0x3a3,0x3c6,0x35c)](_0x308fc7[_0x2416a6(-0x104,-0x129,-0x17f,-0x1a7)],_0x308fc7['PAzay'])?_0x3ba3f9[_0x15533e(0x331,0x2d5,0x34c,0x2f2)](_0x30d237[_0x15533e(0x399,0x3bf,0x427,0x434)],_0x1ee30e):document[_0x2416a6(-0x1ae,-0x207,-0x17a,-0x199)+_0x15533e(0x3d9,0x38b,0x412,0x35b)]('imageInput'+'2')['click']();}),_0x129c1d['find'](_0x308fc7['tmVbk'])['on'](_0x308fc7[_0x11e1dc(0x459,0x46b,0x4cb,0x447)],handleImageUpload2);function _0x5fe195(_0x56fa92,_0x6c9029,_0x117220,_0x2eda7a){return _0x6a94f3(_0x2eda7a- -0x6ba,_0x6c9029-0x1e5,_0x117220,_0x2eda7a-0x185);}_0x129c1d[_0x5fe195(-0x11c,-0x167,-0x16f,-0x11c)](_0x308fc7[_0x11e1dc(0x572,0x49a,0x4ea,0x546)])['on'](_0x308fc7[_0x11e1dc(0x499,0x467,0x4e1,0x543)],()=>{function _0x36cfcf(_0x16c7e2,_0x49ca2d,_0x4d6ea8,_0x1a2eca){return _0x5fe195(_0x16c7e2-0xe3,_0x49ca2d-0x151,_0x16c7e2,_0x1a2eca-0x213);}_0x308fc7[_0x36cfcf(0xda,0x4,0x52,0x51)](removeComfyUIImage);});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};