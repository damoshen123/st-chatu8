(function(_0xb8b9ae,_0x57c3f0){const _0xd188a9=_0xb8b9ae();function _0x7fcfa6(_0x587e05,_0x194b86,_0x1c0247,_0xdd2a29){return _0x2d3f(_0x587e05-0x380,_0xdd2a29);}function _0x3e219b(_0x5e5df2,_0x53ab84,_0x33644f,_0x1333eb){return _0x2d3f(_0x5e5df2- -0x368,_0x33644f);}while(!![]){try{const _0xca2252=-parseInt(_0x7fcfa6(0x62d,0x65f,0x65d,0x615))/(0x347+-0x6f*-0x3d+-0x43f*0x7)+parseInt(_0x7fcfa6(0x5b2,0x5ab,0x54b,0x5af))/(0xe17+-0x492+0x983*-0x1)+parseInt(_0x7fcfa6(0x566,0x583,0x572,0x4f2))/(0x78d+-0x136d*0x2+0x1f50)+-parseInt(_0x3e219b(-0xf1,-0x136,-0x78,-0xd6))/(0x3*-0x77f+0xee*0x4+-0x7*-0x2af)+-parseInt(_0x3e219b(-0x181,-0x169,-0x1e2,-0x13b))/(0x1*-0x89f+-0x1ffe+0x2e7*0xe)*(-parseInt(_0x7fcfa6(0x555,0x4e6,0x5b1,0x5bf))/(0x6*-0x4f+0x9a4+0x1*-0x7c4))+parseInt(_0x7fcfa6(0x5da,0x59c,0x5cc,0x640))/(-0x2475+0x19f0+0xa8c)*(parseInt(_0x3e219b(-0x19e,-0x152,-0x1b7,-0x1fd))/(-0x2494+0x1*-0xecb+0x1*0x3367))+parseInt(_0x7fcfa6(0x5f1,0x5a2,0x65f,0x601))/(0xa95+0x1416*-0x1+0x98a);if(_0xca2252===_0x57c3f0)break;else _0xd188a9['push'](_0xd188a9['shift']());}catch(_0x4ae419){_0xd188a9['push'](_0xd188a9['shift']());}}}(_0x7419,0xcc7e6+-0x29f*0x563+0xf3eff));function _0x249499(_0x390c54,_0x1826e9,_0x17096d,_0xd3f0e){return _0x2d3f(_0xd3f0e- -0x3ad,_0x1826e9);}const _0x1e5366=(function(){const _0x36590c={};function _0x494c0b(_0x3daf98,_0x2e5406,_0x469307,_0x3d774c){return _0x2d3f(_0x469307- -0x23,_0x2e5406);}function _0x21a790(_0x2c1138,_0xff8a00,_0x284928,_0x4fe6cb){return _0x2d3f(_0x284928- -0x98,_0x4fe6cb);}_0x36590c[_0x494c0b(0x191,0x17a,0x1ef,0x1a3)]=_0x21a790(0x11a,0x105,0x13e,0xf3)+'ge_novelai',_0x36590c[_0x21a790(0x1b9,0x21a,0x1ba,0x203)]='data:image',_0x36590c[_0x494c0b(0x265,0x2bf,0x278,0x243)]=_0x21a790(0x170,0x18c,0x1c7,0x232),_0x36590c[_0x21a790(0x228,0x248,0x1cf,0x1e4)]=_0x21a790(0x1ea,0x18f,0x1ab,0x176)+'x',_0x36590c['cKrmW']=_0x21a790(0x1f3,0x1da,0x20d,0x22b),_0x36590c['urTxt']=function(_0x3dfb37,_0xf9907){return _0x3dfb37!==_0xf9907;},_0x36590c['KHFrN']='XsHew';const _0x38ea70=_0x36590c;let _0x442f95=!![];return function(_0x143d48,_0x50e2e7){const _0x27b50c={'VtWTm':_0x38ea70[_0x43920c(0x39,-0xd,-0x2,0xb)],'xRFCk':_0x38ea70[_0x43920c(-0xa,0x33,0x44,0x40)],'WYYIo':_0x38ea70[_0x60a05e(0xa5,0xbc,0x7d,0xe2)],'VUQlx':_0x38ea70[_0x60a05e(0x2d,0x88,0xf4,0xf9)],'XnFaz':_0x60a05e(-0x21,0x14,0x55,0x90),'yAbIA':_0x38ea70[_0x60a05e(0xa4,0xa3,0x41,0xb0)],'fKlCc':function(_0x33cc81,_0x2c15f7){return _0x38ea70['urTxt'](_0x33cc81,_0x2c15f7);},'kTlPC':_0x38ea70[_0x60a05e(0x12f,0xbe,0x4a,0x5c)]};function _0x60a05e(_0x5cf515,_0x4293c0,_0x14f22d,_0x90dbd7){return _0x21a790(_0x5cf515-0x1ac,_0x4293c0-0x1ec,_0x4293c0- -0x147,_0x14f22d);}function _0x43920c(_0x279eea,_0x1639aa,_0x56f42a,_0xdabb6){return _0x21a790(_0x279eea-0x152,_0x1639aa-0x5c,_0x1639aa- -0x187,_0x56f42a);}const _0x4483a3=_0x442f95?function(){function _0x2f6955(_0x54f2d8,_0x378dec,_0x2e4514,_0x270fd7){return _0x43920c(_0x54f2d8-0xc4,_0x2e4514-0x31b,_0x270fd7,_0x270fd7-0x108);}function _0x5725f9(_0x29a08b,_0x36456d,_0x76366f,_0x3b6dba){return _0x43920c(_0x29a08b-0xd,_0x3b6dba-0x345,_0x29a08b,_0x3b6dba-0x5d);}if(_0x27b50c[_0x5725f9(0x405,0x37c,0x3e4,0x3b6)](_0x2f6955(0x3ab,0x32e,0x34f,0x37d),_0x27b50c[_0x5725f9(0x2ef,0x2f3,0x2b4,0x325)])){const _0x1b0b18=_0x572f51['getElement'+'ById'](_0x27b50c['VtWTm']),_0x252091=_0x4eb440[_0x5725f9(0x396,0x342,0x376,0x334)+_0x2f6955(0x2f4,0x351,0x314,0x2f3)]('#novelai-i'+'mage-previ'+_0x2f6955(0x393,0x393,0x36c,0x369)+_0x5725f9(0x3b6,0x376,0x3d6,0x371)+'tu8-image-'+_0x2f6955(0x34c,0x2ce,0x31b,0x304)+'r'),_0x1fa47a=_0x464f80[_0x5725f9(0x372,0x2ef,0x2c7,0x302)+_0x5725f9(0x369,0x2c2,0x288,0x2f3)](_0x5725f9(0x308,0x398,0x32b,0x36f)+_0x2f6955(0x31b,0x381,0x326,0x385)+_0x2f6955(0x397,0x349,0x336,0x30d));if(_0x318c0f&&_0x9953ec[_0x5725f9(0x346,0x2aa,0x2c9,0x2f8)](_0x27b50c['xRFCk'])){_0x1b0b18['src']=_0x2e508e,_0x1b0b18['style'][_0x2f6955(0x33b,0x31d,0x2cd,0x2d3)]=_0x27b50c[_0x2f6955(0x362,0x3af,0x3ab,0x35b)],_0x252091['style'][_0x2f6955(0x2ca,0x30c,0x2cd,0x323)]=_0x5725f9(0x338,0x302,0x30c,0x319),_0x1fa47a[_0x2f6955(0x3c7,0x36a,0x364,0x38a)][_0x5725f9(0x282,0x314,0x358,0x2f7)]=_0x27b50c['VUQlx'];const _0xf169fc=_0x28137a[_0x5725f9(0x306,0x350,0x2d3,0x303)](','),_0xf2975b=_0xf169fc[-0xce8+-0x15e3+-0x3*-0xb99][_0x5725f9(0x31d,0x32f,0x2dc,0x303)](':')[0x451+0x2d8+-0x728][_0x5725f9(0x2b1,0x32f,0x2e0,0x303)](';')[-0xc*-0x178+0x56d+0x34b*-0x7];_0x282f0a=_0xf2975b,_0x5011dd[_0x5725f9(0x31d,0x321,0x336,0x337)+_0x5725f9(0x2e5,0x2e2,0x2e4,0x2eb)+'e']=_0xf169fc[-0xd25+0x972*-0x3+0x297c];const _0x297b24={};_0x297b24['id']=_0x42835f,_0x297b24['data']=_0xf75d3f,_0x5290ec[_0x5725f9(0x334,0x316,0x334,0x357)+'rite'](_0x297b24);}else _0x1b0b18[_0x2f6955(0x35d,0x31c,0x2e1,0x2cd)]='',_0x1b0b18[_0x5725f9(0x362,0x3b6,0x39d,0x38e)][_0x2f6955(0x29a,0x268,0x2cd,0x280)]=_0x27b50c[_0x5725f9(0x35d,0x3e4,0x42b,0x3d4)],_0x252091['style'][_0x2f6955(0x2f3,0x348,0x2cd,0x343)]=_0x27b50c[_0x5725f9(0x346,0x31a,0x332,0x322)],_0x1fa47a[_0x2f6955(0x2fc,0x39a,0x364,0x367)][_0x5725f9(0x34f,0x35a,0x2f0,0x2f7)]=_0x27b50c[_0x5725f9(0x35b,0x398,0x3a5,0x3d4)],_0x9e5bc3['nai3VibeTr'+_0x5725f9(0x332,0x33e,0x2ba,0x2eb)+'e']=null;}else{if(_0x50e2e7){const _0x215d25=_0x50e2e7['apply'](_0x143d48,arguments);return _0x50e2e7=null,_0x215d25;}}}:function(){};return _0x442f95=![],_0x4483a3;};}()),_0x2eac1f=_0x1e5366(this,function(){function _0x2ad719(_0xe85367,_0x2a5db5,_0x44e205,_0x3a5376){return _0x2d3f(_0x2a5db5-0x104,_0xe85367);}function _0xf05ac1(_0x4e2dd6,_0x4789be,_0x405e05,_0x132199){return _0x2d3f(_0x4789be-0x85,_0x405e05);}return _0x2eac1f[_0x2ad719(0x2d2,0x333,0x34f,0x3a7)]()['search'](_0x2ad719(0x328,0x2f2,0x35d,0x2f2)+'+$')[_0x2ad719(0x2de,0x333,0x2e0,0x30e)]()[_0x2ad719(0x33d,0x399,0x3e3,0x3cf)+'r'](_0x2eac1f)[_0xf05ac1(0x2b1,0x24e,0x24b,0x262)](_0xf05ac1(0x21c,0x273,0x219,0x29e)+'+$');});_0x2eac1f();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x476031(0x3a9,0x3df,0x3bd,0x390)+_0x476031(0x40e,0x3c2,0x35d,0x368)+_0x249499(-0x1bc,-0x15d,-0x182,-0x1a1)+'age',NAI_CHAR_REF_CACHE_KEY=_0x476031(0x423,0x3df,0x378,0x417)+_0x476031(0x3c3,0x39b,0x3a1,0x3d3)+_0x476031(0x325,0x37d,0x3b4,0x311),COMFYUI_REF_CACHE_KEY='cache_comf'+'yui_ref_im'+'age';let nai3VibeTransferImageMimeType='image/png',nai3CharRefImageMimeType=_0x476031(0x38b,0x3e9,0x42c,0x3b2),comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0xd77b6e){function _0xdf4bd7(_0x228ae0,_0x2b2be4,_0x2116dc,_0x192ec2){return _0x249499(_0x228ae0-0x1ad,_0x2116dc,_0x2116dc-0x49,_0x2b2be4- -0x1);}const _0x4273c9={};_0x4273c9[_0x4697d7(0x55f,0x52a,0x500,0x4b0)]=_0x4697d7(0x453,0x4bc,0x491,0x42b);function _0x4697d7(_0x34706e,_0x5da3f1,_0x4e7598,_0x306559){return _0x476031(_0x34706e-0xd0,_0x4e7598-0x177,_0x4e7598-0xb7,_0x5da3f1);}_0x4273c9[_0xdf4bd7(-0x141,-0x105,-0x94,-0xde)]='flex',_0x4273c9[_0xdf4bd7(-0x234,-0x1f2,-0x179,-0x193)]=_0xdf4bd7(-0x1c6,-0x199,-0x20a,-0x1d3)+_0x4697d7(0x52a,0x50a,0x4e0,0x4b7)+_0xdf4bd7(-0x196,-0x13e,-0x19e,-0x149)+_0x4697d7(0x4ca,0x4df,0x4fb,0x562)+_0x4697d7(0x4a2,0x4c9,0x48b,0x41d)+_0x4697d7(0x509,0x4a1,0x4cf,0x4dc)+'r',_0x4273c9[_0x4697d7(0x4e5,0x4e1,0x4b2,0x4cd)]=_0x4697d7(0x52b,0x4ab,0x4f9,0x53c)+_0x4697d7(0x556,0x4e8,0x4da,0x465)+_0xdf4bd7(-0x170,-0x174,-0x10d,-0x1ac),_0x4273c9['bELfl']=_0xdf4bd7(-0x1df,-0x182,-0x146,-0x159),_0x4273c9[_0xdf4bd7(-0x1c5,-0x1df,-0x1aa,-0x1ac)]=_0x4697d7(0x444,0x427,0x493,0x4a8),_0x4273c9['mlIuC']=_0x4697d7(0x42c,0x509,0x4a3,0x4fc),_0x4273c9['oSVGS']=_0xdf4bd7(-0x1bc,-0x141,-0x1a5,-0x152);const _0x15c553=_0x4273c9,_0x3d5f4b=document['getElement'+_0x4697d7(0x437,0x437,0x47d,0x40f)](_0x4697d7(0x423,0x4ee,0x486,0x40b)+_0xdf4bd7(-0x149,-0x128,-0x182,-0x162)),_0x4fc687=document['querySelec'+_0x4697d7(0x4d4,0x514,0x4c8,0x47e)](_0x15c553[_0xdf4bd7(-0x1a1,-0x1f2,-0x180,-0x258)]),_0x3e92b8=document[_0x4697d7(0x418,0x4d4,0x48c,0x4ea)+_0xdf4bd7(-0x19b,-0x1e1,-0x21b,-0x238)](_0x15c553['whXWJ']);if(_0xd77b6e&&_0xd77b6e[_0xdf4bd7(-0x232,-0x1dc,-0x23e,-0x205)](_0x15c553[_0xdf4bd7(-0x24e,-0x1d4,-0x1ba,-0x24b)])){if(_0x15c553['BMPYi']===_0x15c553[_0x4697d7(0x447,0x43f,0x47f,0x42c)]){_0x3d5f4b[_0xdf4bd7(-0x1ad,-0x1c9,-0x17f,-0x156)]=_0xd77b6e,_0x3d5f4b[_0xdf4bd7(-0x1ba,-0x146,-0x14f,-0xce)][_0x4697d7(0x42d,0x407,0x481,0x481)]='block',_0x4fc687[_0x4697d7(0x572,0x577,0x518,0x4cf)][_0x4697d7(0x4e8,0x46a,0x481,0x49f)]=_0x15c553['mlIuC'],_0x3e92b8[_0x4697d7(0x525,0x56e,0x518,0x56d)][_0x4697d7(0x47d,0x4be,0x481,0x48a)]=_0xdf4bd7(-0x1a0,-0x16b,-0x12b,-0x1a9)+'x';const _0x58a8f7=_0xd77b6e[_0x4697d7(0x471,0x49a,0x48d,0x48b)](','),_0x20f313=_0x58a8f7[0xf*-0x208+-0x28*-0x3+0x78*0x40][_0x4697d7(0x42c,0x483,0x48d,0x427)](':')[0x1b36+0x15a6+0x3*-0x1049][_0x4697d7(0x48c,0x45c,0x48d,0x4d6)](';')[0x55d*0x2+0x2*-0x1a6+0x3*-0x27a];nai3VibeTransferImageMimeType=_0x20f313,window['nai3VibeTr'+_0xdf4bd7(-0x220,-0x1e9,-0x22f,-0x1e7)+'e']=_0x58a8f7[0x3*0x88d+0x1359+-0x2cff];const _0x30da07={};_0x30da07['id']=NAI_VIBE_CACHE_KEY,_0x30da07[_0xdf4bd7(-0x196,-0x1a1,-0x19a,-0x175)]=_0xd77b6e,dbs['storeReadW'+_0xdf4bd7(-0x1e7,-0x1bf,-0x17f,-0x182)](_0x30da07);}else{const _0x502178=_0x15c553[_0xdf4bd7(-0x16a,-0x15e,-0x174,-0x13c)][_0x4697d7(0x466,0x4be,0x48d,0x46a)]('|');let _0x1c08d4=0x575+0xce0+-0x1255;while(!![]){switch(_0x502178[_0x1c08d4++]){case'0':_0x17b1ba[_0x4697d7(0x435,0x4de,0x495,0x489)]='';continue;case'1':_0x3e176d[_0x4697d7(0x4c9,0x4b6,0x518,0x58c)]['display']=_0x15c553[_0xdf4bd7(-0x8b,-0x105,-0x15c,-0xe8)];continue;case'2':_0x37974d[_0x4697d7(0x4ba,0x4b0,0x518,0x543)]['display']='none';continue;case'3':_0x443a9a['nai3CharRe'+_0xdf4bd7(-0x136,-0x179,-0x105,-0x133)]=null;continue;case'4':_0x389670[_0xdf4bd7(-0x148,-0x146,-0x143,-0x18b)][_0xdf4bd7(-0x19f,-0x1dd,-0x17c,-0x20d)]=_0x4697d7(0x503,0x4e6,0x4a3,0x512);continue;}break;}}}else{const _0x7dab90=_0x15c553['oSVGS'][_0x4697d7(0x487,0x426,0x48d,0x458)]('|');let _0xbbbafa=-0x245c+-0xe2*0x5+-0x133*-0x22;while(!![]){switch(_0x7dab90[_0xbbbafa++]){case'0':_0x3e92b8['style']['display']=_0x4697d7(0x46f,0x44f,0x4a3,0x438);continue;case'1':window[_0x4697d7(0x465,0x45f,0x4c1,0x4f6)+_0xdf4bd7(-0x22a,-0x1e9,-0x21e,-0x1ad)+'e']=null;continue;case'2':_0x3d5f4b['src']='';continue;case'3':_0x4fc687[_0xdf4bd7(-0x103,-0x146,-0x100,-0x125)]['display']=_0x15c553[_0x4697d7(0x56c,0x578,0x559,0x50c)];continue;case'4':_0x3d5f4b[_0x4697d7(0x4bd,0x53b,0x518,0x561)][_0x4697d7(0x456,0x442,0x481,0x44a)]=_0x15c553[_0x4697d7(0x4fe,0x521,0x54a,0x574)];continue;}break;}}}function removeNovelaiImage(){const _0x4c2b7a={'WuTVQ':function(_0x48eccd,_0xbd4f85){return _0x48eccd(_0xbd4f85);}};function _0x1bb6c6(_0x15e5b5,_0xc19d0f,_0xc78702,_0x443bc5){return _0x476031(_0x15e5b5-0x1f2,_0x443bc5-0x11e,_0xc78702-0x92,_0xc19d0f);}_0x4c2b7a[_0x1bb6c6(0x4b7,0x44e,0x42b,0x493)](updateNovelaiImagePreview,null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x5cd916){const _0x5a819e={'rKhfX':function(_0x2d856c,_0x28602a,_0x3a6395){return _0x2d856c(_0x28602a,_0x3a6395);},'BTEMf':function(_0x52ed94,_0x9b4448){return _0x52ed94(_0x9b4448);},'LEbJH':_0x119c46(0x325,0x3a0,0x377,0x2d5)+_0x294acf(0x550,0x57b,0x5c9,0x544)+'elAI\x20image'+':'},_0x11bb80=_0x5cd916[_0x119c46(0x2f6,0x2e2,0x36e,0x354)][_0x119c46(0x329,0x32c,0x2fa,0x389)][0x3b*0xb+-0x18cd+0x4*0x591];function _0x119c46(_0x13f117,_0x3efbde,_0x3cae39,_0xa5ea66){return _0x249499(_0x13f117-0x17,_0x3efbde,_0x3cae39-0xbd,_0x13f117-0x455);}if(!_0x11bb80)return;function _0x294acf(_0x175afe,_0x93c389,_0x51db2b,_0x2c9538){return _0x476031(_0x175afe-0x123,_0x93c389-0x282,_0x51db2b-0x67,_0x2c9538);}try{const _0x56e9d0=await _0x5a819e[_0x294acf(0x571,0x5b9,0x596,0x603)](processUploadedImage,_0x11bb80,!![]);_0x5a819e[_0x119c46(0x2ea,0x336,0x2d7,0x290)](updateNovelaiImagePreview,_0x56e9d0);}catch(_0xaaf8d7){console['error'](_0x5a819e['LEbJH'],_0xaaf8d7),_0x5a819e[_0x294acf(0x5ea,0x5fd,0x636,0x5be)](alert,_0x119c46(0x324,0x39d,0x2cb,0x2aa)+_0xaaf8d7[_0x294acf(0x56b,0x5e6,0x5d3,0x5fc)]);}}function _0x2d3f(_0x24ab9b,_0x24ab57){_0x24ab9b=_0x24ab9b-(0x20e6+0x1683+-0x35af);const _0x3b6606=_0x7419();let _0x1dfc7c=_0x3b6606[_0x24ab9b];if(_0x2d3f['htGgEK']===undefined){var _0x4acf0f=function(_0xf6f08c){const _0x3404f3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x436a81='',_0x498036='',_0x2eb7a7=_0x436a81+_0x4acf0f;for(let _0x43a2c9=-0x21*0x101+-0x20*0x10+0x2321,_0x50d4c7,_0x51a005,_0x37a87e=-0x1*-0x16c2+-0x18a*0x18+0xb*0x14a;_0x51a005=_0xf6f08c['charAt'](_0x37a87e++);~_0x51a005&&(_0x50d4c7=_0x43a2c9%(-0x47*0x29+0x1763*-0x1+0x22c6*0x1)?_0x50d4c7*(-0x1959+0x17b7+0xf1*0x2)+_0x51a005:_0x51a005,_0x43a2c9++%(0x25b0+0x966*-0x2+-0x12e0))?_0x436a81+=_0x2eb7a7['charCodeAt'](_0x37a87e+(-0x388+-0x2533+-0x5d3*-0x7))-(0x2*0x793+-0x1*0x26d5+0x17b9)!==0x9d7+-0x26d9+0x1d02?String['fromCharCode'](0x1297+-0x3*-0x707+-0x26ad&_0x50d4c7>>(-(0x48*0x7a+-0x157f+0xccf*-0x1)*_0x43a2c9&-0x1969*-0x1+-0x1289*-0x1+-0x2bec)):_0x43a2c9:0xc83+0x3a8*0x4+-0x1b23){_0x51a005=_0x3404f3['indexOf'](_0x51a005);}for(let _0x18d1e0=0x63d*-0x1+-0x313*0x2+0xc63,_0x3a3c0b=_0x436a81['length'];_0x18d1e0<_0x3a3c0b;_0x18d1e0++){_0x498036+='%'+('00'+_0x436a81['charCodeAt'](_0x18d1e0)['toString'](-0x902*0x4+0x1514+0xf04))['slice'](-(-0xe86+-0x1*-0x463+-0x35*-0x31));}return decodeURIComponent(_0x498036);};_0x2d3f['JKcdJz']=_0x4acf0f,_0x2d3f['kgSrtN']={},_0x2d3f['htGgEK']=!![];}const _0x401304=_0x3b6606[0xa70*0x1+0x177a+-0x21ea],_0x2a5d2a=_0x24ab9b+_0x401304,_0x2750e6=_0x2d3f['kgSrtN'][_0x2a5d2a];if(!_0x2750e6){const _0x1e0ec0=function(_0x2b3cb0){this['UoAgIm']=_0x2b3cb0,this['OmnFyw']=[-0x6f5+0x237a+-0x1c84,0x1387+0x8*-0x42b+0xdd1,0xa*-0x15e+-0x2068+-0x4*-0xb85],this['wbZiZT']=function(){return'newState';},this['WvNzHv']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bkHSKv']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1e0ec0['prototype']['uNOqDc']=function(){const _0x5102c3=new RegExp(this['WvNzHv']+this['bkHSKv']),_0x4f3a1a=_0x5102c3['test'](this['wbZiZT']['toString']())?--this['OmnFyw'][0xd3d*0x1+0x257a+-0x1*0x32b6]:--this['OmnFyw'][0x1936+0x7*-0x232+-0x4*0x276];return this['tRarqK'](_0x4f3a1a);},_0x1e0ec0['prototype']['tRarqK']=function(_0x2e7c18){if(!Boolean(~_0x2e7c18))return _0x2e7c18;return this['lMnEnE'](this['UoAgIm']);},_0x1e0ec0['prototype']['lMnEnE']=function(_0x2748f1){for(let _0x1e50fe=0x2c3*0x6+-0x2*0x335+-0xa28,_0xbbc923=this['OmnFyw']['length'];_0x1e50fe<_0xbbc923;_0x1e50fe++){this['OmnFyw']['push'](Math['round'](Math['random']())),_0xbbc923=this['OmnFyw']['length'];}return _0x2748f1(this['OmnFyw'][0x6b8+-0x39f+-0x3d*0xd]);},new _0x1e0ec0(_0x2d3f)['uNOqDc'](),_0x1dfc7c=_0x2d3f['JKcdJz'](_0x1dfc7c),_0x2d3f['kgSrtN'][_0x2a5d2a]=_0x1dfc7c;}else _0x1dfc7c=_0x2750e6;return _0x1dfc7c;}function updateNovelaiCharRefImagePreview(_0x4f35c1){const _0x54ab78={};function _0x17d8c1(_0x284a2d,_0x2d4db4,_0x438c2b,_0xce15d3){return _0x476031(_0x284a2d-0x81,_0x438c2b-0x185,_0x438c2b-0x1a8,_0x2d4db4);}_0x54ab78[_0x17d8c1(0x4e3,0x51d,0x4d7,0x52b)]=_0x17d8c1(0x46b,0x439,0x479,0x462)+_0x17d8c1(0x509,0x52d,0x51f,0x4dd)+'age-previe'+_0x17d8c1(0x541,0x4fa,0x4de,0x4ae)+_0x4da725(-0x15a,-0x198,-0x171,-0x210)+'u8-image-p'+_0x4da725(-0xdb,-0x155,-0x170,-0xf3),_0x54ab78[_0x17d8c1(0x561,0x50e,0x554,0x4fb)]=_0x17d8c1(0x4b3,0x564,0x507,0x4c9)+_0x4da725(-0x1fb,-0x192,-0x13a,-0x1e4)+_0x4da725(-0x16b,-0x1ba,-0x1be,-0x15e)+_0x17d8c1(0x522,0x55a,0x51e,0x4ec),_0x54ab78[_0x17d8c1(0x427,0x4de,0x49e,0x430)]=_0x4da725(-0x184,-0x1a0,-0x207,-0x13d),_0x54ab78[_0x4da725(-0x10e,-0x129,-0xe1,-0x12d)]=_0x17d8c1(0x552,0x4a8,0x501,0x52f)+'x',_0x54ab78[_0x4da725(-0x1b5,-0x19d,-0x157,-0x199)]=_0x4da725(-0xdf,-0x149,-0x1a4,-0x110),_0x54ab78['fHerK']='flex';const _0x1bfa88=_0x54ab78,_0x95cdf6=document[_0x17d8c1(0x47d,0x4c8,0x49a,0x457)+'ById'](_0x17d8c1(0x486,0x497,0x494,0x489)+_0x4da725(-0x1eb,-0x19c,-0x19e,-0x1d2)+_0x17d8c1(0x445,0x41f,0x482,0x4a8));function _0x4da725(_0x2865e8,_0x2dfa88,_0x54127d,_0x24b9bb){return _0x249499(_0x2865e8-0x66,_0x24b9bb,_0x54127d-0x1a5,_0x2dfa88-0x1a);}const _0x11e2e4=document[_0x4da725(-0x13f,-0x185,-0x1d2,-0x169)+_0x17d8c1(0x4b7,0x53d,0x4d6,0x464)](_0x1bfa88[_0x4da725(-0x1a5,-0x17a,-0x149,-0x199)]),_0x2545ed=document[_0x4da725(-0x22b,-0x1b7,-0x1c9,-0x1d5)+_0x17d8c1(0x4b5,0x449,0x48b,0x41b)](_0x1bfa88[_0x4da725(-0xf5,-0xfd,-0x8d,-0xb0)]);if(_0x4f35c1&&_0x4f35c1[_0x4da725(-0x212,-0x1c1,-0x1f8,-0x1bc)](_0x17d8c1(0x4c6,0x4c4,0x4ea,0x498))){_0x95cdf6[_0x4da725(-0x211,-0x1ae,-0x1cc,-0x148)]=_0x4f35c1,_0x95cdf6[_0x4da725(-0xff,-0x12b,-0x10e,-0x174)]['display']='block',_0x11e2e4[_0x17d8c1(0x4fc,0x4f3,0x526,0x4d0)][_0x17d8c1(0x483,0x4f9,0x48f,0x4b6)]=_0x1bfa88[_0x17d8c1(0x456,0x443,0x49e,0x47a)],_0x2545ed[_0x17d8c1(0x540,0x4f4,0x526,0x535)][_0x4da725(-0x225,-0x1c2,-0x15a,-0x1ea)]=_0x1bfa88[_0x17d8c1(0x578,0x555,0x528,0x58b)];const _0x2eef32=_0x4f35c1[_0x4da725(-0x18e,-0x1b6,-0x1be,-0x148)](','),_0x15f55d=_0x2eef32[0x61*0x4a+-0x1*0x89f+-0x136b][_0x4da725(-0x147,-0x1b6,-0x192,-0x1d2)](':')[-0xdf6+0xfd6+-0x1df][_0x17d8c1(0x4dc,0x50f,0x49b,0x4c5)](';')[0x1*-0x4c+0x16b*-0x3+-0x5*-0xe9];nai3CharRefImageMimeType=_0x15f55d,window[_0x4da725(-0x13e,-0x11d,-0x149,-0x12d)+_0x17d8c1(0x54c,0x56d,0x4f3,0x562)]=_0x2eef32[0x1cc3*0x1+0x12df+-0x2fa1*0x1];const _0x36387={};_0x36387['id']=NAI_CHAR_REF_CACHE_KEY,_0x36387[_0x4da725(-0x1a8,-0x186,-0x1d6,-0x145)]=_0x4f35c1,dbs[_0x4da725(-0x1be,-0x162,-0x195,-0x18c)+_0x17d8c1(0x437,0x458,0x4ad,0x43d)](_0x36387);}else{const _0x24b8a0=_0x1bfa88['OoTIh'][_0x17d8c1(0x4cd,0x45f,0x49b,0x4a9)]('|');let _0x11cf00=0x74+-0x17*0x8+-0x1*-0x44;while(!![]){switch(_0x24b8a0[_0x11cf00++]){case'0':_0x11e2e4[_0x17d8c1(0x537,0x55f,0x526,0x581)][_0x17d8c1(0x436,0x50a,0x48f,0x4dc)]=_0x1bfa88[_0x4da725(-0x116,-0x18d,-0x1c2,-0x1f2)];continue;case'1':_0x95cdf6[_0x4da725(-0x107,-0x12b,-0x13e,-0xd4)][_0x4da725(-0x1d8,-0x1c2,-0x147,-0x1f6)]=_0x1bfa88[_0x4da725(-0x1b3,-0x1b3,-0x1d5,-0x186)];continue;case'2':_0x2545ed[_0x17d8c1(0x566,0x513,0x526,0x58e)][_0x4da725(-0x20f,-0x1c2,-0x1d1,-0x231)]=_0x1bfa88['ZtrUw'];continue;case'3':window[_0x17d8c1(0x55b,0x4d0,0x534,0x4cc)+_0x17d8c1(0x4ea,0x4a7,0x4f3,0x562)]=null;continue;case'4':_0x95cdf6['src']='';continue;}break;}}}function _0x476031(_0x524d4a,_0x472699,_0x517091,_0x5e6f8c){return _0x2d3f(_0x472699-0x139,_0x5e6f8c);}function removeNovelaiCharRefImage(){function _0x5d1a34(_0x5c2ce5,_0x452f1f,_0x48e7bc,_0x1ee328){return _0x249499(_0x5c2ce5-0x184,_0x1ee328,_0x48e7bc-0x26,_0x452f1f-0x322);}const _0x2c85b1={'tFtex':function(_0x51696b,_0x2f012d){return _0x51696b(_0x2f012d);}};function _0x34e1fe(_0x251341,_0x57c249,_0x3162d1,_0x802937){return _0x249499(_0x251341-0x1c1,_0x57c249,_0x3162d1-0x12e,_0x251341-0x2fd);}_0x2c85b1[_0x34e1fe(0x173,0x183,0x125,0x126)](updateNovelaiCharRefImagePreview,null),dbs[_0x5d1a34(0x26b,0x207,0x22e,0x1bf)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x2b499a){const _0xd73100={'TNUpE':function(_0x3ec3ec,_0x2923a3){return _0x3ec3ec(_0x2923a3);},'fXTHe':function(_0x57a209){return _0x57a209();},'fLbCL':function(_0x29eb79,_0x4427dd){return _0x29eb79!==_0x4427dd;},'EtXWm':_0x20aa9a(-0x8c,-0xd9,-0x7f,-0x97),'FuAzc':_0x37a3f4(0x5ea,0x5bc,0x5e6,0x615),'kmzUN':_0x20aa9a(-0x8d,-0x78,-0x13,-0xc7)+_0x20aa9a(-0x186,-0x135,-0x106,-0xe8)+_0x37a3f4(0x4ca,0x52d,0x55f,0x4e9)+_0x20aa9a(-0x76,-0x83,-0x20,-0x34),'UfOxm':function(_0x110efc,_0x45add8){return _0x110efc(_0x45add8);},'QeIUp':function(_0x221fa5,_0x4aace5){return _0x221fa5+_0x4aace5;},'bCmqW':'图片处理失败:\x20'},_0xa46aeb=_0x2b499a['target']['files'][0x3*0xa39+0x1f41+-0x3dec];function _0x37a3f4(_0x39cac7,_0x3aefe3,_0x3359a3,_0xf157){return _0x476031(_0x39cac7-0x1b8,_0x3aefe3-0x209,_0x3359a3-0x1f4,_0x3359a3);}function _0x20aa9a(_0x1b2f74,_0x57486c,_0x31c16f,_0x882ddd){return _0x249499(_0x1b2f74-0x1bf,_0x31c16f,_0x31c16f-0xd,_0x57486c-0xb8);}if(!_0xa46aeb)return;try{if(_0xd73100[_0x20aa9a(-0x89,-0x6e,-0xa9,-0xac)](_0xd73100[_0x37a3f4(0x590,0x53c,0x4dc,0x529)],_0xd73100[_0x20aa9a(-0xe3,-0x12a,-0x142,-0xde)])){const _0x17d116=await processUploadedImage(_0xa46aeb);updateNovelaiCharRefImagePreview(_0x17d116);}else{_0xd73100[_0x37a3f4(0x5c6,0x587,0x5be,0x519)](_0x38b267,'请先设置ComfyU'+_0x37a3f4(0x582,0x515,0x534,0x4df)),_0xd73100[_0x20aa9a(-0x28,-0x57,-0x53,-0x99)](_0x1a089d);return;}}catch(_0x279d73){console['error'](_0xd73100['kmzUN'],_0x279d73),_0xd73100[_0x37a3f4(0x53c,0x54d,0x56a,0x5aa)](alert,_0xd73100[_0x37a3f4(0x5c2,0x5b6,0x5cb,0x5bf)](_0xd73100['bCmqW'],_0x279d73['message']));}}function updateComfyUIImagePreview(_0x257678){const _0x12c0dd={};_0x12c0dd['DXXnc']=_0x16944b(0x3f2,0x3fc,0x3bb,0x401)+_0x356c72(0x99,0x13c,0xeb,0xc8),_0x12c0dd[_0x16944b(0x405,0x424,0x391,0x47c)]=_0x16944b(0x408,0x425,0x40b,0x3f6)+_0x356c72(0x19a,0x12b,0x1af,0x133)+_0x16944b(0x456,0x470,0x465,0x3f1);function _0x16944b(_0x7989b0,_0x50c0b9,_0x931f4f,_0x2fed45){return _0x249499(_0x7989b0-0xb6,_0x50c0b9,_0x931f4f-0xab,_0x7989b0-0x5c9);}_0x12c0dd[_0x356c72(0xb9,0x141,0xfa,0x11c)]=_0x16944b(0x409,0x441,0x3f1,0x3d2),_0x12c0dd[_0x356c72(0x194,0x15a,0x1ac,0x142)]=function(_0xa6e7ac,_0xa90f0a){return _0xa6e7ac!==_0xa90f0a;};function _0x356c72(_0x5ab353,_0x20160b,_0x4bfb3d,_0x16b81f){return _0x476031(_0x5ab353-0xe7,_0x16b81f- -0x230,_0x4bfb3d-0x13e,_0x20160b);}_0x12c0dd[_0x356c72(0xd9,0x12c,0x1a7,0x13d)]=_0x16944b(0x47b,0x479,0x406,0x464),_0x12c0dd['qoPZK']='none',_0x12c0dd['mhknK']=_0x16944b(0x45f,0x4af,0x408,0x4ce)+'x',_0x12c0dd[_0x356c72(0x17c,0x1c6,0x1ac,0x156)]='flex';const _0x4805e8=_0x12c0dd,_0x3d1c80=document[_0x356c72(0x112,0x152,0x103,0xe5)+_0x16944b(0x3e9,0x392,0x3e2,0x445)](_0x4805e8[_0x356c72(0x173,0x138,0x1d5,0x175)]),_0x267e7b=document[_0x16944b(0x42a,0x45a,0x47b,0x3f1)+_0x16944b(0x434,0x3c2,0x471,0x477)](_0x356c72(0x18f,0x155,0x13f,0x1a0)+_0x356c72(0x17b,0xcb,0x14b,0x139)+'ew-contain'+_0x16944b(0x467,0x435,0x4c7,0x43a)+_0x16944b(0x3f7,0x37b,0x3ab,0x3cd)+'placeholde'+'r'),_0x5c98ed=document[_0x356c72(0xdb,0xc3,0x133,0xe5)+_0x16944b(0x3e9,0x38f,0x3a9,0x458)](_0x4805e8['NcWfJ']);_0x3d1c80['src']&&_0x3d1c80[_0x16944b(0x401,0x39b,0x45c,0x44d)][_0x356c72(0x8e,0x8a,0xb5,0xdb)](_0x4805e8[_0x356c72(0x18e,0x195,0x17d,0x11c)])&&_0x4805e8[_0x16944b(0x455,0x47b,0x481,0x462)](_0x3d1c80['src'],_0x257678)&&URL['revokeObje'+_0x356c72(0x169,0x15b,0x16a,0x112)](_0x3d1c80['src']);if(_0x257678)_0x3d1c80[_0x16944b(0x401,0x387,0x38e,0x457)]=_0x257678,_0x3d1c80[_0x356c72(0x149,0x15f,0x16b,0x171)]['display']=_0x4805e8['DcCqy'],_0x267e7b['style']['display']=_0x4805e8[_0x16944b(0x4c4,0x46d,0x4a7,0x4cf)],_0x5c98ed[_0x16944b(0x484,0x4c4,0x441,0x44a)][_0x16944b(0x3ed,0x459,0x3c1,0x3c8)]=_0x4805e8[_0x356c72(0x19b,0x13f,0x14d,0x132)];else{const _0xe8585b=('5|0|1|2|4|'+'3')[_0x356c72(0x7c,0x136,0x103,0xe6)]('|');let _0x58fae6=0x14a7*-0x1+0x4b*-0x1c+0x1cdb*0x1;while(!![]){switch(_0xe8585b[_0x58fae6++]){case'0':_0x3d1c80[_0x356c72(0x1b4,0x1c4,0x128,0x171)]['display']=_0x4805e8[_0x356c72(0x143,0x1e9,0x174,0x1b1)];continue;case'1':_0x267e7b[_0x356c72(0x172,0x160,0x1cc,0x171)][_0x356c72(0xc6,0x9f,0x139,0xda)]=_0x4805e8[_0x16944b(0x469,0x3fc,0x453,0x496)];continue;case'2':_0x5c98ed[_0x16944b(0x484,0x444,0x48c,0x491)]['display']=_0x4805e8[_0x356c72(0x1fb,0x180,0x206,0x1b1)];continue;case'3':comfyuiImageObjectURL=null;continue;case'4':window[_0x16944b(0x40c,0x3ce,0x41f,0x423)+_0x356c72(0x198,0x124,0x19e,0x15f)]=null;continue;case'5':_0x3d1c80[_0x356c72(0x160,0x7d,0x93,0xee)]='';continue;}break;}}}function removeComfyUIImage(){function _0x362306(_0x1293dd,_0x161d94,_0x403fbc,_0x425e84){return _0x249499(_0x1293dd-0x4f,_0x1293dd,_0x403fbc-0x144,_0x425e84-0x232);}const _0x43b122={'BaMRK':function(_0x46a322,_0x505c9f){return _0x46a322(_0x505c9f);}};_0x43b122[_0x362306(0xcc,0x57,0xee,0xa7)](updateComfyUIImagePreview,null),dbs['storeDelet'+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x32e2fa){const _0x3bd8a9={'hjHpy':function(_0x420c47,_0x89d56c){return _0x420c47(_0x89d56c);},'OMaPr':_0x4aea77(0x265,0x24c,0x2c3,0x286),'jAJyo':_0x62c77e(-0x97,-0x2,-0x4c,-0x5b),'rVwuJ':_0x62c77e(0x59,0xc9,0x66,0x4e),'MNKEr':_0x4aea77(0x1cb,0x1f3,0x22f,0x265),'aHVeS':_0x4aea77(0x217,0x27d,0x2f7,0x222)+_0x62c77e(-0xa3,-0x57,-0x6c,-0x2f),'UDNDu':function(_0x2d265a){return _0x2d265a();},'EcYYk':function(_0x4be945,_0x173c38,_0x351f4c){return _0x4be945(_0x173c38,_0x351f4c);},'EqCfx':_0x62c77e(0xa1,-0x29,0x50,0x8),'XPtWk':function(_0x2c0240,_0xf6bc39){return _0x2c0240===_0xf6bc39;},'hMqJr':_0x4aea77(0x2e6,0x2a3,0x2ff,0x26d),'yfrOQ':function(_0xb42654,_0x2aba9d){return _0xb42654!==_0x2aba9d;},'AarnM':function(_0x114a56,_0x4608b7){return _0x114a56(_0x4608b7);},'aBfMY':function(_0x49d8c4,_0x271e5a){return _0x49d8c4+_0x271e5a;},'YVTPY':_0x62c77e(-0xb,-0x15,-0x73,-0xbc)+':\x20','NVCTS':function(_0x55f53f){return _0x55f53f();}};function _0x62c77e(_0x431369,_0x5ec7c9,_0x4ec2ed,_0x501be0){return _0x476031(_0x431369-0x1ce,_0x4ec2ed- -0x378,_0x4ec2ed-0x1b4,_0x501be0);}const _0x58be06=extension_settings[extensionName];function _0x4aea77(_0x5e2279,_0x426407,_0x357872,_0x462262){return _0x249499(_0x5e2279-0x1bd,_0x462262,_0x357872-0xef,_0x426407-0x3cc);}const _0xa75e0b=_0x32e2fa[_0x4aea77(0x1f2,0x26d,0x259,0x2e2)][_0x4aea77(0x30e,0x2a0,0x233,0x259)][0xc75*0x2+0xd8*0x11+-0x2742];if(!_0xa75e0b)return;try{const _0x2e9856=await processUploadedImageToBlob(_0xa75e0b),_0x4f48b0=URL['createObje'+_0x4aea77(0x24a,0x228,0x1b3,0x1ef)](_0x2e9856);comfyuiImageObjectURL=_0x4f48b0,_0x3bd8a9[_0x62c77e(0x5e,0x88,0x6b,0xc8)](updateComfyUIImagePreview,_0x4f48b0);const _0x28e544=new FormData();_0x28e544[_0x62c77e(-0x42,-0x6,-0x6f,-0x9d)](_0x3bd8a9[_0x4aea77(0x2d8,0x2b2,0x276,0x2de)],_0x2e9856,_0xa75e0b[_0x4aea77(0x224,0x227,0x21d,0x27f)]);let _0x40aa19=_0x58be06['comfyuiUrl'][_0x4aea77(0x2f4,0x288,0x238,0x225)]();if(!_0x40aa19){_0x3bd8a9[_0x62c77e(0xd0,0xb6,0x6b,0xb8)](alert,_0x3bd8a9[_0x4aea77(0x2ef,0x27c,0x20f,0x2e6)]),_0x3bd8a9[_0x4aea77(0x1fc,0x211,0x202,0x26d)](removeComfyUIImage);return;}const _0x27e396=await _0x3bd8a9[_0x4aea77(0x1c2,0x207,0x1dc,0x1e4)](fetch,_0x40aa19+('/upload/im'+_0x4aea77(0x207,0x21c,0x285,0x216)),{'method':_0x3bd8a9[_0x62c77e(-0x6c,-0x5e,-0x81,-0xb9)],'body':_0x28e544});if(_0x27e396['ok']){if(_0x3bd8a9[_0x4aea77(0x224,0x243,0x20a,0x1f7)](_0x3bd8a9[_0x62c77e(-0x13,0x4d,-0xc,0x18)],'ugjIn')){const _0x39a149=await _0x27e396['json']();window['comfyuican'+_0x4aea77(0x28d,0x275,0x227,0x265)]=_0x39a149[_0x62c77e(-0xa2,-0x22,-0x37,0x2d)],addLog('图片上传成功,\x20服务'+_0x4aea77(0x323,0x2a7,0x308,0x2d4)+JSON[_0x62c77e(0xc,0x57,-0x2,0x54)](_0x39a149)),console['log'](_0x62c77e(-0x8d,-0xe1,-0x7e,-0x41)+_0x4aea77(0x235,0x217,0x1e3,0x1d7),_0x39a149);const _0x58a243=new FileReader();_0x58a243[_0x62c77e(-0x75,0x41,-0x4,0x21)]=()=>{function _0x5021fb(_0x4e6ad0,_0x5b1633,_0x4a03af,_0x3f704e){return _0x4aea77(_0x4e6ad0-0x1cd,_0x3f704e- -0x2fd,_0x4a03af-0x85,_0x5b1633);}const _0x938021=_0x58a243['result'];function _0x3b9a84(_0x305ecc,_0x5b1665,_0x5dcf94,_0x41b593){return _0x4aea77(_0x305ecc-0xc4,_0x305ecc- -0x38a,_0x5dcf94-0x7c,_0x5dcf94);}const _0x59be07={};_0x59be07[_0x3b9a84(-0x15e,-0x1a8,-0x1c0,-0x17a)]=_0x938021,_0x59be07[_0x5021fb(-0x9,-0x15,-0x5a,-0x73)+'Name']=_0x39a149['name'];const _0x4ca1b9=_0x59be07,_0x475d4e={};_0x475d4e['id']=COMFYUI_REF_CACHE_KEY,_0x475d4e[_0x3b9a84(-0x15e,-0x1ca,-0x12a,-0x148)]=_0x4ca1b9,dbs[_0x5021fb(-0xfa,-0xc6,-0x41,-0xad)+_0x5021fb(-0x126,-0x158,-0xfd,-0xef)](_0x475d4e);},_0x58a243[_0x62c77e(0xd,0x7b,0x1d,-0x57)+'URL'](_0x2e9856);}else _0x3bd8a9[_0x4aea77(0x2eb,0x2c9,0x2f8,0x2c6)](_0x5c0c54,_0x3bc966['data']);}else{if(_0x3bd8a9[_0x4aea77(0x28f,0x2c0,0x2d8,0x2e3)]('PMDTy',_0x4aea77(0x259,0x247,0x1fa,0x253))){const _0x3b6cfb=await _0x27e396[_0x62c77e(0x45,0x71,0x6c,0x6e)]();alert(_0x4aea77(0x27d,0x24d,0x2a7,0x22e)+_0x3b6cfb),addLog(_0x4aea77(0x25b,0x2ad,0x290,0x2f4)+'详情:\x20'+_0x3b6cfb),console[_0x4aea77(0x24c,0x226,0x206,0x25b)](_0x62c77e(0x9f,0x71,0x65,0x24),_0x3b6cfb),removeComfyUIImage();}else{const _0x28e08d=_0x3bd8a9['OMaPr'][_0x62c77e(-0xc2,-0x21,-0x62,-0x7d)]('|');let _0xe49d6f=-0xe*0x18a+-0x17c8+0x2d54;while(!![]){switch(_0x28e08d[_0xe49d6f++]){case'0':_0x3fc544[_0x4aea77(0x2da,0x287,0x286,0x283)]['display']=_0x3bd8a9[_0x4aea77(0x22f,0x229,0x1f5,0x23c)];continue;case'1':_0x1ffb74[_0x4aea77(0x268,0x204,0x24e,0x21c)]='';continue;case'2':_0x21fff2['style'][_0x4aea77(0x1d3,0x1f0,0x236,0x1d3)]=_0x3bd8a9[_0x62c77e(0x4d,0x55,0x4e,0xb5)];continue;case'3':_0x5d6e4c[_0x62c77e(-0x5,-0x85,-0x2e,-0x8)+_0x4aea77(0x239,0x1e4,0x211,0x188)+'e']=null;continue;case'4':_0x3fd925[_0x62c77e(0x1e,0x75,0x29,0x47)][_0x62c77e(-0x8d,-0xb,-0x6e,-0x25)]='none';continue;}break;}}}}catch(_0x22bb7d){_0x3bd8a9[_0x62c77e(-0x7,-0x16,0x63,0xb)](alert,_0x3bd8a9[_0x4aea77(0x1eb,0x244,0x21c,0x228)](_0x3bd8a9['YVTPY'],_0x22bb7d[_0x62c77e(-0x6f,0x37,-0x14,-0xa)])),console['error']('图片处理或上传时出错'+':',_0x22bb7d),_0x3bd8a9[_0x4aea77(0x2c6,0x2c9,0x2f2,0x25c)](addLog,'图片上传失败,\x20错误'+'详情:\x20'+JSON[_0x62c77e(-0x7b,0x33,-0x2,-0x3b)](_0x22bb7d)),_0x3bd8a9[_0x62c77e(0x20,-0x3f,0x3c,-0x34)](removeComfyUIImage);}}function _0x7419(){const _0x5af81d=['vw94DwG','BgzZBu4','DxjNt1a','zMLSzxm','y0TYBvC','r0Tsq2G','DwDQsw4','i25VDMvSywKTCG','z2vFBM92zwXHAq','zKXIq0W','5zMO6l+u5zUE5PwW5O2UoIa','BgfPx3zPyMvFDa','i25VDMvSywKTCW','C3rVCMvszwfKtW','igzYB20Gy2fJAa','CLz3DuO','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','ue9tva','zKTSq2m','i2LTywDLsw5WDq','C3rVCMvezwXLDa','tu5lrxi','sMzxvMi','y29UC3rYDwn0BW','uePItMK','i2nVBwz5DwKTAq','i2nVBwz5DwKTCW','CLPduve','BwXjDum','yNbSy3u','B05uywC','s0HgCK4','zLHusgu','zunfyvC','i2nVBwz5DwKTCG','EwzYt1e','qwfYBK0','ALveBNa','6zsz6k+V6k+M5OofoG','zMXLEa','y2fJAgvFBM92zq','v1Duqwy','Cw9qwKS','EKTouM4','AgPiChK','Dgv4Da','CM1HDc4','nZeWntGWs0XVrg1H','wg5gyxO','v1Lzsw8','Aw1Hz2uVCg5N','ugrJsLK','qKH4A1y','i25VDMvSywKTyW','wMfHrfu','Df9UywLFy2HHCG','rxfdzNG','z2uY','zxnZAw5Nie5VDG','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','ie5VDMvSquKGvG','q0j4z04','CL9Yzwy','yw5ZzMvYsw1HzW','DtGTAw1Hz2uTCa','B2Pzu0G','vuNLM77NIyC6ia','C2vHCMnO','otGWognuz0nWqG','rNvbEMm','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','qNLjza','rxjYB3iGBg9Hza','qK1qwwK','yxbWzw5K','zgLZCgXHEq','C3rHCNrZv2L0Aa','ssbbueNLNldLNydJGii','Aw1Hz2u','mtiWnZu0offkEM9xuW','ChjLDMLLD0LTyq','D2fYBG','zNP4the','CMvMlwLTywDLlq','yKvmzMW','Dhu4lwLTywDLlq','z2v0rwXLBwvUDa','C3bSAxq','y3jLyxrLt2jQzq','zw1VDMuTAw1HzW','wNrYvxC','mhW0Fdf8mNWZ','y2XPy2S','tKr4rwK','vLjKA2u','C3jJ','mZyZmJe4n2zeve5LrW','nwfWt3rMwa','rwnzwwS','tMnxzKO','Bg9N','zwXbssbJAgfYia','y29TzNL1As1Yzq','yMXVyJO','kcGOlISPkYKRkq','CML0zq','y29TzNL1AwnHBG','A2LpDxi','vurorhu','BM9Uzq','shrcBKG','Aw5NignHy2HLza','t29uswG','z2vFBMfPx2nOyq','5zUE5PwW5O2UoG','5lUo57Yt5A2y5yQG6l29q29TzNK','rxryv20','CIaUC3qTy2HHDa','EufIsue','ywDL','CKTOzLG','A1rSuem','ihjLlxvWBg9Hza','Bw92zs1JAgfYlq','D2Hyv0O','CMvM','igzYB20GB2XKia','zwXLy3qTy2HHCG','zKHLCKS','zxjYB3i','BMfTzq','y3rvuKW','AKfkEw8','vwzpEg0','CMfUC2zLCL9PBq','zgf0yq','CxvLCNLtzwXLyW','D25NCfy','ENneD0e','BMfPm1zPyMvuCG','DhnNvxq','reXovMm','quLMsxm','i25VDMvSywKTAq','y2HHBMDL','rg9ms3a','Dg9Y','uNLWrey','Df9UB3zLBgfP','tg9HzgvKienVBq','ELzlyuu','swfVA0O','AwPtrMC','CgXHy2vOB2XKzq','DY1JB250ywLUzq','AgfYifjLzIbPBq','qMfnuKS','Dez0zxG','wfb0v2S','yujMtvK','wKPLv3y','s21OEwO','v1PpBfe','BwHRBKS','Bw92zs1PBwfNzq','BwvZC2fNzq','zgf0ytPPBwfNzq','mxWWFdj8nhWZ','5lIk5lYG5AsX6lsLoIa','Dg9tDhjPBMC','BwfNzs1WCMv2Aq','C3rVCMvszwfKvW','ndG4nJa0sKXswgTs','Ae1XsNi','rgndCxK','zKLTywDL','zwXLy3qTAw1HzW','zMLUza','zw1VDMuTy2HHCG','zgnPzNe','lwj0BG','B25SB2fKzw5K','v3vuvLe','C3rYAw5NAwz5','BgfJzwHVBgrLCG','CKzuqvm','t1rtD3C','wKzZEKe','qLrftwy','Aw5SAw5LlwzSzq','zwzFAw1Hz2u','ve5vCeu','sKrPrKm','B3bLBKrc','zNLvssbPBwfNzq','BM92zwXHAs1Yzq','nhWXFdb8mNWZ','zxiGlNn0lwnOyq','zs1IDg4','C3bts0e','DgfYz2v0','ywDLoG','C09nA0q','ztOG','v0fNzhi','whnizxC','ww1SzLe','r1jPvuG','A2fVDhvWAwfU','x25VDMvSywK','tMfTzq','BMX5','mtC5mLbuzvzAsa','DePuDvC','CMvHzefZrgf0yq','yuHwzvm','6k+35ywi6k6+572Uq29TzNLv','yMXVy2S','yNrU','AgfYlxjLzI1PBq','BgfPx2nOyxjFCG','lxjLzI1PBwfNzq','y2fJAguGzM9YBq','DKngu1u','vvHsrwm','shDOEgy','C3r5Bgu','DhjPBq','DeXzEKC','C2vYDMvYrMLSzq','rfHyBMm','mNW0Fdn8mhWX','BhfqAxK','ignHy2HLihrVia','zxCTy29UDgfPBG','ntyXodu5mLL6vvrrCG','CMvMigLTywDLoG','C3rYAw5N','uwvjvxa','AwjLigLTywDLoG','BMfPm0nOyxjszq','mZG4otu1nKryCxrTzW','Aw1Hz2vjBNb1Da','DNbQrgG','Afb0BKS','tLzdvfm','5zU+54Mh5Ase55cg5AsX6lsLoIa','rxjYB3iGChjVyW'];_0x7419=function(){return _0x5af81d;};return _0x7419();}async function loadCachedImages(){function _0x176a58(_0x49b3f7,_0x506002,_0x3c45b4,_0xdf299c){return _0x249499(_0x49b3f7-0x1ba,_0xdf299c,_0x3c45b4-0x1d5,_0x49b3f7-0x498);}const _0xb1ee8c={'ZJeWv':'block','PdcJY':_0x28c7ed(0x419,0x43c,0x44d,0x3ee)+'x','cBSJj':function(_0x28cd09,_0x127264){return _0x28cd09!==_0x127264;},'JDiFC':_0x176a58(0x33f,0x378,0x2ed,0x3b5),'AIfIs':function(_0x34334a,_0x825aa4){return _0x34334a(_0x825aa4);},'fzxLq':'Error\x20load'+_0x28c7ed(0x392,0x3a6,0x3ff,0x398)+_0x176a58(0x2ad,0x251,0x31f,0x30b)+_0x28c7ed(0x4d3,0x4dc,0x47f,0x4be),'tJTuW':function(_0x378795,_0x56fb65){return _0x378795(_0x56fb65);},'GRiUH':function(_0x111e9d,_0x4400bd){return _0x111e9d===_0x4400bd;},'JfWVb':_0x28c7ed(0x416,0x45f,0x421,0x3c8),'vpjDh':_0x176a58(0x312,0x2b6,0x2c6,0x300),'oNTag':'Error\x20load'+_0x28c7ed(0x414,0x3be,0x3ff,0x400)+'\x20NovelAI\x20C'+_0x176a58(0x30c,0x301,0x2a5,0x32e)+_0x176a58(0x33a,0x2e3,0x320,0x2ce),'zsDwA':'ATAds','UXREc':_0x176a58(0x35e,0x382,0x38a,0x3c7),'ojYSH':function(_0x2fef34,_0x3c05e1){return _0x2fef34(_0x3c05e1);},'CBxgN':_0x28c7ed(0x45b,0x3d1,0x425,0x3d9)+'fyUI\x20image'+_0x176a58(0x2ef,0x2d8,0x2a5,0x31c)+_0x176a58(0x34f,0x3c3,0x331,0x2ea)+'at.\x20Please'+_0x28c7ed(0x45a,0x459,0x40a,0x472)+'\x20to\x20update'+_0x28c7ed(0x4df,0x423,0x479,0x453)+'the\x20new\x20fo'+_0x176a58(0x397,0x341,0x34b,0x350),'Uoxuh':_0x28c7ed(0x442,0x3ca,0x3d8,0x36f)+'ing\x20cached'+'\x20ComfyUI\x20i'+'mage:'};await dbs[_0x176a58(0x332,0x380,0x31e,0x35d)]();function _0x28c7ed(_0x27949c,_0x2c0024,_0x12ea14,_0x2342e8){return _0x249499(_0x27949c-0x69,_0x27949c,_0x12ea14-0x32,_0x12ea14-0x5b7);}try{if(_0xb1ee8c['cBSJj']('xeTWP',_0xb1ee8c[_0x28c7ed(0x3da,0x3eb,0x450,0x49f)])){const _0x5c56e9=await dbs[_0x28c7ed(0x432,0x473,0x495,0x457)+_0x28c7ed(0x4c7,0x47a,0x463,0x470)](NAI_VIBE_CACHE_KEY);_0x5c56e9&&_0x5c56e9[_0x176a58(0x2f8,0x300,0x303,0x2dc)]&&_0xb1ee8c['AIfIs'](updateNovelaiImagePreview,_0x5c56e9[_0x28c7ed(0x446,0x462,0x417,0x3af)]);}else{_0x5d53fb['src']=_0xc6f93a,_0x5677c1['style'][_0x28c7ed(0x3ae,0x374,0x3db,0x3ea)]=_0xb1ee8c[_0x28c7ed(0x3f5,0x47d,0x430,0x41f)],_0x2732a9[_0x176a58(0x353,0x377,0x367,0x395)][_0x176a58(0x2bc,0x28a,0x305,0x322)]=_0x28c7ed(0x412,0x464,0x3fd,0x41a),_0x5afd0f[_0x176a58(0x353,0x365,0x3ce,0x3b8)][_0x176a58(0x2bc,0x250,0x310,0x330)]=_0xb1ee8c[_0x176a58(0x39c,0x35b,0x402,0x390)];const _0x47cf69=_0xca2c00[_0x28c7ed(0x3bd,0x3a5,0x3e7,0x39f)](','),_0x37474e=_0x47cf69[0xe*0x109+0x3*0x4c1+0x1*-0x1cc1][_0x176a58(0x2c8,0x31f,0x341,0x2f4)](':')[0x107e*0x2+-0x27a*0x1+-0x3*0xa2b][_0x28c7ed(0x404,0x3a6,0x3e7,0x3e5)](';')[0x64*-0x16+-0x1*-0x833+0x1*0x65];_0x1ca240=_0x37474e,_0xf27684['nai3VibeTr'+_0x28c7ed(0x39d,0x446,0x3cf,0x3fd)+'e']=_0x47cf69[0x149+0xf8d*-0x1+0xd*0x119];const _0x52d853={};_0x52d853['id']=_0x6fdbec,_0x52d853[_0x28c7ed(0x405,0x493,0x417,0x46a)]=_0x83fd0c,_0x4785dc[_0x28c7ed(0x417,0x42d,0x43b,0x3f5)+_0x28c7ed(0x386,0x473,0x3f9,0x42c)](_0x52d853);}}catch(_0x1756a1){console[_0x28c7ed(0x48b,0x453,0x411,0x3bd)](_0xb1ee8c[_0x28c7ed(0x3dc,0x3a4,0x3e2,0x3f9)],_0x1756a1);}try{const _0x3aa1e2=await dbs[_0x176a58(0x376,0x3c8,0x3a5,0x398)+_0x176a58(0x344,0x33f,0x384,0x38a)](NAI_CHAR_REF_CACHE_KEY);_0x3aa1e2&&_0x3aa1e2[_0x28c7ed(0x3a8,0x451,0x417,0x45f)]&&_0xb1ee8c[_0x176a58(0x346,0x30a,0x359,0x37b)](updateNovelaiCharRefImagePreview,_0x3aa1e2['data']);}catch(_0x3bcbf4){if(_0xb1ee8c[_0x28c7ed(0x45e,0x44b,0x45f,0x4b2)](_0xb1ee8c[_0x28c7ed(0x4ed,0x473,0x49e,0x4fe)],_0xb1ee8c[_0x28c7ed(0x456,0x4cf,0x483,0x4b8)])){if(_0x58ac1d){const _0x109841=_0x248327['apply'](_0x28873e,arguments);return _0x5b9b97=null,_0x109841;}}else console[_0x28c7ed(0x487,0x3e6,0x411,0x43a)](_0xb1ee8c[_0x28c7ed(0x50d,0x4fe,0x4a6,0x476)],_0x3bcbf4);}try{if(_0x176a58(0x38a,0x357,0x33d,0x3d3)===_0xb1ee8c[_0x176a58(0x2fb,0x2c7,0x289,0x345)])_0x3723b4(null),_0xf68b1f[_0x176a58(0x37d,0x3e3,0x321,0x3d7)+'e'](_0x20ee58);else{const _0x2d6f7b=await dbs['storeReadO'+_0x176a58(0x344,0x3a7,0x328,0x368)](COMFYUI_REF_CACHE_KEY);if(_0x2d6f7b&&_0x2d6f7b[_0x176a58(0x2f8,0x347,0x35f,0x30f)]&&_0x2d6f7b[_0x28c7ed(0x453,0x3e1,0x417,0x457)][_0x28c7ed(0x3e7,0x3bc,0x417,0x405)]&&_0x2d6f7b[_0x176a58(0x2f8,0x323,0x329,0x35d)][_0x28c7ed(0x496,0x47c,0x475,0x4bd)+_0x176a58(0x343,0x367,0x39a,0x3a5)]){const _0x4214a7=_0x2d6f7b[_0x28c7ed(0x473,0x3f0,0x417,0x475)],_0x4d7c43=await fetch(_0x4214a7['data']),_0x218af8=await _0x4d7c43['blob'](),_0x1a6aa4=URL[_0x28c7ed(0x3e3,0x448,0x3e8,0x403)+_0x28c7ed(0x423,0x441,0x413,0x3c0)](_0x218af8);updateComfyUIImagePreview(_0x1a6aa4),comfyuiImageObjectURL=_0x1a6aa4,window[_0x28c7ed(0x426,0x3c5,0x3fa,0x395)+_0x176a58(0x341,0x2c6,0x33d,0x2d2)]=_0x4214a7[_0x28c7ed(0x49e,0x43a,0x475,0x4c9)+'Name'],_0xb1ee8c[_0x28c7ed(0x41d,0x462,0x41e,0x3ae)](addLog,_0x28c7ed(0x41c,0x46e,0x403,0x3a6)+_0x28c7ed(0x41f,0x3f9,0x3d2,0x368)+_0x4214a7[_0x28c7ed(0x456,0x4c1,0x475,0x47b)+'Name']),console[_0x28c7ed(0x434,0x3ce,0x3f4,0x458)](_0x176a58(0x306,0x2d9,0x2bd,0x2ca)+_0x28c7ed(0x4cd,0x4b9,0x452,0x3d7)+_0x176a58(0x377,0x350,0x331,0x3ef)+_0x176a58(0x33c,0x328,0x30e,0x35b)+_0x4214a7[_0x176a58(0x356,0x303,0x3c2,0x334)+_0x28c7ed(0x4c7,0x461,0x462,0x400)]);}else{if(_0x2d6f7b&&_0xb1ee8c[_0x176a58(0x340,0x35c,0x316,0x3bb)](typeof _0x2d6f7b[_0x28c7ed(0x474,0x3df,0x417,0x451)],_0xb1ee8c[_0x176a58(0x351,0x37d,0x337,0x35d)])){const _0x31936e=await _0xb1ee8c[_0x28c7ed(0x3da,0x3e5,0x3d1,0x388)](fetch,_0x2d6f7b[_0x176a58(0x2f8,0x33b,0x36a,0x2be)]),_0x347759=await _0x31936e['blob'](),_0x160ce5=URL[_0x28c7ed(0x384,0x376,0x3e8,0x432)+_0x176a58(0x2f4,0x338,0x2d6,0x34c)](_0x347759);_0xb1ee8c[_0x176a58(0x346,0x319,0x2f2,0x3ae)](updateComfyUIImagePreview,_0x160ce5),comfyuiImageObjectURL=_0x160ce5,console[_0x28c7ed(0x36e,0x387,0x3e1,0x44c)](_0xb1ee8c[_0x176a58(0x2ae,0x257,0x2f1,0x252)]);}}}}catch(_0xbf6947){console[_0x176a58(0x2f2,0x2b3,0x2ba,0x2fe)](_0xb1ee8c[_0x176a58(0x369,0x32e,0x353,0x3b4)],_0xbf6947);}}export function initImageUpload(_0x30a213){const _0xa84ec4={'rFTAS':_0x12ab1c(0x223,0x1aa,0x17f,0x1d8)+_0x358cef(-0x158,-0x107,-0x122,-0xe1)+'r_ref','VRdke':_0x12ab1c(0x12d,0x18f,0x1b6,0x13c)+_0x12ab1c(0x1db,0x235,0x2a4,0x263)+'age-previe'+_0x358cef(-0x6b,-0x9a,-0xb5,-0xb8)+_0x358cef(-0x6c,-0x12f,-0x12f,-0xdd)+_0x358cef(-0x184,-0x140,-0x152,-0x112)+_0x358cef(-0x76,-0xab,-0xbf,-0x9a),'IaokJ':_0x12ab1c(0x1a2,0x1c7,0x1ce,0x187),'lqPiy':_0x12ab1c(0x200,0x217,0x283,0x241)+'x','BHxkV':_0x358cef(-0xe6,-0x10a,-0xfe,-0x8e),'kiOur':_0x12ab1c(0x22c,0x279,0x263,0x226),'wngpV':_0x12ab1c(0x23c,0x26d,0x2a8,0x2aa),'lfsmN':_0x12ab1c(0x267,0x24c,0x1f6,0x223)+'_nai_char_'+_0x12ab1c(0x231,0x1d7,0x217,0x202),'xwNCV':function(_0x51f15f){return _0x51f15f();},'KHyYc':_0x358cef(-0x3e,-0xae,-0xa3,-0x60)+'2','OTSww':'#novelai-s'+_0x358cef(-0xab,-0x107,-0xef,-0xa2)+'e-btn','urgOP':_0x12ab1c(0x179,0x1b6,0x22d,0x13f),'jUDnp':_0x358cef(-0x98,-0xbd,-0x93,-0x47)+_0x12ab1c(0x1f8,0x1ee,0x1d0,0x234),'HtBnH':_0x12ab1c(0x1ff,0x1ea,0x177,0x218),'WWTAf':_0x358cef(0x21,-0x25,0x11,-0x53)+'emove-imag'+_0x358cef(-0x31,-0x5c,-0xa2,-0x8c),'vCFSU':_0x12ab1c(0x25d,0x265,0x22b,0x220)+_0x358cef(-0x177,-0xeb,-0x15a,-0x11b)+'_ref','ZFszA':_0x12ab1c(0x203,0x259,0x280,0x23e)+_0x358cef(-0xc3,-0xad,-0x115,-0xa0)+_0x358cef(-0x32,-0xe4,-0x7,-0x75)+_0x12ab1c(0x208,0x20e,0x27f,0x1ca),'ijSFg':_0x358cef(0x31,-0xc,-0x22,-0x40)+'elect-imag'+'e-btn','GKRCh':_0x358cef(-0x8f,-0x62,-0x78,-0x38)+_0x358cef(-0x14a,-0x167,-0xc9,-0xf9)+_0x358cef(-0xe8,-0x105,-0x5b,-0x8c)};loadCachedImages();function _0x358cef(_0xe65c3d,_0x599429,_0x3fc217,_0x3eb15d){return _0x249499(_0xe65c3d-0x156,_0x599429,_0x3fc217-0xd4,_0x3eb15d-0xd5);}_0x30a213[_0x12ab1c(0x254,0x20b,0x25d,0x1a9)](_0xa84ec4[_0x358cef(-0x107,-0xb4,-0x92,-0x98)])['on'](_0xa84ec4['urgOP'],()=>{function _0x177879(_0x33542a,_0xb7dded,_0x53b17,_0x1917ea){return _0x12ab1c(_0x33542a-0xd1,_0x1917ea- -0x2ed,_0x53b17-0x16b,_0xb7dded);}function _0xad61c7(_0x37efe9,_0x19d5e2,_0x464d77,_0x57243e){return _0x358cef(_0x37efe9-0x46,_0x57243e,_0x464d77-0xdb,_0x37efe9-0x3a);}if(_0xa84ec4[_0x177879(-0x10e,-0xc2,-0xa6,-0x10a)]!==_0xad61c7(-0x5,-0x2a,0x50,-0x2)){const _0x56caf2=_0x3b6606[_0xad61c7(-0xc2,-0x62,-0xdd,-0x78)+'ById'](_0xa84ec4[_0xad61c7(-0x5f,-0x6c,0x12,0x9)]),_0x386c90=_0x1dfc7c['querySelec'+_0xad61c7(-0x86,-0x2a,-0x27,-0x8b)](_0xa84ec4[_0xad61c7(-0xba,-0x82,-0xf1,-0x9b)]),_0x5b9fe8=_0x4acf0f[_0x177879(-0x116,-0x19b,-0x175,-0x13d)+'ById'](_0x177879(-0xf1,-0xcd,-0x115,-0xd0)+_0xad61c7(-0x9d,-0x72,-0x50,-0xc9)+_0xad61c7(-0xc5,-0xac,-0x89,-0x5e)+_0x177879(-0x12e,-0x9e,-0x5f,-0xb9));if(_0x401304&&_0x2a5d2a['startsWith']('data:image')){_0x56caf2[_0x177879(-0xd3,-0x166,-0x105,-0x134)]=_0x51a005,_0x56caf2['style'][_0xad61c7(-0xcd,-0xc2,-0x5e,-0x145)]='block',_0x386c90['style'][_0x177879(-0x101,-0x1c3,-0x119,-0x148)]=_0xa84ec4['IaokJ'],_0x5b9fe8['style']['display']=_0xa84ec4[_0x177879(-0x89,-0x62,-0xe4,-0xab)];const _0x45d4a8=_0x37a87e[_0x177879(-0xc0,-0xeb,-0x19f,-0x13c)](','),_0x398dd4=_0x45d4a8[-0x822+0x24f*0x4+0x2*-0x8d][_0xad61c7(-0xc1,-0xcf,-0xf6,-0x61)](':')[0xee0*-0x1+-0x294*-0x6+0x1*-0x97][_0x177879(-0x131,-0xea,-0x12c,-0x13c)](';')[0x1*-0x21ee+0xdf5+-0x1*-0x13f9];_0x18d1e0=_0x398dd4,_0x3a3c0b[_0xad61c7(-0x28,-0xa0,-0x32,-0x50)+_0x177879(-0x10e,-0xf3,-0x111,-0xe4)]=_0x45d4a8[-0x1502+0x1b65+-0x2b*0x26];const _0x5b71fa={};_0x5b71fa['id']=_0x2b3cb0,_0x5b71fa['data']=_0x5102c3,_0x1e0ec0[_0x177879(-0xf6,-0x150,-0x116,-0xe8)+'rite'](_0x5b71fa);}else{const _0x97536=_0xa84ec4[_0x177879(-0x1d7,-0x1d8,-0x123,-0x15f)][_0x177879(-0xc9,-0x16d,-0x167,-0x13c)]('|');let _0x2ea35b=-0xbfb*0x2+0x1*0xca0+0xb56;while(!![]){switch(_0x97536[_0x2ea35b++]){case'0':_0x386c90[_0xad61c7(-0x36,-0x30,-0x7,-0x4f)][_0xad61c7(-0xcd,-0x87,-0xd9,-0xfc)]=_0xa84ec4[_0xad61c7(-0xad,-0xde,-0xb8,-0xc0)];continue;case'1':_0x56caf2['style'][_0xad61c7(-0xcd,-0x5f,-0xf5,-0xd5)]=_0xa84ec4[_0xad61c7(-0x81,-0x90,-0x6b,-0x57)];continue;case'2':_0x5b9fe8[_0xad61c7(-0x36,-0x2c,0x30,-0xb)][_0x177879(-0x17f,-0x135,-0x181,-0x148)]=_0x177879(-0xe7,-0x189,-0x144,-0x126);continue;case'3':_0x4f3a1a['nai3CharRe'+_0xad61c7(-0x69,-0xb7,-0x26,-0x9e)]=null;continue;case'4':_0x56caf2[_0xad61c7(-0xb9,-0xef,-0x109,-0xbd)]='';continue;}break;}}}else document[_0x177879(-0xfa,-0xda,-0x18e,-0x13d)+'ById'](_0x177879(-0xb9,-0xc5,-0x10b,-0xa1)+_0x177879(-0x12b,-0xdc,-0x62,-0xc2))[_0x177879(-0x1b3,-0xf9,-0x190,-0x137)]();}),_0x30a213[_0x358cef(-0xc3,-0x49,-0xc0,-0xa1)](_0xa84ec4[_0x12ab1c(0x2f2,0x277,0x2d5,0x22d)])['on'](_0xa84ec4[_0x358cef(-0xbd,-0x69,-0xc4,-0xe4)],handleNovelaiImageUpload),_0x30a213[_0x358cef(-0x71,-0xc9,-0x4c,-0xa1)](_0xa84ec4[_0x12ab1c(0x2bb,0x27b,0x23e,0x208)])['on'](_0xa84ec4['urgOP'],()=>{removeNovelaiImage();}),_0x30a213[_0x358cef(-0x6f,-0x10c,-0x8b,-0xa1)](_0x12ab1c(0x20e,0x25e,0x296,0x260)+_0x358cef(-0xcf,-0xde,-0x6d,-0xd3)+_0x12ab1c(0x1fe,0x237,0x255,0x221)+_0x358cef(-0x59,-0x108,-0x38,-0x9e))['on'](_0xa84ec4[_0x358cef(-0x44,-0x7,-0x52,-0x58)],()=>{function _0x361d7d(_0x282cf0,_0x3c0a6f,_0x2dd730,_0x2b992c){return _0x358cef(_0x282cf0-0x19d,_0x3c0a6f,_0x2dd730-0x23,_0x2b992c-0x4e4);}function _0x2b719c(_0x4262cc,_0x3ed3d9,_0x43b0cb,_0x569309){return _0x12ab1c(_0x4262cc-0x16,_0x4262cc- -0x282,_0x43b0cb-0xab,_0x569309);}document[_0x361d7d(0x3b6,0x3d5,0x450,0x3e8)+_0x2b719c(-0xe1,-0x91,-0xc3,-0x6f)](_0xa84ec4[_0x361d7d(0x43f,0x44e,0x480,0x48b)])[_0x2b719c(-0xcc,-0xbc,-0x12b,-0x59)]();}),_0x30a213[_0x358cef(-0xa2,-0x63,-0x80,-0xa1)](_0xa84ec4[_0x12ab1c(0x26f,0x239,0x231,0x21d)])['on']('change',handleNovelaiCharRefImageUpload),_0x30a213[_0x12ab1c(0x1e1,0x20b,0x1cc,0x251)](_0xa84ec4[_0x12ab1c(0x208,0x215,0x1ad,0x1a1)])['on'](_0x358cef(-0x145,-0xbe,-0x140,-0xf6),()=>{_0xa84ec4['xwNCV'](removeNovelaiCharRefImage);});function _0x12ab1c(_0xc6966a,_0x30ba80,_0x4a62f9,_0x1bcf65){return _0x476031(_0xc6966a-0x17f,_0x30ba80- -0x165,_0x4a62f9-0x1c9,_0x1bcf65);}_0x30a213[_0x358cef(-0xc2,-0x2e,-0x64,-0xa1)](_0xa84ec4[_0x358cef(-0xdc,-0xb6,-0xc4,-0xba)])['on'](_0xa84ec4['urgOP'],()=>{function _0x407bb0(_0x2681b4,_0x63604a,_0x16f7ec,_0x1442e7){return _0x12ab1c(_0x2681b4-0x15a,_0x2681b4- -0x1ad,_0x16f7ec-0x19f,_0x63604a);}function _0x43d483(_0x2be745,_0x2821b5,_0x29988a,_0x249f59){return _0x358cef(_0x2be745-0x199,_0x2821b5,_0x29988a-0x1aa,_0x249f59-0x302);}document[_0x43d483(0x1ab,0x1ff,0x25e,0x206)+_0x43d483(0x248,0x1e9,0x213,0x1f7)](_0xa84ec4['KHyYc'])[_0x407bb0(0x9,-0x9,-0xe,0x32)]();}),_0x30a213[_0x358cef(-0xa2,-0xd7,-0xf0,-0xa1)](_0x358cef(-0x9,-0x30,0x21,-0x47)+'t2')['on'](_0xa84ec4[_0x358cef(-0xfe,-0x160,-0xb3,-0xe4)],handleImageUpload2),_0x30a213[_0x12ab1c(0x274,0x20b,0x24c,0x1d1)](_0xa84ec4[_0x358cef(-0x18,-0x4e,-0x4c,-0x55)])['on'](_0x358cef(-0x94,-0x12d,-0xb5,-0xf6),()=>{removeComfyUIImage();});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};