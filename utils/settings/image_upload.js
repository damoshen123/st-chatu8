(function(_0x399090,_0x2919f){function _0x6475b8(_0x4294be,_0x55c6e0,_0x55a9bd,_0x89f7e9){return _0x540b(_0x89f7e9- -0xf8,_0x4294be);}function _0x308607(_0x2536bd,_0x40910d,_0x3f04ce,_0x3a9baa){return _0x540b(_0x3f04ce- -0x26a,_0x2536bd);}const _0x3f20b2=_0x399090();while(!![]){try{const _0x2c1295=-parseInt(_0x308607(-0x20d,-0x1a5,-0x17f,-0x17c))/(-0x1*0x111a+-0x4be+-0x11*-0x149)*(-parseInt(_0x308607(-0xca,-0xac,-0xce,-0xe1))/(-0x1f*0xf1+0x15a3+0x2*0x3c7))+-parseInt(_0x308607(-0x210,-0x1ef,-0x184,-0x111))/(-0x110*0x1b+-0x66e+0x2321)*(-parseInt(_0x6475b8(0xa0,0x65,-0x52,0x30))/(0x2e8+0x1*-0x1436+-0x6*-0x2e3))+parseInt(_0x6475b8(0x50,0x46,0x13,-0x5))/(-0x2ff+0x1d2f+-0x1a2b)+-parseInt(_0x6475b8(0x1,0x99,0x8,0x12))/(-0x685+-0x99*0x9+0xbec)+-parseInt(_0x308607(-0x138,-0x166,-0x197,-0x14b))/(-0x185c*0x1+0x351*0x3+0x108*0xe)*(parseInt(_0x308607(-0x173,-0xf2,-0x140,-0x17b))/(0x1*0x1891+-0x19ec+-0x1*-0x163))+parseInt(_0x308607(-0x11d,-0x156,-0xe8,-0x90))/(0x141c+-0x24e7+0x10d4)*(-parseInt(_0x308607(-0x40,-0xf2,-0xc9,-0x12c))/(0x1b07+0x1893+-0x3390))+parseInt(_0x6475b8(0x58,-0x42,0x6a,0x1f))/(0xd40+-0x66a+-0x1*0x6cb);if(_0x2c1295===_0x2919f)break;else _0x3f20b2['push'](_0x3f20b2['shift']());}catch(_0x33f628){_0x3f20b2['push'](_0x3f20b2['shift']());}}}(_0x2fd5,-0xb23*0xdf+-0x5fcad*-0x1+0xc5f4*0x14));const _0x529029=(function(){const _0x59fbad={};_0x59fbad[_0x44b9b0(0x2b4,0x2f5,0x374,0x2ec)]=_0x44b9b0(0x355,0x2dd,0x2e4,0x351)+_0x44b9b0(0x1f3,0x244,0x2c9,0x216)+_0x475f0d(-0x1a7,-0x17b,-0x21f,-0x21b),_0x59fbad[_0x475f0d(-0x28b,-0x30c,-0x261,-0x207)]=function(_0x23678d,_0x30c0c8){return _0x23678d||_0x30c0c8;};function _0x475f0d(_0x4f48ac,_0x219f34,_0x230662,_0x3dd517){return _0x540b(_0x4f48ac- -0x346,_0x219f34);}_0x59fbad['xJrUN']='[CharRef]\x20'+'Old\x20charac'+_0x475f0d(-0x26e,-0x25d,-0x2f6,-0x1f7)+_0x475f0d(-0x200,-0x228,-0x1c7,-0x244)+'ments\x20not\x20'+_0x44b9b0(0x1e8,0x274,0x202,0x2f8)+'ing\x20new\x20sy'+_0x475f0d(-0x1cf,-0x223,-0x206,-0x15d),_0x59fbad[_0x475f0d(-0x1ce,-0x232,-0x20c,-0x23f)]=_0x475f0d(-0x214,-0x275,-0x24a,-0x22e);function _0x44b9b0(_0x4bdccd,_0x2bcf42,_0x410988,_0x5ba541){return _0x540b(_0x2bcf42-0x16b,_0x410988);}_0x59fbad[_0x44b9b0(0x2b4,0x277,0x23c,0x27d)]=_0x44b9b0(0x31a,0x2cf,0x307,0x322)+'x',_0x59fbad[_0x475f0d(-0x28a,-0x227,-0x2c4,-0x25c)]='flex',_0x59fbad[_0x475f0d(-0x1db,-0x193,-0x24b,-0x17a)]=_0x44b9b0(0x29d,0x2c5,0x314,0x280),_0x59fbad['jwjsi']=function(_0x59af01,_0x4fef5e){return _0x59af01!==_0x4fef5e;},_0x59fbad['JOhKu']=_0x475f0d(-0x272,-0x2d5,-0x27d,-0x22b),_0x59fbad[_0x475f0d(-0x286,-0x24e,-0x30b,-0x273)]='ubFha';const _0x214965=_0x59fbad;let _0x2f5b9f=!![];return function(_0x1d13c7,_0x4f3ec8){const _0x313c4c={'Zmhky':_0x214965[_0x3a2a2c(-0x102,-0x17b,-0xf4,-0x139)],'bcEKM':'novelai-re'+_0x3a2a2c(-0x2dd,-0x24e,-0x2bb,-0x203)+_0x3a2a2c(-0x1d5,-0x21e,-0x258,-0x29d)+_0x3a2a2c(-0x1c6,-0x1c2,-0x195,-0x15c),'hQxjy':function(_0x249eb5,_0x353fbf){function _0x50fc74(_0x22268d,_0x13b92c,_0x2e1cb4,_0x23feb6){return _0x3a2a2c(_0x22268d-0x16e,_0x22268d-0x56,_0x2e1cb4-0x187,_0x23feb6);}return _0x214965[_0x50fc74(-0x1f4,-0x16b,-0x176,-0x27d)](_0x249eb5,_0x353fbf);},'NNUOG':_0x214965[_0x3a2a2c(-0x153,-0x182,-0x1a8,-0x1f5)],'nWFbM':_0x3a2a2c(-0x2a6,-0x236,-0x1f7,-0x28f),'GViyY':_0x1ffd82(0x60,-0x31,-0x66,0xe),'VmeGF':_0x214965[_0x3a2a2c(-0x1f6,-0x18d,-0x1f0,-0x162)],'IZMvj':_0x214965[_0x1ffd82(0x69,0xae,0x84,0x7a)],'wiwYU':_0x214965[_0x1ffd82(0xab,0x29,0x8e,0x2a)],'lLgWe':function(_0x3c1842,_0x18fe6c){return _0x3c1842!==_0x18fe6c;},'WcFDj':_0x214965['XxaPY'],'ZIusv':function(_0xb07d1a,_0x58522b){return _0x214965['jwjsi'](_0xb07d1a,_0x58522b);},'HsNIh':_0x214965[_0x3a2a2c(-0x197,-0x1a0,-0x1a4,-0x22b)]};function _0x1ffd82(_0x35382f,_0x2e0f77,_0x1c8012,_0x4f5b77){return _0x475f0d(_0x4f5b77-0x2b4,_0x1c8012,_0x1c8012-0x17a,_0x4f5b77-0x1b8);}function _0x3a2a2c(_0x5bc39a,_0x282714,_0x591335,_0x1c5f9e){return _0x44b9b0(_0x5bc39a-0xe6,_0x282714- -0x470,_0x1c5f9e,_0x1c5f9e-0x6c);}if(_0x214965[_0x1ffd82(0xd8,0xaa,0x15b,0xf5)](_0x214965[_0x3a2a2c(-0x289,-0x245,-0x2d5,-0x289)],_0x214965[_0x3a2a2c(-0x1e7,-0x245,-0x2b8,-0x259)]))_0x4d2bb7(null),_0x4c1505['storeDelet'+'e'](_0x3613fc);else{const _0x1dfd25=_0x2f5b9f?function(){function _0x378a4e(_0x5596c2,_0x537815,_0x1dcf03,_0x18b00a){return _0x1ffd82(_0x5596c2-0x1f,_0x537815-0x188,_0x537815,_0x1dcf03-0x1a2);}function _0x39bcaa(_0x45d646,_0x597e97,_0x277c38,_0x83f58c){return _0x3a2a2c(_0x45d646-0x191,_0x597e97-0x387,_0x277c38-0xd,_0x277c38);}if(_0x313c4c['lLgWe'](_0x313c4c[_0x378a4e(0x268,0x1fa,0x26e,0x2d2)],_0x313c4c[_0x378a4e(0x20c,0x1ea,0x26e,0x2c0)])){const _0x5d10f7=_0x58004a[_0x39bcaa(0x237,0x1e4,0x18b,0x23d)+_0x39bcaa(0x194,0x108,0xd0,0x18b)](_0x313c4c[_0x39bcaa(0x1bd,0x12d,0xe8,0xab)]),_0x1d3349=_0x95d2cf[_0x378a4e(0x20c,0x25a,0x1ec,0x1cf)+_0x378a4e(0x1e4,0x1ed,0x1bc,0x162)]('#novelai-c'+_0x39bcaa(0x226,0x1bf,0x143,0x22f)+_0x39bcaa(0x1c2,0x182,0x198,0x170)+_0x378a4e(0x2d0,0x217,0x25b,0x219)+_0x39bcaa(0x240,0x1e2,0x267,0x1a8)+_0x39bcaa(0x1f2,0x20b,0x229,0x252)+'laceholder'),_0x4b61c=_0x2bb904[_0x378a4e(0x23e,0x242,0x272,0x205)+_0x39bcaa(0x147,0x108,0xf5,0x116)](_0x313c4c['bcEKM']);if(_0x313c4c['hQxjy'](!_0x5d10f7,!_0x1d3349)||!_0x4b61c){_0x3b8878[_0x39bcaa(0x11b,0x11f,0x123,0x9c)](_0x313c4c[_0x39bcaa(0xfb,0x172,0x1e6,0x117)]);return;}if(_0x4136d4&&_0x62a780['startsWith'](_0x313c4c[_0x378a4e(0x15b,0x1df,0x1b5,0x21f)])){_0x5d10f7[_0x378a4e(0x299,0x1d8,0x215,0x1e9)]=_0x24ad29,_0x5d10f7[_0x378a4e(0x1fb,0x26b,0x205,0x1d2)][_0x378a4e(0x178,0x191,0x19e,0x13d)]=_0x313c4c[_0x39bcaa(0x18a,0x176,0x178,0xec)],_0x1d3349[_0x39bcaa(0x129,0x177,0x19f,0x1f4)][_0x39bcaa(0x15c,0x110,0xc2,0x87)]=_0x313c4c['VmeGF'],_0x4b61c[_0x39bcaa(0x1a2,0x177,0x1ab,0x11c)][_0x39bcaa(0xb2,0x110,0xcd,0x11d)]=_0x313c4c[_0x378a4e(0x2b1,0x1ce,0x243,0x250)];const _0x391f82=_0x206e58[_0x39bcaa(0x208,0x19b,0x1b1,0x1fa)](','),_0x283c0c=_0x391f82[0x2a5*-0xe+0x5d*0x7+0x227b]['split'](':')[-0x8d8+-0x36e+0xc47][_0x378a4e(0x21c,0x22e,0x229,0x1a9)](';')[0x2505+-0x2458+0xad*-0x1];_0x5e05c3=_0x283c0c,_0x21f5a9[_0x39bcaa(0x1dd,0x160,0x1cd,0x15b)+_0x378a4e(0x1fa,0x188,0x1ff,0x1b6)]=_0x391f82[0x341*0x8+-0x42a*-0x6+-0x3303];const _0x4a50da={};_0x4a50da['id']=_0x591871,_0x4a50da[_0x39bcaa(0x171,0x1bb,0x1cd,0x215)]=_0x458433,_0x5ea4a1[_0x378a4e(0x2d1,0x266,0x27f,0x279)+'rite'](_0x4a50da);}else _0x5d10f7[_0x39bcaa(0x1ee,0x187,0x133,0x108)]='',_0x5d10f7['style'][_0x378a4e(0x18f,0x225,0x19e,0x196)]=_0x378a4e(0x285,0x1c7,0x242,0x27f),_0x1d3349['style']['display']=_0x313c4c[_0x39bcaa(0xd7,0x147,0x135,0x195)],_0x4b61c[_0x39bcaa(0x11d,0x177,0x1d4,0x1b9)][_0x39bcaa(0x10d,0x110,0xec,0xa6)]=_0x313c4c[_0x378a4e(0x1c2,0x24e,0x1dc,0x242)],_0x389d26[_0x378a4e(0x1fd,0x21b,0x1ee,0x1d7)+_0x378a4e(0x178,0x1f6,0x1ff,0x170)]=null;}else{if(_0x4f3ec8){if(_0x313c4c[_0x378a4e(0x29c,0x2c6,0x245,0x1fa)]('HvLNK',_0x313c4c[_0x378a4e(0x1fb,0x204,0x216,0x1ed)])){const _0x4b6f35=_0x4f3ec8[_0x378a4e(0x215,0x257,0x24e,0x2ce)](_0x1d13c7,arguments);return _0x4f3ec8=null,_0x4b6f35;}else{_0x4278b6[_0x39bcaa(0x12d,0x187,0x153,0x16e)]=_0xe0d405,_0x16ec3a[_0x378a4e(0x1d2,0x247,0x205,0x189)][_0x378a4e(0x16a,0x14a,0x19e,0x20d)]=_0x313c4c[_0x39bcaa(0x15e,0x176,0x1d7,0x110)],_0x29a5fd['style'][_0x39bcaa(0xb8,0x110,0xde,0x167)]=_0x313c4c[_0x378a4e(0x216,0x217,0x1dc,0x1b9)],_0x2f1ab1[_0x39bcaa(0x1ca,0x177,0x1db,0x14d)][_0x378a4e(0x200,0x123,0x19e,0x1ba)]='inline-fle'+'x';const _0x13bee6=_0x831884[_0x39bcaa(0x19c,0x19b,0x112,0x221)](','),_0x189a90=_0x13bee6[0x1b4a+0x20d5+-0x3c1f][_0x39bcaa(0x152,0x19b,0x1dd,0x19f)](':')[0x4*0xee+0x6d*0x50+0x1*-0x25c7][_0x39bcaa(0x15d,0x19b,0x11e,0x15c)](';')[-0xd4*0x7+-0x2ea+0x8b6];_0x4f4389=_0x189a90,_0x3017c2[_0x378a4e(0x132,0x10c,0x19a,0x12b)+'ansferImag'+'e']=_0x13bee6[-0x17b0+-0x1*-0x4bd+0x4bd*0x4];const _0x58bf9c={};_0x58bf9c['id']=_0x1e04c4,_0x58bf9c[_0x378a4e(0x287,0x2d0,0x249,0x1cb)]=_0x3b517b,_0x4d66e4[_0x39bcaa(0x269,0x1f1,0x1d9,0x1a3)+_0x378a4e(0x20c,0x200,0x251,0x224)](_0x58bf9c);}}}}:function(){};return _0x2f5b9f=![],_0x1dfd25;}};}()),_0x1f63ab=_0x529029(this,function(){const _0x47f3f0={};_0x47f3f0[_0x3593d6(-0x19b,-0x1b0,-0x14d,-0x1a7)]=_0x3593d6(-0x1b2,-0x12f,-0x176,-0x127)+'+$';function _0x7c8661(_0x5c3e43,_0x37d4ba,_0x16a57d,_0x21a160){return _0x540b(_0x37d4ba- -0x75,_0x21a160);}function _0x3593d6(_0x39360a,_0x496a95,_0x4ae672,_0x5d428e){return _0x540b(_0x4ae672- -0x2cc,_0x496a95);}const _0x52db30=_0x47f3f0;return _0x1f63ab[_0x3593d6(-0x114,-0xf5,-0x156,-0x1aa)]()['search'](_0x52db30[_0x3593d6(-0x13b,-0xc3,-0x14d,-0xe9)])['toString']()[_0x7c8661(0x4,0x4d,0x28,0x60)+'r'](_0x1f63ab)[_0x7c8661(0xd9,0x5c,-0x34,0x30)](_0x3593d6(-0x1a5,-0x1f7,-0x176,-0x1c8)+'+$');});_0x1f63ab();function _0x16c038(_0x64f01f,_0x5eb15a,_0xfd1887,_0x2f504d){return _0x540b(_0x64f01f-0x0,_0xfd1887);}import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';function _0x15af83(_0xeb838c,_0x5081c0,_0x5741d2,_0x34ae9a){return _0x540b(_0xeb838c- -0x1cc,_0x5741d2);}import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY='cache_nove'+'lai_vibe_t'+_0x16c038(0x131,0x14c,0xea,0x18f)+_0x16c038(0xa9,0x75,0xca,0x10b),NAI_CHAR_REF_CACHE_KEY=_0x15af83(-0xa1,-0xd5,-0xa2,-0x77)+_0x16c038(0x185,0x138,0x200,0x1e4)+_0x15af83(-0xc9,-0x73,-0xa1,-0x76),COMFYUI_REF_CACHE_KEY=_0x16c038(0x110,0x107,0xc1,0xfa)+_0x15af83(-0x96,-0xbd,-0x56,-0x75)+'age';let nai3VibeTransferImageMimeType=_0x15af83(-0x6b,-0xda,-0xef,-0x14),nai3CharRefImageMimeType='image/png',comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x3a341a){const _0x1f7d7c={};function _0x21fd80(_0xf8c624,_0x50b2de,_0x3d2590,_0x214215){return _0x16c038(_0x50b2de- -0x3b0,_0x50b2de-0x1ea,_0x214215,_0x214215-0xb4);}_0x1f7d7c[_0x563dec(-0x1c0,-0x248,-0x1fd,-0x1dc)]=_0x21fd80(-0x20f,-0x23e,-0x1c4,-0x1fb)+_0x563dec(-0x1bf,-0x17b,-0x17b,-0x168),_0x1f7d7c[_0x563dec(-0x127,-0x183,-0x153,-0x1ba)]=_0x21fd80(-0x327,-0x31d,-0x342,-0x339)+'mage-previ'+_0x563dec(-0x204,-0x205,-0x230,-0x212)+'er\x20.st-cha'+_0x563dec(-0x1b8,-0x162,-0x1d6,-0x135)+_0x21fd80(-0x1c6,-0x232,-0x1f4,-0x1ed)+'r',_0x1f7d7c['kETzV']=_0x563dec(-0x219,-0x200,-0x18a,-0x203),_0x1f7d7c[_0x563dec(-0x1eb,-0x225,-0x2af,-0x1b7)]=function(_0x5f1027,_0x3c4811){return _0x5f1027!==_0x3c4811;},_0x1f7d7c['QFqKX']='CSeLP',_0x1f7d7c[_0x563dec(-0x1a7,-0x15c,-0x175,-0x183)]='boEwS',_0x1f7d7c['MmWFJ']='none',_0x1f7d7c[_0x563dec(-0x1be,-0x1af,-0x23a,-0x165)]=_0x563dec(-0x155,-0x16b,-0x155,-0xe5)+'x',_0x1f7d7c[_0x563dec(-0xea,-0x170,-0x1f3,-0xfd)]=_0x563dec(-0x17a,-0x1e2,-0x185,-0x18f),_0x1f7d7c[_0x563dec(-0x295,-0x244,-0x1b5,-0x1ea)]=_0x563dec(-0x217,-0x219,-0x1de,-0x298);const _0xb2168a=_0x1f7d7c,_0x3a0d7f=document['getElement'+_0x563dec(-0x1cd,-0x249,-0x22e,-0x27b)](_0xb2168a[_0x21fd80(-0x355,-0x329,-0x38c,-0x2e1)]);function _0x563dec(_0x4916b7,_0x3a7b5d,_0x3195e7,_0x8d12e5){return _0x15af83(_0x3a7b5d- -0x103,_0x3a7b5d-0x1cb,_0x3195e7,_0x8d12e5-0xc5);}const _0x2626ae=document['querySelec'+_0x21fd80(-0x31b,-0x304,-0x28d,-0x376)](_0xb2168a[_0x563dec(-0x148,-0x183,-0x1ed,-0x1a9)]),_0x29ced9=document['getElement'+'ById']('novelai-re'+'move-image'+'-btn');if(_0x3a341a&&_0x3a341a[_0x563dec(-0x26a,-0x21f,-0x1a6,-0x240)](_0xb2168a[_0x21fd80(-0x28e,-0x21a,-0x2a5,-0x1c2)])){if(_0xb2168a['LBTWd'](_0xb2168a[_0x21fd80(-0x34b,-0x2fe,-0x2a6,-0x2ca)],_0xb2168a['coZhd'])){_0x3a0d7f[_0x21fd80(-0x293,-0x2ab,-0x334,-0x270)]=_0x3a341a,_0x3a0d7f[_0x563dec(-0x24d,-0x1da,-0x21b,-0x216)][_0x21fd80(-0x310,-0x322,-0x2b8,-0x320)]=_0x563dec(-0x252,-0x22f,-0x207,-0x2ab),_0x2626ae[_0x21fd80(-0x27e,-0x2bb,-0x2ae,-0x26e)][_0x21fd80(-0x320,-0x322,-0x366,-0x32d)]=_0xb2168a[_0x563dec(-0x208,-0x239,-0x296,-0x20b)],_0x29ced9[_0x563dec(-0x1ec,-0x1da,-0x228,-0x1ee)][_0x21fd80(-0x39c,-0x322,-0x336,-0x349)]=_0xb2168a[_0x21fd80(-0x216,-0x290,-0x23c,-0x2b0)];const _0x101788=_0x3a341a[_0x563dec(-0x247,-0x1b6,-0x1c0,-0x148)](','),_0x42c2f0=_0x101788[0x78c*0x1+-0x49*-0x36+-0x16f2]['split'](':')[-0x827+0x1adc+0x12b4*-0x1][_0x563dec(-0x222,-0x1b6,-0x1b6,-0x130)](';')[0x54e+-0xfe*0xb+0x167*0x4];nai3VibeTransferImageMimeType=_0x42c2f0,window['nai3VibeTr'+_0x563dec(-0xf0,-0x13d,-0x119,-0x18d)+'e']=_0x101788[-0x1432+0x265c+0x1229*-0x1];const _0x30b899={};_0x30b899['id']=NAI_VIBE_CACHE_KEY,_0x30b899[_0x563dec(-0x207,-0x196,-0x165,-0x17b)]=_0x3a341a,dbs['storeReadW'+_0x563dec(-0x14d,-0x18e,-0x146,-0x148)](_0x30b899);}else{if(_0x3a5a9a){const _0x39dc2c=_0x18d3b2['apply'](_0x4d7ac8,arguments);return _0x2f93ba=null,_0x39dc2c;}}}else{const _0x32f600=_0xb2168a[_0x563dec(-0x16e,-0x170,-0x13e,-0x13a)][_0x21fd80(-0x2b8,-0x297,-0x26e,-0x323)]('|');let _0x185598=0x7e7+-0x1*0x2047+-0x3*-0x820;while(!![]){switch(_0x32f600[_0x185598++]){case'0':_0x3a0d7f[_0x21fd80(-0x2b5,-0x2bb,-0x2ec,-0x317)][_0x563dec(-0x2a9,-0x241,-0x1df,-0x2b5)]=_0x563dec(-0x19b,-0x19d,-0x1f5,-0x174);continue;case'1':_0x29ced9['style'][_0x563dec(-0x1f4,-0x241,-0x23c,-0x1ef)]=_0xb2168a[_0x563dec(-0x265,-0x239,-0x1fe,-0x2a2)];continue;case'2':_0x2626ae[_0x563dec(-0x1f2,-0x1da,-0x1ce,-0x1aa)][_0x563dec(-0x219,-0x241,-0x1d1,-0x245)]=_0xb2168a['uFhNF'];continue;case'3':_0x3a0d7f[_0x563dec(-0x171,-0x1ca,-0x1d9,-0x146)]='';continue;case'4':window[_0x21fd80(-0x2d4,-0x326,-0x35a,-0x34b)+_0x21fd80(-0x1ff,-0x21e,-0x1fa,-0x234)+'e']=null;continue;}break;}}}function removeNovelaiImage(){function _0x48060f(_0x3d1d8e,_0x482ef2,_0x406a73,_0x51e386){return _0x15af83(_0x406a73- -0x18c,_0x482ef2-0x1df,_0x482ef2,_0x51e386-0xb9);}updateNovelaiImagePreview(null),dbs[_0x48060f(-0x23e,-0x13c,-0x1b8,-0x1b6)+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x54ccf5){const _0x2742a5={'zcSlU':function(_0x44573a,_0x10befb){return _0x44573a!==_0x10befb;},'PPtuw':_0xaeebab(0x52c,0x4ad,0x493,0x491),'sxxlC':function(_0x4ce319,_0x405152,_0x47befc){return _0x4ce319(_0x405152,_0x47befc);},'tGEgM':function(_0x5cab4c,_0x4e4756){return _0x5cab4c(_0x4e4756);},'PTNhq':function(_0x4cc0cc,_0x102b71){return _0x4cc0cc!==_0x102b71;},'gIcSO':_0xaeebab(0x4ec,0x4b5,0x45b,0x4d3),'CfpSS':function(_0x3b39e9,_0x2412f1){return _0x3b39e9(_0x2412f1);},'EmRjg':function(_0x127c28,_0x2d4f72){return _0x127c28+_0x2d4f72;},'erWAX':_0xaeebab(0x50c,0x4ac,0x4d6,0x448)},_0x122611=_0x54ccf5[_0xaeebab(0x3c9,0x42e,0x3a1,0x42d)][_0xaeebab(0x4d8,0x50e,0x573,0x564)][0x22b0+0x10d9+0x3389*-0x1];function _0xaeebab(_0x132ac8,_0x2efbbb,_0x283c04,_0x1d5d1b){return _0x15af83(_0x2efbbb-0x549,_0x2efbbb-0x160,_0x132ac8,_0x1d5d1b-0xee);}if(!_0x122611)return;function _0x2220a3(_0x554b10,_0x34832e,_0x525e9f,_0x55d5b6){return _0x15af83(_0x55d5b6-0x10a,_0x34832e-0x1d0,_0x554b10,_0x55d5b6-0x1f1);}try{if(_0x2742a5[_0x2220a3(0xc7,0xdc,0x15e,0xe1)](_0x2742a5[_0xaeebab(0x4e4,0x501,0x590,0x484)],_0x2742a5[_0x2220a3(0x7e,0x11b,0xca,0xc2)]))_0x560e18();else{const _0x355f88=await _0x2742a5[_0xaeebab(0x4d7,0x45f,0x45e,0x3eb)](processUploadedImage,_0x122611,!![]);_0x2742a5[_0x2220a3(0x5b,-0x52,-0x42,0x36)](updateNovelaiImagePreview,_0x355f88);}}catch(_0x49e055){_0x2742a5[_0xaeebab(0x48e,0x46f,0x489,0x401)](_0x2742a5[_0xaeebab(0x4a8,0x4bd,0x4b7,0x53b)],_0x2742a5['gIcSO'])?_0x5093bd():(console[_0xaeebab(0x492,0x479,0x3fb,0x509)](_0x2220a3(0x1d,0x83,-0x49,0x4)+'essing\x20Nov'+_0x2220a3(0x6c,0xb5,0x48,0x4b)+':',_0x49e055),_0x2742a5['CfpSS'](alert,_0x2742a5['EmRjg'](_0x2742a5[_0xaeebab(0x514,0x4cb,0x527,0x53a)],_0x49e055[_0x2220a3(0xe6,0x144,0x8c,0xd5)])));}}function _0x540b(_0x4ccec3,_0x296a6c){_0x4ccec3=_0x4ccec3-(-0x7*0xe9+0x1*-0x290+-0x29*-0x3b);const _0x58004a=_0x2fd5();let _0x95d2cf=_0x58004a[_0x4ccec3];if(_0x540b['hMFnVq']===undefined){var _0x2bb904=function(_0x4aad82){const _0x399a86='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x36bac3='',_0x4371ff='',_0x5e98c2=_0x36bac3+_0x2bb904;for(let _0x118288=-0x7*-0xc6+-0x1*-0x103c+-0x15a6,_0xd00b7d,_0x54f6bd,_0x3b8878=0x15d5+0x7*0x4e4+-0x3811*0x1;_0x54f6bd=_0x4aad82['charAt'](_0x3b8878++);~_0x54f6bd&&(_0xd00b7d=_0x118288%(0x13e+0x685+-0x7bf)?_0xd00b7d*(-0x65*-0x4d+0x2e3*0x5+-0x2c9*0x10)+_0x54f6bd:_0x54f6bd,_0x118288++%(0x2*0x1083+-0x12*0x115+-0x8*0x1b1))?_0x36bac3+=_0x5e98c2['charCodeAt'](_0x3b8878+(0x1869+0x17*-0x1+-0x1848))-(-0x355*0xb+-0xb2a*0x3+0x462f*0x1)!==0x2367+0x12f3+-0x365a?String['fromCharCode'](0xad5+-0xbe2+0x20c&_0xd00b7d>>(-(-0xbd*-0x2b+0x1434+-0x33f1)*_0x118288&-0x1ebe+-0x489*0x7+-0x3e83*-0x1)):_0x118288:-0x4c4*0x2+-0x1972+0x22fa){_0x54f6bd=_0x399a86['indexOf'](_0x54f6bd);}for(let _0x24ad29=0x1e1d*0x1+-0x1b9e+0x47*-0x9,_0x206e58=_0x36bac3['length'];_0x24ad29<_0x206e58;_0x24ad29++){_0x4371ff+='%'+('00'+_0x36bac3['charCodeAt'](_0x24ad29)['toString'](0x250c+0x17ca+-0x3cc6))['slice'](-(-0x82*0x3+0x1320+-0x1198));}return decodeURIComponent(_0x4371ff);};_0x540b['OuqONu']=_0x2bb904,_0x540b['ZDRXVj']={},_0x540b['hMFnVq']=!![];}const _0xdb3fba=_0x58004a[0xb*0x295+0xdc4+-0x2a2b],_0x4136d4=_0x4ccec3+_0xdb3fba,_0x62a780=_0x540b['ZDRXVj'][_0x4136d4];if(!_0x62a780){const _0x5e05c3=function(_0x21f5a9){this['vqGVLl']=_0x21f5a9,this['BRQyHL']=[-0x4f3+0x1*-0x24a9+-0x35*-0xc9,0x987+0x1ec5+-0x4*0xa13,-0x1316+-0x2*-0x1255+-0x1194],this['lhHKNK']=function(){return'newState';},this['KhZOEg']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['QDbtjR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5e05c3['prototype']['tyQTzf']=function(){const _0x5ea4a1=new RegExp(this['KhZOEg']+this['QDbtjR']),_0x591871=_0x5ea4a1['test'](this['lhHKNK']['toString']())?--this['BRQyHL'][0x220b*-0x1+0x1620+-0x1b4*-0x7]:--this['BRQyHL'][0x48*0x31+0x102f*0x2+-0x2e26];return this['MxGWEu'](_0x591871);},_0x5e05c3['prototype']['MxGWEu']=function(_0x458433){if(!Boolean(~_0x458433))return _0x458433;return this['PejaXN'](this['vqGVLl']);},_0x5e05c3['prototype']['PejaXN']=function(_0x389d26){for(let _0x1ecd30=-0xfac+0x4*-0x23e+0x18a4,_0x4ab8c9=this['BRQyHL']['length'];_0x1ecd30<_0x4ab8c9;_0x1ecd30++){this['BRQyHL']['push'](Math['round'](Math['random']())),_0x4ab8c9=this['BRQyHL']['length'];}return _0x389d26(this['BRQyHL'][0xff3*-0x1+-0x215f*-0x1+-0x116c]);},new _0x5e05c3(_0x540b)['tyQTzf'](),_0x95d2cf=_0x540b['OuqONu'](_0x95d2cf),_0x540b['ZDRXVj'][_0x4136d4]=_0x95d2cf;}else _0x95d2cf=_0x62a780;return _0x95d2cf;}function updateNovelaiCharRefImagePreview(_0x834598){const _0x3700de={};_0x3700de[_0x1657c6(-0x2d9,-0x294,-0x31f,-0x21a)]=_0x30ca99(-0x6,-0x33,-0x43,-0x3a),_0x3700de[_0x1657c6(-0x241,-0x2bc,-0x251,-0x327)]=_0x30ca99(-0x16,-0x1,0x21,-0x62)+'x';function _0x30ca99(_0xa73c8a,_0x40172d,_0x35d84d,_0x314c25){return _0x15af83(_0x40172d-0x67,_0x40172d-0x1dd,_0xa73c8a,_0x314c25-0x127);}function _0x1657c6(_0x5d44de,_0x43ee13,_0x17c279,_0x30f28a){return _0x15af83(_0x43ee13- -0x20a,_0x43ee13-0x74,_0x17c279,_0x30f28a-0x179);}_0x3700de[_0x30ca99(-0x110,-0xce,-0x45,-0x120)]=_0x30ca99(-0x35,0xd,-0x48,-0xe)+'ge_nai_cha'+'r_ref',_0x3700de[_0x30ca99(0xa9,0x2a,0x5b,0xe)]=_0x1657c6(-0x2be,-0x335,-0x355,-0x38e)+_0x1657c6(-0x264,-0x299,-0x31c,-0x2d4)+_0x30ca99(-0x56,-0x65,0x22,-0xe9)+_0x30ca99(-0xa6,-0x1a,0x2f,0xb)+_0x30ca99(-0x53,-0x5,0x84,0x13)+_0x30ca99(-0x4c,0x24,-0x67,-0xc)+'laceholder',_0x3700de[_0x30ca99(-0x2,-0xd,0x79,-0x5b)]=_0x1657c6(-0x2ee,-0x318,-0x34b,-0x392)+_0x30ca99(-0x8f,-0xae,-0x6b,-0x71)+_0x30ca99(0x8,-0x7e,-0x84,0x11)+_0x30ca99(-0x13,-0x22,-0x8b,0x57),_0x3700de['AEwyd']=function(_0x1bc979,_0x2b3f4f){return _0x1bc979||_0x2b3f4f;},_0x3700de[_0x1657c6(-0x2f0,-0x2f5,-0x2cb,-0x338)]=function(_0x4f7b35,_0x27ddcf){return _0x4f7b35===_0x27ddcf;},_0x3700de[_0x30ca99(-0xf7,-0x80,-0xf0,-0x9f)]=_0x30ca99(0x5f,0x2f,0x77,0x9e),_0x3700de['BSLLM']=_0x1657c6(-0x35b,-0x336,-0x377,-0x2ae),_0x3700de[_0x1657c6(-0x2d8,-0x2ad,-0x2f4,-0x2da)]=_0x30ca99(-0x77,-0xb2,-0xc3,-0x5a),_0x3700de[_0x30ca99(0x5,0x1c,0x50,0xc)]=_0x30ca99(-0x79,-0xaf,-0x8d,-0x6a);const _0x2ff737=_0x3700de,_0x2bd6fc=document[_0x30ca99(0x50,-0x3,-0x43,-0x3d)+_0x30ca99(-0x8e,-0xdf,-0xf3,-0x115)](_0x2ff737[_0x30ca99(-0x117,-0xce,-0xad,-0x85)]),_0x430592=document[_0x30ca99(-0x55,-0x89,-0x4f,-0xa6)+_0x1657c6(-0x2ad,-0x32a,-0x2f9,-0x30d)](_0x2ff737[_0x1657c6(-0x1e9,-0x247,-0x2c9,-0x250)]),_0x211738=document['getElement'+_0x1657c6(-0x2d2,-0x350,-0x3b3,-0x32a)](_0x2ff737[_0x30ca99(0x1b,-0xd,-0x92,0x42)]);if(_0x2ff737[_0x1657c6(-0x29d,-0x313,-0x398,-0x2d7)](!_0x2bd6fc,!_0x430592)||!_0x211738){console[_0x30ca99(-0x51,-0xc8,-0x9e,-0xba)](_0x1657c6(-0x2b4,-0x273,-0x28f,-0x250)+_0x30ca99(0x76,-0x13,-0x12,0x4e)+_0x1657c6(-0x317,-0x2fe,-0x284,-0x384)+'nce\x20UI\x20ele'+'ments\x20not\x20'+'found\x20-\x20us'+'ing\x20new\x20sy'+'stem');return;}if(_0x834598&&_0x834598[_0x1657c6(-0x37a,-0x326,-0x38e,-0x2a2)](_0x1657c6(-0x323,-0x307,-0x2a2,-0x2f3))){if(_0x2ff737[_0x30ca99(-0x54,-0x84,-0x7,-0x113)](_0x2ff737[_0x1657c6(-0x273,-0x2f1,-0x37e,-0x2e8)],_0x1657c6(-0x270,-0x239,-0x242,-0x2bc)))_0x523c22[_0x1657c6(-0x2b0,-0x2d1,-0x2a6,-0x33a)]=_0x596840,_0x2f801e['style']['display']='block',_0x599b46[_0x1657c6(-0x27e,-0x2e1,-0x26a,-0x332)][_0x1657c6(-0x31c,-0x348,-0x2d0,-0x351)]=_0x2ff737[_0x1657c6(-0x289,-0x294,-0x245,-0x213)],_0x125038[_0x1657c6(-0x2a2,-0x2e1,-0x2e4,-0x335)][_0x30ca99(-0x9e,-0xd7,-0x107,-0x79)]=_0x2ff737[_0x30ca99(-0x47,-0x4b,-0x3d,0xf)];else{_0x2bd6fc[_0x1657c6(-0x2f2,-0x2d1,-0x292,-0x329)]=_0x834598,_0x2bd6fc[_0x1657c6(-0x286,-0x2e1,-0x36b,-0x2d0)][_0x30ca99(-0x4a,-0xd7,-0x4e,-0x7c)]=_0x2ff737[_0x1657c6(-0x346,-0x2fc,-0x2a3,-0x37b)],_0x430592[_0x1657c6(-0x360,-0x2e1,-0x289,-0x293)][_0x30ca99(-0x4e,-0xd7,-0xff,-0xb4)]=_0x2ff737[_0x1657c6(-0x26f,-0x294,-0x319,-0x2dd)],_0x211738[_0x1657c6(-0x251,-0x2e1,-0x28f,-0x366)][_0x1657c6(-0x31d,-0x348,-0x2ef,-0x395)]=_0x2ff737[_0x1657c6(-0x246,-0x2bc,-0x2ef,-0x2a6)];const _0x57d7c7=_0x834598[_0x1657c6(-0x32c,-0x2bd,-0x2ca,-0x31e)](','),_0x4bee7b=_0x57d7c7[0x215a*-0x1+-0xd*0x1b+-0x3*-0xb93]['split'](':')[-0x102*-0x17+0xf15+-0x2642*0x1]['split'](';')[-0x26d5+-0x5*-0x663+0x1*0x6e6];nai3CharRefImageMimeType=_0x4bee7b,window[_0x30ca99(-0x32,-0x87,-0x59,-0x117)+_0x30ca99(-0x44,-0x76,0x1a,-0x24)]=_0x57d7c7[-0xeb9*-0x1+-0x47*0x86+0x1672];const _0x1cc0be={};_0x1cc0be['id']=NAI_CHAR_REF_CACHE_KEY,_0x1cc0be[_0x1657c6(-0x223,-0x29d,-0x30f,-0x2d8)]=_0x834598,dbs[_0x1657c6(-0x2ab,-0x267,-0x1e1,-0x2b0)+_0x30ca99(0x48,-0x24,-0xa1,-0x2e)](_0x1cc0be);}}else{const _0x4ab2f0=_0x2ff737[_0x30ca99(0xb,-0x3c,-0x1d,-0x4b)][_0x30ca99(-0x3b,-0x4c,-0x63,-0x36)]('|');let _0x51068b=0x67b+-0x1a*0x61+0x35f;while(!![]){switch(_0x4ab2f0[_0x51068b++]){case'0':_0x430592[_0x30ca99(-0x39,-0x70,0x10,-0x7d)][_0x1657c6(-0x2f0,-0x348,-0x2f0,-0x313)]=_0x2ff737[_0x1657c6(-0x289,-0x255,-0x2af,-0x1c5)];continue;case'1':window[_0x1657c6(-0x388,-0x2f8,-0x290,-0x28a)+_0x30ca99(-0x5f,-0x76,-0x15,-0xec)]=null;continue;case'2':_0x2bd6fc[_0x1657c6(-0x370,-0x2e1,-0x31c,-0x295)][_0x1657c6(-0x366,-0x348,-0x315,-0x353)]=_0x2ff737['wkktc'];continue;case'3':_0x2bd6fc[_0x30ca99(-0xc6,-0x60,-0x30,-0x7a)]='';continue;case'4':_0x211738['style'][_0x30ca99(-0xc5,-0xd7,-0x49,-0x100)]='none';continue;}break;}}}function removeNovelaiCharRefImage(){updateNovelaiCharRefImagePreview(null);function _0x53cac1(_0x21061f,_0xafb797,_0x528795,_0x5e9198){return _0x16c038(_0x528795- -0x1a1,_0xafb797-0x2f,_0xafb797,_0x5e9198-0x7a);}dbs[_0x53cac1(0x54,0x43,-0x1,-0x52)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x2c8baa){const _0x58635e={'QNGVN':function(_0x475c73,_0xfdcc7c){return _0x475c73(_0xfdcc7c);},'hQzHx':'Error\x20proc'+_0x2c833f(0x424,0x433,0x40a,0x44a)+_0x2c833f(0x51f,0x49e,0x537,0x4a9)+_0x411330(0x174,0x1ab,0xf1,0x103),'kSQUw':function(_0x5f1cd2,_0x3a3f65){return _0x5f1cd2+_0x3a3f65;}};function _0x2c833f(_0x477439,_0x590d8c,_0x46af16,_0x14398c){return _0x16c038(_0x14398c-0x383,_0x590d8c-0x1e1,_0x590d8c,_0x14398c-0x21);}const _0x467fbf=_0x2c8baa[_0x411330(0xa9,0x2e,0x8b,0x6b)]['files'][-0xce8+0xce3*0x1+0x5];function _0x411330(_0x6bff1,_0x19a512,_0x3eeefa,_0x4e22ef){return _0x16c038(_0x6bff1- -0x8,_0x19a512-0x14c,_0x4e22ef,_0x4e22ef-0xcb);}if(!_0x467fbf)return;try{const _0x1eff82=await processUploadedImage(_0x467fbf);_0x58635e['QNGVN'](updateNovelaiCharRefImagePreview,_0x1eff82);}catch(_0x15069f){console[_0x411330(0xf4,0xdc,0xb5,0xe0)](_0x58635e[_0x2c833f(0x4d5,0x497,0x4b1,0x4ca)],_0x15069f),alert(_0x58635e[_0x2c833f(0x4b1,0x455,0x502,0x4d0)]('图片处理失败:\x20',_0x15069f[_0x411330(0x18f,0x1ac,0x20a,0x141)]));}}function updateComfyUIImagePreview(_0x8d3e2a){function _0x3fa35d(_0x57c4ad,_0x5b1c32,_0x26c295,_0xc225aa){return _0x16c038(_0x26c295- -0x133,_0x5b1c32-0x108,_0x5b1c32,_0xc225aa-0x39);}const _0x123fc0={};_0x123fc0[_0xbec1c9(-0x215,-0x265,-0x2a7,-0x24a)]=_0xbec1c9(-0x2c3,-0x250,-0x26e,-0x2ac)+_0x3fa35d(0x22,0x69,-0xc,0x2d)+_0x3fa35d(-0x46,-0x36,-0x69,0x18)+_0x3fa35d(-0xa,-0xde,-0x9a,-0x6c)+_0xbec1c9(-0x19d,-0x1f2,-0x23c,-0x199)+_0xbec1c9(-0x1ba,-0x1e1,-0x224,-0x270)+'r',_0x123fc0['lOBxg']=_0x3fa35d(-0xe9,-0xab,-0x93,-0xfc),_0x123fc0['ehKtq']=_0xbec1c9(-0x29f,-0x22d,-0x1ad,-0x1b5),_0x123fc0[_0x3fa35d(0x1a,0x3,-0x66,-0xf5)]='inline-fle'+'x',_0x123fc0[_0x3fa35d(-0x25,-0x9a,-0x72,-0x2e)]=_0xbec1c9(-0x280,-0x220,-0x257,-0x1e2),_0x123fc0[_0x3fa35d(0xbe,0x9e,0x71,0x73)]=_0x3fa35d(0x25,0x1,0x5d,0xb8),_0x123fc0[_0xbec1c9(-0x2cd,-0x240,-0x1c0,-0x24e)]=_0x3fa35d(-0xae,-0xd,-0x53,-0x54)+'5',_0x123fc0[_0xbec1c9(-0x23d,-0x1d4,-0x259,-0x25c)]='flex';const _0x754cc5=_0x123fc0;function _0xbec1c9(_0x3f1e23,_0x254644,_0x302a0c,_0x4ebcf1){return _0x15af83(_0x254644- -0x193,_0x254644-0x1dc,_0x302a0c,_0x4ebcf1-0x176);}const _0x1f9085=document[_0xbec1c9(-0x209,-0x1fd,-0x1e2,-0x249)+'ById'](_0xbec1c9(-0x20e,-0x1ed,-0x26e,-0x209)+_0x3fa35d(-0x43,-0x5b,-0xae,-0x49)),_0x261b3b=document['querySelec'+_0x3fa35d(-0xd,-0xa,-0x87,-0x93)](_0x754cc5[_0xbec1c9(-0x297,-0x265,-0x2d4,-0x240)]),_0xf16d4a=document['getElement'+_0xbec1c9(-0x24f,-0x2d9,-0x24f,-0x33b)](_0xbec1c9(-0x1e8,-0x208,-0x245,-0x186)+_0x3fa35d(0xb4,0x82,0x67,0xb4)+_0x3fa35d(0xba,-0x38,0x2a,0xaa));_0x1f9085['src']&&_0x1f9085['src'][_0x3fa35d(-0x67,-0x5a,-0x83,-0x7c)]('blob:')&&_0x1f9085[_0xbec1c9(-0x257,-0x25a,-0x1f3,-0x1e5)]!==_0x8d3e2a&&URL[_0xbec1c9(-0x1f5,-0x24d,-0x284,-0x2da)+_0xbec1c9(-0x1a5,-0x217,-0x27d,-0x1e2)](_0x1f9085[_0xbec1c9(-0x27d,-0x25a,-0x25e,-0x2a1)]);if(_0x8d3e2a)_0x1f9085['src']=_0x8d3e2a,_0x1f9085[_0xbec1c9(-0x277,-0x26a,-0x2aa,-0x23d)][_0x3fa35d(-0x31,-0x1a,-0xa5,-0x4e)]=_0x754cc5[_0xbec1c9(-0x201,-0x275,-0x2ad,-0x201)],_0x261b3b[_0x3fa35d(-0xa8,0xc,-0x3e,-0x31)][_0xbec1c9(-0x312,-0x2d1,-0x2b6,-0x2c3)]=_0x754cc5['ehKtq'],_0xf16d4a['style']['display']=_0x754cc5[_0xbec1c9(-0x22e,-0x292,-0x2a0,-0x317)];else{if(_0x754cc5[_0x3fa35d(-0xe2,-0x37,-0x72,0x1c)]===_0x754cc5[_0x3fa35d(0x49,0xe7,0x71,0xb3)]){const _0x72ce07=_0x2f3a37['apply'](_0x6d00aa,arguments);return _0x37d30c=null,_0x72ce07;}else{const _0x4477cd=_0x754cc5['xnqks'][_0x3fa35d(0x29,-0x20,-0x1a,0x56)]('|');let _0x384761=0x1c84+0x2398+0x4*-0x1007;while(!![]){switch(_0x4477cd[_0x384761++]){case'0':_0x261b3b[_0x3fa35d(-0xb7,-0x21,-0x3e,-0x6b)][_0xbec1c9(-0x2d2,-0x2d1,-0x2f8,-0x31f)]=_0x754cc5[_0x3fa35d(0x64,0x38,0x58,0x34)];continue;case'1':_0xf16d4a[_0x3fa35d(-0xc4,-0x64,-0x3e,0x38)][_0xbec1c9(-0x303,-0x2d1,-0x345,-0x2d4)]=_0x754cc5[_0xbec1c9(-0x2bd,-0x249,-0x28e,-0x257)];continue;case'2':_0x1f9085[_0xbec1c9(-0x222,-0x26a,-0x280,-0x22b)]['display']=_0xbec1c9(-0x2a9,-0x22d,-0x1f7,-0x1d7);continue;case'3':window['comfyuican'+'kaotupian']=null;continue;case'4':_0x1f9085[_0xbec1c9(-0x1f0,-0x25a,-0x2e0,-0x24c)]='';continue;case'5':comfyuiImageObjectURL=null;continue;}break;}}}}function removeComfyUIImage(){const _0x3bda39={'OItdx':function(_0x5c9519,_0x180b4c){return _0x5c9519(_0x180b4c);}};_0x3bda39[_0x37505b(-0x1b5,-0x18e,-0x1e7,-0x220)](updateComfyUIImagePreview,null);function _0x220f04(_0xbaab62,_0x5c4148,_0x38eec3,_0x2301cd){return _0x16c038(_0x2301cd-0x6f,_0x5c4148-0x98,_0x5c4148,_0x2301cd-0x196);}function _0x37505b(_0x5a4153,_0x1464d3,_0x17333c,_0x5a49c4){return _0x16c038(_0x17333c- -0x321,_0x1464d3-0x71,_0x5a4153,_0x5a49c4-0x72);}dbs[_0x220f04(0x283,0x253,0x22c,0x20f)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x3af02b){const _0x75239f={'zhlaf':_0x4e795c(0x63,-0x33,0x39,0xc)+'+$','PhORU':function(_0x36d896,_0x446f7b){return _0x36d896+_0x446f7b;},'WEzVq':'图片处理或上传时出错'+':','TBxxw':function(_0x16a1d5){return _0x16a1d5();},'ztlMw':function(_0x45487b,_0x235c69){return _0x45487b(_0x235c69);},'YfADc':function(_0x47fd89,_0x53e96c){return _0x47fd89===_0x53e96c;},'XwSjV':_0x39fec7(0x19c,0x225,0x1f2,0x215),'rWjnZ':function(_0x5b277e,_0xb0f724){return _0x5b277e(_0xb0f724);},'ywcBU':_0x4e795c(0xba,0x30,0x47,0x42),'OdJds':'OSZCi','emraI':'nnwvl','ZiBVW':function(_0x9dce78,_0x21d75b){return _0x9dce78(_0x21d75b);},'gZufq':_0x39fec7(0x121,0x158,0x125,0xe2)+_0x39fec7(0x18c,0xfe,0x212,0x1f6),'isnKi':function(_0x389fcb,_0x45f21b,_0x1bc90f){return _0x389fcb(_0x45f21b,_0x1bc90f);},'VJGXL':function(_0x202e1d,_0xca15aa){return _0x202e1d===_0xca15aa;},'eRnSb':_0x39fec7(0x10c,0x136,0x142,0xa5),'kUBkw':function(_0x3f4998,_0x364bdf){return _0x3f4998(_0x364bdf);},'Ybkmg':_0x4e795c(-0x75,-0x80,-0x6,0x0),'ROeVF':_0x39fec7(0xf4,0xf2,0x16e,0xca),'vsSvR':'图片处理或上传时出错'+':\x20'};function _0x39fec7(_0x6e158d,_0x193e0f,_0xbe4dd8,_0x295f56){return _0x15af83(_0x6e158d-0x234,_0x193e0f-0x11d,_0x193e0f,_0x295f56-0xfd);}function _0x4e795c(_0x57226d,_0x255c6d,_0x5e9db8,_0x371eec){return _0x15af83(_0x371eec-0x82,_0x255c6d-0x34,_0x57226d,_0x371eec-0xb7);}const _0x4d0c7a=extension_settings[extensionName],_0x45bdb0=_0x3af02b[_0x39fec7(0x119,0xe3,0xc7,0xac)][_0x39fec7(0x1f9,0x171,0x262,0x1ac)][0x2d7*-0x1+-0x1b*-0xd0+-0x1319];if(!_0x45bdb0)return;try{if(_0x75239f[_0x39fec7(0x20a,0x1f4,0x1ee,0x297)](_0x75239f['XwSjV'],_0x75239f['XwSjV'])){const _0x3aaec6=await _0x75239f[_0x4e795c(-0x108,-0x115,-0xc3,-0xc1)](processUploadedImageToBlob,_0x45bdb0),_0x119b5d=URL[_0x39fec7(0x1c1,0x159,0x19d,0x1a6)+_0x4e795c(0x1a,0x23,0x30,-0x2)](_0x3aaec6);comfyuiImageObjectURL=_0x119b5d,updateComfyUIImagePreview(_0x119b5d);const _0x1fc541=new FormData();_0x1fc541[_0x4e795c(0x52,-0x74,0x46,-0x1d)](_0x75239f[_0x4e795c(-0x48,-0x16,0x9,-0x67)],_0x3aaec6,_0x45bdb0['name']);let _0x5b49e2=_0x4d0c7a['comfyuiUrl'][_0x39fec7(0x16f,0x105,0x18d,0x118)]();if(!_0x5b49e2){if(_0x75239f['YfADc'](_0x75239f['OdJds'],_0x75239f[_0x4e795c(-0x73,-0xd5,-0x2f,-0xb8)]))return _0x5ca343[_0x4e795c(0x42,-0x1d,-0x5f,0x2c)]()[_0x39fec7(0x139,0x126,0xb4,0x18b)](xsdrYt[_0x4e795c(-0x37,-0xa2,-0x26,-0xae)])['toString']()['constructo'+'r'](_0x5e1470)[_0x4e795c(-0xae,-0xc,-0x27,-0x79)](xsdrYt['zhlaf']);else{_0x75239f['ZiBVW'](alert,_0x75239f[_0x39fec7(0x206,0x25e,0x211,0x23a)]),_0x75239f['TBxxw'](removeComfyUIImage);return;}}const _0x5c8071={};_0x5c8071[_0x39fec7(0x147,0x16e,0x147,0x1a4)]=_0x39fec7(0x151,0x181,0x147,0x12f),_0x5c8071['body']=_0x1fc541;const _0x202e02=await _0x75239f['isnKi'](fetch,_0x5b49e2+(_0x39fec7(0x116,0x15f,0x145,0xb6)+_0x4e795c(-0xbf,-0xd2,-0x53,-0xa1)),_0x5c8071);if(_0x202e02['ok']){if(_0x75239f[_0x39fec7(0x1dc,0x1e4,0x249,0x199)](_0x4e795c(-0x5b,-0x19,-0xc6,-0x37),_0x75239f[_0x39fec7(0x17d,0x1ea,0x1b8,0x123)]))_0x365454(_0x75239f[_0x4e795c(-0xf2,-0x41,-0xc0,-0xbb)](_0x39fec7(0x11d,0xf4,0x11a,0x1a6)+':\x20',_0x112780[_0x39fec7(0x1ff,0x1e9,0x22f,0x1dd)])),_0x15736e['error'](_0x75239f[_0x4e795c(0x21,-0x3c,-0xc,0x49)],_0x215b05),_0x5d4702(_0x39fec7(0x1f6,0x238,0x165,0x1a8)+'详情:\x20'+_0x5426ca[_0x39fec7(0x1fd,0x22f,0x1bd,0x1c4)](_0x76b58e)),_0x75239f[_0x39fec7(0x1b7,0x225,0x149,0x128)](_0x1b6e0f);else{const _0xd38465=await _0x202e02[_0x4e795c(-0xff,-0x2a,-0x37,-0xb6)]();window[_0x4e795c(0x5c,-0x41,0xbc,0x3e)+'kaotupian']=_0xd38465[_0x4e795c(0x90,-0x1b,0x44,0x1d)],addLog('图片上传成功,\x20服务'+_0x39fec7(0x10b,0x10d,0x125,0xe0)+JSON[_0x39fec7(0x1fd,0x188,0x171,0x22f)](_0xd38465)),console['log'](_0x39fec7(0x194,0x20c,0x193,0x1a1)+_0x4e795c(-0x2c,-0x17,-0x6a,-0x86),_0xd38465);const _0x1fc322=new FileReader();_0x1fc322[_0x39fec7(0x179,0x161,0xfa,0x162)]=()=>{const _0x3f3f5e=_0x1fc322[_0x9a986d(0x1ab,0x11f,0x1e4,0x1e1)],_0x38296f={};_0x38296f['data']=_0x3f3f5e;function _0x9a986d(_0x50283d,_0x48d78e,_0x242041,_0x199e47){return _0x39fec7(_0x50283d- -0x2d,_0x242041,_0x242041-0x72,_0x199e47-0xe0);}_0x38296f['serverFile'+_0x2a3970(0x44c,0x47d,0x3e6,0x421)]=_0xd38465[_0x9a986d(0x1a2,0x1ec,0x184,0x185)];const _0xa7c9e5=_0x38296f;function _0x2a3970(_0x12739e,_0x3328bf,_0x201544,_0x5c75ff){return _0x39fec7(_0x12739e-0x314,_0x3328bf,_0x201544-0x45,_0x5c75ff-0x188);}const _0x4c43d6={};_0x4c43d6['id']=COMFYUI_REF_CACHE_KEY,_0x4c43d6['data']=_0xa7c9e5,dbs[_0x2a3970(0x4eb,0x4b1,0x4e6,0x4af)+_0x2a3970(0x4bd,0x51f,0x537,0x52c)](_0x4c43d6);},_0x1fc322[_0x4e795c(-0x10,-0x6d,-0xa3,-0x74)+_0x4e795c(0x22,-0xa1,-0xab,-0x46)](_0x3aaec6);}}else{const _0x27a7fd=await _0x202e02['text']();_0x75239f[_0x4e795c(-0x58,-0xf,0x39,0x1f)](alert,_0x75239f[_0x39fec7(0x180,0x1d5,0x1e4,0x1a3)]+_0x27a7fd),_0x75239f['rWjnZ'](addLog,_0x4e795c(0x12,-0x26,-0x44,0x44)+_0x4e795c(0x1,-0x28,-0x88,0x7)+_0x27a7fd),console['error'](_0x75239f['ROeVF'],_0x27a7fd),removeComfyUIImage();}}else{_0x75239f[_0x4e795c(-0x36,-0x72,0x88,0x9)](_0xc82a66,_0x4e795c(-0x8c,-0x9a,-0x1f,-0x91)+_0x39fec7(0x18c,0x134,0x18c,0x174)),_0x75239f['TBxxw'](_0x460a27);return;}}catch(_0x277e5e){_0x75239f[_0x39fec7(0x10f,0x156,0x120,0x165)](alert,_0x75239f[_0x39fec7(0xf7,0x125,0x108,0x16c)](_0x75239f[_0x39fec7(0x18b,0x14e,0x114,0x11a)],_0x277e5e['message'])),console[_0x4e795c(-0xd2,-0x36,-0x9a,-0x4e)](_0x75239f[_0x4e795c(0x42,-0x9,0x2e,0x49)],_0x277e5e),addLog(_0x39fec7(0x1f6,0x1c4,0x23b,0x1a2)+_0x39fec7(0x1b9,0x21e,0x215,0x167)+JSON['stringify'](_0x277e5e)),removeComfyUIImage();}}async function loadCachedImages(){function _0x5dc665(_0x4f3a02,_0x2b6fd4,_0x41d372,_0x1101cf){return _0x16c038(_0x1101cf-0x258,_0x2b6fd4-0x1e2,_0x2b6fd4,_0x1101cf-0x7e);}const _0xd9e77d={'zVOkd':_0x5dc665(0x3c0,0x2c7,0x332,0x349)+_0x1f2871(0x497,0x3d7,0x410,0x39c)+_0x1f2871(0x3ff,0x39f,0x39e,0x3d5)+_0x1f2871(0x3f8,0x4b5,0x42c,0x40a)+_0x5dc665(0x39e,0x3b7,0x38d,0x37d),'QJPJv':_0x5dc665(0x378,0x357,0x3e6,0x3bb)+_0x1f2871(0x42c,0x475,0x3e5,0x457)+_0x1f2871(0x3f7,0x3d4,0x36b,0x356)+_0x5dc665(0x40e,0x3bf,0x330,0x39e)+_0x5dc665(0x38f,0x38c,0x3b7,0x35a)+_0x5dc665(0x31b,0x2e2,0x348,0x361)+'ing\x20new\x20sy'+_0x5dc665(0x424,0x38d,0x3dd,0x3cf),'aSlNW':_0x5dc665(0x370,0x37d,0x42e,0x3c9)+'3','AnOKY':_0x5dc665(0x2c0,0x37d,0x36f,0x30e),'leaLt':function(_0x590c8a,_0x481d9e){return _0x590c8a===_0x481d9e;},'CQhFE':_0x5dc665(0x2db,0x393,0x364,0x321),'djTlR':function(_0x3b190b,_0x28655b){return _0x3b190b(_0x28655b);},'gAtdn':function(_0x5cdf63,_0x265311){return _0x5cdf63!==_0x265311;},'skSiw':_0x5dc665(0x2e1,0x368,0x344,0x344),'XHoEs':_0x5dc665(0x3d1,0x3c8,0x399,0x39d),'BHpQc':function(_0x45ac29,_0x4b9d0c){return _0x45ac29===_0x4b9d0c;},'vlTVz':_0x1f2871(0x33b,0x30e,0x35e,0x302),'xxORR':function(_0x5d23b4,_0x47cca2){return _0x5d23b4(_0x47cca2);},'KPoPx':function(_0x272461,_0x24777b){return _0x272461(_0x24777b);},'XCNAy':function(_0x46ec91,_0x43f4b4){return _0x46ec91(_0x43f4b4);},'IrlPa':'Error\x20load'+'ing\x20cached'+_0x5dc665(0x43b,0x3f5,0x3c6,0x3b4)+_0x5dc665(0x319,0x2d0,0x2be,0x2f0)};await dbs['openDB']();try{const _0x4b9d74=await dbs[_0x1f2871(0x49d,0x43c,0x420,0x3e5)+_0x1f2871(0x3a2,0x3c5,0x40e,0x3d6)](NAI_VIBE_CACHE_KEY);_0x4b9d74&&_0x4b9d74[_0x5dc665(0x40c,0x359,0x304,0x391)]&&(_0xd9e77d[_0x1f2871(0x34a,0x2f4,0x347,0x313)](_0xd9e77d[_0x1f2871(0x38f,0x470,0x40c,0x451)],_0x1f2871(0x395,0x407,0x381,0x3fe))?_0x330343['error'](_0xd9e77d[_0x5dc665(0x27f,0x35b,0x2d8,0x307)],_0xfeb840):_0xd9e77d['djTlR'](updateNovelaiImagePreview,_0x4b9d74[_0x5dc665(0x400,0x3e7,0x400,0x391)]));}catch(_0x52f2bc){console[_0x1f2871(0x3da,0x3a6,0x38f,0x34f)](_0x5dc665(0x370,0x337,0x35c,0x349)+_0x5dc665(0x3cb,0x45f,0x3a4,0x3d5)+'\x20NovelAI\x20V'+'ibe\x20image:',_0x52f2bc);}try{if(_0xd9e77d[_0x1f2871(0x306,0x2e7,0x339,0x323)](_0xd9e77d[_0x5dc665(0x36f,0x414,0x32c,0x3a1)],_0xd9e77d[_0x1f2871(0x3fb,0x417,0x3ff,0x3aa)])){const _0x568725=await dbs[_0x5dc665(0x45c,0x3d6,0x476,0x3e5)+_0x1f2871(0x395,0x463,0x40e,0x442)](NAI_CHAR_REF_CACHE_KEY);_0x568725&&_0x568725['data']&&updateNovelaiCharRefImagePreview(_0x568725[_0x1f2871(0x38e,0x38c,0x3cc,0x453)]);}else{_0x451ec9['log'](_0xd9e77d[_0x5dc665(0x34c,0x3be,0x321,0x355)]);return;}}catch(_0x28343c){console['error'](_0x5dc665(0x33d,0x35c,0x31a,0x349)+_0x1f2871(0x387,0x477,0x410,0x382)+_0x1f2871(0x3c1,0x408,0x39e,0x3f6)+'har\x20Ref\x20im'+'age:',_0x28343c);}function _0x1f2871(_0x5089e9,_0x2a5740,_0x1b5bad,_0x1a8fe1){return _0x16c038(_0x1b5bad-0x293,_0x2a5740-0x135,_0x1a8fe1,_0x1a8fe1-0x16e);}try{const _0x26a271=await dbs[_0x1f2871(0x426,0x397,0x420,0x45d)+_0x5dc665(0x43c,0x3dc,0x3fc,0x3d3)](COMFYUI_REF_CACHE_KEY);if(_0x26a271&&_0x26a271[_0x1f2871(0x403,0x44f,0x3cc,0x42e)]&&_0x26a271[_0x1f2871(0x3ec,0x370,0x3cc,0x3d5)][_0x5dc665(0x36d,0x3fc,0x397,0x391)]&&_0x26a271[_0x5dc665(0x362,0x366,0x34f,0x391)][_0x1f2871(0x3c6,0x41f,0x392,0x3ff)+'Name']){if(_0xd9e77d[_0x1f2871(0x29e,0x2b1,0x32d,0x2b9)](_0xd9e77d[_0x5dc665(0x2f2,0x370,0x353,0x326)],_0xd9e77d[_0x1f2871(0x303,0x373,0x361,0x304)])){const _0x4996c9=_0x26a271['data'],_0x249dc7=await _0xd9e77d['xxORR'](fetch,_0x4996c9[_0x1f2871(0x40e,0x37c,0x3cc,0x3a2)]),_0x2b8e03=await _0x249dc7['blob'](),_0x2aac22=URL[_0x1f2871(0x3d6,0x3fb,0x3ec,0x36b)+_0x5dc665(0x3de,0x31e,0x3ad,0x3a0)](_0x2b8e03);_0xd9e77d[_0x1f2871(0x3ea,0x3d9,0x37b,0x350)](updateComfyUIImagePreview,_0x2aac22),comfyuiImageObjectURL=_0x2aac22,window[_0x5dc665(0x41c,0x3e7,0x38a,0x3e0)+_0x1f2871(0x320,0x350,0x35b,0x3bc)]=_0x4996c9['serverFile'+_0x5dc665(0x3b7,0x2e5,0x398,0x328)],_0xd9e77d['XCNAy'](addLog,_0x1f2871(0x3c7,0x321,0x36e,0x3e7)+_0x1f2871(0x391,0x36a,0x3b0,0x42d)+_0x4996c9[_0x1f2871(0x3fd,0x422,0x392,0x389)+'Name']),console[_0x1f2871(0x393,0x2f2,0x330,0x366)](_0x5dc665(0x367,0x3b1,0x2a2,0x32f)+_0x5dc665(0x349,0x37c,0x3b9,0x3b3)+'\x20from\x20cach'+_0x5dc665(0x3e6,0x3e9,0x3a5,0x3d8)+_0x4996c9[_0x5dc665(0x347,0x35e,0x3d1,0x357)+_0x1f2871(0x33a,0x365,0x363,0x3e0)]);}else{const _0x4cab73=_0xd9e77d['aSlNW'][_0x5dc665(0x339,0x31a,0x325,0x371)]('|');let _0xde4a3=-0x16fb+0x12b*0xd+-0x1*-0x7cc;while(!![]){switch(_0x4cab73[_0xde4a3++]){case'0':_0x110ed9[_0x1f2871(0x410,0x334,0x388,0x32d)][_0x1f2871(0x362,0x2a7,0x321,0x2d8)]=_0xd9e77d['AnOKY'];continue;case'1':_0x84915c['style'][_0x1f2871(0x372,0x349,0x321,0x2fd)]=_0x5dc665(0x3e2,0x333,0x3cc,0x38a);continue;case'2':_0x2a9039[_0x1f2871(0x351,0x390,0x388,0x34d)][_0x5dc665(0x35d,0x26f,0x2cb,0x2e6)]=_0x5dc665(0x3a0,0x30d,0x334,0x38a);continue;case'3':_0x592e6f=null;continue;case'4':_0x27d79d['comfyuican'+_0x1f2871(0x2f8,0x349,0x35b,0x32c)]=null;continue;case'5':_0x3a6217['src']='';continue;}break;}}}else{if(_0x26a271&&_0xd9e77d[_0x5dc665(0x299,0x28e,0x330,0x2f2)](typeof _0x26a271[_0x1f2871(0x455,0x42b,0x3cc,0x446)],_0x1f2871(0x432,0x41c,0x3a1,0x3b9))){const _0x56ca9f=await _0xd9e77d[_0x1f2871(0x3f8,0x36e,0x37b,0x3af)](fetch,_0x26a271['data']),_0x4ebe36=await _0x56ca9f[_0x5dc665(0x351,0x2df,0x39c,0x359)](),_0x39ae1f=URL['createObje'+_0x5dc665(0x379,0x364,0x373,0x3a0)](_0x4ebe36);_0xd9e77d['xxORR'](updateComfyUIImagePreview,_0x39ae1f),comfyuiImageObjectURL=_0x39ae1f,console[_0x5dc665(0x3cd,0x3d1,0x32c,0x376)](_0x5dc665(0x2cc,0x2f3,0x37e,0x32f)+_0x5dc665(0x352,0x404,0x3da,0x3b3)+_0x5dc665(0x2e5,0x2e7,0x309,0x373)+_0x5dc665(0x416,0x3f7,0x3ec,0x38f)+'at.\x20Please'+_0x1f2871(0x386,0x3e1,0x401,0x41d)+_0x5dc665(0x301,0x354,0x355,0x379)+'\x20cache\x20to\x20'+_0x5dc665(0x3fa,0x3f6,0x37e,0x39c)+_0x1f2871(0x478,0x3e3,0x3f9,0x3a4));}}}catch(_0x2ad780){console[_0x1f2871(0x3a1,0x35e,0x38f,0x404)](_0xd9e77d[_0x1f2871(0x43b,0x409,0x3af,0x43f)],_0x2ad780);}}export function initImageUpload(_0x3652ef){const _0x2626da={'BegQZ':_0x13c15b(-0xd3,-0xa1,-0xbb,-0xe7)+'2','qWJwE':function(_0x59e434,_0x1da503){return _0x59e434===_0x1da503;},'JQwrW':_0x13c15b(-0xed,-0xec,-0x123,-0x60),'CvNgF':'imageInput'+_0x79ca4d(-0x2aa,-0x24a,-0x301,-0x305),'RHDhx':'imageInput'+_0x79ca4d(-0x1cf,-0x207,-0x1ab,-0x15a)+'ref','wgwAK':function(_0x59b91e){return _0x59b91e();},'cYbDz':_0x79ca4d(-0x2c7,-0x2c5,-0x2c5,-0x2ed),'Pzwtb':'none','TKaXE':_0x13c15b(-0x9d,-0x6e,-0xed,-0x105)+'x','ghFCz':_0x13c15b(-0xf9,-0xd3,-0x172,-0xc8),'xHZBJ':function(_0x330363){return _0x330363();},'PmQHm':_0x13c15b(-0x16c,-0xf3,-0x1dd,-0x1b4)+_0x13c15b(-0x108,-0x162,-0xa8,-0x134)+_0x13c15b(-0x11d,-0x10d,-0xc8,-0xa9),'nkJVI':'click','EitnJ':'change','bWmbV':_0x13c15b(-0x10a,-0x107,-0x109,-0xe2)+_0x79ca4d(-0x1cc,-0x17c,-0x22b,-0x15a)+'e-btn','HbpuF':_0x13c15b(-0x16c,-0x1f9,-0x116,-0x1a2)+_0x13c15b(-0x149,-0x165,-0xd5,-0xd7)+_0x79ca4d(-0x217,-0x265,-0x1c1,-0x220)+'-btn','VpDoD':_0x79ca4d(-0x2cc,-0x2cc,-0x282,-0x339)+'t_nai_char'+'_ref','fqieG':_0x79ca4d(-0x270,-0x2ce,-0x294,-0x2a2)+_0x13c15b(-0x174,-0x11f,-0x15c,-0x1d9)+_0x79ca4d(-0x217,-0x226,-0x243,-0x24c)+_0x79ca4d(-0x20a,-0x24c,-0x18c,-0x1b4),'vBeSK':_0x13c15b(-0x166,-0x1bb,-0x167,-0x1d1)+'t2','CceaM':_0x79ca4d(-0x2c5,-0x2b9,-0x28b,-0x29b)+_0x13c15b(-0x66,-0x41,-0x6d,0x17)+_0x13c15b(-0x11d,-0x10f,-0xb8,-0x156)};function _0x79ca4d(_0x4392fa,_0x26c0cb,_0x2d53bd,_0x372213){return _0x16c038(_0x4392fa- -0x367,_0x26c0cb-0x99,_0x372213,_0x372213-0x11d);}_0x2626da[_0x79ca4d(-0x1ff,-0x25a,-0x275,-0x1a1)](loadCachedImages),_0x3652ef[_0x79ca4d(-0x2bf,-0x243,-0x313,-0x259)](_0x2626da[_0x13c15b(-0xac,-0xcf,-0xcd,-0x11d)])['on'](_0x2626da[_0x13c15b(-0xc6,-0x139,-0x80,-0x147)],()=>{function _0x56f64c(_0x60ec53,_0x55f9a5,_0x321367,_0x45e81f){return _0x13c15b(_0x55f9a5-0x1e3,_0x45e81f,_0x321367-0x1c0,_0x45e81f-0xbe);}const _0x4a921f={};_0x4a921f['cVxUe']=_0x2626da[_0x56f64c(0xc1,0x14c,0x127,0x161)];function _0x4b22bf(_0x3773b1,_0xb3e3d7,_0x1c72b6,_0x4be468){return _0x13c15b(_0x4be468- -0x53,_0x3773b1,_0x1c72b6-0x72,_0x4be468-0x1a5);}const _0x4c3dad=_0x4a921f;_0x2626da[_0x56f64c(-0x16,0x73,0xe,0xf)](_0x2626da['JQwrW'],_0x2626da[_0x4b22bf(-0x14c,-0x163,-0x198,-0x17f)])?document[_0x56f64c(0x18b,0x144,0x12a,0x1c1)+_0x56f64c(-0x4,0x68,0x1a,0xf3)](_0x2626da[_0x56f64c(0x8c,0xa1,0x54,0xf5)])[_0x4b22bf(-0x170,-0x140,-0x154,-0x1cc)]():_0x24fdb1[_0x56f64c(0x14a,0x144,0x102,0x141)+_0x4b22bf(-0x20e,-0x14d,-0x239,-0x1ce)](_0x4c3dad[_0x56f64c(0xa,0x72,0x3b,0x66)])[_0x56f64c(0xa4,0x6a,0xd3,0xe0)]();}),_0x3652ef[_0x79ca4d(-0x2bf,-0x32d,-0x2fb,-0x2ff)](_0x79ca4d(-0x2cc,-0x290,-0x318,-0x24b)+'t_novelai')['on'](_0x2626da['EitnJ'],handleNovelaiImageUpload),_0x3652ef[_0x79ca4d(-0x2bf,-0x30c,-0x25e,-0x2f9)](_0x2626da[_0x13c15b(-0x163,-0x12f,-0xe5,-0x174)])['on'](_0x2626da[_0x79ca4d(-0x22c,-0x23d,-0x1bd,-0x1ae)],()=>{removeNovelaiImage();}),_0x3652ef[_0x79ca4d(-0x2bf,-0x2ac,-0x32c,-0x288)](_0x2626da['HbpuF'])['on'](_0x2626da[_0x79ca4d(-0x22c,-0x26d,-0x1a0,-0x2ad)],()=>{function _0x3e494b(_0x18f8be,_0x4c91e1,_0x489dd8,_0x4f3316){return _0x79ca4d(_0x489dd8-0x278,_0x4c91e1-0x156,_0x489dd8-0xf7,_0x18f8be);}function _0x207272(_0x58ff90,_0x1820aa,_0x37d50b,_0x5054ae){return _0x79ca4d(_0x58ff90-0x2cd,_0x1820aa-0x1c9,_0x37d50b-0x153,_0x1820aa);}document[_0x207272(0xc8,0xe5,0x80,0x109)+'ById'](_0x2626da[_0x3e494b(0x62,0x4c,0xf,0x53)])['click']();}),_0x3652ef[_0x13c15b(-0x159,-0xe4,-0x17d,-0x166)](_0x2626da[_0x79ca4d(-0x2ad,-0x304,-0x227,-0x244)])['on'](_0x2626da[_0x79ca4d(-0x1e1,-0x1b8,-0x260,-0x22f)],handleNovelaiCharRefImageUpload),_0x3652ef[_0x79ca4d(-0x2bf,-0x24a,-0x2d4,-0x326)](_0x2626da[_0x13c15b(-0x124,-0x100,-0x98,-0xd2)])['on'](_0x13c15b(-0x179,-0x168,-0x1af,-0x1bd),()=>{function _0xfb7f13(_0x373f5d,_0xb21196,_0x39481e,_0x33f366){return _0x79ca4d(_0x33f366-0x4d,_0xb21196-0x16a,_0x39481e-0x83,_0x39481e);}_0x2626da[_0xfb7f13(-0x133,-0x14f,-0x232,-0x1b2)](removeNovelaiCharRefImage);});function _0x13c15b(_0x571264,_0x5ea685,_0x40a19a,_0x303363){return _0x16c038(_0x571264- -0x201,_0x5ea685-0x28,_0x5ea685,_0x303363-0x16b);}_0x3652ef['find'](_0x13c15b(-0xc5,-0xb3,-0x127,-0x49)+_0x13c15b(-0x108,-0x10b,-0x169,-0xa7)+_0x79ca4d(-0x283,-0x213,-0x2a9,-0x308))['on'](_0x2626da['nkJVI'],()=>{function _0x2b9938(_0x2d5cff,_0x55fc14,_0x1e914e,_0x2fe27a){return _0x79ca4d(_0x2fe27a-0x51,_0x55fc14-0x77,_0x1e914e-0x1b4,_0x1e914e);}function _0x45bd71(_0x5ba7cd,_0x2339cd,_0x38f210,_0x22e013){return _0x13c15b(_0x38f210- -0x12e,_0x2339cd,_0x38f210-0x11b,_0x22e013-0xaf);}document[_0x45bd71(-0x1f5,-0x1f2,-0x1cd,-0x160)+_0x2b9938(-0x258,-0x2bd,-0x23f,-0x290)](_0x2626da[_0x45bd71(-0x200,-0x253,-0x1c5,-0x137)])[_0x45bd71(-0x261,-0x32e,-0x2a7,-0x2e6)]();}),_0x3652ef[_0x79ca4d(-0x2bf,-0x2c5,-0x31c,-0x331)](_0x2626da[_0x13c15b(-0x162,-0xe9,-0x1a5,-0xee)])['on'](_0x2626da['EitnJ'],handleImageUpload2),_0x3652ef['find'](_0x2626da['CceaM'])['on'](_0x2626da[_0x13c15b(-0xc6,-0x40,-0x11c,-0x45)],()=>{const _0x1142db={};function _0xd10b08(_0x16577c,_0x5ef4e2,_0x58afd6,_0x3f8a46){return _0x79ca4d(_0x58afd6-0x46a,_0x5ef4e2-0x1ca,_0x58afd6-0x194,_0x3f8a46);}_0x1142db[_0xd10b08(0x282,0x175,0x1fe,0x26b)]=_0x2626da[_0xd10b08(0x276,0x304,0x27d,0x2df)],_0x1142db['ASAQO']=_0x2626da[_0x49c7b6(-0x154,-0x190,-0x184,-0x164)],_0x1142db[_0xd10b08(0x179,0x14a,0x1d5,0x242)]=_0x2626da[_0x49c7b6(-0x28f,-0x2cc,-0x2a9,-0x255)];function _0x49c7b6(_0x20d7a9,_0x2183eb,_0x2a64c5,_0x4463ab){return _0x13c15b(_0x4463ab- -0xd8,_0x20d7a9,_0x2a64c5-0xbd,_0x4463ab-0x17a);}const _0x36ff05=_0x1142db;if(_0x2626da[_0x49c7b6(-0x1fe,-0x237,-0x21e,-0x1b7)]===_0x2626da[_0xd10b08(0x215,0x249,0x225,0x27b)])_0x2626da[_0xd10b08(0x151,0x234,0x1b0,0x201)](removeComfyUIImage);else{_0x4f694e[_0x49c7b6(-0x1e6,-0x1bf,-0x1cc,-0x1d4)]=_0x7972ed,_0x58199[_0xd10b08(0x241,0x223,0x1f8,0x1e2)][_0x49c7b6(-0x2a4,-0x28e,-0x288,-0x24b)]=_0x36ff05[_0xd10b08(0x237,0x1d8,0x1fe,0x211)],_0x44921c[_0xd10b08(0x1b1,0x26d,0x1f8,0x22d)][_0xd10b08(0x1d5,0x17e,0x191,0x117)]=_0x36ff05[_0xd10b08(0x258,0x277,0x1f9,0x1ba)],_0x27a870[_0x49c7b6(-0x1ef,-0x165,-0x154,-0x1e4)][_0x49c7b6(-0x1f3,-0x2aa,-0x2a1,-0x24b)]=_0x36ff05['XabHx'];const _0x1d03c7=_0x24ae21[_0x49c7b6(-0x1d5,-0x1ba,-0x205,-0x1c0)](','),_0x1fa7f1=_0x1d03c7[-0x220f*0x1+-0x1*-0xdfd+0x1412][_0x49c7b6(-0x18c,-0x1d6,-0x1b2,-0x1c0)](':')[-0x1226+0x332*-0x1+-0x445*-0x5][_0x49c7b6(-0x1b6,-0x199,-0x228,-0x1c0)](';')[-0x1bb0+0x139c+0x814];_0x5070ca=_0x1fa7f1,_0x51df2a['nai3CharRe'+_0x49c7b6(-0x1c3,-0x235,-0x179,-0x1ea)]=_0x1d03c7[0x99*0xc+0x1553+-0x1c7e];const _0x25dd5e={};_0x25dd5e['id']=_0x24272b,_0x25dd5e[_0xd10b08(0x26b,0x29f,0x23c,0x28a)]=_0x530857,_0x2546ab[_0x49c7b6(-0x1ca,-0xe2,-0x193,-0x16a)+'rite'](_0x25dd5e);}});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};function _0x2fd5(){const _0x378499=['zgLZCgXHEq','ugHpuLu','y1z4vwu','CvDkD0u','zw1YyuK','i25VDMvSywKTAq','ANnVBG','i25VDMvSywKTCW','tw1xrKO','u3Dsrxa','BwfNztO','zxiGlNn0lwnOyq','qKHWuwm','i2LTywDLsw5WDq','EMHSywy','Bg9N','yLDTyLy','DKjLu0S','yMXVy2S','i25VDMvSywKTyW','i2nVBwz5DwKTCG','5zMO6l+u5zUE5PwW5O2UoIa','r3jltwS','BLDgyK0','z0f0zg4','wMLcvLC','zMLUza','ywDL','tejuv2q','wM1OA3K','Dg9Y','EeHAqKO','l3vWBg9Hzc9PBq','ELzpA2q','C3rHCNrZv2L0Aa','DgfYz2v0','uuzXs1G','m3WYFdb8nhWX','BgvHthq','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','zMXLEa','Bw92zs1JAgfYlq','zwXLy3qTy2HHCG','6k+35ywi6k6+572Uq29TzNLv','vNbeB0q','C0PQz2u','sLL5weu','x25VDMvSywK','BM92zwXHAs1Yzq','q3zoz0y','qMnfq2G','Cwnwvvu','y29UC3rYDwn0BW','quv3Ewq','5zUE5PwW5O2UoG','D2L3wvu','rxjYB3iGChjVyW','zxnZAw5Nie5VDG','A2fVDhvWAwfU','seXRyLm','zxCTy29UDgfPBG','q2Pgwwu','vM1Lr0y','r0HXDxm','DMXuvNO','zgf0ytPPBwfNzq','tMfTzq','C2vHCMnO','wgfIshG','mJGWmZqZtvDHr2rY','C0rYwKK','sLf3CLC','CMvHzefZrgf0yq','tg9HzgvKienVBq','DgvYihjLzMvYzq','z2vFBMfPx2nOyq','qLnmte0','5lUo57Yt5A2y5yQG6l29q29TzNK','CxvLCNLtzwXLyW','zNfPzuC','BMfPm0nOyxjszq','Bwv0Ag9K','nhWYFdb8mxWZFa','ELj6z2m','C3H4Bem','ExDJqLu','zs1IDg4','z1DtqNy','mtvPEgP6B2m','CMvMlwLTywDLlq','s1bVuhG','ue9tva','Be9cEgC','ndeXtfLTvMHd','vvveuLC','m3WWFdj8mxW0','veTAEM0','zKLTywDL','tK5vt0C','rxjYB3iGBg9Hza','ufroAhe','nJmYmZG2mhb1CNPVta','r1zPEvK','C3r5Bgu','qvnbuu8','i25VDMvSywKTCG','DeDfz00','zwXLy3qTAw1HzW','qNvzEe4','sKX3Dxy','zxjYB3i','uuPqsNy','uKHeAhG','C2vYDMvYrMLSzq','ywDLlxbYzxzPzq','yMXVyG','BwvUDhmGBM90ia','zwzFAw1Hz2u','vvjm','C3jJ','shnoswG','DhjPBq','rfnNr3u','zM91BMqGlsb1CW','ntuXnda4nhjJruXdzW','ie5VDMvSquKGqW','rLnTthi','zwXbssbPBwfNzq','C3rYAw5N','i2nVBwz5DwKTAq','y2fJAgvFy29TzG','B25SB2fKzw5K','CMv2B2TLt2jQzq','s3rUBuS','D1rYCva','zvjUu2i','zwHlDhe','mta2mdq5mJrgAKDgBgy','wwjRBwC','C3bSAxq','qMLLB3u','igzYB20GB2XKia','sxjSuge','vuNLM77NIyC6ia','D2fYBG','Eg5XA3m','BffSuKG','ihrVihvWzgf0zq','z2Hgq3O','DNntDLi','ssbbueNLNldLNydJGii','ywDLoG','zwXbssbJAgfYia','BwfNzs1WCMv2Aq','nZuXnZiWvgfVq3Hf','sfzNBwO','mJq4uevNwNfr','y2fJAgvFBM92zq','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','yxbWzw5K','Aw1Hz2vjBNb1Da','5zU+54Mh5Ase55cg5AsX6lsLoIa','vwzjugS','CMfUC2zLCL9PBq','BM9Uzq','svPnDMO','vMzYBe4','wKL1C3y','ExvPx3jLzL9PBq','y2fJAguGzM9YBq','rgXevfG','zgf0yq','t0L0zhG','BMTkvKK','i2nVBwz5DwKTCW','AgfYlxjLzI1PBq','yxbWBhK','vvvcufy','z0LJu08','CML0zq','D2TRDgm','yNrU','DgHLig5LDYbMBW','uLnHtfm','BMnLifvjigvSzq','Aff6shG','y3rvuKW','C2TtAxC','5lIk5lYG5AsX6lsLoIa','DY1JB250ywLUzq','rgjZr00','A1nrvxC','zxjxqvG','vej4EhC','lxjLzI1PBwfNzq','6k+M5OofoIa','t2XKignOyxjHyW','ENrStxC','z2vFBM92zwXHAq','ug1rsg0','kcGOlISPkYKRkq','y29TzNL1As1Yzq','CNPqEKO','y3jLyxrLt2jQzq','BwLqteq','zNLvssbPBwfNzq','ienVBwz5vuKGAq','lwj0BG','v2ngrgO','DezMEwG','CIaUC3qTy2HHDa','Aw1Hz2uVCg5N','z2v0rwXLBwvUDa','w0nOyxjszwzDia','Aw5SAw5LlwzSzq','sK9Os3u','CM1HDc4','BMfTzq','D2D3quS','A1vcA3C','qMvNuvO','whHHufK','weHVrxm','Dhu4lwLTywDLlq','ihjLlxvWBg9Hza','C3rVCMvszwfKvW','CMvZDwX0','nxWYFdb8mxW0Fa','ChjLDMLLD0LTyq','y29AAgq','vKPhweW','uhP3Dgi','Dg9tDhjPBMC','C3rLBq','sMHerxO','q1fOrKu','y1LIrhO','BMX5','CMvMigLTywDLoG','Aw5NignHy2HLza','CgXHy2vOB2XKzq','CKjOq3y','ztOG','B0HSt2m','mty5mK1qDefTtq','EePYvu4','ufb0DxC','BgfPx2nOyxjFCG','rwL0BKO','ANDQC2K','y29TzNL1AwnHBG','DtGTAw1Hz2uTCa','qvrKs2O','DgTer28','Aw1Hz2u','C3rVCMvszwfKtW','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','zfHktNG','tLviB3O','zMLSzxm','yw5ZzMvYsw1HzW','v0v6vNe','ugPPt3y','C3rYAw5NAwz5','A0vuELy','BwvZC2fNzq','x25HAv9JAgfYxW','AgfYifjLzIbPBq','Bw92zs1PBwfNzq','zw1VDMuTAw1HzW','mJq5mfzWD3vctG','sfvWqMu','z1P1zNe','CL9Yzwy','C3rVCMvezwXLDa','mZK4nZbeEMzKteu','wwzbrgm','EMntBfu','D0jLqum','veTHweu','z2uY','qNLjza','sejKvNC','y2XPy2S','CLDQBLO','BMfPm1zPyMvuCG','DuzOtKy','6zsz6k+V6k+M5OofoG','zw1VDMuTy2HHCG'];_0x2fd5=function(){return _0x378499;};return _0x2fd5();}