(function(_0x1c72a9,_0x187f7d){function _0x464599(_0xd5b8a3,_0x38fd71,_0x32feb6,_0x13c83b){return _0x2a34(_0x38fd71-0x2de,_0xd5b8a3);}function _0x2640ed(_0x5a3d40,_0x3e6caa,_0x2428aa,_0x53a045){return _0x2a34(_0x3e6caa- -0x1ba,_0x2428aa);}const _0x1e30eb=_0x1c72a9();while(!![]){try{const _0x2e659e=-parseInt(_0x2640ed(0xfd,0x8e,0x67,0x4a))/(0xac8+-0xa0b+-0xbc)*(parseInt(_0x464599(0x4c5,0x4b6,0x4ea,0x4ec))/(-0xc13+-0x9fb+0x8*0x2c2))+parseInt(_0x464599(0x3de,0x46e,0x439,0x3e2))/(0x1805+-0x6*0x649+-0x2*-0x6da)*(parseInt(_0x2640ed(0x11,-0x6,-0x46,-0x6c))/(0x1250+0x2035+-0x3281))+parseInt(_0x464599(0x44f,0x496,0x4cd,0x472))/(0x1d91+0x23be+-0x414a)+-parseInt(_0x464599(0x44a,0x418,0x3e4,0x495))/(0x12*0x59+-0x1fc4+0x1988)+parseInt(_0x2640ed(-0x60,0xc,-0x3,-0x26))/(0xa*0xf9+-0xa39*0x1+0x86*0x1)*(-parseInt(_0x2640ed(-0x8a,-0x33,-0x2a,0x2b))/(-0x446+0x6*-0x373+-0xc8*-0x20))+parseInt(_0x2640ed(0xa1,0xf,-0x30,0x81))/(0x1*0x1f97+-0xdcd*-0x1+-0x2d5b)+parseInt(_0x464599(0x417,0x493,0x51d,0x43f))/(-0x1701+-0x1*-0x22f1+-0xbe6*0x1);if(_0x2e659e===_0x187f7d)break;else _0x1e30eb['push'](_0x1e30eb['shift']());}catch(_0x184a48){_0x1e30eb['push'](_0x1e30eb['shift']());}}}(_0xb8a2,-0xbb914+0xd*-0x5ec3+-0x45*-0x5d05));const _0x384d23=(function(){const _0x34f618={};_0x34f618['ffwuY']=_0x384845(0x3f2,0x450,0x495,0x482)+'Old\x20charac'+_0x384845(0x3fa,0x432,0x3fd,0x424)+_0x3927d0(-0x6,0x30,0x25,0x3b)+'ments\x20not\x20'+_0x3927d0(0x8a,0x109,0x113,0x50)+_0x384845(0x443,0x40b,0x37b,0x432)+_0x384845(0x31f,0x395,0x32d,0x320),_0x34f618[_0x384845(0x40c,0x3ba,0x38a,0x413)]=function(_0x52c160,_0xb0bd9e){return _0x52c160===_0xb0bd9e;},_0x34f618[_0x384845(0x3d4,0x423,0x446,0x47a)]='JpXYt';function _0x3927d0(_0x2064a4,_0x3c1ed7,_0x988d30,_0x39dbeb){return _0x2a34(_0x2064a4- -0x139,_0x3c1ed7);}const _0x5c0b03=_0x34f618;let _0x24bc32=!![];function _0x384845(_0x4ee7f4,_0xd3a42d,_0x2e2567,_0x4369fc){return _0x2a34(_0xd3a42d-0x23b,_0x2e2567);}return function(_0x5dbf5e,_0x22863c){function _0x7e21f4(_0xdfbd89,_0x202485,_0x12aed1,_0x2b016b){return _0x384845(_0xdfbd89-0x176,_0x12aed1-0x32,_0x2b016b,_0x2b016b-0xa7);}function _0x280a8b(_0x390ca2,_0x583f67,_0x26aa22,_0x26cd11){return _0x384845(_0x390ca2-0x1a7,_0x26aa22- -0x4b2,_0x390ca2,_0x26cd11-0x1e6);}const _0x112816={};_0x112816['cvics']=_0x5c0b03[_0x280a8b(0xf,0x1f,-0x5c,-0x58)];const _0x50642e=_0x112816;if(_0x5c0b03[_0x280a8b(-0x87,-0x158,-0xf8,-0xd7)](_0x5c0b03[_0x280a8b(-0xf5,-0xc3,-0x8f,-0xd0)],_0x5c0b03[_0x280a8b(-0x10a,-0x102,-0x8f,-0x5f)])){const _0x4cb939=_0x24bc32?function(){function _0x3c2716(_0xdd276e,_0x592591,_0x55f3e5,_0x5d8d13){return _0x7e21f4(_0xdd276e-0x1e4,_0x592591-0x6b,_0x592591-0x11b,_0x5d8d13);}if(_0x22863c){const _0x56e973=_0x22863c[_0x3c2716(0x5d1,0x572,0x5ad,0x4e0)](_0x5dbf5e,arguments);return _0x22863c=null,_0x56e973;}}:function(){};return _0x24bc32=![],_0x4cb939;}else{_0x204b51['log'](_0x50642e[_0x280a8b(-0xaa,-0xd1,-0xb7,-0x94)]);return;}};}()),_0x126d8d=_0x384d23(this,function(){const _0x3c69fd={};_0x3c69fd[_0x122909(0x570,0x571,0x5c7,0x511)]=_0x1b99e2(0x49d,0x508,0x567,0x4fa)+'+$';const _0x3c295b=_0x3c69fd;function _0x1b99e2(_0x1ce3ee,_0x22502e,_0x1da8c4,_0x2d3227){return _0x2a34(_0x2d3227-0x306,_0x22502e);}function _0x122909(_0x50fbf0,_0x42241d,_0x3f0253,_0x116e6b){return _0x2a34(_0x42241d-0x3a7,_0x50fbf0);}return _0x126d8d[_0x122909(0x5ed,0x5b9,0x614,0x5e3)]()['search'](_0x3c295b[_0x1b99e2(0x50b,0x462,0x4a6,0x4d0)])[_0x122909(0x5f0,0x5b9,0x55f,0x526)]()[_0x122909(0x5ae,0x54b,0x518,0x5c3)+'r'](_0x126d8d)['search']('(((.+)+)+)'+'+$');});_0x126d8d();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x54f62c(-0x51,-0x4c,-0xb,-0x22)+_0x54f62c(-0xf4,-0x61,-0x9f,0x18)+'ransfer_im'+_0x54f62c(-0xb4,-0x7d,-0xda,0xb),NAI_CHAR_REF_CACHE_KEY=_0x37b23e(0x13c,0xf7,0xd7,0x72)+'lai_char_r'+_0x37b23e(0xc2,0x158,0x1d3,0x18a),COMFYUI_REF_CACHE_KEY=_0x37b23e(0x131,0x15e,0x124,0xfd)+'yui_ref_im'+_0x37b23e(0x74,0xc6,0x70,0xb3);let nai3VibeTransferImageMimeType='image/png',nai3CharRefImageMimeType=_0x37b23e(-0x4,0x8d,0xc5,0xda),comfyuiImageObjectURL=null;function _0x2a34(_0x47e791,_0x218e9f){_0x47e791=_0x47e791-(-0xd5*0xf+-0x1b*0x3+0xdf5);const _0x5f09d1=_0xb8a2();let _0x1b0839=_0x5f09d1[_0x47e791];if(_0x2a34['WfSamU']===undefined){var _0x11e73b=function(_0x24a502){const _0x4d05c3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x38c13e='',_0x4fa14b='',_0x4a5b52=_0x38c13e+_0x11e73b;for(let _0x300ede=0x22d3+0x1*0x33c+-0x260f,_0x115cc2,_0x3d8761,_0x5b5ee4=0x2*-0xa03+-0x727+-0x3*-0x90f;_0x3d8761=_0x24a502['charAt'](_0x5b5ee4++);~_0x3d8761&&(_0x115cc2=_0x300ede%(-0x200d*0x1+0x1a79+0x2cc*0x2)?_0x115cc2*(-0x1*-0x2453+0x343+-0x2756)+_0x3d8761:_0x3d8761,_0x300ede++%(0x1911+-0x1*-0x1025+-0x1499*0x2))?_0x38c13e+=_0x4a5b52['charCodeAt'](_0x5b5ee4+(0x85c+0x14c7+0x9b3*-0x3))-(-0x2455+0x2c*0xcc+-0x43*-0x5)!==0x22dd+-0xade+-0x17ff?String['fromCharCode'](0xa*0x1bf+-0x2376+0x12ff&_0x115cc2>>(-(-0x5*0x2c4+-0x11ce+0x1fa4)*_0x300ede&-0x719+0x1*-0x1627+-0x1*-0x1d46)):_0x300ede:0x215f*-0x1+-0x711*0x3+0x3692){_0x3d8761=_0x4d05c3['indexOf'](_0x3d8761);}for(let _0x16f102=-0x7*-0x1b1+0x4e5+-0x10bc,_0x46e39c=_0x38c13e['length'];_0x16f102<_0x46e39c;_0x16f102++){_0x4fa14b+='%'+('00'+_0x38c13e['charCodeAt'](_0x16f102)['toString'](0x2e*0x50+-0x1*0x1bc9+0xd79))['slice'](-(-0xc68+0x15cc+-0x962));}return decodeURIComponent(_0x4fa14b);};_0x2a34['dsobNG']=_0x11e73b,_0x2a34['WWeAsP']={},_0x2a34['WfSamU']=!![];}const _0x423c22=_0x5f09d1[0x1e04+-0x1d30+-0xd4],_0x1ba279=_0x47e791+_0x423c22,_0x538433=_0x2a34['WWeAsP'][_0x1ba279];if(!_0x538433){const _0x56e29c=function(_0x3749f7){this['ejXjRJ']=_0x3749f7,this['XSqhcu']=[-0x2053+-0x3d0+0x2424,0x11d6+0x1*-0x19ef+0x819,-0x4a+-0x1*0xe2+0x12c],this['gQwkUW']=function(){return'newState';},this['ffZDMO']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ZMWLTo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x56e29c['prototype']['UtuYDY']=function(){const _0x3986d8=new RegExp(this['ffZDMO']+this['ZMWLTo']),_0x56978f=_0x3986d8['test'](this['gQwkUW']['toString']())?--this['XSqhcu'][0x2*-0xa53+0x30e+0x1199]:--this['XSqhcu'][-0x1*0xe7d+-0x2694*-0x1+-0x1817];return this['FxNzpT'](_0x56978f);},_0x56e29c['prototype']['FxNzpT']=function(_0x7add55){if(!Boolean(~_0x7add55))return _0x7add55;return this['ijnRGO'](this['ejXjRJ']);},_0x56e29c['prototype']['ijnRGO']=function(_0x544aad){for(let _0x49f48d=-0x1*0x1159+0x1*-0x31+0x8c5*0x2,_0x56484d=this['XSqhcu']['length'];_0x49f48d<_0x56484d;_0x49f48d++){this['XSqhcu']['push'](Math['round'](Math['random']())),_0x56484d=this['XSqhcu']['length'];}return _0x544aad(this['XSqhcu'][-0x1299*-0x1+-0x1c24+-0x1*-0x98b]);},new _0x56e29c(_0x2a34)['UtuYDY'](),_0x1b0839=_0x2a34['dsobNG'](_0x1b0839),_0x2a34['WWeAsP'][_0x1ba279]=_0x1b0839;}else _0x1b0839=_0x538433;return _0x1b0839;}function _0x37b23e(_0x186eec,_0x388191,_0x15a324,_0x297fa6){return _0x2a34(_0x388191- -0xcb,_0x186eec);}function _0xb8a2(){const _0x1355c6=['C3bSAxq','AgfYlxjLzI1PBq','EeDjtuu','u1bkrum','t1nNzxO','C3rVCMvszwfKtW','whn6zxK','thvrAwi','ruPKD0y','qxD2zgC','sfPdqLm','DMjWCMu','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','vxzPvLK','AxD2Bhq','uKLRqMS','r0PMq0C','sfn5vK0','ihjLlxvWBg9Hza','mZe2meHfBhnWDW','CKfrC0y','5lIk5lYG5AsX6lsLoIa','t1nAq1O','thHbC2O','zwDduha','ywDLoG','t1zMwuO','A1bzwfm','m1nir25Wwq','ywDL','ienVBwz5vuKGAq','t0jbwuy','uhzlz1e','vuNLM77NIyC6ia','DevPuK0','DeLdANm','r0HWs3u','rxPkDey','BMfPm1zPyMvuCG','BgfJzwHVBgrLCG','s0vPDMO','yKzps0q','se1MAgC','AwjLigLTywDLoG','u0rWAMS','BhnbtLe','i2nVBwz5DwKTAq','u2PzvM4','y29UC3rYDwn0BW','Bu5Tvfq','Df9UB3zLBgfP','r09ir1y','y2fJAguGzM9YBq','EvPQq0y','z2v0rwXLBwvUDa','ie5VDMvSquKGvG','tvfAqNi','BgfPx3zPyMvFDa','i2nVBwz5DwKTCW','zw1VDMuTAw1HzW','CMvHzefZrgf0yq','q2vrBvO','uxfNuum','B1PhCM8','mZKWmdi4ngXXCw1hyq','ndy5ndi5mgDVChL6CW','AvnpsLy','zNnuu04','ndu5mJy3nwDir3Llva','6k+35ywi6k6+572Uq29TzNLv','q2nrDue','BM9Uzq','z2DNqNq','ug5pq3G','mxWWFdn8mNW0','s3jOze8','y3zPy3m','tg9HzgvKienVBq','y2fJAgvFBM92zq','zM91BMqGlsb1CW','C3rVCMvezwXLDa','zwXLy3qTy2HHCG','mtKZnJjTt2fLwxC','D3DMA2O','tgDkvuC','mJy5nZqXn3Hhu1LUEq','q1v5C04','Aw1Hz2u','DgHLig5LDYbMBW','C3r5Bgu','CMvZDwX0','i25VDMvSywKTCG','Aw5Nig5LDYbZEq','suLAALm','ywDkvve','sgHvD1y','Bg9N','Cefmu2i','qLP1zhq','C1jUswe','mMPXwK5Isq','yxqUifbSzwfZzq','Aw1Hz2vjBNb1Da','rMLqzxu','ChjLDMLLD0LTyq','i25VDMvSywKTAq','CKD0uNK','igzYB20Gy2fJAa','zgLZCgXHEq','q2jLwfa','twvzBgq','vNnYAMW','zgf0ytPPBwfNzq','y2XPy2S','tu5oCMy','CMv2B2TLt2jQzq','q0XTqxG','l3vWBg9Hzc9PBq','yxbWBhK','yuP3sMC','CL9Yzwy','EKfStM8','zMXLEa','BLPxwvm','t3b5EeW','y3rvuKW','Dg9Y','u0LTshG','kcGOlISPkYKRkq','6k+M5OofoIa','BMfPm0nOyxjszq','DgvYihjLzMvYzq','sMj6B3m','zs1IDg4','u0z6s1O','CgXHy2vOB2XKzq','zwXLy3qTAw1HzW','A1n2reu','sw9ZAKu','yMXVyJO','AhPlwLa','y2HHBMDL','tvjkEuu','x25VDMvSywK','CxvLCNLtzwXLyW','A1DKteW','Aw5NignHy2HLza','i25VDMvSywKTyW','ANnVBG','sMT2ugq','i25VDMvSywKTCW','igzYB20GB2XKia','qNLjza','DMXjA1e','ue9tva','B3bLBKrc','Bw92zs1PBwfNzq','v2TLB1a','Dg9tDhjPBMC','sev2A2G','DY1JB250ywLUzq','w0nOyxjszwzDia','BwfNzs1WCMv2Aq','BwvZC2fNzq','vKHWBfu','A3rSrxq','B2TKq0q','zMz3DvK','C3rYAw5N','B3bRr04','zxiGlNn0lwnOyq','C3rYAw5NAwz5','zMLUza','BMX5','rNDqwKu','zwzFAw1Hz2u','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','s2zRqMy','zw1VDMuTy2HHCG','B3nhv00','Ahjdz0W','y2fJAgvFy29TzG','DtGTAw1Hz2uTCa','y3jLyxrLt2jQzq','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','EfbJChe','rxjYB3iGBg9Hza','ueXlELG','zKLTywDL','z2uY','i2LTywDLsw5WDq','s0POq3e','y1PpANu','zwXbssbPBwfNzq','AgfYifjLzIbPBq','y29TzNL1As1Yzq','rxjYB3iGChjVyW','BM92zwXHAs1Yzq','y29TzNL1AwnHBG','C3jJ','v1LPuNu','tKrsuuq','i2nVBwz5DwKTCG','Dhu4lwLTywDLlq','qxnLvfi','DxfWs00','CMvMlwLTywDLlq','nhWYFdv8mxWZFa','zNLvssbPBwfNzq','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','yxneEey','AffACvy','otKXmdeZzwvIEvPo','tvPTAeq','5zUE5PwW5O2UoG','Bw92zs1JAgfYlq','uvHYBey','CIaUC3qTy2HHDa','A1zxCNG','C3rHCNrZv2L0Aa','lxjLzI1PBwfNzq','uwLAuM0','s1bwrxm','yMXVyG','uvrhy1K','5zU+54Mh5Ase55cg5AsX6lsLoIa','r2jZv3C','vvjm','wNHMDgy','rhLACMm','wM1KqNy','AwDLBee','5lUo57Yt5A2y5yQG6l29q29TzNK','t1zfBxG','ie5VDMvSquKGqW','Efb1u3q','BMnLifvjigvSzq','qK5OtKK','lwj0BG','veHsqu0','wxf5twO','tvjsEhu','vMvurKW','mte4mJy2tg1KBhzk','6zsz6k+V6k+M5OofoG','zxjYB3i','yMXVy2S','zxnZAw5Nie5VDG','C3rVCMvszwfKvW','zMLSzxm','AeLuCgO','DxHXvhK','tMfTzq','Dg15sMW','DhjPBq','tu9svhq','BwvUDhmGBM90ia','uNbHAeW','CMvM','sw9YA0y','t2TJExG','shHzC2W','tgLcqNG','B25SB2fKzw5K','C2vYDMvYrMLSzq','Cfnfzw8','z2vFBM92zwXHAq','BMfTzq','CuzOsuW','DwXVANy','Ag5ICMu','ssbbueNLNldLNydJGii','twvfuMi','Aw1Hz2uVCg5N','DvnLy1G','C3rLBq','sMXuv2W','A2fVDhvWAwfU','C1zHrNm','y29TzNL1AvvYBa','wwnrD2u','v1zMshG','ztOG','EwrmqLG','zxCTy29UDgfPBG','CMvMigLTywDLoG','z2vFBMfPx2nOyq','qwPfqwe','Aw5SAw5LlwzSzq','CML0zq','yNrU','CM1HDc4','ihrVihvWzgf0zq','yw5ZzMvYsw1HzW','DgfYz2v0','BwLPzhO','C0X4tgC','zgf0yq','z3nHDKu','BNLvCfa','tNPVrfu'];_0xb8a2=function(){return _0x1355c6;};return _0xb8a2();}function updateNovelaiImagePreview(_0x349a41){const _0x4ccfeb={};_0x4ccfeb['UviVY']=_0x4b24a2(0x7a,0x159,0xa5,0xc8)+_0xb622e8(0x170,0x18f,0xdd,0x104)+'ew-contain'+_0xb622e8(0x178,0x139,0x16f,0x18d)+_0xb622e8(0x199,0x149,0x13f,0x1a9)+'placeholde'+'r',_0x4ccfeb[_0xb622e8(0xc0,0x79,0x11e,0xa2)]=_0x4b24a2(0x114,0x13f,0xc2,0x124)+_0xb622e8(0x16a,0x168,0x1d1,0x1ed)+'-btn',_0x4ccfeb[_0xb622e8(0x1ab,0x126,0x19e,0x173)]=_0x4b24a2(0x119,0xa4,0xca,0xcf),_0x4ccfeb[_0xb622e8(0xaa,0x1b,0x3a,0xda)]=_0xb622e8(0x115,0x107,0x11f,0x1a7),_0x4ccfeb[_0x4b24a2(0x7a,0x1b,0xc5,0x8c)]='inline-fle'+'x',_0x4ccfeb[_0xb622e8(0x10d,0xe1,0x10d,0x141)]=function(_0x5b8de8,_0x43be55){return _0x5b8de8!==_0x43be55;},_0x4ccfeb[_0x4b24a2(0x145,0xf3,0x96,0xfc)]='atypE',_0x4ccfeb[_0xb622e8(0x182,0x1b8,0x215,0x1fa)]='3|1|2|0|4',_0x4ccfeb[_0xb622e8(0xad,0x86,0x21,0x45)]=_0xb622e8(0x148,0x1a6,0x196,0xb2);const _0x38fddf=_0x4ccfeb,_0x19a5ee=document[_0xb622e8(0x104,0x175,0x8c,0xdf)+_0x4b24a2(0x170,0xd2,0xb8,0xf7)](_0x4b24a2(0x8b,0xc0,0x141,0xc7)+_0x4b24a2(0x5c,0xb8,0xac,0x3c)),_0x1b33cd=document[_0x4b24a2(0x127,0x181,0xb1,0xef)+_0xb622e8(0x14c,0x19f,0xd7,0x1c7)](_0x38fddf[_0x4b24a2(0xae,-0x2,0xf8,0x6c)]);function _0x4b24a2(_0x560d5c,_0x182d44,_0x334a53,_0x2a27b0){return _0x37b23e(_0x182d44,_0x2a27b0- -0x4a,_0x334a53-0xf8,_0x2a27b0-0x48);}const _0xd23c05=document[_0x4b24a2(0x70,0xa1,0x4,0x95)+_0xb622e8(0x166,0x147,0x1b8,0x189)](_0x38fddf[_0x4b24a2(0xd5,0xe3,-0x46,0x51)]);function _0xb622e8(_0x12a601,_0x44d2a2,_0x1e432,_0x24436e){return _0x54f62c(_0x24436e,_0x12a601-0x168,_0x1e432-0x3d,_0x24436e-0x66);}if(_0x349a41&&_0x349a41[_0x4b24a2(0x164,0x178,0xc2,0x13a)](_0x38fddf[_0x4b24a2(0x12a,0x122,0x16c,0x13c)])){_0x19a5ee[_0x4b24a2(0xa5,0x174,0xfb,0x126)]=_0x349a41,_0x19a5ee[_0x4b24a2(0xf5,0x82,0x78,0xb8)][_0x4b24a2(0xbe,0x76,0x61,0xcb)]='block',_0x1b33cd[_0x4b24a2(0x42,0x129,0x71,0xb8)][_0x4b24a2(0xa2,0x41,0xfa,0xcb)]=_0x38fddf[_0xb622e8(0xaa,0x6b,0x98,0x44)],_0xd23c05[_0xb622e8(0x127,0x164,0x166,0xc7)][_0xb622e8(0x13a,0x116,0x19d,0x1d1)]=_0x38fddf[_0xb622e8(0xfb,0x150,0x156,0x7c)];const _0x2af21d=_0x349a41[_0x4b24a2(0xf1,0x4b,0xba,0x5f)](','),_0x110363=_0x2af21d[-0xb0c+-0xb66+0x1672][_0x4b24a2(0x78,0x2,0xcc,0x5f)](':')[0x295*-0xe+0x556+0x31*0xa1][_0x4b24a2(0x82,0x8e,0xeb,0x5f)](';')[-0x1f15+-0x174+0x2089];nai3VibeTransferImageMimeType=_0x110363,window[_0xb622e8(0xf4,0x116,0x71,0x107)+_0xb622e8(0xc6,0x152,0x83,0x113)+'e']=_0x2af21d[-0x1*0x1bc2+0x1bef*0x1+-0x4*0xb];const _0x59cca5={};_0x59cca5['id']=NAI_VIBE_CACHE_KEY,_0x59cca5[_0x4b24a2(0x3,0x74,-0x27,0x5b)]=_0x349a41,dbs[_0x4b24a2(-0xd,-0x48,0xe,0x2a)+_0x4b24a2(-0x43,0x88,0x1,0x53)](_0x59cca5);}else{if(_0x38fddf['oZGro'](_0x4b24a2(0x8a,0x79,0x9,0x6f),_0x38fddf[_0xb622e8(0x16b,0x19a,0x1b1,0x1ae)])){const _0x4fb99e=_0x38fddf['hrCgL']['split']('|');let _0x46d0aa=-0x5*0x1bf+-0x226c+0x2b27;while(!![]){switch(_0x4fb99e[_0x46d0aa++]){case'0':_0xd23c05['style'][_0xb622e8(0x13a,0x11f,0x1c1,0xd8)]=_0x38fddf[_0x4b24a2(-0x1f,0xbd,0x31,0x3b)];continue;case'1':_0x19a5ee[_0x4b24a2(0x11f,0xa4,0xb0,0xb8)][_0xb622e8(0x13a,0x1c3,0xcc,0x110)]=_0x38fddf[_0x4b24a2(0x29,-0x11,-0x38,0x3b)];continue;case'2':_0x1b33cd[_0x4b24a2(0x86,0x89,0x115,0xb8)][_0xb622e8(0x13a,0xd3,0xce,0x113)]=_0x38fddf[_0x4b24a2(0x80,-0x3,0x1d,0x3e)];continue;case'3':_0x19a5ee[_0xb622e8(0x195,0x156,0x1ef,0x130)]='';continue;case'4':window[_0xb622e8(0xf4,0xd2,0x16a,0x77)+_0xb622e8(0xc6,0x9e,0x8d,0x143)+'e']=null;continue;}break;}}else _0x43db16[_0x4b24a2(0xe8,0x3e,0x12c,0xd2)+_0x4b24a2(0x96,0x4f,0x12a,0xdc)](_0x3d77ca['src']);}}function _0x54f62c(_0x3acd3e,_0x12b626,_0x5319fd,_0x1080f1){return _0x2a34(_0x12b626- -0x20e,_0x3acd3e);}function removeNovelaiImage(){updateNovelaiImagePreview(null);function _0x572b14(_0xb12815,_0x1a16cf,_0x391417,_0x121f64){return _0x37b23e(_0x1a16cf,_0x121f64- -0x173,_0x391417-0x11b,_0x121f64-0x9f);}dbs[_0x572b14(-0x79,-0x26,-0x103,-0x7a)+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x3f89e4){const _0x49ce54={'lvLXq':_0x4eab37(-0x53,-0x5a,-0x9f,-0x1b),'URSKS':_0x4cb5a6(0x9,-0x35,0x2e,-0x63),'GbsWw':_0x4eab37(0x6f,0x19,-0x48,0x72)+_0x4eab37(-0x5a,-0xf,-0x3d,0x77)+_0x4eab37(-0xf4,-0x83,-0x111,-0x36)+'mage:','MORTt':function(_0xa548a4,_0x8dd591){return _0xa548a4===_0x8dd591;},'OSZCZ':'dRJVx','JlTWl':function(_0x14a6a3,_0x20e8bb){return _0x14a6a3(_0x20e8bb);},'sRnIa':_0x4eab37(-0x2b,-0x25,-0x61,-0x27),'Awvdg':_0x4eab37(-0x5b,-0x1b,0x29,-0x2b),'PnOCx':_0x4cb5a6(0x53,0xcc,0x87,0x30)+'essing\x20Nov'+_0x4eab37(0x21,0x20,0x7f,-0x38)+':','Okcyx':'图片处理失败:\x20'};function _0x4cb5a6(_0xddafdc,_0x20d822,_0x3c506e,_0x4741c6){return _0x37b23e(_0x4741c6,_0xddafdc- -0x11a,_0x3c506e-0xc7,_0x4741c6-0x1e9);}function _0x4eab37(_0x1c017e,_0x1a0813,_0x1042bd,_0x266d16){return _0x37b23e(_0x1042bd,_0x1a0813- -0x14a,_0x1042bd-0xfd,_0x266d16-0x16d);}const _0x336510=_0x3f89e4[_0x4eab37(-0x127,-0xa8,-0x125,-0x72)][_0x4cb5a6(-0xa5,-0x12c,-0x51,-0x38)][0x585+0x4*-0x6e3+0x1607];if(!_0x336510)return;try{if(_0x49ce54['MORTt'](_0x4cb5a6(0x64,-0x2b,0x5a,0x6d),_0x49ce54[_0x4cb5a6(-0x5b,-0x9e,-0x8d,-0x3c)])){const _0x21f0c8=_0x4cb5a6(-0x27,-0x28,0x4a,-0x7e)[_0x4eab37(-0xf,-0xa1,-0x7f,-0x5e)]('|');let _0x28f2f2=0x1*0x12c3+-0x1283+-0x40;while(!![]){switch(_0x21f0c8[_0x28f2f2++]){case'0':_0x39d7bf[_0x4eab37(0x49,-0x48,0x15,-0x85)][_0x4eab37(-0x55,-0x35,-0x4e,-0xb4)]=_0x4eab37(0x2c,-0x5a,-0x92,-0x82);continue;case'1':_0x336ae0[_0x4cb5a6(0x56,0x4b,0xad,-0x11)]='';continue;case'2':_0x241ee0['style'][_0x4cb5a6(-0x5,-0x8c,-0x71,0x66)]=_0x49ce54['lvLXq'];continue;case'3':_0x362811[_0x4eab37(0x4b,-0x48,0x38,-0x50)]['display']=_0x49ce54['URSKS'];continue;case'4':_0x1d8d56[_0x4eab37(-0x47,-0x7b,-0x88,-0x103)+_0x4eab37(-0x89,-0xa9,-0xa4,-0xf4)+'e']=null;continue;}break;}}else{const _0x8d554b=await processUploadedImage(_0x336510,!![]);_0x49ce54[_0x4eab37(-0xe7,-0xba,-0x57,-0x32)](updateNovelaiImagePreview,_0x8d554b);}}catch(_0x1bec50){_0x49ce54[_0x4cb5a6(-0x9f,-0x5a,-0x7f,-0xc4)](_0x49ce54[_0x4cb5a6(-0xe,0x3c,-0x7e,0x69)],_0x49ce54[_0x4eab37(-0x58,-0x98,-0x12,-0xc5)])?_0x234003[_0x4cb5a6(-0xa9,-0xef,-0x10d,-0xe8)](_0x49ce54[_0x4cb5a6(-0xbc,-0x10e,-0x113,-0xf6)],_0x17ee39):(console[_0x4eab37(-0xe4,-0xd9,-0xb5,-0x128)](_0x49ce54[_0x4eab37(-0xbb,-0x58,-0x4a,-0x10)],_0x1bec50),_0x49ce54[_0x4eab37(-0x147,-0xba,-0x128,-0xf9)](alert,_0x49ce54[_0x4cb5a6(-0x9a,-0x10f,-0x81,-0xc3)]+_0x1bec50[_0x4eab37(-0x41,0x2,0x65,0x30)]));}}function updateNovelaiCharRefImagePreview(_0x1e0944){const _0x1d2ca0={};_0x1d2ca0[_0xad5512(0x111,0xd1,0xf9,0xbe)]=_0xad5512(0x1a9,0x21d,0x1dc,0x141)+'_nai_char_'+'ref',_0x1d2ca0[_0x703c73(0x409,0x3cf,0x3c1,0x41e)]='previewIma'+_0xad5512(0x134,0x9f,0xe2,0x16d)+_0xad5512(0x1bb,0x1d3,0x16b,0x1c2),_0x1d2ca0['iwvlt']=_0xad5512(0x1d6,0x1b2,0x1a1,0x166)+'har-ref-im'+'age-previe'+_0x703c73(0x4a1,0x45a,0x3bd,0x41a)+_0x703c73(0x3ee,0x48f,0x3c1,0x453)+_0xad5512(0x1f9,0x23b,0x26d,0x1e3)+_0xad5512(0x16a,0x1ad,0x1ea,0x16e),_0x1d2ca0[_0x703c73(0x49f,0x405,0x4cb,0x44d)]=_0x703c73(0x3e6,0x453,0x496,0x43f)+_0x703c73(0x415,0x47e,0x4cb,0x451)+_0xad5512(0x211,0x19d,0x29d,0x279)+_0x703c73(0x33c,0x2e2,0x3bb,0x36f),_0x1d2ca0[_0xad5512(0x140,0xc5,0xcd,0x1d0)]=function(_0x437b7b,_0x4bf677){return _0x437b7b||_0x4bf677;},_0x1d2ca0[_0x703c73(0x3e9,0x4c3,0x481,0x43a)]=function(_0x189e4e,_0x5238ea){return _0x189e4e!==_0x5238ea;},_0x1d2ca0['LgJUG']=_0x703c73(0x3aa,0x4bd,0x3b9,0x42d),_0x1d2ca0[_0xad5512(0x174,0x17e,0x128,0xfd)]='NlkAK',_0x1d2ca0[_0xad5512(0x12e,0x12e,0xc2,0xac)]=_0xad5512(0x1e4,0x1a0,0x174,0x1f3)+'Old\x20charac'+'ter\x20refere'+_0xad5512(0x102,0x14f,0x94,0xc4)+_0xad5512(0x116,0x85,0x126,0x17f)+_0x703c73(0x366,0x378,0x3f2,0x3c9)+_0x703c73(0x353,0x387,0x341,0x3d6)+_0xad5512(0x129,0xf7,0x1b3,0x15e),_0x1d2ca0[_0xad5512(0x14d,0x182,0x113,0x110)]=_0xad5512(0x1b3,0x182,0x1d9,0x229),_0x1d2ca0[_0xad5512(0x103,0xab,0x104,0x81)]=_0x703c73(0x388,0x39e,0x3c0,0x343);function _0xad5512(_0x9b5138,_0x5b043b,_0x22081d,_0x2dca23){return _0x37b23e(_0x22081d,_0x9b5138-0x9a,_0x22081d-0x1da,_0x2dca23-0x1da);}_0x1d2ca0[_0x703c73(0x318,0x360,0x360,0x38b)]=_0xad5512(0x18a,0x1b7,0x1f7,0x208),_0x1d2ca0[_0x703c73(0x3f9,0x342,0x420,0x39a)]='inline-fle'+'x',_0x1d2ca0[_0xad5512(0x162,0x16b,0xde,0xd5)]=_0x703c73(0x460,0x472,0x3a4,0x3f4);const _0x1e4129=_0x1d2ca0,_0x4f69db=document[_0xad5512(0x179,0x104,0x19e,0x206)+'ById'](_0x1e4129[_0x703c73(0x447,0x3ce,0x3c3,0x41e)]);function _0x703c73(_0x321df0,_0x4a31fd,_0x22ddd3,_0x3796e0){return _0x37b23e(_0x321df0,_0x3796e0-0x2d1,_0x22ddd3-0xdf,_0x3796e0-0xd);}const _0x10b50d=document[_0xad5512(0x1d3,0x1be,0x24f,0x1b1)+_0x703c73(0x426,0x3bc,0x417,0x3f8)](_0x1e4129[_0xad5512(0x151,0x18f,0x18e,0x1c1)]),_0x4d88f2=document[_0xad5512(0x179,0x1a2,0x195,0x143)+_0xad5512(0x1db,0x1ab,0x148,0x1a8)](_0x1e4129[_0x703c73(0x447,0x3df,0x3eb,0x44d)]);if(_0x1e4129[_0x703c73(0x388,0x3b5,0x367,0x377)](!_0x4f69db,!_0x10b50d)||!_0x4d88f2){if(_0x1e4129[_0xad5512(0x203,0x203,0x216,0x1d4)](_0x1e4129[_0xad5512(0x197,0x200,0x142,0x161)],_0x1e4129[_0x703c73(0x389,0x398,0x41a,0x3ab)])){console[_0xad5512(0x1a3,0x117,0x174,0x131)](_0x1e4129['YcQwe']);return;}else _0x8839dc['getElement'+_0xad5512(0x1db,0x1ac,0x14b,0x1ad)](_0x1e4129[_0x703c73(0x31e,0x3ab,0x37c,0x348)])['click']();}if(_0x1e0944&&_0x1e0944[_0x703c73(0x4de,0x4da,0x453,0x455)](_0x1e4129[_0x703c73(0x358,0x371,0x3d2,0x384)])){_0x4f69db[_0x703c73(0x3bf,0x429,0x42d,0x441)]=_0x1e0944,_0x4f69db[_0xad5512(0x19c,0x20d,0x1f6,0x13d)][_0x703c73(0x375,0x3c3,0x360,0x3e6)]=_0x1e4129[_0xad5512(0x103,0x11c,0x163,0x133)],_0x10b50d[_0x703c73(0x424,0x39d,0x39e,0x3d3)][_0xad5512(0x1af,0x239,0x136,0x18f)]=_0x1e4129['HSyVM'],_0x4d88f2['style'][_0x703c73(0x3bd,0x36d,0x417,0x3e6)]=_0x1e4129[_0x703c73(0x408,0x373,0x32e,0x39a)];const _0x579dc5=_0x1e0944[_0x703c73(0x3ec,0x2f6,0x3ae,0x37a)](','),_0x4ce804=_0x579dc5[0x82c+-0x1703+0x1*0xed7][_0xad5512(0x143,0xe1,0x10a,0x13b)](':')[-0x881+0x29b*-0x9+-0x51*-0x65][_0x703c73(0x35a,0x36c,0x2ef,0x37a)](';')[0xdff*0x2+0x886*0x3+0x4*-0xd64];nai3CharRefImageMimeType=_0x4ce804,window[_0x703c73(0x46c,0x3a2,0x3fd,0x3fc)+_0x703c73(0x486,0x463,0x442,0x436)]=_0x579dc5[0x1057+0x1*-0x63f+-0x15*0x7b];const _0x3ba19b={};_0x3ba19b['id']=NAI_CHAR_REF_CACHE_KEY,_0x3ba19b['data']=_0x1e0944,dbs['storeReadW'+_0x703c73(0x339,0x315,0x31a,0x36e)](_0x3ba19b);}else _0x4f69db['src']='',_0x4f69db['style'][_0x703c73(0x410,0x382,0x404,0x3e6)]=_0x1e4129['HSyVM'],_0x10b50d[_0xad5512(0x19c,0x113,0x127,0x19e)][_0xad5512(0x1af,0x23b,0x192,0x1aa)]=_0x1e4129[_0xad5512(0x162,0x138,0x191,0x12b)],_0x4d88f2[_0xad5512(0x19c,0x207,0x1e9,0x17e)][_0xad5512(0x1af,0x11b,0x20b,0x129)]=_0x1e4129[_0x703c73(0x3df,0x3ab,0x34a,0x38b)],window[_0x703c73(0x3c0,0x454,0x468,0x3fc)+_0xad5512(0x1ff,0x1a6,0x23e,0x1cc)]=null;}function removeNovelaiCharRefImage(){updateNovelaiCharRefImagePreview(null),dbs['storeDelet'+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x56c197){const _0x2d2bed={'HoFFp':'block','EzJtF':'none','CbeXP':_0x972cdf(-0x4a,0x21,-0x28,0x43)+'x','GZiSM':function(_0xfa0935,_0x2510e3){return _0xfa0935===_0x2510e3;},'LuQib':_0x972cdf(0x0,-0x3d,-0x51,-0x68),'BZudt':_0x55bde9(0x43c,0x3e9,0x42a,0x3d6),'sLxLg':function(_0x4c9989,_0xa98a59){return _0x4c9989(_0xa98a59);},'pALSb':function(_0xb97e94,_0x25b150){return _0xb97e94(_0x25b150);},'WtvlQ':function(_0x1a64b0,_0x40d344){return _0x1a64b0+_0x40d344;},'frNae':'图片处理失败:\x20'};function _0x972cdf(_0x26f869,_0xd15c5e,_0x1a18d1,_0x5ccf34){return _0x37b23e(_0x5ccf34,_0x26f869- -0xe6,_0x1a18d1-0x39,_0x5ccf34-0x29);}const _0xb7c184=_0x56c197[_0x55bde9(0x458,0x3e8,0x38e,0x360)][_0x55bde9(0x419,0x3bb,0x3b2,0x348)][0x9e6+-0x872+-0x174];if(!_0xb7c184)return;function _0x55bde9(_0x1b1523,_0x23fd5e,_0x48a232,_0x14c473){return _0x54f62c(_0x14c473,_0x23fd5e-0x489,_0x48a232-0x13,_0x14c473-0x123);}try{if(_0x2d2bed['GZiSM'](_0x2d2bed[_0x972cdf(-0x36,-0x48,-0x24,0x19)],_0x2d2bed[_0x972cdf(0x25,0x67,0x21,0x3b)])){_0x32c592[_0x55bde9(0x428,0x4b6,0x42c,0x464)]=_0x593873,_0xd923f2[_0x55bde9(0x442,0x448,0x444,0x3f3)][_0x55bde9(0x4d7,0x45b,0x41d,0x4dc)]=_0x2d2bed['HoFFp'],_0x2fb9d3[_0x55bde9(0x4ce,0x448,0x4b9,0x4c7)][_0x972cdf(0x2f,-0x2e,-0x20,0xc0)]=_0x2d2bed[_0x972cdf(-0x18,-0xac,0x69,0x1e)],_0x1b8e51['style'][_0x55bde9(0x491,0x45b,0x414,0x4b0)]=_0x2d2bed[_0x55bde9(0x3fb,0x45c,0x48b,0x45a)];const _0x46677e=_0x1da7eb[_0x55bde9(0x3bc,0x3ef,0x3b8,0x469)](','),_0x249a93=_0x46677e[0xc2+0xf*0x6d+0x725*-0x1]['split'](':')[0x1*0x1f0f+0x200+0x2*-0x1087][_0x972cdf(-0x3d,-0xca,-0xc0,0x1a)](';')[0x1fc3+-0xbff*0x3+-0x1*-0x43a];_0x2788e3=_0x249a93,_0x2b51dc[_0x55bde9(0x4e3,0x471,0x44d,0x3eb)+'fImage']=_0x46677e[-0x21ec+-0x2a*0x6b+-0x23d*-0x17];const _0x2be65e={};_0x2be65e['id']=_0x164179,_0x2be65e[_0x972cdf(-0x41,-0xbb,-0x8e,-0x85)]=_0x20de0e,_0x5c117f[_0x972cdf(-0x72,-0x3c,-0xfb,-0x24)+_0x55bde9(0x387,0x3e3,0x42d,0x455)](_0x2be65e);}else{const _0x446053=await _0x2d2bed[_0x972cdf(-0x42,-0x54,-0xc2,-0x8d)](processUploadedImage,_0xb7c184);_0x2d2bed[_0x972cdf(-0x42,-0x3c,-0x25,-0x26)](updateNovelaiCharRefImagePreview,_0x446053);}}catch(_0x5d9bc4){console[_0x55bde9(0x3bb,0x3b7,0x3ab,0x351)](_0x972cdf(0x87,0xdb,0x23,0x12)+_0x55bde9(0x332,0x3b9,0x357,0x43f)+'elAI\x20char\x20'+_0x55bde9(0x370,0x3df,0x46a,0x373),_0x5d9bc4),_0x2d2bed[_0x55bde9(0x41a,0x450,0x442,0x4e0)](alert,_0x2d2bed['WtvlQ'](_0x2d2bed['frNae'],_0x5d9bc4[_0x55bde9(0x48e,0x492,0x4b0,0x412)]));}}function updateComfyUIImagePreview(_0x44129b){const _0x3df006={};_0x3df006[_0x3306b4(-0xf2,-0x124,-0xd0,-0x12b)]=_0x3306b4(-0xe7,-0x10a,-0x11f,-0x194)+'mage-previ'+'ew-contain'+_0x1ea6c6(0x5c,0x4d,0x4,0x48)+_0x1ea6c6(-0x1c,0x4d,0x25,0x46)+'placeholde'+'r',_0x3df006['tICjs']=_0x3306b4(-0xe8,-0x75,-0xda,0x1e)+_0x1ea6c6(0x77,0x1e,-0xa,-0x5a)+_0x3306b4(-0x148,-0x177,-0x1d1,-0x1e4),_0x3df006[_0x1ea6c6(-0x76,0x48,-0x34,0x4a)]=_0x3306b4(-0x2a,-0xad,-0x30,-0x7c);function _0x1ea6c6(_0x415896,_0x512442,_0xe6b03a,_0x3bc267){return _0x37b23e(_0x415896,_0xe6b03a- -0x14f,_0xe6b03a-0xd0,_0x3bc267-0x24);}_0x3df006[_0x3306b4(-0x6c,-0x99,-0x100,-0x26)]=function(_0x2fcbfe,_0xdf7f96){return _0x2fcbfe!==_0xdf7f96;},_0x3df006['IosjE']=function(_0x1fa114,_0x1d870c){return _0x1fa114!==_0x1d870c;},_0x3df006['KrhdO']=_0x1ea6c6(-0xf5,-0x9d,-0xbd,-0x140),_0x3df006[_0x1ea6c6(-0xe9,-0x18,-0x8e,-0xa4)]=_0x3306b4(-0x4a,-0xce,-0x96,-0xed),_0x3df006['DyZrc']=function(_0x3b0464,_0x167223){return _0x3b0464!==_0x167223;},_0x3df006[_0x1ea6c6(0x48,0x17,-0x1,0x14)]=_0x1ea6c6(-0xa6,-0x40,-0xd6,-0x149),_0x3df006[_0x3306b4(-0x1f3,-0x16b,-0x156,-0x1db)]='oLLAQ',_0x3df006[_0x1ea6c6(-0x1b,-0xc3,-0x8b,-0xb4)]=_0x3306b4(-0x187,-0x16f,-0x198,-0x168),_0x3df006[_0x1ea6c6(0x5a,-0xb,0x2c,0x8a)]='none',_0x3df006[_0x3306b4(-0x119,-0x121,-0x140,-0x135)]=_0x1ea6c6(-0xf1,-0x120,-0xb3,-0x11e)+'x',_0x3df006[_0x1ea6c6(-0xb6,-0x59,-0xa3,-0xa6)]=_0x1ea6c6(-0x70,0x33,-0x2c,-0x4b);const _0x536e8e=_0x3df006,_0x500ba7=document[_0x1ea6c6(-0x102,-0xc,-0x70,-0x31)+_0x1ea6c6(-0x37,0x6e,-0xe,0x28)]('previewIma'+'ge2'),_0x3b0e54=document['querySelec'+_0x1ea6c6(-0x1b,-0xb6,-0x28,-0x63)](_0x536e8e[_0x3306b4(-0xf9,-0x124,-0xa7,-0x1a2)]),_0x5bebb0=document['getElement'+_0x1ea6c6(0x56,0x3e,-0xe,-0x45)](_0x536e8e[_0x3306b4(-0x1aa,-0x115,-0xe3,-0x106)]);function _0x3306b4(_0xbd80f6,_0x2f7c9e,_0xdf2efd,_0x5072d1){return _0x37b23e(_0xdf2efd,_0x2f7c9e- -0x1e1,_0xdf2efd-0xaf,_0x5072d1-0x3a);}if(_0x500ba7['src']&&_0x500ba7[_0x3306b4(-0xb5,-0x71,0x25,-0x99)][_0x1ea6c6(0xaf,0x97,0x35,0x80)](_0x536e8e[_0x1ea6c6(0x12,0x60,-0x34,-0x89)])&&_0x536e8e[_0x3306b4(-0x22,-0x99,-0x10c,-0x55)](_0x500ba7[_0x1ea6c6(0x9e,0x48,0x21,0x8a)],_0x44129b)){if(_0x536e8e[_0x3306b4(-0x108,-0xae,-0x72,-0x11a)](_0x536e8e[_0x3306b4(-0xf6,-0xed,-0x12b,-0x8a)],_0x536e8e[_0x1ea6c6(-0xc3,-0x32,-0x8e,-0x10d)]))URL['revokeObje'+_0x3306b4(-0x3b,-0xbb,-0x37,-0x38)](_0x500ba7[_0x1ea6c6(0x3f,0xb5,0x21,0xb2)]);else{const _0x421c7b=_0x59db7a[_0x3306b4(-0xd0,-0xc2,-0x6e,-0xbb)](_0x40c5f4,arguments);return _0x45c6fb=null,_0x421c7b;}}if(_0x44129b){if(_0x536e8e[_0x3306b4(-0xfc,-0x180,-0x19f,-0x203)](_0x536e8e[_0x1ea6c6(-0x6,0x46,-0x1,-0x59)],_0x536e8e[_0x3306b4(-0x1cf,-0x16b,-0x197,-0xec)]))_0x500ba7['src']=_0x44129b,_0x500ba7['style']['display']=_0x536e8e[_0x3306b4(-0xf9,-0x11d,-0x109,-0xcc)],_0x3b0e54['style'][_0x3306b4(-0xfc,-0xcc,-0x13a,-0xc9)]=_0x536e8e[_0x1ea6c6(-0xd,0x88,0x2c,-0x3)],_0x5bebb0[_0x1ea6c6(-0x9,-0x8c,-0x4d,-0x3a)][_0x3306b4(-0xee,-0xcc,-0x52,-0x59)]=_0x536e8e[_0x3306b4(-0x109,-0x121,-0x1a0,-0xb3)];else{if(_0x4e1548){const _0x11eec5=_0xdef26a['apply'](_0x2b01ae,arguments);return _0x3dbf93=null,_0x11eec5;}}}else _0x500ba7[_0x3306b4(-0x73,-0x71,-0x27,-0x73)]='',_0x500ba7['style'][_0x1ea6c6(0x3,0x13,-0x3a,-0xc)]=_0x536e8e[_0x3306b4(-0x86,-0x66,-0x9e,-0x7b)],_0x3b0e54[_0x3306b4(-0x111,-0xdf,-0x13d,-0x118)][_0x1ea6c6(-0x95,-0x2b,-0x3a,-0x12)]=_0x536e8e['SPJEC'],_0x5bebb0[_0x1ea6c6(-0x3c,-0x27,-0x4d,-0x1)][_0x1ea6c6(-0xc4,0x19,-0x3a,0x41)]='none',window[_0x1ea6c6(-0x74,0xa6,0x20,0x82)+_0x3306b4(-0x1d9,-0x150,-0x1ab,-0xe5)]=null,comfyuiImageObjectURL=null;}function removeComfyUIImage(){function _0x32afb9(_0x418303,_0x3b63bb,_0x61b35,_0x3ddf20){return _0x54f62c(_0x61b35,_0x418303-0x2ab,_0x61b35-0x17c,_0x3ddf20-0x18b);}const _0x876f1e={'MeYld':function(_0x8e4c0e,_0x4c15e8){return _0x8e4c0e(_0x4c15e8);}};function _0x424acf(_0x2dd4ac,_0x536480,_0x26df4a,_0x35c1e6){return _0x37b23e(_0x26df4a,_0x35c1e6- -0xf1,_0x26df4a-0x1f1,_0x35c1e6-0xeb);}_0x876f1e[_0x424acf(-0x3,-0x11,-0x17,0x26)](updateComfyUIImagePreview,null),dbs[_0x424acf(-0x69,-0x67,0xc,0x8)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x254394){function _0x4d91c8(_0x24039b,_0x47e689,_0x3bb710,_0x477914){return _0x37b23e(_0x477914,_0x3bb710- -0xc2,_0x3bb710-0x1c5,_0x477914-0xd7);}const _0x423ee5={'SImHx':_0x330e32(0x5b2,0x590,0x5d9,0x664)+_0x330e32(0x4c6,0x515,0x547,0x4b9)+'age-previe'+_0x330e32(0x625,0x58f,0x5e6,0x56c)+_0x4d91c8(0xd3,0xef,0xc0,0xb7)+'u8-image-p'+_0x4d91c8(0x83,-0x28,0xe,0x67),'QqgQC':_0x4d91c8(0x4a,0x3b,0xac,0x62)+_0x330e32(0x5d5,0x6a3,0x61d,0x5fb)+_0x330e32(0x695,0x5a9,0x614,0x5b0)+_0x4d91c8(-0x3a,-0x40,-0x24,0x41),'CcQuA':function(_0x8e2284,_0x2ffc56){return _0x8e2284||_0x2ffc56;},'WVfHx':_0x4d91c8(0x24,0x114,0x88,0xd7)+'Old\x20charac'+_0x330e32(0x5d5,0x5d8,0x5c9,0x5de)+_0x330e32(0x599,0x48d,0x505,0x544)+'ments\x20not\x20'+_0x330e32(0x606,0x503,0x595,0x582)+_0x330e32(0x5de,0x637,0x5a2,0x587)+_0x330e32(0x54e,0x4d3,0x52c,0x496),'KJhCq':'data:image','pgFNa':_0x330e32(0x55c,0x4c4,0x50f,0x57d),'NrUvI':_0x330e32(0x5b5,0x592,0x539,0x5b2)+'x','MRJyE':'1|3|2|0|4','NDRQD':_0x330e32(0x601,0x504,0x58d,0x536),'hzKZP':function(_0x1b9422,_0x163ebc){return _0x1b9422===_0x163ebc;},'HxYsl':'aMCVu','MQZBr':function(_0x1a4d29,_0x20c183){return _0x1a4d29(_0x20c183);},'gggBt':function(_0x38aedd,_0x26288d){return _0x38aedd(_0x26288d);},'bFOKD':function(_0x1a7a52){return _0x1a7a52();},'RIkBk':function(_0x5c6de2,_0xb41a85,_0x411ab2){return _0x5c6de2(_0xb41a85,_0x411ab2);},'TaEGv':_0x4d91c8(0x91,0xfb,0x81,0xcd),'siBzA':function(_0x3395f7,_0x2734a4){return _0x3395f7===_0x2734a4;},'KPVEs':_0x4d91c8(-0x98,0x40,-0x40,-0x96),'KEivj':_0x330e32(0x5e5,0x5a0,0x5f6,0x573)+_0x4d91c8(0xe8,0x106,0xbd,0x38),'kVWrx':function(_0xa622fe,_0xe2532e){return _0xa622fe+_0xe2532e;},'Vsrjl':_0x4d91c8(-0x1e,-0x4d,-0x52,0x26),'cQHJM':_0x4d91c8(0x50,0xf2,0xb8,0xa0)+':\x20','nyUpP':function(_0x361c5d){return _0x361c5d();}},_0x4a64ed=extension_settings[extensionName];function _0x330e32(_0x298446,_0x5bdc4f,_0x46f291,_0x11e730){return _0x37b23e(_0x5bdc4f,_0x46f291-0x49d,_0x46f291-0x19c,_0x11e730-0x71);}const _0x432a2a=_0x254394[_0x4d91c8(0x47,-0x26,-0x20,-0x50)]['files'][-0x237b+0x36a*-0x3+-0x5*-0x925];if(!_0x432a2a)return;try{const _0x373740=await processUploadedImageToBlob(_0x432a2a),_0x20dc4f=URL[_0x330e32(0x600,0x56c,0x5fd,0x684)+_0x4d91c8(0x53,0xc6,0x64,0xd2)](_0x373740);comfyuiImageObjectURL=_0x20dc4f,updateComfyUIImagePreview(_0x20dc4f);const _0x2b02bf=new FormData();_0x2b02bf['append'](_0x330e32(0x5eb,0x5f0,0x59d,0x590),_0x373740,_0x432a2a['name']);let _0xf8e4a9=_0x4a64ed[_0x4d91c8(-0x21,-0x2d,-0x2f,-0x7f)][_0x330e32(0x518,0x588,0x517,0x570)]();if(!_0xf8e4a9){_0x423ee5[_0x330e32(0x559,0x5db,0x58e,0x5c8)](alert,_0x330e32(0x53b,0x583,0x58b,0x575)+_0x330e32(0x515,0x557,0x528,0x552)),_0x423ee5[_0x330e32(0x535,0x564,0x56f,0x510)](removeComfyUIImage);return;}const _0x5b0171=await _0x423ee5[_0x330e32(0x4cc,0x5ca,0x555,0x5d0)](fetch,_0xf8e4a9+(_0x4d91c8(0xe4,0x86,0x5c,0x31)+'age'),{'method':_0x423ee5['TaEGv'],'body':_0x2b02bf});if(_0x5b0171['ok']){if(_0x423ee5['siBzA'](_0x423ee5[_0x330e32(0x6ba,0x5d7,0x624,0x5e4)],_0x423ee5['KPVEs'])){const _0x28e2fb=await _0x5b0171[_0x330e32(0x55d,0x5c4,0x5da,0x634)]();window[_0x4d91c8(0x32,0x85,0xad,0xfe)+_0x330e32(0x57b,0x539,0x52e,0x598)]=_0x28e2fb[_0x330e32(0x5a9,0x520,0x524,0x534)],addLog(_0x330e32(0x62b,0x59c,0x5fe,0x5ea)+'器返回数据:\x20'+JSON[_0x330e32(0x57b,0x5d3,0x5f1,0x571)](_0x28e2fb)),console[_0x4d91c8(0x48,-0x3d,0x47,-0x45)](_0x423ee5[_0x330e32(0x5ee,0x5d1,0x56e,0x57c)],_0x28e2fb);const _0x20eadc=new FileReader();_0x20eadc[_0x4d91c8(-0xd,0x23,-0x3f,0x38)]=()=>{function _0x249669(_0x2c40f5,_0x38bf64,_0x9b7dea,_0x40277b){return _0x330e32(_0x2c40f5-0x137,_0x40277b,_0x38bf64- -0x105,_0x40277b-0xac);}function _0x1f0048(_0x1aa01b,_0x1d5b00,_0x17cd6b,_0x1315b3){return _0x330e32(_0x1aa01b-0x11,_0x1aa01b,_0x17cd6b- -0x18d,_0x1315b3-0x62);}if(_0x423ee5[_0x1f0048(0x4c9,0x452,0x445,0x3f8)](_0x423ee5[_0x249669(0x40d,0x419,0x438,0x3e7)],_0x423ee5[_0x249669(0x452,0x419,0x424,0x498)])){const _0x53c9e4=_0x20eadc[_0x1f0048(0x401,0x394,0x413,0x3a9)],_0x4046a3={};_0x4046a3[_0x249669(0x428,0x43d,0x465,0x3f9)]=_0x53c9e4,_0x4046a3['serverFile'+_0x249669(0x3eb,0x410,0x450,0x3f3)]=_0x28e2fb[_0x1f0048(0x326,0x3fd,0x397,0x3ca)];const _0x102eee=_0x4046a3,_0x19982f={};_0x19982f['id']=COMFYUI_REF_CACHE_KEY,_0x19982f[_0x1f0048(0x3e0,0x3bd,0x3b5,0x397)]=_0x102eee,dbs[_0x249669(0x3c9,0x40c,0x464,0x3bf)+_0x1f0048(0x40a,0x3dc,0x3ad,0x32a)](_0x19982f);}else{const _0x5be67b=_0x1ba279[_0x249669(0x456,0x477,0x446,0x40f)+'ById']('previewIma'+_0x1f0048(0x339,0x345,0x3aa,0x338)+_0x249669(0x431,0x4b9,0x494,0x4c2)),_0xd4bea2=_0x538433['querySelec'+_0x249669(0x4c7,0x4bf,0x4c7,0x4b0)](_0x423ee5[_0x1f0048(0x432,0x3ec,0x438,0x3fb)]),_0x208136=_0x24a502['getElement'+_0x1f0048(0x46a,0x481,0x451,0x48c)](_0x423ee5[_0x1f0048(0x465,0x488,0x3f7,0x39e)]);if(_0x423ee5[_0x1f0048(0x369,0x436,0x3ff,0x3e9)](!_0x5be67b,!_0xd4bea2)||!_0x208136){_0x3749f7[_0x249669(0x420,0x4a1,0x4cd,0x47b)](_0x423ee5[_0x249669(0x475,0x42d,0x422,0x4b2)]);return;}if(_0x38c13e&&_0x4fa14b[_0x249669(0x594,0x51c,0x595,0x559)](_0x423ee5[_0x249669(0x582,0x500,0x50c,0x4b2)])){_0x5be67b[_0x249669(0x4a6,0x508,0x58d,0x583)]=_0x3986d8,_0x5be67b[_0x249669(0x444,0x49a,0x441,0x516)][_0x249669(0x4cc,0x4ad,0x53c,0x461)]=_0x423ee5['pgFNa'],_0xd4bea2[_0x1f0048(0x489,0x3d4,0x412,0x430)][_0x1f0048(0x4ba,0x417,0x425,0x3ab)]=_0x1f0048(0x3b6,0x373,0x400,0x494),_0x208136[_0x1f0048(0x457,0x46a,0x412,0x3f0)][_0x249669(0x421,0x4ad,0x4db,0x43f)]=_0x423ee5['NrUvI'];const _0x1f898b=_0x56978f[_0x249669(0x434,0x441,0x3c8,0x45e)](','),_0x121092=_0x1f898b[0x21da+0xc9*0x10+0x1735*-0x2][_0x1f0048(0x411,0x391,0x3b9,0x426)](':')[0x1225+-0x6fd+-0x23b*0x5][_0x1f0048(0x3d9,0x373,0x3b9,0x373)](';')[-0xf1a+0x2023+-0x7*0x26f];_0x7add55=_0x121092,_0x544aad[_0x249669(0x492,0x4c3,0x4c8,0x469)+'fImage']=_0x1f898b[-0xb1e+0x2268*-0x1+0x2d87];const _0x192567={};_0x192567['id']=_0x56484d,_0x192567[_0x249669(0x3d2,0x43d,0x3fe,0x414)]=_0x19e03b,_0x49f48d['storeReadW'+'rite'](_0x192567);}else{const _0x188533=_0x423ee5[_0x249669(0x4ab,0x4cf,0x45c,0x46a)][_0x1f0048(0x32c,0x359,0x3b9,0x3e1)]('|');let _0x59a524=-0x7*0x272+0x14a8+0x6*-0x97;while(!![]){switch(_0x188533[_0x59a524++]){case'0':_0x208136['style'][_0x249669(0x52b,0x4ad,0x529,0x447)]=_0x423ee5[_0x249669(0x53c,0x50a,0x4cd,0x4fb)];continue;case'1':_0x5be67b['src']='';continue;case'2':_0xd4bea2[_0x249669(0x486,0x49a,0x437,0x4c9)][_0x249669(0x431,0x4ad,0x4ef,0x4aa)]='flex';continue;case'3':_0x5be67b[_0x249669(0x4d5,0x49a,0x429,0x406)][_0x1f0048(0x4a2,0x433,0x425,0x3b4)]=_0x423ee5['NDRQD'];continue;case'4':_0x286cf3['nai3CharRe'+_0x249669(0x4d9,0x4fd,0x520,0x48e)]=null;continue;}break;}}}},_0x20eadc[_0x4d91c8(0xa3,0x5e,0x23,0x5b)+_0x330e32(0x46d,0x495,0x4fc,0x4b8)](_0x373740);}else _0x423ee5[_0x330e32(0x5c6,0x531,0x57e,0x544)](_0x2737e0,null),_0x3c7ea8[_0x330e32(0x53f,0x5ee,0x596,0x587)+'e'](_0x2ad4ec);}else{const _0x2b8222=await _0x5b0171['text']();alert(_0x423ee5[_0x330e32(0x658,0x5ac,0x620,0x651)](_0x330e32(0x5dc,0x5a8,0x55b,0x50d),_0x2b8222)),addLog('图片上传失败,\x20错误'+_0x330e32(0x621,0x5ee,0x5c7,0x63f)+_0x2b8222),console[_0x4d91c8(-0x26,-0x16,-0x51,-0x17)](_0x423ee5[_0x330e32(0x595,0x551,0x5b5,0x5b7)],_0x2b8222),_0x423ee5['bFOKD'](removeComfyUIImage);}}catch(_0x454d93){_0x423ee5[_0x4d91c8(0x9b,0x86,0x2f,-0x2a)](alert,_0x423ee5[_0x4d91c8(0x13a,0xac,0xc1,0xa0)](_0x423ee5['cQHJM'],_0x454d93[_0x330e32(0x5a4,0x619,0x5e9,0x62d)])),console[_0x330e32(0x47a,0x4de,0x50e,0x4dd)](_0x4d91c8(0x39,0xfb,0xb8,0xc3)+':',_0x454d93),addLog(_0x4d91c8(0x26,0x31,-0xd,-0x28)+_0x4d91c8(0x57,-0x11,0x68,0x7c)+JSON[_0x4d91c8(0x4f,0x90,0x92,0xcb)](_0x454d93)),_0x423ee5[_0x4d91c8(-0x3e,0x53,-0x1b,-0x14)](removeComfyUIImage);}}async function loadCachedImages(){function _0x203c8c(_0x15700e,_0x7dfd2b,_0x2a775c,_0x4f2998){return _0x37b23e(_0x15700e,_0x4f2998-0x3da,_0x2a775c-0x29,_0x4f2998-0x1a2);}const _0x9ef637={'Jbzos':_0x203c8c(0x50a,0x47b,0x547,0x4eb)+_0x5381b9(0x147,0x171,0x1dc,0x164),'ydLBX':_0x203c8c(0x4e6,0x4f1,0x4d5,0x4b1)+_0x203c8c(0x541,0x4f9,0x51a,0x525)+_0x203c8c(0x48f,0x45e,0x45b,0x472)+'er\x20.st-cha'+_0x5381b9(0x1cc,0x173,0x1ea,0x237)+_0x203c8c(0x571,0x583,0x588,0x50a)+'r','nZWYS':function(_0x224c5d,_0x53bc5a){return _0x224c5d!==_0x53bc5a;},'RpahL':_0x203c8c(0x47e,0x438,0x464,0x44c),'FwPZE':'inline-fle'+'x','cLCJx':_0x5381b9(0x179,0x21b,0x1ee,0x1c0)+'0','JkvPd':'none','kSvDE':function(_0x1575bb,_0x5f0cd4){return _0x1575bb(_0x5f0cd4);},'mHwCP':function(_0x184912){return _0x184912();},'NzoDU':function(_0x36c58d,_0x313468){return _0x36c58d===_0x313468;},'zAlNo':'SdbSo','vlIkQ':function(_0x5a8f47,_0x317c92){return _0x5a8f47(_0x317c92);},'xGIME':_0x203c8c(0x3dd,0x4dc,0x3ed,0x468),'WYiRu':'Error\x20load'+_0x203c8c(0x56c,0x481,0x4fe,0x515)+_0x5381b9(0x1d7,0x133,0x156,0x120)+_0x203c8c(0x4db,0x4e9,0x41e,0x4ae),'QXrlF':_0x203c8c(0x3d4,0x402,0x40f,0x447),'GHpKu':function(_0x2d359a,_0x55820d){return _0x2d359a===_0x55820d;},'bREgX':_0x5381b9(0x1b7,0x1de,0x172,0x163),'OVfYJ':_0x203c8c(0x506,0x473,0x4a1,0x4fa),'YqyMj':_0x5381b9(0x1e0,0x162,0x1d9,0x235)+'ing\x20cached'+'\x20NovelAI\x20C'+_0x5381b9(0x269,0x249,0x1e1,0x26f)+'age:','VeTFL':'PNEQI','IorkF':function(_0x572d5f,_0x447036){return _0x572d5f(_0x447036);},'ulojv':function(_0x137341,_0x26e714){return _0x137341(_0x26e714);},'xPuSt':_0x5381b9(0x169,0x1fd,0x1c7,0x1d3),'SDpjk':function(_0x3a393f,_0x3a47bf){return _0x3a393f(_0x3a47bf);},'iSOJV':_0x5381b9(0x1ff,0x100,0x16c,0x149)+'fyUI\x20image'+_0x203c8c(0x4c3,0x4b7,0x541,0x51a)+_0x203c8c(0x500,0x475,0x547,0x4b7)+_0x203c8c(0x57c,0x46f,0x495,0x4e8)+_0x203c8c(0x4a9,0x444,0x506,0x495)+_0x5381b9(0x12d,0x81,0x116,0x13a)+'\x20cache\x20to\x20'+_0x203c8c(0x4d2,0x45b,0x4d4,0x4db)+_0x5381b9(0x149,0x1aa,0x115,0x197),'agJUQ':_0x5381b9(0x223,0x1f4,0x1d9,0x24f)+_0x5381b9(0x11f,0x227,0x1b1,0x12a)+_0x5381b9(0x1cc,0x1d1,0x13d,0x142)+'mage:'};await dbs[_0x203c8c(0x510,0x571,0x52c,0x51e)]();try{if(_0x9ef637[_0x203c8c(0x402,0x4b4,0x46e,0x482)](_0x9ef637[_0x5381b9(0x1e4,0x13f,0x198,0x1ef)],_0x5381b9(0xe8,0x1da,0x154,0x1e9))){const _0x2e3d3b=_0x35006d[_0x5381b9(0x16f,0x180,0x155,0x1a4)+_0x5381b9(0x1c3,0x1be,0x1b7,0x198)](_0x9ef637[_0x5381b9(0x1a2,0x159,0x1a3,0x123)]),_0x423e18=_0x2d5a44['querySelec'+'tor'](_0x9ef637[_0x5381b9(0x127,0x8d,0x10d,0x17b)]),_0x4a64c2=_0x1e5df6[_0x203c8c(0x479,0x54d,0x507,0x4b9)+_0x5381b9(0x17a,0x17d,0x1b7,0x14e)](_0x203c8c(0x4d4,0x4b2,0x5c8,0x546)+_0x5381b9(0x165,0x145,0x1bb,0x169)+'-btn');_0x2e3d3b['src']&&_0x2e3d3b[_0x5381b9(0x1f6,0x21e,0x1e6,0x177)][_0x203c8c(0x516,0x4ca,0x59a,0x55e)](_0x5381b9(0x1fd,0x21e,0x1aa,0x230))&&_0x9ef637[_0x5381b9(0x156,0x10c,0x19a,0x1f6)](_0x2e3d3b[_0x5381b9(0x24c,0x188,0x1e6,0x209)],_0x1f6568)&&_0x1e0201[_0x5381b9(0x1df,0x135,0x192,0x132)+'ctURL'](_0x2e3d3b[_0x203c8c(0x595,0x51e,0x560,0x54a)]);if(_0x1497ba)_0x2e3d3b['src']=_0x1ea015,_0x2e3d3b[_0x5381b9(0xf1,0x10b,0x178,0x105)][_0x203c8c(0x4cd,0x474,0x4d9,0x4ef)]=_0x9ef637[_0x203c8c(0x4c0,0x4af,0x3d7,0x457)],_0x423e18[_0x5381b9(0x16e,0x1d4,0x178,0x124)][_0x5381b9(0x160,0x1ca,0x18b,0x17f)]=_0x5381b9(0xe1,0x105,0x166,0x159),_0x4a64c2[_0x203c8c(0x4d7,0x564,0x4a6,0x4dc)][_0x203c8c(0x49e,0x516,0x54a,0x4ef)]=_0x9ef637[_0x5381b9(0x180,0x156,0x1cd,0x189)];else{const _0x1b8b73=_0x9ef637['cLCJx'][_0x5381b9(0x14e,0x168,0x11f,0x142)]('|');let _0x4ffda6=0x1793+-0xc0e+-0xb85*0x1;while(!![]){switch(_0x1b8b73[_0x4ffda6++]){case'0':_0x2aa0bd=null;continue;case'1':_0x4a64c2['style']['display']=_0x9ef637[_0x203c8c(0x4b7,0x4ed,0x4ac,0x518)];continue;case'2':_0x2e3d3b[_0x203c8c(0x52c,0x49e,0x4e7,0x4dc)][_0x5381b9(0x19d,0x13d,0x18b,0x1f8)]=_0x9ef637[_0x203c8c(0x5a3,0x482,0x5a2,0x518)];continue;case'3':_0x40a445['comfyuican'+'kaotupian']=null;continue;case'4':_0x2e3d3b[_0x203c8c(0x4cd,0x5b1,0x5d0,0x54a)]='';continue;case'5':_0x423e18[_0x203c8c(0x524,0x550,0x543,0x4dc)][_0x203c8c(0x46f,0x4ab,0x55c,0x4ef)]=_0x5381b9(0x1fe,0x1dc,0x199,0x138);continue;}break;}}}else{const _0x5e4676=await dbs[_0x203c8c(0x4a8,0x513,0x4a1,0x488)+_0x5381b9(0x169,0x22c,0x1cc,0x211)](NAI_VIBE_CACHE_KEY);_0x5e4676&&_0x5e4676[_0x5381b9(0xa7,0x14a,0x11b,0x118)]&&_0x9ef637[_0x5381b9(0x144,0x124,0x1b8,0x246)](updateNovelaiImagePreview,_0x5e4676[_0x203c8c(0x459,0x46b,0x433,0x47f)]);}}catch(_0xfd4e25){if(_0x9ef637[_0x203c8c(0x4a6,0x4c4,0x514,0x485)]!==_0x9ef637[_0x5381b9(0x11c,0x17a,0x121,0x145)]){_0x9ef637[_0x203c8c(0x4ac,0x51b,0x574,0x50c)](_0x104e99,_0x5381b9(0x129,0x1cb,0x164,0x167)+_0x203c8c(0x3e8,0x4ab,0x3eb,0x465)),_0x9ef637['mHwCP'](_0x33146f);return;}else console[_0x5381b9(0x108,0xca,0xe7,0xfc)](_0x9ef637[_0x5381b9(0x253,0x1a6,0x1e7,0x226)],_0xfd4e25);}try{if(_0x9ef637[_0x5381b9(0x174,0x147,0x11e,0x169)](_0x9ef637[_0x5381b9(0x227,0x25e,0x1f7,0x18b)],_0x9ef637[_0x203c8c(0x500,0x50e,0x509,0x55b)])){const _0x277f5c=await dbs[_0x203c8c(0x487,0x465,0x490,0x488)+'nly'](NAI_CHAR_REF_CACHE_KEY);_0x277f5c&&_0x277f5c[_0x203c8c(0x3fa,0x4e0,0x4d0,0x47f)]&&updateNovelaiCharRefImagePreview(_0x277f5c[_0x5381b9(0xeb,0xa1,0x11b,0x197)]);}else _0x14612();}catch(_0x57780a){_0x9ef637[_0x5381b9(0x128,0x16e,0x143,0x192)](_0x9ef637['bREgX'],_0x9ef637[_0x5381b9(0x188,0x129,0x139,0xd3)])?(_0x3925e9['src']=_0x59edf2,_0x521d18[_0x5381b9(0x19c,0xed,0x178,0x19f)][_0x5381b9(0x176,0x189,0x18b,0x15e)]=_0x9ef637[_0x203c8c(0x4e0,0x3e0,0x490,0x457)],_0x1d66e8[_0x5381b9(0x16e,0x1a3,0x178,0x1b3)][_0x5381b9(0x1f8,0x1f3,0x18b,0x1ed)]=_0x9ef637['JkvPd'],_0x458f06[_0x5381b9(0x179,0x17b,0x178,0xf9)]['display']=_0x9ef637[_0x203c8c(0x5a3,0x4a7,0x4ef,0x531)]):console[_0x203c8c(0x3f3,0x43b,0x40f,0x44b)](_0x9ef637[_0x5381b9(0x142,0x99,0xe2,0x12d)],_0x57780a);}function _0x5381b9(_0x940faf,_0x5b5a2d,_0x4d9036,_0x1addf3){return _0x37b23e(_0x940faf,_0x4d9036-0x76,_0x4d9036-0x1c3,_0x1addf3-0x16e);}try{if(_0x5381b9(0x239,0x21d,0x1ec,0x21b)!==_0x9ef637[_0x203c8c(0x40d,0x468,0x446,0x448)]){const _0x1b81cd=await dbs[_0x203c8c(0x41e,0x401,0x3fa,0x488)+_0x5381b9(0x175,0x211,0x1cc,0x16e)](COMFYUI_REF_CACHE_KEY);if(_0x1b81cd&&_0x1b81cd['data']&&_0x1b81cd['data']['data']&&_0x1b81cd['data'][_0x203c8c(0x47c,0x414,0x428,0x45e)+_0x203c8c(0x42d,0x49b,0x472,0x452)]){const _0x1ec05a=_0x1b81cd[_0x5381b9(0xbe,0x167,0x11b,0x14e)],_0x3a0a0b=await _0x9ef637['IorkF'](fetch,_0x1ec05a[_0x5381b9(0x180,0xfc,0x11b,0x1b2)]),_0x45a7ea=await _0x3a0a0b[_0x203c8c(0x52d,0x4f7,0x597,0x562)](),_0x16bbd3=URL[_0x203c8c(0x5c2,0x593,0x51c,0x53a)+_0x5381b9(0x11e,0x1a2,0x19c,0x126)](_0x45a7ea);_0x9ef637[_0x5381b9(0xa0,0xe8,0xf5,0x95)](updateComfyUIImagePreview,_0x16bbd3),comfyuiImageObjectURL=_0x16bbd3,window['comfyuican'+_0x203c8c(0x4c6,0x4e8,0x403,0x46b)]=_0x1ec05a[_0x203c8c(0x475,0x4d5,0x3e2,0x45e)+_0x5381b9(0xcf,0x17e,0xee,0x88)],_0x9ef637[_0x203c8c(0x46b,0x4f3,0x40c,0x463)](addLog,_0x5381b9(0xc8,0x8a,0xda,0xc9)+_0x5381b9(0x13f,0x15b,0x140,0x1d4)+_0x1ec05a[_0x203c8c(0x4e6,0x4f1,0x429,0x45e)+_0x5381b9(0xf6,0xad,0xee,0x138)]),console['log']('Loaded\x20Com'+_0x203c8c(0x55e,0x4fd,0x4df,0x553)+_0x5381b9(0x163,0x221,0x18a,0x1c3)+_0x203c8c(0x4d2,0x477,0x412,0x470)+_0x1ec05a['serverFile'+_0x5381b9(0xab,0xb6,0xee,0x174)]);}else{if(_0x1b81cd&&_0x9ef637[_0x5381b9(0x10f,0xbe,0x143,0x16c)](typeof _0x1b81cd[_0x203c8c(0x490,0x4c0,0x4a1,0x47f)],_0x9ef637[_0x203c8c(0x44c,0x3ac,0x459,0x441)])){const _0x49b301=await _0x9ef637[_0x203c8c(0x4a0,0x47b,0x4a2,0x4af)](fetch,_0x1b81cd['data']),_0x51c684=await _0x49b301[_0x203c8c(0x5d7,0x5a7,0x4e9,0x562)](),_0x3a8e5e=URL[_0x203c8c(0x547,0x51d,0x583,0x53a)+_0x5381b9(0x170,0x20f,0x19c,0x173)](_0x51c684);updateComfyUIImagePreview(_0x3a8e5e),comfyuiImageObjectURL=_0x3a8e5e,console['warn'](_0x9ef637[_0x203c8c(0x4c5,0x4af,0x43f,0x4c5)]);}}}else{const _0x5f5b23=_0x21ef33?function(){function _0x13c1ed(_0x507e94,_0x4d8ec6,_0x3de78c,_0x3abce8){return _0x5381b9(_0x4d8ec6,_0x4d8ec6-0x1ea,_0x507e94-0x3f5,_0x3abce8-0x72);}if(_0x4e34b3){const _0x106868=_0x498f52[_0x13c1ed(0x58a,0x5c6,0x4f4,0x535)](_0x2ade94,arguments);return _0x6be50c=null,_0x106868;}}:function(){};return _0x2af558=![],_0x5f5b23;}}catch(_0x2ccd0e){console[_0x203c8c(0x3fd,0x471,0x400,0x44b)](_0x9ef637[_0x203c8c(0x44a,0x477,0x44c,0x4e1)],_0x2ccd0e);}}export function initImageUpload(_0x4e20f3){const _0x3ec9f7={'igelA':function(_0x33d727,_0x538b26){return _0x33d727(_0x538b26);},'ZmdBv':function(_0x4ffaaa,_0x6793ab){return _0x4ffaaa+_0x6793ab;},'hnbre':_0x3e2f91(-0xf4,-0x1d2,-0x1ee,-0x172),'EJdwF':'aKkHs','HMfhg':_0x4d101d(0x498,0x4cb,0x56f,0x51e)+_0x4d101d(0x4e1,0x5ca,0x4b6,0x547),'kWdLL':_0x4d101d(0x5cd,0x56b,0x4fb,0x572)+_0x4d101d(0x4e3,0x4d2,0x59d,0x54a)+_0x4d101d(0x4f9,0x472,0x42c,0x475)+_0x4d101d(0x59f,0x50e,0x59c,0x57a)+_0x3e2f91(-0x1f8,-0x277,-0x1d7,-0x23a),'GOHGV':function(_0x5d7c7c,_0x30e785){return _0x5d7c7c!==_0x30e785;},'okdCD':_0x4d101d(0x4c5,0x55d,0x4bb,0x515),'AseTR':function(_0x361470){return _0x361470();},'SjYVn':_0x4d101d(0x563,0x57d,0x4d2,0x51e)+'_nai_char_'+_0x4d101d(0x4fc,0x486,0x48b,0x48d),'eIGFq':function(_0x25c63e){return _0x25c63e();},'QTGcY':function(_0x39c540,_0x4d5501){return _0x39c540+_0x4d5501;},'THRAM':_0x3e2f91(-0x12a,-0x125,-0x15f,-0x182)+':','opkGN':function(_0x483d06,_0x11262f){return _0x483d06(_0x11262f);},'KfkBf':function(_0x2a050c){return _0x2a050c();},'VLKNM':_0x4d101d(0x455,0x4c0,0x4e8,0x49b),'fsTSN':_0x4d101d(0x4b7,0x54d,0x5af,0x529),'OSgez':'#novelai-r'+_0x3e2f91(-0x280,-0x2a8,-0x1a4,-0x218)+'e-btn','PLKzX':_0x3e2f91(-0x175,-0x1f3,-0x242,-0x1bd)+_0x3e2f91(-0x241,-0x23c,-0x28a,-0x202)+'-ref-image'+_0x4d101d(0x3fc,0x3f2,0x4a7,0x479),'FiPeu':_0x3e2f91(-0x186,-0x1fe,-0x1cb,-0x195)+'t_nai_char'+'_ref','aMITW':_0x4d101d(0x560,0x546,0x4cd,0x545),'HhUwV':_0x4d101d(0x532,0x4e4,0x4db,0x513)+_0x3e2f91(-0x19d,-0x216,-0x1cd,-0x1a1)+_0x3e2f91(-0x1b5,-0x1bb,-0x201,-0x177)+_0x4d101d(0x50b,0x413,0x45b,0x479),'lEtBu':_0x3e2f91(-0x201,-0x1cb,-0x240,-0x219)+_0x4d101d(0x5b7,0x4ed,0x586,0x540)+'e-btn','tEiRM':_0x4d101d(0x4f5,0x55c,0x5c8,0x582)+_0x4d101d(0x4eb,0x4b3,0x564,0x4f3)+_0x3e2f91(-0x1a3,-0x23e,-0x257,-0x1ce)};_0x3ec9f7[_0x4d101d(0x5ed,0x53c,0x5fe,0x569)](loadCachedImages),_0x4e20f3['find'](_0x3e2f91(-0x233,-0x1cc,-0x1af,-0x1bd)+_0x4d101d(0x5af,0x580,0x520,0x540)+_0x4d101d(0x4c9,0x5aa,0x4a8,0x53d))['on'](_0x3ec9f7[_0x4d101d(0x4bf,0x49f,0x55f,0x4fb)],()=>{function _0x4dc05a(_0x516f94,_0x11f572,_0xbd0dd6,_0x143b42){return _0x3e2f91(_0x516f94-0x149,_0x11f572-0x5f,_0x11f572,_0x516f94-0x314);}function _0x502752(_0x31c2a6,_0x174c29,_0x1d1848,_0x25a5ae){return _0x4d101d(_0x31c2a6-0x1a6,_0x174c29-0x69,_0x174c29,_0x25a5ae- -0x5da);}_0x4dc05a(0x7d,-0xe,0xa7,-0x6)!==_0x3ec9f7[_0x4dc05a(0xc9,0x61,0x7f,0x40)]?document['getElement'+_0x4dc05a(0x159,0x1b5,0x1b9,0x16f)](_0x3ec9f7[_0x502752(-0x13e,-0x145,-0xae,-0xf8)])[_0x4dc05a(0x132,0xa1,0xf5,0x1b2)]():(_0x2c2dd6[_0x502752(-0xcf,-0x1c1,-0xca,-0x15a)](_0x502752(-0xbf,0x20,0x13,-0x5e)+_0x502752(-0x1e2,-0xeb,-0x1e9,-0x158)+_0x4dc05a(0x182,0x132,0x1ae,0xec)+':',_0x43c02a),_0x3ec9f7[_0x4dc05a(0x7b,0x57,0x3d,0x5d)](_0x35e820,_0x3ec9f7[_0x4dc05a(0x7a,0x8f,0xe3,0x95)](_0x3ec9f7[_0x4dc05a(0xa2,0xe7,0xb5,0xf0)],_0x3efb0a[_0x4dc05a(0x164,0xe5,0x14f,0x129)])));}),_0x4e20f3[_0x3e2f91(-0x16a,-0x15b,-0x1b6,-0x1a7)](_0x3e2f91(-0x1ae,-0x153,-0x136,-0x195)+_0x4d101d(0x496,0x4b5,0x56b,0x4ea))['on']('change',handleNovelaiImageUpload),_0x4e20f3[_0x3e2f91(-0x1b1,-0x113,-0x1e5,-0x1a7)](_0x3ec9f7[_0x4d101d(0x503,0x433,0x4ab,0x4bc)])['on'](_0x3ec9f7[_0x4d101d(0x480,0x550,0x518,0x4fb)],()=>{function _0x1835a4(_0x150e1c,_0x3a556c,_0x37ea46,_0x3163c8){return _0x4d101d(_0x150e1c-0x134,_0x3a556c-0x14c,_0x37ea46,_0x150e1c- -0x474);}function _0x459947(_0x7a05ce,_0x5a7f8b,_0x202983,_0x1bb5ff){return _0x3e2f91(_0x7a05ce-0xde,_0x5a7f8b-0xec,_0x7a05ce,_0x1bb5ff-0x43e);}_0x3ec9f7[_0x459947(0x260,0x1b0,0x2ab,0x21e)](_0x3ec9f7[_0x1835a4(0xea,0x54,0x14a,0x125)],_0x459947(0x1df,0x2b9,0x2b6,0x248))?_0x476a71[_0x1835a4(0xc,0x80,-0x45,0x56)](_0x3ec9f7[_0x459947(0x2db,0x218,0x28a,0x27c)],_0x150307):_0x3ec9f7[_0x459947(0x2c8,0x2d1,0x328,0x2b7)](removeNovelaiImage);}),_0x4e20f3[_0x3e2f91(-0x20f,-0x13a,-0x233,-0x1a7)](_0x3ec9f7[_0x4d101d(0x5c7,0x5ec,0x5b6,0x573)])['on'](_0x3e2f91(-0x23c,-0x166,-0x162,-0x1e2),()=>{function _0x3a65c1(_0x5277f0,_0x56535f,_0x52d506,_0x1a5961){return _0x4d101d(_0x5277f0-0x1a,_0x56535f-0x101,_0x5277f0,_0x52d506- -0x1bc);}function _0x640799(_0x3d8a98,_0x8ed4cc,_0x1d91ad,_0x2aa650){return _0x4d101d(_0x3d8a98-0x11d,_0x8ed4cc-0x1dc,_0x3d8a98,_0x1d91ad- -0x662);}document[_0x3a65c1(0x2df,0x38d,0x332,0x2e3)+_0x640799(-0x162,-0x144,-0x112,-0xec)](_0x3ec9f7[_0x640799(-0x163,-0x1db,-0x17b,-0x130)])['click']();}),_0x4e20f3[_0x3e2f91(-0x1c2,-0x217,-0x1ef,-0x1a7)](_0x3ec9f7[_0x4d101d(0x5a7,0x4d1,0x5a7,0x51f)])['on'](_0x3ec9f7['aMITW'],handleNovelaiCharRefImageUpload),_0x4e20f3[_0x4d101d(0x53a,0x512,0x535,0x564)](_0x3ec9f7[_0x4d101d(0x498,0x52a,0x4df,0x517)])['on'](_0x4d101d(0x4cd,0x583,0x596,0x529),()=>{_0x3ec9f7['eIGFq'](removeNovelaiCharRefImage);});function _0x4d101d(_0x230b01,_0x33dff4,_0x4194a1,_0x6922b6){return _0x37b23e(_0x4194a1,_0x6922b6-0x40f,_0x4194a1-0x19b,_0x6922b6-0x128);}_0x4e20f3[_0x3e2f91(-0x16f,-0x111,-0x1c9,-0x1a7)](_0x3ec9f7['lEtBu'])['on'](_0x3ec9f7[_0x3e2f91(-0x2a5,-0x19d,-0x249,-0x210)],()=>{function _0x45eada(_0x110307,_0x4f2431,_0x4caedf,_0x8cf536){return _0x3e2f91(_0x110307-0xbc,_0x4f2431-0x181,_0x4caedf,_0x8cf536-0x5a6);}function _0xeb1d25(_0x51aea6,_0x4c9469,_0x3a5d78,_0x378b6){return _0x4d101d(_0x51aea6-0xfa,_0x4c9469-0x50,_0x378b6,_0x4c9469- -0x479);}const _0x5891f7={'xPcpq':function(_0x167c17,_0x409ad4){function _0x92924f(_0x2483cd,_0x9f4828,_0x4e1f79,_0x443b72){return _0x2a34(_0x9f4828-0xb0,_0x2483cd);}return _0x3ec9f7[_0x92924f(0x317,0x304,0x2c2,0x316)](_0x167c17,_0x409ad4);},'Zxftf':_0x3ec9f7[_0xeb1d25(0x6e,0x1,-0x30,-0x2)],'abchx':function(_0x21c9ce,_0x545430){function _0x1af166(_0x55e06f,_0x2bb3a3,_0x5a6b65,_0x168589){return _0xeb1d25(_0x55e06f-0x126,_0x2bb3a3-0x226,_0x5a6b65-0x9e,_0x5a6b65);}return _0x3ec9f7[_0x1af166(0x293,0x30e,0x2ba,0x308)](_0x21c9ce,_0x545430);},'Xszey':function(_0x544376){return _0x3ec9f7['KfkBf'](_0x544376);}};_0x3ec9f7['GOHGV'](_0x3ec9f7['VLKNM'],_0xeb1d25(-0xd,0x22,0x1f,0x62))?(_0x1a7d8b(_0x5891f7[_0xeb1d25(0xaa,0xf8,0x6c,0x161)](_0xeb1d25(0xb5,0x110,0x187,0x190)+':\x20',_0x75720d[_0xeb1d25(0x8e,0xe2,0xbb,0x95)])),_0x1530ac['error'](_0x5891f7[_0xeb1d25(-0x2f,-0xa,-0x8b,0x56)],_0x5337ff),_0x5891f7['abchx'](_0x2b7820,_0x45eada(0x3bb,0x3cf,0x394,0x35f)+_0x45eada(0x3a1,0x3d9,0x3ad,0x3d4)+_0x5d5d73[_0xeb1d25(0x10a,0xea,0xd1,0x128)](_0x570626)),_0x5891f7[_0x45eada(0x2ce,0x361,0x36a,0x359)](_0x3c443c)):document[_0xeb1d25(0xb3,0x75,0x47,0xd7)+_0xeb1d25(0x5c,0xd7,0xb1,0x112)](_0x45eada(0x3c3,0x349,0x433,0x3b9)+'2')[_0xeb1d25(0x31,0xb0,0xe3,0x9e)]();});function _0x3e2f91(_0x3ef7ee,_0x1600bc,_0x29ea74,_0x2110a7){return _0x37b23e(_0x29ea74,_0x2110a7- -0x2fc,_0x29ea74-0x1ba,_0x2110a7-0xd5);}_0x4e20f3[_0x3e2f91(-0x186,-0x12d,-0x1a4,-0x1a7)](_0x4d101d(0x569,0x5aa,0x601,0x576)+'t2')['on']('change',handleImageUpload2),_0x4e20f3[_0x3e2f91(-0x212,-0x1d8,-0x1ff,-0x1a7)](_0x3ec9f7[_0x3e2f91(-0x19e,-0x254,-0x21d,-0x231)])['on'](_0x3ec9f7[_0x3e2f91(-0x21e,-0x271,-0x1bc,-0x210)],()=>{function _0x21a066(_0x284621,_0x188d0a,_0x11c522,_0x2fbf06){return _0x3e2f91(_0x284621-0x1c7,_0x188d0a-0xda,_0x284621,_0x2fbf06-0x193);}_0x3ec9f7[_0x21a066(0xa2,0x5d,-0x1b,0xc)](removeComfyUIImage);});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};