(function(_0x4d7036,_0x1a793b){function _0x499573(_0x51eb40,_0x1c346a,_0x4834e1,_0x595513){return _0x9680(_0x1c346a- -0x298,_0x4834e1);}const _0xc2dfdf=_0x4d7036();function _0xaaa4c7(_0x1558ca,_0x4946e4,_0x302c61,_0xd14d56){return _0x9680(_0x302c61- -0x17e,_0x1558ca);}while(!![]){try{const _0x1148e1=-parseInt(_0x499573(-0x17,-0x7b,-0x55,-0xe9))/(0xaec+0x2586*-0x1+-0x3cd*-0x7)*(parseInt(_0x499573(-0x16f,-0x120,-0xd9,-0x124))/(-0x10fa+0x2080+-0xf84))+-parseInt(_0x499573(-0x23,-0x73,-0xa2,-0x6e))/(0x1*-0x3e+-0x14d5+-0x1*-0x1516)+parseInt(_0xaaa4c7(0x9e,0x5f,0x4b,-0x19))/(-0x8c*0x9+0x1e9*-0x1+0x6d9)*(parseInt(_0x499573(-0xa4,-0x53,-0x9,-0x4f))/(0x1b6e*-0x1+-0x20f0+0x3c63))+-parseInt(_0x499573(-0x7d,-0xc8,-0x133,-0x50))/(-0x2f*0x91+-0x6*0x541+0x3a2b)*(parseInt(_0xaaa4c7(0x10f,0x129,0xae,0xa3))/(-0x1577+-0x1d*-0x2b+0x109f))+parseInt(_0x499573(-0x80,-0x67,-0x46,-0xcb))/(0x51*-0x79+-0x85*-0x17+0x1a5e)+parseInt(_0x499573(-0x38,-0xa6,-0x9e,-0xb8))/(-0x1*0x2c5+-0x1*0x2182+0x53*0x70)*(parseInt(_0x499573(-0x11a,-0xa7,-0x86,-0x12c))/(-0x1539+-0x1ab3*0x1+0x36d*0xe))+parseInt(_0xaaa4c7(0x171,0xf3,0xef,0xdc))/(-0x17*0x141+-0x212c+0x3e0e)*(parseInt(_0xaaa4c7(0x122,0xc6,0xb4,0x3b))/(0x73*0x4a+0x1401+-0x3533));if(_0x1148e1===_0x1a793b)break;else _0xc2dfdf['push'](_0xc2dfdf['shift']());}catch(_0x5c203f){_0xc2dfdf['push'](_0xc2dfdf['shift']());}}}(_0x39de,0xeb569+-0x5*0x3d91+-0x15263));function _0x9680(_0x86e1fa,_0xa05f84){_0x86e1fa=_0x86e1fa-(-0xb9+-0x1f06+0x211c);const _0x2cb0c9=_0x39de();let _0x57224a=_0x2cb0c9[_0x86e1fa];if(_0x9680['hbWitG']===undefined){var _0x4c7ca0=function(_0x5b477d){const _0x4cfc07='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x8d30cf='',_0x96090='',_0x5e23cb=_0x8d30cf+_0x4c7ca0;for(let _0xa3b9aa=0x857+-0xfaf*0x2+0x1707,_0x4472d7,_0xc3be95,_0x155f37=-0x25b0+0x1ff5+0xa3*0x9;_0xc3be95=_0x5b477d['charAt'](_0x155f37++);~_0xc3be95&&(_0x4472d7=_0xa3b9aa%(-0x25+0x7a*0x29+-0x1361)?_0x4472d7*(-0x14e+0xb*-0x36a+0x271c)+_0xc3be95:_0xc3be95,_0xa3b9aa++%(-0x2553+0x31a+0x223d))?_0x8d30cf+=_0x5e23cb['charCodeAt'](_0x155f37+(-0x124a+-0x151f+0x2773))-(0x264f+-0x26fe+0xb9)!==-0x515*0x7+0x14e*-0x13+0x3c5d?String['fromCharCode'](0x141*-0x1f+-0x1965+0x15c1*0x3&_0x4472d7>>(-(0x32a+-0x9*-0x281+-0x19b1)*_0xa3b9aa&0x2017+0x214f+-0x4160)):_0xa3b9aa:-0x12*-0x1dd+-0x1c10+-0x57a){_0xc3be95=_0x4cfc07['indexOf'](_0xc3be95);}for(let _0x5a9420=0xd3*0x26+-0x209+-0x1d49,_0x218013=_0x8d30cf['length'];_0x5a9420<_0x218013;_0x5a9420++){_0x96090+='%'+('00'+_0x8d30cf['charCodeAt'](_0x5a9420)['toString'](-0xbf*-0xd+-0xbf*-0xb+0x11d8*-0x1))['slice'](-(0x238a+0xc10+0x4*-0xbe6));}return decodeURIComponent(_0x96090);};_0x9680['gmnjUm']=_0x4c7ca0,_0x9680['nXjHEw']={},_0x9680['hbWitG']=!![];}const _0x777677=_0x2cb0c9[0x9c*0x28+0x1d7+-0x1a37],_0x40a14e=_0x86e1fa+_0x777677,_0x50feb6=_0x9680['nXjHEw'][_0x40a14e];if(!_0x50feb6){const _0x5475e6=function(_0x29e997){this['FBrKZd']=_0x29e997,this['DNJepc']=[0x1*-0x182+0x19e5+0x1862*-0x1,-0x1ddb+0x15ab+0x830,-0xff9+-0xe0f+-0x1e08*-0x1],this['NKAiwX']=function(){return'newState';},this['WWaedF']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['DxpHaJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5475e6['prototype']['NHtlII']=function(){const _0x278118=new RegExp(this['WWaedF']+this['DxpHaJ']),_0xe6cf03=_0x278118['test'](this['NKAiwX']['toString']())?--this['DNJepc'][0x1f1c+0x3a2+-0x22bd*0x1]:--this['DNJepc'][0x2567*0x1+-0x8*-0x2b4+-0x3b07];return this['dAPqOc'](_0xe6cf03);},_0x5475e6['prototype']['dAPqOc']=function(_0x385b21){if(!Boolean(~_0x385b21))return _0x385b21;return this['oafZZH'](this['FBrKZd']);},_0x5475e6['prototype']['oafZZH']=function(_0x345f8d){for(let _0x555f38=-0x2*-0x12be+-0x1*0x637+-0x1f45,_0x302774=this['DNJepc']['length'];_0x555f38<_0x302774;_0x555f38++){this['DNJepc']['push'](Math['round'](Math['random']())),_0x302774=this['DNJepc']['length'];}return _0x345f8d(this['DNJepc'][0x1*-0x1e67+0x1e*0x61+0x1309]);},new _0x5475e6(_0x9680)['NHtlII'](),_0x57224a=_0x9680['gmnjUm'](_0x57224a),_0x9680['nXjHEw'][_0x40a14e]=_0x57224a;}else _0x57224a=_0x50feb6;return _0x57224a;}const _0x262de3=(function(){let _0x4a6cad=!![];return function(_0x5373b5,_0x3593e0){const _0x500c99=_0x4a6cad?function(){function _0x352364(_0xd634fd,_0x4aaa43,_0x536854,_0x175270){return _0x9680(_0x175270- -0x2f6,_0x536854);}function _0x4fc6e4(_0x506317,_0x264e48,_0x20f0c5,_0x49450a){return _0x9680(_0x49450a-0x3c,_0x264e48);}if(_0x3593e0){if('hHKCv'!==_0x4fc6e4(0x23a,0x246,0x270,0x226)){const _0x2514f1=_0x3593e0[_0x4fc6e4(0x270,0x2db,0x299,0x272)](_0x5373b5,arguments);return _0x3593e0=null,_0x2514f1;}else{if(_0x23215c){const _0x45677a=_0x51f263[_0x352364(-0xa9,-0xe5,-0x62,-0xc0)](_0x2dbb48,arguments);return _0x444e01=null,_0x45677a;}}}}:function(){};return _0x4a6cad=![],_0x500c99;};}()),_0x1c148f=_0x262de3(this,function(){function _0x392620(_0x417650,_0x10639c,_0x2b8c06,_0x133dff){return _0x9680(_0x417650-0xf7,_0x133dff);}const _0x2976b1={};function _0x2f6ed9(_0x1ad6c9,_0x38c9f2,_0x24ef57,_0x1ec404){return _0x9680(_0x1ad6c9- -0x30,_0x1ec404);}_0x2976b1[_0x2f6ed9(0x1b5,0x23b,0x177,0x182)]=_0x2f6ed9(0x16f,0x1bd,0x111,0x10b)+'+$';const _0x24f2bf=_0x2976b1;return _0x1c148f['toString']()['search']('(((.+)+)+)'+'+$')[_0x392620(0x273,0x20a,0x224,0x1fb)]()[_0x392620(0x2a0,0x267,0x29b,0x216)+'r'](_0x1c148f)['search'](_0x24f2bf[_0x392620(0x2dc,0x25b,0x31b,0x352)]);});function _0x39de(){const _0x4282d2=['rxjYB3iGBg9Hza','ywDLlxbYzxzPzq','Aw5SAw5LlwzSzq','C3rVCMvszwfKvW','x25VDMvSywK','DtGTAw1Hz2uTCa','DKzwCKq','rxLrExG','z2v0rwXLBwvUDa','otvsuffvwKu','thndsgm','C3D6q3q','C3rVCMvezwXLDa','Dg1vtg0','D2fYBG','CLb2zMi','u0fJBM4','mJeXmdq5mwH4r0XNvq','zNLvssbPBwfNzq','rw9Wu0S','zxCTy29UDgfPBG','wvzjzvC','BM92zwXHAs1Yzq','zxzeyvG','ndKXndC0mM5wDgzbuW','rxjYB3iGChjVyW','i25VDMvSywKTCG','BM13zKG','i2nVBwz5DwKTCG','mtq4ntuYofjpq1fuqW','mJC4otmZmtzyy01ACwC','zwXLy3qTAw1HzW','y2fJAguGzM9YBq','vhbbrwm','yxbWBhK','rLfgt1q','z2LusK4','quHiALa','qvvetLe','ue9tva','y2XPy2S','zK9PELu','ignHy2HLihrVia','Df9UB3zLBgfP','ANnVBG','q3PUvMu','AwjLigLTywDLoG','zwzFAw1Hz2u','rffbtee','nJeXntm1r3LRuw94','zKLTywDL','ENzjs2e','CMvHzefZrgf0yq','DhLou20','EgjQs2O','m3WYFdf8nhWW','y2fJAgvFBM92zq','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','Bg9N','wNrQvgi','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','ywDLoG','C3rHCNrZv2L0Aa','yMLuBgS','igzYB20GB2XKia','DvjwDKq','ChDuvhi','CKTxwve','AvbXDwy','vvjm','BMfTzq','yxbWzw5K','yw5ZzMvYsw1HzW','CMXkC0e','BfPPuw4','wKDdy0e','BMfPm1zPyMvuCG','C2vYDMvYrMLSzq','wgLYvM4','rvLMCMy','ywzNt3K','D3fywMK','lxjLzI1PBwfNzq','tM9jDg4','Exryq3q','DMHjBK0','CgXHy2vOB2XKzq','C2PrCKW','yNrU','mtfZvMjsBwO','BgfPx2nOyxjFCG','A1zvBhK','C1vltfu','vvv4Dg4','z2vFBM92zwXHAq','seTZDMK','m3W0Fdf8mNWW','C3bSAxq','zxb6yuO','q3zjDKG','B25SB2fKzw5K','ywfUyw8','r0HksNK','igzYB20Gy2fJAa','x3jLzG','AgvYB3G','ihrVihvWzgf0zq','AgfYlxjLzI1PBq','v3DQvMC','zxrxCeW','i2nVBwz5DwKTAq','sKXkz2e','z2vFBMfPx2nOyq','CMvMlwLTywDLlq','u2rusxq','BxLxvKu','zM1Psem','Bw92zs1PBwfNzq','uNnZz04','BMX5','mZiXmdzbEvrruve','Cwz1qw4','Dg9Y','zwXLy3qTy2HHCG','Dg9tDhjPBMC','CwnYsei','z0LxAKG','zNruyNq','A2fVDhvWAwfU','CgDOAhy','i25VDMvSywKTCW','y3jLyxrLt2jQzq','wfnKCvu','BgfJzwHVBgrLCG','m3WXFdj8nhWW','lwj0BG','quvNshO','BMLNuvG','y29TzNL1AwnHBG','qMj2veW','ztOG','Dhu4lwLTywDLlq','AgfYifjLzIbPBq','yxqUifbSzwfZzq','rLLWuM8','Aw5NignHy2HLza','i2LTywDLsw5WDq','BK5qAKi','x25HAv9JAgfYxW','u2jJs3O','qNLjza','6k+35ywi6k6+572Uq29TzNLv','thruEwe','yMXVy2S','Bw92zs1JAgfYlq','Df9UywLFy2HHCG','BwfNzs1WCMv2Aq','5lIk5lYG5AsX6lsLoIa','y29TzNL1As1Yzq','kcGOlISPkYKRkq','Aw1Hz2u','C0H5sey','zMLUza','z0ndAeC','y3rvuKW','Dvn2CNe','zgLZCgXHEq','zwXbssbJAgfYia','tg9HzgvKienVBq','y29UC3rYDwn0BW','ie5VDMvSquKGqW','AhvnthC','tMfTzq','i25VDMvSywKTyW','DK5VvLq','swLvz3K','C3rYAw5N','ze1yzeK','ywDL','zxiGlNn0lwnOyq','tfbOu2q','q1Ldvxq','zhr5u2S','y2fJAgvFy29TzG','zs1IDg4','C3Hhs3O','uejgA0C','5zU+54Mh5Ase55cg5AsX6lsLoIa','BgfPx3zPyMvFDa','zM5NwuS','mNWZFdr8mhWX','ChjLDMLLD0LTyq','AevRzhq','BMfPm0nOyxjszq','wgfswLu','qwzLzLq','Ag94D0u','C3r5Bgu','s1z4Eha','zwXbssbPBwfNzq','Aw1Hz2uVCg5N','mJbhCgnXqM4','rvjhwgS','EwXWCei','zM50ueW','Bfzku1q','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','tNLfC3a','nKPRrgLMwq','s2nstva','AxncwLa','5zMO6l+u5zUE5PwW5O2UoIa','zxjYB3i','DxvICeG','BNPLsgq','y2HHBMDL','shjArwW','BK5sv2C','C3rVCMvszwfKtW','ssbbueNLNldLNydJGii','uwnyz1a','C3jJ','yMXVyG','l3vWBg9Hzc9PBq','zMXLEa','CL9Yzwy','uKHvDgm','6zsz6k+V6k+M5OofoG','DY1JB250ywLUzq','uKzorKS','CxvLCNLtzwXLyW','sunrCLu','CMvMigLTywDLoG','BM9Uzq','t0jwz08','vMfKBhe','CML0zq','Aw1Hz2vjBNb1Da','CIaUC3qTy2HHDa','wvbuuxm','ALr5BhK','mZaZnZqXmfzbEwTbwG','mtHrBLDvCeW','q1PPDgq','z2uY','zw1VDMuTAw1HzW','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','DgfYz2v0','De96Dva','AxnKD2q','Egj2qwG','v1PKD0i','BwvZC2fNzq','zgf0yq','ueThwMK','C3rYAw5NAwz5','vxbTz0e','DMX6ruS','BvPhs3O','zMLSzxm','zxnZAw5Nie5VDG','ExjRs1y','ihjLlxvWBg9Hza','ienVBwz5vuKGAq','uuLHt2e','z3jlr0i','Bu1ev2W','uhDkwNi','yMXVyJO','i25VDMvSywKTAq','6k+M5OofoIa','ie5VDMvSquKGvG','CMvZDwX0','5lUo57Yt5A2y5yQG6l29q29TzNK','Dgv4Da','rxDxuu4'];_0x39de=function(){return _0x4282d2;};return _0x39de();}_0x1c148f();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';function _0x561afc(_0x5244d0,_0x42fd44,_0x372d79,_0x3ee53f){return _0x9680(_0x42fd44-0x1ed,_0x3ee53f);}function _0x3399c6(_0x28b2af,_0x45bfdf,_0x576589,_0x1d2dc6){return _0x9680(_0x28b2af-0x2e9,_0x576589);}import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x561afc(0x432,0x439,0x401,0x43f)+_0x3399c6(0x4a5,0x521,0x456,0x4ec)+'ransfer_im'+_0x561afc(0x3b2,0x39f,0x339,0x397),NAI_CHAR_REF_CACHE_KEY=_0x3399c6(0x535,0x541,0x4f7,0x5a8)+_0x3399c6(0x557,0x4ce,0x576,0x4d1)+_0x3399c6(0x52c,0x4ae,0x58c,0x508),COMFYUI_REF_CACHE_KEY=_0x561afc(0x3da,0x3a4,0x33a,0x3db)+'yui_ref_im'+_0x561afc(0x3a5,0x39f,0x38a,0x3a8);let nai3VibeTransferImageMimeType=_0x3399c6(0x4b1,0x46a,0x42c,0x427),nai3CharRefImageMimeType=_0x3399c6(0x4b1,0x52e,0x4f1,0x4c5),comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x499c26){const _0x5d67e2={'afgOy':function(_0x994ff0){return _0x994ff0();},'kVUly':_0x2b778e(0x11f,0x18c,0x18f,0x11b)+_0x2b778e(0xce,0x12b,0x172,0x1af),'ZtjTb':_0x2b778e(0x20d,0x1da,0x252,0x176)+_0x2b778e(0x14b,0x169,0x1dd,0x178)+_0x33c971(0x1d3,0x1a1,0x22a,0x19a)+_0x33c971(0x15e,0x112,0x156,0x1ad)+_0x33c971(0x138,0x1a4,0xee,0x122)+_0x2b778e(0x1f9,0x237,0x29c,0x297)+'r','uRVvD':_0x33c971(0x1d5,0x250,0x177,0x1d1)+'move-image'+_0x33c971(0x132,0x1a9,0xd8,0xe5),'mZGKz':'data:image','AEgHz':function(_0x3c1a22,_0x96006e){return _0x3c1a22!==_0x96006e;},'NyEsp':'otVjV','JoHKH':_0x2b778e(0x18e,0x166,0x106,0x11c),'AUDNQ':_0x2b778e(0x188,0x1b6,0x152,0x132),'KcRMP':_0x2b778e(0x1e6,0x1e3,0x267,0x197)+'x','ylppB':function(_0x1affa4,_0x453d62){return _0x1affa4===_0x453d62;},'CYCUt':_0x33c971(0x136,0xf2,0x125,0xda),'hEkdt':_0x33c971(0x1f6,0x231,0x20f,0x1ad)},_0x299316=document[_0x33c971(0x1c7,0x17d,0x1f6,0x1a1)+'ById'](_0x5d67e2[_0x33c971(0x21a,0x239,0x1ea,0x278)]);function _0x2b778e(_0x887b6b,_0x5f4233,_0x481dc7,_0x596df8){return _0x3399c6(_0x5f4233- -0x31c,_0x5f4233-0xf0,_0x481dc7,_0x596df8-0x1a8);}const _0x338393=document[_0x33c971(0x191,0x171,0x1e0,0x17e)+_0x2b778e(0xd7,0x147,0x171,0x112)](_0x5d67e2[_0x33c971(0x1fa,0x25d,0x27b,0x226)]),_0x2810c3=document[_0x33c971(0x1c7,0x207,0x22c,0x192)+'ById'](_0x5d67e2[_0x2b778e(0x198,0x222,0x1f3,0x265)]);function _0x33c971(_0x2399a3,_0x3ef8b3,_0x8a894b,_0x3a073d){return _0x561afc(_0x2399a3-0xf,_0x2399a3- -0x242,_0x8a894b-0x141,_0x3ef8b3);}if(_0x499c26&&_0x499c26[_0x2b778e(0x29d,0x21f,0x1c5,0x26a)](_0x5d67e2[_0x2b778e(0x22e,0x1cf,0x1f4,0x228)])){if(_0x5d67e2[_0x33c971(0x133,0x101,0x116,0xc9)](_0x5d67e2[_0x2b778e(0x219,0x19c,0x1de,0x1bd)],_0x5d67e2[_0x2b778e(0x118,0x19c,0x13a,0x15c)])){const _0xfd2d09=_0x4de614[_0x33c971(0x1bb,0x243,0x225,0x233)],_0x56d031={};_0x56d031['data']=_0xfd2d09,_0x56d031['serverFile'+_0x2b778e(0x139,0x179,0xf3,0x153)]=_0xca187c[_0x2b778e(0x201,0x227,0x22c,0x283)];const _0x156568=_0x56d031,_0x44f726={};_0x44f726['id']=_0x532110,_0x44f726[_0x2b778e(0x21c,0x1ca,0x1c3,0x1e4)]=_0x156568,_0x5d7552[_0x33c971(0x1c2,0x14c,0x23c,0x236)+_0x33c971(0x197,0x200,0x18e,0x1ff)](_0x44f726);}else{_0x299316[_0x33c971(0x188,0x10f,0x1df,0x1be)]=_0x499c26,_0x299316['style'][_0x2b778e(0x123,0x173,0x1a2,0x180)]=_0x5d67e2['JoHKH'],_0x338393[_0x33c971(0x170,0x175,0x102,0x167)][_0x2b778e(0x1e1,0x173,0x177,0x143)]=_0x5d67e2[_0x2b778e(0x287,0x207,0x233,0x21c)],_0x2810c3['style'][_0x2b778e(0x18c,0x173,0x10e,0x1b0)]=_0x5d67e2[_0x33c971(0x17c,0x1e5,0x1c9,0x14d)];const _0x46e659=_0x499c26['split'](','),_0x29a0af=_0x46e659[-0x977*-0x1+-0xdd*-0x12+0xad*-0x25]['split'](':')[0x2210+0x5*0x195+0x44*-0x9e][_0x2b778e(0x149,0x12e,0xc1,0xdb)](';')[-0x245*0x7+-0x1791*-0x1+-0x7ae];nai3VibeTransferImageMimeType=_0x29a0af,window[_0x2b778e(0x1bf,0x22d,0x29d,0x2a8)+_0x2b778e(0x223,0x229,0x29c,0x1b8)+'e']=_0x46e659[-0x1413+-0x1*0x1eeb+0x5*0xa33];const _0x249241={};_0x249241['id']=NAI_VIBE_CACHE_KEY,_0x249241['data']=_0x499c26,dbs[_0x2b778e(0x1ed,0x1e4,0x25f,0x177)+_0x33c971(0x197,0x15f,0x120,0x213)](_0x249241);}}else{if(_0x5d67e2[_0x2b778e(0x117,0x198,0x129,0x118)](_0x5d67e2[_0x33c971(0x160,0x189,0x19e,0x1c3)],_0x5d67e2[_0x2b778e(0x104,0x182,0x1c1,0x120)])){const _0x590091=_0x5d67e2[_0x33c971(0x16b,0x161,0x1da,0x11c)][_0x33c971(0x10c,0xd2,0x94,0x12f)]('|');let _0x2e5d1e=0x205a+0x47*0x28+0x1*-0x2b72;while(!![]){switch(_0x590091[_0x2e5d1e++]){case'0':window[_0x2b778e(0x1a3,0x22d,0x279,0x1bf)+_0x33c971(0x207,0x21e,0x1b4,0x1a1)+'e']=null;continue;case'1':_0x338393[_0x2b778e(0x166,0x192,0x11c,0x159)][_0x33c971(0x151,0x18c,0x186,0x15b)]=_0x2b778e(0x184,0x1ad,0x1b1,0x1f3);continue;case'2':_0x299316['style'][_0x33c971(0x151,0x1b6,0xca,0x12b)]=_0x5d67e2[_0x33c971(0x1e5,0x24b,0x26e,0x1fd)];continue;case'3':_0x299316['src']='';continue;case'4':_0x2810c3[_0x33c971(0x170,0x19b,0x147,0x153)][_0x33c971(0x151,0x19b,0xf7,0x174)]=_0x5d67e2[_0x2b778e(0x244,0x207,0x1c6,0x200)];continue;}break;}}else _0x5d67e2[_0x2b778e(0x2bb,0x231,0x289,0x1e7)](_0x11f051);}}function removeNovelaiImage(){function _0x4dca68(_0x1596ae,_0x4def9d,_0x1bac0a,_0x5c761a){return _0x3399c6(_0x1bac0a- -0x481,_0x4def9d-0x4b,_0x5c761a,_0x5c761a-0x1a3);}const _0x2d734e={'XaRZU':function(_0x5ac3a9,_0x3f621e){return _0x5ac3a9(_0x3f621e);}};_0x2d734e[_0x4dca68(-0x6,0x1a,0x2a,-0x39)](updateNovelaiImagePreview,null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x3fa18c){const _0x1bc2cf={'CZitd':'none','pnQqW':_0x418fb4(-0xcb,-0x6c,-0xa9,-0x7b)+'x','dmpBq':function(_0x432f23,_0x25c8b5,_0x19ee14){return _0x432f23(_0x25c8b5,_0x19ee14);},'Akcms':function(_0x4d3b18,_0x3a9354){return _0x4d3b18(_0x3a9354);},'HnGUU':function(_0x3be0b4,_0x3c5906){return _0x3be0b4===_0x3c5906;},'XirVn':_0x418fb4(-0x167,-0x115,-0x95,-0x186),'cIUxZ':_0x31aa2e(-0x155,-0x102,-0x131,-0x12f)+_0x418fb4(-0x24,-0x7e,-0xf0,-0x90)+_0x31aa2e(-0x1bb,-0x142,-0x242,-0x229)+':','tNkwr':function(_0x449f81,_0x7df9c8){return _0x449f81(_0x7df9c8);},'tmULm':'图片处理失败:\x20'};function _0x418fb4(_0x35a7d9,_0x336704,_0x994b49,_0x135d59){return _0x561afc(_0x35a7d9-0xf7,_0x336704- -0x46f,_0x994b49-0x150,_0x135d59);}const _0x277d8c=_0x3fa18c[_0x418fb4(-0x62,-0x8b,-0x9a,-0xbe)][_0x418fb4(-0xdf,-0x7f,-0xe5,-0x56)][0x3*-0xa13+-0x2c*0x79+-0x3305*-0x1];if(!_0x277d8c)return;function _0x31aa2e(_0x1494e3,_0x512c12,_0x2b7b08,_0x5ddf77){return _0x561afc(_0x1494e3-0xcc,_0x1494e3- -0x56f,_0x2b7b08-0x89,_0x512c12);}try{const _0x522e77=await _0x1bc2cf['dmpBq'](processUploadedImage,_0x277d8c,!![]);_0x1bc2cf['Akcms'](updateNovelaiImagePreview,_0x522e77);}catch(_0x23b177){_0x1bc2cf['HnGUU'](_0x1bc2cf[_0x418fb4(-0x3f,-0x20,0x41,-0x18)],_0x1bc2cf['XirVn'])?(console[_0x418fb4(-0x113,-0xae,-0x32,-0x89)](_0x1bc2cf['cIUxZ'],_0x23b177),_0x1bc2cf['tNkwr'](alert,_0x1bc2cf[_0x31aa2e(-0x161,-0x168,-0x183,-0x1a9)]+_0x23b177[_0x418fb4(-0x74,-0x86,-0xb2,-0x3a)])):(_0x475bd3[_0x418fb4(-0x100,-0xa5,-0x11c,-0x11b)]=_0x3bd8eb,_0x19d981[_0x418fb4(-0xfa,-0xbd,-0xa7,-0xae)]['display']=_0x31aa2e(-0x1e9,-0x20c,-0x22e,-0x218),_0x1c2a7d['style'][_0x31aa2e(-0x1dc,-0x1fe,-0x20c,-0x159)]=_0x1bc2cf[_0x418fb4(-0x119,-0x8f,-0x78,-0xdb)],_0x4883d3[_0x31aa2e(-0x1bd,-0x143,-0x21b,-0x182)][_0x418fb4(-0x11b,-0xdc,-0x115,-0xe8)]=_0x1bc2cf['pnQqW']);}}function updateNovelaiCharRefImagePreview(_0x306c8b){function _0x4b032d(_0x1aae3b,_0xf96950,_0x26ce19,_0x22d289){return _0x3399c6(_0x26ce19- -0x149,_0xf96950-0x90,_0x22d289,_0x22d289-0x33);}const _0x50cc7a={'YZbvQ':function(_0xd01066){return _0xd01066();},'EYfrf':_0x22d29f(0x501,0x47f,0x441,0x4c5),'QIaOa':_0x22d29f(0x48e,0x533,0x48c,0x4eb)+'ge_nai_cha'+_0x22d29f(0x513,0x4ce,0x56c,0x50d),'EopSK':_0x22d29f(0x470,0x4df,0x4b4,0x4d9)+_0x4b032d(0x2cf,0x318,0x30b,0x32a)+_0x4b032d(0x369,0x3dc,0x3b5,0x384)+_0x4b032d(0x376,0x307,0x384,0x3cf)+'r\x20.st-chat'+_0x22d29f(0x4f8,0x4c2,0x4f0,0x545)+_0x4b032d(0x325,0x387,0x325,0x313),'IiUgy':'data:image','dMXdI':_0x22d29f(0x544,0x4b2,0x52a,0x515),'VwRvi':_0x22d29f(0x53c,0x54c,0x54d,0x542)+'x','NoItn':function(_0x48ba1d,_0x52c849){return _0x48ba1d===_0x52c849;},'NKxZI':'Apbed','goDDH':_0x4b032d(0x2f1,0x395,0x35e,0x33f),'biTlk':_0x22d29f(0x49b,0x523,0x58d,0x50c)},_0x57bfa9=document[_0x22d29f(0x58e,0x59b,0x538,0x548)+_0x4b032d(0x321,0x2f0,0x336,0x2d4)](_0x50cc7a[_0x4b032d(0x408,0x3ac,0x3a8,0x3c5)]),_0x383025=document[_0x4b032d(0x3d8,0x3d8,0x386,0x3f6)+_0x22d29f(0x49b,0x507,0x434,0x4a6)](_0x50cc7a[_0x4b032d(0x3a5,0x389,0x3c7,0x36f)]);function _0x22d29f(_0x47589,_0x106733,_0x3cf9cc,_0x43a6cb){return _0x3399c6(_0x43a6cb-0x43,_0x106733-0xd3,_0x3cf9cc,_0x43a6cb-0x11e);}const _0xac3a62=document[_0x4b032d(0x3bf,0x381,0x3bc,0x380)+_0x4b032d(0x332,0x2c3,0x336,0x359)](_0x22d29f(0x573,0x4d7,0x4d9,0x556)+_0x4b032d(0x2bd,0x2e1,0x33a,0x2cd)+_0x22d29f(0x41f,0x499,0x4f5,0x49d)+_0x4b032d(0x417,0x40a,0x40c,0x48e));if(_0x306c8b&&_0x306c8b['startsWith'](_0x50cc7a[_0x4b032d(0x3c1,0x30f,0x34f,0x2f7)])){if(_0x4b032d(0x3e5,0x34e,0x35d,0x3aa)!==_0x4b032d(0x3db,0x2fc,0x356,0x384)){_0x57bfa9[_0x22d29f(0x52b,0x563,0x4c4,0x509)]=_0x306c8b,_0x57bfa9[_0x4b032d(0x360,0x352,0x365,0x346)][_0x4b032d(0x343,0x3c6,0x346,0x350)]=_0x50cc7a[_0x4b032d(0x3d5,0x425,0x403,0x41d)],_0x383025['style'][_0x22d29f(0x514,0x550,0x503,0x4d2)]=_0x50cc7a[_0x22d29f(0x45b,0x540,0x50c,0x4dd)],_0xac3a62['style'][_0x4b032d(0x31b,0x37d,0x346,0x319)]=_0x50cc7a['VwRvi'];const _0x17efd7=_0x306c8b[_0x4b032d(0x303,0x27e,0x301,0x33b)](','),_0x2d5253=_0x17efd7[0xf*0xc1+-0x7*-0x11f+0x2*-0x994]['split'](':')[0x860+-0x19c1+-0x59*-0x32][_0x4b032d(0x2c2,0x2f9,0x301,0x27c)](';')[-0x26ee+0x538*-0x2+0x2*0x18af];nai3CharRefImageMimeType=_0x2d5253,window['nai3CharRe'+_0x22d29f(0x5d7,0x5da,0x4e9,0x572)]=_0x17efd7[-0x1261+-0x101*-0xb+0x1*0x757];const _0x5702a9={};_0x5702a9['id']=NAI_CHAR_REF_CACHE_KEY,_0x5702a9[_0x22d29f(0x4cd,0x557,0x4c6,0x529)]=_0x306c8b,dbs['storeReadW'+_0x4b032d(0x316,0x388,0x38c,0x36f)](_0x5702a9);}else _0x50cc7a['YZbvQ'](_0x231b1b);}else{if(_0x50cc7a[_0x4b032d(0x3d9,0x43b,0x407,0x446)](_0x50cc7a['NKxZI'],_0x4b032d(0x34b,0x3a0,0x366,0x3ba))){_0x4fb453[_0x22d29f(0x50a,0x547,0x494,0x509)]=_0x10e1d8,_0xac7dea[_0x4b032d(0x3ad,0x398,0x365,0x305)]['display']=_0x50cc7a[_0x22d29f(0x55c,0x60c,0x5cf,0x58f)],_0x18e505[_0x4b032d(0x36e,0x380,0x365,0x369)][_0x4b032d(0x3ba,0x370,0x346,0x33c)]=_0x22d29f(0x51d,0x4d5,0x56b,0x515),_0x40e3f1[_0x4b032d(0x3df,0x3d0,0x365,0x3c2)][_0x4b032d(0x382,0x3ad,0x346,0x342)]=_0x4b032d(0x358,0x385,0x3b6,0x40b)+'x';const _0x7da49b=_0x14961c['split'](','),_0x2341d8=_0x7da49b[0x3*0x17+-0x12bb+0x1276][_0x22d29f(0x48f,0x459,0x42e,0x48d)](':')[-0x1*-0x2477+-0x2493+0x1d][_0x22d29f(0x4ae,0x502,0x43c,0x48d)](';')[0xb*0x14f+0x6*-0x632+0x16c7];_0x3384eb=_0x2341d8,_0x32ebe8[_0x22d29f(0x4ec,0x51d,0x4fd,0x4ed)+_0x22d29f(0x58a,0x4f9,0x549,0x572)]=_0x7da49b[0xc*-0x1a+0x1926+0x23*-0xaf];const _0x5d53de={};_0x5d53de['id']=_0xa75471,_0x5d53de[_0x4b032d(0x342,0x378,0x39d,0x31b)]=_0x17cb5e,_0x4641a7['storeReadW'+'rite'](_0x5d53de);}else{const _0x55b880=_0x50cc7a['goDDH']['split']('|');let _0x735fa8=-0xa15*-0x1+-0x156f+0xb5a;while(!![]){switch(_0x55b880[_0x735fa8++]){case'0':_0xac3a62[_0x4b032d(0x396,0x39b,0x365,0x379)]['display']=_0x22d29f(0x4d9,0x4e1,0x554,0x515);continue;case'1':window[_0x22d29f(0x4bb,0x4ed,0x547,0x4ed)+_0x22d29f(0x4f9,0x532,0x504,0x572)]=null;continue;case'2':_0x57bfa9[_0x22d29f(0x4e5,0x4da,0x4fd,0x509)]='';continue;case'3':_0x57bfa9['style']['display']=_0x50cc7a[_0x4b032d(0x318,0x38a,0x351,0x3b1)];continue;case'4':_0x383025[_0x4b032d(0x31d,0x3d1,0x365,0x3be)]['display']=_0x50cc7a[_0x22d29f(0x586,0x580,0x52c,0x57f)];continue;}break;}}}}function removeNovelaiCharRefImage(){function _0x167b33(_0xe8cb63,_0xd84fdc,_0x4aff21,_0xe70ad2){return _0x561afc(_0xe8cb63-0x1b2,_0xe8cb63- -0x55a,_0x4aff21-0x56,_0xe70ad2);}updateNovelaiCharRefImagePreview(null),dbs[_0x167b33(-0x14d,-0x1ab,-0x126,-0x137)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x250ed9){const _0x48c70b={'YVIeW':function(_0x2e1340,_0x34aceb){return _0x2e1340(_0x34aceb);},'lZiQn':'Error\x20proc'+_0xfbeb88(0x152,0x1dc,0x1ac,0x160)+_0x55f22f(0x9a,0x44,0x3b,0x5f)+_0xfbeb88(0x1d0,0x10f,0x190,0x139),'jTyly':function(_0x14c8b8,_0x27bfcb){return _0x14c8b8+_0x27bfcb;}},_0x446699=_0x250ed9[_0x55f22f(0x35,0x9d,0x113,0xaf)][_0x55f22f(0xc2,0x84,0x8b,0xbb)][-0xff6+-0x51d+0x1513];function _0x55f22f(_0x155c05,_0x33dfdd,_0xea0eca,_0x1f8c09){return _0x561afc(_0x155c05-0x1ea,_0x1f8c09- -0x335,_0xea0eca-0x123,_0xea0eca);}function _0xfbeb88(_0x2a51c3,_0x13d290,_0xf98a6d,_0x100c6f){return _0x561afc(_0x2a51c3-0x18b,_0xf98a6d- -0x245,_0xf98a6d-0x151,_0x100c6f);}if(!_0x446699)return;try{const _0x247149=await _0x48c70b[_0x55f22f(0xf7,0x5b,0x98,0xe1)](processUploadedImage,_0x446699);updateNovelaiCharRefImagePreview(_0x247149);}catch(_0x468fea){console[_0x55f22f(0x38,0xc3,0x63,0x8c)](_0x48c70b[_0x55f22f(0x198,0x122,0x18f,0x116)],_0x468fea),_0x48c70b[_0x55f22f(0xdf,0xfe,0x11d,0xe1)](alert,_0x48c70b[_0x55f22f(0xb9,0xe4,0x11f,0xa8)](_0xfbeb88(0x12d,0x18d,0x163,0x156),_0x468fea[_0x55f22f(0xf1,0x42,0x80,0xb4)]));}}function updateComfyUIImagePreview(_0x38915b){const _0x2530b3={'SbcKz':function(_0x139040,_0x2abe17){return _0x139040(_0x2abe17);},'uSvrq':_0x22a742(0x119,0x79,0x11b,0xda),'epzaJ':'#comfyui-i'+'mage-previ'+_0x22a742(0xeb,0x1b5,0x103,0x147)+_0x22a742(0xf9,0x13b,0xbc,0xd2)+_0x20acb8(0x2a1,0x255,0x2c3,0x28e)+_0x20acb8(0x3b8,0x357,0x32b,0x36b)+'r','isBZP':_0x20acb8(0x2b7,0x2be,0x2e6,0x29f)+_0x20acb8(0x2b0,0x296,0x20b,0x276)+'-btn','iFFVh':_0x22a742(0x117,0xb0,0x189,0x12b),'UUxtn':function(_0x55932e,_0x42c297){return _0x55932e!==_0x42c297;},'FQFOT':_0x20acb8(0x334,0x2a8,0x2fd,0x2ea),'nigQX':_0x22a742(0x152,0x1a0,0x1a9,0x135)+'x','RssgN':_0x22a742(0x130,0x11a,0x17d,0x10a),'pwTTr':'qGIeW','JLJga':_0x20acb8(0x2d2,0x293,0x2ba,0x2e1)},_0x5e6f7f=document[_0x20acb8(0x2c7,0x30c,0x371,0x31d)+_0x20acb8(0x25f,0x262,0x238,0x297)](_0x22a742(0x5b,0xe2,0x15d,0xde)+_0x20acb8(0x2d8,0x2e4,0x2ab,0x2f5));function _0x22a742(_0xab8249,_0x29572c,_0x33faa3,_0x402396){return _0x561afc(_0xab8249-0x1e3,_0x402396- -0x2ce,_0x33faa3-0x8c,_0xab8249);}const _0x4a7cf2=document[_0x22a742(0x177,0x167,0x102,0x105)+'tor'](_0x2530b3[_0x22a742(0x12,0x6b,0x4f,0x81)]),_0x192c0c=document[_0x22a742(0xe9,0xe1,0x124,0x13b)+_0x22a742(0x132,0x9a,0xb0,0xb5)](_0x2530b3[_0x22a742(0x12a,0xc0,0xd4,0xf1)]);function _0x20acb8(_0x53589d,_0x50c7bf,_0x351009,_0x326300){return _0x3399c6(_0x326300- -0x1e8,_0x50c7bf-0xfc,_0x50c7bf,_0x326300-0x170);}_0x5e6f7f[_0x22a742(0x7f,0x156,0x176,0xfc)]&&_0x5e6f7f['src'][_0x20acb8(0x2e2,0x36f,0x371,0x353)](_0x2530b3['iFFVh'])&&_0x2530b3[_0x22a742(0xf5,0xab,0x39,0x7c)](_0x5e6f7f[_0x22a742(0x13d,0xa2,0x162,0xfc)],_0x38915b)&&URL['revokeObje'+'ctURL'](_0x5e6f7f[_0x22a742(0x79,0x116,0x11e,0xfc)]),_0x38915b?(_0x5e6f7f[_0x22a742(0x112,0x103,0xb7,0xfc)]=_0x38915b,_0x5e6f7f[_0x20acb8(0x342,0x30d,0x2e5,0x2c6)][_0x20acb8(0x2ef,0x246,0x263,0x2a7)]=_0x20acb8(0x283,0x257,0x2ae,0x29a),_0x4a7cf2[_0x20acb8(0x2a3,0x312,0x272,0x2c6)][_0x20acb8(0x231,0x251,0x239,0x2a7)]=_0x2530b3[_0x22a742(0xe9,0x151,0x119,0x156)],_0x192c0c[_0x20acb8(0x30a,0x273,0x317,0x2c6)]['display']=_0x2530b3[_0x20acb8(0x235,0x281,0x2c1,0x28a)]):_0x2530b3[_0x20acb8(0x261,0x2c0,0x295,0x277)]!==_0x2530b3[_0x22a742(0x1c2,0x18a,0x1d7,0x175)]?(_0x5e6f7f[_0x22a742(0x178,0x7a,0xa2,0xfc)]='',_0x5e6f7f[_0x20acb8(0x2d1,0x266,0x2f9,0x2c6)][_0x22a742(0x7c,0x11f,0x54,0xc5)]=_0x2530b3['FQFOT'],_0x4a7cf2['style'][_0x22a742(0xe3,0x3d,0x142,0xc5)]=_0x2530b3[_0x20acb8(0x1ea,0x2e0,0x26d,0x270)],_0x192c0c[_0x20acb8(0x256,0x2ca,0x2d6,0x2c6)]['display']=_0x2530b3['FQFOT'],window['comfyuican'+_0x22a742(0x70,0x9d,0x97,0x9f)]=null,comfyuiImageObjectURL=null):(_0x53e440[_0x22a742(0x128,0xb6,0x124,0xf3)]('Error\x20proc'+_0x20acb8(0x2f7,0x2c2,0x327,0x305)+_0x22a742(0xd6,0xb1,0xd7,0xc6)+_0x20acb8(0x2f8,0x325,0x2db,0x2e9),_0x20f6db),_0x2530b3[_0x20acb8(0x276,0x260,0x25d,0x296)](_0x227d5f,_0x2530b3[_0x22a742(0x8e,0xe7,0x115,0xc4)]+_0x399138['message']));}function removeComfyUIImage(){const _0x323a2f={'fntPL':function(_0x1cee85,_0x4fae04){return _0x1cee85(_0x4fae04);}};_0x323a2f[_0x5e8eb9(0x311,0x2cf,0x302,0x25f)](updateComfyUIImagePreview,null);function _0x5e8eb9(_0x1b8139,_0xb4b596,_0x581f0b,_0x469586){return _0x561afc(_0x1b8139-0x122,_0xb4b596- -0xea,_0x581f0b-0x1bb,_0x1b8139);}dbs['storeDelet'+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x4fcc9f){const _0x5e271f={'evDaX':_0x3e1709(0x30f,0x29d,0x2c4,0x301)+_0x3e1709(0x313,0x381,0x2c4,0x336),'oDari':function(_0x4e772c,_0x5715aa){return _0x4e772c!==_0x5715aa;},'sHyHF':_0x230f93(0x42e,0x4cc,0x491,0x4c0),'rlJsA':_0x230f93(0x561,0x4a4,0x4e1,0x52e),'ftTbt':'1|4|5|2|3|'+'0','xbvAh':function(_0x2dc3bd,_0xcbb96){return _0x2dc3bd(_0xcbb96);},'rPvfb':function(_0xc9e41c,_0x1751d8){return _0xc9e41c+_0x1751d8;},'pghhv':_0x3e1709(0x3a1,0x3d2,0x3d7,0x38f)+':\x20','CvIvH':_0x230f93(0x52d,0x533,0x545,0x5ae)+':','pitCf':function(_0x1acddf){return _0x1acddf();},'grKGB':_0x3e1709(0x34c,0x42f,0x380,0x3b2),'gIWjH':function(_0x54c8ad,_0x278bba){return _0x54c8ad(_0x278bba);},'DQALA':function(_0x18c6dd,_0x289945){return _0x18c6dd!==_0x289945;},'PwJZr':_0x3e1709(0x301,0x2e0,0x265,0x2da),'UpmgA':function(_0x3b9260,_0x305cfc,_0x34f7c9){return _0x3b9260(_0x305cfc,_0x34f7c9);},'QcXgP':_0x230f93(0x531,0x512,0x533,0x54e),'nNRWg':function(_0x206e80,_0x18525d){return _0x206e80===_0x18525d;},'zvIKa':_0x230f93(0x54a,0x5a6,0x561,0x5eb),'okMlU':_0x3e1709(0x334,0x398,0x355,0x338)+'回数据:','jNRJl':function(_0xee66a5,_0x2953ea){return _0xee66a5(_0x2953ea);},'yMGke':_0x3e1709(0x365,0x39d,0x366,0x325),'RHUtc':function(_0x4f991a){return _0x4f991a();},'tRWrD':function(_0x5974a7,_0x34f52b){return _0x5974a7(_0x34f52b);}},_0x1d29d9=extension_settings[extensionName],_0x90932e=_0x4fcc9f[_0x230f93(0x49d,0x4b5,0x4ef,0x511)]['files'][-0x18c0+0xc*-0x257+0x78c*0x7];if(!_0x90932e)return;function _0x3e1709(_0x577d0d,_0x16d2e6,_0x62552e,_0x3c0cad){return _0x3399c6(_0x3c0cad- -0x1a7,_0x16d2e6-0x135,_0x62552e,_0x3c0cad-0x4e);}function _0x230f93(_0x5b4b49,_0x53f562,_0x2876ed,_0xfffbe8){return _0x561afc(_0x5b4b49-0xa6,_0x2876ed-0x10b,_0x2876ed-0x1d1,_0x53f562);}try{if(_0x5e271f[_0x230f93(0x548,0x58a,0x501,0x55e)]===_0x5e271f[_0x3e1709(0x335,0x370,0x2d5,0x34b)]){const _0x59acfc=await _0x5e271f[_0x230f93(0x4c8,0x4b3,0x4f2,0x52e)](processUploadedImageToBlob,_0x90932e),_0x113c56=URL[_0x3e1709(0x29e,0x2a5,0x2e9,0x2c5)+_0x230f93(0x4de,0x47c,0x49c,0x479)](_0x59acfc);comfyuiImageObjectURL=_0x113c56,_0x5e271f[_0x230f93(0x453,0x435,0x476,0x409)](updateComfyUIImagePreview,_0x113c56);const _0x257e5e=new FormData();_0x257e5e[_0x230f93(0x5ab,0x5b8,0x553,0x4f7)](_0x3e1709(0x2e1,0x366,0x2e1,0x2e2),_0x59acfc,_0x90932e[_0x230f93(0x4f9,0x555,0x552,0x5c0)]);let _0x3d12e9=_0x1d29d9['comfyuiUrl']['trim']();if(!_0x3d12e9){if(_0x5e271f[_0x230f93(0x503,0x54e,0x53c,0x516)](_0x5e271f[_0x3e1709(0x332,0x3ab,0x370,0x34d)],_0x5e271f[_0x230f93(0x556,0x585,0x503,0x4ef)]))_0x508ffb['revokeObje'+_0x230f93(0x4f5,0x44e,0x49c,0x4f3)](_0x1785f5[_0x230f93(0x46a,0x453,0x4d5,0x4dd)]);else{alert(_0x3e1709(0x333,0x338,0x325,0x2d9)+_0x3e1709(0x31e,0x2ea,0x380,0x31d)),removeComfyUIImage();return;}}const _0x54af8b=await _0x5e271f[_0x230f93(0x554,0x553,0x4f8,0x4cd)](fetch,_0x3d12e9+(_0x230f93(0x538,0x482,0x4d7,0x4f9)+_0x230f93(0x43b,0x423,0x4aa,0x4e8)),{'method':_0x5e271f[_0x230f93(0x4d4,0x453,0x4d4,0x4b4)],'body':_0x257e5e});if(_0x54af8b['ok']){if(_0x5e271f[_0x3e1709(0x360,0x371,0x2df,0x31b)](_0x5e271f[_0x3e1709(0x3d1,0x348,0x3e1,0x389)],_0x3e1709(0x2f1,0x2a4,0x33e,0x31a))){const _0x350577=_0x55d65e[_0x230f93(0x4f4,0x49e,0x514,0x4c2)+'ById'](_0x5e271f[_0x230f93(0x49f,0x58e,0x523,0x514)]),_0x2bc0e2=_0x5908e6[_0x230f93(0x552,0x4cb,0x4de,0x554)+'tor'](_0x3e1709(0x238,0x231,0x236,0x2b0)+_0x3e1709(0x25f,0x316,0x2b0,0x2de)+'ew-contain'+_0x230f93(0x497,0x458,0x4ab,0x436)+'tu8-image-'+_0x3e1709(0x3e7,0x331,0x345,0x3ac)+'r'),_0x290496=_0xdc9a67[_0x230f93(0x4bb,0x4c0,0x514,0x59c)+'ById'](_0x230f93(0x4c4,0x4a4,0x496,0x51c)+'move-image'+'-btn');_0x350577[_0x230f93(0x545,0x531,0x4d5,0x54b)]&&_0x350577[_0x230f93(0x473,0x4ba,0x4d5,0x520)][_0x3e1709(0x385,0x3c0,0x409,0x394)](_0x3e1709(0x37c,0x37f,0x328,0x34e))&&_0x5e271f['oDari'](_0x350577[_0x230f93(0x4b5,0x4be,0x4d5,0x537)],_0x2b4398)&&_0x3e19f5['revokeObje'+_0x230f93(0x480,0x444,0x49c,0x4c5)](_0x350577[_0x230f93(0x542,0x489,0x4d5,0x451)]);if(_0x5e304a)_0x350577[_0x3e1709(0x377,0x370,0x29c,0x31f)]=_0x105b69,_0x350577[_0x3e1709(0x32d,0x280,0x331,0x307)][_0x3e1709(0x2ef,0x2c5,0x28f,0x2e8)]=_0x5e271f[_0x230f93(0x414,0x4f0,0x499,0x46c)],_0x2bc0e2[_0x230f93(0x4b3,0x49a,0x4bd,0x4b8)][_0x3e1709(0x2c9,0x27e,0x2d2,0x2e8)]=_0x5e271f['rlJsA'],_0x290496[_0x230f93(0x488,0x494,0x4bd,0x49b)][_0x230f93(0x47a,0x4cf,0x49e,0x4d0)]='inline-fle'+'x';else{const _0xd04274=_0x5e271f[_0x3e1709(0x2b8,0x267,0x2d9,0x2c1)][_0x230f93(0x45d,0x452,0x459,0x450)]('|');let _0x16ce57=-0x9ff+0xf3*0x5+-0x38*-0x18;while(!![]){switch(_0xd04274[_0x16ce57++]){case'0':_0x137e55=null;continue;case'1':_0x350577[_0x230f93(0x54e,0x453,0x4d5,0x4d0)]='';continue;case'2':_0x290496[_0x3e1709(0x368,0x2f8,0x2d0,0x307)][_0x230f93(0x453,0x4f8,0x49e,0x4eb)]=_0x5e271f[_0x3e1709(0x38c,0x330,0x3a0,0x39f)];continue;case'3':_0x2c6049[_0x230f93(0x47a,0x4b7,0x482,0x48a)+_0x3e1709(0x2ab,0x32f,0x321,0x2c2)]=null;continue;case'4':_0x350577[_0x230f93(0x547,0x529,0x4bd,0x53a)][_0x230f93(0x4c1,0x4b0,0x49e,0x4b3)]=_0x5e271f[_0x230f93(0x4ce,0x5d2,0x555,0x504)];continue;case'5':_0x2bc0e2[_0x230f93(0x47c,0x477,0x4bd,0x47f)][_0x3e1709(0x2a3,0x2c5,0x322,0x2e8)]=_0x3e1709(0x33d,0x2fc,0x2b6,0x322);continue;}break;}}}else{const _0x2fb3ed=await _0x54af8b[_0x3e1709(0x3b6,0x31c,0x3e8,0x382)]();window['comfyuican'+_0x230f93(0x43a,0x448,0x478,0x481)]=_0x2fb3ed[_0x230f93(0x54c,0x5b1,0x552,0x505)],addLog(_0x3e1709(0x2ac,0x386,0x317,0x310)+_0x230f93(0x4af,0x4d1,0x4cb,0x524)+JSON['stringify'](_0x2fb3ed)),console['log'](_0x5e271f['okMlU'],_0x2fb3ed);const _0x38ee9c=new FileReader();_0x38ee9c[_0x3e1709(0x284,0x231,0x244,0x2a6)]=()=>{const _0x530280=_0x38ee9c[_0x3faa5a(-0x75,-0xff,0x6,-0xa)],_0x3a33a8={};_0x3a33a8[_0x3faa5a(-0x88,-0x44,-0xb,-0xd4)]=_0x530280,_0x3a33a8[_0x12a6cc(-0xad,0x0,-0x58,0x1)+_0x3faa5a(-0xd9,-0xb5,-0x70,-0x7b)]=_0x2fb3ed[_0x3faa5a(-0x2b,-0x6f,-0x44,-0x5)];const _0x98a25=_0x3a33a8,_0x3170e8={};_0x3170e8['id']=COMFYUI_REF_CACHE_KEY;function _0x12a6cc(_0x1186a4,_0x186412,_0x13ca8e,_0x22d248){return _0x230f93(_0x1186a4-0xd1,_0x186412,_0x13ca8e- -0x5b1,_0x22d248-0xae);}_0x3170e8['data']=_0x98a25;function _0x3faa5a(_0xb730eb,_0x462bea,_0x2aabfb,_0x4862e1){return _0x3e1709(_0xb730eb-0x119,_0x462bea-0x5,_0x2aabfb,_0xb730eb- -0x3c7);}dbs[_0x3faa5a(-0x6e,-0x58,-0x74,-0xd6)+_0x12a6cc(-0x12a,-0xab,-0xcd,-0x153)](_0x3170e8);},_0x38ee9c[_0x230f93(0x5c5,0x592,0x540,0x4bf)+_0x230f93(0x5a7,0x57e,0x551,0x539)](_0x59acfc);}}else{const _0x4a7a8b=await _0x54af8b[_0x230f93(0x4ab,0x4ff,0x50a,0x484)]();_0x5e271f['jNRJl'](alert,_0x230f93(0x426,0x430,0x495,0x4b2)+_0x4a7a8b),addLog(_0x3e1709(0x40f,0x397,0x34d,0x392)+'详情:\x20'+_0x4a7a8b),console['error'](_0x5e271f['yMGke'],_0x4a7a8b),_0x5e271f[_0x230f93(0x480,0x4aa,0x4da,0x4a2)](removeComfyUIImage);}}else _0x5e271f[_0x3e1709(0x317,0x3ad,0x3b9,0x33c)](_0x30ca1c,_0x5e271f[_0x230f93(0x537,0x588,0x51b,0x50b)](_0x5e271f[_0x3e1709(0x30b,0x2c2,0x2e4,0x2c3)],_0x3d0d83[_0x3e1709(0x392,0x3b7,0x2be,0x33e)])),_0x3c108e[_0x230f93(0x52f,0x532,0x4cc,0x542)](_0x5e271f[_0x3e1709(0x271,0x25b,0x2ce,0x2a5)],_0x144b3f),_0x40f2c0(_0x230f93(0x5a6,0x5b8,0x548,0x5c9)+_0x3e1709(0x383,0x326,0x38f,0x350)+_0x13da3c['stringify'](_0x4d8301)),_0x5e271f['pitCf'](_0x1a2383);}catch(_0x5d4c76){alert(_0x5e271f['rPvfb'](_0x3e1709(0x320,0x392,0x3e8,0x38f)+':\x20',_0x5d4c76['message'])),console['error'](_0x230f93(0x50d,0x595,0x545,0x52e)+':',_0x5d4c76),_0x5e271f['tRWrD'](addLog,_0x3e1709(0x3bb,0x37e,0x320,0x392)+'详情:\x20'+JSON[_0x3e1709(0x378,0x39c,0x342,0x341)](_0x5d4c76)),_0x5e271f['pitCf'](removeComfyUIImage);}}async function loadCachedImages(){const _0x218f48={'iPquf':'Error\x20load'+_0x1feebc(-0x1ff,-0x240,-0x1b5,-0x201)+_0x1feebc(-0x189,-0x202,-0x20b,-0x154)+'mage:','AfefT':'previewIma'+_0x4a6678(0x333,0x297,0x2cb,0x256),'FYpRo':_0x1feebc(-0x183,-0x1d8,-0x1f0,-0x184)+_0x1feebc(-0x1f4,-0x181,-0x1a3,-0x266)+_0x4a6678(0x35e,0x356,0x395,0x3dd)+'er\x20.st-cha'+_0x4a6678(0x2d0,0x34e,0x2fa,0x351)+_0x4a6678(0x412,0x382,0x3d7,0x43d)+'r','LsCHc':_0x1feebc(-0x166,-0x166,-0x1c2,-0x18d)+_0x1feebc(-0x21b,-0x208,-0x240,-0x28c)+_0x4a6678(0x343,0x2a7,0x2f4,0x272),'wqXZi':'data:image','gcMmJ':_0x4a6678(0x289,0x35a,0x306,0x298),'herox':'none','nzeHd':_0x1feebc(-0x17a,-0x11f,-0x19f,-0x194)+'x','EyQyx':_0x4a6678(0x27d,0x25e,0x2cd,0x27f),'ERGXk':_0x4a6678(0x376,0x301,0x34d,0x398),'SdTIt':function(_0x786c85,_0x561165){return _0x786c85(_0x561165);},'WGvyC':'previewIma'+_0x4a6678(0x2b2,0x2ec,0x2dd,0x2c3)+'r_ref','YPTQs':_0x1feebc(-0x166,-0x12a,-0x111,-0x196)+_0x1feebc(-0x1f6,-0x208,-0x1d3,-0x1c7)+_0x4a6678(0x2e8,0x346,0x2de,0x333)+_0x1feebc(-0x124,-0x136,-0x147,-0x102),'AHHjP':_0x1feebc(-0x20a,-0x26f,-0x1ce,-0x1bc),'TpAEc':function(_0x322d17,_0x5c3b8c){return _0x322d17!==_0x5c3b8c;},'vNoVT':_0x1feebc(-0x1e5,-0x1f3,-0x1fe,-0x217),'tOzuP':_0x1feebc(-0x128,-0x16d,-0x127,-0x195),'CznVe':_0x1feebc(-0x17c,-0x1b2,-0x171,-0x109)+'ing\x20cached'+_0x4a6678(0x3b9,0x370,0x37c,0x36d)+_0x4a6678(0x41d,0x336,0x3af,0x3e9),'nmwfH':function(_0x5aaac8,_0x29ff94){return _0x5aaac8(_0x29ff94);},'ICQrU':function(_0x2e0919,_0x35a8fe){return _0x2e0919(_0x35a8fe);},'fmiHC':function(_0x8fa833,_0x363e28){return _0x8fa833===_0x363e28;},'EwWQN':_0x4a6678(0x399,0x329,0x31d,0x386),'PBFkG':_0x4a6678(0x319,0x266,0x2e6,0x370),'Uugyv':'Loaded\x20Com'+_0x1feebc(-0x16a,-0x1c3,-0x18e,-0x17b)+_0x1feebc(-0x13c,-0xe6,-0x1a1,-0xd6)+_0x4a6678(0x399,0x38e,0x3a1,0x39b)+_0x1feebc(-0x201,-0x1b8,-0x207,-0x216)+_0x4a6678(0x385,0x30a,0x373,0x380)+_0x1feebc(-0x226,-0x1b2,-0x1b1,-0x2a4)+_0x4a6678(0x389,0x3ab,0x3ab,0x3ed)+'the\x20new\x20fo'+'rmat.'};function _0x4a6678(_0x5e40ac,_0x1d2185,_0x2d7090,_0x3dc646){return _0x3399c6(_0x2d7090- -0x17c,_0x1d2185-0x2,_0x3dc646,_0x3dc646-0x138);}await dbs['openDB']();function _0x1feebc(_0x186089,_0x4247bf,_0x1df2e0,_0x3ee32f){return _0x3399c6(_0x186089- -0x679,_0x4247bf-0x1df,_0x3ee32f,_0x3ee32f-0x1b5);}try{if(_0x218f48['TpAEc'](_0x218f48[_0x1feebc(-0x1e2,-0x1bc,-0x163,-0x214)],_0x218f48[_0x1feebc(-0x1e2,-0x1ed,-0x166,-0x1f1)]))_0x42004e['error'](_0x218f48[_0x4a6678(0x3fb,0x3da,0x3c5,0x430)],_0x5f01ad);else{const _0x40584b=await dbs['storeReadO'+_0x4a6678(0x342,0x29e,0x2e4,0x327)](NAI_VIBE_CACHE_KEY);if(_0x40584b&&_0x40584b[_0x4a6678(0x3a0,0x3a1,0x36a,0x3a7)]){if(_0x218f48[_0x4a6678(0x41a,0x402,0x3a2,0x3dd)](_0x1feebc(-0x18b,-0x207,-0x170,-0x134),_0x218f48[_0x1feebc(-0x198,-0x182,-0x175,-0x14a)]))updateNovelaiImagePreview(_0x40584b[_0x4a6678(0x3ac,0x3ca,0x36a,0x308)]);else{const _0x5da4fe=_0xd707f8['getElement'+_0x4a6678(0x32f,0x29b,0x303,0x2e1)](_0x218f48[_0x1feebc(-0x1cd,-0x224,-0x160,-0x187)]),_0x3fee46=_0x3a8f3b[_0x4a6678(0x2f7,0x369,0x353,0x305)+_0x4a6678(0x2c3,0x28c,0x2e7,0x27d)](_0x218f48[_0x4a6678(0x29e,0x333,0x2fd,0x2cd)]),_0x14ea88=_0x21ceb4[_0x4a6678(0x3ee,0x36d,0x389,0x3d7)+_0x4a6678(0x331,0x2f9,0x303,0x359)](_0x218f48[_0x1feebc(-0x172,-0x1a1,-0x1a5,-0x111)]);if(_0x2d5bce&&_0x26c48b[_0x4a6678(0x3b7,0x3f3,0x3bf,0x43b)](_0x218f48[_0x1feebc(-0x12b,-0x152,-0x133,-0x168)])){_0x5da4fe[_0x1feebc(-0x1b3,-0x19f,-0x1d0,-0x12a)]=_0x485ec5,_0x5da4fe[_0x4a6678(0x2cf,0x2e5,0x332,0x2d9)][_0x4a6678(0x2c4,0x36c,0x313,0x301)]=_0x218f48['gcMmJ'],_0x3fee46[_0x4a6678(0x3a5,0x34f,0x332,0x3b4)][_0x4a6678(0x2bd,0x2e7,0x313,0x39a)]=_0x218f48[_0x4a6678(0x2a5,0x268,0x2d6,0x2da)],_0x14ea88[_0x4a6678(0x36c,0x36d,0x332,0x321)]['display']=_0x218f48['nzeHd'];const _0x38bce5=_0xe6a377[_0x1feebc(-0x22f,-0x1be,-0x1b3,-0x1e8)](','),_0x388452=_0x38bce5[0x7bd+-0xb*-0x351+-0x14*0x236][_0x1feebc(-0x22f,-0x2ad,-0x208,-0x223)](':')[-0x1384+0xe*-0x70+0x19a5][_0x4a6678(0x339,0x287,0x2ce,0x270)](';')[-0x24e6*-0x1+0xccc+0x31b2*-0x1];_0x4298b2=_0x388452,_0x162ef6[_0x4a6678(0x418,0x3a9,0x3cd,0x3df)+_0x1feebc(-0x134,-0x103,-0x1bc,-0xab)+'e']=_0x38bce5[-0x60e*0x5+0x2179+-0x332];const _0x363871={};_0x363871['id']=_0x5b1344,_0x363871[_0x1feebc(-0x193,-0x1fb,-0x15f,-0x213)]=_0x5b1010,_0x55276b[_0x4a6678(0x379,0x345,0x384,0x309)+_0x4a6678(0x36f,0x3ab,0x359,0x394)](_0x363871);}else{const _0x57edf9=_0x218f48[_0x1feebc(-0x175,-0x192,-0x14a,-0x133)][_0x4a6678(0x271,0x29a,0x2ce,0x2a0)]('|');let _0x444efd=0x26*0x9a+-0x75*-0x49+-0x3839*0x1;while(!![]){switch(_0x57edf9[_0x444efd++]){case'0':_0x3e6900[_0x1feebc(-0x130,-0xd0,-0x154,-0x139)+'ansferImag'+'e']=null;continue;case'1':_0x3fee46[_0x1feebc(-0x1cb,-0x24e,-0x1f3,-0x22f)][_0x4a6678(0x2b7,0x30a,0x313,0x2d7)]=_0x218f48[_0x4a6678(0x34e,0x2b7,0x337,0x368)];continue;case'2':_0x14ea88[_0x1feebc(-0x1cb,-0x143,-0x1fe,-0x215)]['display']=_0x218f48[_0x4a6678(0x2ad,0x342,0x2d6,0x26a)];continue;case'3':_0x5da4fe[_0x4a6678(0x34b,0x2eb,0x34a,0x36a)]='';continue;case'4':_0x5da4fe[_0x4a6678(0x2f1,0x2e0,0x332,0x350)][_0x4a6678(0x34e,0x2a0,0x313,0x33e)]=_0x218f48[_0x1feebc(-0x227,-0x2ae,-0x1ff,-0x240)];continue;}break;}}}}}}catch(_0x2f8b42){console['error'](_0x218f48[_0x4a6678(0x32e,0x366,0x3ae,0x3d1)],_0x2f8b42);}try{const _0x3d693b=await dbs[_0x4a6678(0x35d,0x2c8,0x347,0x335)+'nly'](NAI_CHAR_REF_CACHE_KEY);_0x3d693b&&_0x3d693b[_0x4a6678(0x34e,0x341,0x36a,0x3a9)]&&_0x218f48['SdTIt'](updateNovelaiCharRefImagePreview,_0x3d693b['data']);}catch(_0x12e668){console[_0x4a6678(0x31b,0x378,0x341,0x2e6)]('Error\x20load'+'ing\x20cached'+_0x1feebc(-0x1e6,-0x213,-0x1ff,-0x1b9)+_0x4a6678(0x383,0x315,0x2fb,0x2d1)+_0x4a6678(0x418,0x43e,0x3be,0x434),_0x12e668);}try{if('wdiia'!==_0x1feebc(-0x1dc,-0x19d,-0x1e5,-0x206)){const _0x18fb27=await dbs[_0x4a6678(0x2c1,0x2e5,0x347,0x321)+_0x4a6678(0x296,0x274,0x2e4,0x283)](COMFYUI_REF_CACHE_KEY);if(_0x18fb27&&_0x18fb27[_0x1feebc(-0x193,-0x203,-0x189,-0x19a)]&&_0x18fb27[_0x4a6678(0x319,0x377,0x36a,0x3bd)][_0x1feebc(-0x193,-0x20c,-0x1f6,-0x120)]&&_0x18fb27[_0x4a6678(0x34e,0x333,0x36a,0x2ec)][_0x4a6678(0x3d3,0x3bc,0x3ce,0x452)+_0x4a6678(0x311,0x2f4,0x319,0x369)]){const _0x1753cd=_0x18fb27['data'],_0x37cc48=await _0x218f48[_0x1feebc(-0x161,-0x1cd,-0x1a6,-0x1bb)](fetch,_0x1753cd[_0x4a6678(0x3de,0x30d,0x36a,0x30e)]),_0x4e9314=await _0x37cc48[_0x4a6678(0x3b8,0x308,0x34b,0x397)](),_0x4039c7=URL[_0x1feebc(-0x20d,-0x288,-0x18e,-0x294)+_0x1feebc(-0x1ec,-0x1ef,-0x198,-0x165)](_0x4e9314);_0x218f48[_0x4a6678(0x342,0x2c4,0x2df,0x2aa)](updateComfyUIImagePreview,_0x4039c7),comfyuiImageObjectURL=_0x4039c7,window[_0x4a6678(0x2ba,0x363,0x2f7,0x322)+_0x4a6678(0x27b,0x2e1,0x2ed,0x2c3)]=_0x1753cd[_0x1feebc(-0x12f,-0x142,-0x19b,-0x163)+_0x4a6678(0x34f,0x365,0x319,0x382)],_0x218f48[_0x1feebc(-0x1a9,-0x170,-0x199,-0x149)](addLog,_0x1feebc(-0x17f,-0x1ce,-0x101,-0x1c6)+'UI图片:\x20'+_0x1753cd[_0x4a6678(0x3df,0x444,0x3ce,0x3c7)+_0x4a6678(0x2a5,0x313,0x319,0x36b)]),console[_0x4a6678(0x368,0x398,0x3bb,0x340)](_0x1feebc(-0x1e8,-0x1a5,-0x19e,-0x260)+'fyUI\x20image'+_0x4a6678(0x32b,0x317,0x2d4,0x28b)+_0x1feebc(-0x204,-0x239,-0x27e,-0x199)+_0x1753cd['serverFile'+_0x4a6678(0x2b7,0x3a1,0x319,0x321)]);}else{if(_0x18fb27&&_0x218f48[_0x4a6678(0x307,0x26f,0x2e1,0x309)](typeof _0x18fb27[_0x4a6678(0x30f,0x379,0x36a,0x319)],_0x218f48[_0x4a6678(0x36d,0x3a9,0x380,0x3e9)])){if(_0x218f48['fmiHC'](_0x218f48[_0x4a6678(0x2f0,0x388,0x327,0x319)],_0x218f48['PBFkG'])){const _0x1dc28b=await fetch(_0x18fb27['data']),_0x4ad1f3=await _0x1dc28b[_0x1feebc(-0x1b2,-0x182,-0x21e,-0x15d)](),_0x2e0344=URL[_0x1feebc(-0x20d,-0x1cc,-0x250,-0x1dc)+_0x4a6678(0x377,0x367,0x311,0x2f7)](_0x4ad1f3);_0x218f48[_0x1feebc(-0x161,-0x168,-0x18e,-0x100)](updateComfyUIImagePreview,_0x2e0344),comfyuiImageObjectURL=_0x2e0344,console[_0x4a6678(0x34f,0x324,0x38f,0x38e)](_0x218f48['Uugyv']);}else _0x218f48[_0x4a6678(0x25f,0x350,0x2df,0x318)](_0x55a482,_0x4f4701[_0x1feebc(-0x193,-0x17c,-0x13b,-0x15f)]);}}}else{const _0x5ad733=_0x96090[_0x4a6678(0x382,0x3e0,0x389,0x34d)+'ById'](_0x218f48['WGvyC']),_0x1cc748=_0x5e23cb[_0x4a6678(0x34c,0x368,0x353,0x2fb)+_0x4a6678(0x2c3,0x331,0x2e7,0x2ba)](_0x4a6678(0x32a,0x29d,0x31a,0x2ca)+_0x1feebc(-0x225,-0x23a,-0x206,-0x22d)+_0x1feebc(-0x17b,-0x1d0,-0x1be,-0x134)+_0x1feebc(-0x1ac,-0x234,-0x12b,-0x223)+_0x1feebc(-0x1a2,-0x11d,-0x1c0,-0x1ba)+'u8-image-p'+'laceholder'),_0x2707c9=_0xa3b9aa[_0x4a6678(0x363,0x402,0x389,0x40c)+_0x1feebc(-0x1fa,-0x1fc,-0x215,-0x197)](_0x218f48[_0x1feebc(-0x1a1,-0x1ad,-0x1de,-0x1bb)]);if(_0x4472d7&&_0xc3be95['startsWith'](_0x218f48[_0x1feebc(-0x12b,-0x19f,-0x140,-0xe4)])){_0x5ad733[_0x1feebc(-0x1b3,-0x1a6,-0x1ca,-0x15f)]=_0x345f8d,_0x5ad733['style']['display']=_0x218f48['gcMmJ'],_0x1cc748['style'][_0x1feebc(-0x1ea,-0x214,-0x1be,-0x249)]=_0x218f48[_0x1feebc(-0x227,-0x1ec,-0x1eb,-0x23c)],_0x2707c9[_0x1feebc(-0x1cb,-0x19d,-0x179,-0x24c)]['display']=_0x218f48[_0x1feebc(-0x1ba,-0x1b6,-0x1b4,-0x20d)];const _0x374666=_0x555f38[_0x4a6678(0x2ab,0x265,0x2ce,0x252)](','),_0x31d9d1=_0x374666[-0x667+0x4*0xf2+0x1*0x29f][_0x4a6678(0x2f6,0x2b5,0x2ce,0x2c3)](':')[0x118d+-0xfb*-0xb+-0x1c55][_0x1feebc(-0x22f,-0x257,-0x28a,-0x22c)](';')[-0xb95+0x239*0x1+0x95c];_0x302774=_0x31d9d1,_0x1cbece[_0x1feebc(-0x1cf,-0x150,-0x1b4,-0x14e)+'fImage']=_0x374666[0x17a2+-0x1f34+0x793];const _0x46f17c={};_0x46f17c['id']=_0x1300d1,_0x46f17c['data']=_0x374d88,_0x454224[_0x1feebc(-0x179,-0x1f2,-0x1c8,-0x19b)+_0x4a6678(0x31b,0x3b2,0x359,0x3c1)](_0x46f17c);}else{const _0x5933aa=_0x218f48[_0x4a6678(0x41a,0x378,0x3a6,0x3c7)][_0x1feebc(-0x22f,-0x247,-0x1da,-0x1ce)]('|');let _0x3a5a05=0x594*0x1+0x555*-0x3+-0x17d*-0x7;while(!![]){switch(_0x5933aa[_0x3a5a05++]){case'0':_0x23388e[_0x1feebc(-0x1cf,-0x1e1,-0x159,-0x1de)+_0x1feebc(-0x14a,-0x1b4,-0xd7,-0xd9)]=null;continue;case'1':_0x5ad733[_0x4a6678(0x2e3,0x317,0x332,0x2ea)][_0x4a6678(0x327,0x35e,0x313,0x379)]=_0x218f48[_0x4a6678(0x2ad,0x29f,0x2d6,0x26e)];continue;case'2':_0x1cc748[_0x4a6678(0x2c0,0x319,0x332,0x2f8)][_0x4a6678(0x36c,0x347,0x313,0x31e)]=_0x218f48[_0x4a6678(0x321,0x38d,0x337,0x2ba)];continue;case'3':_0x5ad733[_0x4a6678(0x36e,0x2f7,0x34a,0x370)]='';continue;case'4':_0x2707c9[_0x4a6678(0x31d,0x350,0x332,0x2f2)][_0x4a6678(0x2c1,0x322,0x313,0x2f1)]=_0x218f48[_0x1feebc(-0x227,-0x1f7,-0x225,-0x200)];continue;}break;}}}}catch(_0x114c5f){console['error'](_0x218f48['iPquf'],_0x114c5f);}}export function initImageUpload(_0x3ed824){const _0x459139={'swzCt':function(_0x5a4cf6,_0x805595){return _0x5a4cf6(_0x805595);},'vFVrD':function(_0x1b9640,_0x1e7438){return _0x1b9640===_0x1e7438;},'ZGCcA':_0x5ea160(0x2b6,0x328,0x2f4,0x27e),'WZdwB':'VliMN','sjQrL':function(_0x5afa12){return _0x5afa12();},'FmRzA':_0x3fe896(0x202,0x180,0x200,0x110),'giTJN':'inline-fle'+'x','GHJJy':function(_0x28dc4c,_0x555921){return _0x28dc4c!==_0x555921;},'fOizU':_0x3fe896(0x268,0x23e,0x292,0x24c),'lVJST':function(_0x1da181,_0x14b553){return _0x1da181===_0x14b553;},'PKGZi':_0x3fe896(0x1bf,0x1f1,0x222,0x222),'UPklU':'Error\x20load'+_0x5ea160(0x2a4,0x279,0x25e,0x2d5)+_0x3fe896(0x120,0x191,0x1dc,0x11b)+'har\x20Ref\x20im'+_0x3fe896(0x1f5,0x238,0x1d0,0x1cb),'nNPjB':_0x3fe896(0x1cb,0x146,0x15a,0x157),'qcrHB':_0x3fe896(0x1a1,0x1e0,0x192,0x1da),'vlzEK':'imageInput'+'2','WwjVg':'#novelai-s'+_0x3fe896(0x1f5,0x21a,0x1df,0x1af)+_0x5ea160(0x2cb,0x323,0x2ff,0x25e),'SAcnn':_0x5ea160(0x2a5,0x24c,0x2f5,0x313)+_0x3fe896(0x20a,0x226,0x244,0x28a),'xbjKj':_0x5ea160(0x2ea,0x317,0x2ad,0x2d0),'uubpH':_0x5ea160(0x295,0x273,0x244,0x248)+_0x3fe896(0x134,0x162,0x114,0x17b)+_0x5ea160(0x379,0x338,0x32a,0x343)+'-btn','tyNSm':'click','sxGKz':_0x5ea160(0x2a5,0x2cb,0x2cc,0x2e7)+_0x3fe896(0x1ca,0x182,0x176,0x1d6)+_0x3fe896(0x131,0x14f,0x1c0,0x18f),'UPNyU':_0x3fe896(0x296,0x215,0x242,0x20f)+'emove-char'+_0x5ea160(0x379,0x34d,0x39c,0x2f4)+'-btn','hoxwE':'#comfyui-s'+_0x3fe896(0x26b,0x21a,0x263,0x1ae)+_0x3fe896(0x183,0x19f,0x15e,0x21e),'GASno':_0x3fe896(0x200,0x179,0x13b,0x137)+'t2','XSdqU':_0x3fe896(0x25d,0x217,0x1e6,0x28c)+_0x3fe896(0x180,0x1dc,0x173,0x1cf)+_0x3fe896(0x161,0x19f,0x189,0x215)};loadCachedImages(),_0x3ed824['find'](_0x459139[_0x3fe896(0x1d1,0x153,0x1be,0x1c4)])['on'](_0x5ea160(0x34f,0x335,0x33d,0x375),()=>{const _0x5e23ce={'myWVE':function(_0x18c5d8,_0x3d3a9d){function _0x149bb5(_0x11f76f,_0x4d1c5e,_0x5fa8b5,_0x3e27f4){return _0x9680(_0x4d1c5e-0x193,_0x3e27f4);}return _0x459139[_0x149bb5(0x42f,0x3b2,0x3e0,0x38f)](_0x18c5d8,_0x3d3a9d);}};function _0x597dd0(_0x2158f9,_0x503088,_0x3356c1,_0x553a79){return _0x3fe896(_0x3356c1,_0x553a79-0x36d,_0x3356c1-0x117,_0x553a79-0x157);}function _0x17ed04(_0x501ac5,_0x24dac6,_0x371014,_0x2b8516){return _0x5ea160(_0x24dac6- -0x383,_0x24dac6-0x6a,_0x501ac5,_0x2b8516-0x90);}_0x459139[_0x17ed04(0x29,-0x56,-0x26,0x13)](_0x459139[_0x17ed04(-0x3c,-0x11,0x6e,-0x68)],_0x459139[_0x597dd0(0x5a6,0x590,0x4fe,0x54f)])?(_0x5e23ce[_0x17ed04(-0x177,-0xfd,-0x183,-0xc7)](_0x281aa7,null),_0x36a2ec[_0x17ed04(0x27,-0x50,-0x9d,0x15)+'e'](_0x21f72d)):document[_0x17ed04(0x12,-0x54,-0x10,-0x1a)+'ById'](_0x597dd0(0x530,0x596,0x524,0x541)+_0x17ed04(-0x87,-0x58,0x25,-0x80))[_0x17ed04(-0x27,-0x34,0x46,-0x6)]();}),_0x3ed824['find'](_0x459139[_0x5ea160(0x337,0x39f,0x2de,0x300)])['on'](_0x459139[_0x5ea160(0x35d,0x3ce,0x319,0x3cf)],handleNovelaiImageUpload),_0x3ed824[_0x5ea160(0x2b5,0x305,0x231,0x287)](_0x5ea160(0x341,0x2dc,0x392,0x2ea)+_0x5ea160(0x308,0x2d2,0x305,0x2bb)+_0x3fe896(0x123,0x19f,0x213,0x136))['on']('click',()=>{_0x459139['sjQrL'](removeNovelaiImage);}),_0x3ed824[_0x5ea160(0x2b5,0x261,0x263,0x2fd)](_0x459139[_0x3fe896(0x15d,0x1bc,0x171,0x178)])['on'](_0x459139['tyNSm'],()=>{function _0x226772(_0xde36e1,_0x537ea3,_0x190fb5,_0x63954a){return _0x5ea160(_0x190fb5- -0x1c1,_0x537ea3-0x14b,_0x537ea3,_0x63954a-0x89);}function _0x5034c5(_0x1f8de4,_0xcf021b,_0x3c0d42,_0x59e684){return _0x5ea160(_0xcf021b-0x164,_0xcf021b-0x18a,_0x1f8de4,_0x59e684-0x109);}if(_0x459139[_0x226772(0x7f,0xd6,0xb8,0x117)](_0x459139[_0x5034c5(0x4b3,0x4b4,0x437,0x4d8)],_0x5034c5(0x376,0x3dc,0x36b,0x37e)))document[_0x226772(0x191,0x16d,0x16e,0x16a)+_0x226772(0x15c,0x12a,0xe8,0x8b)](_0x226772(0xb6,0x134,0x13f,0x168)+_0x5034c5(0x3c1,0x40b,0x3e5,0x3ec)+'ref')[_0x226772(0x1c1,0x10b,0x18e,0x171)]();else{_0x5ad60a[_0x5034c5(0x3fb,0x454,0x490,0x48a)]=_0xb3fe30,_0x4a22fd[_0x226772(0x114,0x99,0x117,0x15d)][_0x5034c5(0x3ea,0x41d,0x42a,0x3c5)]=_0x459139['FmRzA'],_0x1c0f6a[_0x5034c5(0x47e,0x43c,0x3d6,0x4b6)][_0x226772(0xd7,0x99,0xf8,0x8c)]='none',_0x256a28[_0x5034c5(0x43c,0x43c,0x49f,0x4be)]['display']=_0x459139[_0x5034c5(0x51b,0x4af,0x526,0x494)];const _0x3ec7a8=_0x1695ce['split'](','),_0x33d972=_0x3ec7a8[0xe94+0x3*0x1e9+-0x144f*0x1][_0x226772(0x101,0x51,0xb3,0x13b)](':')[0x19*-0xa7+-0x25f0+0x3640]['split'](';')[0x1*0xbb7+0xdc4+0x251*-0xb];_0x1c31ca=_0x33d972,_0x1e870c[_0x226772(0x1b0,0x19e,0x1b2,0x135)+_0x226772(0x1a6,0x167,0x1ae,0x1d4)+'e']=_0x3ec7a8[0xa8e+-0x1bd5+0x2*0x8a4];const _0x1d9e6d={};_0x1d9e6d['id']=_0xb1286,_0x1d9e6d['data']=_0x3f06e8,_0x7c3c1['storeReadW'+_0x226772(0xb5,0x103,0x13e,0x136)](_0x1d9e6d);}}),_0x3ed824[_0x5ea160(0x2b5,0x27c,0x2a5,0x2e1)](_0x459139[_0x5ea160(0x2cc,0x2d0,0x32f,0x303)])['on'](_0x459139[_0x5ea160(0x35d,0x3e5,0x37d,0x2de)],handleNovelaiCharRefImageUpload);function _0x5ea160(_0xfec3c6,_0x4e7d6f,_0x56ca41,_0x55e1ee){return _0x561afc(_0xfec3c6-0x175,_0xfec3c6- -0xda,_0x56ca41-0x146,_0x56ca41);}_0x3ed824[_0x3fe896(0x18d,0x189,0x1e2,0x15e)](_0x459139['UPNyU'])['on'](_0x459139[_0x5ea160(0x35c,0x30c,0x326,0x3b3)],()=>{function _0x3bb6e5(_0x4749d9,_0x4168c7,_0x27b48a,_0x974551){return _0x5ea160(_0x27b48a-0x2bb,_0x4168c7-0x1c8,_0x4168c7,_0x974551-0x15);}function _0x4eef99(_0x472736,_0x140d3c,_0x479c5c,_0x1369b5){return _0x3fe896(_0x472736,_0x1369b5-0x2f8,_0x479c5c-0x98,_0x1369b5-0xab);}_0x459139[_0x3bb6e5(0x557,0x624,0x59b,0x5c3)](_0x459139[_0x4eef99(0x4ff,0x4c8,0x496,0x4dd)],_0x459139[_0x4eef99(0x536,0x553,0x529,0x4dd)])?removeNovelaiCharRefImage():(_0x459139['swzCt'](_0x2540de,null),_0x5a049b[_0x4eef99(0x4ef,0x549,0x4be,0x4ff)+'e'](_0x34fc40));}),_0x3ed824[_0x3fe896(0x1b1,0x189,0x18f,0x18a)](_0x459139[_0x5ea160(0x2d7,0x29a,0x348,0x315)])['on'](_0x3fe896(0x20e,0x223,0x259,0x1eb),()=>{function _0x2f7e32(_0x2e354a,_0x57b277,_0x493a92,_0x1d80fc){return _0x5ea160(_0x1d80fc- -0x20b,_0x57b277-0x190,_0x57b277,_0x1d80fc-0x56);}function _0x596c59(_0x1ba3e1,_0x5edb60,_0x263493,_0x39dfc3){return _0x3fe896(_0x1ba3e1,_0x5edb60-0x3b6,_0x263493-0xa9,_0x39dfc3-0x19b);}_0x459139[_0x2f7e32(0x13a,0x127,0x91,0xd5)](_0x459139[_0x2f7e32(0xe7,0xa9,0x11a,0x9b)],_0x459139[_0x596c59(0x4b0,0x51a,0x4a3,0x4da)])?_0x4a6acf['error'](_0x459139['UPklU'],_0x18b575):document['getElement'+'ById'](_0x459139[_0x596c59(0x5c4,0x59e,0x51d,0x5d5)])['click']();}),_0x3ed824[_0x5ea160(0x2b5,0x2ad,0x2a2,0x2e6)](_0x459139['GASno'])['on'](_0x459139[_0x3fe896(0x226,0x231,0x260,0x1df)],handleImageUpload2);function _0x3fe896(_0x45a2d1,_0x5ad9fe,_0x75297c,_0x5e1ef4){return _0x561afc(_0x45a2d1-0x199,_0x5ad9fe- -0x206,_0x75297c-0x24,_0x45a2d1);}_0x3ed824[_0x5ea160(0x2b5,0x2b9,0x2ba,0x2ef)](_0x459139[_0x5ea160(0x297,0x31c,0x2eb,0x261)])['on'](_0x5ea160(0x34f,0x3a7,0x2f3,0x2d3),()=>{function _0x5516d6(_0x29f682,_0x50203e,_0x19f7d9,_0x370388){return _0x5ea160(_0x370388-0xc2,_0x50203e-0x1c1,_0x50203e,_0x370388-0x154);}_0x459139[_0x5516d6(0x485,0x46d,0x3f4,0x440)](removeComfyUIImage);});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};